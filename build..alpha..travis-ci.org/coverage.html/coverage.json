{"/home/travis/build/npmtest/node-npmtest-pomelo/test.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/test.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":1,"12":1,"13":1,"14":1,"15":2,"16":2,"17":2,"18":2,"19":1,"20":1,"21":2,"22":2,"23":2,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":2,"40":2,"41":1,"42":2,"43":2,"44":1,"45":2,"46":2,"47":1,"48":2,"49":2,"50":1,"51":1,"52":1,"53":1,"54":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[1,1],"5":[1,1],"6":[1,1],"7":[1,1],"8":[1,1],"9":[1,1],"10":[1,1,1],"11":[1,1],"12":[1,1],"13":[1,1],"14":[1,1],"15":[1,1],"16":[1,1],"17":[1,1]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":1,"7":1,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":5},"end":{"line":61,"column":17}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":5},"end":{"line":82,"column":17}}},"6":{"name":"(anonymous_6)","line":91,"loc":{"start":{"line":91,"column":77},"end":{"line":94,"column":10}}},"7":{"name":"(anonymous_7)","line":112,"loc":{"start":{"line":112,"column":83},"end":{"line":115,"column":10}},"skip":true},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":77},"end":{"line":126,"column":10}},"skip":true},"9":{"name":"(anonymous_9)","line":139,"loc":{"start":{"line":139,"column":12},"end":{"line":139,"column":40}},"skip":true},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":77},"end":{"line":150,"column":10}},"skip":true},"11":{"name":"(anonymous_11)","line":158,"loc":{"start":{"line":158,"column":83},"end":{"line":161,"column":10}},"skip":true},"12":{"name":"(anonymous_12)","line":169,"loc":{"start":{"line":169,"column":79},"end":{"line":172,"column":10}},"skip":true},"13":{"name":"(anonymous_13)","line":180,"loc":{"start":{"line":180,"column":75},"end":{"line":183,"column":10}},"skip":true}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":195,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":56,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":40,"column":8},"end":{"line":53,"column":9}},"11":{"start":{"line":43,"column":12},"end":{"line":46,"column":14}},"12":{"start":{"line":47,"column":12},"end":{"line":47,"column":18}},"13":{"start":{"line":50,"column":12},"end":{"line":51,"column":46}},"14":{"start":{"line":52,"column":12},"end":{"line":52,"column":18}},"15":{"start":{"line":55,"column":8},"end":{"line":55,"column":35}},"16":{"start":{"line":61,"column":4},"end":{"line":63,"column":9}},"17":{"start":{"line":62,"column":8},"end":{"line":62,"column":15}},"18":{"start":{"line":64,"column":4},"end":{"line":77,"column":5}},"19":{"start":{"line":70,"column":8},"end":{"line":70,"column":14}},"20":{"start":{"line":76,"column":8},"end":{"line":76,"column":14}},"21":{"start":{"line":82,"column":4},"end":{"line":84,"column":9}},"22":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"23":{"start":{"line":85,"column":4},"end":{"line":194,"column":5}},"24":{"start":{"line":91,"column":8},"end":{"line":99,"column":10}},"25":{"start":{"line":98,"column":12},"end":{"line":98,"column":35}},"26":{"start":{"line":102,"column":8},"end":{"line":104,"column":63}},"27":{"start":{"line":105,"column":8},"end":{"line":105,"column":14}},"28":{"start":{"line":112,"column":8},"end":{"line":121,"column":10},"skip":true},"29":{"start":{"line":119,"column":12},"end":{"line":119,"column":55},"skip":true},"30":{"start":{"line":120,"column":12},"end":{"line":120,"column":48},"skip":true},"31":{"start":{"line":123,"column":8},"end":{"line":136,"column":10},"skip":true},"32":{"start":{"line":130,"column":12},"end":{"line":130,"column":76},"skip":true},"33":{"start":{"line":131,"column":12},"end":{"line":131,"column":73},"skip":true},"34":{"start":{"line":132,"column":12},"end":{"line":132,"column":74},"skip":true},"35":{"start":{"line":133,"column":12},"end":{"line":133,"column":79},"skip":true},"36":{"start":{"line":134,"column":12},"end":{"line":134,"column":25},"skip":true},"37":{"start":{"line":135,"column":12},"end":{"line":135,"column":45},"skip":true},"38":{"start":{"line":138,"column":8},"end":{"line":145,"column":14},"skip":true},"39":{"start":{"line":143,"column":16},"end":{"line":143,"column":29},"skip":true},"40":{"start":{"line":144,"column":16},"end":{"line":144,"column":55},"skip":true},"41":{"start":{"line":147,"column":8},"end":{"line":156,"column":10},"skip":true},"42":{"start":{"line":154,"column":12},"end":{"line":154,"column":25},"skip":true},"43":{"start":{"line":155,"column":12},"end":{"line":155,"column":45},"skip":true},"44":{"start":{"line":158,"column":8},"end":{"line":167,"column":10},"skip":true},"45":{"start":{"line":165,"column":12},"end":{"line":165,"column":25},"skip":true},"46":{"start":{"line":166,"column":12},"end":{"line":166,"column":48},"skip":true},"47":{"start":{"line":169,"column":8},"end":{"line":178,"column":10},"skip":true},"48":{"start":{"line":176,"column":12},"end":{"line":176,"column":25},"skip":true},"49":{"start":{"line":177,"column":12},"end":{"line":177,"column":46},"skip":true},"50":{"start":{"line":180,"column":8},"end":{"line":189,"column":10},"skip":true},"51":{"start":{"line":187,"column":12},"end":{"line":187,"column":94},"skip":true},"52":{"start":{"line":188,"column":12},"end":{"line":188,"column":48},"skip":true},"53":{"start":{"line":192,"column":8},"end":{"line":192,"column":35},"skip":true},"54":{"start":{"line":193,"column":8},"end":{"line":193,"column":14},"skip":true}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":40,"type":"switch","locations":[{"start":{"line":42,"column":8},"end":{"line":47,"column":18}},{"start":{"line":49,"column":8},"end":{"line":52,"column":18}}]},"5":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":44}},{"start":{"line":44,"column":48},"end":{"line":44,"column":66}}]},"6":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":21},"end":{"line":50,"column":49}},{"start":{"line":50,"column":53},"end":{"line":50,"column":72}}]},"7":{"line":64,"type":"switch","locations":[{"start":{"line":69,"column":4},"end":{"line":70,"column":14}},{"start":{"line":75,"column":4},"end":{"line":76,"column":14}}]},"8":{"line":85,"type":"switch","locations":[{"start":{"line":90,"column":4},"end":{"line":105,"column":14}},{"start":{"line":111,"column":4},"end":{"line":193,"column":14},"skip":true}]},"9":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":42},"end":{"line":91,"column":73}},{"start":{"line":91,"column":77},"end":{"line":99,"column":9}}]},"10":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":18},"end":{"line":102,"column":32}},{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},{"start":{"line":104,"column":12},"end":{"line":104,"column":61}}]},"11":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":45},"end":{"line":112,"column":79},"skip":true},{"start":{"line":112,"column":83},"end":{"line":121,"column":9},"skip":true}]},"12":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":42},"end":{"line":123,"column":73},"skip":true},{"start":{"line":123,"column":77},"end":{"line":136,"column":9},"skip":true}]},"13":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":48},"end":{"line":138,"column":85},"skip":true},{"start":{"line":139,"column":12},"end":{"line":145,"column":13},"skip":true}]},"14":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":42},"end":{"line":147,"column":73},"skip":true},{"start":{"line":147,"column":77},"end":{"line":156,"column":9},"skip":true}]},"15":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":45},"end":{"line":158,"column":79},"skip":true},{"start":{"line":158,"column":83},"end":{"line":167,"column":9},"skip":true}]},"16":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":43},"end":{"line":169,"column":75},"skip":true},{"start":{"line":169,"column":79},"end":{"line":178,"column":9},"skip":true}]},"17":{"line":180,"type":"binary-expr","locations":[{"start":{"line":180,"column":41},"end":{"line":180,"column":71},"skip":true},{"start":{"line":180,"column":75},"end":{"line":189,"column":9},"skip":true}]}},"code":["/* istanbul instrument in package npmtest_pomelo */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - pre-init","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        switch (local.modeJs) {","        // re-init local from window.local","        case 'browser':","            local = local.global.utility2.objectSetDefault(","                local.global.utility2_rollup || local.global.local,","                local.global.utility2","            );","            break;","        // re-init local from example.js","        case 'node':","            local = (local.global.utility2_rollup || require('utility2'))","                .requireExampleJsFromReadme();","            break;","        }","        // export local","        local.global.local = local;","    }());","","","","    // run shared js-env code - function","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - function","    case 'browser':","        break;","","","","    // run node js-env code - function","    case 'node':","        break;","    }","","","","    // run shared js-env code - post-init","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - post-init","    case 'browser':","        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (","            options,","            onError","        ) {","        /*","         * this function will test browsers's null-case handling-behavior-behavior","         */","            onError(null, options);","        };","","        // run tests","        local.nop(local.modeTest &&","            document.querySelector('#testRunButton1') &&","            document.querySelector('#testRunButton1').click());","        break;","","","","    // run node js-env code - post-init","    /* istanbul ignore next */","    case 'node':","        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApidoc's default handling-behavior-behavior","         */","            options = { modulePathList: module.paths };","            local.buildApidoc(options, onError);","        };","","        local.testCase_buildApp_default = local.testCase_buildApp_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApp's default handling-behavior-behavior","         */","            local.testCase_buildReadme_default(options, local.onErrorThrow);","            local.testCase_buildLib_default(options, local.onErrorThrow);","            local.testCase_buildTest_default(options, local.onErrorThrow);","            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);","            options = [];","            local.buildApp(options, onError);","        };","","        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||","            function (options, onError) {","            /*","             * this function will test buildCustomOrg's default handling-behavior","             */","                options = {};","                local.buildCustomOrg(options, onError);","            };","","        local.testCase_buildLib_default = local.testCase_buildLib_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildLib's default handling-behavior","         */","            options = {};","            local.buildLib(options, onError);","        };","","        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildReadme's default handling-behavior-behavior","         */","            options = {};","            local.buildReadme(options, onError);","        };","","        local.testCase_buildTest_default = local.testCase_buildTest_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildTest's default handling-behavior","         */","            options = {};","            local.buildTest(options, onError);","        };","","        local.testCase_webpage_default = local.testCase_webpage_default || function (","            options,","            onError","        ) {","        /*","         * this function will test webpage's default handling-behavior","         */","            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };","            local.browserTest(options, onError);","        };","","        // run test-server","        local.testRunServer(local);","        break;","    }","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"40":2,"43":1,"47":1,"50":1,"52":1,"55":2,"61":2,"62":2,"64":2,"70":1,"76":1,"82":2,"83":2,"85":2,"91":1,"98":1,"102":1,"105":1,"112":1,"119":1,"120":1,"123":1,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"138":1,"143":2,"144":2,"147":1,"154":2,"155":2,"158":1,"165":2,"166":2,"169":1,"176":2,"177":2,"180":1,"187":1,"188":1,"192":1,"193":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/lib.npmtest_pomelo.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/lib.npmtest_pomelo.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":1,"15":1,"16":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1]},"f":{"1":2,"2":2,"3":2},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":53,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":52,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":41,"column":8},"end":{"line":41,"column":54}},"11":{"start":{"line":43,"column":8},"end":{"line":43,"column":51}},"12":{"start":{"line":45,"column":8},"end":{"line":51,"column":9}},"13":{"start":{"line":46,"column":12},"end":{"line":46,"column":57}},"14":{"start":{"line":48,"column":12},"end":{"line":48,"column":35}},"15":{"start":{"line":49,"column":12},"end":{"line":49,"column":49}},"16":{"start":{"line":50,"column":12},"end":{"line":50,"column":43}}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":44}},{"start":{"line":41,"column":48},"end":{"line":41,"column":53}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]}},"code":["/* istanbul instrument in package npmtest_pomelo */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - pre-init","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || local;","        // init lib","        local.local = local.npmtest_pomelo = local;","        // init exports","        if (local.modeJs === 'browser') {","            local.global.utility2_npmtest_pomelo = local;","        } else {","            module.exports = local;","            module.exports.__dirname = __dirname;","            module.exports.module = module;","        }","    }());","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"41":2,"43":2,"45":2,"46":1,"48":1,"49":1,"50":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/example.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/example.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":2,"15":2,"16":2,"17":2,"18":2,"19":0,"20":2,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":2,"31":0,"32":0,"33":0,"34":1,"35":2,"36":2,"37":3,"38":3,"39":3,"40":3,"41":0,"42":3,"43":3,"44":3,"45":1,"46":3,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":0,"58":1,"59":6,"60":6,"61":1,"62":2,"63":0,"64":2,"65":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1],"6":[1,1],"7":[2,0],"8":[2,1,1,1,1,1],"9":[0,2,0],"10":[1,1],"11":[2,1,1],"12":[1,0],"13":[0,2],"14":[2,0,0,0,0,0,0],"15":[0,3],"16":[3,0],"17":[1,1],"18":[0,1],"19":[1,2,0,2],"20":[1,0],"21":[1,1],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":3,"8":3,"9":3,"10":1,"11":6,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":1},"end":{"line":26,"column":13}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":5},"end":{"line":33,"column":17}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":36}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":31},"end":{"line":69,"column":48}},"skip":true},"5":{"name":"(anonymous_5)","line":78,"loc":{"start":{"line":78,"column":26},"end":{"line":78,"column":45}},"skip":true},"6":{"name":"(anonymous_6)","line":123,"loc":{"start":{"line":123,"column":33},"end":{"line":123,"column":48}},"skip":true},"7":{"name":"(anonymous_7)","line":125,"loc":{"start":{"line":125,"column":27},"end":{"line":125,"column":39}},"skip":true},"8":{"name":"(anonymous_8)","line":133,"loc":{"start":{"line":133,"column":59},"end":{"line":133,"column":74}},"skip":true},"9":{"name":"(anonymous_9)","line":143,"loc":{"start":{"line":143,"column":45},"end":{"line":143,"column":62}},"skip":true},"10":{"name":"(anonymous_10)","line":144,"loc":{"start":{"line":144,"column":73},"end":{"line":144,"column":92}},"skip":true},"11":{"name":"(anonymous_11)","line":272,"loc":{"start":{"line":272,"column":51},"end":{"line":272,"column":77}},"skip":true},"12":{"name":"(anonymous_12)","line":315,"loc":{"start":{"line":315,"column":32},"end":{"line":315,"column":61}},"skip":true}},"statementMap":{"1":{"start":{"line":26,"column":0},"end":{"line":326,"column":5}},"2":{"start":{"line":28,"column":4},"end":{"line":28,"column":14}},"3":{"start":{"line":33,"column":4},"end":{"line":60,"column":9}},"4":{"start":{"line":35,"column":8},"end":{"line":35,"column":19}},"5":{"start":{"line":37,"column":8},"end":{"line":49,"column":13}},"6":{"start":{"line":38,"column":12},"end":{"line":48,"column":13}},"7":{"start":{"line":39,"column":16},"end":{"line":42,"column":30}},"8":{"start":{"line":44,"column":16},"end":{"line":47,"column":27}},"9":{"start":{"line":51,"column":8},"end":{"line":53,"column":21}},"10":{"start":{"line":55,"column":8},"end":{"line":57,"column":45}},"11":{"start":{"line":59,"column":8},"end":{"line":59,"column":35}},"12":{"start":{"line":61,"column":4},"end":{"line":325,"column":5}},"13":{"start":{"line":69,"column":8},"end":{"line":121,"column":10},"skip":true},"14":{"start":{"line":70,"column":12},"end":{"line":88,"column":13},"skip":true},"15":{"start":{"line":76,"column":16},"end":{"line":87,"column":19},"skip":true},"16":{"start":{"line":79,"column":20},"end":{"line":86,"column":21},"skip":true},"17":{"start":{"line":82,"column":24},"end":{"line":82,"column":43},"skip":true},"18":{"start":{"line":83,"column":24},"end":{"line":83,"column":30},"skip":true},"19":{"start":{"line":85,"column":24},"end":{"line":85,"column":49},"skip":true},"20":{"start":{"line":89,"column":12},"end":{"line":107,"column":13},"skip":true},"21":{"start":{"line":92,"column":16},"end":{"line":102,"column":17},"skip":true},"22":{"start":{"line":93,"column":20},"end":{"line":93,"column":86},"skip":true},"23":{"start":{"line":94,"column":20},"end":{"line":95,"column":45},"skip":true},"24":{"start":{"line":96,"column":20},"end":{"line":96,"column":42},"skip":true},"25":{"start":{"line":97,"column":20},"end":{"line":97,"column":48},"skip":true},"26":{"start":{"line":100,"column":20},"end":{"line":100,"column":85},"skip":true},"27":{"start":{"line":101,"column":20},"end":{"line":101,"column":96},"skip":true},"28":{"start":{"line":103,"column":16},"end":{"line":103,"column":22},"skip":true},"29":{"start":{"line":106,"column":16},"end":{"line":106,"column":22},"skip":true},"30":{"start":{"line":108,"column":12},"end":{"line":120,"column":13},"skip":true},"31":{"start":{"line":114,"column":16},"end":{"line":119,"column":17},"skip":true},"32":{"start":{"line":116,"column":20},"end":{"line":116,"column":78},"skip":true},"33":{"start":{"line":118,"column":20},"end":{"line":118,"column":47},"skip":true},"34":{"start":{"line":123,"column":8},"end":{"line":141,"column":11},"skip":true},"35":{"start":{"line":124,"column":12},"end":{"line":124,"column":54},"skip":true},"36":{"start":{"line":125,"column":12},"end":{"line":140,"column":14},"skip":true},"37":{"start":{"line":126,"column":16},"end":{"line":126,"column":28},"skip":true},"38":{"start":{"line":127,"column":16},"end":{"line":127,"column":69},"skip":true},"39":{"start":{"line":128,"column":16},"end":{"line":128,"column":75},"skip":true},"40":{"start":{"line":129,"column":16},"end":{"line":131,"column":17},"skip":true},"41":{"start":{"line":130,"column":20},"end":{"line":130,"column":27},"skip":true},"42":{"start":{"line":133,"column":16},"end":{"line":137,"column":36},"skip":true},"43":{"start":{"line":134,"column":20},"end":{"line":136,"column":55},"skip":true},"44":{"start":{"line":139,"column":16},"end":{"line":139,"column":57},"skip":true},"45":{"start":{"line":143,"column":8},"end":{"line":147,"column":11},"skip":true},"46":{"start":{"line":144,"column":12},"end":{"line":146,"column":15},"skip":true},"47":{"start":{"line":145,"column":16},"end":{"line":145,"column":70},"skip":true},"48":{"start":{"line":149,"column":8},"end":{"line":149,"column":31},"skip":true},"49":{"start":{"line":150,"column":8},"end":{"line":150,"column":14},"skip":true},"50":{"start":{"line":158,"column":8},"end":{"line":158,"column":31},"skip":true},"51":{"start":{"line":160,"column":8},"end":{"line":160,"column":33},"skip":true},"52":{"start":{"line":161,"column":8},"end":{"line":161,"column":37},"skip":true},"53":{"start":{"line":162,"column":8},"end":{"line":162,"column":35},"skip":true},"54":{"start":{"line":164,"column":8},"end":{"line":164,"column":50},"skip":true},"55":{"start":{"line":166,"column":8},"end":{"line":256,"column":2},"skip":true},"56":{"start":{"line":258,"column":8},"end":{"line":286,"column":9},"skip":true},"57":{"start":{"line":259,"column":12},"end":{"line":269,"column":14},"skip":true},"58":{"start":{"line":271,"column":12},"end":{"line":285,"column":19},"skip":true},"59":{"start":{"line":274,"column":20},"end":{"line":274,"column":35},"skip":true},"60":{"start":{"line":275,"column":20},"end":{"line":284,"column":21},"skip":true},"61":{"start":{"line":277,"column":24},"end":{"line":277,"column":64},"skip":true},"62":{"start":{"line":279,"column":24},"end":{"line":279,"column":40},"skip":true},"63":{"start":{"line":281,"column":24},"end":{"line":281,"column":40},"skip":true},"64":{"start":{"line":283,"column":24},"end":{"line":283,"column":39},"skip":true},"65":{"start":{"line":288,"column":8},"end":{"line":290,"column":9},"skip":true},"66":{"start":{"line":289,"column":12},"end":{"line":289,"column":18},"skip":true},"67":{"start":{"line":291,"column":8},"end":{"line":293,"column":54},"skip":true},"68":{"start":{"line":296,"column":8},"end":{"line":301,"column":37},"skip":true},"69":{"start":{"line":303,"column":8},"end":{"line":303,"column":82},"skip":true},"70":{"start":{"line":306,"column":8},"end":{"line":308,"column":9},"skip":true},"71":{"start":{"line":307,"column":12},"end":{"line":307,"column":82},"skip":true},"72":{"start":{"line":310,"column":8},"end":{"line":312,"column":9},"skip":true},"73":{"start":{"line":311,"column":12},"end":{"line":311,"column":18},"skip":true},"74":{"start":{"line":313,"column":8},"end":{"line":313,"column":54},"skip":true},"75":{"start":{"line":314,"column":8},"end":{"line":314,"column":69},"skip":true},"76":{"start":{"line":315,"column":8},"end":{"line":323,"column":36},"skip":true},"77":{"start":{"line":316,"column":12},"end":{"line":316,"column":61},"skip":true},"78":{"start":{"line":317,"column":12},"end":{"line":320,"column":13},"skip":true},"79":{"start":{"line":318,"column":16},"end":{"line":318,"column":75},"skip":true},"80":{"start":{"line":319,"column":16},"end":{"line":319,"column":23},"skip":true},"81":{"start":{"line":321,"column":12},"end":{"line":321,"column":38},"skip":true},"82":{"start":{"line":322,"column":12},"end":{"line":322,"column":27},"skip":true},"83":{"start":{"line":324,"column":8},"end":{"line":324,"column":14},"skip":true}},"branchMap":{"1":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":23},"end":{"line":39,"column":62}},{"start":{"line":40,"column":20},"end":{"line":40,"column":70}},{"start":{"line":41,"column":20},"end":{"line":41,"column":71}},{"start":{"line":42,"column":20},"end":{"line":42,"column":29}}]},"2":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":23},"end":{"line":44,"column":37}},{"start":{"line":45,"column":20},"end":{"line":45,"column":61}},{"start":{"line":46,"column":20},"end":{"line":46,"column":70}},{"start":{"line":47,"column":20},"end":{"line":47,"column":26}}]},"3":{"line":51,"type":"cond-expr","locations":[{"start":{"line":52,"column":14},"end":{"line":52,"column":20}},{"start":{"line":53,"column":14},"end":{"line":53,"column":20}}]},"4":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":16},"end":{"line":55,"column":44}},{"start":{"line":55,"column":49},"end":{"line":57,"column":43}}]},"5":{"line":55,"type":"cond-expr","locations":[{"start":{"line":56,"column":14},"end":{"line":56,"column":50}},{"start":{"line":57,"column":14},"end":{"line":57,"column":43}}]},"6":{"line":61,"type":"switch","locations":[{"start":{"line":68,"column":4},"end":{"line":150,"column":14},"skip":true},{"start":{"line":156,"column":4},"end":{"line":324,"column":14},"skip":true}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true},{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":16},"end":{"line":70,"column":22},"skip":true},{"start":{"line":70,"column":27},"end":{"line":70,"column":32},"skip":true},{"start":{"line":71,"column":20},"end":{"line":71,"column":39},"skip":true},{"start":{"line":72,"column":20},"end":{"line":72,"column":49},"skip":true},{"start":{"line":73,"column":20},"end":{"line":73,"column":58},"skip":true},{"start":{"line":74,"column":20},"end":{"line":74,"column":69},"skip":true}]},"9":{"line":79,"type":"switch","locations":[{"start":{"line":80,"column":20},"end":{"line":80,"column":33},"skip":true},{"start":{"line":81,"column":20},"end":{"line":83,"column":30},"skip":true},{"start":{"line":84,"column":20},"end":{"line":85,"column":49},"skip":true}]},"10":{"line":89,"type":"switch","locations":[{"start":{"line":90,"column":12},"end":{"line":103,"column":22},"skip":true},{"start":{"line":105,"column":12},"end":{"line":106,"column":22},"skip":true}]},"11":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":20},"end":{"line":89,"column":25},"skip":true},{"start":{"line":89,"column":29},"end":{"line":89,"column":48},"skip":true},{"start":{"line":89,"column":52},"end":{"line":89,"column":74},"skip":true}]},"12":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true},{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true}]},"13":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true},{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true}]},"14":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":16},"end":{"line":108,"column":61},"skip":true},{"start":{"line":108,"column":66},"end":{"line":108,"column":72},"skip":true},{"start":{"line":108,"column":77},"end":{"line":108,"column":82},"skip":true},{"start":{"line":109,"column":20},"end":{"line":109,"column":39},"skip":true},{"start":{"line":110,"column":20},"end":{"line":110,"column":49},"skip":true},{"start":{"line":111,"column":20},"end":{"line":111,"column":58},"skip":true},{"start":{"line":112,"column":20},"end":{"line":112,"column":68},"skip":true}]},"15":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true},{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true}]},"16":{"line":134,"type":"cond-expr","locations":[{"start":{"line":135,"column":26},"end":{"line":135,"column":29},"skip":true},{"start":{"line":136,"column":26},"end":{"line":136,"column":54},"skip":true}]},"17":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":27},"end":{"line":164,"column":43},"skip":true},{"start":{"line":164,"column":47},"end":{"line":164,"column":49},"skip":true}]},"18":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true},{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true}]},"19":{"line":275,"type":"switch","locations":[{"start":{"line":276,"column":20},"end":{"line":277,"column":64},"skip":true},{"start":{"line":278,"column":20},"end":{"line":279,"column":40},"skip":true},{"start":{"line":280,"column":20},"end":{"line":281,"column":40},"skip":true},{"start":{"line":282,"column":20},"end":{"line":283,"column":39},"skip":true}]},"20":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true},{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true}]},"21":{"line":288,"type":"binary-expr","locations":[{"start":{"line":288,"column":12},"end":{"line":288,"column":40},"skip":true},{"start":{"line":288,"column":44},"end":{"line":288,"column":67},"skip":true}]},"22":{"line":292,"type":"binary-expr","locations":[{"start":{"line":292,"column":12},"end":{"line":292,"column":50},"skip":true},{"start":{"line":293,"column":12},"end":{"line":293,"column":53},"skip":true}]},"23":{"line":297,"type":"binary-expr","locations":[{"start":{"line":297,"column":12},"end":{"line":297,"column":64},"skip":true},{"start":{"line":298,"column":12},"end":{"line":301,"column":36},"skip":true}]},"24":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":43},"end":{"line":303,"column":75},"skip":true},{"start":{"line":303,"column":79},"end":{"line":303,"column":81},"skip":true}]},"25":{"line":306,"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true},{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true}]},"26":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true},{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true}]},"27":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":27},"end":{"line":313,"column":43},"skip":true},{"start":{"line":313,"column":47},"end":{"line":313,"column":53},"skip":true}]},"28":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true},{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true}]}},"code":["/*","example.js","","quickstart example","","instruction","    1. save this script as example.js","    2. run the shell command:","        $ npm install npmtest-pomelo && PORT=8081 node example.js","    3. play with the browser-demo on http://127.0.0.1:8081","*/","","","","/* istanbul instrument in package npmtest_pomelo */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - pre-init","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || (local.modeJs === 'browser'","            ? local.global.utility2_npmtest_pomelo","            : global.utility2_moduleExports);","        // export local","        local.global.local = local;","    }());","    switch (local.modeJs) {","","","","    // post-init","    // run browser js-env code - post-init","    /* istanbul ignore next */","    case 'browser':","        local.testRunBrowser = function (event) {","            if (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('onreset'))) {","                // reset output","                Array.from(","                    document.querySelectorAll('body > .resettable')","                ).forEach(function (element) {","                    switch (element.tagName) {","                    case 'INPUT':","                    case 'TEXTAREA':","                        element.value = '';","                        break;","                    default:","                        element.textContent = '';","                    }","                });","            }","            switch (event && event.currentTarget && event.currentTarget.id) {","            case 'testRunButton1':","                // show tests","                if (document.querySelector('#testReportDiv1').style.display === 'none') {","                    document.querySelector('#testReportDiv1').style.display = 'block';","                    document.querySelector('#testRunButton1').textContent =","                        'hide internal test';","                    local.modeTest = true;","                    local.testRunDefault(local);","                // hide tests","                } else {","                    document.querySelector('#testReportDiv1').style.display = 'none';","                    document.querySelector('#testRunButton1').textContent = 'run internal test';","                }","                break;","            // custom-case","            default:","                break;","            }","            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('oneval')))) {","                // try to eval input-code","                try {","                    /*jslint evil: true*/","                    eval(document.querySelector('#inputTextareaEval1').value);","                } catch (errorCaught) {","                    console.error(errorCaught);","                }","            }","        };","        // log stderr and stdout to #outputTextareaStdout1","        ['error', 'log'].forEach(function (key) {","            console[key + '_original'] = console[key];","            console[key] = function () {","                var element;","                console[key + '_original'].apply(console, arguments);","                element = document.querySelector('#outputTextareaStdout1');","                if (!element) {","                    return;","                }","                // append text to #outputTextareaStdout1","                element.value += Array.from(arguments).map(function (arg) {","                    return typeof arg === 'string'","                        ? arg","                        : JSON.stringify(arg, null, 4);","                }).join(' ') + '\\n';","                // scroll textarea to bottom","                element.scrollTop = element.scrollHeight;","            };","        });","        // init event-handling","        ['change', 'click', 'keyup'].forEach(function (event) {","            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {","                element.addEventListener(event, local.testRunBrowser);","            });","        });","        // run tests","        local.testRunBrowser();","        break;","","","","    // run node js-env code - post-init","    /* istanbul ignore next */","    case 'node':","        // export local","        module.exports = local;","        // require modules","        local.fs = require('fs');","        local.http = require('http');","        local.url = require('url');","        // init assets","        local.assetsDict = local.assetsDict || {};","        /* jslint-ignore-begin */","        local.assetsDict['/assets.index.template.html'] = '\\","<!doctype html>\\n\\","<html lang=\"en\">\\n\\","<head>\\n\\","<meta charset=\"UTF-8\">\\n\\","<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\","<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\","<style>\\n\\","/*csslint\\n\\","    box-sizing: false,\\n\\","    universal-selector: false\\n\\","*/\\n\\","* {\\n\\","    box-sizing: border-box;\\n\\","}\\n\\","body {\\n\\","    background: #dde;\\n\\","    font-family: Arial, Helvetica, sans-serif;\\n\\","    margin: 2rem;\\n\\","}\\n\\","body > * {\\n\\","    margin-bottom: 1rem;\\n\\","}\\n\\",".utility2FooterDiv {\\n\\","    margin-top: 20px;\\n\\","    text-align: center;\\n\\","}\\n\\","</style>\\n\\","<style>\\n\\","/*csslint\\n\\","*/\\n\\","textarea {\\n\\","    font-family: monospace;\\n\\","    height: 10rem;\\n\\","    width: 100%;\\n\\","}\\n\\","textarea[readonly] {\\n\\","    background: #ddd;\\n\\","}\\n\\","</style>\\n\\","</head>\\n\\","<body>\\n\\","<!-- utility2-comment\\n\\","<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\","utility2-comment -->\\n\\","<h1>\\n\\","<!-- utility2-comment\\n\\","    <a\\n\\","        {{#if env.npm_package_homepage}}\\n\\","        href=\"{{env.npm_package_homepage}}\"\\n\\","        {{/if env.npm_package_homepage}}\\n\\","        target=\"_blank\"\\n\\","    >\\n\\","utility2-comment -->\\n\\","        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\","<!-- utility2-comment\\n\\","    </a>\\n\\","utility2-comment -->\\n\\","</h1>\\n\\","<h3>{{env.npm_package_description}}</h3>\\n\\","<!-- utility2-comment\\n\\","<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\","<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\","<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\","utility2-comment -->\\n\\","\\n\\","\\n\\","\\n\\","<label>stderr and stdout</label>\\n\\","<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\","<!-- utility2-comment\\n\\","{{#if isRollup}}\\n\\","<script src=\"assets.app.js\"></script>\\n\\","{{#unless isRollup}}\\n\\","utility2-comment -->\\n\\","<script src=\"assets.utility2.rollup.js\"></script>\\n\\","<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\","<script src=\"assets.npmtest_pomelo.rollup.js\"></script>\\n\\","<script src=\"assets.example.js\"></script>\\n\\","<script src=\"assets.test.js\"></script>\\n\\","<!-- utility2-comment\\n\\","{{/if isRollup}}\\n\\","utility2-comment -->\\n\\","<div class=\"utility2FooterDiv\">\\n\\","    [ this app was created with\\n\\","    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\","    ]\\n\\","</div>\\n\\","</body>\\n\\","</html>\\n\\","';","        /* jslint-ignore-end */","        if (local.templateRender) {","            local.assetsDict['/'] = local.templateRender(","                local.assetsDict['/assets.index.template.html'],","                {","                    env: local.objectSetDefault(local.env, {","                        npm_package_description: 'the greatest app in the world!',","                        npm_package_name: 'my-app',","                        npm_package_nameAlias: 'my_app',","                        npm_package_version: '0.0.1'","                    })","                }","            );","        } else {","            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']","                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {","                    // jslint-hack","                    String(match0);","                    switch (match1) {","                    case 'npm_package_description':","                        return 'the greatest app in the world!';","                    case 'npm_package_name':","                        return 'my-app';","                    case 'npm_package_nameAlias':","                        return 'my_app';","                    case 'npm_package_version':","                        return '0.0.1';","                    }","                });","        }","        // run the cli","        if (local.global.utility2_rollup || module !== require.main) {","            break;","        }","        local.assetsDict['/assets.example.js'] =","            local.assetsDict['/assets.example.js'] ||","            local.fs.readFileSync(__filename, 'utf8');","        // bug-workaround - long $npm_package_buildCustomOrg","        /* jslint-ignore-begin */","        local.assetsDict['/assets.npmtest_pomelo.rollup.js'] =","            local.assetsDict['/assets.npmtest_pomelo.rollup.js'] ||","            local.fs.readFileSync(","                local.npmtest_pomelo.__dirname + '/lib.npmtest_pomelo.js',","                'utf8'","            ).replace((/^#!/), '//');","        /* jslint-ignore-end */","        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';","        // if $npm_config_timeout_exit exists,","        // then exit this process after $npm_config_timeout_exit ms","        if (Number(process.env.npm_config_timeout_exit)) {","            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));","        }","        // start server","        if (local.global.utility2_serverHttp1) {","            break;","        }","        process.env.PORT = process.env.PORT || '8081';","        console.error('server starting on port ' + process.env.PORT);","        local.http.createServer(function (request, response) {","            request.urlParsed = local.url.parse(request.url);","            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {","                response.end(local.assetsDict[request.urlParsed.pathname]);","                return;","            }","            response.statusCode = 404;","            response.end();","        }).listen(process.env.PORT);","        break;","    }","}());",""],"l":{"26":2,"28":2,"33":2,"35":2,"37":2,"38":2,"39":2,"44":1,"51":2,"55":2,"59":2,"61":2,"69":1,"70":2,"76":2,"79":2,"82":2,"83":2,"85":1,"89":2,"92":1,"93":1,"94":1,"96":1,"97":1,"100":1,"101":1,"103":1,"106":1,"108":2,"114":1,"116":1,"118":1,"123":1,"124":2,"125":2,"126":3,"127":3,"128":3,"129":3,"130":1,"133":3,"134":3,"139":3,"143":1,"144":3,"145":1,"149":1,"150":1,"158":1,"160":1,"161":1,"162":1,"164":1,"166":1,"258":1,"259":1,"271":1,"274":6,"275":6,"277":1,"279":2,"281":1,"283":2,"288":1,"289":1,"291":1,"296":1,"303":1,"306":1,"307":1,"310":1,"311":1,"313":1,"314":1,"315":1,"316":1,"317":1,"318":1,"319":1,"321":1,"322":1,"324":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}}},"branchMap":{},"code":["module.exports = require('./lib/pomelo');"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/pomelo.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/pomelo.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":2,"22":2,"23":0,"24":0,"25":1,"26":0,"27":1,"28":13,"29":0,"30":13,"31":13,"32":13,"33":13,"34":1,"35":4,"36":0,"37":4,"38":4,"39":4,"40":4,"41":1,"42":2,"43":0,"44":2,"45":2,"46":2,"47":1,"48":428,"49":340,"50":88},"b":{"1":[0,13],"2":[0,4],"3":[0,2],"4":[340,88]},"f":{"1":2,"2":0,"3":13,"4":4,"5":2,"6":428},"fnMap":{"1":{"name":"(anonymous_1)","line":74,"loc":{"start":{"line":74,"column":19},"end":{"line":74,"column":35}}},"2":{"name":"(anonymous_2)","line":85,"loc":{"start":{"line":85,"column":6},"end":{"line":85,"column":18}}},"3":{"name":"(anonymous_3)","line":93,"loc":{"start":{"line":93,"column":50},"end":{"line":93,"column":70}}},"4":{"name":"(anonymous_4)","line":104,"loc":{"start":{"line":104,"column":55},"end":{"line":104,"column":75}}},"5":{"name":"(anonymous_5)","line":115,"loc":{"start":{"line":115,"column":51},"end":{"line":115,"column":71}}},"6":{"name":"load","line":125,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":26}}}},"statementMap":{"1":{"start":{"line":10,"column":0},"end":{"line":10,"column":23}},"2":{"start":{"line":11,"column":0},"end":{"line":11,"column":27}},"3":{"start":{"line":12,"column":0},"end":{"line":12,"column":43}},"4":{"start":{"line":13,"column":0},"end":{"line":13,"column":36}},"5":{"start":{"line":21,"column":0},"end":{"line":21,"column":33}},"6":{"start":{"line":27,"column":0},"end":{"line":27,"column":33}},"7":{"start":{"line":32,"column":0},"end":{"line":32,"column":41}},"8":{"start":{"line":37,"column":0},"end":{"line":37,"column":23}},"9":{"start":{"line":42,"column":0},"end":{"line":42,"column":20}},"10":{"start":{"line":47,"column":0},"end":{"line":47,"column":23}},"11":{"start":{"line":52,"column":0},"end":{"line":52,"column":23}},"12":{"start":{"line":53,"column":0},"end":{"line":53,"column":97}},"13":{"start":{"line":54,"column":0},"end":{"line":54,"column":103}},"14":{"start":{"line":55,"column":0},"end":{"line":55,"column":97}},"15":{"start":{"line":56,"column":0},"end":{"line":56,"column":99}},"16":{"start":{"line":61,"column":0},"end":{"line":61,"column":27}},"17":{"start":{"line":62,"column":0},"end":{"line":62,"column":93}},"18":{"start":{"line":63,"column":0},"end":{"line":63,"column":93}},"19":{"start":{"line":65,"column":0},"end":{"line":65,"column":16}},"20":{"start":{"line":74,"column":0},"end":{"line":79,"column":2}},"21":{"start":{"line":75,"column":2},"end":{"line":75,"column":24}},"22":{"start":{"line":76,"column":2},"end":{"line":76,"column":17}},"23":{"start":{"line":77,"column":2},"end":{"line":77,"column":17}},"24":{"start":{"line":78,"column":2},"end":{"line":78,"column":13}},"25":{"start":{"line":84,"column":0},"end":{"line":88,"column":3}},"26":{"start":{"line":86,"column":4},"end":{"line":86,"column":20}},"27":{"start":{"line":93,"column":0},"end":{"line":102,"column":3}},"28":{"start":{"line":94,"column":2},"end":{"line":96,"column":3}},"29":{"start":{"line":95,"column":4},"end":{"line":95,"column":11}},"30":{"start":{"line":97,"column":2},"end":{"line":97,"column":44}},"31":{"start":{"line":98,"column":2},"end":{"line":98,"column":53}},"32":{"start":{"line":100,"column":2},"end":{"line":100,"column":50}},"33":{"start":{"line":101,"column":2},"end":{"line":101,"column":39}},"34":{"start":{"line":104,"column":0},"end":{"line":113,"column":3}},"35":{"start":{"line":105,"column":2},"end":{"line":107,"column":3}},"36":{"start":{"line":106,"column":4},"end":{"line":106,"column":11}},"37":{"start":{"line":108,"column":2},"end":{"line":108,"column":44}},"38":{"start":{"line":109,"column":2},"end":{"line":109,"column":58}},"39":{"start":{"line":111,"column":2},"end":{"line":111,"column":47}},"40":{"start":{"line":112,"column":2},"end":{"line":112,"column":39}},"41":{"start":{"line":115,"column":0},"end":{"line":123,"column":3}},"42":{"start":{"line":116,"column":2},"end":{"line":118,"column":3}},"43":{"start":{"line":117,"column":4},"end":{"line":117,"column":11}},"44":{"start":{"line":119,"column":2},"end":{"line":119,"column":44}},"45":{"start":{"line":120,"column":2},"end":{"line":120,"column":54}},"46":{"start":{"line":122,"column":2},"end":{"line":122,"column":50}},"47":{"start":{"line":125,"column":0},"end":{"line":130,"column":1}},"48":{"start":{"line":126,"column":2},"end":{"line":128,"column":3}},"49":{"start":{"line":127,"column":4},"end":{"line":127,"column":32}},"50":{"start":{"line":129,"column":2},"end":{"line":129,"column":23}}},"branchMap":{"1":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":2},"end":{"line":94,"column":2}},{"start":{"line":94,"column":2},"end":{"line":94,"column":2}}]},"2":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"3":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":2},"end":{"line":116,"column":2}},{"start":{"line":116,"column":2},"end":{"line":116,"column":2}}]},"4":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":2},"end":{"line":126,"column":2}},{"start":{"line":126,"column":2},"end":{"line":126,"column":2}}]}},"code":["/*!"," * Pomelo"," * Copyright(c) 2012 xiechengchao <xiecc@163.com>"," * MIT Licensed"," */","","/**"," * Module dependencies."," */","var fs = require('fs');","var path = require('path');","var application = require('./application');","var Package = require('../package');","","/**"," * Expose `createApplication()`."," *"," * @module"," */","","var Pomelo = module.exports = {};","","/**"," * Framework version."," */","","Pomelo.version = Package.version;","","/**"," * Event definitions that would be emitted by app.event"," */","Pomelo.events = require('./util/events');","","/**"," * auto loaded components"," */","Pomelo.components = {};","","/**"," * auto loaded filters"," */","Pomelo.filters = {};","","/**"," * auto loaded rpc filters"," */","Pomelo.rpcFilters = {};","","/**"," * connectors"," */","Pomelo.connectors = {};","Pomelo.connectors.__defineGetter__('sioconnector', load.bind(null, './connectors/sioconnector'));","Pomelo.connectors.__defineGetter__('hybridconnector', load.bind(null, './connectors/hybridconnector'));","Pomelo.connectors.__defineGetter__('udpconnector', load.bind(null, './connectors/udpconnector'));","Pomelo.connectors.__defineGetter__('mqttconnector', load.bind(null, './connectors/mqttconnector'));","","/**"," * pushSchedulers"," */","Pomelo.pushSchedulers = {};","Pomelo.pushSchedulers.__defineGetter__('direct', load.bind(null, './pushSchedulers/direct'));","Pomelo.pushSchedulers.__defineGetter__('buffer', load.bind(null, './pushSchedulers/buffer'));","","var self = this;","","/**"," * Create an pomelo application."," *"," * @return {Application}"," * @memberOf Pomelo"," * @api public"," */","Pomelo.createApp = function (opts) {","  var app = application;","  app.init(opts);","  self.app = app;","  return app;","};","","/**"," * Get application"," */","Object.defineProperty(Pomelo, 'app', {","  get:function () {","    return self.app;","  }","});","","/**"," * Auto-load bundled components with getters."," */","fs.readdirSync(__dirname + '/components').forEach(function (filename) {","  if (!/\\.js$/.test(filename)) {","    return;","  }","  var name = path.basename(filename, '.js');","  var _load = load.bind(null, './components/', name);","  ","  Pomelo.components.__defineGetter__(name, _load);","  Pomelo.__defineGetter__(name, _load);","});","","fs.readdirSync(__dirname + '/filters/handler').forEach(function (filename) {","  if (!/\\.js$/.test(filename)) {","    return;","  }","  var name = path.basename(filename, '.js');","  var _load = load.bind(null, './filters/handler/', name);","  ","  Pomelo.filters.__defineGetter__(name, _load);","  Pomelo.__defineGetter__(name, _load);","});","","fs.readdirSync(__dirname + '/filters/rpc').forEach(function (filename) {","  if (!/\\.js$/.test(filename)) {","    return;","  }","  var name = path.basename(filename, '.js');","  var _load = load.bind(null, './filters/rpc/', name);","  ","  Pomelo.rpcFilters.__defineGetter__(name, _load);","});","","function load(path, name) {","  if (name) {","    return require(path + name);","  }","  return require(path);","}",""],"l":{"10":1,"11":1,"12":1,"13":1,"21":1,"27":1,"32":1,"37":1,"42":1,"47":1,"52":1,"53":1,"54":1,"55":1,"56":1,"61":1,"62":1,"63":1,"65":1,"74":1,"75":2,"76":2,"77":0,"78":0,"84":1,"86":0,"93":1,"94":13,"95":0,"97":13,"98":13,"100":13,"101":13,"104":1,"105":4,"106":0,"108":4,"109":4,"111":4,"112":4,"115":1,"116":2,"117":0,"119":2,"120":2,"122":2,"125":1,"126":428,"127":340,"129":88}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/application.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/application.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":2,"17":2,"18":2,"19":2,"20":2,"21":2,"22":2,"23":2,"24":2,"25":2,"26":2,"27":2,"28":2,"29":2,"30":2,"31":2,"32":2,"33":2,"34":0,"35":0,"36":1,"37":8,"38":1,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":1,"55":0,"56":1,"57":0,"58":1,"59":0,"60":0,"61":1,"62":0,"63":1,"64":0,"65":1,"66":0,"67":1,"68":0,"69":1,"70":0,"71":0,"72":1,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":1,"91":4,"92":4,"93":4,"94":4,"95":4,"96":4,"97":0,"98":0,"99":0,"100":0,"101":0,"102":4,"103":0,"104":0,"105":0,"106":4,"107":4,"108":0,"109":0,"110":0,"111":0,"112":1,"113":0,"114":0,"115":0,"116":0,"117":0,"118":1,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":1,"126":0,"127":0,"128":0,"129":1,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":1,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":1,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":1,"190":6,"191":0,"192":6,"193":6,"194":4,"195":6,"196":1,"197":16,"198":1,"199":0,"200":1,"201":0,"202":1,"203":0,"204":1,"205":0,"206":1,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":1,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":1,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":1,"263":0,"264":1,"265":2,"266":1,"267":0,"268":1,"269":0,"270":1,"271":0,"272":1,"273":0,"274":1,"275":0,"276":1,"277":0,"278":1,"279":0,"280":1,"281":0,"282":1,"283":0,"284":1,"285":0,"286":0,"287":1,"288":0,"289":0,"290":1,"291":0,"292":1,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":1,"307":0,"308":0,"309":0,"310":0,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"319":1,"320":0,"321":0,"322":0,"323":0,"324":0,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"331":0,"332":0,"333":0,"334":0,"335":0,"336":0,"337":1,"338":0,"339":0,"340":0,"341":0,"342":1,"343":0,"344":0,"345":0,"346":0,"347":1,"348":0,"349":0,"350":0,"351":0,"352":0,"353":1,"354":0,"355":0,"356":0,"357":0,"358":0,"359":0,"360":1,"361":0,"362":0,"363":0,"364":0,"365":0,"366":0,"367":0,"368":1,"369":0,"370":0,"371":0,"372":0,"373":1,"374":0,"375":0,"376":0,"377":0,"378":0},"b":{"1":[2,2],"2":[2,2],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,4],"15":[0,0],"16":[0,4],"17":[0,4],"18":[4,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,6],"36":[4,2],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0],"78":[0,0],"79":[0,0],"80":[0,0],"81":[0,0],"82":[0,0]},"f":{"1":2,"2":8,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":4,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":6,"33":16,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":2,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0},"fnMap":{"1":{"name":"(anonymous_1)","line":40,"loc":{"start":{"line":40,"column":19},"end":{"line":40,"column":34}}},"2":{"name":"(anonymous_2)","line":80,"loc":{"start":{"line":80,"column":22},"end":{"line":80,"column":33}}},"3":{"name":"(anonymous_3)","line":91,"loc":{"start":{"line":91,"column":22},"end":{"line":91,"column":35}}},"4":{"name":"(anonymous_4)","line":102,"loc":{"start":{"line":102,"column":30},"end":{"line":102,"column":47}}},"5":{"name":"(anonymous_5)","line":125,"loc":{"start":{"line":125,"column":21},"end":{"line":125,"column":39}}},"6":{"name":"(anonymous_6)","line":136,"loc":{"start":{"line":136,"column":21},"end":{"line":136,"column":35}}},"7":{"name":"(anonymous_7)","line":146,"loc":{"start":{"line":146,"column":20},"end":{"line":146,"column":34}}},"8":{"name":"(anonymous_8)","line":157,"loc":{"start":{"line":157,"column":27},"end":{"line":157,"column":45}}},"9":{"name":"(anonymous_9)","line":168,"loc":{"start":{"line":168,"column":27},"end":{"line":168,"column":41}}},"10":{"name":"(anonymous_10)","line":178,"loc":{"start":{"line":178,"column":26},"end":{"line":178,"column":40}}},"11":{"name":"(anonymous_11)","line":188,"loc":{"start":{"line":188,"column":24},"end":{"line":188,"column":37}}},"12":{"name":"(anonymous_12)","line":198,"loc":{"start":{"line":198,"column":23},"end":{"line":198,"column":36}}},"13":{"name":"(anonymous_13)","line":209,"loc":{"start":{"line":209,"column":24},"end":{"line":209,"column":41}}},"14":{"name":"(anonymous_14)","line":223,"loc":{"start":{"line":223,"column":19},"end":{"line":223,"column":51}}},"15":{"name":"(anonymous_15)","line":265,"loc":{"start":{"line":265,"column":32},"end":{"line":265,"column":60}}},"16":{"name":"(anonymous_16)","line":287,"loc":{"start":{"line":287,"column":23},"end":{"line":287,"column":50}}},"17":{"name":"(anonymous_17)","line":304,"loc":{"start":{"line":304,"column":25},"end":{"line":304,"column":44}}},"18":{"name":"(anonymous_18)","line":331,"loc":{"start":{"line":331,"column":20},"end":{"line":331,"column":52}}},"19":{"name":"(anonymous_19)","line":348,"loc":{"start":{"line":348,"column":29},"end":{"line":348,"column":43}}},"20":{"name":"(anonymous_20)","line":361,"loc":{"start":{"line":361,"column":21},"end":{"line":361,"column":34}}},"21":{"name":"(anonymous_21)","line":369,"loc":{"start":{"line":369,"column":28},"end":{"line":369,"column":39}}},"22":{"name":"(anonymous_22)","line":371,"loc":{"start":{"line":371,"column":18},"end":{"line":371,"column":29}}},"23":{"name":"(anonymous_23)","line":372,"loc":{"start":{"line":372,"column":67},"end":{"line":372,"column":81}}},"24":{"name":"(anonymous_24)","line":397,"loc":{"start":{"line":397,"column":25},"end":{"line":397,"column":38}}},"25":{"name":"(anonymous_25)","line":405,"loc":{"start":{"line":405,"column":69},"end":{"line":405,"column":83}}},"26":{"name":"(anonymous_26)","line":412,"loc":{"start":{"line":412,"column":32},"end":{"line":412,"column":43}}},"27":{"name":"(anonymous_27)","line":429,"loc":{"start":{"line":429,"column":19},"end":{"line":429,"column":35}}},"28":{"name":"(anonymous_28)","line":437,"loc":{"start":{"line":437,"column":30},"end":{"line":437,"column":41}}},"29":{"name":"(anonymous_29)","line":441,"loc":{"start":{"line":441,"column":27},"end":{"line":441,"column":37}}},"30":{"name":"(anonymous_30)","line":446,"loc":{"start":{"line":446,"column":17},"end":{"line":446,"column":28}}},"31":{"name":"(anonymous_31)","line":447,"loc":{"start":{"line":447,"column":45},"end":{"line":447,"column":56}}},"32":{"name":"(anonymous_32)","line":484,"loc":{"start":{"line":484,"column":18},"end":{"line":484,"column":50}}},"33":{"name":"(anonymous_33)","line":502,"loc":{"start":{"line":502,"column":18},"end":{"line":502,"column":37}}},"34":{"name":"(anonymous_34)","line":513,"loc":{"start":{"line":513,"column":22},"end":{"line":513,"column":41}}},"35":{"name":"(anonymous_35)","line":524,"loc":{"start":{"line":524,"column":23},"end":{"line":524,"column":42}}},"36":{"name":"(anonymous_36)","line":535,"loc":{"start":{"line":535,"column":21},"end":{"line":535,"column":40}}},"37":{"name":"(anonymous_37)","line":546,"loc":{"start":{"line":546,"column":22},"end":{"line":546,"column":41}}},"38":{"name":"(anonymous_38)","line":576,"loc":{"start":{"line":576,"column":24},"end":{"line":576,"column":49}}},"39":{"name":"(anonymous_39)","line":604,"loc":{"start":{"line":604,"column":28},"end":{"line":604,"column":61}}},"40":{"name":"(anonymous_40)","line":637,"loc":{"start":{"line":637,"column":18},"end":{"line":637,"column":41}}},"41":{"name":"(anonymous_41)","line":652,"loc":{"start":{"line":652,"column":44},"end":{"line":652,"column":64}}},"42":{"name":"(anonymous_42)","line":675,"loc":{"start":{"line":675,"column":42},"end":{"line":675,"column":62}}},"43":{"name":"(anonymous_43)","line":699,"loc":{"start":{"line":699,"column":26},"end":{"line":699,"column":70}}},"44":{"name":"(anonymous_44)","line":709,"loc":{"start":{"line":709,"column":24},"end":{"line":709,"column":35}}},"45":{"name":"(anonymous_45)","line":719,"loc":{"start":{"line":719,"column":27},"end":{"line":719,"column":38}}},"46":{"name":"(anonymous_46)","line":729,"loc":{"start":{"line":729,"column":26},"end":{"line":729,"column":37}}},"47":{"name":"(anonymous_47)","line":739,"loc":{"start":{"line":739,"column":28},"end":{"line":739,"column":39}}},"48":{"name":"(anonymous_48)","line":749,"loc":{"start":{"line":749,"column":25},"end":{"line":749,"column":36}}},"49":{"name":"(anonymous_49)","line":759,"loc":{"start":{"line":759,"column":35},"end":{"line":759,"column":46}}},"50":{"name":"(anonymous_50)","line":769,"loc":{"start":{"line":769,"column":29},"end":{"line":769,"column":40}}},"51":{"name":"(anonymous_51)","line":780,"loc":{"start":{"line":780,"column":28},"end":{"line":780,"column":47}}},"52":{"name":"(anonymous_52)","line":792,"loc":{"start":{"line":792,"column":34},"end":{"line":792,"column":53}}},"53":{"name":"(anonymous_53)","line":803,"loc":{"start":{"line":803,"column":31},"end":{"line":803,"column":52}}},"54":{"name":"(anonymous_54)","line":816,"loc":{"start":{"line":816,"column":25},"end":{"line":816,"column":42}}},"55":{"name":"(anonymous_55)","line":829,"loc":{"start":{"line":829,"column":24},"end":{"line":829,"column":41}}},"56":{"name":"(anonymous_56)","line":840,"loc":{"start":{"line":840,"column":23},"end":{"line":840,"column":34}}},"57":{"name":"(anonymous_57)","line":850,"loc":{"start":{"line":850,"column":25},"end":{"line":850,"column":43}}},"58":{"name":"(anonymous_58)","line":882,"loc":{"start":{"line":882,"column":28},"end":{"line":882,"column":42}}},"59":{"name":"(anonymous_59)","line":911,"loc":{"start":{"line":911,"column":29},"end":{"line":911,"column":47}}},"60":{"name":"(anonymous_60)","line":943,"loc":{"start":{"line":943,"column":23},"end":{"line":943,"column":39}}},"61":{"name":"(anonymous_61)","line":957,"loc":{"start":{"line":957,"column":26},"end":{"line":957,"column":42}}},"62":{"name":"(anonymous_62)","line":965,"loc":{"start":{"line":965,"column":20},"end":{"line":965,"column":48}}},"63":{"name":"(anonymous_63)","line":975,"loc":{"start":{"line":975,"column":19},"end":{"line":975,"column":39}}},"64":{"name":"(anonymous_64)","line":988,"loc":{"start":{"line":988,"column":15},"end":{"line":988,"column":39}}},"65":{"name":"(anonymous_65)","line":1002,"loc":{"start":{"line":1002,"column":17},"end":{"line":1002,"column":38}}},"66":{"name":"(anonymous_66)","line":1011,"loc":{"start":{"line":1011,"column":16},"end":{"line":1011,"column":44}}}},"statementMap":{"1":{"start":{"line":10,"column":0},"end":{"line":10,"column":36}},"2":{"start":{"line":11,"column":0},"end":{"line":11,"column":70}},"3":{"start":{"line":12,"column":0},"end":{"line":12,"column":50}},"4":{"start":{"line":13,"column":0},"end":{"line":13,"column":38}},"5":{"start":{"line":14,"column":0},"end":{"line":14,"column":40}},"6":{"start":{"line":15,"column":0},"end":{"line":15,"column":44}},"7":{"start":{"line":16,"column":0},"end":{"line":16,"column":56}},"8":{"start":{"line":17,"column":0},"end":{"line":17,"column":23}},"9":{"start":{"line":18,"column":0},"end":{"line":18,"column":27}},"10":{"start":{"line":25,"column":0},"end":{"line":25,"column":38}},"11":{"start":{"line":30,"column":0},"end":{"line":30,"column":22}},"12":{"start":{"line":31,"column":0},"end":{"line":31,"column":20}},"13":{"start":{"line":32,"column":0},"end":{"line":32,"column":22}},"14":{"start":{"line":33,"column":0},"end":{"line":33,"column":22}},"15":{"start":{"line":40,"column":0},"end":{"line":67,"column":2}},"16":{"start":{"line":41,"column":2},"end":{"line":41,"column":20}},"17":{"start":{"line":42,"column":2},"end":{"line":42,"column":19}},"18":{"start":{"line":43,"column":2},"end":{"line":43,"column":23}},"19":{"start":{"line":44,"column":2},"end":{"line":44,"column":21}},"20":{"start":{"line":45,"column":2},"end":{"line":45,"column":62}},"21":{"start":{"line":46,"column":2},"end":{"line":46,"column":48}},"22":{"start":{"line":47,"column":2},"end":{"line":47,"column":34}},"23":{"start":{"line":50,"column":2},"end":{"line":50,"column":23}},"24":{"start":{"line":51,"column":2},"end":{"line":51,"column":25}},"25":{"start":{"line":52,"column":2},"end":{"line":52,"column":24}},"26":{"start":{"line":53,"column":2},"end":{"line":53,"column":24}},"27":{"start":{"line":56,"column":2},"end":{"line":56,"column":21}},"28":{"start":{"line":57,"column":2},"end":{"line":57,"column":20}},"29":{"start":{"line":58,"column":2},"end":{"line":58,"column":27}},"30":{"start":{"line":59,"column":2},"end":{"line":59,"column":24}},"31":{"start":{"line":60,"column":2},"end":{"line":60,"column":25}},"32":{"start":{"line":61,"column":2},"end":{"line":61,"column":23}},"33":{"start":{"line":63,"column":2},"end":{"line":63,"column":37}},"34":{"start":{"line":65,"column":2},"end":{"line":65,"column":28}},"35":{"start":{"line":66,"column":2},"end":{"line":66,"column":60}},"36":{"start":{"line":80,"column":0},"end":{"line":82,"column":2}},"37":{"start":{"line":81,"column":2},"end":{"line":81,"column":43}},"38":{"start":{"line":91,"column":0},"end":{"line":93,"column":2}},"39":{"start":{"line":92,"column":2},"end":{"line":92,"column":55}},"40":{"start":{"line":102,"column":0},"end":{"line":116,"column":2}},"41":{"start":{"line":103,"column":2},"end":{"line":115,"column":3}},"42":{"start":{"line":104,"column":4},"end":{"line":104,"column":30}},"43":{"start":{"line":105,"column":4},"end":{"line":105,"column":47}},"44":{"start":{"line":106,"column":4},"end":{"line":106,"column":61}},"45":{"start":{"line":107,"column":4},"end":{"line":107,"column":113}},"46":{"start":{"line":108,"column":4},"end":{"line":114,"column":5}},"47":{"start":{"line":109,"column":6},"end":{"line":109,"column":74}},"48":{"start":{"line":110,"column":11},"end":{"line":114,"column":5}},"49":{"start":{"line":111,"column":6},"end":{"line":111,"column":75}},"50":{"start":{"line":113,"column":6},"end":{"line":113,"column":63}},"51":{"start":{"line":125,"column":0},"end":{"line":128,"column":2}},"52":{"start":{"line":126,"column":2},"end":{"line":126,"column":22}},"53":{"start":{"line":127,"column":2},"end":{"line":127,"column":21}},"54":{"start":{"line":136,"column":0},"end":{"line":138,"column":2}},"55":{"start":{"line":137,"column":2},"end":{"line":137,"column":56}},"56":{"start":{"line":146,"column":0},"end":{"line":148,"column":2}},"57":{"start":{"line":147,"column":2},"end":{"line":147,"column":55}},"58":{"start":{"line":157,"column":0},"end":{"line":160,"column":2}},"59":{"start":{"line":158,"column":2},"end":{"line":158,"column":28}},"60":{"start":{"line":159,"column":2},"end":{"line":159,"column":27}},"61":{"start":{"line":168,"column":0},"end":{"line":170,"column":2}},"62":{"start":{"line":169,"column":2},"end":{"line":169,"column":63}},"63":{"start":{"line":178,"column":0},"end":{"line":180,"column":2}},"64":{"start":{"line":179,"column":2},"end":{"line":179,"column":62}},"65":{"start":{"line":188,"column":0},"end":{"line":190,"column":2}},"66":{"start":{"line":189,"column":2},"end":{"line":189,"column":60}},"67":{"start":{"line":198,"column":0},"end":{"line":200,"column":2}},"68":{"start":{"line":199,"column":2},"end":{"line":199,"column":59}},"69":{"start":{"line":209,"column":0},"end":{"line":212,"column":2}},"70":{"start":{"line":210,"column":2},"end":{"line":210,"column":25}},"71":{"start":{"line":211,"column":2},"end":{"line":211,"column":24}},"72":{"start":{"line":223,"column":0},"end":{"line":254,"column":2}},"73":{"start":{"line":224,"column":2},"end":{"line":231,"column":3}},"74":{"start":{"line":225,"column":4},"end":{"line":225,"column":21}},"75":{"start":{"line":226,"column":4},"end":{"line":226,"column":21}},"76":{"start":{"line":227,"column":4},"end":{"line":227,"column":16}},"77":{"start":{"line":228,"column":4},"end":{"line":230,"column":5}},"78":{"start":{"line":229,"column":6},"end":{"line":229,"column":28}},"79":{"start":{"line":233,"column":2},"end":{"line":235,"column":3}},"80":{"start":{"line":234,"column":4},"end":{"line":234,"column":38}},"81":{"start":{"line":237,"column":2},"end":{"line":239,"column":3}},"82":{"start":{"line":238,"column":4},"end":{"line":238,"column":26}},"83":{"start":{"line":241,"column":2},"end":{"line":245,"column":3}},"84":{"start":{"line":243,"column":4},"end":{"line":243,"column":56}},"85":{"start":{"line":244,"column":4},"end":{"line":244,"column":11}},"86":{"start":{"line":247,"column":2},"end":{"line":247,"column":30}},"87":{"start":{"line":248,"column":2},"end":{"line":251,"column":3}},"88":{"start":{"line":250,"column":4},"end":{"line":250,"column":38}},"89":{"start":{"line":253,"column":2},"end":{"line":253,"column":14}},"90":{"start":{"line":265,"column":0},"end":{"line":294,"column":2}},"91":{"start":{"line":266,"column":2},"end":{"line":266,"column":18}},"92":{"start":{"line":267,"column":2},"end":{"line":267,"column":45}},"93":{"start":{"line":268,"column":2},"end":{"line":268,"column":57}},"94":{"start":{"line":269,"column":2},"end":{"line":269,"column":109}},"95":{"start":{"line":270,"column":2},"end":{"line":270,"column":15}},"96":{"start":{"line":271,"column":2},"end":{"line":284,"column":3}},"97":{"start":{"line":272,"column":5},"end":{"line":272,"column":27}},"98":{"start":{"line":273,"column":5},"end":{"line":273,"column":36}},"99":{"start":{"line":274,"column":5},"end":{"line":276,"column":6}},"100":{"start":{"line":275,"column":7},"end":{"line":275,"column":24}},"101":{"start":{"line":277,"column":5},"end":{"line":277,"column":25}},"102":{"start":{"line":278,"column":9},"end":{"line":284,"column":3}},"103":{"start":{"line":279,"column":4},"end":{"line":279,"column":27}},"104":{"start":{"line":280,"column":4},"end":{"line":280,"column":37}},"105":{"start":{"line":281,"column":4},"end":{"line":281,"column":25}},"106":{"start":{"line":283,"column":4},"end":{"line":283,"column":66}},"107":{"start":{"line":286,"column":2},"end":{"line":293,"column":3}},"108":{"start":{"line":287,"column":4},"end":{"line":292,"column":7}},"109":{"start":{"line":288,"column":6},"end":{"line":291,"column":7}},"110":{"start":{"line":289,"column":8},"end":{"line":289,"column":56}},"111":{"start":{"line":290,"column":8},"end":{"line":290,"column":41}},"112":{"start":{"line":304,"column":0},"end":{"line":311,"column":2}},"113":{"start":{"line":305,"column":2},"end":{"line":305,"column":45}},"114":{"start":{"line":306,"column":2},"end":{"line":306,"column":21}},"115":{"start":{"line":307,"column":2},"end":{"line":309,"column":3}},"116":{"start":{"line":308,"column":4},"end":{"line":308,"column":19}},"117":{"start":{"line":310,"column":2},"end":{"line":310,"column":21}},"118":{"start":{"line":331,"column":0},"end":{"line":339,"column":2}},"119":{"start":{"line":332,"column":2},"end":{"line":332,"column":50}},"120":{"start":{"line":333,"column":2},"end":{"line":336,"column":3}},"121":{"start":{"line":334,"column":4},"end":{"line":334,"column":16}},"122":{"start":{"line":335,"column":4},"end":{"line":335,"column":47}},"123":{"start":{"line":337,"column":2},"end":{"line":337,"column":33}},"124":{"start":{"line":338,"column":2},"end":{"line":338,"column":14}},"125":{"start":{"line":348,"column":0},"end":{"line":353,"column":2}},"126":{"start":{"line":349,"column":2},"end":{"line":349,"column":58}},"127":{"start":{"line":350,"column":2},"end":{"line":352,"column":3}},"128":{"start":{"line":351,"column":4},"end":{"line":351,"column":55}},"129":{"start":{"line":361,"column":1},"end":{"line":389,"column":2}},"130":{"start":{"line":362,"column":2},"end":{"line":362,"column":30}},"131":{"start":{"line":363,"column":2},"end":{"line":366,"column":3}},"132":{"start":{"line":364,"column":4},"end":{"line":364,"column":74}},"133":{"start":{"line":365,"column":4},"end":{"line":365,"column":11}},"134":{"start":{"line":368,"column":2},"end":{"line":368,"column":18}},"135":{"start":{"line":369,"column":2},"end":{"line":388,"column":5}},"136":{"start":{"line":370,"column":4},"end":{"line":370,"column":40}},"137":{"start":{"line":371,"column":4},"end":{"line":381,"column":6}},"138":{"start":{"line":372,"column":6},"end":{"line":380,"column":9}},"139":{"start":{"line":373,"column":8},"end":{"line":373,"column":33}},"140":{"start":{"line":374,"column":8},"end":{"line":379,"column":9}},"141":{"start":{"line":375,"column":10},"end":{"line":375,"column":40}},"142":{"start":{"line":377,"column":10},"end":{"line":377,"column":69}},"143":{"start":{"line":378,"column":10},"end":{"line":378,"column":30}},"144":{"start":{"line":382,"column":4},"end":{"line":382,"column":74}},"145":{"start":{"line":383,"column":4},"end":{"line":387,"column":5}},"146":{"start":{"line":384,"column":6},"end":{"line":384,"column":42}},"147":{"start":{"line":386,"column":6},"end":{"line":386,"column":16}},"148":{"start":{"line":397,"column":0},"end":{"line":422,"column":2}},"149":{"start":{"line":398,"column":2},"end":{"line":401,"column":3}},"150":{"start":{"line":399,"column":4},"end":{"line":399,"column":75}},"151":{"start":{"line":400,"column":4},"end":{"line":400,"column":11}},"152":{"start":{"line":403,"column":2},"end":{"line":403,"column":70}},"153":{"start":{"line":404,"column":2},"end":{"line":404,"column":18}},"154":{"start":{"line":405,"column":2},"end":{"line":421,"column":5}},"155":{"start":{"line":406,"column":4},"end":{"line":406,"column":31}},"156":{"start":{"line":407,"column":4},"end":{"line":407,"column":32}},"157":{"start":{"line":408,"column":4},"end":{"line":410,"column":5}},"158":{"start":{"line":409,"column":6},"end":{"line":409,"column":41}},"159":{"start":{"line":411,"column":4},"end":{"line":417,"column":5}},"160":{"start":{"line":412,"column":6},"end":{"line":414,"column":9}},"161":{"start":{"line":413,"column":8},"end":{"line":413,"column":38}},"162":{"start":{"line":416,"column":6},"end":{"line":416,"column":36}},"163":{"start":{"line":418,"column":4},"end":{"line":418,"column":47}},"164":{"start":{"line":419,"column":4},"end":{"line":419,"column":53}},"165":{"start":{"line":420,"column":4},"end":{"line":420,"column":45}},"166":{"start":{"line":429,"column":0},"end":{"line":463,"column":2}},"167":{"start":{"line":430,"column":2},"end":{"line":433,"column":3}},"168":{"start":{"line":431,"column":4},"end":{"line":431,"column":72}},"169":{"start":{"line":432,"column":4},"end":{"line":432,"column":11}},"170":{"start":{"line":434,"column":2},"end":{"line":434,"column":28}},"171":{"start":{"line":435,"column":2},"end":{"line":435,"column":18}},"172":{"start":{"line":437,"column":2},"end":{"line":439,"column":36}},"173":{"start":{"line":438,"column":4},"end":{"line":438,"column":20}},"174":{"start":{"line":441,"column":2},"end":{"line":445,"column":4}},"175":{"start":{"line":442,"column":6},"end":{"line":444,"column":7}},"176":{"start":{"line":443,"column":8},"end":{"line":443,"column":37}},"177":{"start":{"line":446,"column":2},"end":{"line":453,"column":4}},"178":{"start":{"line":447,"column":4},"end":{"line":452,"column":7}},"179":{"start":{"line":448,"column":6},"end":{"line":448,"column":28}},"180":{"start":{"line":449,"column":6},"end":{"line":451,"column":7}},"181":{"start":{"line":450,"column":8},"end":{"line":450,"column":24}},"182":{"start":{"line":454,"column":2},"end":{"line":454,"column":58}},"183":{"start":{"line":455,"column":2},"end":{"line":455,"column":71}},"184":{"start":{"line":456,"column":2},"end":{"line":462,"column":3}},"185":{"start":{"line":457,"column":4},"end":{"line":457,"column":60}},"186":{"start":{"line":458,"column":9},"end":{"line":462,"column":3}},"187":{"start":{"line":459,"column":4},"end":{"line":459,"column":67}},"188":{"start":{"line":461,"column":4},"end":{"line":461,"column":15}},"189":{"start":{"line":484,"column":0},"end":{"line":493,"column":2}},"190":{"start":{"line":485,"column":2},"end":{"line":487,"column":3}},"191":{"start":{"line":486,"column":4},"end":{"line":486,"column":34}},"192":{"start":{"line":488,"column":2},"end":{"line":488,"column":31}},"193":{"start":{"line":489,"column":2},"end":{"line":491,"column":3}},"194":{"start":{"line":490,"column":4},"end":{"line":490,"column":24}},"195":{"start":{"line":492,"column":2},"end":{"line":492,"column":14}},"196":{"start":{"line":502,"column":0},"end":{"line":504,"column":2}},"197":{"start":{"line":503,"column":2},"end":{"line":503,"column":32}},"198":{"start":{"line":513,"column":0},"end":{"line":515,"column":2}},"199":{"start":{"line":514,"column":2},"end":{"line":514,"column":29}},"200":{"start":{"line":524,"column":0},"end":{"line":526,"column":2}},"201":{"start":{"line":525,"column":2},"end":{"line":525,"column":28}},"202":{"start":{"line":535,"column":0},"end":{"line":537,"column":2}},"203":{"start":{"line":536,"column":2},"end":{"line":536,"column":33}},"204":{"start":{"line":546,"column":0},"end":{"line":548,"column":2}},"205":{"start":{"line":547,"column":2},"end":{"line":547,"column":34}},"206":{"start":{"line":576,"column":0},"end":{"line":594,"column":2}},"207":{"start":{"line":577,"column":2},"end":{"line":577,"column":38}},"208":{"start":{"line":578,"column":2},"end":{"line":578,"column":18}},"209":{"start":{"line":579,"column":2},"end":{"line":579,"column":38}},"210":{"start":{"line":581,"column":2},"end":{"line":583,"column":3}},"211":{"start":{"line":582,"column":4},"end":{"line":582,"column":18}},"212":{"start":{"line":584,"column":2},"end":{"line":586,"column":3}},"213":{"start":{"line":585,"column":4},"end":{"line":585,"column":19}},"214":{"start":{"line":588,"column":2},"end":{"line":592,"column":3}},"215":{"start":{"line":589,"column":4},"end":{"line":591,"column":5}},"216":{"start":{"line":590,"column":6},"end":{"line":590,"column":20}},"217":{"start":{"line":593,"column":2},"end":{"line":593,"column":14}},"218":{"start":{"line":604,"column":0},"end":{"line":628,"column":2}},"219":{"start":{"line":605,"column":2},"end":{"line":605,"column":52}},"220":{"start":{"line":606,"column":2},"end":{"line":609,"column":3}},"221":{"start":{"line":607,"column":4},"end":{"line":607,"column":17}},"222":{"start":{"line":608,"column":4},"end":{"line":608,"column":49}},"223":{"start":{"line":611,"column":2},"end":{"line":617,"column":3}},"224":{"start":{"line":612,"column":4},"end":{"line":612,"column":18}},"225":{"start":{"line":613,"column":4},"end":{"line":613,"column":22}},"226":{"start":{"line":614,"column":4},"end":{"line":616,"column":5}},"227":{"start":{"line":615,"column":6},"end":{"line":615,"column":33}},"228":{"start":{"line":619,"column":2},"end":{"line":621,"column":3}},"229":{"start":{"line":620,"column":4},"end":{"line":620,"column":11}},"230":{"start":{"line":623,"column":2},"end":{"line":627,"column":4}},"231":{"start":{"line":637,"column":0},"end":{"line":687,"column":2}},"232":{"start":{"line":638,"column":2},"end":{"line":641,"column":3}},"233":{"start":{"line":639,"column":4},"end":{"line":639,"column":60}},"234":{"start":{"line":640,"column":4},"end":{"line":640,"column":11}},"235":{"start":{"line":643,"column":2},"end":{"line":643,"column":18}},"236":{"start":{"line":644,"column":2},"end":{"line":644,"column":20}},"237":{"start":{"line":645,"column":2},"end":{"line":645,"column":44}},"238":{"start":{"line":647,"column":2},"end":{"line":650,"column":3}},"239":{"start":{"line":648,"column":4},"end":{"line":648,"column":78}},"240":{"start":{"line":649,"column":4},"end":{"line":649,"column":11}},"241":{"start":{"line":652,"column":2},"end":{"line":664,"column":5}},"242":{"start":{"line":653,"column":4},"end":{"line":655,"column":5}},"243":{"start":{"line":654,"column":6},"end":{"line":654,"column":13}},"244":{"start":{"line":656,"column":4},"end":{"line":656,"column":46}},"245":{"start":{"line":657,"column":4},"end":{"line":657,"column":33}},"246":{"start":{"line":658,"column":4},"end":{"line":658,"column":73}},"247":{"start":{"line":659,"column":4},"end":{"line":663,"column":5}},"248":{"start":{"line":660,"column":6},"end":{"line":660,"column":71}},"249":{"start":{"line":662,"column":6},"end":{"line":662,"column":46}},"250":{"start":{"line":667,"column":2},"end":{"line":686,"column":3}},"251":{"start":{"line":668,"column":4},"end":{"line":668,"column":11}},"252":{"start":{"line":670,"column":4},"end":{"line":673,"column":5}},"253":{"start":{"line":671,"column":6},"end":{"line":671,"column":72}},"254":{"start":{"line":672,"column":6},"end":{"line":672,"column":13}},"255":{"start":{"line":675,"column":4},"end":{"line":685,"column":7}},"256":{"start":{"line":676,"column":6},"end":{"line":678,"column":7}},"257":{"start":{"line":677,"column":8},"end":{"line":677,"column":15}},"258":{"start":{"line":679,"column":6},"end":{"line":679,"column":71}},"259":{"start":{"line":680,"column":6},"end":{"line":684,"column":7}},"260":{"start":{"line":681,"column":8},"end":{"line":681,"column":74}},"261":{"start":{"line":683,"column":8},"end":{"line":683,"column":48}},"262":{"start":{"line":699,"column":0},"end":{"line":701,"column":2}},"263":{"start":{"line":700,"column":2},"end":{"line":700,"column":60}},"264":{"start":{"line":709,"column":0},"end":{"line":711,"column":2}},"265":{"start":{"line":710,"column":2},"end":{"line":710,"column":21}},"266":{"start":{"line":719,"column":0},"end":{"line":721,"column":2}},"267":{"start":{"line":720,"column":2},"end":{"line":720,"column":24}},"268":{"start":{"line":729,"column":0},"end":{"line":731,"column":2}},"269":{"start":{"line":730,"column":2},"end":{"line":730,"column":23}},"270":{"start":{"line":739,"column":0},"end":{"line":741,"column":2}},"271":{"start":{"line":740,"column":2},"end":{"line":740,"column":25}},"272":{"start":{"line":749,"column":0},"end":{"line":751,"column":2}},"273":{"start":{"line":750,"column":2},"end":{"line":750,"column":22}},"274":{"start":{"line":759,"column":0},"end":{"line":761,"column":2}},"275":{"start":{"line":760,"column":2},"end":{"line":760,"column":49}},"276":{"start":{"line":769,"column":0},"end":{"line":771,"column":2}},"277":{"start":{"line":770,"column":2},"end":{"line":770,"column":26}},"278":{"start":{"line":780,"column":0},"end":{"line":782,"column":2}},"279":{"start":{"line":781,"column":2},"end":{"line":781,"column":32}},"280":{"start":{"line":792,"column":0},"end":{"line":794,"column":2}},"281":{"start":{"line":793,"column":2},"end":{"line":793,"column":59}},"282":{"start":{"line":803,"column":0},"end":{"line":805,"column":2}},"283":{"start":{"line":804,"column":2},"end":{"line":804,"column":41}},"284":{"start":{"line":816,"column":0},"end":{"line":819,"column":2}},"285":{"start":{"line":817,"column":2},"end":{"line":817,"column":41}},"286":{"start":{"line":818,"column":2},"end":{"line":818,"column":48}},"287":{"start":{"line":829,"column":0},"end":{"line":832,"column":2}},"288":{"start":{"line":830,"column":2},"end":{"line":830,"column":41}},"289":{"start":{"line":831,"column":2},"end":{"line":831,"column":38}},"290":{"start":{"line":840,"column":0},"end":{"line":842,"column":2}},"291":{"start":{"line":841,"column":2},"end":{"line":841,"column":55}},"292":{"start":{"line":850,"column":0},"end":{"line":874,"column":2}},"293":{"start":{"line":851,"column":2},"end":{"line":853,"column":3}},"294":{"start":{"line":852,"column":4},"end":{"line":852,"column":11}},"295":{"start":{"line":855,"column":2},"end":{"line":855,"column":18}},"296":{"start":{"line":856,"column":2},"end":{"line":872,"column":3}},"297":{"start":{"line":857,"column":4},"end":{"line":857,"column":22}},"298":{"start":{"line":859,"column":4},"end":{"line":859,"column":33}},"299":{"start":{"line":862,"column":4},"end":{"line":862,"column":49}},"300":{"start":{"line":863,"column":4},"end":{"line":865,"column":5}},"301":{"start":{"line":864,"column":6},"end":{"line":864,"column":56}},"302":{"start":{"line":866,"column":4},"end":{"line":866,"column":31}},"303":{"start":{"line":869,"column":4},"end":{"line":871,"column":5}},"304":{"start":{"line":870,"column":6},"end":{"line":870,"column":45}},"305":{"start":{"line":873,"column":2},"end":{"line":873,"column":47}},"306":{"start":{"line":882,"column":0},"end":{"line":903,"column":2}},"307":{"start":{"line":883,"column":2},"end":{"line":885,"column":3}},"308":{"start":{"line":884,"column":4},"end":{"line":884,"column":11}},"309":{"start":{"line":887,"column":2},"end":{"line":887,"column":22}},"310":{"start":{"line":888,"column":2},"end":{"line":901,"column":3}},"311":{"start":{"line":889,"column":4},"end":{"line":889,"column":16}},"312":{"start":{"line":890,"column":4},"end":{"line":890,"column":28}},"313":{"start":{"line":891,"column":4},"end":{"line":893,"column":5}},"314":{"start":{"line":892,"column":6},"end":{"line":892,"column":15}},"315":{"start":{"line":895,"column":4},"end":{"line":895,"column":28}},"316":{"start":{"line":898,"column":4},"end":{"line":898,"column":49}},"317":{"start":{"line":899,"column":4},"end":{"line":899,"column":28}},"318":{"start":{"line":902,"column":2},"end":{"line":902,"column":46}},"319":{"start":{"line":911,"column":0},"end":{"line":935,"column":2}},"320":{"start":{"line":912,"column":2},"end":{"line":914,"column":3}},"321":{"start":{"line":913,"column":4},"end":{"line":913,"column":11}},"322":{"start":{"line":916,"column":2},"end":{"line":916,"column":25}},"323":{"start":{"line":917,"column":2},"end":{"line":917,"column":27}},"324":{"start":{"line":918,"column":2},"end":{"line":918,"column":24}},"325":{"start":{"line":919,"column":2},"end":{"line":919,"column":23}},"326":{"start":{"line":920,"column":2},"end":{"line":933,"column":3}},"327":{"start":{"line":921,"column":4},"end":{"line":921,"column":29}},"328":{"start":{"line":922,"column":4},"end":{"line":922,"column":60}},"329":{"start":{"line":923,"column":4},"end":{"line":923,"column":48}},"330":{"start":{"line":924,"column":4},"end":{"line":926,"column":5}},"331":{"start":{"line":925,"column":6},"end":{"line":925,"column":51}},"332":{"start":{"line":927,"column":4},"end":{"line":927,"column":49}},"333":{"start":{"line":929,"column":4},"end":{"line":931,"column":5}},"334":{"start":{"line":930,"column":6},"end":{"line":930,"column":40}},"335":{"start":{"line":932,"column":4},"end":{"line":932,"column":29}},"336":{"start":{"line":934,"column":2},"end":{"line":934,"column":55}},"337":{"start":{"line":943,"column":0},"end":{"line":949,"column":2}},"338":{"start":{"line":944,"column":2},"end":{"line":947,"column":3}},"339":{"start":{"line":945,"column":4},"end":{"line":945,"column":41}},"340":{"start":{"line":946,"column":4},"end":{"line":946,"column":11}},"341":{"start":{"line":948,"column":2},"end":{"line":948,"column":43}},"342":{"start":{"line":957,"column":0},"end":{"line":963,"column":2}},"343":{"start":{"line":958,"column":2},"end":{"line":961,"column":3}},"344":{"start":{"line":959,"column":4},"end":{"line":959,"column":39}},"345":{"start":{"line":960,"column":4},"end":{"line":960,"column":11}},"346":{"start":{"line":962,"column":2},"end":{"line":962,"column":46}},"347":{"start":{"line":965,"column":0},"end":{"line":973,"column":2}},"348":{"start":{"line":966,"column":2},"end":{"line":971,"column":3}},"349":{"start":{"line":967,"column":4},"end":{"line":970,"column":5}},"350":{"start":{"line":968,"column":6},"end":{"line":968,"column":28}},"351":{"start":{"line":969,"column":6},"end":{"line":969,"column":13}},"352":{"start":{"line":972,"column":2},"end":{"line":972,"column":25}},"353":{"start":{"line":975,"column":0},"end":{"line":986,"column":2}},"354":{"start":{"line":976,"column":2},"end":{"line":978,"column":3}},"355":{"start":{"line":977,"column":4},"end":{"line":977,"column":11}},"356":{"start":{"line":980,"column":2},"end":{"line":985,"column":3}},"357":{"start":{"line":981,"column":4},"end":{"line":984,"column":5}},"358":{"start":{"line":982,"column":6},"end":{"line":982,"column":25}},"359":{"start":{"line":983,"column":6},"end":{"line":983,"column":13}},"360":{"start":{"line":988,"column":0},"end":{"line":1000,"column":2}},"361":{"start":{"line":989,"column":2},"end":{"line":991,"column":3}},"362":{"start":{"line":990,"column":4},"end":{"line":990,"column":17}},"363":{"start":{"line":993,"column":2},"end":{"line":993,"column":31}},"364":{"start":{"line":994,"column":2},"end":{"line":998,"column":3}},"365":{"start":{"line":995,"column":4},"end":{"line":997,"column":5}},"366":{"start":{"line":996,"column":6},"end":{"line":996,"column":18}},"367":{"start":{"line":999,"column":2},"end":{"line":999,"column":15}},"368":{"start":{"line":1002,"column":0},"end":{"line":1009,"column":2}},"369":{"start":{"line":1003,"column":2},"end":{"line":1003,"column":32}},"370":{"start":{"line":1004,"column":2},"end":{"line":1008,"column":3}},"371":{"start":{"line":1005,"column":4},"end":{"line":1007,"column":5}},"372":{"start":{"line":1006,"column":6},"end":{"line":1006,"column":50}},"373":{"start":{"line":1011,"column":0},"end":{"line":1018,"column":2}},"374":{"start":{"line":1012,"column":1},"end":{"line":1012,"column":29}},"375":{"start":{"line":1013,"column":2},"end":{"line":1016,"column":3}},"376":{"start":{"line":1014,"column":4},"end":{"line":1014,"column":17}},"377":{"start":{"line":1015,"column":4},"end":{"line":1015,"column":27}},"378":{"start":{"line":1017,"column":2},"end":{"line":1017,"column":23}}},"branchMap":{"1":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":9},"end":{"line":41,"column":13}},{"start":{"line":41,"column":17},"end":{"line":41,"column":19}}]},"2":{"line":45,"type":"binary-expr","locations":[{"start":{"line":45,"column":13},"end":{"line":45,"column":22}},{"start":{"line":45,"column":26},"end":{"line":45,"column":61}}]},"3":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":2},"end":{"line":103,"column":2}},{"start":{"line":103,"column":2},"end":{"line":103,"column":2}}]},"4":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":108,"column":4}},{"start":{"line":108,"column":4},"end":{"line":108,"column":4}}]},"5":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":11},"end":{"line":110,"column":11}},{"start":{"line":110,"column":11},"end":{"line":110,"column":11}}]},"6":{"line":224,"type":"if","locations":[{"start":{"line":224,"column":2},"end":{"line":224,"column":2}},{"start":{"line":224,"column":2},"end":{"line":224,"column":2}}]},"7":{"line":228,"type":"if","locations":[{"start":{"line":228,"column":4},"end":{"line":228,"column":4}},{"start":{"line":228,"column":4},"end":{"line":228,"column":4}}]},"8":{"line":233,"type":"if","locations":[{"start":{"line":233,"column":2},"end":{"line":233,"column":2}},{"start":{"line":233,"column":2},"end":{"line":233,"column":2}}]},"9":{"line":237,"type":"if","locations":[{"start":{"line":237,"column":2},"end":{"line":237,"column":2}},{"start":{"line":237,"column":2},"end":{"line":237,"column":2}}]},"10":{"line":237,"type":"binary-expr","locations":[{"start":{"line":237,"column":5},"end":{"line":237,"column":10}},{"start":{"line":237,"column":14},"end":{"line":237,"column":48}}]},"11":{"line":241,"type":"if","locations":[{"start":{"line":241,"column":2},"end":{"line":241,"column":2}},{"start":{"line":241,"column":2},"end":{"line":241,"column":2}}]},"12":{"line":241,"type":"binary-expr","locations":[{"start":{"line":241,"column":5},"end":{"line":241,"column":9}},{"start":{"line":241,"column":13},"end":{"line":241,"column":34}}]},"13":{"line":248,"type":"if","locations":[{"start":{"line":248,"column":2},"end":{"line":248,"column":2}},{"start":{"line":248,"column":2},"end":{"line":248,"column":2}}]},"14":{"line":271,"type":"if","locations":[{"start":{"line":271,"column":2},"end":{"line":271,"column":2}},{"start":{"line":271,"column":2},"end":{"line":271,"column":2}}]},"15":{"line":274,"type":"if","locations":[{"start":{"line":274,"column":5},"end":{"line":274,"column":5}},{"start":{"line":274,"column":5},"end":{"line":274,"column":5}}]},"16":{"line":278,"type":"if","locations":[{"start":{"line":278,"column":9},"end":{"line":278,"column":9}},{"start":{"line":278,"column":9},"end":{"line":278,"column":9}}]},"17":{"line":286,"type":"if","locations":[{"start":{"line":286,"column":2},"end":{"line":286,"column":2}},{"start":{"line":286,"column":2},"end":{"line":286,"column":2}}]},"18":{"line":286,"type":"binary-expr","locations":[{"start":{"line":286,"column":5},"end":{"line":286,"column":15}},{"start":{"line":286,"column":19},"end":{"line":286,"column":27}}]},"19":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":6},"end":{"line":288,"column":6}},{"start":{"line":288,"column":6},"end":{"line":288,"column":6}}]},"20":{"line":307,"type":"if","locations":[{"start":{"line":307,"column":2},"end":{"line":307,"column":2}},{"start":{"line":307,"column":2},"end":{"line":307,"column":2}}]},"21":{"line":333,"type":"if","locations":[{"start":{"line":333,"column":2},"end":{"line":333,"column":2}},{"start":{"line":333,"column":2},"end":{"line":333,"column":2}}]},"22":{"line":350,"type":"if","locations":[{"start":{"line":350,"column":2},"end":{"line":350,"column":2}},{"start":{"line":350,"column":2},"end":{"line":350,"column":2}}]},"23":{"line":350,"type":"binary-expr","locations":[{"start":{"line":350,"column":5},"end":{"line":350,"column":10}},{"start":{"line":350,"column":14},"end":{"line":350,"column":39}}]},"24":{"line":363,"type":"if","locations":[{"start":{"line":363,"column":2},"end":{"line":363,"column":2}},{"start":{"line":363,"column":2},"end":{"line":363,"column":2}}]},"25":{"line":374,"type":"if","locations":[{"start":{"line":374,"column":8},"end":{"line":374,"column":8}},{"start":{"line":374,"column":8},"end":{"line":374,"column":8}}]},"26":{"line":383,"type":"if","locations":[{"start":{"line":383,"column":4},"end":{"line":383,"column":4}},{"start":{"line":383,"column":4},"end":{"line":383,"column":4}}]},"27":{"line":398,"type":"if","locations":[{"start":{"line":398,"column":2},"end":{"line":398,"column":2}},{"start":{"line":398,"column":2},"end":{"line":398,"column":2}}]},"28":{"line":408,"type":"if","locations":[{"start":{"line":408,"column":4},"end":{"line":408,"column":4}},{"start":{"line":408,"column":4},"end":{"line":408,"column":4}}]},"29":{"line":411,"type":"if","locations":[{"start":{"line":411,"column":4},"end":{"line":411,"column":4}},{"start":{"line":411,"column":4},"end":{"line":411,"column":4}}]},"30":{"line":430,"type":"if","locations":[{"start":{"line":430,"column":2},"end":{"line":430,"column":2}},{"start":{"line":430,"column":2},"end":{"line":430,"column":2}}]},"31":{"line":442,"type":"if","locations":[{"start":{"line":442,"column":6},"end":{"line":442,"column":6}},{"start":{"line":442,"column":6},"end":{"line":442,"column":6}}]},"32":{"line":449,"type":"if","locations":[{"start":{"line":449,"column":6},"end":{"line":449,"column":6}},{"start":{"line":449,"column":6},"end":{"line":449,"column":6}}]},"33":{"line":456,"type":"if","locations":[{"start":{"line":456,"column":2},"end":{"line":456,"column":2}},{"start":{"line":456,"column":2},"end":{"line":456,"column":2}}]},"34":{"line":458,"type":"if","locations":[{"start":{"line":458,"column":9},"end":{"line":458,"column":9}},{"start":{"line":458,"column":9},"end":{"line":458,"column":9}}]},"35":{"line":485,"type":"if","locations":[{"start":{"line":485,"column":2},"end":{"line":485,"column":2}},{"start":{"line":485,"column":2},"end":{"line":485,"column":2}}]},"36":{"line":489,"type":"if","locations":[{"start":{"line":489,"column":2},"end":{"line":489,"column":2}},{"start":{"line":489,"column":2},"end":{"line":489,"column":2}}]},"37":{"line":581,"type":"if","locations":[{"start":{"line":581,"column":2},"end":{"line":581,"column":2}},{"start":{"line":581,"column":2},"end":{"line":581,"column":2}}]},"38":{"line":584,"type":"if","locations":[{"start":{"line":584,"column":2},"end":{"line":584,"column":2}},{"start":{"line":584,"column":2},"end":{"line":584,"column":2}}]},"39":{"line":588,"type":"if","locations":[{"start":{"line":588,"column":2},"end":{"line":588,"column":2}},{"start":{"line":588,"column":2},"end":{"line":588,"column":2}}]},"40":{"line":588,"type":"binary-expr","locations":[{"start":{"line":588,"column":6},"end":{"line":588,"column":36}},{"start":{"line":588,"column":40},"end":{"line":588,"column":72}}]},"41":{"line":589,"type":"if","locations":[{"start":{"line":589,"column":4},"end":{"line":589,"column":4}},{"start":{"line":589,"column":4},"end":{"line":589,"column":4}}]},"42":{"line":589,"type":"binary-expr","locations":[{"start":{"line":589,"column":8},"end":{"line":589,"column":39}},{"start":{"line":589,"column":43},"end":{"line":589,"column":83}}]},"43":{"line":606,"type":"if","locations":[{"start":{"line":606,"column":2},"end":{"line":606,"column":2}},{"start":{"line":606,"column":2},"end":{"line":606,"column":2}}]},"44":{"line":611,"type":"if","locations":[{"start":{"line":611,"column":2},"end":{"line":611,"column":2}},{"start":{"line":611,"column":2},"end":{"line":611,"column":2}}]},"45":{"line":614,"type":"if","locations":[{"start":{"line":614,"column":4},"end":{"line":614,"column":4}},{"start":{"line":614,"column":4},"end":{"line":614,"column":4}}]},"46":{"line":619,"type":"if","locations":[{"start":{"line":619,"column":2},"end":{"line":619,"column":2}},{"start":{"line":619,"column":2},"end":{"line":619,"column":2}}]},"47":{"line":638,"type":"if","locations":[{"start":{"line":638,"column":2},"end":{"line":638,"column":2}},{"start":{"line":638,"column":2},"end":{"line":638,"column":2}}]},"48":{"line":644,"type":"binary-expr","locations":[{"start":{"line":644,"column":9},"end":{"line":644,"column":13}},{"start":{"line":644,"column":17},"end":{"line":644,"column":19}}]},"49":{"line":647,"type":"if","locations":[{"start":{"line":647,"column":2},"end":{"line":647,"column":2}},{"start":{"line":647,"column":2},"end":{"line":647,"column":2}}]},"50":{"line":653,"type":"if","locations":[{"start":{"line":653,"column":4},"end":{"line":653,"column":4}},{"start":{"line":653,"column":4},"end":{"line":653,"column":4}}]},"51":{"line":657,"type":"binary-expr","locations":[{"start":{"line":657,"column":16},"end":{"line":657,"column":26}},{"start":{"line":657,"column":30},"end":{"line":657,"column":32}}]},"52":{"line":659,"type":"if","locations":[{"start":{"line":659,"column":4},"end":{"line":659,"column":4}},{"start":{"line":659,"column":4},"end":{"line":659,"column":4}}]},"53":{"line":667,"type":"if","locations":[{"start":{"line":667,"column":2},"end":{"line":667,"column":2}},{"start":{"line":667,"column":2},"end":{"line":667,"column":2}}]},"54":{"line":670,"type":"if","locations":[{"start":{"line":670,"column":4},"end":{"line":670,"column":4}},{"start":{"line":670,"column":4},"end":{"line":670,"column":4}}]},"55":{"line":676,"type":"if","locations":[{"start":{"line":676,"column":6},"end":{"line":676,"column":6}},{"start":{"line":676,"column":6},"end":{"line":676,"column":6}}]},"56":{"line":680,"type":"if","locations":[{"start":{"line":680,"column":6},"end":{"line":680,"column":6}},{"start":{"line":680,"column":6},"end":{"line":680,"column":6}}]},"57":{"line":817,"type":"binary-expr","locations":[{"start":{"line":817,"column":11},"end":{"line":817,"column":17}},{"start":{"line":817,"column":21},"end":{"line":817,"column":40}}]},"58":{"line":818,"type":"binary-expr","locations":[{"start":{"line":818,"column":9},"end":{"line":818,"column":17}},{"start":{"line":818,"column":21},"end":{"line":818,"column":47}}]},"59":{"line":830,"type":"binary-expr","locations":[{"start":{"line":830,"column":11},"end":{"line":830,"column":17}},{"start":{"line":830,"column":21},"end":{"line":830,"column":40}}]},"60":{"line":831,"type":"binary-expr","locations":[{"start":{"line":831,"column":9},"end":{"line":831,"column":17}},{"start":{"line":831,"column":21},"end":{"line":831,"column":37}}]},"61":{"line":851,"type":"if","locations":[{"start":{"line":851,"column":2},"end":{"line":851,"column":2}},{"start":{"line":851,"column":2},"end":{"line":851,"column":2}}]},"62":{"line":851,"type":"binary-expr","locations":[{"start":{"line":851,"column":5},"end":{"line":851,"column":13}},{"start":{"line":851,"column":17},"end":{"line":851,"column":32}}]},"63":{"line":863,"type":"if","locations":[{"start":{"line":863,"column":4},"end":{"line":863,"column":4}},{"start":{"line":863,"column":4},"end":{"line":863,"column":4}}]},"64":{"line":869,"type":"if","locations":[{"start":{"line":869,"column":4},"end":{"line":869,"column":4}},{"start":{"line":869,"column":4},"end":{"line":869,"column":4}}]},"65":{"line":883,"type":"if","locations":[{"start":{"line":883,"column":2},"end":{"line":883,"column":2}},{"start":{"line":883,"column":2},"end":{"line":883,"column":2}}]},"66":{"line":883,"type":"binary-expr","locations":[{"start":{"line":883,"column":5},"end":{"line":883,"column":9}},{"start":{"line":883,"column":13},"end":{"line":883,"column":24}}]},"67":{"line":891,"type":"if","locations":[{"start":{"line":891,"column":4},"end":{"line":891,"column":4}},{"start":{"line":891,"column":4},"end":{"line":891,"column":4}}]},"68":{"line":912,"type":"if","locations":[{"start":{"line":912,"column":2},"end":{"line":912,"column":2}},{"start":{"line":912,"column":2},"end":{"line":912,"column":2}}]},"69":{"line":924,"type":"if","locations":[{"start":{"line":924,"column":4},"end":{"line":924,"column":4}},{"start":{"line":924,"column":4},"end":{"line":924,"column":4}}]},"70":{"line":929,"type":"if","locations":[{"start":{"line":929,"column":4},"end":{"line":929,"column":4}},{"start":{"line":929,"column":4},"end":{"line":929,"column":4}}]},"71":{"line":944,"type":"if","locations":[{"start":{"line":944,"column":2},"end":{"line":944,"column":2}},{"start":{"line":944,"column":2},"end":{"line":944,"column":2}}]},"72":{"line":944,"type":"binary-expr","locations":[{"start":{"line":944,"column":5},"end":{"line":944,"column":11}},{"start":{"line":944,"column":15},"end":{"line":944,"column":28}}]},"73":{"line":958,"type":"if","locations":[{"start":{"line":958,"column":2},"end":{"line":958,"column":2}},{"start":{"line":958,"column":2},"end":{"line":958,"column":2}}]},"74":{"line":958,"type":"binary-expr","locations":[{"start":{"line":958,"column":5},"end":{"line":958,"column":11}},{"start":{"line":958,"column":15},"end":{"line":958,"column":28}}]},"75":{"line":967,"type":"if","locations":[{"start":{"line":967,"column":4},"end":{"line":967,"column":4}},{"start":{"line":967,"column":4},"end":{"line":967,"column":4}}]},"76":{"line":976,"type":"if","locations":[{"start":{"line":976,"column":2},"end":{"line":976,"column":2}},{"start":{"line":976,"column":2},"end":{"line":976,"column":2}}]},"77":{"line":976,"type":"binary-expr","locations":[{"start":{"line":976,"column":5},"end":{"line":976,"column":11}},{"start":{"line":976,"column":15},"end":{"line":976,"column":28}}]},"78":{"line":981,"type":"if","locations":[{"start":{"line":981,"column":4},"end":{"line":981,"column":4}},{"start":{"line":981,"column":4},"end":{"line":981,"column":4}}]},"79":{"line":989,"type":"if","locations":[{"start":{"line":989,"column":2},"end":{"line":989,"column":2}},{"start":{"line":989,"column":2},"end":{"line":989,"column":2}}]},"80":{"line":995,"type":"if","locations":[{"start":{"line":995,"column":4},"end":{"line":995,"column":4}},{"start":{"line":995,"column":4},"end":{"line":995,"column":4}}]},"81":{"line":1005,"type":"if","locations":[{"start":{"line":1005,"column":4},"end":{"line":1005,"column":4}},{"start":{"line":1005,"column":4},"end":{"line":1005,"column":4}}]},"82":{"line":1013,"type":"if","locations":[{"start":{"line":1013,"column":2},"end":{"line":1013,"column":2}},{"start":{"line":1013,"column":2},"end":{"line":1013,"column":2}}]}},"code":["/*!"," * Pomelo -- proto"," * Copyright(c) 2012 xiechengchao <xiecc@163.com>"," * MIT Licensed"," */","","/**"," * Module dependencies."," */","var utils = require('./util/utils');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var EventEmitter = require('events').EventEmitter;","var events = require('./util/events');","var appUtil = require('./util/appUtil');","var Constants = require('./util/constants');","var appManager = require('./common/manager/appManager');","var fs = require('fs');","var path = require('path');","","/**"," * Application prototype."," *"," * @module"," */","var Application = module.exports = {};","","/**"," * Application states"," */","var STATE_INITED  = 1;  // app has inited","var STATE_START = 2;  // app start","var STATE_STARTED = 3;  // app has started","var STATE_STOPED  = 4;  // app has stoped","","/**"," * Initialize the server."," *"," *   - setup default configuration"," */","Application.init = function(opts) {","  opts = opts || {};","  this.loaded = [];       // loaded component list","  this.components = {};   // name -> component map","  this.settings = {};     // collection keep set/get","  var base = opts.base || path.dirname(require.main.filename);","  this.set(Constants.RESERVED.BASE, base, true);","  this.event = new EventEmitter();  // event object to sub/pub events","","  // current server info","  this.serverId = null;   // current server id","  this.serverType = null; // current server type","  this.curServer = null;  // current server info","  this.startTime = null; // current server start time","","  // global server infos","  this.master = null;         // master server info","  this.servers = {};          // current global server info maps, id -> info","  this.serverTypeMaps = {};   // current global type maps, type -> [info]","  this.serverTypes = [];      // current global server type list","  this.lifecycleCbs = {};     // current server custom lifecycle callbacks","  this.clusterSeq = {};       // cluster id seqence","","  appUtil.defaultConfiguration(this);","","  this.state = STATE_INITED;","  logger.info('application inited: %j', this.getServerId());","};","","/**"," * Get application base path"," *"," *  // cwd: /home/game/"," *  pomelo start"," *  // app.getBase() -> /home/game"," *"," * @return {String} application base path"," *"," * @memberOf Application"," */","Application.getBase = function() {","  return this.get(Constants.RESERVED.BASE);","};","","/**"," * Override require method in application"," *"," * @param {String} relative path of file"," *"," * @memberOf Application"," */","Application.require = function(ph) {","  return require(path.join(Application.getBase(), ph));","};","","/**"," * Configure logger with {$base}/config/log4js.json"," * "," * @param {Object} logger pomelo-logger instance without configuration"," *"," * @memberOf Application"," */","Application.configureLogger = function(logger) {","  if (process.env.POMELO_LOGGER !== 'off') {","    var base = this.getBase();","    var env = this.get(Constants.RESERVED.ENV);","    var originPath = path.join(base, Constants.FILEPATH.LOG);","    var presentPath = path.join(base, Constants.FILEPATH.CONFIG_DIR, env, path.basename(Constants.FILEPATH.LOG));","    if(fs.existsSync(originPath)) {","      logger.configure(originPath, {serverId: this.serverId, base: base});","    } else if(fs.existsSync(presentPath)) {","      logger.configure(presentPath, {serverId: this.serverId, base: base});","    } else {","      logger.error('logger file path configuration is error.');","    }","  }","};","","/**"," * add a filter to before and after filter"," *"," * @param {Object} filter provide before and after filter method."," *                        A filter should have two methods: before and after."," * @memberOf Application"," */","Application.filter = function (filter) {","  this.before(filter);","  this.after(filter);","};","","/**"," * Add before filter."," *"," * @param {Object|Function} bf before fileter, bf(msg, session, next)"," * @memberOf Application"," */","Application.before = function (bf) {","  addFilter(this, Constants.KEYWORDS.BEFORE_FILTER, bf);","};","","/**"," * Add after filter."," *"," * @param {Object|Function} af after filter, `af(err, msg, session, resp, next)`"," * @memberOf Application"," */","Application.after = function (af) {","  addFilter(this, Constants.KEYWORDS.AFTER_FILTER, af);","};","","/**"," * add a global filter to before and after global filter"," *"," * @param {Object} filter provide before and after filter method."," *                        A filter should have two methods: before and after."," * @memberOf Application"," */","Application.globalFilter = function (filter) {","  this.globalBefore(filter);","  this.globalAfter(filter);","};","","/**"," * Add global before filter."," *"," * @param {Object|Function} bf before fileter, bf(msg, session, next)"," * @memberOf Application"," */","Application.globalBefore = function (bf) {","  addFilter(this, Constants.KEYWORDS.GLOBAL_BEFORE_FILTER, bf);","};","","/**"," * Add global after filter."," *"," * @param {Object|Function} af after filter, `af(err, msg, session, resp, next)`"," * @memberOf Application"," */","Application.globalAfter = function (af) {","  addFilter(this, Constants.KEYWORDS.GLOBAL_AFTER_FILTER, af);","};","","/**"," * Add rpc before filter."," *"," * @param {Object|Function} bf before fileter, bf(serverId, msg, opts, next)"," * @memberOf Application"," */","Application.rpcBefore = function(bf) {","  addFilter(this, Constants.KEYWORDS.RPC_BEFORE_FILTER, bf);","};","","/**"," * Add rpc after filter."," *"," * @param {Object|Function} af after filter, `af(serverId, msg, opts, next)`"," * @memberOf Application"," */","Application.rpcAfter = function(af) {","  addFilter(this, Constants.KEYWORDS.RPC_AFTER_FILTER, af);","};","","/**"," * add a rpc filter to before and after rpc filter"," *"," * @param {Object} filter provide before and after filter method."," *                        A filter should have two methods: before and after."," * @memberOf Application"," */","Application.rpcFilter = function(filter) {","  this.rpcBefore(filter);","  this.rpcAfter(filter);","};","","/**"," * Load component"," *"," * @param  {String} name    (optional) name of the component"," * @param  {Object} component component instance or factory function of the component"," * @param  {[type]} opts    (optional) construct parameters for the factory function"," * @return {Object}     app instance for chain invoke"," * @memberOf Application"," */","Application.load = function(name, component, opts) {","  if(typeof name !== 'string') {","    opts = component;","    component = name;","    name = null;","    if(typeof component.name === 'string') {","      name = component.name;","    }","  }","","  if(typeof component === 'function') {","    component = component(this, opts);","  }","","  if(!name && typeof component.name === 'string') {","    name = component.name;","  }","","  if(name && this.components[name]) {","    // ignore duplicat component","    logger.warn('ignore duplicate component: %j', name);","    return;","  }","","  this.loaded.push(component);","  if(name) {","    // components with a name would get by name throught app.components later.","    this.components[name] = component;","  }","","  return this;","};","","/**"," * Load Configure json file to settings.(support different enviroment directory & compatible for old path)"," *"," * @param {String} key environment key"," * @param {String} val environment value"," * @param {Boolean} reload whether reload after change default false"," * @return {Server|Mixed} for chaining, or the setting value"," * @memberOf Application"," */","Application.loadConfigBaseApp = function (key, val, reload) {","  var self = this;","  var env = this.get(Constants.RESERVED.ENV);","  var originPath = path.join(Application.getBase(), val);","  var presentPath = path.join(Application.getBase(), Constants.FILEPATH.CONFIG_DIR, env, path.basename(val));","  var realPath;","  if(fs.existsSync(originPath)) {","     realPath = originPath;","     var file = require(originPath);","     if (file[env]) {","       file = file[env];","     }","     this.set(key, file);","  } else if(fs.existsSync(presentPath)) {","    realPath = presentPath;","    var pfile = require(presentPath);","    this.set(key, pfile);","  } else {","    logger.error('invalid configuration with file path: %s', key);","  }","","  if(!!realPath && !!reload) {","    fs.watch(realPath, function (event, filename) {","      if(event === 'change') {","        delete require.cache[require.resolve(realPath)];","        self.loadConfigBaseApp(key, val);","      }","    });","  }","};","","/**"," * Load Configure json file to settings."," *"," * @param {String} key environment key"," * @param {String} val environment value"," * @return {Server|Mixed} for chaining, or the setting value"," * @memberOf Application"," */","Application.loadConfig = function(key, val) {","  var env = this.get(Constants.RESERVED.ENV);","  val = require(val);","  if (val[env]) {","    val = val[env];","  }","  this.set(key, val);","};","","/**"," * Set the route function for the specified server type."," *"," * Examples:"," *"," *  app.route('area', routeFunc);"," *"," *  var routeFunc = function(session, msg, app, cb) {"," *    // all request to area would be route to the first area server"," *    var areas = app.getServersByType('area');"," *    cb(null, areas[0].id);"," *  };"," *"," * @param  {String} serverType server type string"," * @param  {Function} routeFunc  route function. routeFunc(session, msg, app, cb)"," * @return {Object}     current application instance for chain invoking"," * @memberOf Application"," */","Application.route = function(serverType, routeFunc) {","  var routes = this.get(Constants.KEYWORDS.ROUTE);","  if(!routes) {","    routes = {};","    this.set(Constants.KEYWORDS.ROUTE, routes);","  }","  routes[serverType] = routeFunc;","  return this;","};","","/**"," * Set before stop function. It would perform before servers stop."," *"," * @param  {Function} fun before close function"," * @return {Void}"," * @memberOf Application"," */","Application.beforeStopHook = function(fun) {","  logger.warn('this method was deprecated in pomelo 0.8');","  if(!!fun && typeof fun === 'function') {","    this.set(Constants.KEYWORDS.BEFORE_STOP_HOOK, fun);","  }","};","","/**"," * Start application. It would load the default components and start all the loaded components."," *"," * @param  {Function} cb callback function"," * @memberOf Application"," */"," Application.start = function(cb) {","  this.startTime = Date.now();","  if(this.state > STATE_INITED) {","    utils.invokeCallback(cb, new Error('application has already start.'));","    return;","  }","  ","  var self = this;","  appUtil.startByType(self, function() {","    appUtil.loadDefaultComponents(self);","    var startUp = function() {","      appUtil.optComponents(self.loaded, Constants.RESERVED.START, function(err) {","        self.state = STATE_START;","        if(err) {","          utils.invokeCallback(cb, err);","        } else {","          logger.info('%j enter after start...', self.getServerId());","          self.afterStart(cb);","        }","      });","    };","    var beforeFun = self.lifecycleCbs[Constants.LIFECYCLE.BEFORE_STARTUP];","    if(!!beforeFun) {","      beforeFun.call(null, self, startUp);","    } else {","      startUp();","    }","  });","};","","/**"," * Lifecycle callback for after start."," *"," * @param  {Function} cb callback function"," * @return {Void}"," */","Application.afterStart = function(cb) {","  if(this.state !== STATE_START) {","    utils.invokeCallback(cb, new Error('application is not running now.'));","    return;","  }","","  var afterFun = this.lifecycleCbs[Constants.LIFECYCLE.AFTER_STARTUP];","  var self = this;","  appUtil.optComponents(this.loaded, Constants.RESERVED.AFTER_START, function(err) {","    self.state = STATE_STARTED;","    var id = self.getServerId();","    if(!err) {","      logger.info('%j finish start', id);","    }","    if(!!afterFun) {","      afterFun.call(null, self, function() {","        utils.invokeCallback(cb, err);","      });","    } else {","      utils.invokeCallback(cb, err);","    }","    var usedTime = Date.now() - self.startTime;","    logger.info('%j startup in %s ms', id, usedTime);","    self.event.emit(events.START_SERVER, id);","  });","};","","/**"," * Stop components."," *"," * @param  {Boolean} force whether stop the app immediately"," */","Application.stop = function(force) {","  if(this.state > STATE_STARTED) {","    logger.warn('[pomelo application] application is not running now.');","    return;","  }","  this.state = STATE_STOPED;","  var self = this;","","  this.stopTimer = setTimeout(function() {","    process.exit(0);","  }, Constants.TIME.TIME_WAIT_STOP);","","  var cancelShutDownTimer =function(){","      if(!!self.stopTimer) {","        clearTimeout(self.stopTimer);","      }","  };","  var shutDown = function() {","    appUtil.stopComps(self.loaded, 0, force, function() {","      cancelShutDownTimer();","      if(force) {","        process.exit(0);","      }","    });","  };","  var fun = this.get(Constants.KEYWORDS.BEFORE_STOP_HOOK);","  var stopFun = this.lifecycleCbs[Constants.LIFECYCLE.BEFORE_SHUTDOWN];","  if(!!stopFun) {","    stopFun.call(null, this, shutDown, cancelShutDownTimer);","  } else if(!!fun) {","    utils.invokeCallback(fun, self, shutDown, cancelShutDownTimer);","  } else {","    shutDown();","  }","};","","/**"," * Assign `setting` to `val`, or return `setting`'s value."," *"," * Example:"," *"," *  app.set('key1', 'value1');"," *  app.get('key1');  // 'value1'"," *  app.key1;         // undefined"," *"," *  app.set('key2', 'value2', true);"," *  app.get('key2');  // 'value2'"," *  app.key2;         // 'value2'"," *"," * @param {String} setting the setting of application"," * @param {String} val the setting's value"," * @param {Boolean} attach whether attach the settings to application"," * @return {Server|Mixed} for chaining, or the setting value"," * @memberOf Application"," */","Application.set = function (setting, val, attach) {","  if (arguments.length === 1) {","    return this.settings[setting];","  }","  this.settings[setting] = val;","  if(attach) {","    this[setting] = val;","  }","  return this;","};","","/**"," * Get property from setting"," *"," * @param {String} setting application setting"," * @return {String} val"," * @memberOf Application"," */","Application.get = function (setting) {","  return this.settings[setting];","};","","/**"," * Check if `setting` is enabled."," *"," * @param {String} setting application setting"," * @return {Boolean}"," * @memberOf Application"," */","Application.enabled = function (setting) {","  return !!this.get(setting);","};","","/**"," * Check if `setting` is disabled."," *"," * @param {String} setting application setting"," * @return {Boolean}"," * @memberOf Application"," */","Application.disabled = function (setting) {","  return !this.get(setting);","};","","/**"," * Enable `setting`."," *"," * @param {String} setting application setting"," * @return {app} for chaining"," * @memberOf Application"," */","Application.enable = function (setting) {","  return this.set(setting, true);","};","","/**"," * Disable `setting`."," *"," * @param {String} setting application setting"," * @return {app} for chaining"," * @memberOf Application"," */","Application.disable = function (setting) {","  return this.set(setting, false);","};","","/**"," * Configure callback for the specified env and server type."," * When no env is specified that callback will"," * be invoked for all environments and when no type is specified"," * that callback will be invoked for all server types."," *"," * Examples:"," *"," *  app.configure(function(){"," *    // executed for all envs and server types"," *  });"," *"," *  app.configure('development', function(){"," *    // executed development env"," *  });"," *"," *  app.configure('development', 'connector', function(){"," *    // executed for development env and connector server type"," *  });"," *"," * @param {String} env application environment"," * @param {Function} fn callback function"," * @param {String} type server type"," * @return {Application} for chaining"," * @memberOf Application"," */","Application.configure = function (env, type, fn) {","  var args = [].slice.call(arguments);","  fn = args.pop();","  env = type = Constants.RESERVED.ALL;","","  if(args.length > 0) {","    env = args[0];","  }","  if(args.length > 1) {","    type = args[1];","  }","","  if (env === Constants.RESERVED.ALL || contains(this.settings.env, env)) {","    if (type === Constants.RESERVED.ALL || contains(this.settings.serverType, type)) {","      fn.call(this);","    }","  }","  return this;","};","","/**"," * Register admin modules. Admin modules is the extends point of the monitor system."," *"," * @param {String} module (optional) module id or provoided by module.moduleId"," * @param {Object} module module object or factory function for module"," * @param {Object} opts construct parameter for module"," * @memberOf Application"," */","Application.registerAdmin = function(moduleId, module, opts) {","  var modules = this.get(Constants.KEYWORDS.MODULE);","  if(!modules) {","    modules = {};","    this.set(Constants.KEYWORDS.MODULE, modules);","  }","","  if(typeof moduleId !== 'string') {","    opts = module;","    module = moduleId;","    if(module) {","      moduleId = module.moduleId;","    }","  }","","  if(!moduleId){","    return;","  }","","  modules[moduleId] = {","    moduleId: moduleId,","    module: module,","    opts: opts","  };","};","","/**"," * Use plugin."," *"," * @param  {Object} plugin plugin instance"," * @param  {[type]} opts    (optional) construct parameters for the factory function"," * @memberOf Application"," */","Application.use = function(plugin, opts) {","  if(!plugin.components) {","    logger.error('invalid components, no components exist');","    return;","  }","","  var self = this;","  opts = opts || {};","  var dir = path.dirname(plugin.components);","","  if(!fs.existsSync(plugin.components)) {","    logger.error('fail to find components, find path: %s', plugin.components);","    return;","  }","","  fs.readdirSync(plugin.components).forEach(function (filename) {","    if (!/\\.js$/.test(filename)) {","      return;","    }","    var name = path.basename(filename, '.js');","    var param = opts[name] || {};","    var absolutePath = path.join(dir, Constants.DIR.COMPONENT, filename);","    if(!fs.existsSync(absolutePath)) {","      logger.error('component %s not exist at %s', name, absolutePath);","    } else {","      self.load(require(absolutePath), param);","    }","  });","","  // load events","  if(!plugin.events) {","    return;","  } else {","    if(!fs.existsSync(plugin.events)) {","      logger.error('fail to find events, find path: %s', plugin.events);","      return;","    }","","    fs.readdirSync(plugin.events).forEach(function (filename) {","      if (!/\\.js$/.test(filename)) {","        return;","      }","      var absolutePath = path.join(dir, Constants.DIR.EVENT, filename);","      if(!fs.existsSync(absolutePath)) {","        logger.error('events %s not exist at %s', filename, absolutePath);","      } else {","        bindEvents(require(absolutePath), self);","      }","    });","  }","};","","/**"," * Application transaction. Transcation includes conditions and handlers, if conditions are satisfied, handlers would be executed."," * And you can set retry times to execute handlers. The transaction log is in file logs/transaction.log."," *"," * @param {String} name transaction name"," * @param {Object} conditions functions which are called before transaction"," * @param {Object} handlers functions which are called during transaction"," * @param {Number} retry retry times to execute handlers if conditions are successfully executed"," * @memberOf Application"," */","Application.transaction = function(name, conditions, handlers, retry) {","  appManager.transaction(name, conditions, handlers, retry);","};","","/**"," * Get master server info."," *"," * @return {Object} master server info, {id, host, port}"," * @memberOf Application"," */","Application.getMaster = function() {","  return this.master;","};","","/**"," * Get current server info."," *"," * @return {Object} current server info, {id, serverType, host, port}"," * @memberOf Application"," */","Application.getCurServer = function() {","  return this.curServer;","};","","/**"," * Get current server id."," *"," * @return {String|Number} current server id from servers.json"," * @memberOf Application"," */","Application.getServerId = function() {","  return this.serverId;","};","","/**"," * Get current server type."," *"," * @return {String|Number} current server type from servers.json"," * @memberOf Application"," */","Application.getServerType = function() {","  return this.serverType;","};","","/**"," * Get all the current server infos."," *"," * @return {Object} server info map, key: server id, value: server info"," * @memberOf Application"," */","Application.getServers = function() {","  return this.servers;","};","","/**"," * Get all server infos from servers.json."," *"," * @return {Object} server info map, key: server id, value: server info"," * @memberOf Application"," */","Application.getServersFromConfig = function() {","  return this.get(Constants.KEYWORDS.SERVER_MAP);","};","","/**"," * Get all the server type."," *"," * @return {Array} server type list"," * @memberOf Application"," */","Application.getServerTypes = function() {","  return this.serverTypes;","};","","/**"," * Get server info by server id from current server cluster."," *"," * @param  {String} serverId server id"," * @return {Object} server info or undefined"," * @memberOf Application"," */","Application.getServerById = function(serverId) {","  return this.servers[serverId];","};","","/**"," * Get server info by server id from servers.json."," *"," * @param  {String} serverId server id"," * @return {Object} server info or undefined"," * @memberOf Application"," */","","Application.getServerFromConfig = function(serverId) {","  return this.get(Constants.KEYWORDS.SERVER_MAP)[serverId];","};","","/**"," * Get server infos by server type."," *"," * @param  {String} serverType server type"," * @return {Array}      server info list"," * @memberOf Application"," */","Application.getServersByType = function(serverType) {","  return this.serverTypeMaps[serverType];","};","","/**"," * Check the server whether is a frontend server"," *"," * @param  {server}  server server info. it would check current server"," *            if server not specified"," * @return {Boolean}"," *"," * @memberOf Application"," */","Application.isFrontend = function(server) {","  server = server || this.getCurServer();","  return !!server && server.frontend === 'true';","};","","/**"," * Check the server whether is a backend server"," *"," * @param  {server}  server server info. it would check current server"," *            if server not specified"," * @return {Boolean}"," * @memberOf Application"," */","Application.isBackend = function(server) {","  server = server || this.getCurServer();","  return !!server && !server.frontend;","};","","/**"," * Check whether current server is a master server"," *"," * @return {Boolean}"," * @memberOf Application"," */","Application.isMaster = function() {","  return this.serverType === Constants.RESERVED.MASTER;","};","","/**"," * Add new server info to current application in runtime."," *"," * @param {Array} servers new server info list"," * @memberOf Application"," */","Application.addServers = function(servers) {","  if(!servers || !servers.length) {","    return;","  }","","  var item, slist;","  for(var i=0, l=servers.length; i<l; i++) {","    item = servers[i];","    // update global server map","    this.servers[item.id] = item;","","    // update global server type map","    slist = this.serverTypeMaps[item.serverType];","    if(!slist) {","      this.serverTypeMaps[item.serverType] = slist = [];","    }","    replaceServer(slist, item);","","    // update global server type list","    if(this.serverTypes.indexOf(item.serverType) < 0) {","      this.serverTypes.push(item.serverType);","    }","  }","  this.event.emit(events.ADD_SERVERS, servers);","};","","/**"," * Remove server info from current application at runtime."," *"," * @param  {Array} ids server id list"," * @memberOf Application"," */","Application.removeServers = function(ids) {","  if(!ids || !ids.length) {","    return;","  }","","  var id, item, slist;","  for(var i=0, l=ids.length; i<l; i++) {","    id = ids[i];","    item = this.servers[id];","    if(!item) {","      continue;","    }","    // clean global server map","    delete this.servers[id];","","    // clean global server type map","    slist = this.serverTypeMaps[item.serverType];","    removeServer(slist, id);","    // TODO: should remove the server type if the slist is empty?","  }","  this.event.emit(events.REMOVE_SERVERS, ids);","};","","/**"," * Replace server info from current application at runtime."," *"," * @param  {Object} server id map"," * @memberOf Application"," */","Application.replaceServers = function(servers) {","  if(!servers){","    return;","  }","","  this.servers = servers;","  this.serverTypeMaps = {};","  this.serverTypes = [];","  var serverArray = [];","  for(var id in servers){","    var server = servers[id];","    var serverType = server[Constants.RESERVED.SERVER_TYPE];","    var slist = this.serverTypeMaps[serverType];","    if(!slist) {","      this.serverTypeMaps[serverType] = slist = [];","    }","    this.serverTypeMaps[serverType].push(server);","    // update global server type list","    if(this.serverTypes.indexOf(serverType) < 0) {","      this.serverTypes.push(serverType);","    }","    serverArray.push(server);","  }","  this.event.emit(events.REPLACE_SERVERS, serverArray);","};","","/**"," * Add crons from current application at runtime."," *"," * @param  {Array} crons new crons would be added in application"," * @memberOf Application"," */","Application.addCrons = function(crons) {","  if(!crons || !crons.length) {","    logger.warn('crons is not defined.');","    return;","  }","  this.event.emit(events.ADD_CRONS, crons);","};","","/**"," * Remove crons from current application at runtime."," *"," * @param  {Array} crons old crons would be removed in application"," * @memberOf Application"," */","Application.removeCrons = function(crons) {","  if(!crons || !crons.length) {","    logger.warn('ids is not defined.');","    return;","  }","  this.event.emit(events.REMOVE_CRONS, crons);","};","","var replaceServer = function(slist, serverInfo) {","  for(var i=0, l=slist.length; i<l; i++) {","    if(slist[i].id === serverInfo.id) {","      slist[i] = serverInfo;","      return;","    }","  }","  slist.push(serverInfo);","};","","var removeServer = function(slist, id) {","  if(!slist || !slist.length) {","    return;","  }","","  for(var i=0, l=slist.length; i<l; i++) {","    if(slist[i].id === id) {","      slist.splice(i, 1);","      return;","    }","  }","};","","var contains = function(str, settings) {","  if(!settings) {","    return false;","  }","","  var ts = settings.split(\"|\");","  for(var i=0, l=ts.length; i<l; i++) {","    if(str === ts[i]) {","      return true;","    }","  }","  return false;","};","","var bindEvents = function(Event, app) {","  var emethods = new Event(app);","  for(var m in emethods) {","    if(typeof emethods[m] === 'function') {","      app.event.on(m, emethods[m].bind(emethods));","    }","  }","};","","var addFilter = function(app, type, filter) {"," var filters = app.get(type);","  if(!filters) {","    filters = [];","    app.set(type, filters);","  }","  filters.push(filter);","};",""],"l":{"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"25":1,"30":1,"31":1,"32":1,"33":1,"40":1,"41":2,"42":2,"43":2,"44":2,"45":2,"46":2,"47":2,"50":2,"51":2,"52":2,"53":2,"56":2,"57":2,"58":2,"59":2,"60":2,"61":2,"63":2,"65":0,"66":0,"80":1,"81":8,"91":1,"92":0,"102":1,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"113":0,"125":1,"126":0,"127":0,"136":1,"137":0,"146":1,"147":0,"157":1,"158":0,"159":0,"168":1,"169":0,"178":1,"179":0,"188":1,"189":0,"198":1,"199":0,"209":1,"210":0,"211":0,"223":1,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"233":0,"234":0,"237":0,"238":0,"241":0,"243":0,"244":0,"247":0,"248":0,"250":0,"253":0,"265":1,"266":4,"267":4,"268":4,"269":4,"270":4,"271":4,"272":0,"273":0,"274":0,"275":0,"277":0,"278":4,"279":0,"280":0,"281":0,"283":4,"286":4,"287":0,"288":0,"289":0,"290":0,"304":1,"305":0,"306":0,"307":0,"308":0,"310":0,"331":1,"332":0,"333":0,"334":0,"335":0,"337":0,"338":0,"348":1,"349":0,"350":0,"351":0,"361":1,"362":0,"363":0,"364":0,"365":0,"368":0,"369":0,"370":0,"371":0,"372":0,"373":0,"374":0,"375":0,"377":0,"378":0,"382":0,"383":0,"384":0,"386":0,"397":1,"398":0,"399":0,"400":0,"403":0,"404":0,"405":0,"406":0,"407":0,"408":0,"409":0,"411":0,"412":0,"413":0,"416":0,"418":0,"419":0,"420":0,"429":1,"430":0,"431":0,"432":0,"434":0,"435":0,"437":0,"438":0,"441":0,"442":0,"443":0,"446":0,"447":0,"448":0,"449":0,"450":0,"454":0,"455":0,"456":0,"457":0,"458":0,"459":0,"461":0,"484":1,"485":6,"486":0,"488":6,"489":6,"490":4,"492":6,"502":1,"503":16,"513":1,"514":0,"524":1,"525":0,"535":1,"536":0,"546":1,"547":0,"576":1,"577":0,"578":0,"579":0,"581":0,"582":0,"584":0,"585":0,"588":0,"589":0,"590":0,"593":0,"604":1,"605":0,"606":0,"607":0,"608":0,"611":0,"612":0,"613":0,"614":0,"615":0,"619":0,"620":0,"623":0,"637":1,"638":0,"639":0,"640":0,"643":0,"644":0,"645":0,"647":0,"648":0,"649":0,"652":0,"653":0,"654":0,"656":0,"657":0,"658":0,"659":0,"660":0,"662":0,"667":0,"668":0,"670":0,"671":0,"672":0,"675":0,"676":0,"677":0,"679":0,"680":0,"681":0,"683":0,"699":1,"700":0,"709":1,"710":2,"719":1,"720":0,"729":1,"730":0,"739":1,"740":0,"749":1,"750":0,"759":1,"760":0,"769":1,"770":0,"780":1,"781":0,"792":1,"793":0,"803":1,"804":0,"816":1,"817":0,"818":0,"829":1,"830":0,"831":0,"840":1,"841":0,"850":1,"851":0,"852":0,"855":0,"856":0,"857":0,"859":0,"862":0,"863":0,"864":0,"866":0,"869":0,"870":0,"873":0,"882":1,"883":0,"884":0,"887":0,"888":0,"889":0,"890":0,"891":0,"892":0,"895":0,"898":0,"899":0,"902":0,"911":1,"912":0,"913":0,"916":0,"917":0,"918":0,"919":0,"920":0,"921":0,"922":0,"923":0,"924":0,"925":0,"927":0,"929":0,"930":0,"932":0,"934":0,"943":1,"944":0,"945":0,"946":0,"948":0,"957":1,"958":0,"959":0,"960":0,"962":0,"965":1,"966":0,"967":0,"968":0,"969":0,"972":0,"975":1,"976":0,"977":0,"980":0,"981":0,"982":0,"983":0,"988":1,"989":0,"990":0,"993":0,"994":0,"995":0,"996":0,"999":0,"1002":1,"1003":0,"1004":0,"1005":0,"1006":0,"1011":1,"1012":0,"1013":0,"1014":0,"1015":0,"1017":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/utils.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/utils.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":1,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":1,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":0,"59":0,"60":0,"61":1,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":1,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":1,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":1,"138":0,"139":0,"140":0,"141":0,"142":1,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":1,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":1,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":1,"184":0,"185":0,"186":0,"187":0,"188":1,"189":1,"190":1,"191":1,"192":2,"193":2,"194":1,"195":2,"196":1,"197":1,"198":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0],"11":[0,0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0,0,0],"44":[0,0,0,0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[2,0],"52":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":2,"23":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":23},"end":{"line":13,"column":36}}},"2":{"name":"(anonymous_2)","line":43,"loc":{"start":{"line":43,"column":13},"end":{"line":43,"column":27}}},"3":{"name":"(anonymous_3)","line":56,"loc":{"start":{"line":56,"column":17},"end":{"line":56,"column":39}}},"4":{"name":"(anonymous_4)","line":67,"loc":{"start":{"line":67,"column":19},"end":{"line":67,"column":41}}},"5":{"name":"(anonymous_5)","line":79,"loc":{"start":{"line":79,"column":18},"end":{"line":79,"column":43}}},"6":{"name":"(anonymous_6)","line":97,"loc":{"start":{"line":97,"column":15},"end":{"line":97,"column":38}}},"7":{"name":"(anonymous_7)","line":125,"loc":{"start":{"line":125,"column":23},"end":{"line":125,"column":37}}},"8":{"name":"(anonymous_8)","line":136,"loc":{"start":{"line":136,"column":22},"end":{"line":136,"column":36}}},"9":{"name":"(anonymous_9)","line":186,"loc":{"start":{"line":186,"column":13},"end":{"line":186,"column":32}}},"10":{"name":"(anonymous_10)","line":189,"loc":{"start":{"line":189,"column":14},"end":{"line":189,"column":44}}},"11":{"name":"(anonymous_11)","line":205,"loc":{"start":{"line":205,"column":18},"end":{"line":205,"column":39}}},"12":{"name":"(anonymous_12)","line":213,"loc":{"start":{"line":213,"column":24},"end":{"line":213,"column":51}}},"13":{"name":"(anonymous_13)","line":230,"loc":{"start":{"line":230,"column":25},"end":{"line":230,"column":55}}},"14":{"name":"(anonymous_14)","line":239,"loc":{"start":{"line":239,"column":17},"end":{"line":239,"column":47}}},"15":{"name":"(anonymous_15)","line":253,"loc":{"start":{"line":253,"column":16},"end":{"line":253,"column":31}}},"16":{"name":"(anonymous_16)","line":266,"loc":{"start":{"line":266,"column":20},"end":{"line":266,"column":53}}},"17":{"name":"(anonymous_17)","line":286,"loc":{"start":{"line":286,"column":14},"end":{"line":286,"column":28}}},"18":{"name":"(anonymous_18)","line":304,"loc":{"start":{"line":304,"column":16},"end":{"line":304,"column":38}}},"19":{"name":"(anonymous_19)","line":315,"loc":{"start":{"line":315,"column":20},"end":{"line":315,"column":41}}},"20":{"name":"(anonymous_20)","line":326,"loc":{"start":{"line":326,"column":14},"end":{"line":326,"column":29}}},"21":{"name":"(anonymous_21)","line":335,"loc":{"start":{"line":335,"column":15},"end":{"line":335,"column":26}}},"22":{"name":"(anonymous_22)","line":338,"loc":{"start":{"line":338,"column":13},"end":{"line":338,"column":31}}},"23":{"name":"(anonymous_23)","line":349,"loc":{"start":{"line":349,"column":17},"end":{"line":349,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":70}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":39}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":34}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":27}},"8":{"start":{"line":13,"column":0},"end":{"line":38,"column":2}},"9":{"start":{"line":14,"column":2},"end":{"line":37,"column":3}},"10":{"start":{"line":15,"column":4},"end":{"line":15,"column":31}},"11":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"12":{"start":{"line":17,"column":6},"end":{"line":17,"column":18}},"13":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"14":{"start":{"line":21,"column":6},"end":{"line":21,"column":30}},"15":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"16":{"start":{"line":25,"column":6},"end":{"line":25,"column":44}},"17":{"start":{"line":28,"column":4},"end":{"line":30,"column":5}},"18":{"start":{"line":29,"column":6},"end":{"line":29,"column":58}},"19":{"start":{"line":32,"column":4},"end":{"line":32,"column":30}},"20":{"start":{"line":33,"column":4},"end":{"line":34,"column":35}},"21":{"start":{"line":34,"column":8},"end":{"line":34,"column":35}},"22":{"start":{"line":35,"column":4},"end":{"line":35,"column":25}},"23":{"start":{"line":43,"column":0},"end":{"line":51,"column":2}},"24":{"start":{"line":44,"column":2},"end":{"line":44,"column":16}},"25":{"start":{"line":45,"column":2},"end":{"line":49,"column":3}},"26":{"start":{"line":46,"column":4},"end":{"line":48,"column":5}},"27":{"start":{"line":47,"column":6},"end":{"line":47,"column":14}},"28":{"start":{"line":50,"column":2},"end":{"line":50,"column":15}},"29":{"start":{"line":56,"column":0},"end":{"line":62,"column":2}},"30":{"start":{"line":57,"column":2},"end":{"line":60,"column":3}},"31":{"start":{"line":59,"column":4},"end":{"line":59,"column":17}},"32":{"start":{"line":61,"column":2},"end":{"line":61,"column":64}},"33":{"start":{"line":67,"column":0},"end":{"line":74,"column":2}},"34":{"start":{"line":68,"column":2},"end":{"line":71,"column":3}},"35":{"start":{"line":70,"column":4},"end":{"line":70,"column":17}},"36":{"start":{"line":73,"column":2},"end":{"line":73,"column":35}},"37":{"start":{"line":79,"column":0},"end":{"line":92,"column":2}},"38":{"start":{"line":80,"column":2},"end":{"line":80,"column":13}},"39":{"start":{"line":81,"column":2},"end":{"line":83,"column":3}},"40":{"start":{"line":82,"column":4},"end":{"line":82,"column":24}},"41":{"start":{"line":85,"column":2},"end":{"line":85,"column":18}},"42":{"start":{"line":86,"column":2},"end":{"line":90,"column":3}},"43":{"start":{"line":87,"column":4},"end":{"line":87,"column":22}},"44":{"start":{"line":88,"column":4},"end":{"line":88,"column":22}},"45":{"start":{"line":88,"column":13},"end":{"line":88,"column":22}},"46":{"start":{"line":89,"column":4},"end":{"line":89,"column":19}},"47":{"start":{"line":91,"column":2},"end":{"line":91,"column":16}},"48":{"start":{"line":97,"column":0},"end":{"line":120,"column":2}},"49":{"start":{"line":98,"column":2},"end":{"line":98,"column":32}},"50":{"start":{"line":99,"column":2},"end":{"line":107,"column":4}},"51":{"start":{"line":109,"column":2},"end":{"line":111,"column":3}},"52":{"start":{"line":110,"column":4},"end":{"line":110,"column":95}},"53":{"start":{"line":113,"column":2},"end":{"line":118,"column":3}},"54":{"start":{"line":114,"column":4},"end":{"line":117,"column":5}},"55":{"start":{"line":115,"column":6},"end":{"line":116,"column":50}},"56":{"start":{"line":119,"column":2},"end":{"line":119,"column":16}},"57":{"start":{"line":125,"column":0},"end":{"line":131,"column":2}},"58":{"start":{"line":126,"column":2},"end":{"line":130,"column":3}},"59":{"start":{"line":127,"column":4},"end":{"line":127,"column":16}},"60":{"start":{"line":129,"column":4},"end":{"line":129,"column":17}},"61":{"start":{"line":136,"column":0},"end":{"line":180,"column":2}},"62":{"start":{"line":137,"column":2},"end":{"line":137,"column":17}},"63":{"start":{"line":138,"column":2},"end":{"line":138,"column":19}},"64":{"start":{"line":139,"column":2},"end":{"line":139,"column":19}},"65":{"start":{"line":140,"column":2},"end":{"line":178,"column":3}},"66":{"start":{"line":141,"column":4},"end":{"line":141,"column":27}},"67":{"start":{"line":143,"column":4},"end":{"line":176,"column":5}},"68":{"start":{"line":144,"column":6},"end":{"line":144,"column":31}},"69":{"start":{"line":146,"column":11},"end":{"line":176,"column":5}},"70":{"start":{"line":147,"column":6},"end":{"line":147,"column":64}},"71":{"start":{"line":148,"column":6},"end":{"line":148,"column":57}},"72":{"start":{"line":150,"column":11},"end":{"line":176,"column":5}},"73":{"start":{"line":151,"column":6},"end":{"line":151,"column":64}},"74":{"start":{"line":152,"column":6},"end":{"line":152,"column":64}},"75":{"start":{"line":153,"column":6},"end":{"line":153,"column":57}},"76":{"start":{"line":155,"column":11},"end":{"line":176,"column":5}},"77":{"start":{"line":156,"column":6},"end":{"line":156,"column":64}},"78":{"start":{"line":157,"column":6},"end":{"line":157,"column":65}},"79":{"start":{"line":158,"column":6},"end":{"line":158,"column":64}},"80":{"start":{"line":159,"column":6},"end":{"line":159,"column":57}},"81":{"start":{"line":161,"column":11},"end":{"line":176,"column":5}},"82":{"start":{"line":162,"column":6},"end":{"line":162,"column":64}},"83":{"start":{"line":163,"column":6},"end":{"line":163,"column":65}},"84":{"start":{"line":164,"column":6},"end":{"line":164,"column":65}},"85":{"start":{"line":165,"column":6},"end":{"line":165,"column":64}},"86":{"start":{"line":166,"column":6},"end":{"line":166,"column":57}},"87":{"start":{"line":168,"column":11},"end":{"line":176,"column":5}},"88":{"start":{"line":169,"column":6},"end":{"line":169,"column":64}},"89":{"start":{"line":170,"column":6},"end":{"line":170,"column":65}},"90":{"start":{"line":171,"column":6},"end":{"line":171,"column":65}},"91":{"start":{"line":172,"column":6},"end":{"line":172,"column":65}},"92":{"start":{"line":173,"column":6},"end":{"line":173,"column":64}},"93":{"start":{"line":174,"column":6},"end":{"line":174,"column":57}},"94":{"start":{"line":179,"column":2},"end":{"line":179,"column":17}},"95":{"start":{"line":186,"column":0},"end":{"line":199,"column":2}},"96":{"start":{"line":187,"column":2},"end":{"line":198,"column":3}},"97":{"start":{"line":188,"column":4},"end":{"line":188,"column":35}},"98":{"start":{"line":189,"column":4},"end":{"line":195,"column":7}},"99":{"start":{"line":190,"column":6},"end":{"line":193,"column":7}},"100":{"start":{"line":191,"column":8},"end":{"line":191,"column":18}},"101":{"start":{"line":192,"column":8},"end":{"line":192,"column":15}},"102":{"start":{"line":194,"column":6},"end":{"line":194,"column":15}},"103":{"start":{"line":197,"column":4},"end":{"line":197,"column":13}},"104":{"start":{"line":205,"column":0},"end":{"line":251,"column":2}},"105":{"start":{"line":206,"column":2},"end":{"line":209,"column":3}},"106":{"start":{"line":207,"column":4},"end":{"line":207,"column":39}},"107":{"start":{"line":208,"column":4},"end":{"line":208,"column":11}},"108":{"start":{"line":210,"column":2},"end":{"line":210,"column":18}},"109":{"start":{"line":211,"column":2},"end":{"line":211,"column":46}},"110":{"start":{"line":212,"column":2},"end":{"line":212,"column":25}},"111":{"start":{"line":213,"column":2},"end":{"line":228,"column":4}},"112":{"start":{"line":214,"column":4},"end":{"line":214,"column":12}},"113":{"start":{"line":215,"column":4},"end":{"line":215,"column":74}},"114":{"start":{"line":216,"column":4},"end":{"line":221,"column":5}},"115":{"start":{"line":217,"column":6},"end":{"line":217,"column":40}},"116":{"start":{"line":220,"column":6},"end":{"line":220,"column":22}},"117":{"start":{"line":222,"column":4},"end":{"line":226,"column":5}},"118":{"start":{"line":223,"column":6},"end":{"line":223,"column":108}},"119":{"start":{"line":225,"column":6},"end":{"line":225,"column":78}},"120":{"start":{"line":227,"column":4},"end":{"line":227,"column":15}},"121":{"start":{"line":229,"column":2},"end":{"line":229,"column":47}},"122":{"start":{"line":230,"column":2},"end":{"line":250,"column":5}},"123":{"start":{"line":231,"column":4},"end":{"line":249,"column":5}},"124":{"start":{"line":232,"column":6},"end":{"line":232,"column":73}},"125":{"start":{"line":233,"column":6},"end":{"line":233,"column":39}},"126":{"start":{"line":234,"column":11},"end":{"line":249,"column":5}},"127":{"start":{"line":235,"column":6},"end":{"line":235,"column":38}},"128":{"start":{"line":237,"column":6},"end":{"line":237,"column":31}},"129":{"start":{"line":238,"column":6},"end":{"line":238,"column":51}},"130":{"start":{"line":239,"column":6},"end":{"line":248,"column":9}},"131":{"start":{"line":240,"column":8},"end":{"line":247,"column":9}},"132":{"start":{"line":241,"column":10},"end":{"line":241,"column":77}},"133":{"start":{"line":242,"column":10},"end":{"line":242,"column":43}},"134":{"start":{"line":243,"column":15},"end":{"line":247,"column":9}},"135":{"start":{"line":244,"column":10},"end":{"line":244,"column":42}},"136":{"start":{"line":246,"column":10},"end":{"line":246,"column":45}},"137":{"start":{"line":253,"column":0},"end":{"line":260,"column":2}},"138":{"start":{"line":254,"column":2},"end":{"line":254,"column":37}},"139":{"start":{"line":255,"column":2},"end":{"line":259,"column":3}},"140":{"start":{"line":256,"column":4},"end":{"line":256,"column":95}},"141":{"start":{"line":258,"column":4},"end":{"line":258,"column":123}},"142":{"start":{"line":266,"column":0},"end":{"line":302,"column":2}},"143":{"start":{"line":267,"column":2},"end":{"line":267,"column":26}},"144":{"start":{"line":268,"column":2},"end":{"line":268,"column":25}},"145":{"start":{"line":269,"column":2},"end":{"line":269,"column":65}},"146":{"start":{"line":270,"column":2},"end":{"line":270,"column":46}},"147":{"start":{"line":271,"column":2},"end":{"line":276,"column":3}},"148":{"start":{"line":272,"column":4},"end":{"line":272,"column":12}},"149":{"start":{"line":273,"column":4},"end":{"line":273,"column":46}},"150":{"start":{"line":275,"column":4},"end":{"line":275,"column":52}},"151":{"start":{"line":278,"column":2},"end":{"line":284,"column":3}},"152":{"start":{"line":279,"column":4},"end":{"line":279,"column":39}},"153":{"start":{"line":280,"column":4},"end":{"line":283,"column":5}},"154":{"start":{"line":281,"column":6},"end":{"line":281,"column":42}},"155":{"start":{"line":282,"column":6},"end":{"line":282,"column":33}},"156":{"start":{"line":286,"column":2},"end":{"line":292,"column":4}},"157":{"start":{"line":287,"column":4},"end":{"line":287,"column":16}},"158":{"start":{"line":288,"column":4},"end":{"line":290,"column":5}},"159":{"start":{"line":289,"column":6},"end":{"line":289,"column":25}},"160":{"start":{"line":291,"column":4},"end":{"line":291,"column":14}},"161":{"start":{"line":293,"column":2},"end":{"line":301,"column":3}},"162":{"start":{"line":294,"column":4},"end":{"line":294,"column":32}},"163":{"start":{"line":295,"column":4},"end":{"line":295,"column":81}},"164":{"start":{"line":296,"column":4},"end":{"line":299,"column":5}},"165":{"start":{"line":297,"column":6},"end":{"line":297,"column":42}},"166":{"start":{"line":298,"column":6},"end":{"line":298,"column":25}},"167":{"start":{"line":300,"column":4},"end":{"line":300,"column":36}},"168":{"start":{"line":304,"column":0},"end":{"line":313,"column":2}},"169":{"start":{"line":305,"column":2},"end":{"line":305,"column":49}},"170":{"start":{"line":305,"column":35},"end":{"line":305,"column":49}},"171":{"start":{"line":307,"column":2},"end":{"line":307,"column":30}},"172":{"start":{"line":308,"column":2},"end":{"line":308,"column":22}},"173":{"start":{"line":309,"column":2},"end":{"line":311,"column":3}},"174":{"start":{"line":310,"column":4},"end":{"line":310,"column":35}},"175":{"start":{"line":312,"column":2},"end":{"line":312,"column":16}},"176":{"start":{"line":315,"column":0},"end":{"line":324,"column":2}},"177":{"start":{"line":316,"column":2},"end":{"line":316,"column":14}},"178":{"start":{"line":317,"column":2},"end":{"line":322,"column":3}},"179":{"start":{"line":318,"column":4},"end":{"line":320,"column":5}},"180":{"start":{"line":319,"column":6},"end":{"line":319,"column":16}},"181":{"start":{"line":321,"column":4},"end":{"line":321,"column":35}},"182":{"start":{"line":323,"column":2},"end":{"line":323,"column":13}},"183":{"start":{"line":326,"column":0},"end":{"line":333,"column":2}},"184":{"start":{"line":327,"column":2},"end":{"line":331,"column":3}},"185":{"start":{"line":328,"column":4},"end":{"line":330,"column":5}},"186":{"start":{"line":329,"column":6},"end":{"line":329,"column":18}},"187":{"start":{"line":332,"column":2},"end":{"line":332,"column":15}},"188":{"start":{"line":335,"column":0},"end":{"line":347,"column":4}},"189":{"start":{"line":336,"column":2},"end":{"line":336,"column":38}},"190":{"start":{"line":337,"column":2},"end":{"line":337,"column":15}},"191":{"start":{"line":338,"column":2},"end":{"line":342,"column":4}},"192":{"start":{"line":339,"column":4},"end":{"line":341,"column":5}},"193":{"start":{"line":340,"column":6},"end":{"line":340,"column":32}},"194":{"start":{"line":343,"column":2},"end":{"line":345,"column":3}},"195":{"start":{"line":344,"column":4},"end":{"line":344,"column":30}},"196":{"start":{"line":346,"column":2},"end":{"line":346,"column":13}},"197":{"start":{"line":349,"column":0},"end":{"line":351,"column":2}},"198":{"start":{"line":350,"column":2},"end":{"line":350,"column":49}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":2},"end":{"line":14,"column":2}},{"start":{"line":14,"column":2},"end":{"line":14,"column":2}}]},"2":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":16,"column":4}},{"start":{"line":16,"column":4},"end":{"line":16,"column":4}}]},"3":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":20,"column":4}},{"start":{"line":20,"column":4},"end":{"line":20,"column":4}}]},"4":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":4}},{"start":{"line":24,"column":4},"end":{"line":24,"column":4}}]},"5":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":28,"column":4}},{"start":{"line":28,"column":4},"end":{"line":28,"column":4}}]},"6":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":4},"end":{"line":46,"column":4}},{"start":{"line":46,"column":4},"end":{"line":46,"column":4}}]},"7":{"line":46,"type":"binary-expr","locations":[{"start":{"line":46,"column":8},"end":{"line":46,"column":29}},{"start":{"line":46,"column":33},"end":{"line":46,"column":61}}]},"8":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":57,"column":2}},{"start":{"line":57,"column":2},"end":{"line":57,"column":2}}]},"9":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":6},"end":{"line":57,"column":29}},{"start":{"line":57,"column":33},"end":{"line":57,"column":59}},{"start":{"line":58,"column":4},"end":{"line":58,"column":30}}]},"10":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":2},"end":{"line":68,"column":2}},{"start":{"line":68,"column":2},"end":{"line":68,"column":2}}]},"11":{"line":68,"type":"binary-expr","locations":[{"start":{"line":68,"column":6},"end":{"line":68,"column":29}},{"start":{"line":68,"column":33},"end":{"line":68,"column":59}},{"start":{"line":69,"column":4},"end":{"line":69,"column":30}}]},"12":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"13":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":11},"end":{"line":98,"column":17}},{"start":{"line":98,"column":21},"end":{"line":98,"column":31}}]},"14":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":2},"end":{"line":109,"column":2}},{"start":{"line":109,"column":2},"end":{"line":109,"column":2}}]},"15":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":4},"end":{"line":114,"column":4}},{"start":{"line":114,"column":4},"end":{"line":114,"column":4}}]},"16":{"line":115,"type":"cond-expr","locations":[{"start":{"line":115,"column":66},"end":{"line":115,"column":70}},{"start":{"line":116,"column":8},"end":{"line":116,"column":48}}]},"17":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":2},"end":{"line":126,"column":2}},{"start":{"line":126,"column":2},"end":{"line":126,"column":2}}]},"18":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":143,"column":4}},{"start":{"line":143,"column":4},"end":{"line":143,"column":4}}]},"19":{"line":143,"type":"binary-expr","locations":[{"start":{"line":143,"column":9},"end":{"line":143,"column":18}},{"start":{"line":143,"column":24},"end":{"line":143,"column":34}}]},"20":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":11},"end":{"line":146,"column":11}},{"start":{"line":146,"column":11},"end":{"line":146,"column":11}}]},"21":{"line":146,"type":"binary-expr","locations":[{"start":{"line":146,"column":16},"end":{"line":146,"column":26}},{"start":{"line":146,"column":32},"end":{"line":146,"column":43}}]},"22":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":11},"end":{"line":150,"column":11}},{"start":{"line":150,"column":11},"end":{"line":150,"column":11}}]},"23":{"line":150,"type":"binary-expr","locations":[{"start":{"line":150,"column":16},"end":{"line":150,"column":27}},{"start":{"line":150,"column":33},"end":{"line":150,"column":45}}]},"24":{"line":155,"type":"if","locations":[{"start":{"line":155,"column":11},"end":{"line":155,"column":11}},{"start":{"line":155,"column":11},"end":{"line":155,"column":11}}]},"25":{"line":155,"type":"binary-expr","locations":[{"start":{"line":155,"column":16},"end":{"line":155,"column":29}},{"start":{"line":155,"column":35},"end":{"line":155,"column":49}}]},"26":{"line":161,"type":"if","locations":[{"start":{"line":161,"column":11},"end":{"line":161,"column":11}},{"start":{"line":161,"column":11},"end":{"line":161,"column":11}}]},"27":{"line":161,"type":"binary-expr","locations":[{"start":{"line":161,"column":16},"end":{"line":161,"column":30}},{"start":{"line":161,"column":36},"end":{"line":161,"column":51}}]},"28":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":11},"end":{"line":168,"column":11}},{"start":{"line":168,"column":11},"end":{"line":168,"column":11}}]},"29":{"line":168,"type":"binary-expr","locations":[{"start":{"line":168,"column":16},"end":{"line":168,"column":31}},{"start":{"line":168,"column":37},"end":{"line":168,"column":53}}]},"30":{"line":187,"type":"if","locations":[{"start":{"line":187,"column":2},"end":{"line":187,"column":2}},{"start":{"line":187,"column":2},"end":{"line":187,"column":2}}]},"31":{"line":190,"type":"if","locations":[{"start":{"line":190,"column":6},"end":{"line":190,"column":6}},{"start":{"line":190,"column":6},"end":{"line":190,"column":6}}]},"32":{"line":206,"type":"if","locations":[{"start":{"line":206,"column":2},"end":{"line":206,"column":2}},{"start":{"line":206,"column":2},"end":{"line":206,"column":2}}]},"33":{"line":206,"type":"binary-expr","locations":[{"start":{"line":206,"column":6},"end":{"line":206,"column":18}},{"start":{"line":206,"column":22},"end":{"line":206,"column":40}}]},"34":{"line":211,"type":"binary-expr","locations":[{"start":{"line":211,"column":13},"end":{"line":211,"column":24}},{"start":{"line":211,"column":28},"end":{"line":211,"column":45}}]},"35":{"line":216,"type":"if","locations":[{"start":{"line":216,"column":4},"end":{"line":216,"column":4}},{"start":{"line":216,"column":4},"end":{"line":216,"column":4}}]},"36":{"line":216,"type":"binary-expr","locations":[{"start":{"line":216,"column":7},"end":{"line":216,"column":19}},{"start":{"line":216,"column":23},"end":{"line":216,"column":48}}]},"37":{"line":222,"type":"if","locations":[{"start":{"line":222,"column":4},"end":{"line":222,"column":4}},{"start":{"line":222,"column":4},"end":{"line":222,"column":4}}]},"38":{"line":231,"type":"if","locations":[{"start":{"line":231,"column":4},"end":{"line":231,"column":4}},{"start":{"line":231,"column":4},"end":{"line":231,"column":4}}]},"39":{"line":234,"type":"if","locations":[{"start":{"line":234,"column":11},"end":{"line":234,"column":11}},{"start":{"line":234,"column":11},"end":{"line":234,"column":11}}]},"40":{"line":240,"type":"if","locations":[{"start":{"line":240,"column":8},"end":{"line":240,"column":8}},{"start":{"line":240,"column":8},"end":{"line":240,"column":8}}]},"41":{"line":243,"type":"if","locations":[{"start":{"line":243,"column":15},"end":{"line":243,"column":15}},{"start":{"line":243,"column":15},"end":{"line":243,"column":15}}]},"42":{"line":255,"type":"if","locations":[{"start":{"line":255,"column":2},"end":{"line":255,"column":2}},{"start":{"line":255,"column":2},"end":{"line":255,"column":2}}]},"43":{"line":256,"type":"binary-expr","locations":[{"start":{"line":256,"column":11},"end":{"line":256,"column":31}},{"start":{"line":256,"column":35},"end":{"line":256,"column":55}},{"start":{"line":256,"column":59},"end":{"line":256,"column":77}},{"start":{"line":256,"column":81},"end":{"line":256,"column":94}}]},"44":{"line":258,"type":"binary-expr","locations":[{"start":{"line":258,"column":11},"end":{"line":258,"column":31}},{"start":{"line":258,"column":35},"end":{"line":258,"column":55}},{"start":{"line":258,"column":59},"end":{"line":258,"column":77}},{"start":{"line":258,"column":81},"end":{"line":258,"column":94}},{"start":{"line":258,"column":98},"end":{"line":258,"column":122}}]},"45":{"line":271,"type":"if","locations":[{"start":{"line":271,"column":2},"end":{"line":271,"column":2}},{"start":{"line":271,"column":2},"end":{"line":271,"column":2}}]},"46":{"line":280,"type":"if","locations":[{"start":{"line":280,"column":4},"end":{"line":280,"column":4}},{"start":{"line":280,"column":4},"end":{"line":280,"column":4}}]},"47":{"line":305,"type":"if","locations":[{"start":{"line":305,"column":2},"end":{"line":305,"column":2}},{"start":{"line":305,"column":2},"end":{"line":305,"column":2}}]},"48":{"line":305,"type":"binary-expr","locations":[{"start":{"line":305,"column":6},"end":{"line":305,"column":10}},{"start":{"line":305,"column":14},"end":{"line":305,"column":33}}]},"49":{"line":318,"type":"if","locations":[{"start":{"line":318,"column":4},"end":{"line":318,"column":4}},{"start":{"line":318,"column":4},"end":{"line":318,"column":4}}]},"50":{"line":328,"type":"if","locations":[{"start":{"line":328,"column":4},"end":{"line":328,"column":4}},{"start":{"line":328,"column":4},"end":{"line":328,"column":4}}]},"51":{"line":339,"type":"if","locations":[{"start":{"line":339,"column":4},"end":{"line":339,"column":4}},{"start":{"line":339,"column":4},"end":{"line":339,"column":4}}]},"52":{"line":350,"type":"binary-expr","locations":[{"start":{"line":350,"column":9},"end":{"line":350,"column":32}},{"start":{"line":350,"column":36},"end":{"line":350,"column":48}}]}},"code":["var os = require('os');","var util = require('util');","var exec = require('child_process').exec;","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var Constants = require('./constants');","var pomelo = require('../pomelo');","","var utils = module.exports;","","/**"," * Invoke callback with check"," */","utils.invokeCallback = function(cb) {","  if (typeof cb === 'function') {","    var len = arguments.length;","    if(len == 1) {","      return cb();","    }","","    if(len == 2) {","      return cb(arguments[1]);","    }","","    if(len == 3) {","      return cb(arguments[1], arguments[2]);","    }","","    if(len == 4) {","      return cb(arguments[1], arguments[2], arguments[3]);","    }","","    var args = Array(len - 1);","    for (i = 1; i < len; i++)","        args[i - 1] = arguments[i];","    cb.apply(null, args);","    // cb.apply(null, Array.prototype.slice.call(arguments, 1));","  }","};","","/**"," * Get the count of elements of object"," */","utils.size = function(obj) {","  var count = 0;","  for (var i in obj) {","    if (obj.hasOwnProperty(i) && typeof obj[i] !== 'function') {","      count++;","    }","  }","  return count;","};","","/**"," * Check a string whether ends with another string"," */","utils.endsWith = function(str, suffix) {","  if (typeof str !== 'string' || typeof suffix !== 'string' ||","    suffix.length > str.length) {","    return false;","  }","  return str.indexOf(suffix, str.length - suffix.length) !== -1;","};","","/**"," * Check a string whether starts with another string"," */","utils.startsWith = function(str, prefix) {","  if (typeof str !== 'string' || typeof prefix !== 'string' ||","    prefix.length > str.length) {","    return false;","  }","","  return str.indexOf(prefix) === 0;","};","","/**"," * Compare the two arrays and return the difference."," */","utils.arrayDiff = function(array1, array2) {","  var o = {};","  for(var i = 0, len = array2.length; i < len; i++) {","    o[array2[i]] = true;","  }","","  var result = [];","  for(i = 0, len = array1.length; i < len; i++) {","    var v = array1[i];","    if(o[v]) continue;","    result.push(v);","  }","  return result;","};","","/*"," * Date format"," */","utils.format = function(date, format) {","  format = format || 'MMddhhmm';","  var o = {","    \"M+\": date.getMonth() + 1, //month","    \"d+\": date.getDate(), //day","    \"h+\": date.getHours(), //hour","    \"m+\": date.getMinutes(), //minute","    \"s+\": date.getSeconds(), //second","    \"q+\": Math.floor((date.getMonth() + 3) / 3), //quarter","    \"S\": date.getMilliseconds() //millisecond","  };","","  if (/(y+)/.test(format)) {","    format = format.replace(RegExp.$1, (date.getFullYear() + \"\").substr(4 - RegExp.$1.length));","  }","","  for (var k in o) {","    if (new RegExp(\"(\" + k + \")\").test(format)) {","      format = format.replace(RegExp.$1, RegExp.$1.length === 1 ? o[k] :","        (\"00\" + o[k]).substr((\"\" + o[k]).length));","    }","  }","  return format;","};","","/**"," * check if has Chinese characters."," */","utils.hasChineseChar = function(str) {","  if (/.*[\\u4e00-\\u9fa5]+.*$/.test(str)) {","    return true;","  } else {","    return false;","  }","};","","/**"," * transform unicode to utf8"," */","utils.unicodeToUtf8 = function(str) {","  var i, len, ch;","  var utf8Str = \"\";","  len = str.length;","  for (i = 0; i < len; i++) {","    ch = str.charCodeAt(i);","","    if ((ch >= 0x0) && (ch <= 0x7F)) {","      utf8Str += str.charAt(i);","","    } else if ((ch >= 0x80) && (ch <= 0x7FF)) {","      utf8Str += String.fromCharCode(0xc0 | ((ch >> 6) & 0x1F));","      utf8Str += String.fromCharCode(0x80 | (ch & 0x3F));","","    } else if ((ch >= 0x800) && (ch <= 0xFFFF)) {","      utf8Str += String.fromCharCode(0xe0 | ((ch >> 12) & 0xF));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 6) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | (ch & 0x3F));","","    } else if ((ch >= 0x10000) && (ch <= 0x1FFFFF)) {","      utf8Str += String.fromCharCode(0xF0 | ((ch >> 18) & 0x7));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 12) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 6) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | (ch & 0x3F));","","    } else if ((ch >= 0x200000) && (ch <= 0x3FFFFFF)) {","      utf8Str += String.fromCharCode(0xF8 | ((ch >> 24) & 0x3));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 18) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 12) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 6) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | (ch & 0x3F));","","    } else if ((ch >= 0x4000000) && (ch <= 0x7FFFFFFF)) {","      utf8Str += String.fromCharCode(0xFC | ((ch >> 30) & 0x1));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 24) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 18) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 12) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | ((ch >> 6) & 0x3F));","      utf8Str += String.fromCharCode(0x80 | (ch & 0x3F));","","    }","","  }","  return utf8Str;","};","","/**"," * Ping server to check if network is available"," *"," */","utils.ping = function(host, cb) {","  if(!module.exports.isLocal(host)) {","    var cmd = 'ping -w 15 ' + host;","    exec(cmd, function(err, stdout, stderr) {","      if(!!err) {","        cb(false);","        return;","      }","      cb(true);","    });","  } else {","    cb(true);","  }","};","","/**"," * Check if server is exsit. "," *"," */","utils.checkPort = function(server, cb) {","  if (!server.port && !server.clientPort) {","    this.invokeCallback(cb, 'leisure');","    return;","  }","  var self = this;","  var port = server.port || server.clientPort;","  var host = server.host;","  var generateCommand = function(self, host, port) {","    var cmd;","    var ssh_params = pomelo.app.get(Constants.RESERVED.SSH_CONFIG_PARAMS);","    if(!!ssh_params && Array.isArray(ssh_params)) {","      ssh_params = ssh_params.join(' ');","    }","    else {","      ssh_params = \"\";","    }","    if (!self.isLocal(host)) {","      cmd = util.format('ssh %s %s \"netstat -an|awk \\'{print $4}\\'|grep %s|wc -l\"', host, ssh_params, port);","    } else {","      cmd = util.format('netstat -an|awk \\'{print $4}\\'|grep %s|wc -l', port);","    }","    return cmd;","  };","  var cmd1 = generateCommand(self, host, port);","  var child = exec(cmd1, function(err, stdout, stderr) {","    if(err) {","      logger.error('command %s execute with error: %j', cmd1, err.stack);","      self.invokeCallback(cb, 'error');","    } else if(stdout.trim() !== '0') {","      self.invokeCallback(cb, 'busy');","    } else {","      port = server.clientPort;","      var cmd2 = generateCommand(self, host, port);","      exec(cmd2, function(err, stdout, stderr) {","        if(err) {","          logger.error('command %s execute with error: %j', cmd2, err.stack);","          self.invokeCallback(cb, 'error');","        } else if (stdout.trim() !== '0') {","          self.invokeCallback(cb, 'busy');","        } else {","          self.invokeCallback(cb, 'leisure');","        }","      });","    }","  });","};","","utils.isLocal = function(host) {","  var app = require('../pomelo').app;","  if(!app) {","    return host === '127.0.0.1' || host === 'localhost' || host === '0.0.0.0' || inLocal(host);","  } else {","    return host === '127.0.0.1' || host === 'localhost' || host === '0.0.0.0' || inLocal(host) || host === app.master.host;","  }","};","","/**"," * Load cluster server."," *"," */","utils.loadCluster = function(app, server, serverMap) {","  var increaseFields = {};","  var host = server.host;","  var count = parseInt(server[Constants.RESERVED.CLUSTER_COUNT]);","  var seq = app.clusterSeq[server.serverType];","  if(!seq) {","    seq = 0;","    app.clusterSeq[server.serverType] = count;","  } else {","    app.clusterSeq[server.serverType] = seq + count;","  }","","  for(var key in server) {","    var value = server[key].toString();","    if(value.indexOf(Constants.RESERVED.CLUSTER_SIGNAL) > 0) {","      var base = server[key].slice(0, -2);","      increaseFields[key] = base;","    }","  }","","  var clone = function(src) {","    var rs = {};","    for(var key in src) {","      rs[key] = src[key];","    }","    return rs;","  };","  for(var i=0, l=seq; i<count; i++,l++) {","    var cserver = clone(server);","    cserver.id = Constants.RESERVED.CLUSTER_PREFIX + server.serverType + '-' + l;","    for(var k in increaseFields) {","      var v = parseInt(increaseFields[k]);","      cserver[k] = v + i;","    }","    serverMap[cserver.id] = cserver;","  }","};","","utils.extends = function(origin, add) {","  if (!add || !this.isObject(add)) return origin;","","  var keys = Object.keys(add);","  var i = keys.length;","  while (i--) {","    origin[keys[i]] = add[keys[i]];","  }","  return origin;","};","","utils.headHandler = function(headBuffer) {","  var len = 0;","  for(var i=1; i<4; i++) {","    if(i > 1) {","      len <<= 8;","    }","    len += headBuffer.readUInt8(i);","  }","  return len;","};","","var inLocal = function(host) {","  for (var index in localIps) {","    if (host === localIps[index]) {","      return true;","    }","  }","  return false;","};","","var localIps = function() {","  var ifaces = os.networkInterfaces();","  var ips = [];","  var func = function(details) {","    if (details.family === 'IPv4') {","      ips.push(details.address);","    }","  };","  for (var dev in ifaces) {","    ifaces[dev].forEach(func);","  }","  return ips;","}();","","utils.isObject = function(arg) {","  return typeof arg === 'object' && arg !== null;","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"13":1,"14":0,"15":0,"16":0,"17":0,"20":0,"21":0,"24":0,"25":0,"28":0,"29":0,"32":0,"33":0,"34":0,"35":0,"43":1,"44":0,"45":0,"46":0,"47":0,"50":0,"56":1,"57":0,"59":0,"61":0,"67":1,"68":0,"70":0,"73":0,"79":1,"80":0,"81":0,"82":0,"85":0,"86":0,"87":0,"88":0,"89":0,"91":0,"97":1,"98":0,"99":0,"109":0,"110":0,"113":0,"114":0,"115":0,"119":0,"125":1,"126":0,"127":0,"129":0,"136":1,"137":0,"138":0,"139":0,"140":0,"141":0,"143":0,"144":0,"146":0,"147":0,"148":0,"150":0,"151":0,"152":0,"153":0,"155":0,"156":0,"157":0,"158":0,"159":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"179":0,"186":1,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"194":0,"197":0,"205":1,"206":0,"207":0,"208":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"220":0,"222":0,"223":0,"225":0,"227":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"246":0,"253":1,"254":0,"255":0,"256":0,"258":0,"266":1,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"275":0,"278":0,"279":0,"280":0,"281":0,"282":0,"286":0,"287":0,"288":0,"289":0,"291":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"300":0,"304":1,"305":0,"307":0,"308":0,"309":0,"310":0,"312":0,"315":1,"316":0,"317":0,"318":0,"319":0,"321":0,"323":0,"326":1,"327":0,"328":0,"329":0,"332":0,"335":1,"336":1,"337":1,"338":1,"339":2,"340":2,"343":1,"344":2,"346":1,"349":1,"350":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}}},"branchMap":{},"code":["module.exports = require('./lib/logger');"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/lib/logger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/lib/logger.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":60,"7":60,"8":60,"9":60,"10":0,"11":60,"12":60,"13":60,"14":60,"15":60,"16":60,"17":2100,"18":60,"19":420,"20":4,"21":4,"22":4,"23":4,"24":4,"25":0,"26":4,"27":4,"28":4,"29":4,"30":60,"31":1,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":1,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":1,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":1,"65":0,"66":0,"67":0,"68":0,"69":1,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":1,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":1,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":1,"125":0,"126":1,"127":0,"128":1,"129":0,"130":1,"131":0,"132":0,"133":0,"134":1,"135":4,"136":1,"137":4,"138":1,"139":4,"140":1,"141":1,"142":1},"b":{"1":[0,60],"2":[60,0],"3":[4,0],"4":[4,0],"5":[0,4],"6":[4,4],"7":[4,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[4,0],"42":[4,0]},"f":{"1":60,"2":420,"3":4,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":4,"18":4,"19":4},"fnMap":{"1":{"name":"getLogger","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":33}}},"2":{"name":"(anonymous_2)","line":31,"loc":{"start":{"line":31,"column":69},"end":{"line":31,"column":84}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":18},"end":{"line":32,"column":29}}},"4":{"name":"initReloadConfiguration","line":55,"loc":{"start":{"line":55,"column":0},"end":{"line":55,"column":55}}},"5":{"name":"getMTime","line":65,"loc":{"start":{"line":65,"column":0},"end":{"line":65,"column":28}}},"6":{"name":"loadConfigurationFile","line":75,"loc":{"start":{"line":75,"column":0},"end":{"line":75,"column":41}}},"7":{"name":"reloadConfiguration","line":82,"loc":{"start":{"line":82,"column":0},"end":{"line":82,"column":31}}},"8":{"name":"configureOnceOff","line":94,"loc":{"start":{"line":94,"column":0},"end":{"line":94,"column":34}}},"9":{"name":"configureLevels","line":112,"loc":{"start":{"line":112,"column":0},"end":{"line":112,"column":33}}},"10":{"name":"configure","line":136,"loc":{"start":{"line":136,"column":0},"end":{"line":136,"column":33}}},"11":{"name":"replaceProperties","line":166,"loc":{"start":{"line":166,"column":0},"end":{"line":166,"column":44}}},"12":{"name":"doReplace","line":190,"loc":{"start":{"line":190,"column":0},"end":{"line":190,"column":30}}},"13":{"name":"doEnv","line":230,"loc":{"start":{"line":230,"column":0},"end":{"line":230,"column":21}}},"14":{"name":"doArgs","line":234,"loc":{"start":{"line":234,"column":0},"end":{"line":234,"column":22}}},"15":{"name":"doOpts","line":238,"loc":{"start":{"line":238,"column":0},"end":{"line":238,"column":28}}},"16":{"name":"getLine","line":242,"loc":{"start":{"line":242,"column":0},"end":{"line":242,"column":19}}},"17":{"name":"colorizeStart","line":249,"loc":{"start":{"line":249,"column":0},"end":{"line":249,"column":30}}},"18":{"name":"colorizeEnd","line":253,"loc":{"start":{"line":253,"column":0},"end":{"line":253,"column":28}}},"19":{"name":"colorize","line":259,"loc":{"start":{"line":259,"column":0},"end":{"line":259,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":23}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"4":{"start":{"line":6,"column":0},"end":{"line":10,"column":2}},"5":{"start":{"line":12,"column":0},"end":{"line":51,"column":1}},"6":{"start":{"line":13,"column":1},"end":{"line":13,"column":22}},"7":{"start":{"line":14,"column":1},"end":{"line":14,"column":17}},"8":{"start":{"line":15,"column":1},"end":{"line":20,"column":2}},"9":{"start":{"line":16,"column":2},"end":{"line":19,"column":29}},"10":{"start":{"line":17,"column":3},"end":{"line":17,"column":37}},"11":{"start":{"line":19,"column":3},"end":{"line":19,"column":29}},"12":{"start":{"line":21,"column":1},"end":{"line":24,"column":2}},"13":{"start":{"line":23,"column":2},"end":{"line":23,"column":57}},"14":{"start":{"line":25,"column":1},"end":{"line":25,"column":45}},"15":{"start":{"line":26,"column":1},"end":{"line":26,"column":18}},"16":{"start":{"line":27,"column":1},"end":{"line":29,"column":2}},"17":{"start":{"line":28,"column":2},"end":{"line":28,"column":29}},"18":{"start":{"line":31,"column":1},"end":{"line":49,"column":4}},"19":{"start":{"line":32,"column":2},"end":{"line":48,"column":3}},"20":{"start":{"line":33,"column":3},"end":{"line":33,"column":14}},"21":{"start":{"line":34,"column":3},"end":{"line":42,"column":4}},"22":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"23":{"start":{"line":36,"column":5},"end":{"line":36,"column":29}},"24":{"start":{"line":38,"column":4},"end":{"line":40,"column":5}},"25":{"start":{"line":39,"column":5},"end":{"line":39,"column":30}},"26":{"start":{"line":41,"column":4},"end":{"line":41,"column":35}},"27":{"start":{"line":44,"column":3},"end":{"line":46,"column":4}},"28":{"start":{"line":45,"column":4},"end":{"line":45,"column":36}},"29":{"start":{"line":47,"column":3},"end":{"line":47,"column":41}},"30":{"start":{"line":50,"column":1},"end":{"line":50,"column":16}},"31":{"start":{"line":53,"column":0},"end":{"line":53,"column":21}},"32":{"start":{"line":55,"column":0},"end":{"line":63,"column":1}},"33":{"start":{"line":56,"column":1},"end":{"line":59,"column":2}},"34":{"start":{"line":57,"column":2},"end":{"line":57,"column":37}},"35":{"start":{"line":58,"column":2},"end":{"line":58,"column":29}},"36":{"start":{"line":60,"column":1},"end":{"line":60,"column":33}},"37":{"start":{"line":61,"column":1},"end":{"line":61,"column":44}},"38":{"start":{"line":62,"column":1},"end":{"line":62,"column":75}},"39":{"start":{"line":65,"column":0},"end":{"line":73,"column":1}},"40":{"start":{"line":66,"column":1},"end":{"line":66,"column":11}},"41":{"start":{"line":67,"column":1},"end":{"line":71,"column":2}},"42":{"start":{"line":68,"column":2},"end":{"line":68,"column":38}},"43":{"start":{"line":70,"column":2},"end":{"line":70,"column":67}},"44":{"start":{"line":72,"column":1},"end":{"line":72,"column":14}},"45":{"start":{"line":75,"column":0},"end":{"line":80,"column":1}},"46":{"start":{"line":76,"column":1},"end":{"line":78,"column":2}},"47":{"start":{"line":77,"column":2},"end":{"line":77,"column":55}},"48":{"start":{"line":79,"column":1},"end":{"line":79,"column":18}},"49":{"start":{"line":82,"column":0},"end":{"line":91,"column":1}},"50":{"start":{"line":83,"column":1},"end":{"line":83,"column":44}},"51":{"start":{"line":84,"column":1},"end":{"line":86,"column":2}},"52":{"start":{"line":85,"column":2},"end":{"line":85,"column":9}},"53":{"start":{"line":87,"column":1},"end":{"line":89,"column":2}},"54":{"start":{"line":88,"column":2},"end":{"line":88,"column":64}},"55":{"start":{"line":90,"column":1},"end":{"line":90,"column":31}},"56":{"start":{"line":94,"column":0},"end":{"line":110,"column":1}},"57":{"start":{"line":95,"column":1},"end":{"line":109,"column":2}},"58":{"start":{"line":96,"column":2},"end":{"line":108,"column":3}},"59":{"start":{"line":97,"column":3},"end":{"line":97,"column":34}},"60":{"start":{"line":98,"column":3},"end":{"line":102,"column":4}},"61":{"start":{"line":99,"column":4},"end":{"line":99,"column":28}},"62":{"start":{"line":101,"column":4},"end":{"line":101,"column":28}},"63":{"start":{"line":104,"column":3},"end":{"line":107,"column":5}},"64":{"start":{"line":112,"column":0},"end":{"line":120,"column":1}},"65":{"start":{"line":113,"column":1},"end":{"line":119,"column":2}},"66":{"start":{"line":114,"column":2},"end":{"line":118,"column":3}},"67":{"start":{"line":115,"column":3},"end":{"line":117,"column":4}},"68":{"start":{"line":116,"column":4},"end":{"line":116,"column":58}},"69":{"start":{"line":136,"column":0},"end":{"line":164,"column":1}},"70":{"start":{"line":137,"column":1},"end":{"line":137,"column":23}},"71":{"start":{"line":138,"column":1},"end":{"line":138,"column":46}},"72":{"start":{"line":139,"column":1},"end":{"line":139,"column":19}},"73":{"start":{"line":141,"column":1},"end":{"line":143,"column":2}},"74":{"start":{"line":142,"column":2},"end":{"line":142,"column":55}},"75":{"start":{"line":145,"column":1},"end":{"line":147,"column":2}},"76":{"start":{"line":146,"column":2},"end":{"line":146,"column":43}},"77":{"start":{"line":149,"column":1},"end":{"line":151,"column":2}},"78":{"start":{"line":150,"column":2},"end":{"line":150,"column":33}},"79":{"start":{"line":153,"column":1},"end":{"line":155,"column":2}},"80":{"start":{"line":154,"column":2},"end":{"line":154,"column":33}},"81":{"start":{"line":157,"column":1},"end":{"line":159,"column":2}},"82":{"start":{"line":158,"column":2},"end":{"line":158,"column":55}},"83":{"start":{"line":163,"column":1},"end":{"line":163,"column":32}},"84":{"start":{"line":166,"column":0},"end":{"line":188,"column":1}},"85":{"start":{"line":167,"column":1},"end":{"line":185,"column":2}},"86":{"start":{"line":168,"column":2},"end":{"line":170,"column":3}},"87":{"start":{"line":169,"column":3},"end":{"line":169,"column":56}},"88":{"start":{"line":171,"column":8},"end":{"line":185,"column":2}},"89":{"start":{"line":172,"column":2},"end":{"line":172,"column":12}},"90":{"start":{"line":173,"column":2},"end":{"line":184,"column":3}},"91":{"start":{"line":174,"column":3},"end":{"line":176,"column":4}},"92":{"start":{"line":175,"column":4},"end":{"line":175,"column":13}},"93":{"start":{"line":178,"column":3},"end":{"line":178,"column":24}},"94":{"start":{"line":179,"column":3},"end":{"line":183,"column":4}},"95":{"start":{"line":180,"column":4},"end":{"line":180,"column":42}},"96":{"start":{"line":181,"column":10},"end":{"line":183,"column":4}},"97":{"start":{"line":182,"column":4},"end":{"line":182,"column":50}},"98":{"start":{"line":187,"column":1},"end":{"line":187,"column":18}},"99":{"start":{"line":190,"column":0},"end":{"line":228,"column":1}},"100":{"start":{"line":191,"column":1},"end":{"line":193,"column":2}},"101":{"start":{"line":192,"column":2},"end":{"line":192,"column":13}},"102":{"start":{"line":195,"column":1},"end":{"line":195,"column":26}},"103":{"start":{"line":196,"column":1},"end":{"line":197,"column":16}},"104":{"start":{"line":198,"column":1},"end":{"line":221,"column":2}},"105":{"start":{"line":199,"column":2},"end":{"line":199,"column":13}},"106":{"start":{"line":200,"column":2},"end":{"line":200,"column":22}},"107":{"start":{"line":201,"column":2},"end":{"line":204,"column":3}},"108":{"start":{"line":202,"column":3},"end":{"line":202,"column":14}},"109":{"start":{"line":203,"column":3},"end":{"line":203,"column":12}},"110":{"start":{"line":206,"column":2},"end":{"line":206,"column":16}},"111":{"start":{"line":207,"column":2},"end":{"line":207,"column":15}},"112":{"start":{"line":208,"column":2},"end":{"line":210,"column":3}},"113":{"start":{"line":209,"column":3},"end":{"line":209,"column":24}},"114":{"start":{"line":212,"column":2},"end":{"line":212,"column":22}},"115":{"start":{"line":213,"column":2},"end":{"line":216,"column":3}},"116":{"start":{"line":214,"column":3},"end":{"line":214,"column":14}},"117":{"start":{"line":215,"column":3},"end":{"line":215,"column":12}},"118":{"start":{"line":218,"column":2},"end":{"line":218,"column":43}},"119":{"start":{"line":219,"column":2},"end":{"line":219,"column":28}},"120":{"start":{"line":220,"column":2},"end":{"line":220,"column":44}},"121":{"start":{"line":223,"column":1},"end":{"line":225,"column":2}},"122":{"start":{"line":224,"column":2},"end":{"line":224,"column":34}},"123":{"start":{"line":227,"column":1},"end":{"line":227,"column":12}},"124":{"start":{"line":230,"column":0},"end":{"line":232,"column":1}},"125":{"start":{"line":231,"column":1},"end":{"line":231,"column":26}},"126":{"start":{"line":234,"column":0},"end":{"line":236,"column":1}},"127":{"start":{"line":235,"column":1},"end":{"line":235,"column":27}},"128":{"start":{"line":238,"column":0},"end":{"line":240,"column":1}},"129":{"start":{"line":239,"column":1},"end":{"line":239,"column":38}},"130":{"start":{"line":242,"column":0},"end":{"line":247,"column":1}},"131":{"start":{"line":243,"column":1},"end":{"line":243,"column":21}},"132":{"start":{"line":245,"column":1},"end":{"line":245,"column":49}},"133":{"start":{"line":246,"column":1},"end":{"line":246,"column":13}},"134":{"start":{"line":249,"column":0},"end":{"line":251,"column":1}},"135":{"start":{"line":250,"column":1},"end":{"line":250,"column":54}},"136":{"start":{"line":253,"column":0},"end":{"line":255,"column":1}},"137":{"start":{"line":254,"column":1},"end":{"line":254,"column":54}},"138":{"start":{"line":259,"column":0},"end":{"line":261,"column":1}},"139":{"start":{"line":260,"column":1},"end":{"line":260,"column":56}},"140":{"start":{"line":263,"column":0},"end":{"line":280,"column":2}},"141":{"start":{"line":282,"column":0},"end":{"line":291,"column":2}},"142":{"start":{"line":293,"column":0},"end":{"line":310,"column":2}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":16,"column":2}},{"start":{"line":16,"column":2},"end":{"line":16,"column":2}}]},"2":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},{"start":{"line":21,"column":1},"end":{"line":21,"column":1}}]},"3":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":3},"end":{"line":34,"column":3}},{"start":{"line":34,"column":3},"end":{"line":34,"column":3}}]},"4":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":35,"column":4}},{"start":{"line":35,"column":4},"end":{"line":35,"column":4}}]},"5":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":4}},{"start":{"line":38,"column":4},"end":{"line":38,"column":4}}]},"6":{"line":38,"type":"binary-expr","locations":[{"start":{"line":38,"column":8},"end":{"line":38,"column":19}},{"start":{"line":38,"column":23},"end":{"line":38,"column":46}}]},"7":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":3},"end":{"line":44,"column":3}},{"start":{"line":44,"column":3},"end":{"line":44,"column":3}}]},"8":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},{"start":{"line":56,"column":1},"end":{"line":56,"column":1}}]},"9":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},{"start":{"line":76,"column":1},"end":{"line":76,"column":1}}]},"10":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},{"start":{"line":84,"column":1},"end":{"line":84,"column":1}}]},"11":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},{"start":{"line":87,"column":1},"end":{"line":87,"column":1}}]},"12":{"line":87,"type":"binary-expr","locations":[{"start":{"line":87,"column":5},"end":{"line":87,"column":26}},{"start":{"line":87,"column":31},"end":{"line":87,"column":80}}]},"13":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},{"start":{"line":95,"column":1},"end":{"line":95,"column":1}}]},"14":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":3},"end":{"line":98,"column":3}},{"start":{"line":98,"column":3},"end":{"line":98,"column":3}}]},"15":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},{"start":{"line":113,"column":1},"end":{"line":113,"column":1}}]},"16":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":3},"end":{"line":115,"column":3}},{"start":{"line":115,"column":3},"end":{"line":115,"column":3}}]},"17":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":10},"end":{"line":138,"column":16}},{"start":{"line":138,"column":20},"end":{"line":138,"column":45}}]},"18":{"line":139,"type":"binary-expr","locations":[{"start":{"line":139,"column":8},"end":{"line":139,"column":12}},{"start":{"line":139,"column":16},"end":{"line":139,"column":18}}]},"19":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},{"start":{"line":141,"column":1},"end":{"line":141,"column":1}}]},"20":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},{"start":{"line":145,"column":1},"end":{"line":145,"column":1}}]},"21":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},{"start":{"line":149,"column":1},"end":{"line":149,"column":1}}]},"22":{"line":149,"type":"binary-expr","locations":[{"start":{"line":149,"column":5},"end":{"line":149,"column":11}},{"start":{"line":149,"column":15},"end":{"line":149,"column":31}}]},"23":{"line":153,"type":"if","locations":[{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},{"start":{"line":153,"column":1},"end":{"line":153,"column":1}}]},"24":{"line":153,"type":"binary-expr","locations":[{"start":{"line":153,"column":5},"end":{"line":153,"column":11}},{"start":{"line":153,"column":15},"end":{"line":153,"column":32}}]},"25":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},{"start":{"line":157,"column":1},"end":{"line":157,"column":1}}]},"26":{"line":157,"type":"binary-expr","locations":[{"start":{"line":157,"column":5},"end":{"line":157,"column":13}},{"start":{"line":157,"column":17},"end":{"line":157,"column":23}},{"start":{"line":157,"column":27},"end":{"line":157,"column":44}}]},"27":{"line":167,"type":"if","locations":[{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},{"start":{"line":167,"column":1},"end":{"line":167,"column":1}}]},"28":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":8},"end":{"line":171,"column":8}},{"start":{"line":171,"column":8},"end":{"line":171,"column":8}}]},"29":{"line":174,"type":"if","locations":[{"start":{"line":174,"column":3},"end":{"line":174,"column":3}},{"start":{"line":174,"column":3},"end":{"line":174,"column":3}}]},"30":{"line":179,"type":"if","locations":[{"start":{"line":179,"column":3},"end":{"line":179,"column":3}},{"start":{"line":179,"column":3},"end":{"line":179,"column":3}}]},"31":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":10},"end":{"line":181,"column":10}},{"start":{"line":181,"column":10},"end":{"line":181,"column":10}}]},"32":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},{"start":{"line":191,"column":1},"end":{"line":191,"column":1}}]},"33":{"line":201,"type":"if","locations":[{"start":{"line":201,"column":2},"end":{"line":201,"column":2}},{"start":{"line":201,"column":2},"end":{"line":201,"column":2}}]},"34":{"line":201,"type":"binary-expr","locations":[{"start":{"line":201,"column":6},"end":{"line":201,"column":21}},{"start":{"line":201,"column":25},"end":{"line":201,"column":40}}]},"35":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":2},"end":{"line":208,"column":2}},{"start":{"line":208,"column":2},"end":{"line":208,"column":2}}]},"36":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":2},"end":{"line":213,"column":2}},{"start":{"line":213,"column":2},"end":{"line":213,"column":2}}]},"37":{"line":213,"type":"binary-expr","locations":[{"start":{"line":213,"column":6},"end":{"line":213,"column":11}},{"start":{"line":213,"column":15},"end":{"line":213,"column":41}}]},"38":{"line":220,"type":"binary-expr","locations":[{"start":{"line":220,"column":10},"end":{"line":220,"column":26}},{"start":{"line":220,"column":30},"end":{"line":220,"column":42}}]},"39":{"line":223,"type":"if","locations":[{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},{"start":{"line":223,"column":1},"end":{"line":223,"column":1}}]},"40":{"line":239,"type":"cond-expr","locations":[{"start":{"line":239,"column":15},"end":{"line":239,"column":25}},{"start":{"line":239,"column":28},"end":{"line":239,"column":37}}]},"41":{"line":250,"type":"cond-expr","locations":[{"start":{"line":250,"column":16},"end":{"line":250,"column":48}},{"start":{"line":250,"column":51},"end":{"line":250,"column":53}}]},"42":{"line":254,"type":"cond-expr","locations":[{"start":{"line":254,"column":16},"end":{"line":254,"column":48}},{"start":{"line":254,"column":51},"end":{"line":254,"column":53}}]}},"code":["var log4js = require('log4js');","var fs = require('fs');","var util = require('util');","","","var funcs = {","\t'env': doEnv,","\t'args': doArgs,","\t'opts': doOpts","};","","function getLogger(categoryName) {","\tvar args = arguments;","\tvar prefix = \"\";","\tfor (var i = 1; i < args.length; i++) {","\t\tif (i !== args.length - 1)","\t\t\tprefix = prefix + args[i] + \"] [\";","\t\telse","\t\t\tprefix = prefix + args[i];","\t}","\tif (typeof categoryName === 'string') {","\t\t// category name is __filename then cut the prefix path","\t\tcategoryName = categoryName.replace(process.cwd(), '');","\t}","\tvar logger = log4js.getLogger(categoryName);","\tvar pLogger = {};","\tfor (var key in logger) {","\t\tpLogger[key] = logger[key];","\t}","","\t['log', 'debug', 'info', 'warn', 'error', 'trace', 'fatal'].forEach(function(item) {","\t\tpLogger[item] = function() {","\t\t\tvar p = \"\";","\t\t\tif (!process.env.RAW_MESSAGE) {","\t\t\t\tif (args.length > 1) {","\t\t\t\t\tp = \"[\" + prefix + \"] \";","\t\t\t\t}","\t\t\t\tif (args.length && process.env.LOGGER_LINE) {","\t\t\t\t\tp = getLine() + \": \" + p;","\t\t\t\t}","\t\t\t\tp = colorize(p, colours[item]);","\t\t\t}","","\t\t\tif (args.length) {","\t\t\t\targuments[0] = p + arguments[0];","\t\t\t}","\t\t\tlogger[item].apply(logger, arguments);","\t\t}","\t});","\treturn pLogger;","};","","var configState = {};","","function initReloadConfiguration(filename, reloadSecs) {","\tif (configState.timerId) {","\t\tclearInterval(configState.timerId);","\t\tdelete configState.timerId;","\t}","\tconfigState.filename = filename;","\tconfigState.lastMTime = getMTime(filename);","\tconfigState.timerId = setInterval(reloadConfiguration, reloadSecs * 1000);","};","","function getMTime(filename) {","\tvar mtime;","\ttry {","\t\tmtime = fs.statSync(filename).mtime;","\t} catch (e) {","\t\tthrow new Error(\"Cannot find file with given path: \" + filename);","\t}","\treturn mtime;","};","","function loadConfigurationFile(filename) {","\tif (filename) {","\t\treturn JSON.parse(fs.readFileSync(filename, \"utf8\"));","\t}","\treturn undefined;","};","","function reloadConfiguration() {","\tvar mtime = getMTime(configState.filename);","\tif (!mtime) {","\t\treturn;","\t}","\tif (configState.lastMTime && (mtime.getTime() > configState.lastMTime.getTime())) {","\t\tconfigureOnceOff(loadConfigurationFile(configState.filename));","\t}","\tconfigState.lastMTime = mtime;","};","","","function configureOnceOff(config) {","\tif (config) {","\t\ttry {","\t\t\tconfigureLevels(config.levels);","\t\t\tif (config.replaceConsole) {","\t\t\t\tlog4js.replaceConsole();","\t\t\t} else {","\t\t\t\tlog4js.restoreConsole();","\t\t\t}","\t\t} catch (e) {","\t\t\tthrow new Error(","\t\t\t\t\"Problem reading log4js config \" + util.inspect(config) +","\t\t\t\t\". Error was \\\"\" + e.message + \"\\\" (\" + e.stack + \")\"","\t\t\t);","\t\t}","\t}","};","","function configureLevels(levels) {","\tif (levels) {","\t\tfor (var category in levels) {","\t\t\tif (levels.hasOwnProperty(category)) {","\t\t\t\tlog4js.getLogger(category).setLevel(levels[category]);","\t\t\t}","\t\t}","\t}","};","","/**"," * Configure the logger."," * Configure file just like log4js.json. And support ${scope:arg-name} format property setting."," * It can replace the placeholder in runtime."," * scope can be:"," *     env: environment variables, such as: env:PATH"," *     args: command line arguments, such as: args:1"," *     opts: key/value from opts argument of configure function"," *"," * @param  {String|Object} config configure file name or configure object"," * @param  {Object} opts   options"," * @return {Void}"," */","","function configure(config, opts) {","\tvar filename = config;","\tconfig = config || process.env.LOG4JS_CONFIG;","\topts = opts || {};","","\tif (typeof config === 'string') {","\t\tconfig = JSON.parse(fs.readFileSync(config, \"utf8\"));","\t}","","\tif (config) {","\t\tconfig = replaceProperties(config, opts);","\t}","","\tif (config && config.lineDebug) {","\t\tprocess.env.LOGGER_LINE = true;","\t}","","\tif (config && config.rawMessage) {","\t\tprocess.env.RAW_MESSAGE = true;","\t}","","\tif (filename && config && config.reloadSecs) {","\t\tinitReloadConfiguration(filename, config.reloadSecs);","\t}","","\t// config object could not turn on the auto reload configure file in log4js","","\tlog4js.configure(config, opts);","};","","function replaceProperties(configObj, opts) {","\tif (configObj instanceof Array) {","\t\tfor (var i = 0, l = configObj.length; i < l; i++) {","\t\t\tconfigObj[i] = replaceProperties(configObj[i], opts);","\t\t}","\t} else if (typeof configObj === 'object') {","\t\tvar field;","\t\tfor (var f in configObj) {","\t\t\tif (!configObj.hasOwnProperty(f)) {","\t\t\t\tcontinue;","\t\t\t}","","\t\t\tfield = configObj[f];","\t\t\tif (typeof field === 'string') {","\t\t\t\tconfigObj[f] = doReplace(field, opts);","\t\t\t} else if (typeof field === 'object') {","\t\t\t\tconfigObj[f] = replaceProperties(field, opts);","\t\t\t}","\t\t}","\t}","","\treturn configObj;","}","","function doReplace(src, opts) {","\tif (!src) {","\t\treturn src;","\t}","","\tvar ptn = /\\$\\{(.*?)\\}/g;","\tvar m, pro, ts, scope, name, defaultValue, func, res = '',","\t\tlastIndex = 0;","\twhile ((m = ptn.exec(src))) {","\t\tpro = m[1];","\t\tts = pro.split(':');","\t\tif (ts.length !== 2 && ts.length !== 3) {","\t\t\tres += pro;","\t\t\tcontinue;","\t\t}","","\t\tscope = ts[0];","\t\tname = ts[1];","\t\tif (ts.length === 3) {","\t\t\tdefaultValue = ts[2];","\t\t}","","\t\tfunc = funcs[scope];","\t\tif (!func && typeof func !== 'function') {","\t\t\tres += pro;","\t\t\tcontinue;","\t\t}","","\t\tres += src.substring(lastIndex, m.index);","\t\tlastIndex = ptn.lastIndex;","\t\tres += (func(name, opts) || defaultValue);","\t}","","\tif (lastIndex < src.length) {","\t\tres += src.substring(lastIndex);","\t}","","\treturn res;","}","","function doEnv(name) {","\treturn process.env[name];","}","","function doArgs(name) {","\treturn process.argv[name];","}","","function doOpts(name, opts) {","\treturn opts ? opts[name] : undefined;","}","","function getLine() {","\tvar e = new Error();","\t// now magic will happen: get line number from callstack","\tvar line = e.stack.split('\\n')[3].split(':')[1];","\treturn line;","}","","function colorizeStart(style) {","\treturn style ? '\\x1B[' + styles[style][0] + 'm' : '';","}","","function colorizeEnd(style) {","\treturn style ? '\\x1B[' + styles[style][1] + 'm' : '';","}","/**"," * Taken from masylum's fork (https://github.com/masylum/log4js-node)"," */","function colorize(str, style) {","\treturn colorizeStart(style) + str + colorizeEnd(style);","}","","var styles = {","\t//styles","\t'bold': [1, 22],","\t'italic': [3, 23],","\t'underline': [4, 24],","\t'inverse': [7, 27],","\t//grayscale","\t'white': [37, 39],","\t'grey': [90, 39],","\t'black': [90, 39],","\t//colors","\t'blue': [34, 39],","\t'cyan': [36, 39],","\t'green': [32, 39],","\t'magenta': [35, 39],","\t'red': [31, 39],","\t'yellow': [33, 39]","};","","var colours = {","\t'all': \"grey\",","\t'trace': \"blue\",","\t'debug': \"cyan\",","\t'info': \"green\",","\t'warn': \"yellow\",","\t'error': \"red\",","\t'fatal': \"magenta\",","\t'off': \"grey\"","};","","module.exports = {","\tgetLogger: getLogger,","\tgetDefaultLogger: log4js.getDefaultLogger,","","\taddAppender: log4js.addAppender,","\tloadAppender: log4js.loadAppender,","\tclearAppenders: log4js.clearAppenders,","\tconfigure: configure,","","\treplaceConsole: log4js.replaceConsole,","\trestoreConsole: log4js.restoreConsole,","","\tlevels: log4js.levels,","\tsetGlobalLogLevel: log4js.setGlobalLogLevel,","","\tlayouts: log4js.layouts,","\tappenders: log4js.appenders","};"],"l":{"1":1,"2":1,"3":1,"6":1,"12":1,"13":60,"14":60,"15":60,"16":60,"17":0,"19":60,"21":60,"23":60,"25":60,"26":60,"27":60,"28":2100,"31":60,"32":420,"33":4,"34":4,"35":4,"36":4,"38":4,"39":0,"41":4,"44":4,"45":4,"47":4,"50":60,"53":1,"55":1,"56":0,"57":0,"58":0,"60":0,"61":0,"62":0,"65":1,"66":0,"67":0,"68":0,"70":0,"72":0,"75":1,"76":0,"77":0,"79":0,"82":1,"83":0,"84":0,"85":0,"87":0,"88":0,"90":0,"94":1,"95":0,"96":0,"97":0,"98":0,"99":0,"101":0,"104":0,"112":1,"113":0,"114":0,"115":0,"116":0,"136":1,"137":0,"138":0,"139":0,"141":0,"142":0,"145":0,"146":0,"149":0,"150":0,"153":0,"154":0,"157":0,"158":0,"163":0,"166":1,"167":0,"168":0,"169":0,"171":0,"172":0,"173":0,"174":0,"175":0,"178":0,"179":0,"180":0,"181":0,"182":0,"187":0,"190":1,"191":0,"192":0,"195":0,"196":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"206":0,"207":0,"208":0,"209":0,"212":0,"213":0,"214":0,"215":0,"218":0,"219":0,"220":0,"223":0,"224":0,"227":0,"230":1,"231":0,"234":1,"235":0,"238":1,"239":0,"242":1,"243":0,"245":0,"246":0,"249":1,"250":4,"253":1,"254":4,"259":1,"260":4,"263":1,"282":1,"293":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/log4js.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/log4js.js","s":{"1":1,"2":1,"3":60,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":60,"29":0,"30":60,"31":60,"32":10,"33":10,"34":0,"35":0,"36":0,"37":10,"38":10,"39":10,"40":10,"41":60,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":0,"49":1,"50":1,"51":1,"52":1,"53":0,"54":0,"55":1,"56":1,"57":0,"58":0,"59":1,"60":1,"61":1,"62":1,"63":1,"64":1,"65":1,"66":0,"67":0,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":1,"76":1,"77":1,"78":0,"79":1,"80":1,"81":0,"82":0,"83":0,"84":0,"85":0,"86":1,"87":0,"88":1,"89":0,"90":1,"91":1,"92":1,"93":0,"94":1,"95":1,"96":1,"97":1,"98":1,"99":1,"100":1,"101":0,"102":1,"103":0,"104":1,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":1,"112":0,"113":0,"114":0,"115":0,"116":0,"117":1,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":1,"125":1,"126":1,"127":1,"128":1,"129":1,"130":0,"131":1,"132":0,"133":0,"134":1,"135":1,"136":1,"137":1,"138":0,"139":0,"140":0,"141":0,"142":0,"143":1,"144":1,"145":5,"146":1,"147":1,"148":1,"149":1,"150":0,"151":1,"152":1,"153":1,"154":1,"155":0,"156":1,"157":1,"158":0,"159":1,"160":1,"161":0,"162":0,"163":0,"164":0,"165":0,"166":1,"167":1},"b":{"1":[0,60],"2":[10,50],"3":[0,10],"4":[10,0],"5":[1,0],"6":[1,1],"7":[0,1],"8":[1,0],"9":[0,0],"10":[0,0],"11":[1,0],"12":[0,0],"13":[1,0],"14":[0,1],"15":[0,0],"16":[0,0],"17":[0,1],"18":[1,0],"19":[0,1],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[1,1],"25":[1,1],"26":[1,0],"27":[1,0,0],"28":[0,1],"29":[1,1],"30":[0,0],"31":[0,0],"32":[0,0],"33":[1,1],"34":[0,1],"35":[0,1]},"f":{"1":60,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":60,"11":0,"12":10,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":0,"22":0,"23":1,"24":1,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":0,"33":1,"34":5,"35":1,"36":1,"37":0,"38":0,"39":0},"fnMap":{"1":{"name":"hasLogger","line":68,"loc":{"start":{"line":68,"column":0},"end":{"line":68,"column":27}}},"2":{"name":"getBufferedLogger","line":73,"loc":{"start":{"line":73,"column":0},"end":{"line":73,"column":41}}},"3":{"name":"(anonymous_3)","line":78,"loc":{"start":{"line":78,"column":19},"end":{"line":78,"column":31}}},"4":{"name":"(anonymous_4)","line":85,"loc":{"start":{"line":85,"column":19},"end":{"line":85,"column":38}}},"5":{"name":"(anonymous_5)","line":86,"loc":{"start":{"line":86,"column":19},"end":{"line":86,"column":38}}},"6":{"name":"(anonymous_6)","line":87,"loc":{"start":{"line":87,"column":18},"end":{"line":87,"column":37}}},"7":{"name":"(anonymous_7)","line":88,"loc":{"start":{"line":88,"column":18},"end":{"line":88,"column":37}}},"8":{"name":"(anonymous_8)","line":89,"loc":{"start":{"line":89,"column":19},"end":{"line":89,"column":38}}},"9":{"name":"(anonymous_9)","line":90,"loc":{"start":{"line":90,"column":19},"end":{"line":90,"column":38}}},"10":{"name":"getLogger","line":102,"loc":{"start":{"line":102,"column":0},"end":{"line":102,"column":34}}},"11":{"name":"(anonymous_11)","line":115,"loc":{"start":{"line":115,"column":27},"end":{"line":115,"column":46}}},"12":{"name":"(anonymous_12)","line":121,"loc":{"start":{"line":121,"column":27},"end":{"line":121,"column":46}}},"13":{"name":"addAppender","line":133,"loc":{"start":{"line":133,"column":0},"end":{"line":133,"column":24}}},"14":{"name":"(anonymous_14)","line":144,"loc":{"start":{"line":144,"column":15},"end":{"line":144,"column":34}}},"15":{"name":"addAppenderToAllLoggers","line":155,"loc":{"start":{"line":155,"column":0},"end":{"line":155,"column":43}}},"16":{"name":"addAppenderToCategory","line":163,"loc":{"start":{"line":163,"column":0},"end":{"line":163,"column":51}}},"17":{"name":"clearAppenders","line":170,"loc":{"start":{"line":170,"column":0},"end":{"line":170,"column":27}}},"18":{"name":"configureAppenders","line":179,"loc":{"start":{"line":179,"column":0},"end":{"line":179,"column":51}}},"19":{"name":"(anonymous_19)","line":182,"loc":{"start":{"line":182,"column":25},"end":{"line":182,"column":50}}},"20":{"name":"configureLevels","line":196,"loc":{"start":{"line":196,"column":0},"end":{"line":196,"column":33}}},"21":{"name":"setGlobalLogLevel","line":209,"loc":{"start":{"line":209,"column":0},"end":{"line":209,"column":34}}},"22":{"name":"getDefaultLogger","line":218,"loc":{"start":{"line":218,"column":0},"end":{"line":218,"column":29}}},"23":{"name":"loadConfigurationFile","line":224,"loc":{"start":{"line":224,"column":0},"end":{"line":224,"column":41}}},"24":{"name":"configureOnceOff","line":231,"loc":{"start":{"line":231,"column":0},"end":{"line":231,"column":43}}},"25":{"name":"reloadConfiguration","line":251,"loc":{"start":{"line":251,"column":0},"end":{"line":251,"column":31}}},"26":{"name":"getMTime","line":261,"loc":{"start":{"line":261,"column":0},"end":{"line":261,"column":28}}},"27":{"name":"initReloadConfiguration","line":271,"loc":{"start":{"line":271,"column":0},"end":{"line":271,"column":52}}},"28":{"name":"configure","line":281,"loc":{"start":{"line":281,"column":0},"end":{"line":281,"column":55}}},"29":{"name":"replaceConsole","line":309,"loc":{"start":{"line":309,"column":0},"end":{"line":309,"column":32}}},"30":{"name":"replaceWith","line":310,"loc":{"start":{"line":310,"column":2},"end":{"line":310,"column":27}}},"31":{"name":"(anonymous_31)","line":311,"loc":{"start":{"line":311,"column":11},"end":{"line":311,"column":22}}},"32":{"name":"(anonymous_32)","line":316,"loc":{"start":{"line":316,"column":48},"end":{"line":316,"column":64}}},"33":{"name":"restoreConsole","line":321,"loc":{"start":{"line":321,"column":0},"end":{"line":321,"column":26}}},"34":{"name":"(anonymous_34)","line":322,"loc":{"start":{"line":322,"column":52},"end":{"line":322,"column":68}}},"35":{"name":"requireAppender","line":336,"loc":{"start":{"line":336,"column":0},"end":{"line":336,"column":35}}},"36":{"name":"loadAppender","line":356,"loc":{"start":{"line":356,"column":0},"end":{"line":356,"column":48}}},"37":{"name":"shutdown","line":379,"loc":{"start":{"line":379,"column":0},"end":{"line":379,"column":22}}},"38":{"name":"(anonymous_38)","line":386,"loc":{"start":{"line":386,"column":4},"end":{"line":386,"column":30}}},"39":{"name":"(anonymous_39)","line":393,"loc":{"start":{"line":393,"column":4},"end":{"line":393,"column":31}}}},"statementMap":{"1":{"start":{"line":46,"column":0},"end":{"line":66,"column":2}},"2":{"start":{"line":68,"column":0},"end":{"line":70,"column":1}},"3":{"start":{"line":69,"column":2},"end":{"line":69,"column":40}},"4":{"start":{"line":73,"column":0},"end":{"line":93,"column":1}},"5":{"start":{"line":74,"column":4},"end":{"line":74,"column":46}},"6":{"start":{"line":75,"column":4},"end":{"line":75,"column":20}},"7":{"start":{"line":76,"column":4},"end":{"line":76,"column":21}},"8":{"start":{"line":77,"column":4},"end":{"line":77,"column":32}},"9":{"start":{"line":78,"column":4},"end":{"line":84,"column":6}},"10":{"start":{"line":79,"column":8},"end":{"line":83,"column":9}},"11":{"start":{"line":80,"column":12},"end":{"line":80,"column":37}},"12":{"start":{"line":81,"column":12},"end":{"line":81,"column":50}},"13":{"start":{"line":82,"column":12},"end":{"line":82,"column":34}},"14":{"start":{"line":85,"column":4},"end":{"line":85,"column":96}},"15":{"start":{"line":85,"column":40},"end":{"line":85,"column":93}},"16":{"start":{"line":86,"column":4},"end":{"line":86,"column":96}},"17":{"start":{"line":86,"column":40},"end":{"line":86,"column":93}},"18":{"start":{"line":87,"column":4},"end":{"line":87,"column":94}},"19":{"start":{"line":87,"column":39},"end":{"line":87,"column":91}},"20":{"start":{"line":88,"column":4},"end":{"line":88,"column":94}},"21":{"start":{"line":88,"column":39},"end":{"line":88,"column":91}},"22":{"start":{"line":89,"column":4},"end":{"line":89,"column":96}},"23":{"start":{"line":89,"column":40},"end":{"line":89,"column":93}},"24":{"start":{"line":90,"column":4},"end":{"line":90,"column":96}},"25":{"start":{"line":90,"column":40},"end":{"line":90,"column":93}},"26":{"start":{"line":92,"column":4},"end":{"line":92,"column":18}},"27":{"start":{"line":102,"column":0},"end":{"line":128,"column":1}},"28":{"start":{"line":105,"column":2},"end":{"line":107,"column":3}},"29":{"start":{"line":106,"column":4},"end":{"line":106,"column":43}},"30":{"start":{"line":109,"column":2},"end":{"line":109,"column":19}},"31":{"start":{"line":110,"column":2},"end":{"line":125,"column":3}},"32":{"start":{"line":112,"column":4},"end":{"line":112,"column":53}},"33":{"start":{"line":113,"column":4},"end":{"line":118,"column":5}},"34":{"start":{"line":114,"column":6},"end":{"line":114,"column":45}},"35":{"start":{"line":115,"column":6},"end":{"line":117,"column":9}},"36":{"start":{"line":116,"column":8},"end":{"line":116,"column":59}},"37":{"start":{"line":119,"column":4},"end":{"line":124,"column":5}},"38":{"start":{"line":120,"column":6},"end":{"line":120,"column":47}},"39":{"start":{"line":121,"column":6},"end":{"line":123,"column":9}},"40":{"start":{"line":122,"column":8},"end":{"line":122,"column":59}},"41":{"start":{"line":127,"column":2},"end":{"line":127,"column":31}},"42":{"start":{"line":133,"column":0},"end":{"line":153,"column":1}},"43":{"start":{"line":134,"column":2},"end":{"line":134,"column":51}},"44":{"start":{"line":135,"column":2},"end":{"line":135,"column":30}},"45":{"start":{"line":136,"column":2},"end":{"line":138,"column":3}},"46":{"start":{"line":137,"column":4},"end":{"line":137,"column":30}},"47":{"start":{"line":140,"column":2},"end":{"line":142,"column":3}},"48":{"start":{"line":141,"column":4},"end":{"line":141,"column":19}},"49":{"start":{"line":144,"column":2},"end":{"line":152,"column":5}},"50":{"start":{"line":145,"column":4},"end":{"line":145,"column":46}},"51":{"start":{"line":147,"column":4},"end":{"line":151,"column":5}},"52":{"start":{"line":148,"column":6},"end":{"line":148,"column":40}},"53":{"start":{"line":149,"column":11},"end":{"line":151,"column":5}},"54":{"start":{"line":150,"column":6},"end":{"line":150,"column":53}},"55":{"start":{"line":155,"column":0},"end":{"line":161,"column":1}},"56":{"start":{"line":156,"column":2},"end":{"line":160,"column":3}},"57":{"start":{"line":157,"column":4},"end":{"line":159,"column":5}},"58":{"start":{"line":158,"column":6},"end":{"line":158,"column":51}},"59":{"start":{"line":163,"column":0},"end":{"line":168,"column":1}},"60":{"start":{"line":164,"column":2},"end":{"line":166,"column":3}},"61":{"start":{"line":165,"column":4},"end":{"line":165,"column":29}},"62":{"start":{"line":167,"column":2},"end":{"line":167,"column":37}},"63":{"start":{"line":170,"column":0},"end":{"line":177,"column":1}},"64":{"start":{"line":171,"column":2},"end":{"line":171,"column":17}},"65":{"start":{"line":172,"column":2},"end":{"line":176,"column":3}},"66":{"start":{"line":173,"column":4},"end":{"line":175,"column":5}},"67":{"start":{"line":174,"column":6},"end":{"line":174,"column":48}},"68":{"start":{"line":179,"column":0},"end":{"line":194,"column":1}},"69":{"start":{"line":180,"column":2},"end":{"line":180,"column":19}},"70":{"start":{"line":181,"column":2},"end":{"line":193,"column":3}},"71":{"start":{"line":182,"column":4},"end":{"line":192,"column":7}},"72":{"start":{"line":183,"column":6},"end":{"line":183,"column":40}},"73":{"start":{"line":184,"column":6},"end":{"line":184,"column":19}},"74":{"start":{"line":185,"column":6},"end":{"line":185,"column":45}},"75":{"start":{"line":186,"column":6},"end":{"line":191,"column":7}},"76":{"start":{"line":187,"column":8},"end":{"line":187,"column":80}},"77":{"start":{"line":188,"column":8},"end":{"line":188,"column":55}},"78":{"start":{"line":190,"column":8},"end":{"line":190,"column":95}},"79":{"start":{"line":196,"column":0},"end":{"line":207,"column":1}},"80":{"start":{"line":197,"column":2},"end":{"line":206,"column":3}},"81":{"start":{"line":198,"column":4},"end":{"line":205,"column":5}},"82":{"start":{"line":199,"column":6},"end":{"line":204,"column":7}},"83":{"start":{"line":200,"column":8},"end":{"line":202,"column":9}},"84":{"start":{"line":201,"column":10},"end":{"line":201,"column":46}},"85":{"start":{"line":203,"column":8},"end":{"line":203,"column":55}},"86":{"start":{"line":209,"column":0},"end":{"line":211,"column":1}},"87":{"start":{"line":210,"column":2},"end":{"line":210,"column":63}},"88":{"start":{"line":218,"column":0},"end":{"line":220,"column":1}},"89":{"start":{"line":219,"column":2},"end":{"line":219,"column":44}},"90":{"start":{"line":222,"column":0},"end":{"line":222,"column":21}},"91":{"start":{"line":224,"column":0},"end":{"line":229,"column":1}},"92":{"start":{"line":225,"column":2},"end":{"line":227,"column":3}},"93":{"start":{"line":226,"column":4},"end":{"line":226,"column":57}},"94":{"start":{"line":228,"column":2},"end":{"line":228,"column":19}},"95":{"start":{"line":231,"column":0},"end":{"line":249,"column":1}},"96":{"start":{"line":232,"column":2},"end":{"line":248,"column":3}},"97":{"start":{"line":233,"column":4},"end":{"line":247,"column":5}},"98":{"start":{"line":234,"column":6},"end":{"line":234,"column":52}},"99":{"start":{"line":235,"column":6},"end":{"line":235,"column":37}},"100":{"start":{"line":237,"column":6},"end":{"line":241,"column":7}},"101":{"start":{"line":238,"column":8},"end":{"line":238,"column":25}},"102":{"start":{"line":240,"column":8},"end":{"line":240,"column":25}},"103":{"start":{"line":243,"column":6},"end":{"line":246,"column":8}},"104":{"start":{"line":251,"column":0},"end":{"line":259,"column":1}},"105":{"start":{"line":252,"column":2},"end":{"line":252,"column":45}},"106":{"start":{"line":253,"column":2},"end":{"line":253,"column":21}},"107":{"start":{"line":253,"column":14},"end":{"line":253,"column":21}},"108":{"start":{"line":255,"column":2},"end":{"line":257,"column":3}},"109":{"start":{"line":256,"column":4},"end":{"line":256,"column":66}},"110":{"start":{"line":258,"column":2},"end":{"line":258,"column":32}},"111":{"start":{"line":261,"column":0},"end":{"line":269,"column":1}},"112":{"start":{"line":262,"column":2},"end":{"line":262,"column":12}},"113":{"start":{"line":263,"column":2},"end":{"line":267,"column":3}},"114":{"start":{"line":264,"column":4},"end":{"line":264,"column":52}},"115":{"start":{"line":266,"column":4},"end":{"line":266,"column":78}},"116":{"start":{"line":268,"column":2},"end":{"line":268,"column":15}},"117":{"start":{"line":271,"column":0},"end":{"line":279,"column":1}},"118":{"start":{"line":272,"column":2},"end":{"line":275,"column":3}},"119":{"start":{"line":273,"column":4},"end":{"line":273,"column":39}},"120":{"start":{"line":274,"column":4},"end":{"line":274,"column":31}},"121":{"start":{"line":276,"column":2},"end":{"line":276,"column":34}},"122":{"start":{"line":277,"column":2},"end":{"line":277,"column":45}},"123":{"start":{"line":278,"column":2},"end":{"line":278,"column":82}},"124":{"start":{"line":281,"column":0},"end":{"line":299,"column":1}},"125":{"start":{"line":282,"column":2},"end":{"line":282,"column":41}},"126":{"start":{"line":283,"column":2},"end":{"line":283,"column":47}},"127":{"start":{"line":284,"column":2},"end":{"line":284,"column":26}},"128":{"start":{"line":286,"column":2},"end":{"line":297,"column":3}},"129":{"start":{"line":287,"column":4},"end":{"line":289,"column":5}},"130":{"start":{"line":288,"column":6},"end":{"line":288,"column":47}},"131":{"start":{"line":290,"column":4},"end":{"line":290,"column":60}},"132":{"start":{"line":292,"column":4},"end":{"line":296,"column":5}},"133":{"start":{"line":293,"column":6},"end":{"line":295,"column":8}},"134":{"start":{"line":298,"column":2},"end":{"line":298,"column":36}},"135":{"start":{"line":301,"column":0},"end":{"line":307,"column":2}},"136":{"start":{"line":309,"column":0},"end":{"line":319,"column":1}},"137":{"start":{"line":310,"column":2},"end":{"line":314,"column":3}},"138":{"start":{"line":311,"column":4},"end":{"line":313,"column":6}},"139":{"start":{"line":312,"column":6},"end":{"line":312,"column":34}},"140":{"start":{"line":315,"column":2},"end":{"line":315,"column":42}},"141":{"start":{"line":316,"column":2},"end":{"line":318,"column":5}},"142":{"start":{"line":317,"column":4},"end":{"line":317,"column":77}},"143":{"start":{"line":321,"column":0},"end":{"line":325,"column":1}},"144":{"start":{"line":322,"column":2},"end":{"line":324,"column":5}},"145":{"start":{"line":323,"column":4},"end":{"line":323,"column":51}},"146":{"start":{"line":336,"column":0},"end":{"line":344,"column":1}},"147":{"start":{"line":337,"column":2},"end":{"line":337,"column":21}},"148":{"start":{"line":338,"column":2},"end":{"line":342,"column":3}},"149":{"start":{"line":339,"column":4},"end":{"line":339,"column":56}},"150":{"start":{"line":341,"column":4},"end":{"line":341,"column":39}},"151":{"start":{"line":343,"column":2},"end":{"line":343,"column":24}},"152":{"start":{"line":356,"column":0},"end":{"line":368,"column":1}},"153":{"start":{"line":357,"column":2},"end":{"line":357,"column":63}},"154":{"start":{"line":359,"column":2},"end":{"line":361,"column":3}},"155":{"start":{"line":360,"column":4},"end":{"line":360,"column":74}},"156":{"start":{"line":363,"column":2},"end":{"line":363,"column":84}},"157":{"start":{"line":364,"column":2},"end":{"line":366,"column":3}},"158":{"start":{"line":365,"column":4},"end":{"line":365,"column":79}},"159":{"start":{"line":367,"column":2},"end":{"line":367,"column":75}},"160":{"start":{"line":379,"column":0},"end":{"line":398,"column":1}},"161":{"start":{"line":382,"column":2},"end":{"line":382,"column":37}},"162":{"start":{"line":385,"column":2},"end":{"line":388,"column":11}},"163":{"start":{"line":387,"column":6},"end":{"line":387,"column":55}},"164":{"start":{"line":391,"column":2},"end":{"line":397,"column":4}},"165":{"start":{"line":394,"column":6},"end":{"line":394,"column":23}},"166":{"start":{"line":400,"column":0},"end":{"line":422,"column":2}},"167":{"start":{"line":425,"column":0},"end":{"line":425,"column":12}}},"branchMap":{"1":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"2":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":2},"end":{"line":110,"column":2}},{"start":{"line":110,"column":2},"end":{"line":110,"column":2}}]},"3":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":4},"end":{"line":113,"column":4}},{"start":{"line":113,"column":4},"end":{"line":113,"column":4}}]},"4":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":4},"end":{"line":119,"column":4}},{"start":{"line":119,"column":4},"end":{"line":119,"column":4}}]},"5":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":2},"end":{"line":136,"column":2}},{"start":{"line":136,"column":2},"end":{"line":136,"column":2}}]},"6":{"line":136,"type":"binary-expr","locations":[{"start":{"line":136,"column":6},"end":{"line":136,"column":23}},{"start":{"line":136,"column":27},"end":{"line":136,"column":48}}]},"7":{"line":140,"type":"if","locations":[{"start":{"line":140,"column":2},"end":{"line":140,"column":2}},{"start":{"line":140,"column":2},"end":{"line":140,"column":2}}]},"8":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":4},"end":{"line":147,"column":4}},{"start":{"line":147,"column":4},"end":{"line":147,"column":4}}]},"9":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":11},"end":{"line":149,"column":11}},{"start":{"line":149,"column":11},"end":{"line":149,"column":11}}]},"10":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":4},"end":{"line":157,"column":4}},{"start":{"line":157,"column":4},"end":{"line":157,"column":4}}]},"11":{"line":164,"type":"if","locations":[{"start":{"line":164,"column":2},"end":{"line":164,"column":2}},{"start":{"line":164,"column":2},"end":{"line":164,"column":2}}]},"12":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":4},"end":{"line":173,"column":4}},{"start":{"line":173,"column":4},"end":{"line":173,"column":4}}]},"13":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":2},"end":{"line":181,"column":2}},{"start":{"line":181,"column":2},"end":{"line":181,"column":2}}]},"14":{"line":197,"type":"if","locations":[{"start":{"line":197,"column":2},"end":{"line":197,"column":2}},{"start":{"line":197,"column":2},"end":{"line":197,"column":2}}]},"15":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":6},"end":{"line":199,"column":6}},{"start":{"line":199,"column":6},"end":{"line":199,"column":6}}]},"16":{"line":200,"type":"if","locations":[{"start":{"line":200,"column":8},"end":{"line":200,"column":8}},{"start":{"line":200,"column":8},"end":{"line":200,"column":8}}]},"17":{"line":225,"type":"if","locations":[{"start":{"line":225,"column":2},"end":{"line":225,"column":2}},{"start":{"line":225,"column":2},"end":{"line":225,"column":2}}]},"18":{"line":232,"type":"if","locations":[{"start":{"line":232,"column":2},"end":{"line":232,"column":2}},{"start":{"line":232,"column":2},"end":{"line":232,"column":2}}]},"19":{"line":237,"type":"if","locations":[{"start":{"line":237,"column":6},"end":{"line":237,"column":6}},{"start":{"line":237,"column":6},"end":{"line":237,"column":6}}]},"20":{"line":253,"type":"if","locations":[{"start":{"line":253,"column":2},"end":{"line":253,"column":2}},{"start":{"line":253,"column":2},"end":{"line":253,"column":2}}]},"21":{"line":255,"type":"if","locations":[{"start":{"line":255,"column":2},"end":{"line":255,"column":2}},{"start":{"line":255,"column":2},"end":{"line":255,"column":2}}]},"22":{"line":255,"type":"binary-expr","locations":[{"start":{"line":255,"column":6},"end":{"line":255,"column":27}},{"start":{"line":255,"column":32},"end":{"line":255,"column":81}}]},"23":{"line":272,"type":"if","locations":[{"start":{"line":272,"column":2},"end":{"line":272,"column":2}},{"start":{"line":272,"column":2},"end":{"line":272,"column":2}}]},"24":{"line":283,"type":"binary-expr","locations":[{"start":{"line":283,"column":11},"end":{"line":283,"column":17}},{"start":{"line":283,"column":21},"end":{"line":283,"column":46}}]},"25":{"line":284,"type":"binary-expr","locations":[{"start":{"line":284,"column":12},"end":{"line":284,"column":19}},{"start":{"line":284,"column":23},"end":{"line":284,"column":25}}]},"26":{"line":286,"type":"if","locations":[{"start":{"line":286,"column":2},"end":{"line":286,"column":2}},{"start":{"line":286,"column":2},"end":{"line":286,"column":2}}]},"27":{"line":286,"type":"binary-expr","locations":[{"start":{"line":286,"column":6},"end":{"line":286,"column":26}},{"start":{"line":286,"column":30},"end":{"line":286,"column":45}},{"start":{"line":286,"column":49},"end":{"line":286,"column":76}}]},"28":{"line":287,"type":"if","locations":[{"start":{"line":287,"column":4},"end":{"line":287,"column":4}},{"start":{"line":287,"column":4},"end":{"line":287,"column":4}}]},"29":{"line":290,"type":"binary-expr","locations":[{"start":{"line":290,"column":13},"end":{"line":290,"column":42}},{"start":{"line":290,"column":46},"end":{"line":290,"column":59}}]},"30":{"line":292,"type":"if","locations":[{"start":{"line":292,"column":4},"end":{"line":292,"column":4}},{"start":{"line":292,"column":4},"end":{"line":292,"column":4}}]},"31":{"line":315,"type":"binary-expr","locations":[{"start":{"line":315,"column":11},"end":{"line":315,"column":17}},{"start":{"line":315,"column":21},"end":{"line":315,"column":41}}]},"32":{"line":317,"type":"cond-expr","locations":[{"start":{"line":317,"column":49},"end":{"line":317,"column":60}},{"start":{"line":317,"column":63},"end":{"line":317,"column":75}}]},"33":{"line":357,"type":"binary-expr","locations":[{"start":{"line":357,"column":19},"end":{"line":357,"column":33}},{"start":{"line":357,"column":37},"end":{"line":357,"column":62}}]},"34":{"line":359,"type":"if","locations":[{"start":{"line":359,"column":2},"end":{"line":359,"column":2}},{"start":{"line":359,"column":2},"end":{"line":359,"column":2}}]},"35":{"line":364,"type":"if","locations":[{"start":{"line":364,"column":2},"end":{"line":364,"column":2}},{"start":{"line":364,"column":2},"end":{"line":364,"column":2}}]}},"code":["\"use strict\";","/*"," * Licensed under the Apache License, Version 2.0 (the \"License\");"," * you may not use this file except in compliance with the License."," * You may obtain a copy of the License at"," *"," *      http://www.apache.org/licenses/LICENSE-2.0"," *"," * Unless required by applicable law or agreed to in writing, software"," * distributed under the License is distributed on an \"AS IS\" BASIS,"," * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."," * See the License for the specific language governing permissions and"," * limitations under the License."," */","","/**"," * @fileoverview log4js is a library to log in JavaScript in similar manner"," * than in log4j for Java. The API should be nearly the same."," *"," * <h3>Example:</h3>"," * <pre>"," *  var logging = require('log4js');"," *  //add an appender that logs all messages to stdout."," *  logging.addAppender(logging.consoleAppender());"," *  //add an appender that logs \"some-category\" to a file"," *  logging.addAppender(logging.fileAppender(\"file.log\"), \"some-category\");"," *  //get a logger"," *  var log = logging.getLogger(\"some-category\");"," *  log.setLevel(logging.levels.TRACE); //set the Level"," *"," *  ..."," *"," *  //call the log"," *  log.trace(\"trace me\" );"," * </pre>"," *"," * NOTE: the authors below are the original browser-based log4js authors"," * don't try to contact them about bugs in this version :)"," * @version 1.0"," * @author Stephan Strittmatter - http://jroller.com/page/stritti"," * @author Seth Chisamore - http://www.chisamore.com"," * @since 2005-05-20"," * @static"," * Website: http://log4js.berlios.de"," */","var events = require('events')",", async = require('async')",", fs = require('fs')",", path = require('path')",", util = require('util')",", layouts = require('./layouts')",", levels = require('./levels')",", loggerModule = require('./logger')",", LoggingEvent = loggerModule.LoggingEvent",", Logger = loggerModule.Logger",", ALL_CATEGORIES = '[all]'",", appenders = {}",", loggers = {}",", appenderMakers = {}",", appenderShutdowns = {}",", defaultConfig =   {","  appenders: [","    { type: \"console\" }","  ],","  replaceConsole: false","};","","function hasLogger(logger) {","  return loggers.hasOwnProperty(logger);","}","","","function getBufferedLogger(categoryName) {","    var base_logger = getLogger(categoryName);","    var logger = {};","    logger.temp = [];","    logger.target = base_logger;","    logger.flush = function () {","        for (var i = 0; i < logger.temp.length; i++) {","            var log = logger.temp[i];","            logger.target[log.level](log.message);","            delete logger.temp[i];","        }","    };","    logger.trace = function (message) { logger.temp.push({level: 'trace', message: message}); };","    logger.debug = function (message) { logger.temp.push({level: 'debug', message: message}); };","    logger.info = function (message) { logger.temp.push({level: 'info', message: message}); };","    logger.warn = function (message) { logger.temp.push({level: 'warn', message: message}); };","    logger.error = function (message) { logger.temp.push({level: 'error', message: message}); };","    logger.fatal = function (message) { logger.temp.push({level: 'fatal', message: message}); };","","    return logger;","}","","","/**"," * Get a logger instance. Instance is cached on categoryName level."," * @param  {String} categoryName name of category to log to."," * @return {Logger} instance of logger for the category"," * @static"," */","function getLogger (categoryName) {","","  // Use default logger if categoryName is not specified or invalid","  if (typeof categoryName !== \"string\") {","    categoryName = Logger.DEFAULT_CATEGORY;","  }","","  var appenderList;","  if (!hasLogger(categoryName)) {","    // Create the logger for this name if it doesn't already exist","    loggers[categoryName] = new Logger(categoryName);","    if (appenders[categoryName]) {","      appenderList = appenders[categoryName];","      appenderList.forEach(function(appender) {","        loggers[categoryName].addListener(\"log\", appender);","      });","    }","    if (appenders[ALL_CATEGORIES]) {","      appenderList = appenders[ALL_CATEGORIES];","      appenderList.forEach(function(appender) {","        loggers[categoryName].addListener(\"log\", appender);","      });","    }","  }","  ","  return loggers[categoryName];","}","","/**"," * args are appender, then zero or more categories"," */","function addAppender () {","  var args = Array.prototype.slice.call(arguments);","  var appender = args.shift();","  if (args.length === 0 || args[0] === undefined) {","    args = [ ALL_CATEGORIES ];","  }","  //argument may already be an array","  if (Array.isArray(args[0])) {","    args = args[0];","  }","  ","  args.forEach(function(category) {","    addAppenderToCategory(appender, category);","    ","    if (category === ALL_CATEGORIES) {","      addAppenderToAllLoggers(appender);","    } else if (hasLogger(category)) {","      loggers[category].addListener(\"log\", appender);","    }","  });","}","","function addAppenderToAllLoggers(appender) {","  for (var logger in loggers) {","    if (hasLogger(logger)) {","      loggers[logger].addListener(\"log\", appender);","    }","  }","}","","function addAppenderToCategory(appender, category) {","  if (!appenders[category]) {","    appenders[category] = [];","  }","  appenders[category].push(appender);","}","","function clearAppenders () {","  appenders = {};","  for (var logger in loggers) {","    if (hasLogger(logger)) {","      loggers[logger].removeAllListeners(\"log\");","    }","  }","}","","function configureAppenders(appenderList, options) {","  clearAppenders();","  if (appenderList) {","    appenderList.forEach(function(appenderConfig) {","      loadAppender(appenderConfig.type);","      var appender;","      appenderConfig.makers = appenderMakers;","      try {","        appender = appenderMakers[appenderConfig.type](appenderConfig, options);","        addAppender(appender, appenderConfig.category);","      } catch(e) {","        throw new Error(\"log4js configuration problem for \" + util.inspect(appenderConfig), e);","      }","    });","  }","}","","function configureLevels(levels) {","  if (levels) {","    for (var category in levels) {","      if (levels.hasOwnProperty(category)) {","        if(category === ALL_CATEGORIES) {","          setGlobalLogLevel(levels[category]);","        }","        getLogger(category).setLevel(levels[category]);","      }","    }","  }","}","","function setGlobalLogLevel(level) {","  Logger.prototype.level = levels.toLevel(level, levels.TRACE);","}","","/**"," * Get the default logger instance."," * @return {Logger} instance of default logger"," * @static"," */","function getDefaultLogger () {","  return getLogger(Logger.DEFAULT_CATEGORY);","}","","var configState = {};","","function loadConfigurationFile(filename) {","  if (filename) {","    return JSON.parse(fs.readFileSync(filename, \"utf8\"));","  }","  return undefined;","}","","function configureOnceOff(config, options) {","  if (config) {","    try {","      configureAppenders(config.appenders, options);","      configureLevels(config.levels);","      ","      if (config.replaceConsole) {","        replaceConsole();","      } else {","        restoreConsole();","      }","    } catch (e) {","      throw new Error(","        \"Problem reading log4js config \" + util.inspect(config) + ","          \". Error was \\\"\" + e.message + \"\\\" (\" + e.stack + \")\"","      );","    }","  }","}","","function reloadConfiguration() {","  var mtime = getMTime(configState.filename);","  if (!mtime) return;","","  if (configState.lastMTime && (mtime.getTime() > configState.lastMTime.getTime())) {","    configureOnceOff(loadConfigurationFile(configState.filename));","  }","  configState.lastMTime = mtime;","}","","function getMTime(filename) {","  var mtime;","  try {","    mtime = fs.statSync(configState.filename).mtime;","  } catch (e) {","    getLogger('log4js').warn('Failed to load configuration file ' + filename);","  }","  return mtime;","}","","function initReloadConfiguration(filename, options) {","  if (configState.timerId) {","    clearInterval(configState.timerId);","    delete configState.timerId;","  }","  configState.filename = filename;","  configState.lastMTime = getMTime(filename);","  configState.timerId = setInterval(reloadConfiguration, options.reloadSecs*1000);","}","","function configure(configurationFileOrObject, options) {","  var config = configurationFileOrObject;","  config = config || process.env.LOG4JS_CONFIG;","  options = options || {};","  ","  if (config === undefined || config === null || typeof(config) === 'string') {","    if (options.reloadSecs) {","      initReloadConfiguration(config, options);","    }","    config = loadConfigurationFile(config) || defaultConfig;","  } else {","    if (options.reloadSecs) {","      getLogger('log4js').warn(","        'Ignoring configuration reload parameter for \"object\" configuration.'","      );","    }","  }","  configureOnceOff(config, options);","}","","var originalConsoleFunctions = {","  log: console.log,","  debug: console.debug,","  info: console.info,","  warn: console.warn,","  error: console.error","};","","function replaceConsole(logger) {","  function replaceWith(fn) {","    return function() {","      fn.apply(logger, arguments);","    };","  }","  logger = logger || getLogger(\"console\");","  ['log','debug','info','warn','error'].forEach(function (item) {","    console[item] = replaceWith(item === 'log' ? logger.info : logger[item]);","  });","}","","function restoreConsole() {","  ['log', 'debug', 'info', 'warn', 'error'].forEach(function (item) {","    console[item] = originalConsoleFunctions[item];","  });","}","","/**"," * Load an appenderModule based on the provided appender filepath. Will first"," * check if the appender path is a subpath of the log4js \"lib/appenders\" directory."," * If not, it will attempt to load the the appender as complete path."," *"," * @param {string} appender The filepath for the appender."," * @returns {Object|null} The required appender or null if appender could not be loaded."," * @private"," */","function requireAppender(appender) {","  var appenderModule;","  try {","    appenderModule = require('./appenders/' + appender);","  } catch (e) {","    appenderModule = require(appender);","  }","  return appenderModule;","}","","/**"," * Load an appender. Provided the appender path to be loaded. If appenderModule is defined,"," * it will be used in place of requiring the appender module."," *"," * @param {string} appender The path to the appender module."," * @param {Object|void} [appenderModule] The pre-required appender module. When provided,"," * instead of requiring the appender by its path, this object will be used."," * @returns {void}"," * @private"," */","function loadAppender(appender, appenderModule) {","  appenderModule = appenderModule || requireAppender(appender);","","  if (!appenderModule) {","    throw new Error(\"Invalid log4js appender: \" + util.inspect(appender));","  }","","  module.exports.appenders[appender] = appenderModule.appender.bind(appenderModule);","  if (appenderModule.shutdown) {","    appenderShutdowns[appender] = appenderModule.shutdown.bind(appenderModule);","  }","  appenderMakers[appender] = appenderModule.configure.bind(appenderModule);","}","","/**"," * Shutdown all log appenders. This will first disable all writing to appenders"," * and then call the shutdown function each appender."," *"," * @params {Function} cb - The callback to be invoked once all appenders have"," *  shutdown. If an error occurs, the callback will be given the error object"," *  as the first argument."," * @returns {void}"," */","function shutdown(cb) {","  // First, disable all writing to appenders. This prevents appenders from","  // not being able to be drained because of run-away log writes.","  loggerModule.disableAllLogWrites();","","  // Next, get all the shutdown functions for appenders as an array.","  var shutdownFunctions = Object.keys(appenderShutdowns).reduce(","    function(accum, category) {","      return accum.concat(appenderShutdowns[category]);","    }, []);","","  // Call each of the shutdown functions.","  async.each(","    shutdownFunctions,","    function(shutdownFn, done) {","      shutdownFn(done);","    },","\t\tcb","  );","}","","module.exports = {","  getBufferedLogger: getBufferedLogger,","  getLogger: getLogger,","  getDefaultLogger: getDefaultLogger,","  hasLogger: hasLogger,","  ","  addAppender: addAppender,","  loadAppender: loadAppender,","  clearAppenders: clearAppenders,","  configure: configure,","  shutdown: shutdown,","  ","  replaceConsole: replaceConsole,","  restoreConsole: restoreConsole,","  ","  levels: levels,","  setGlobalLogLevel: setGlobalLogLevel,","  ","  layouts: layouts,","  appenders: {},","  appenderMakers: appenderMakers,","  connectLogger: require('./connect-logger').connectLogger","};","","//set ourselves up","configure();","",""],"l":{"46":1,"68":1,"69":60,"73":1,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"92":0,"102":1,"105":60,"106":0,"109":60,"110":60,"112":10,"113":10,"114":0,"115":0,"116":0,"119":10,"120":10,"121":10,"122":10,"127":60,"133":1,"134":1,"135":1,"136":1,"137":1,"140":1,"141":0,"144":1,"145":1,"147":1,"148":1,"149":0,"150":0,"155":1,"156":1,"157":0,"158":0,"163":1,"164":1,"165":1,"167":1,"170":1,"171":1,"172":1,"173":0,"174":0,"179":1,"180":1,"181":1,"182":1,"183":1,"184":1,"185":1,"186":1,"187":1,"188":1,"190":0,"196":1,"197":1,"198":0,"199":0,"200":0,"201":0,"203":0,"209":1,"210":0,"218":1,"219":0,"222":1,"224":1,"225":1,"226":0,"228":1,"231":1,"232":1,"233":1,"234":1,"235":1,"237":1,"238":0,"240":1,"243":0,"251":1,"252":0,"253":0,"255":0,"256":0,"258":0,"261":1,"262":0,"263":0,"264":0,"266":0,"268":0,"271":1,"272":0,"273":0,"274":0,"276":0,"277":0,"278":0,"281":1,"282":1,"283":1,"284":1,"286":1,"287":1,"288":0,"290":1,"292":0,"293":0,"298":1,"301":1,"309":1,"310":1,"311":0,"312":0,"315":0,"316":0,"317":0,"321":1,"322":1,"323":5,"336":1,"337":1,"338":1,"339":1,"341":0,"343":1,"356":1,"357":1,"359":1,"360":0,"363":1,"364":1,"365":0,"367":1,"379":1,"382":0,"385":0,"387":0,"391":0,"394":0,"400":1,"425":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/layouts.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/layouts.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1,"8":8,"9":24,"10":0,"11":0,"12":24,"13":1,"14":8,"15":8,"16":1,"17":1,"18":4,"19":1,"20":4,"21":1,"22":4,"23":1,"24":4,"25":4,"26":1,"27":0,"28":1,"29":4,"30":1,"31":0,"32":1,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":0,"59":1,"60":0,"61":1,"62":0,"63":1,"64":0,"65":1,"66":0,"67":1,"68":0,"69":1,"70":0,"71":1,"72":0,"73":1,"74":0,"75":1,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":1,"83":0,"84":1,"85":0,"86":0,"87":0,"88":0,"89":0,"90":1,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":1,"121":0},"b":{"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,24],"5":[24,0],"6":[4,4],"7":[4,0],"8":[4,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":8,"7":24,"8":0,"9":8,"10":4,"11":4,"12":4,"13":4,"14":0,"15":4,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":24},"end":{"line":8,"column":35}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":11},"end":{"line":9,"column":22}}},"3":{"name":"(anonymous_3)","line":10,"loc":{"start":{"line":10,"column":13},"end":{"line":10,"column":24}}},"4":{"name":"(anonymous_4)","line":11,"loc":{"start":{"line":11,"column":14},"end":{"line":11,"column":25}}},"5":{"name":"(anonymous_5)","line":12,"loc":{"start":{"line":12,"column":13},"end":{"line":12,"column":31}}},"6":{"name":"wrapErrorsWithInspect","line":27,"loc":{"start":{"line":27,"column":0},"end":{"line":27,"column":38}}},"7":{"name":"(anonymous_7)","line":28,"loc":{"start":{"line":28,"column":19},"end":{"line":28,"column":34}}},"8":{"name":"(anonymous_8)","line":30,"loc":{"start":{"line":30,"column":24},"end":{"line":30,"column":35}}},"9":{"name":"formatLogData","line":37,"loc":{"start":{"line":37,"column":0},"end":{"line":37,"column":32}}},"10":{"name":"colorizeStart","line":61,"loc":{"start":{"line":61,"column":0},"end":{"line":61,"column":30}}},"11":{"name":"colorizeEnd","line":64,"loc":{"start":{"line":64,"column":0},"end":{"line":64,"column":28}}},"12":{"name":"colorize","line":70,"loc":{"start":{"line":70,"column":0},"end":{"line":70,"column":31}}},"13":{"name":"timestampLevelAndCategory","line":74,"loc":{"start":{"line":74,"column":0},"end":{"line":74,"column":57}}},"14":{"name":"basicLayout","line":96,"loc":{"start":{"line":96,"column":0},"end":{"line":96,"column":36}}},"15":{"name":"colouredLayout","line":104,"loc":{"start":{"line":104,"column":0},"end":{"line":104,"column":39}}},"16":{"name":"messagePassThroughLayout","line":111,"loc":{"start":{"line":111,"column":0},"end":{"line":111,"column":49}}},"17":{"name":"patternLayout","line":146,"loc":{"start":{"line":146,"column":0},"end":{"line":146,"column":41}}},"18":{"name":"categoryName","line":152,"loc":{"start":{"line":152,"column":2},"end":{"line":152,"column":49}}},"19":{"name":"formatAsDate","line":164,"loc":{"start":{"line":164,"column":2},"end":{"line":164,"column":49}}},"20":{"name":"hostname","line":183,"loc":{"start":{"line":183,"column":2},"end":{"line":183,"column":22}}},"21":{"name":"formatMessage","line":187,"loc":{"start":{"line":187,"column":2},"end":{"line":187,"column":39}}},"22":{"name":"endOfLine","line":191,"loc":{"start":{"line":191,"column":2},"end":{"line":191,"column":23}}},"23":{"name":"logLevel","line":195,"loc":{"start":{"line":195,"column":2},"end":{"line":195,"column":34}}},"24":{"name":"startTime","line":199,"loc":{"start":{"line":199,"column":2},"end":{"line":199,"column":35}}},"25":{"name":"startColour","line":203,"loc":{"start":{"line":203,"column":2},"end":{"line":203,"column":37}}},"26":{"name":"endColour","line":207,"loc":{"start":{"line":207,"column":2},"end":{"line":207,"column":35}}},"27":{"name":"percent","line":211,"loc":{"start":{"line":211,"column":2},"end":{"line":211,"column":21}}},"28":{"name":"pid","line":215,"loc":{"start":{"line":215,"column":2},"end":{"line":215,"column":17}}},"29":{"name":"userDefined","line":219,"loc":{"start":{"line":219,"column":2},"end":{"line":219,"column":48}}},"30":{"name":"replaceToken","line":245,"loc":{"start":{"line":245,"column":2},"end":{"line":245,"column":70}}},"31":{"name":"truncate","line":249,"loc":{"start":{"line":249,"column":2},"end":{"line":249,"column":44}}},"32":{"name":"pad","line":259,"loc":{"start":{"line":259,"column":2},"end":{"line":259,"column":31}}},"33":{"name":"(anonymous_33)","line":279,"loc":{"start":{"line":279,"column":9},"end":{"line":279,"column":32}}},"34":{"name":"(anonymous_34)","line":321,"loc":{"start":{"line":321,"column":10},"end":{"line":321,"column":33}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":25,"column":2}},"2":{"start":{"line":8,"column":37},"end":{"line":8,"column":69}},"3":{"start":{"line":9,"column":24},"end":{"line":9,"column":43}},"4":{"start":{"line":10,"column":26},"end":{"line":10,"column":48}},"5":{"start":{"line":11,"column":27},"end":{"line":11,"column":49}},"6":{"start":{"line":13,"column":4},"end":{"line":13,"column":76}},"7":{"start":{"line":27,"column":0},"end":{"line":35,"column":1}},"8":{"start":{"line":28,"column":2},"end":{"line":34,"column":5}},"9":{"start":{"line":29,"column":4},"end":{"line":33,"column":5}},"10":{"start":{"line":30,"column":6},"end":{"line":30,"column":87}},"11":{"start":{"line":30,"column":37},"end":{"line":30,"column":82}},"12":{"start":{"line":32,"column":6},"end":{"line":32,"column":18}},"13":{"start":{"line":37,"column":0},"end":{"line":40,"column":1}},"14":{"start":{"line":38,"column":2},"end":{"line":38,"column":86}},"15":{"start":{"line":39,"column":2},"end":{"line":39,"column":62}},"16":{"start":{"line":42,"column":0},"end":{"line":59,"column":2}},"17":{"start":{"line":61,"column":0},"end":{"line":63,"column":1}},"18":{"start":{"line":62,"column":2},"end":{"line":62,"column":55}},"19":{"start":{"line":64,"column":0},"end":{"line":66,"column":1}},"20":{"start":{"line":65,"column":2},"end":{"line":65,"column":55}},"21":{"start":{"line":70,"column":0},"end":{"line":72,"column":1}},"22":{"start":{"line":71,"column":2},"end":{"line":71,"column":57}},"23":{"start":{"line":74,"column":0},"end":{"line":85,"column":1}},"24":{"start":{"line":75,"column":2},"end":{"line":83,"column":4}},"25":{"start":{"line":84,"column":2},"end":{"line":84,"column":16}},"26":{"start":{"line":96,"column":0},"end":{"line":98,"column":1}},"27":{"start":{"line":97,"column":2},"end":{"line":97,"column":84}},"28":{"start":{"line":104,"column":0},"end":{"line":109,"column":1}},"29":{"start":{"line":105,"column":2},"end":{"line":108,"column":39}},"30":{"start":{"line":111,"column":0},"end":{"line":113,"column":1}},"31":{"start":{"line":112,"column":2},"end":{"line":112,"column":42}},"32":{"start":{"line":146,"column":0},"end":{"line":313,"column":1}},"33":{"start":{"line":147,"column":2},"end":{"line":147,"column":51}},"34":{"start":{"line":148,"column":2},"end":{"line":148,"column":82}},"35":{"start":{"line":150,"column":2},"end":{"line":150,"column":47}},"36":{"start":{"line":152,"column":2},"end":{"line":162,"column":3}},"37":{"start":{"line":153,"column":4},"end":{"line":153,"column":47}},"38":{"start":{"line":154,"column":4},"end":{"line":160,"column":5}},"39":{"start":{"line":155,"column":6},"end":{"line":155,"column":46}},"40":{"start":{"line":156,"column":6},"end":{"line":156,"column":49}},"41":{"start":{"line":157,"column":6},"end":{"line":159,"column":7}},"42":{"start":{"line":158,"column":8},"end":{"line":158,"column":87}},"43":{"start":{"line":161,"column":4},"end":{"line":161,"column":22}},"44":{"start":{"line":164,"column":2},"end":{"line":181,"column":3}},"45":{"start":{"line":165,"column":4},"end":{"line":165,"column":43}},"46":{"start":{"line":166,"column":4},"end":{"line":178,"column":5}},"47":{"start":{"line":167,"column":6},"end":{"line":167,"column":25}},"48":{"start":{"line":169,"column":6},"end":{"line":177,"column":7}},"49":{"start":{"line":170,"column":8},"end":{"line":170,"column":43}},"50":{"start":{"line":171,"column":13},"end":{"line":177,"column":7}},"51":{"start":{"line":172,"column":8},"end":{"line":172,"column":58}},"52":{"start":{"line":173,"column":13},"end":{"line":177,"column":7}},"53":{"start":{"line":174,"column":8},"end":{"line":174,"column":48}},"54":{"start":{"line":175,"column":13},"end":{"line":177,"column":7}},"55":{"start":{"line":176,"column":8},"end":{"line":176,"column":44}},"56":{"start":{"line":180,"column":4},"end":{"line":180,"column":63}},"57":{"start":{"line":183,"column":2},"end":{"line":185,"column":3}},"58":{"start":{"line":184,"column":4},"end":{"line":184,"column":36}},"59":{"start":{"line":187,"column":2},"end":{"line":189,"column":3}},"60":{"start":{"line":188,"column":4},"end":{"line":188,"column":44}},"61":{"start":{"line":191,"column":2},"end":{"line":193,"column":3}},"62":{"start":{"line":192,"column":4},"end":{"line":192,"column":15}},"63":{"start":{"line":195,"column":2},"end":{"line":197,"column":3}},"64":{"start":{"line":196,"column":4},"end":{"line":196,"column":41}},"65":{"start":{"line":199,"column":2},"end":{"line":201,"column":3}},"66":{"start":{"line":200,"column":4},"end":{"line":200,"column":60}},"67":{"start":{"line":203,"column":2},"end":{"line":205,"column":3}},"68":{"start":{"line":204,"column":4},"end":{"line":204,"column":65}},"69":{"start":{"line":207,"column":2},"end":{"line":209,"column":3}},"70":{"start":{"line":208,"column":4},"end":{"line":208,"column":63}},"71":{"start":{"line":211,"column":2},"end":{"line":213,"column":3}},"72":{"start":{"line":212,"column":4},"end":{"line":212,"column":15}},"73":{"start":{"line":215,"column":2},"end":{"line":217,"column":3}},"74":{"start":{"line":216,"column":4},"end":{"line":216,"column":23}},"75":{"start":{"line":219,"column":2},"end":{"line":228,"column":3}},"76":{"start":{"line":220,"column":4},"end":{"line":226,"column":5}},"77":{"start":{"line":221,"column":6},"end":{"line":225,"column":7}},"78":{"start":{"line":222,"column":8},"end":{"line":222,"column":47}},"79":{"start":{"line":224,"column":8},"end":{"line":224,"column":33}},"80":{"start":{"line":227,"column":4},"end":{"line":227,"column":16}},"81":{"start":{"line":230,"column":2},"end":{"line":243,"column":4}},"82":{"start":{"line":245,"column":2},"end":{"line":247,"column":3}},"83":{"start":{"line":246,"column":4},"end":{"line":246,"column":67}},"84":{"start":{"line":249,"column":2},"end":{"line":257,"column":3}},"85":{"start":{"line":250,"column":4},"end":{"line":250,"column":12}},"86":{"start":{"line":251,"column":4},"end":{"line":254,"column":5}},"87":{"start":{"line":252,"column":6},"end":{"line":252,"column":47}},"88":{"start":{"line":253,"column":6},"end":{"line":253,"column":42}},"89":{"start":{"line":256,"column":4},"end":{"line":256,"column":22}},"90":{"start":{"line":259,"column":2},"end":{"line":277,"column":3}},"91":{"start":{"line":260,"column":4},"end":{"line":260,"column":12}},"92":{"start":{"line":261,"column":4},"end":{"line":275,"column":5}},"93":{"start":{"line":262,"column":6},"end":{"line":274,"column":7}},"94":{"start":{"line":263,"column":8},"end":{"line":263,"column":46}},"95":{"start":{"line":265,"column":8},"end":{"line":267,"column":9}},"96":{"start":{"line":266,"column":10},"end":{"line":266,"column":23}},"97":{"start":{"line":269,"column":8},"end":{"line":269,"column":36}},"98":{"start":{"line":271,"column":8},"end":{"line":273,"column":9}},"99":{"start":{"line":272,"column":10},"end":{"line":272,"column":30}},"100":{"start":{"line":276,"column":4},"end":{"line":276,"column":17}},"101":{"start":{"line":279,"column":2},"end":{"line":311,"column":4}},"102":{"start":{"line":280,"column":4},"end":{"line":280,"column":29}},"103":{"start":{"line":281,"column":4},"end":{"line":281,"column":15}},"104":{"start":{"line":282,"column":4},"end":{"line":282,"column":31}},"105":{"start":{"line":284,"column":4},"end":{"line":309,"column":5}},"106":{"start":{"line":285,"column":6},"end":{"line":285,"column":36}},"107":{"start":{"line":286,"column":6},"end":{"line":286,"column":30}},"108":{"start":{"line":287,"column":6},"end":{"line":287,"column":33}},"109":{"start":{"line":288,"column":6},"end":{"line":288,"column":42}},"110":{"start":{"line":289,"column":6},"end":{"line":289,"column":32}},"111":{"start":{"line":290,"column":6},"end":{"line":290,"column":27}},"112":{"start":{"line":293,"column":6},"end":{"line":307,"column":7}},"113":{"start":{"line":294,"column":8},"end":{"line":294,"column":37}},"114":{"start":{"line":298,"column":8},"end":{"line":300,"column":24}},"115":{"start":{"line":304,"column":8},"end":{"line":304,"column":56}},"116":{"start":{"line":305,"column":8},"end":{"line":305,"column":48}},"117":{"start":{"line":306,"column":8},"end":{"line":306,"column":39}},"118":{"start":{"line":308,"column":6},"end":{"line":308,"column":74}},"119":{"start":{"line":310,"column":4},"end":{"line":310,"column":27}},"120":{"start":{"line":315,"column":0},"end":{"line":324,"column":2}},"121":{"start":{"line":322,"column":4},"end":{"line":322,"column":60}}},"branchMap":{"1":{"line":4,"type":"binary-expr","locations":[{"start":{"line":4,"column":8},"end":{"line":4,"column":14}},{"start":{"line":4,"column":18},"end":{"line":4,"column":22}}]},"2":{"line":13,"type":"binary-expr","locations":[{"start":{"line":13,"column":25},"end":{"line":13,"column":31}},{"start":{"line":13,"column":35},"end":{"line":13,"column":49}}]},"3":{"line":13,"type":"binary-expr","locations":[{"start":{"line":13,"column":51},"end":{"line":13,"column":57}},{"start":{"line":13,"column":61},"end":{"line":13,"column":74}}]},"4":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":4}},{"start":{"line":29,"column":4},"end":{"line":29,"column":4}}]},"5":{"line":29,"type":"binary-expr","locations":[{"start":{"line":29,"column":9},"end":{"line":29,"column":30}},{"start":{"line":29,"column":35},"end":{"line":29,"column":45}}]},"6":{"line":38,"type":"cond-expr","locations":[{"start":{"line":38,"column":38},"end":{"line":38,"column":45}},{"start":{"line":38,"column":48},"end":{"line":38,"column":85}}]},"7":{"line":62,"type":"cond-expr","locations":[{"start":{"line":62,"column":17},"end":{"line":62,"column":49}},{"start":{"line":62,"column":52},"end":{"line":62,"column":54}}]},"8":{"line":65,"type":"cond-expr","locations":[{"start":{"line":65,"column":17},"end":{"line":65,"column":49}},{"start":{"line":65,"column":52},"end":{"line":65,"column":54}}]},"9":{"line":150,"type":"binary-expr","locations":[{"start":{"line":150,"column":12},"end":{"line":150,"column":19}},{"start":{"line":150,"column":23},"end":{"line":150,"column":46}}]},"10":{"line":154,"type":"if","locations":[{"start":{"line":154,"column":4},"end":{"line":154,"column":4}},{"start":{"line":154,"column":4},"end":{"line":154,"column":4}}]},"11":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":6},"end":{"line":157,"column":6}},{"start":{"line":157,"column":6},"end":{"line":157,"column":6}}]},"12":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":166,"column":4}},{"start":{"line":166,"column":4},"end":{"line":166,"column":4}}]},"13":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":6},"end":{"line":169,"column":6}},{"start":{"line":169,"column":6},"end":{"line":169,"column":6}}]},"14":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":13},"end":{"line":171,"column":13}},{"start":{"line":171,"column":13},"end":{"line":171,"column":13}}]},"15":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":13},"end":{"line":173,"column":13}},{"start":{"line":173,"column":13},"end":{"line":173,"column":13}}]},"16":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":13},"end":{"line":175,"column":13}},{"start":{"line":175,"column":13},"end":{"line":175,"column":13}}]},"17":{"line":220,"type":"if","locations":[{"start":{"line":220,"column":4},"end":{"line":220,"column":4}},{"start":{"line":220,"column":4},"end":{"line":220,"column":4}}]},"18":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":6},"end":{"line":221,"column":6}},{"start":{"line":221,"column":6},"end":{"line":221,"column":6}}]},"19":{"line":251,"type":"if","locations":[{"start":{"line":251,"column":4},"end":{"line":251,"column":4}},{"start":{"line":251,"column":4},"end":{"line":251,"column":4}}]},"20":{"line":261,"type":"if","locations":[{"start":{"line":261,"column":4},"end":{"line":261,"column":4}},{"start":{"line":261,"column":4},"end":{"line":261,"column":4}}]},"21":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":6},"end":{"line":262,"column":6}},{"start":{"line":262,"column":6},"end":{"line":262,"column":6}}]},"22":{"line":293,"type":"if","locations":[{"start":{"line":293,"column":6},"end":{"line":293,"column":6}},{"start":{"line":293,"column":6},"end":{"line":293,"column":6}}]},"23":{"line":299,"type":"binary-expr","locations":[{"start":{"line":299,"column":10},"end":{"line":299,"column":68}},{"start":{"line":300,"column":10},"end":{"line":300,"column":23}}]},"24":{"line":322,"type":"binary-expr","locations":[{"start":{"line":322,"column":11},"end":{"line":322,"column":29}},{"start":{"line":322,"column":33},"end":{"line":322,"column":59}}]}},"code":["\"use strict\";","var dateFormat = require('./date_format')",", os = require('os')",", eol = os.EOL || '\\n'",", util = require('util')",", replacementRegExp = /%[sdj]/g",", layoutMakers = {","  \"messagePassThrough\": function() { return messagePassThroughLayout; }, ","  \"basic\": function() { return basicLayout; }, ","  \"colored\": function() { return colouredLayout; }, ","  \"coloured\": function() { return colouredLayout; }, ","  \"pattern\": function (config) {","    return patternLayout(config && config.pattern, config && config.tokens);","\t}","}",", colours = {","  ALL: \"grey\", ","  TRACE: \"blue\", ","  DEBUG: \"cyan\", ","  INFO: \"green\", ","  WARN: \"yellow\", ","  ERROR: \"red\", ","  FATAL: \"magenta\", ","  OFF: \"grey\"","};","","function wrapErrorsWithInspect(items) {","  return items.map(function(item) {","    if ((item instanceof Error) && item.stack) {","      return { inspect: function() { return util.format(item) + '\\n' + item.stack; } };","    } else {","      return item;","    }","  });","}","","function formatLogData(logData) {","  var data = Array.isArray(logData) ? logData : Array.prototype.slice.call(arguments);","  return util.format.apply(util, wrapErrorsWithInspect(data));","}","","var styles = {","    //styles","  'bold'      : [1,  22],","  'italic'    : [3,  23],","  'underline' : [4,  24],","  'inverse'   : [7,  27],","  //grayscale","  'white'     : [37, 39],","  'grey'      : [90, 39],","  'black'     : [90, 39],","  //colors","  'blue'      : [34, 39],","  'cyan'      : [36, 39],","  'green'     : [32, 39],","  'magenta'   : [35, 39],","  'red'       : [31, 39],","  'yellow'    : [33, 39]","};","","function colorizeStart(style) {","  return style ? '\\x1B[' + styles[style][0] + 'm' : '';","}","function colorizeEnd(style) {","  return style ? '\\x1B[' + styles[style][1] + 'm' : '';","}","/**"," * Taken from masylum's fork (https://github.com/masylum/log4js-node)"," */","function colorize (str, style) {","  return colorizeStart(style) + str + colorizeEnd(style);","}","","function timestampLevelAndCategory(loggingEvent, colour) {","  var output = colorize(","    formatLogData(","      '[%s] [%s] %s - '","      , dateFormat.asString(loggingEvent.startTime)","      , loggingEvent.level","      , loggingEvent.categoryName","    )","    , colour","  );","  return output;","}","","/**"," * BasicLayout is a simple layout for storing the logs. The logs are stored"," * in following format:"," * <pre>"," * [startTime] [logLevel] categoryName - message\\n"," * </pre>"," *"," * @author Stephan Strittmatter"," */","function basicLayout (loggingEvent) {","  return timestampLevelAndCategory(loggingEvent) + formatLogData(loggingEvent.data);","}","","/**"," * colouredLayout - taken from masylum's fork."," * same as basicLayout, but with colours."," */","function colouredLayout (loggingEvent) {","  return timestampLevelAndCategory(","    loggingEvent,","    colours[loggingEvent.level.toString()]","  ) + formatLogData(loggingEvent.data);","}","","function messagePassThroughLayout (loggingEvent) {","  return formatLogData(loggingEvent.data);","}","","/**"," * PatternLayout"," * Format for specifiers is %[padding].[truncation][field]{[format]}"," * e.g. %5.10p - left pad the log level by 5 characters, up to a max of 10"," * Fields can be any of:"," *  - %r time in toLocaleTimeString format"," *  - %p log level"," *  - %c log category"," *  - %h hostname"," *  - %m log data"," *  - %d date in various formats"," *  - %% %"," *  - %n newline"," *  - %z pid"," *  - %x{<tokenname>} add dynamic tokens to your log. Tokens are specified in the tokens parameter"," * You can use %[ and %] to define a colored block."," *"," * Tokens are specified as simple key:value objects. "," * The key represents the token name whereas the value can be a string or function"," * which is called to extract the value to put in the log message. If token is not"," * found, it doesn't replace the field."," *"," * A sample token would be: { \"pid\" : function() { return process.pid; } }"," *"," * Takes a pattern string, array of tokens and returns a layout function."," * @param {String} Log format pattern String"," * @param {object} map object of different tokens"," * @return {Function}"," * @author Stephan Strittmatter"," * @author Jan Schmidle"," */","function patternLayout (pattern, tokens) {","  var TTCC_CONVERSION_PATTERN  = \"%r %p %c - %m%n\";","  var regex = /%(-?[0-9]+)?(\\.?[0-9]+)?([\\[\\]cdhmnprzx%])(\\{([^\\}]+)\\})?|([^%]+)/;","  ","  pattern = pattern || TTCC_CONVERSION_PATTERN;","","  function categoryName(loggingEvent, specifier) {","    var loggerName = loggingEvent.categoryName;","    if (specifier) {","      var precision = parseInt(specifier, 10);","      var loggerNameBits = loggerName.split(\".\");","      if (precision < loggerNameBits.length) {","        loggerName = loggerNameBits.slice(loggerNameBits.length - precision).join(\".\");","      }","    }","    return loggerName;","  }","","  function formatAsDate(loggingEvent, specifier) {","    var format = dateFormat.ISO8601_FORMAT;","    if (specifier) {","      format = specifier;","      // Pick up special cases","      if (format == \"ISO8601\") {","        format = dateFormat.ISO8601_FORMAT;","      } else if (format == \"ISO8601_WITH_TZ_OFFSET\") {","        format = dateFormat.ISO8601_WITH_TZ_OFFSET_FORMAT; ","      } else if (format == \"ABSOLUTE\") {","        format = dateFormat.ABSOLUTETIME_FORMAT;","      } else if (format == \"DATE\") {","        format = dateFormat.DATETIME_FORMAT;","      }","    }","    // Format the date","    return dateFormat.asString(format, loggingEvent.startTime);","  }","  ","  function hostname() {","    return os.hostname().toString();","  }","","  function formatMessage(loggingEvent) {","    return formatLogData(loggingEvent.data);","  }","  ","  function endOfLine() {","    return eol;","  }","","  function logLevel(loggingEvent) {","    return loggingEvent.level.toString();","  }","","  function startTime(loggingEvent) {","    return \"\" + loggingEvent.startTime.toLocaleTimeString();","  }","","  function startColour(loggingEvent) {","    return colorizeStart(colours[loggingEvent.level.toString()]);","  }","","  function endColour(loggingEvent) {","    return colorizeEnd(colours[loggingEvent.level.toString()]);","  }","","  function percent() {","    return '%';","  }","","  function pid() {","    return process.pid;","  }","","  function userDefined(loggingEvent, specifier) {","    if (typeof(tokens[specifier]) !== 'undefined') {","      if (typeof(tokens[specifier]) === 'function') {","        return tokens[specifier](loggingEvent);","      } else {","        return tokens[specifier];","      }","    }","    return null;","  }","","  var replacers = {","    'c': categoryName,","    'd': formatAsDate,","    'h': hostname,","    'm': formatMessage,","    'n': endOfLine,","    'p': logLevel,","    'r': startTime,","    '[': startColour,","    ']': endColour,","    'z': pid,","    '%': percent,","    'x': userDefined","  };","","  function replaceToken(conversionCharacter, loggingEvent, specifier) {","    return replacers[conversionCharacter](loggingEvent, specifier);","  }","","  function truncate(truncation, toTruncate) {","    var len;","    if (truncation) {","      len = parseInt(truncation.substr(1), 10);","      return toTruncate.substring(0, len);","    }","","    return toTruncate;","  }","","  function pad(padding, toPad) {","    var len;","    if (padding) {","      if (padding.charAt(0) == \"-\") {","        len = parseInt(padding.substr(1), 10);","        // Right pad with spaces","        while (toPad.length < len) {","          toPad += \" \";","        }","      } else {","        len = parseInt(padding, 10);","        // Left pad with spaces","        while (toPad.length < len) {","          toPad = \" \" + toPad;","        }","      }","    }","    return toPad;","  }","  ","  return function(loggingEvent) {","    var formattedString = \"\";","    var result;","    var searchString = pattern;","    ","    while ((result = regex.exec(searchString))) {","      var matchedString = result[0];","      var padding = result[1];","      var truncation = result[2];","      var conversionCharacter = result[3];","      var specifier = result[5];","      var text = result[6];","      ","      // Check if the pattern matched was just normal text","      if (text) {","        formattedString += \"\" + text;","      } else {","        // Create a raw replacement string based on the conversion","        // character and specifier","        var replacement = ","          replaceToken(conversionCharacter, loggingEvent, specifier) || ","          matchedString;","","        // Format the replacement according to any padding or","        // truncation specified","        replacement = truncate(truncation, replacement);","        replacement = pad(padding, replacement);","        formattedString += replacement;","      }","      searchString = searchString.substr(result.index + result[0].length);","    }","    return formattedString;","  };","","}","","module.exports = {","  basicLayout: basicLayout, ","  messagePassThroughLayout: messagePassThroughLayout, ","  patternLayout: patternLayout, ","  colouredLayout: colouredLayout, ","  coloredLayout: colouredLayout, ","  layout: function(name, config) {","    return layoutMakers[name] && layoutMakers[name](config);","  }","};",""],"l":{"2":1,"8":0,"9":0,"10":0,"11":0,"13":0,"27":1,"28":8,"29":24,"30":0,"32":24,"37":1,"38":8,"39":8,"42":1,"61":1,"62":4,"64":1,"65":4,"70":1,"71":4,"74":1,"75":4,"84":4,"96":1,"97":0,"104":1,"105":4,"111":1,"112":0,"146":1,"147":0,"148":0,"150":0,"152":1,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"161":0,"164":1,"165":0,"166":0,"167":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"180":0,"183":1,"184":0,"187":1,"188":0,"191":1,"192":0,"195":1,"196":0,"199":1,"200":0,"203":1,"204":0,"207":1,"208":0,"211":1,"212":0,"215":1,"216":0,"219":1,"220":0,"221":0,"222":0,"224":0,"227":0,"230":0,"245":1,"246":0,"249":1,"250":0,"251":0,"252":0,"253":0,"256":0,"259":1,"260":0,"261":0,"262":0,"263":0,"265":0,"266":0,"269":0,"271":0,"272":0,"276":0,"279":0,"280":0,"281":0,"282":0,"284":0,"285":0,"286":0,"287":0,"288":0,"289":0,"290":0,"293":0,"294":0,"298":0,"304":0,"305":0,"306":0,"308":0,"310":0,"315":1,"322":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/date_format.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/date_format.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":32,"7":32,"8":10,"9":32,"10":1,"11":28,"12":1,"13":4,"14":4,"15":4,"16":4,"17":4,"18":4,"19":4,"20":4,"21":1,"22":4,"23":4,"24":0,"25":0,"26":4,"27":4,"28":4,"29":4,"30":4,"31":4,"32":4,"33":4,"34":4,"35":4,"36":4,"37":4},"b":{"1":[4,0],"2":[4,0],"3":[0,4],"4":[0,4],"5":[4,0]},"f":{"1":32,"2":28,"3":4,"4":4},"fnMap":{"1":{"name":"padWithZeros","line":7,"loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":38}}},"2":{"name":"addZero","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":26}}},"3":{"name":"offset","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":22}}},"4":{"name":"(anonymous_4)","line":38,"loc":{"start":{"line":38,"column":19},"end":{"line":38,"column":46}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":2,"column":51}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":63}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":45}},"5":{"start":{"line":7,"column":0},"end":{"line":13,"column":1}},"6":{"start":{"line":8,"column":2},"end":{"line":8,"column":33}},"7":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":36}},"9":{"start":{"line":12,"column":2},"end":{"line":12,"column":21}},"10":{"start":{"line":15,"column":0},"end":{"line":17,"column":1}},"11":{"start":{"line":16,"column":2},"end":{"line":16,"column":34}},"12":{"start":{"line":24,"column":0},"end":{"line":36,"column":1}},"13":{"start":{"line":26,"column":2},"end":{"line":26,"column":46}},"14":{"start":{"line":27,"column":2},"end":{"line":27,"column":36}},"15":{"start":{"line":28,"column":2},"end":{"line":28,"column":24}},"16":{"start":{"line":29,"column":2},"end":{"line":31,"column":3}},"17":{"start":{"line":30,"column":4},"end":{"line":30,"column":16}},"18":{"start":{"line":32,"column":2},"end":{"line":34,"column":3}},"19":{"start":{"line":33,"column":4},"end":{"line":33,"column":16}},"20":{"start":{"line":35,"column":2},"end":{"line":35,"column":58}},"21":{"start":{"line":38,"column":0},"end":{"line":66,"column":2}},"22":{"start":{"line":39,"column":2},"end":{"line":39,"column":38}},"23":{"start":{"line":40,"column":2},"end":{"line":43,"column":3}},"24":{"start":{"line":41,"column":4},"end":{"line":41,"column":26}},"25":{"start":{"line":42,"column":4},"end":{"line":42,"column":24}},"26":{"start":{"line":45,"column":2},"end":{"line":45,"column":37}},"27":{"start":{"line":46,"column":2},"end":{"line":46,"column":42}},"28":{"start":{"line":47,"column":2},"end":{"line":47,"column":46}},"29":{"start":{"line":48,"column":2},"end":{"line":48,"column":73}},"30":{"start":{"line":49,"column":2},"end":{"line":49,"column":69}},"31":{"start":{"line":50,"column":2},"end":{"line":50,"column":40}},"32":{"start":{"line":51,"column":2},"end":{"line":51,"column":43}},"33":{"start":{"line":52,"column":2},"end":{"line":52,"column":43}},"34":{"start":{"line":53,"column":2},"end":{"line":53,"column":61}},"35":{"start":{"line":54,"column":2},"end":{"line":54,"column":31}},"36":{"start":{"line":55,"column":2},"end":{"line":63,"column":30}},"37":{"start":{"line":64,"column":2},"end":{"line":64,"column":19}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"2":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":32,"column":2}},{"start":{"line":32,"column":2},"end":{"line":32,"column":2}}]},"3":{"line":35,"type":"cond-expr","locations":[{"start":{"line":35,"column":40},"end":{"line":35,"column":47}},{"start":{"line":35,"column":50},"end":{"line":35,"column":57}}]},"4":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":40,"column":2}},{"start":{"line":40,"column":2},"end":{"line":40,"column":2}}]},"5":{"line":49,"type":"cond-expr","locations":[{"start":{"line":49,"column":45},"end":{"line":49,"column":54}},{"start":{"line":49,"column":57},"end":{"line":49,"column":67}}]}},"code":["\"use strict\";","exports.ISO8601_FORMAT = \"yyyy-MM-dd hh:mm:ss.SSS\";","exports.ISO8601_WITH_TZ_OFFSET_FORMAT = \"yyyy-MM-ddThh:mm:ssO\";","exports.DATETIME_FORMAT = \"dd MM yyyy hh:mm:ss.SSS\";","exports.ABSOLUTETIME_FORMAT = \"hh:mm:ss.SSS\";","","function padWithZeros(vNumber, width) {","  var numAsString = vNumber + \"\";","  while (numAsString.length < width) {","    numAsString = \"0\" + numAsString;","  }","  return numAsString;","}","  ","function addZero(vNumber) {","  return padWithZeros(vNumber, 2);","}","","/**"," * Formats the TimeOffest"," * Thanks to http://www.svendtofte.com/code/date_format/"," * @private"," */","function offset(date) {","  // Difference to Greenwich time (GMT) in hours","  var os = Math.abs(date.getTimezoneOffset());","  var h = String(Math.floor(os/60));","  var m = String(os%60);","  if (h.length == 1) {","    h = \"0\" + h;","  }","  if (m.length == 1) {","    m = \"0\" + m;","  }","  return date.getTimezoneOffset() < 0 ? \"+\"+h+m : \"-\"+h+m;","}","","exports.asString = function(/*format,*/ date) {","  var format = exports.ISO8601_FORMAT;","  if (typeof(date) === \"string\") {","    format = arguments[0];","    date = arguments[1];","  }","","  var vDay = addZero(date.getDate());","  var vMonth = addZero(date.getMonth()+1);","  var vYearLong = addZero(date.getFullYear());","  var vYearShort = addZero(date.getFullYear().toString().substring(2,4));","  var vYear = (format.indexOf(\"yyyy\") > -1 ? vYearLong : vYearShort);","  var vHour  = addZero(date.getHours());","  var vMinute = addZero(date.getMinutes());","  var vSecond = addZero(date.getSeconds());","  var vMillisecond = padWithZeros(date.getMilliseconds(), 3);","  var vTimeZone = offset(date);","  var formatted = format","    .replace(/dd/g, vDay)","    .replace(/MM/g, vMonth)","    .replace(/y{1,4}/g, vYear)","    .replace(/hh/g, vHour)","    .replace(/mm/g, vMinute)","    .replace(/ss/g, vSecond)","    .replace(/SSS/g, vMillisecond)","    .replace(/O/g, vTimeZone);","  return formatted;","","};",""],"l":{"2":1,"3":1,"4":1,"5":1,"7":1,"8":32,"9":32,"10":10,"12":32,"15":1,"16":28,"24":1,"26":4,"27":4,"28":4,"29":4,"30":4,"32":4,"33":4,"35":4,"38":1,"39":4,"40":4,"41":0,"42":0,"45":4,"46":4,"47":4,"48":4,"49":4,"50":4,"51":4,"52":4,"53":4,"54":4,"55":4,"64":4}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/levels.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/levels.js","s":{"1":1,"2":8,"3":8,"4":1,"5":14,"6":0,"7":14,"8":10,"9":10,"10":10,"11":0,"12":4,"13":1,"14":12,"15":1,"16":8,"17":0,"18":8,"19":1,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":1},"b":{"1":[0,14],"2":[10,4],"3":[10,0],"4":[0,8],"5":[0,0],"6":[0,0]},"f":{"1":8,"2":14,"3":12,"4":8,"5":0,"6":0},"fnMap":{"1":{"name":"Level","line":3,"loc":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}}},"2":{"name":"toLevel","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":37}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":27},"end":{"line":33,"column":38}}},"4":{"name":"(anonymous_4)","line":37,"loc":{"start":{"line":37,"column":38},"end":{"line":37,"column":59}}},"5":{"name":"(anonymous_5)","line":44,"loc":{"start":{"line":44,"column":41},"end":{"line":44,"column":62}}},"6":{"name":"(anonymous_6)","line":51,"loc":{"start":{"line":51,"column":28},"end":{"line":51,"column":49}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":6,"column":1}},"2":{"start":{"line":4,"column":2},"end":{"line":4,"column":21}},"3":{"start":{"line":5,"column":2},"end":{"line":5,"column":27}},"4":{"start":{"line":15,"column":0},"end":{"line":31,"column":1}},"5":{"start":{"line":17,"column":2},"end":{"line":19,"column":3}},"6":{"start":{"line":18,"column":4},"end":{"line":18,"column":24}},"7":{"start":{"line":21,"column":2},"end":{"line":28,"column":3}},"8":{"start":{"line":22,"column":4},"end":{"line":22,"column":31}},"9":{"start":{"line":23,"column":4},"end":{"line":27,"column":5}},"10":{"start":{"line":24,"column":6},"end":{"line":24,"column":31}},"11":{"start":{"line":26,"column":6},"end":{"line":26,"column":26}},"12":{"start":{"line":30,"column":2},"end":{"line":30,"column":34}},"13":{"start":{"line":33,"column":0},"end":{"line":35,"column":2}},"14":{"start":{"line":34,"column":2},"end":{"line":34,"column":23}},"15":{"start":{"line":37,"column":0},"end":{"line":42,"column":2}},"16":{"start":{"line":38,"column":2},"end":{"line":40,"column":3}},"17":{"start":{"line":39,"column":4},"end":{"line":39,"column":37}},"18":{"start":{"line":41,"column":2},"end":{"line":41,"column":40}},"19":{"start":{"line":44,"column":0},"end":{"line":49,"column":2}},"20":{"start":{"line":45,"column":2},"end":{"line":47,"column":3}},"21":{"start":{"line":46,"column":4},"end":{"line":46,"column":37}},"22":{"start":{"line":48,"column":2},"end":{"line":48,"column":40}},"23":{"start":{"line":51,"column":0},"end":{"line":56,"column":2}},"24":{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},"25":{"start":{"line":53,"column":4},"end":{"line":53,"column":37}},"26":{"start":{"line":55,"column":2},"end":{"line":55,"column":41}},"27":{"start":{"line":58,"column":0},"end":{"line":68,"column":2}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":2},"end":{"line":17,"column":2}},{"start":{"line":17,"column":2},"end":{"line":17,"column":2}}]},"2":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":2},"end":{"line":21,"column":2}},{"start":{"line":21,"column":2},"end":{"line":21,"column":2}}]},"3":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":23,"column":4}},{"start":{"line":23,"column":4},"end":{"line":23,"column":4}}]},"4":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":2},"end":{"line":38,"column":2}},{"start":{"line":38,"column":2},"end":{"line":38,"column":2}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":2},"end":{"line":45,"column":2}},{"start":{"line":45,"column":2},"end":{"line":45,"column":2}}]},"6":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":52,"column":2}},{"start":{"line":52,"column":2},"end":{"line":52,"column":2}}]}},"code":["\"use strict\";","","function Level(level, levelStr) {","  this.level = level;","  this.levelStr = levelStr;","}","","/**"," * converts given String to corresponding Level"," * @param {String} sArg String value of Level OR Log4js.Level"," * @param {Log4js.Level} defaultLevel default Level, if no String representation"," * @return Level object"," * @type Log4js.Level"," */","function toLevel(sArg, defaultLevel) {","","  if (!sArg) {","    return defaultLevel;","  }","","  if (typeof sArg == \"string\") {","    var s = sArg.toUpperCase();","    if (module.exports[s]) {","      return module.exports[s];","    } else {","      return defaultLevel;","    }","  }","","  return toLevel(sArg.toString());","}","","Level.prototype.toString = function() {","  return this.levelStr;","};","","Level.prototype.isLessThanOrEqualTo = function(otherLevel) {","  if (typeof otherLevel === \"string\") {","    otherLevel = toLevel(otherLevel);","  }","  return this.level <= otherLevel.level;","};","","Level.prototype.isGreaterThanOrEqualTo = function(otherLevel) {","  if (typeof otherLevel === \"string\") {","    otherLevel = toLevel(otherLevel);","  }","  return this.level >= otherLevel.level;","};","","Level.prototype.isEqualTo = function(otherLevel) {","  if (typeof otherLevel == \"string\") {","    otherLevel = toLevel(otherLevel);","  }","  return this.level === otherLevel.level;","};","","module.exports = {","  ALL: new Level(Number.MIN_VALUE, \"ALL\"), ","  TRACE: new Level(5000, \"TRACE\"), ","  DEBUG: new Level(10000, \"DEBUG\"), ","  INFO: new Level(20000, \"INFO\"), ","  WARN: new Level(30000, \"WARN\"), ","  ERROR: new Level(40000, \"ERROR\"), ","  FATAL: new Level(50000, \"FATAL\"), ","  OFF: new Level(Number.MAX_VALUE, \"OFF\"), ","  toLevel: toLevel","};",""],"l":{"3":1,"4":8,"5":8,"15":1,"17":14,"18":0,"21":14,"22":10,"23":10,"24":10,"26":0,"30":4,"33":1,"34":12,"37":1,"38":8,"39":0,"41":8,"44":1,"45":0,"46":0,"48":0,"51":1,"52":0,"53":0,"55":0,"58":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/logger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/logger.js","s":{"1":1,"2":1,"3":1,"4":4,"5":4,"6":4,"7":4,"8":4,"9":1,"10":10,"11":10,"12":0,"13":1,"14":1,"15":1,"16":1,"17":0,"18":1,"19":0,"20":1,"21":4,"22":4,"23":4,"24":4,"25":1,"26":8,"27":1,"28":6,"29":6,"30":0,"31":6,"32":4,"33":4,"34":4,"35":4,"36":1,"37":0,"38":1,"39":0,"40":1,"41":1,"42":1,"43":1},"b":{"1":[10,0],"2":[0,10],"3":[0,0],"4":[4,0],"5":[4,0],"6":[4,4]},"f":{"1":4,"2":10,"3":0,"4":0,"5":4,"6":8,"7":6,"8":0,"9":4,"10":0,"11":0},"fnMap":{"1":{"name":"LoggingEvent","line":18,"loc":{"start":{"line":18,"column":0},"end":{"line":18,"column":58}}},"2":{"name":"Logger","line":33,"loc":{"start":{"line":33,"column":0},"end":{"line":33,"column":30}}},"3":{"name":"(anonymous_3)","line":44,"loc":{"start":{"line":44,"column":28},"end":{"line":44,"column":44}}},"4":{"name":"(anonymous_4)","line":48,"loc":{"start":{"line":48,"column":31},"end":{"line":48,"column":42}}},"5":{"name":"(anonymous_5)","line":52,"loc":{"start":{"line":52,"column":23},"end":{"line":52,"column":34}}},"6":{"name":"(anonymous_6)","line":62,"loc":{"start":{"line":62,"column":34},"end":{"line":62,"column":55}}},"7":{"name":"(anonymous_7)","line":67,"loc":{"start":{"line":67,"column":2},"end":{"line":67,"column":24}}},"8":{"name":"(anonymous_8)","line":69,"loc":{"start":{"line":69,"column":51},"end":{"line":69,"column":62}}},"9":{"name":"(anonymous_9)","line":73,"loc":{"start":{"line":73,"column":50},"end":{"line":73,"column":62}}},"10":{"name":"disableAllLogWrites","line":87,"loc":{"start":{"line":87,"column":0},"end":{"line":87,"column":31}}},"11":{"name":"enableAllLogWrites","line":95,"loc":{"start":{"line":95,"column":0},"end":{"line":95,"column":30}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":5,"column":33}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":28}},"3":{"start":{"line":18,"column":0},"end":{"line":24,"column":1}},"4":{"start":{"line":19,"column":2},"end":{"line":19,"column":30}},"5":{"start":{"line":20,"column":2},"end":{"line":20,"column":35}},"6":{"start":{"line":21,"column":2},"end":{"line":21,"column":19}},"7":{"start":{"line":22,"column":2},"end":{"line":22,"column":21}},"8":{"start":{"line":23,"column":2},"end":{"line":23,"column":23}},"9":{"start":{"line":33,"column":0},"end":{"line":39,"column":1}},"10":{"start":{"line":34,"column":2},"end":{"line":34,"column":43}},"11":{"start":{"line":36,"column":2},"end":{"line":38,"column":3}},"12":{"start":{"line":37,"column":4},"end":{"line":37,"column":25}},"13":{"start":{"line":40,"column":0},"end":{"line":40,"column":43}},"14":{"start":{"line":41,"column":0},"end":{"line":41,"column":43}},"15":{"start":{"line":42,"column":0},"end":{"line":42,"column":38}},"16":{"start":{"line":44,"column":0},"end":{"line":46,"column":2}},"17":{"start":{"line":45,"column":2},"end":{"line":45,"column":65}},"18":{"start":{"line":48,"column":0},"end":{"line":50,"column":2}},"19":{"start":{"line":49,"column":2},"end":{"line":49,"column":20}},"20":{"start":{"line":52,"column":0},"end":{"line":60,"column":2}},"21":{"start":{"line":53,"column":2},"end":{"line":55,"column":17}},"22":{"start":{"line":56,"column":2},"end":{"line":59,"column":3}},"23":{"start":{"line":57,"column":4},"end":{"line":57,"column":73}},"24":{"start":{"line":58,"column":4},"end":{"line":58,"column":35}},"25":{"start":{"line":62,"column":0},"end":{"line":64,"column":2}},"26":{"start":{"line":63,"column":2},"end":{"line":63,"column":52}},"27":{"start":{"line":66,"column":0},"end":{"line":81,"column":2}},"28":{"start":{"line":68,"column":4},"end":{"line":68,"column":44}},"29":{"start":{"line":69,"column":4},"end":{"line":71,"column":6}},"30":{"start":{"line":70,"column":6},"end":{"line":70,"column":40}},"31":{"start":{"line":73,"column":4},"end":{"line":79,"column":6}},"32":{"start":{"line":74,"column":6},"end":{"line":78,"column":7}},"33":{"start":{"line":75,"column":8},"end":{"line":75,"column":57}},"34":{"start":{"line":76,"column":8},"end":{"line":76,"column":28}},"35":{"start":{"line":77,"column":8},"end":{"line":77,"column":47}},"36":{"start":{"line":87,"column":0},"end":{"line":89,"column":1}},"37":{"start":{"line":88,"column":2},"end":{"line":88,"column":27}},"38":{"start":{"line":95,"column":0},"end":{"line":97,"column":1}},"39":{"start":{"line":96,"column":2},"end":{"line":96,"column":26}},"40":{"start":{"line":99,"column":0},"end":{"line":99,"column":36}},"41":{"start":{"line":100,"column":0},"end":{"line":100,"column":24}},"42":{"start":{"line":101,"column":0},"end":{"line":101,"column":50}},"43":{"start":{"line":102,"column":0},"end":{"line":102,"column":48}}},"branchMap":{"1":{"line":34,"type":"binary-expr","locations":[{"start":{"line":34,"column":18},"end":{"line":34,"column":22}},{"start":{"line":34,"column":26},"end":{"line":34,"column":42}}]},"2":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":2}},{"start":{"line":36,"column":2},"end":{"line":36,"column":2}}]},"3":{"line":45,"type":"binary-expr","locations":[{"start":{"line":45,"column":37},"end":{"line":45,"column":47}},{"start":{"line":45,"column":51},"end":{"line":45,"column":63}}]},"4":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":2},"end":{"line":56,"column":2}},{"start":{"line":56,"column":2},"end":{"line":56,"column":2}}]},"5":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":6},"end":{"line":74,"column":6}},{"start":{"line":74,"column":6},"end":{"line":74,"column":6}}]},"6":{"line":74,"type":"binary-expr","locations":[{"start":{"line":74,"column":10},"end":{"line":74,"column":26}},{"start":{"line":74,"column":30},"end":{"line":74,"column":56}}]}},"code":["\"use strict\";","var levels = require('./levels')",", util = require('util')",", events = require('events')",", DEFAULT_CATEGORY = '[default]';","","var logWritesEnabled = true;","","/**"," * Models a logging event."," * @constructor"," * @param {String} categoryName name of category"," * @param {Log4js.Level} level level of message"," * @param {Array} data objects to log"," * @param {Log4js.Logger} logger the associated logger"," * @author Seth Chisamore"," */","function LoggingEvent (categoryName, level, data, logger) {","  this.startTime = new Date();","  this.categoryName = categoryName;","  this.data = data;","  this.level = level;","  this.logger = logger;","}","","/**"," * Logger to log messages."," * use {@see Log4js#getLogger(String)} to get an instance."," * @constructor"," * @param name name of category to log to"," * @author Stephan Strittmatter"," */","function Logger (name, level) {","  this.category = name || DEFAULT_CATEGORY;","  ","  if (level) {","    this.setLevel(level);","  }","}","util.inherits(Logger, events.EventEmitter);","Logger.DEFAULT_CATEGORY = DEFAULT_CATEGORY;","Logger.prototype.level = levels.TRACE;","","Logger.prototype.setLevel = function(level) {","  this.level = levels.toLevel(level, this.level || levels.TRACE);","};","","Logger.prototype.removeLevel = function() {","  delete this.level;","};","","Logger.prototype.log = function() {","  var args = Array.prototype.slice.call(arguments)","  , logLevel = levels.toLevel(args.shift())","  , loggingEvent;","  if (this.isLevelEnabled(logLevel)) {","    loggingEvent = new LoggingEvent(this.category, logLevel, args, this);","    this.emit(\"log\", loggingEvent);","  }","};","","Logger.prototype.isLevelEnabled = function(otherLevel) {","  return this.level.isLessThanOrEqualTo(otherLevel);","};","","['Trace','Debug','Info','Warn','Error','Fatal'].forEach(","  function(levelString) {","    var level = levels.toLevel(levelString);","    Logger.prototype['is'+levelString+'Enabled'] = function() {","      return this.isLevelEnabled(level);","    };","    ","    Logger.prototype[levelString.toLowerCase()] = function () {","      if (logWritesEnabled && this.isLevelEnabled(level)) {","        var args = Array.prototype.slice.call(arguments);","        args.unshift(level);","        Logger.prototype.log.apply(this, args);","      }","    };","  }",");","","/**"," * Disable all log writes."," * @returns {void}"," */","function disableAllLogWrites() {","  logWritesEnabled = false;","}","","/**"," * Enable log writes."," * @returns {void}"," */","function enableAllLogWrites() {","  logWritesEnabled = true;","}","","exports.LoggingEvent = LoggingEvent;","exports.Logger = Logger;","exports.disableAllLogWrites = disableAllLogWrites;","exports.enableAllLogWrites = enableAllLogWrites;",""],"l":{"2":1,"7":1,"18":1,"19":4,"20":4,"21":4,"22":4,"23":4,"33":1,"34":10,"36":10,"37":0,"40":1,"41":1,"42":1,"44":1,"45":0,"48":1,"49":0,"52":1,"53":4,"56":4,"57":4,"58":4,"62":1,"63":8,"66":1,"68":6,"69":6,"70":0,"73":6,"74":4,"75":4,"76":4,"77":4,"87":1,"88":0,"95":1,"96":0,"99":1,"100":1,"101":1,"102":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/connect-logger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/connect-logger.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":1,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0,0],"24":[0,0,0,0,0,0],"25":[0,0],"26":[0,0,0,0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"getLogger","line":34,"loc":{"start":{"line":34,"column":0},"end":{"line":34,"column":39}}},"2":{"name":"(anonymous_2)","line":48,"loc":{"start":{"line":48,"column":9},"end":{"line":48,"column":35}}},"3":{"name":"(anonymous_3)","line":66,"loc":{"start":{"line":66,"column":19},"end":{"line":66,"column":42}}},"4":{"name":"(anonymous_4)","line":83,"loc":{"start":{"line":83,"column":13},"end":{"line":83,"column":39}}},"5":{"name":"(anonymous_5)","line":95,"loc":{"start":{"line":95,"column":31},"end":{"line":95,"column":44}}},"6":{"name":"format","line":119,"loc":{"start":{"line":119,"column":0},"end":{"line":119,"column":31}}},"7":{"name":"(anonymous_7)","line":140,"loc":{"start":{"line":140,"column":34},"end":{"line":140,"column":52}}},"8":{"name":"(anonymous_8)","line":141,"loc":{"start":{"line":141,"column":34},"end":{"line":141,"column":52}}},"9":{"name":"createNoLogCondition","line":175,"loc":{"start":{"line":175,"column":0},"end":{"line":175,"column":37}}},"10":{"name":"convertToStrings","line":189,"loc":{"start":{"line":189,"column":8},"end":{"line":189,"column":37}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"2":{"start":{"line":3,"column":0},"end":{"line":6,"column":19}},"3":{"start":{"line":34,"column":0},"end":{"line":107,"column":1}},"4":{"start":{"line":35,"column":1},"end":{"line":41,"column":2}},"5":{"start":{"line":36,"column":2},"end":{"line":36,"column":26}},"6":{"start":{"line":37,"column":8},"end":{"line":41,"column":2}},"7":{"start":{"line":38,"column":2},"end":{"line":38,"column":32}},"8":{"start":{"line":40,"column":2},"end":{"line":40,"column":15}},"9":{"start":{"line":43,"column":1},"end":{"line":46,"column":71}},"10":{"start":{"line":48,"column":2},"end":{"line":106,"column":4}},"11":{"start":{"line":50,"column":4},"end":{"line":50,"column":36}},"12":{"start":{"line":50,"column":22},"end":{"line":50,"column":36}},"13":{"start":{"line":53,"column":2},"end":{"line":53,"column":58}},"14":{"start":{"line":53,"column":44},"end":{"line":53,"column":58}},"15":{"start":{"line":54,"column":2},"end":{"line":102,"column":3}},"16":{"start":{"line":56,"column":3},"end":{"line":60,"column":27}},"17":{"start":{"line":63,"column":3},"end":{"line":63,"column":23}},"18":{"start":{"line":66,"column":3},"end":{"line":80,"column":5}},"19":{"start":{"line":67,"column":4},"end":{"line":67,"column":30}},"20":{"start":{"line":68,"column":4},"end":{"line":68,"column":33}},"21":{"start":{"line":69,"column":4},"end":{"line":69,"column":41}},"22":{"start":{"line":70,"column":4},"end":{"line":70,"column":34}},"23":{"start":{"line":73,"column":4},"end":{"line":79,"column":5}},"24":{"start":{"line":74,"column":5},"end":{"line":74,"column":25}},"25":{"start":{"line":75,"column":5},"end":{"line":75,"column":41}},"26":{"start":{"line":75,"column":21},"end":{"line":75,"column":41}},"27":{"start":{"line":76,"column":5},"end":{"line":76,"column":42}},"28":{"start":{"line":76,"column":21},"end":{"line":76,"column":42}},"29":{"start":{"line":78,"column":5},"end":{"line":78,"column":56}},"30":{"start":{"line":83,"column":3},"end":{"line":101,"column":5}},"31":{"start":{"line":84,"column":4},"end":{"line":84,"column":18}},"32":{"start":{"line":85,"column":4},"end":{"line":85,"column":29}},"33":{"start":{"line":86,"column":4},"end":{"line":86,"column":42}},"34":{"start":{"line":88,"column":4},"end":{"line":92,"column":5}},"35":{"start":{"line":89,"column":5},"end":{"line":89,"column":25}},"36":{"start":{"line":90,"column":5},"end":{"line":90,"column":51}},"37":{"start":{"line":90,"column":31},"end":{"line":90,"column":51}},"38":{"start":{"line":91,"column":5},"end":{"line":91,"column":52}},"39":{"start":{"line":91,"column":31},"end":{"line":91,"column":52}},"40":{"start":{"line":93,"column":4},"end":{"line":100,"column":5}},"41":{"start":{"line":94,"column":5},"end":{"line":99,"column":6}},"42":{"start":{"line":95,"column":6},"end":{"line":95,"column":79}},"43":{"start":{"line":95,"column":46},"end":{"line":95,"column":75}},"44":{"start":{"line":96,"column":6},"end":{"line":96,"column":44}},"45":{"start":{"line":96,"column":16},"end":{"line":96,"column":44}},"46":{"start":{"line":98,"column":6},"end":{"line":98,"column":51}},"47":{"start":{"line":105,"column":4},"end":{"line":105,"column":11}},"48":{"start":{"line":119,"column":0},"end":{"line":146,"column":1}},"49":{"start":{"line":120,"column":1},"end":{"line":145,"column":7}},"50":{"start":{"line":140,"column":54},"end":{"line":140,"column":94}},"51":{"start":{"line":142,"column":6},"end":{"line":144,"column":50}},"52":{"start":{"line":175,"column":0},"end":{"line":198,"column":1}},"53":{"start":{"line":176,"column":2},"end":{"line":176,"column":20}},"54":{"start":{"line":178,"column":1},"end":{"line":195,"column":3}},"55":{"start":{"line":179,"column":4},"end":{"line":181,"column":5}},"56":{"start":{"line":180,"column":6},"end":{"line":180,"column":21}},"57":{"start":{"line":183,"column":4},"end":{"line":185,"column":5}},"58":{"start":{"line":184,"column":6},"end":{"line":184,"column":33}},"59":{"start":{"line":187,"column":4},"end":{"line":194,"column":5}},"60":{"start":{"line":188,"column":6},"end":{"line":192,"column":8}},"61":{"start":{"line":190,"column":10},"end":{"line":190,"column":41}},"62":{"start":{"line":193,"column":6},"end":{"line":193,"column":54}},"63":{"start":{"line":197,"column":2},"end":{"line":197,"column":16}},"64":{"start":{"line":200,"column":0},"end":{"line":200,"column":34}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},{"start":{"line":35,"column":1},"end":{"line":35,"column":1}}]},"2":{"line":36,"type":"binary-expr","locations":[{"start":{"line":36,"column":12},"end":{"line":36,"column":19}},{"start":{"line":36,"column":23},"end":{"line":36,"column":25}}]},"3":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":37,"column":8}},{"start":{"line":37,"column":8},"end":{"line":37,"column":8}}]},"4":{"line":45,"type":"binary-expr","locations":[{"start":{"line":45,"column":10},"end":{"line":45,"column":24}},{"start":{"line":45,"column":28},"end":{"line":45,"column":42}}]},"5":{"line":46,"type":"cond-expr","locations":[{"start":{"line":46,"column":28},"end":{"line":46,"column":63}},{"start":{"line":46,"column":66},"end":{"line":46,"column":70}}]},"6":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":4},"end":{"line":50,"column":4}},{"start":{"line":50,"column":4},"end":{"line":50,"column":4}}]},"7":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":53,"column":2}},{"start":{"line":53,"column":2},"end":{"line":53,"column":2}}]},"8":{"line":53,"type":"binary-expr","locations":[{"start":{"line":53,"column":6},"end":{"line":53,"column":11}},{"start":{"line":53,"column":15},"end":{"line":53,"column":42}}]},"9":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":2},"end":{"line":54,"column":2}},{"start":{"line":54,"column":2},"end":{"line":54,"column":2}}]},"10":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":6},"end":{"line":54,"column":38}},{"start":{"line":54,"column":42},"end":{"line":54,"column":66}}]},"11":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":20},"end":{"line":70,"column":27}},{"start":{"line":70,"column":31},"end":{"line":70,"column":33}}]},"12":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":73,"column":4}},{"start":{"line":73,"column":4},"end":{"line":73,"column":4}}]},"13":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":5},"end":{"line":75,"column":5}},{"start":{"line":75,"column":5},"end":{"line":75,"column":5}}]},"14":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":5},"end":{"line":76,"column":5}},{"start":{"line":76,"column":5},"end":{"line":76,"column":5}}]},"15":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"16":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":7},"end":{"line":88,"column":21}},{"start":{"line":88,"column":25},"end":{"line":88,"column":49}}]},"17":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":5},"end":{"line":90,"column":5}},{"start":{"line":90,"column":5},"end":{"line":90,"column":5}}]},"18":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":5},"end":{"line":91,"column":5}},{"start":{"line":91,"column":5},"end":{"line":91,"column":5}}]},"19":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":4},"end":{"line":93,"column":4}},{"start":{"line":93,"column":4},"end":{"line":93,"column":4}}]},"20":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":5},"end":{"line":94,"column":5}},{"start":{"line":94,"column":5},"end":{"line":94,"column":5}}]},"21":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":6},"end":{"line":96,"column":6}},{"start":{"line":96,"column":6},"end":{"line":96,"column":6}}]},"22":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":24},"end":{"line":123,"column":40}},{"start":{"line":123,"column":44},"end":{"line":123,"column":58}}]},"23":{"line":126,"type":"binary-expr","locations":[{"start":{"line":126,"column":26},"end":{"line":126,"column":45}},{"start":{"line":126,"column":49},"end":{"line":126,"column":69}},{"start":{"line":126,"column":73},"end":{"line":126,"column":75}}]},"24":{"line":129,"type":"binary-expr","locations":[{"start":{"line":129,"column":22},"end":{"line":129,"column":28}},{"start":{"line":129,"column":32},"end":{"line":129,"column":50}},{"start":{"line":130,"column":6},"end":{"line":130,"column":16}},{"start":{"line":131,"column":9},"end":{"line":131,"column":33}},{"start":{"line":131,"column":38},"end":{"line":131,"column":55}},{"start":{"line":131,"column":59},"end":{"line":131,"column":90}}]},"25":{"line":133,"type":"binary-expr","locations":[{"start":{"line":133,"column":28},"end":{"line":133,"column":53}},{"start":{"line":133,"column":57},"end":{"line":133,"column":59}}]},"26":{"line":136,"type":"binary-expr","locations":[{"start":{"line":136,"column":7},"end":{"line":136,"column":19}},{"start":{"line":136,"column":23},"end":{"line":136,"column":53}},{"start":{"line":137,"column":9},"end":{"line":137,"column":22}},{"start":{"line":137,"column":26},"end":{"line":137,"column":57}},{"start":{"line":138,"column":8},"end":{"line":138,"column":11}}]},"27":{"line":142,"type":"cond-expr","locations":[{"start":{"line":143,"column":9},"end":{"line":143,"column":66}},{"start":{"line":144,"column":11},"end":{"line":144,"column":48}}]},"28":{"line":143,"type":"binary-expr","locations":[{"start":{"line":143,"column":9},"end":{"line":143,"column":42}},{"start":{"line":143,"column":46},"end":{"line":143,"column":66}}]},"29":{"line":144,"type":"binary-expr","locations":[{"start":{"line":144,"column":11},"end":{"line":144,"column":24}},{"start":{"line":144,"column":28},"end":{"line":144,"column":48}}]},"30":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},{"start":{"line":178,"column":1},"end":{"line":178,"column":1}}]},"31":{"line":179,"type":"if","locations":[{"start":{"line":179,"column":4},"end":{"line":179,"column":4}},{"start":{"line":179,"column":4},"end":{"line":179,"column":4}}]},"32":{"line":183,"type":"if","locations":[{"start":{"line":183,"column":4},"end":{"line":183,"column":4}},{"start":{"line":183,"column":4},"end":{"line":183,"column":4}}]},"33":{"line":187,"type":"if","locations":[{"start":{"line":187,"column":4},"end":{"line":187,"column":4}},{"start":{"line":187,"column":4},"end":{"line":187,"column":4}}]},"34":{"line":190,"type":"cond-expr","locations":[{"start":{"line":190,"column":28},"end":{"line":190,"column":36}},{"start":{"line":190,"column":39},"end":{"line":190,"column":40}}]}},"code":["\"use strict\";","var levels = require(\"./levels\");","var DEFAULT_FORMAT = ':remote-addr - -' + ","  ' \":method :url HTTP/:http-version\"' + ","  ' :status :content-length \":referrer\"' + ","  ' \":user-agent\"';","/**"," * Log requests with the given `options` or a `format` string."," *"," * Options:"," *"," *   - `format`        Format string, see below for tokens"," *   - `level`         A log4js levels instance. Supports also 'auto'"," *"," * Tokens:"," *"," *   - `:req[header]` ex: `:req[Accept]`"," *   - `:res[header]` ex: `:res[Content-Length]`"," *   - `:http-version`"," *   - `:response-time`"," *   - `:remote-addr`"," *   - `:date`"," *   - `:method`"," *   - `:url`"," *   - `:referrer`"," *   - `:user-agent`"," *   - `:status`"," *"," * @param {String|Function|Object} format or options"," * @return {Function}"," * @api public"," */","","function getLogger(logger4js, options) {","\tif ('object' == typeof options) {","\t\toptions = options || {};","\t} else if (options) {","\t\toptions = { format: options };","\t} else {","\t\toptions = {};","\t}","","\tvar thislogger = logger4js","  , level = levels.toLevel(options.level, levels.INFO)","  , fmt = options.format || DEFAULT_FORMAT","  , nolog = options.nolog ? createNoLogCondition(options.nolog) : null;","","  return function (req, res, next) {","    // mount safety","    if (req._logging) return next();","","\t\t// nologs","\t\tif (nolog && nolog.test(req.originalUrl)) return next();","\t\tif (thislogger.isLevelEnabled(level) || options.level === 'auto') {","      ","\t\t\tvar start = new Date()","\t\t\t, statusCode","\t\t\t, writeHead = res.writeHead","\t\t\t, end = res.end","\t\t\t, url = req.originalUrl;","","\t\t\t// flag as logging","\t\t\treq._logging = true;","      ","\t\t\t// proxy for statusCode.","\t\t\tres.writeHead = function(code, headers){","\t\t\t\tres.writeHead = writeHead;","\t\t\t\tres.writeHead(code, headers);","\t\t\t\tres.__statusCode = statusCode = code;","\t\t\t\tres.__headers = headers || {};","","\t\t\t\t//status code response level handling","\t\t\t\tif(options.level === 'auto'){","\t\t\t\t\tlevel = levels.INFO;","\t\t\t\t\tif(code >= 300) level = levels.WARN;","\t\t\t\t\tif(code >= 400) level = levels.ERROR;","\t\t\t\t} else {","\t\t\t\t\tlevel = levels.toLevel(options.level, levels.INFO);","\t\t\t\t}","\t\t\t};","      ","\t\t\t// proxy end to output a line to the provided logger.","\t\t\tres.end = function(chunk, encoding) {","\t\t\t\tres.end = end;","\t\t\t\tres.end(chunk, encoding);","\t\t\t\tres.responseTime = new Date() - start;","\t\t\t\t//status code response level handling","\t\t\t\tif(res.statusCode && options.level === 'auto'){","\t\t\t\t\tlevel = levels.INFO;","\t\t\t\t\tif(res.statusCode >= 300) level = levels.WARN;","\t\t\t\t\tif(res.statusCode >= 400) level = levels.ERROR;","\t\t\t\t}","\t\t\t\tif (thislogger.isLevelEnabled(level)) {","\t\t\t\t\tif (typeof fmt === 'function') {","\t\t\t\t\t\tvar line = fmt(req, res, function(str){ return format(str, req, res); });","\t\t\t\t\t\tif (line) thislogger.log(level, line);","\t\t\t\t\t} else {","\t\t\t\t\t\tthislogger.log(level, format(fmt, req, res));","\t\t\t\t\t}","\t\t\t\t}","\t\t\t};","\t\t}","    ","    //ensure next gets always called","    next();","  };","}","","/**"," * Return formatted log line."," *"," * @param  {String} str"," * @param  {IncomingMessage} req"," * @param  {ServerResponse} res"," * @return {String}"," * @api private"," */","","function format(str, req, res) {","\treturn str","    .replace(':url', req.originalUrl)","    .replace(':method', req.method)","    .replace(':status', res.__statusCode || res.statusCode)","    .replace(':response-time', res.responseTime)","    .replace(':date', new Date().toUTCString())","    .replace(':referrer', req.headers.referer || req.headers.referrer || '')","    .replace(':http-version', req.httpVersionMajor + '.' + req.httpVersionMinor)","    .replace(","      ':remote-addr', req.ip || req._remoteAddress || ( ","      req.socket && ","        (req.socket.remoteAddress || (req.socket.socket && req.socket.socket.remoteAddress))","    ))","    .replace(':user-agent', req.headers['user-agent'] || '')","    .replace(","      ':content-length', ","      (res._headers && res._headers['content-length']) || ","        (res.__headers && res.__headers['Content-Length']) || ","        '-'","    )","    .replace(/:req\\[([^\\]]+)\\]/g, function(_, field){ return req.headers[field.toLowerCase()]; })","    .replace(/:res\\[([^\\]]+)\\]/g, function(_, field){","      return res._headers ? ","        (res._headers[field.toLowerCase()] || res.__headers[field])","        : (res.__headers && res.__headers[field]);","    });","}","","/**"," * Return RegExp Object about nolog"," *"," * @param  {String} nolog"," * @return {RegExp}"," * @api private"," *"," * syntax"," *  1. String"," *   1.1 \"\\\\.gif\""," *         NOT LOGGING http://example.com/hoge.gif and http://example.com/hoge.gif?fuga"," *         LOGGING http://example.com/hoge.agif"," *   1.2 in \"\\\\.gif|\\\\.jpg$\""," *         NOT LOGGING http://example.com/hoge.gif and "," *           http://example.com/hoge.gif?fuga and http://example.com/hoge.jpg?fuga"," *         LOGGING http://example.com/hoge.agif, "," *           http://example.com/hoge.ajpg and http://example.com/hoge.jpg?hoge"," *   1.3 in \"\\\\.(gif|jpe?g|png)$\""," *         NOT LOGGING http://example.com/hoge.gif and http://example.com/hoge.jpeg"," *         LOGGING http://example.com/hoge.gif?uid=2 and http://example.com/hoge.jpg?pid=3"," *  2. RegExp"," *   2.1 in /\\.(gif|jpe?g|png)$/"," *         SAME AS 1.3"," *  3. Array"," *   3.1 [\"\\\\.jpg$\", \"\\\\.png\", \"\\\\.gif\"]"," *         SAME AS \"\\\\.jpg|\\\\.png|\\\\.gif\""," */","function createNoLogCondition(nolog) {","  var regexp = null;","","\tif (nolog) {","    if (nolog instanceof RegExp) {","      regexp = nolog;","    } ","    ","    if (typeof nolog === 'string') {","      regexp = new RegExp(nolog);","    }","    ","    if (Array.isArray(nolog)) {","      var regexpsAsStrings = nolog.map(","        function convertToStrings(o) { ","          return o.source ? o.source : o;","        }","      );","      regexp = new RegExp(regexpsAsStrings.join('|'));","    }","  }","","  return regexp;","}","","exports.connectLogger = getLogger;",""],"l":{"2":1,"3":1,"34":1,"35":0,"36":0,"37":0,"38":0,"40":0,"43":0,"48":0,"50":0,"53":0,"54":0,"56":0,"63":0,"66":0,"67":0,"68":0,"69":0,"70":0,"73":0,"74":0,"75":0,"76":0,"78":0,"83":0,"84":0,"85":0,"86":0,"88":0,"89":0,"90":0,"91":0,"93":0,"94":0,"95":0,"96":0,"98":0,"105":0,"119":1,"120":0,"140":0,"142":0,"175":1,"176":0,"178":0,"179":0,"180":0,"183":0,"184":0,"187":0,"188":0,"190":0,"193":0,"197":0,"200":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/appenders/console.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-logger/node_modules/log4js/lib/appenders/console.js","s":{"1":1,"2":1,"3":1,"4":1,"5":4,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1},"b":{"1":[1,1],"2":[0,1]},"f":{"1":1,"2":4,"3":1},"fnMap":{"1":{"name":"consoleAppender","line":5,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":34}}},"2":{"name":"(anonymous_2)","line":7,"loc":{"start":{"line":7,"column":9},"end":{"line":7,"column":32}}},"3":{"name":"configure","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":27}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":3,"column":41}},"2":{"start":{"line":5,"column":0},"end":{"line":10,"column":1}},"3":{"start":{"line":6,"column":2},"end":{"line":6,"column":44}},"4":{"start":{"line":7,"column":2},"end":{"line":9,"column":4}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":37}},"6":{"start":{"line":12,"column":0},"end":{"line":18,"column":1}},"7":{"start":{"line":13,"column":2},"end":{"line":13,"column":13}},"8":{"start":{"line":14,"column":2},"end":{"line":16,"column":3}},"9":{"start":{"line":15,"column":4},"end":{"line":15,"column":63}},"10":{"start":{"line":17,"column":2},"end":{"line":17,"column":33}},"11":{"start":{"line":20,"column":0},"end":{"line":20,"column":35}},"12":{"start":{"line":21,"column":0},"end":{"line":21,"column":30}}},"branchMap":{"1":{"line":6,"type":"binary-expr","locations":[{"start":{"line":6,"column":11},"end":{"line":6,"column":17}},{"start":{"line":6,"column":21},"end":{"line":6,"column":43}}]},"2":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":2},"end":{"line":14,"column":2}},{"start":{"line":14,"column":2},"end":{"line":14,"column":2}}]}},"code":["\"use strict\";","var layouts = require('../layouts')",", consoleLog = console.log.bind(console);","","function consoleAppender (layout) {","  layout = layout || layouts.colouredLayout;","  return function(loggingEvent) {","    consoleLog(layout(loggingEvent));","  };","}","","function configure(config) {","  var layout;","  if (config.layout) {","    layout = layouts.layout(config.layout.type, config.layout);","  }","  return consoleAppender(layout);","}","","exports.appender = consoleAppender;","exports.configure = configure;",""],"l":{"2":1,"5":1,"6":1,"7":1,"8":4,"12":1,"13":1,"14":1,"15":0,"17":1,"20":1,"21":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/constants.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/constants.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":112,"column":2}}},"branchMap":{},"code":["module.exports = {","  KEYWORDS: {","    BEFORE_FILTER: '__befores__',","    AFTER_FILTER: '__afters__',","    GLOBAL_BEFORE_FILTER: '__globalBefores__',","    GLOBAL_AFTER_FILTER: '__globalAfters__',","    ROUTE: '__routes__',","    BEFORE_STOP_HOOK: '__beforeStopHook__',","    MODULE: '__modules__',","    SERVER_MAP: '__serverMap__',","    RPC_BEFORE_FILTER: '__rpcBefores__',","    RPC_AFTER_FILTER: '__rpcAfters__',","    MASTER_WATCHER: '__masterwatcher__',","    MONITOR_WATCHER: '__monitorwatcher__'"," },","","  FILEPATH: {","    MASTER: '/config/master.json',","    SERVER: '/config/servers.json',","    CRON: '/config/crons.json',","    LOG: '/config/log4js.json',","    SERVER_PROTOS: '/config/serverProtos.json',","    CLIENT_PROTOS: '/config/clientProtos.json',","    MASTER_HA: '/config/masterha.json',","    LIFECYCLE: '/lifecycle.js',","    SERVER_DIR: '/app/servers/',","    CONFIG_DIR: '/config'","  },","","  DIR: {","    HANDLER: 'handler',","    REMOTE: 'remote',","    CRON: 'cron',","    LOG: 'logs',","    SCRIPT: 'scripts',","    EVENT: 'events',","    COMPONENT: 'components'","  },","","  RESERVED: {","    BASE: 'base',","    MAIN: 'main',","    MASTER: 'master',","    SERVERS: 'servers',","    ENV: 'env',","    CPU: 'cpu',","    ENV_DEV: 'development',","    ENV_PRO: 'production',","    ALL: 'all',","    SERVER_TYPE: 'serverType',","    SERVER_ID: 'serverId',","    CURRENT_SERVER: 'curServer',","    MODE: 'mode',","    TYPE: 'type',","    CLUSTER: 'clusters',","    STAND_ALONE: 'stand-alone',","    START: 'start',","    AFTER_START: 'afterStart',","    CRONS: 'crons',","    ERROR_HANDLER: 'errorHandler',","    GLOBAL_ERROR_HANDLER: 'globalErrorHandler',","    AUTO_RESTART: 'auto-restart',","    RESTART_FORCE: 'restart-force',","    CLUSTER_COUNT: 'clusterCount',","    CLUSTER_PREFIX: 'cluster-server-',","    CLUSTER_SIGNAL: '++',","    RPC_ERROR_HANDLER: 'rpcErrorHandler',","    SERVER: 'server',","    CLIENT: 'client',","    STARTID: 'startId',","    STOP_SERVERS: 'stop_servers',","    SSH_CONFIG_PARAMS: 'ssh_config_params'","  },","","  COMMAND: {","    TASKSET: 'taskset',","    KILL: 'kill',","    TASKKILL: 'taskkill',","    SSH: 'ssh'","  },","","  PLATFORM: {","    WIN: 'win32',","    LINUX: 'linux'","  },","","  LIFECYCLE: {","    BEFORE_STARTUP: 'beforeStartup',","    BEFORE_SHUTDOWN: 'beforeShutdown',","    AFTER_STARTUP: 'afterStartup',","    AFTER_STARTALL: 'afterStartAll'","  },","","  SIGNAL: {","    FAIL: 0,","    OK: 1","  },",""," TIME: {","   TIME_WAIT_STOP: 3 * 1000,","   TIME_WAIT_KILL: 5 * 1000,","   TIME_WAIT_RESTART: 5 * 1000,","   TIME_WAIT_COUNTDOWN: 10 * 1000,","   TIME_WAIT_MASTER_KILL: 2 * 60 * 1000,","   TIME_WAIT_MONITOR_KILL: 2 * 1000,","   TIME_WAIT_PING: 30 * 1000,","   TIME_WAIT_MAX_PING: 5 * 60 * 1000,","   DEFAULT_UDP_HEARTBEAT_TIME: 20 * 1000,","   DEFAULT_UDP_HEARTBEAT_TIMEOUT: 100 * 1000,","   DEFAULT_MQTT_HEARTBEAT_TIMEOUT: 90 * 1000"," }","};"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/events.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/events.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":12,"column":2}}},"branchMap":{},"code":["module.exports = {","\tADD_SERVERS: 'add_servers',","\tREMOVE_SERVERS: 'remove_servers',","  REPLACE_SERVERS: 'replace_servers',","  BIND_SESSION: 'bind_session',","  UNBIND_SESSION:'unbind_session',","\tCLOSE_SESSION: 'close_session',","\tADD_CRONS: 'add_crons',","\tREMOVE_CRONS: 'remove_crons',","\tSTART_SERVER: 'start_server',","\tSTART_ALL: 'start_all'","};",""],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/appUtil.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/appUtil.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":2,"11":2,"12":2,"13":2,"14":2,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":1,"65":2,"66":2,"67":2,"68":2,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":2,"80":1,"81":2,"82":2,"83":1,"84":2,"85":2,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":1,"104":2,"105":1,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":1,"116":2,"117":2,"118":2,"119":0,"120":2,"121":2,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":2,"130":1,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[2,2],"17":[2,2],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[2,2,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0]},"f":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":2,"10":2,"11":2,"12":2,"13":0,"14":2,"15":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":38},"end":{"line":13,"column":52}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":29},"end":{"line":26,"column":47}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":39},"end":{"line":45,"column":53}}},"4":{"name":"(anonymous_4)","line":81,"loc":{"start":{"line":81,"column":27},"end":{"line":81,"column":61}}},"5":{"name":"(anonymous_5)","line":88,"loc":{"start":{"line":88,"column":21},"end":{"line":88,"column":32}}},"6":{"name":"(anonymous_6)","line":106,"loc":{"start":{"line":106,"column":31},"end":{"line":106,"column":59}}},"7":{"name":"(anonymous_7)","line":108,"loc":{"start":{"line":108,"column":29},"end":{"line":108,"column":50}}},"8":{"name":"(anonymous_8)","line":115,"loc":{"start":{"line":115,"column":5},"end":{"line":115,"column":19}}},"9":{"name":"(anonymous_9)","line":130,"loc":{"start":{"line":130,"column":18},"end":{"line":130,"column":32}}},"10":{"name":"(anonymous_10)","line":155,"loc":{"start":{"line":155,"column":17},"end":{"line":155,"column":31}}},"11":{"name":"(anonymous_11)","line":163,"loc":{"start":{"line":163,"column":18},"end":{"line":163,"column":38}}},"12":{"name":"(anonymous_12)","line":193,"loc":{"start":{"line":193,"column":15},"end":{"line":193,"column":35}}},"13":{"name":"(anonymous_13)","line":200,"loc":{"start":{"line":200,"column":19},"end":{"line":200,"column":33}}},"14":{"name":"(anonymous_14)","line":222,"loc":{"start":{"line":222,"column":16},"end":{"line":222,"column":31}}},"15":{"name":"(anonymous_15)","line":249,"loc":{"start":{"line":249,"column":20},"end":{"line":249,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":29}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":23}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":39}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":43}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":70}},"9":{"start":{"line":13,"column":0},"end":{"line":21,"column":2}},"10":{"start":{"line":14,"column":2},"end":{"line":14,"column":37}},"11":{"start":{"line":15,"column":2},"end":{"line":15,"column":22}},"12":{"start":{"line":16,"column":2},"end":{"line":16,"column":18}},"13":{"start":{"line":17,"column":2},"end":{"line":17,"column":19}},"14":{"start":{"line":18,"column":2},"end":{"line":18,"column":25}},"15":{"start":{"line":19,"column":2},"end":{"line":19,"column":20}},"16":{"start":{"line":20,"column":2},"end":{"line":20,"column":21}},"17":{"start":{"line":26,"column":0},"end":{"line":40,"column":2}},"18":{"start":{"line":27,"column":2},"end":{"line":39,"column":3}},"19":{"start":{"line":28,"column":4},"end":{"line":32,"column":5}},"20":{"start":{"line":29,"column":6},"end":{"line":29,"column":31}},"21":{"start":{"line":31,"column":6},"end":{"line":31,"column":30}},"22":{"start":{"line":34,"column":4},"end":{"line":38,"column":5}},"23":{"start":{"line":35,"column":6},"end":{"line":35,"column":30}},"24":{"start":{"line":37,"column":6},"end":{"line":37,"column":31}},"25":{"start":{"line":45,"column":0},"end":{"line":71,"column":2}},"26":{"start":{"line":46,"column":2},"end":{"line":46,"column":36}},"27":{"start":{"line":48,"column":2},"end":{"line":69,"column":3}},"28":{"start":{"line":49,"column":4},"end":{"line":49,"column":53}},"29":{"start":{"line":51,"column":4},"end":{"line":51,"column":51}},"30":{"start":{"line":52,"column":4},"end":{"line":54,"column":5}},"31":{"start":{"line":53,"column":6},"end":{"line":53,"column":55}},"32":{"start":{"line":55,"column":4},"end":{"line":65,"column":5}},"33":{"start":{"line":56,"column":6},"end":{"line":56,"column":63}},"34":{"start":{"line":57,"column":6},"end":{"line":57,"column":61}},"35":{"start":{"line":58,"column":6},"end":{"line":58,"column":57}},"36":{"start":{"line":60,"column":6},"end":{"line":64,"column":7}},"37":{"start":{"line":61,"column":8},"end":{"line":61,"column":67}},"38":{"start":{"line":63,"column":8},"end":{"line":63,"column":71}},"39":{"start":{"line":66,"column":4},"end":{"line":66,"column":69}},"40":{"start":{"line":67,"column":4},"end":{"line":67,"column":55}},"41":{"start":{"line":68,"column":4},"end":{"line":68,"column":53}},"42":{"start":{"line":70,"column":2},"end":{"line":70,"column":53}},"43":{"start":{"line":81,"column":0},"end":{"line":95,"column":2}},"44":{"start":{"line":82,"column":2},"end":{"line":85,"column":3}},"45":{"start":{"line":83,"column":4},"end":{"line":83,"column":29}},"46":{"start":{"line":84,"column":4},"end":{"line":84,"column":11}},"47":{"start":{"line":86,"column":2},"end":{"line":86,"column":26}},"48":{"start":{"line":87,"column":2},"end":{"line":94,"column":3}},"49":{"start":{"line":88,"column":4},"end":{"line":91,"column":7}},"50":{"start":{"line":90,"column":6},"end":{"line":90,"column":60}},"51":{"start":{"line":93,"column":4},"end":{"line":93,"column":58}},"52":{"start":{"line":106,"column":0},"end":{"line":125,"column":2}},"53":{"start":{"line":107,"column":2},"end":{"line":107,"column":12}},"54":{"start":{"line":108,"column":2},"end":{"line":124,"column":5}},"55":{"start":{"line":109,"column":4},"end":{"line":109,"column":8}},"56":{"start":{"line":110,"column":4},"end":{"line":114,"column":5}},"57":{"start":{"line":111,"column":6},"end":{"line":111,"column":25}},"58":{"start":{"line":113,"column":6},"end":{"line":113,"column":13}},"59":{"start":{"line":116,"column":4},"end":{"line":122,"column":5}},"60":{"start":{"line":117,"column":6},"end":{"line":121,"column":7}},"61":{"start":{"line":118,"column":8},"end":{"line":118,"column":84}},"62":{"start":{"line":120,"column":8},"end":{"line":120,"column":91}},"63":{"start":{"line":123,"column":4},"end":{"line":123,"column":34}},"64":{"start":{"line":130,"column":0},"end":{"line":150,"column":2}},"65":{"start":{"line":131,"column":2},"end":{"line":131,"column":79}},"66":{"start":{"line":132,"column":2},"end":{"line":132,"column":52}},"67":{"start":{"line":133,"column":2},"end":{"line":133,"column":42}},"68":{"start":{"line":134,"column":2},"end":{"line":148,"column":3}},"69":{"start":{"line":135,"column":4},"end":{"line":135,"column":32}},"70":{"start":{"line":136,"column":4},"end":{"line":147,"column":5}},"71":{"start":{"line":137,"column":6},"end":{"line":137,"column":24}},"72":{"start":{"line":138,"column":6},"end":{"line":138,"column":37}},"73":{"start":{"line":139,"column":6},"end":{"line":142,"column":7}},"74":{"start":{"line":140,"column":8},"end":{"line":140,"column":50}},"75":{"start":{"line":141,"column":8},"end":{"line":141,"column":17}},"76":{"start":{"line":143,"column":6},"end":{"line":143,"column":36}},"77":{"start":{"line":144,"column":6},"end":{"line":146,"column":7}},"78":{"start":{"line":145,"column":8},"end":{"line":145,"column":107}},"79":{"start":{"line":149,"column":2},"end":{"line":149,"column":52}},"80":{"start":{"line":155,"column":0},"end":{"line":158,"column":2}},"81":{"start":{"line":156,"column":2},"end":{"line":156,"column":78}},"82":{"start":{"line":157,"column":2},"end":{"line":157,"column":50}},"83":{"start":{"line":163,"column":0},"end":{"line":188,"column":2}},"84":{"start":{"line":164,"column":2},"end":{"line":164,"column":64}},"85":{"start":{"line":165,"column":2},"end":{"line":165,"column":47}},"86":{"start":{"line":166,"column":2},"end":{"line":166,"column":53}},"87":{"start":{"line":167,"column":2},"end":{"line":167,"column":42}},"88":{"start":{"line":168,"column":2},"end":{"line":168,"column":49}},"89":{"start":{"line":169,"column":2},"end":{"line":169,"column":29}},"90":{"start":{"line":171,"column":2},"end":{"line":171,"column":52}},"91":{"start":{"line":172,"column":2},"end":{"line":172,"column":60}},"92":{"start":{"line":173,"column":2},"end":{"line":173,"column":56}},"93":{"start":{"line":174,"column":2},"end":{"line":174,"column":47}},"94":{"start":{"line":175,"column":2},"end":{"line":175,"column":47}},"95":{"start":{"line":176,"column":2},"end":{"line":178,"column":3}},"96":{"start":{"line":177,"column":4},"end":{"line":177,"column":55}},"97":{"start":{"line":180,"column":2},"end":{"line":187,"column":3}},"98":{"start":{"line":181,"column":4},"end":{"line":181,"column":22}},"99":{"start":{"line":182,"column":4},"end":{"line":182,"column":59}},"100":{"start":{"line":183,"column":9},"end":{"line":187,"column":3}},"101":{"start":{"line":184,"column":4},"end":{"line":184,"column":59}},"102":{"start":{"line":186,"column":4},"end":{"line":186,"column":70}},"103":{"start":{"line":193,"column":0},"end":{"line":195,"column":2}},"104":{"start":{"line":194,"column":2},"end":{"line":194,"column":104}},"105":{"start":{"line":200,"column":0},"end":{"line":213,"column":2}},"106":{"start":{"line":201,"column":2},"end":{"line":212,"column":3}},"107":{"start":{"line":202,"column":4},"end":{"line":202,"column":46}},"108":{"start":{"line":203,"column":4},"end":{"line":203,"column":70}},"109":{"start":{"line":204,"column":4},"end":{"line":204,"column":122}},"110":{"start":{"line":205,"column":4},"end":{"line":211,"column":5}},"111":{"start":{"line":206,"column":6},"end":{"line":206,"column":37}},"112":{"start":{"line":207,"column":11},"end":{"line":211,"column":5}},"113":{"start":{"line":208,"column":6},"end":{"line":208,"column":38}},"114":{"start":{"line":210,"column":6},"end":{"line":210,"column":63}},"115":{"start":{"line":222,"column":0},"end":{"line":243,"column":2}},"116":{"start":{"line":223,"column":2},"end":{"line":223,"column":19}},"117":{"start":{"line":224,"column":2},"end":{"line":224,"column":18}},"118":{"start":{"line":226,"column":2},"end":{"line":228,"column":3}},"119":{"start":{"line":227,"column":4},"end":{"line":227,"column":14}},"120":{"start":{"line":229,"column":2},"end":{"line":229,"column":31}},"121":{"start":{"line":231,"column":2},"end":{"line":240,"column":3}},"122":{"start":{"line":232,"column":4},"end":{"line":232,"column":22}},"123":{"start":{"line":233,"column":4},"end":{"line":233,"column":31}},"124":{"start":{"line":234,"column":4},"end":{"line":234,"column":32}},"125":{"start":{"line":235,"column":4},"end":{"line":235,"column":35}},"126":{"start":{"line":236,"column":4},"end":{"line":238,"column":5}},"127":{"start":{"line":237,"column":6},"end":{"line":237,"column":28}},"128":{"start":{"line":239,"column":4},"end":{"line":239,"column":25}},"129":{"start":{"line":242,"column":2},"end":{"line":242,"column":17}},"130":{"start":{"line":249,"column":0},"end":{"line":262,"column":2}},"131":{"start":{"line":250,"column":2},"end":{"line":250,"column":119}},"132":{"start":{"line":251,"column":2},"end":{"line":253,"column":3}},"133":{"start":{"line":252,"column":4},"end":{"line":252,"column":11}},"134":{"start":{"line":254,"column":2},"end":{"line":254,"column":36}},"135":{"start":{"line":255,"column":2},"end":{"line":261,"column":3}},"136":{"start":{"line":256,"column":4},"end":{"line":260,"column":5}},"137":{"start":{"line":257,"column":6},"end":{"line":257,"column":45}},"138":{"start":{"line":259,"column":6},"end":{"line":259,"column":67}}},"branchMap":{"1":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":2},"end":{"line":27,"column":2}},{"start":{"line":27,"column":2},"end":{"line":27,"column":2}}]},"2":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":28,"column":4}},{"start":{"line":28,"column":4},"end":{"line":28,"column":4}}]},"3":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":34,"column":4}},{"start":{"line":34,"column":4},"end":{"line":34,"column":4}}]},"4":{"line":34,"type":"binary-expr","locations":[{"start":{"line":34,"column":7},"end":{"line":34,"column":17}},{"start":{"line":34,"column":21},"end":{"line":34,"column":56}},{"start":{"line":34,"column":60},"end":{"line":34,"column":98}}]},"5":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":48,"column":2}},{"start":{"line":48,"column":2},"end":{"line":48,"column":2}}]},"6":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"7":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":55,"column":4}},{"start":{"line":55,"column":4},"end":{"line":55,"column":4}}]},"8":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":6},"end":{"line":60,"column":6}},{"start":{"line":60,"column":6},"end":{"line":60,"column":6}}]},"9":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":2},"end":{"line":82,"column":2}},{"start":{"line":82,"column":2},"end":{"line":82,"column":2}}]},"10":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"11":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":4},"end":{"line":110,"column":4}},{"start":{"line":110,"column":4},"end":{"line":110,"column":4}}]},"12":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":4},"end":{"line":116,"column":4}},{"start":{"line":116,"column":4},"end":{"line":116,"column":4}}]},"13":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":6},"end":{"line":117,"column":6}},{"start":{"line":117,"column":6},"end":{"line":117,"column":6}}]},"14":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":6},"end":{"line":139,"column":6}},{"start":{"line":139,"column":6},"end":{"line":139,"column":6}}]},"15":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":6},"end":{"line":144,"column":6}},{"start":{"line":144,"column":6},"end":{"line":144,"column":6}}]},"16":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":19},"end":{"line":164,"column":34}},{"start":{"line":164,"column":38},"end":{"line":164,"column":63}}]},"17":{"line":165,"type":"binary-expr","locations":[{"start":{"line":165,"column":17},"end":{"line":165,"column":24}},{"start":{"line":165,"column":28},"end":{"line":165,"column":46}}]},"18":{"line":166,"type":"binary-expr","locations":[{"start":{"line":166,"column":13},"end":{"line":166,"column":22}},{"start":{"line":166,"column":26},"end":{"line":166,"column":52}}]},"19":{"line":167,"type":"binary-expr","locations":[{"start":{"line":167,"column":17},"end":{"line":167,"column":30}},{"start":{"line":167,"column":34},"end":{"line":167,"column":41}}]},"20":{"line":168,"type":"binary-expr","locations":[{"start":{"line":168,"column":13},"end":{"line":168,"column":22}},{"start":{"line":168,"column":26},"end":{"line":168,"column":48}}]},"21":{"line":176,"type":"if","locations":[{"start":{"line":176,"column":2},"end":{"line":176,"column":2}},{"start":{"line":176,"column":2},"end":{"line":176,"column":2}}]},"22":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":2},"end":{"line":180,"column":2}},{"start":{"line":180,"column":2},"end":{"line":180,"column":2}}]},"23":{"line":183,"type":"if","locations":[{"start":{"line":183,"column":9},"end":{"line":183,"column":9}},{"start":{"line":183,"column":9},"end":{"line":183,"column":9}}]},"24":{"line":194,"type":"binary-expr","locations":[{"start":{"line":194,"column":34},"end":{"line":194,"column":42}},{"start":{"line":194,"column":46},"end":{"line":194,"column":66}},{"start":{"line":194,"column":70},"end":{"line":194,"column":96}}]},"25":{"line":201,"type":"if","locations":[{"start":{"line":201,"column":2},"end":{"line":201,"column":2}},{"start":{"line":201,"column":2},"end":{"line":201,"column":2}}]},"26":{"line":205,"type":"if","locations":[{"start":{"line":205,"column":4},"end":{"line":205,"column":4}},{"start":{"line":205,"column":4},"end":{"line":205,"column":4}}]},"27":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":11},"end":{"line":207,"column":11}},{"start":{"line":207,"column":11},"end":{"line":207,"column":11}}]},"28":{"line":236,"type":"if","locations":[{"start":{"line":236,"column":4},"end":{"line":236,"column":4}},{"start":{"line":236,"column":4},"end":{"line":236,"column":4}}]},"29":{"line":236,"type":"binary-expr","locations":[{"start":{"line":236,"column":8},"end":{"line":236,"column":29}},{"start":{"line":236,"column":34},"end":{"line":236,"column":56}}]},"30":{"line":251,"type":"if","locations":[{"start":{"line":251,"column":2},"end":{"line":251,"column":2}},{"start":{"line":251,"column":2},"end":{"line":251,"column":2}}]},"31":{"line":256,"type":"if","locations":[{"start":{"line":256,"column":4},"end":{"line":256,"column":4}},{"start":{"line":256,"column":4},"end":{"line":256,"column":4}}]}},"code":["var async = require('async');","var log = require('./log');","var utils = require('./utils');","var path = require('path');","var fs = require('fs');","var Constants = require('./constants');","var starter = require('../master/starter');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","/**"," * Initialize application configuration."," */","module.exports.defaultConfiguration = function(app) {","  var args = parseArgs(process.argv);","  setupEnv(app, args);","  loadMaster(app);","  loadServers(app);","  processArgs(app, args);","  configLogger(app);","  loadLifecycle(app);","};","","/**"," * Start servers by type."," */","module.exports.startByType = function(app, cb) {","  if(!!app.startId) {","    if(app.startId === Constants.RESERVED.MASTER) {","      utils.invokeCallback(cb);","    } else {","      starter.runServers(app);","    }","  } else {","    if(!!app.type && app.type !== Constants.RESERVED.ALL && app.type !== Constants.RESERVED.MASTER) {","      starter.runServers(app);","    } else {","      utils.invokeCallback(cb);","    }","  }","};","","/**"," * Load default components for application."," */","module.exports.loadDefaultComponents = function(app) {","  var pomelo = require('../pomelo');","  // load system default components","  if (app.serverType === Constants.RESERVED.MASTER) {","    app.load(pomelo.master, app.get('masterConfig'));","  } else {","    app.load(pomelo.proxy, app.get('proxyConfig'));","    if (app.getCurServer().port) {","      app.load(pomelo.remote, app.get('remoteConfig'));","    }","    if (app.isFrontend()) {","      app.load(pomelo.connection, app.get('connectionConfig'));","      app.load(pomelo.connector, app.get('connectorConfig'));","      app.load(pomelo.session, app.get('sessionConfig'));","      // compatible for schedulerConfig","      if(app.get('schedulerConfig')) {","        app.load(pomelo.pushScheduler, app.get('schedulerConfig'));","      } else {","        app.load(pomelo.pushScheduler, app.get('pushSchedulerConfig'));","      }","    }","    app.load(pomelo.backendSession, app.get('backendSessionConfig'));","    app.load(pomelo.channel, app.get('channelConfig'));","    app.load(pomelo.server, app.get('serverConfig'));","  }","  app.load(pomelo.monitor, app.get('monitorConfig'));","};","","/**"," * Stop components."," *"," * @param  {Array}  comps component list"," * @param  {Number}   index current component index"," * @param  {Boolean}  force whether stop component immediately"," * @param  {Function} cb"," */","module.exports.stopComps = function(comps, index, force, cb) {","  if (index >= comps.length) {","    utils.invokeCallback(cb);","    return;","  }","  var comp = comps[index];","  if (typeof comp.stop === 'function') {","    comp.stop(force, function() {","      // ignore any error","      module.exports.stopComps(comps, index + 1, force, cb);","    });","  } else {","    module.exports.stopComps(comps, index + 1, force, cb);","  }","};","","/**"," * Apply command to loaded components."," * This method would invoke the component {method} in series."," * Any component {method} return err, it would return err directly."," *"," * @param {Array} comps loaded component list"," * @param {String} method component lifecycle method name, such as: start, stop"," * @param {Function} cb"," */","module.exports.optComponents = function(comps, method, cb) {","  var i = 0;","  async.forEachSeries(comps, function(comp, done) {","    i++;","    if (typeof comp[method] === 'function') {","      comp[method](done);","    } else {","      done();","    }","  }, function(err) {","    if (err) {","      if(typeof err === 'string') {","        logger.error('fail to operate component, method: %s, err: %j', method, err);","      } else {","        logger.error('fail to operate component, method: %s, err: %j',  method, err.stack);","      }","    }","    utils.invokeCallback(cb, err);","  });","};","","/**"," * Load server info from config/servers.json."," */","var loadServers = function(app) {","  app.loadConfigBaseApp(Constants.RESERVED.SERVERS, Constants.FILEPATH.SERVER);","  var servers = app.get(Constants.RESERVED.SERVERS);","  var serverMap = {}, slist, i, l, server;","  for (var serverType in servers) {","    slist = servers[serverType];","    for (i = 0, l = slist.length; i < l; i++) {","      server = slist[i];","      server.serverType = serverType;","      if(server[Constants.RESERVED.CLUSTER_COUNT]) {","        utils.loadCluster(app, server, serverMap);","        continue;","      }","      serverMap[server.id] = server;","      if (server.wsPort) {","        logger.warn('wsPort is deprecated, use clientPort in frontend server instead, server: %j', server);","      }","    }","  }","  app.set(Constants.KEYWORDS.SERVER_MAP, serverMap);","};","","/**"," * Load master info from config/master.json."," */","var loadMaster = function(app) {","  app.loadConfigBaseApp(Constants.RESERVED.MASTER, Constants.FILEPATH.MASTER);","  app.master = app.get(Constants.RESERVED.MASTER);","};","","/**"," * Process server start command"," */","var processArgs = function(app, args) {","  var serverType = args.serverType || Constants.RESERVED.MASTER;","  var serverId = args.id || app.getMaster().id;","  var mode = args.mode || Constants.RESERVED.CLUSTER;","  var masterha = args.masterha || 'false';","  var type = args.type || Constants.RESERVED.ALL;","  var startId = args.startId;","","  app.set(Constants.RESERVED.MAIN, args.main, true);","  app.set(Constants.RESERVED.SERVER_TYPE, serverType, true);","  app.set(Constants.RESERVED.SERVER_ID, serverId, true);","  app.set(Constants.RESERVED.MODE, mode, true);","  app.set(Constants.RESERVED.TYPE, type, true);","  if(!!startId) {","    app.set(Constants.RESERVED.STARTID, startId, true);","  }","","  if (masterha === 'true') {","    app.master = args;","    app.set(Constants.RESERVED.CURRENT_SERVER, args, true);","  } else if (serverType !== Constants.RESERVED.MASTER) {","    app.set(Constants.RESERVED.CURRENT_SERVER, args, true);","  } else {","    app.set(Constants.RESERVED.CURRENT_SERVER, app.getMaster(), true);","  }","};","","/**"," * Setup enviroment."," */","var setupEnv = function(app, args) {","  app.set(Constants.RESERVED.ENV, args.env || process.env.NODE_ENV || Constants.RESERVED.ENV_DEV, true);","};","","/**"," * Configure custom logger."," */","var configLogger = function(app) {","  if (process.env.POMELO_LOGGER !== 'off') {","    var env = app.get(Constants.RESERVED.ENV);","    var originPath = path.join(app.getBase(), Constants.FILEPATH.LOG);","    var presentPath = path.join(app.getBase(), Constants.FILEPATH.CONFIG_DIR, env, path.basename(Constants.FILEPATH.LOG));","    if(fs.existsSync(originPath)) {","      log.configure(app, originPath);","    } else if(fs.existsSync(presentPath)) {","      log.configure(app, presentPath);","    } else {","      logger.error('logger file path configuration is error.');","    }","  }","};","","/**"," * Parse command line arguments."," *"," * @param args command line arguments"," *"," * @return Object argsMap map of arguments"," */","var parseArgs = function(args) {","  var argsMap = {};","  var mainPos = 1;","","  while (args[mainPos].indexOf('--') > 0) {","    mainPos++;","  }","  argsMap.main = args[mainPos];","","  for (var i = (mainPos + 1); i < args.length; i++) {","    var arg = args[i];","    var sep = arg.indexOf('=');","    var key = arg.slice(0, sep);","    var value = arg.slice(sep + 1);","    if (!isNaN(Number(value)) && (value.indexOf('.') < 0)) {","      value = Number(value);","    }","    argsMap[key] = value;","  }","","  return argsMap;","};","","/**"," * Load lifecycle file."," *"," */","var loadLifecycle = function(app) {","  var filePath = path.join(app.getBase(), Constants.FILEPATH.SERVER_DIR, app.serverType, Constants.FILEPATH.LIFECYCLE);","  if(!fs.existsSync(filePath)) {","    return;","  }","  var lifecycle = require(filePath);","  for(var key in lifecycle) {","    if(typeof lifecycle[key] === 'function') {","      app.lifecycleCbs[key] = lifecycle[key];","    } else {","      logger.warn('lifecycle.js in %s is error format.', filePath);","    }","  }","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"13":1,"14":2,"15":2,"16":2,"17":2,"18":2,"19":0,"20":0,"26":1,"27":0,"28":0,"29":0,"31":0,"34":0,"35":0,"37":0,"45":1,"46":0,"48":0,"49":0,"51":0,"52":0,"53":0,"55":0,"56":0,"57":0,"58":0,"60":0,"61":0,"63":0,"66":0,"67":0,"68":0,"70":0,"81":1,"82":0,"83":0,"84":0,"86":0,"87":0,"88":0,"90":0,"93":0,"106":1,"107":0,"108":0,"109":0,"110":0,"111":0,"113":0,"116":0,"117":0,"118":0,"120":0,"123":0,"130":1,"131":2,"132":2,"133":2,"134":2,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"143":0,"144":0,"145":0,"149":2,"155":1,"156":2,"157":2,"163":1,"164":2,"165":2,"166":0,"167":0,"168":0,"169":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"180":0,"181":0,"182":0,"183":0,"184":0,"186":0,"193":1,"194":2,"200":1,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"210":0,"222":1,"223":2,"224":2,"226":2,"227":0,"229":2,"231":2,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"239":0,"242":2,"249":1,"250":0,"251":0,"252":0,"254":0,"255":0,"256":0,"257":0,"259":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/log.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/log.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":27},"end":{"line":6,"column":51}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":38}},"2":{"start":{"line":6,"column":0},"end":{"line":10,"column":2}},"3":{"start":{"line":7,"column":2},"end":{"line":7,"column":35}},"4":{"start":{"line":8,"column":2},"end":{"line":8,"column":27}},"5":{"start":{"line":9,"column":2},"end":{"line":9,"column":63}}},"branchMap":{},"code":["var logger = require('pomelo-logger');","","/**"," * Configure pomelo logger"," */","module.exports.configure = function(app, filename) {","  var serverId = app.getServerId();","  var base = app.getBase();","  logger.configure(filename, {serverId: serverId, base: base});","};",""],"l":{"1":1,"6":1,"7":0,"8":0,"9":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/master/starter.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/master/starter.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":1,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":1,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1,"92":0,"93":0,"94":1,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"(anonymous_1)","line":18,"loc":{"start":{"line":18,"column":22},"end":{"line":18,"column":36}}},"2":{"name":"(anonymous_2)","line":50,"loc":{"start":{"line":50,"column":14},"end":{"line":50,"column":40}}},"3":{"name":"(anonymous_3)","line":97,"loc":{"start":{"line":97,"column":18},"end":{"line":97,"column":43}}},"4":{"name":"(anonymous_4)","line":119,"loc":{"start":{"line":119,"column":15},"end":{"line":119,"column":39}}},"5":{"name":"(anonymous_5)","line":154,"loc":{"start":{"line":154,"column":17},"end":{"line":154,"column":41}}},"6":{"name":"(anonymous_6)","line":175,"loc":{"start":{"line":175,"column":19},"end":{"line":175,"column":59}}},"7":{"name":"(anonymous_7)","line":188,"loc":{"start":{"line":188,"column":19},"end":{"line":188,"column":56}}},"8":{"name":"(anonymous_8)","line":195,"loc":{"start":{"line":195,"column":28},"end":{"line":195,"column":45}}},"9":{"name":"(anonymous_9)","line":203,"loc":{"start":{"line":203,"column":28},"end":{"line":203,"column":45}}},"10":{"name":"(anonymous_10)","line":212,"loc":{"start":{"line":212,"column":19},"end":{"line":212,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":34}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":70}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":37}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":45}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":37}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":21}},"9":{"start":{"line":9,"column":0},"end":{"line":9,"column":14}},"10":{"start":{"line":10,"column":0},"end":{"line":10,"column":34}},"11":{"start":{"line":18,"column":1},"end":{"line":41,"column":2}},"12":{"start":{"line":19,"column":2},"end":{"line":19,"column":22}},"13":{"start":{"line":20,"column":2},"end":{"line":20,"column":42}},"14":{"start":{"line":21,"column":2},"end":{"line":40,"column":3}},"15":{"start":{"line":23,"column":4},"end":{"line":23,"column":10}},"16":{"start":{"line":25,"column":4},"end":{"line":25,"column":41}},"17":{"start":{"line":26,"column":4},"end":{"line":28,"column":5}},"18":{"start":{"line":27,"column":6},"end":{"line":27,"column":39}},"19":{"start":{"line":29,"column":4},"end":{"line":29,"column":10}},"20":{"start":{"line":31,"column":4},"end":{"line":31,"column":48}},"21":{"start":{"line":32,"column":4},"end":{"line":39,"column":5}},"22":{"start":{"line":33,"column":6},"end":{"line":33,"column":28}},"23":{"start":{"line":35,"column":6},"end":{"line":35,"column":63}},"24":{"start":{"line":36,"column":6},"end":{"line":38,"column":7}},"25":{"start":{"line":37,"column":8},"end":{"line":37,"column":34}},"26":{"start":{"line":50,"column":0},"end":{"line":87,"column":2}},"27":{"start":{"line":51,"column":2},"end":{"line":51,"column":40}},"28":{"start":{"line":52,"column":2},"end":{"line":52,"column":15}},"29":{"start":{"line":53,"column":2},"end":{"line":86,"column":3}},"30":{"start":{"line":54,"column":4},"end":{"line":54,"column":21}},"31":{"start":{"line":55,"column":4},"end":{"line":61,"column":5}},"32":{"start":{"line":56,"column":6},"end":{"line":60,"column":7}},"33":{"start":{"line":57,"column":8},"end":{"line":57,"column":41}},"34":{"start":{"line":59,"column":8},"end":{"line":59,"column":46}},"35":{"start":{"line":62,"column":4},"end":{"line":62,"column":43}},"36":{"start":{"line":63,"column":4},"end":{"line":63,"column":22}},"37":{"start":{"line":64,"column":4},"end":{"line":64,"column":46}},"38":{"start":{"line":65,"column":4},"end":{"line":70,"column":5}},"39":{"start":{"line":66,"column":6},"end":{"line":68,"column":7}},"40":{"start":{"line":67,"column":8},"end":{"line":67,"column":38}},"41":{"start":{"line":69,"column":6},"end":{"line":69,"column":59}},"42":{"start":{"line":71,"column":4},"end":{"line":71,"column":58}},"43":{"start":{"line":73,"column":4},"end":{"line":73,"column":74}},"44":{"start":{"line":74,"column":4},"end":{"line":74,"column":26}},"45":{"start":{"line":75,"column":4},"end":{"line":77,"column":5}},"46":{"start":{"line":76,"column":6},"end":{"line":76,"column":17}},"47":{"start":{"line":78,"column":4},"end":{"line":78,"column":79}},"48":{"start":{"line":79,"column":4},"end":{"line":84,"column":5}},"49":{"start":{"line":80,"column":6},"end":{"line":82,"column":7}},"50":{"start":{"line":81,"column":8},"end":{"line":81,"column":38}},"51":{"start":{"line":83,"column":6},"end":{"line":83,"column":54}},"52":{"start":{"line":85,"column":4},"end":{"line":85,"column":41}},"53":{"start":{"line":97,"column":0},"end":{"line":111,"column":2}},"54":{"start":{"line":98,"column":2},"end":{"line":110,"column":3}},"55":{"start":{"line":99,"column":4},"end":{"line":109,"column":5}},"56":{"start":{"line":100,"column":6},"end":{"line":100,"column":23}},"57":{"start":{"line":101,"column":6},"end":{"line":101,"column":26}},"58":{"start":{"line":102,"column":6},"end":{"line":102,"column":30}},"59":{"start":{"line":103,"column":6},"end":{"line":103,"column":24}},"60":{"start":{"line":104,"column":6},"end":{"line":104,"column":65}},"61":{"start":{"line":107,"column":6},"end":{"line":107,"column":69}},"62":{"start":{"line":108,"column":6},"end":{"line":108,"column":38}},"63":{"start":{"line":119,"column":0},"end":{"line":144,"column":2}},"64":{"start":{"line":120,"column":2},"end":{"line":120,"column":10}},"65":{"start":{"line":121,"column":2},"end":{"line":143,"column":3}},"66":{"start":{"line":122,"column":4},"end":{"line":122,"column":28}},"67":{"start":{"line":123,"column":4},"end":{"line":142,"column":5}},"68":{"start":{"line":124,"column":6},"end":{"line":124,"column":23}},"69":{"start":{"line":125,"column":6},"end":{"line":132,"column":7}},"70":{"start":{"line":126,"column":8},"end":{"line":126,"column":41}},"71":{"start":{"line":127,"column":8},"end":{"line":127,"column":29}},"72":{"start":{"line":128,"column":8},"end":{"line":128,"column":27}},"73":{"start":{"line":130,"column":8},"end":{"line":130,"column":37}},"74":{"start":{"line":131,"column":8},"end":{"line":131,"column":25}},"75":{"start":{"line":133,"column":6},"end":{"line":133,"column":28}},"76":{"start":{"line":134,"column":6},"end":{"line":134,"column":41}},"77":{"start":{"line":136,"column":6},"end":{"line":140,"column":7}},"78":{"start":{"line":137,"column":8},"end":{"line":137,"column":58}},"79":{"start":{"line":139,"column":8},"end":{"line":139,"column":49}},"80":{"start":{"line":141,"column":6},"end":{"line":141,"column":39}},"81":{"start":{"line":154,"column":0},"end":{"line":166,"column":2}},"82":{"start":{"line":155,"column":2},"end":{"line":155,"column":16}},"83":{"start":{"line":156,"column":2},"end":{"line":156,"column":18}},"84":{"start":{"line":157,"column":2},"end":{"line":157,"column":72}},"85":{"start":{"line":158,"column":2},"end":{"line":160,"column":3}},"86":{"start":{"line":159,"column":4},"end":{"line":159,"column":35}},"87":{"start":{"line":161,"column":2},"end":{"line":161,"column":17}},"88":{"start":{"line":163,"column":2},"end":{"line":163,"column":58}},"89":{"start":{"line":164,"column":2},"end":{"line":164,"column":54}},"90":{"start":{"line":165,"column":2},"end":{"line":165,"column":9}},"91":{"start":{"line":175,"column":0},"end":{"line":178,"column":2}},"92":{"start":{"line":176,"column":2},"end":{"line":176,"column":63}},"93":{"start":{"line":177,"column":2},"end":{"line":177,"column":45}},"94":{"start":{"line":188,"column":0},"end":{"line":220,"column":2}},"95":{"start":{"line":189,"column":2},"end":{"line":189,"column":19}},"96":{"start":{"line":191,"column":2},"end":{"line":210,"column":3}},"97":{"start":{"line":192,"column":4},"end":{"line":192,"column":39}},"98":{"start":{"line":193,"column":4},"end":{"line":193,"column":76}},"99":{"start":{"line":195,"column":4},"end":{"line":201,"column":7}},"100":{"start":{"line":196,"column":6},"end":{"line":196,"column":33}},"101":{"start":{"line":197,"column":6},"end":{"line":197,"column":32}},"102":{"start":{"line":198,"column":6},"end":{"line":200,"column":7}},"103":{"start":{"line":199,"column":8},"end":{"line":199,"column":16}},"104":{"start":{"line":203,"column":4},"end":{"line":206,"column":7}},"105":{"start":{"line":204,"column":6},"end":{"line":204,"column":42}},"106":{"start":{"line":205,"column":6},"end":{"line":205,"column":32}},"107":{"start":{"line":208,"column":4},"end":{"line":208,"column":75}},"108":{"start":{"line":209,"column":4},"end":{"line":209,"column":18}},"109":{"start":{"line":212,"column":2},"end":{"line":219,"column":5}},"110":{"start":{"line":213,"column":4},"end":{"line":215,"column":5}},"111":{"start":{"line":214,"column":6},"end":{"line":214,"column":105}},"112":{"start":{"line":216,"column":4},"end":{"line":218,"column":5}},"113":{"start":{"line":217,"column":6},"end":{"line":217,"column":35}}},"branchMap":{"1":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":18},"end":{"line":20,"column":29}},{"start":{"line":20,"column":33},"end":{"line":20,"column":41}}]},"2":{"line":21,"type":"switch","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":10}},{"start":{"line":24,"column":4},"end":{"line":29,"column":10}},{"start":{"line":30,"column":4},"end":{"line":39,"column":5}}]},"3":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":4},"end":{"line":32,"column":4}},{"start":{"line":32,"column":4},"end":{"line":32,"column":4}}]},"4":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":53,"column":2}},{"start":{"line":53,"column":2},"end":{"line":53,"column":2}}]},"5":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":55,"column":4}},{"start":{"line":55,"column":4},"end":{"line":55,"column":4}}]},"6":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":6},"end":{"line":56,"column":6}},{"start":{"line":56,"column":6},"end":{"line":56,"column":6}}]},"7":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":6},"end":{"line":66,"column":6}},{"start":{"line":66,"column":6},"end":{"line":66,"column":6}}]},"8":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":4},"end":{"line":75,"column":4}},{"start":{"line":75,"column":4},"end":{"line":75,"column":4}}]},"9":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":6},"end":{"line":80,"column":6}},{"start":{"line":80,"column":6},"end":{"line":80,"column":6}}]},"10":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":2},"end":{"line":98,"column":2}},{"start":{"line":98,"column":2},"end":{"line":98,"column":2}}]},"11":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":5},"end":{"line":98,"column":47}},{"start":{"line":98,"column":51},"end":{"line":98,"column":74}}]},"12":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":4},"end":{"line":99,"column":4}},{"start":{"line":99,"column":4},"end":{"line":99,"column":4}}]},"13":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":4}},{"start":{"line":123,"column":4},"end":{"line":123,"column":4}}]},"14":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":6},"end":{"line":125,"column":6}},{"start":{"line":125,"column":6},"end":{"line":125,"column":6}}]},"15":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":6},"end":{"line":136,"column":6}},{"start":{"line":136,"column":6},"end":{"line":136,"column":6}}]},"16":{"line":158,"type":"if","locations":[{"start":{"line":158,"column":2},"end":{"line":158,"column":2}},{"start":{"line":158,"column":2},"end":{"line":158,"column":2}}]},"17":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":5},"end":{"line":158,"column":17}},{"start":{"line":158,"column":21},"end":{"line":158,"column":46}}]},"18":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":2},"end":{"line":191,"column":2}},{"start":{"line":191,"column":2},"end":{"line":191,"column":2}}]},"19":{"line":193,"type":"cond-expr","locations":[{"start":{"line":193,"column":53},"end":{"line":193,"column":70}},{"start":{"line":193,"column":73},"end":{"line":193,"column":75}}]},"20":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":6},"end":{"line":198,"column":6}},{"start":{"line":198,"column":6},"end":{"line":198,"column":6}}]},"21":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":4},"end":{"line":213,"column":4}},{"start":{"line":213,"column":4},"end":{"line":213,"column":4}}]},"22":{"line":216,"type":"if","locations":[{"start":{"line":216,"column":4},"end":{"line":216,"column":4}},{"start":{"line":216,"column":4},"end":{"line":216,"column":4}}]},"23":{"line":217,"type":"cond-expr","locations":[{"start":{"line":217,"column":22},"end":{"line":217,"column":26}},{"start":{"line":217,"column":29},"end":{"line":217,"column":33}}]}},"code":["var cp = require('child_process');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var starter = module.exports;","var util = require('util');","var utils = require('../util/utils');","var Constants = require('../util/constants');","var env = Constants.RESERVED.ENV_DEV;","var os=require('os');","var cpus = {};","var pomelo = require('../pomelo');","","/**"," * Run all servers"," *"," * @param {Object} app current application  context"," * @return {Void}"," */"," starter.runServers = function(app) {","  var server, servers;","  var condition = app.startId || app.type;","  switch(condition) {","    case Constants.RESERVED.MASTER:","    break;","    case Constants.RESERVED.ALL:","    servers = app.getServersFromConfig();","    for (var serverId in servers) {","      this.run(app, servers[serverId]);","    }","    break;","    default:","    server = app.getServerFromConfig(condition);","    if(!!server) {","      this.run(app, server);","    } else {","      servers = app.get(Constants.RESERVED.SERVERS)[condition];","      for(var i=0; i<servers.length; i++) {","        this.run(app, servers[i]);","      }","    }","  }","};","","/**"," * Run server"," *"," * @param {Object} app current application context"," * @param {Object} server"," * @return {Void}"," */","starter.run = function(app, server, cb) {","  env = app.get(Constants.RESERVED.ENV);","  var cmd, key;","  if (utils.isLocal(server.host)) {","    var options = [];","    if (!!server.args) {","      if(typeof server.args === 'string') {","        options.push(server.args.trim());","      } else {","        options = options.concat(server.args);","      }","    }","    cmd = app.get(Constants.RESERVED.MAIN);","    options.push(cmd);","    options.push(util.format('env=%s',  env));","    for(key in server) {","      if(key === Constants.RESERVED.CPU) {","        cpus[server.id] = server[key];","      }","      options.push(util.format('%s=%s', key, server[key]));","    }","    starter.localrun(process.execPath, null, options, cb);","  } else {","    cmd = util.format('cd \"%s\" && \"%s\"', app.getBase(), process.execPath);","    var arg = server.args;","    if (arg !== undefined) {","      cmd += arg;","    }","    cmd += util.format(' \"%s\" env=%s ', app.get(Constants.RESERVED.MAIN), env);","    for(key in server) {","      if(key === Constants.RESERVED.CPU) {","        cpus[server.id] = server[key];","      }","      cmd += util.format(' %s=%s ', key, server[key]);","    }","    starter.sshrun(cmd, server.host, cb);","  }","};","","/**"," * Bind process with cpu"," *"," * @param {String} sid server id"," * @param {String} pid process id"," * @param {String} host server host"," * @return {Void}"," */","starter.bindCpu = function(sid, pid, host) {","  if(os.platform() === Constants.PLATFORM.LINUX && cpus[sid] !== undefined) {","    if (utils.isLocal(host)) {","      var options = [];","      options.push('-pc');","      options.push(cpus[sid]);","      options.push(pid);","      starter.localrun(Constants.COMMAND.TASKSET, null, options);","    }","    else {","      var cmd = util.format('taskset -pc \"%s\" \"%s\"', cpus[sid], pid);","      starter.sshrun(cmd, host, null);","    }","  }","};","","/**"," * Kill application in all servers"," *"," * @param {String} pids  array of server's pid"," * @param {String} serverIds array of serverId"," */","starter.kill = function(pids, servers) {","  var cmd;","  for(var i = 0; i < servers.length; i++) {","    var server = servers[i];","    if(utils.isLocal(server.host)) {","      var options = [];","      if(os.platform() === Constants.PLATFORM.WIN) {","        cmd = Constants.COMMAND.TASKKILL;","        options.push('/pid');","        options.push('/f');","      } else {","        cmd = Constants.COMMAND.KILL;","        options.push(-9);","      }","      options.push(pids[i]);","      starter.localrun(cmd,null,options);","    } else {","      if(os.platform() === Constants.PLATFORM.WIN) {","        cmd = util.format('taskkill /pid %s /f', pids[i]);","      } else {","        cmd = util.format('kill -9 %s', pids[i]);","      }","      starter.sshrun(cmd, server.host);","    }","  }","};","","/**"," * Use ssh to run command."," *"," * @param {String} cmd command that would be executed in the remote server"," * @param {String} host remote server host"," * @param {Function} cb callback function"," *"," */","starter.sshrun = function(cmd, host, cb) {","  var args = [];","  args.push(host);","  var ssh_params = pomelo.app.get(Constants.RESERVED.SSH_CONFIG_PARAMS);","  if(!!ssh_params && Array.isArray(ssh_params)) {","    args = args.concat(ssh_params);","  }","  args.push(cmd);","","  logger.info('Executing ' + cmd + ' on ' + host + ':22');","  spawnProcess(Constants.COMMAND.SSH, host, args, cb);","  return;","};","","/**"," * Run local command."," *"," * @param {String} cmd"," * @param {Callback} callback"," *"," */","starter.localrun = function (cmd, host, options, callback) {","  logger.info('Executing ' + cmd + ' ' + options + ' locally');","  spawnProcess(cmd, host, options, callback);","};","","/**"," * Fork child process to run command."," *"," * @param {String} command"," * @param {Object} options"," * @param {Callback} callback"," *"," */","var spawnProcess = function(command, host, options, cb) {","  var child = null;","","  if(env === Constants.RESERVED.ENV_DEV) {","    child = cp.spawn(command, options);","    var prefix = command === Constants.COMMAND.SSH ? '[' + host + '] ' : '';","","    child.stderr.on('data', function (chunk) {","      var msg = chunk.toString();","      process.stderr.write(msg);","      if(!!cb) {","        cb(msg);","      }","    });","","    child.stdout.on('data', function (chunk) {","      var msg = prefix + chunk.toString();","      process.stdout.write(msg);","    });","  } else {","    child = cp.spawn(command, options, {detached: true, stdio: 'inherit'});","    child.unref();","  }","","  child.on('exit', function (code) {","    if(code !== 0) {","      logger.warn('child process exit with error, error code: %s, executed command: %s', code,  command);","    }","    if (typeof cb === 'function') {","      cb(code === 0 ? null : code);","    }","  });","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"18":1,"19":0,"20":0,"21":0,"23":0,"25":0,"26":0,"27":0,"29":0,"31":0,"32":0,"33":0,"35":0,"36":0,"37":0,"50":1,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"59":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"69":0,"71":0,"73":0,"74":0,"75":0,"76":0,"78":0,"79":0,"80":0,"81":0,"83":0,"85":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"107":0,"108":0,"119":1,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"130":0,"131":0,"133":0,"134":0,"136":0,"137":0,"139":0,"141":0,"154":1,"155":0,"156":0,"157":0,"158":0,"159":0,"161":0,"163":0,"164":0,"165":0,"175":1,"176":0,"177":0,"188":1,"189":0,"191":0,"192":0,"193":0,"195":0,"196":0,"197":0,"198":0,"199":0,"203":0,"204":0,"205":0,"208":0,"209":0,"212":0,"213":0,"214":0,"216":0,"217":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/manager/appManager.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/manager/appManager.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":22},"end":{"line":9,"column":66}}},"2":{"name":"(anonymous_2)","line":34,"loc":{"start":{"line":34,"column":32},"end":{"line":34,"column":53}}},"3":{"name":"(anonymous_3)","line":38,"loc":{"start":{"line":38,"column":5},"end":{"line":38,"column":19}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":23},"end":{"line":40,"column":34}}},"5":{"name":"(anonymous_5)","line":54,"loc":{"start":{"line":54,"column":23},"end":{"line":54,"column":34}}},"6":{"name":"(anonymous_6)","line":69,"loc":{"start":{"line":69,"column":10},"end":{"line":69,"column":21}}},"7":{"name":"(anonymous_7)","line":72,"loc":{"start":{"line":72,"column":10},"end":{"line":72,"column":29}}},"8":{"name":"(anonymous_8)","line":75,"loc":{"start":{"line":75,"column":42},"end":{"line":75,"column":63}}},"9":{"name":"(anonymous_9)","line":79,"loc":{"start":{"line":79,"column":15},"end":{"line":79,"column":29}}},"10":{"name":"(anonymous_10)","line":81,"loc":{"start":{"line":81,"column":33},"end":{"line":81,"column":44}}},"11":{"name":"(anonymous_11)","line":98,"loc":{"start":{"line":98,"column":31},"end":{"line":98,"column":42}}},"12":{"name":"(anonymous_12)","line":103,"loc":{"start":{"line":103,"column":10},"end":{"line":103,"column":24}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":29}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":70}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":90}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":101}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":29}},"7":{"start":{"line":9,"column":0},"end":{"line":113,"column":2}},"8":{"start":{"line":10,"column":1},"end":{"line":12,"column":3}},"9":{"start":{"line":11,"column":4},"end":{"line":11,"column":14}},"10":{"start":{"line":13,"column":2},"end":{"line":16,"column":3}},"11":{"start":{"line":14,"column":4},"end":{"line":14,"column":70}},"12":{"start":{"line":15,"column":4},"end":{"line":15,"column":11}},"13":{"start":{"line":17,"column":2},"end":{"line":20,"column":3}},"14":{"start":{"line":18,"column":4},"end":{"line":18,"column":122}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":11}},"16":{"start":{"line":22,"column":2},"end":{"line":22,"column":53}},"17":{"start":{"line":23,"column":2},"end":{"line":30,"column":3}},"18":{"start":{"line":24,"column":4},"end":{"line":27,"column":5}},"19":{"start":{"line":25,"column":6},"end":{"line":25,"column":138}},"20":{"start":{"line":26,"column":6},"end":{"line":26,"column":13}},"21":{"start":{"line":28,"column":4},"end":{"line":28,"column":21}},"22":{"start":{"line":29,"column":4},"end":{"line":29,"column":35}},"23":{"start":{"line":32,"column":2},"end":{"line":32,"column":12}},"24":{"start":{"line":34,"column":2},"end":{"line":112,"column":5}},"25":{"start":{"line":35,"column":4},"end":{"line":35,"column":15}},"26":{"start":{"line":36,"column":4},"end":{"line":36,"column":80}},"27":{"start":{"line":37,"column":4},"end":{"line":37,"column":8}},"28":{"start":{"line":39,"column":4},"end":{"line":111,"column":5}},"29":{"start":{"line":40,"column":6},"end":{"line":50,"column":9}},"30":{"start":{"line":41,"column":8},"end":{"line":41,"column":111}},"31":{"start":{"line":42,"column":8},"end":{"line":48,"column":10}},"32":{"start":{"line":49,"column":8},"end":{"line":49,"column":58}},"33":{"start":{"line":51,"column":6},"end":{"line":51,"column":13}},"34":{"start":{"line":54,"column":6},"end":{"line":110,"column":9}},"35":{"start":{"line":55,"column":8},"end":{"line":62,"column":9}},"36":{"start":{"line":56,"column":10},"end":{"line":59,"column":11}},"37":{"start":{"line":57,"column":12},"end":{"line":57,"column":136}},"38":{"start":{"line":58,"column":12},"end":{"line":58,"column":19}},"39":{"start":{"line":60,"column":10},"end":{"line":60,"column":27}},"40":{"start":{"line":61,"column":10},"end":{"line":61,"column":39}},"41":{"start":{"line":64,"column":8},"end":{"line":64,"column":24}},"42":{"start":{"line":65,"column":8},"end":{"line":65,"column":26}},"43":{"start":{"line":68,"column":8},"end":{"line":109,"column":10}},"44":{"start":{"line":70,"column":12},"end":{"line":70,"column":37}},"45":{"start":{"line":73,"column":12},"end":{"line":73,"column":22}},"46":{"start":{"line":74,"column":12},"end":{"line":74,"column":20}},"47":{"start":{"line":75,"column":12},"end":{"line":101,"column":15}},"48":{"start":{"line":76,"column":14},"end":{"line":76,"column":25}},"49":{"start":{"line":77,"column":14},"end":{"line":77,"column":88}},"50":{"start":{"line":78,"column":14},"end":{"line":78,"column":18}},"51":{"start":{"line":80,"column":14},"end":{"line":95,"column":15}},"52":{"start":{"line":81,"column":16},"end":{"line":93,"column":19}},"53":{"start":{"line":82,"column":18},"end":{"line":82,"column":137}},"54":{"start":{"line":83,"column":18},"end":{"line":90,"column":20}},"55":{"start":{"line":91,"column":18},"end":{"line":91,"column":68}},"56":{"start":{"line":92,"column":18},"end":{"line":92,"column":49}},"57":{"start":{"line":94,"column":16},"end":{"line":94,"column":23}},"58":{"start":{"line":96,"column":14},"end":{"line":96,"column":27}},"59":{"start":{"line":97,"column":14},"end":{"line":97,"column":45}},"60":{"start":{"line":98,"column":14},"end":{"line":100,"column":17}},"61":{"start":{"line":99,"column":16},"end":{"line":99,"column":108}},"62":{"start":{"line":104,"column":12},"end":{"line":106,"column":13}},"63":{"start":{"line":105,"column":14},"end":{"line":105,"column":82}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},{"start":{"line":10,"column":1},"end":{"line":10,"column":1}}]},"2":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":2},"end":{"line":13,"column":2}},{"start":{"line":13,"column":2},"end":{"line":13,"column":2}}]},"3":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":2},"end":{"line":17,"column":2}},{"start":{"line":17,"column":2},"end":{"line":17,"column":2}}]},"4":{"line":17,"type":"binary-expr","locations":[{"start":{"line":17,"column":5},"end":{"line":17,"column":35}},{"start":{"line":17,"column":39},"end":{"line":17,"column":67}}]},"5":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":24,"column":4}},{"start":{"line":24,"column":4},"end":{"line":24,"column":4}}]},"6":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":7},"end":{"line":24,"column":30}},{"start":{"line":24,"column":34},"end":{"line":24,"column":71}}]},"7":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"8":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":10},"end":{"line":56,"column":10}},{"start":{"line":56,"column":10},"end":{"line":56,"column":10}}]},"9":{"line":56,"type":"binary-expr","locations":[{"start":{"line":56,"column":13},"end":{"line":56,"column":36}},{"start":{"line":56,"column":40},"end":{"line":56,"column":75}}]},"10":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":19},"end":{"line":70,"column":28}},{"start":{"line":70,"column":32},"end":{"line":70,"column":36}}]},"11":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":14},"end":{"line":80,"column":14}},{"start":{"line":80,"column":14},"end":{"line":80,"column":14}}]},"12":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":12},"end":{"line":104,"column":12}},{"start":{"line":104,"column":12},"end":{"line":104,"column":12}}]}},"code":["var async = require('async');","var utils = require('../../util/utils');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var transactionLogger = require('pomelo-logger').getLogger('transaction-log', __filename);","var transactionErrorLogger = require('pomelo-logger').getLogger('transaction-error-log', __filename);","","var manager = module.exports;","","manager.transaction = function(name, conditions, handlers, retry) {","\tif(!retry) {","    retry = 1;","  }","  if(typeof name !== 'string') {","    logger.error('transaction name is error format, name: %s.', name);","    return;","  }","  if(typeof conditions !== 'object' || typeof handlers !== 'object') {","    logger.error('transaction conditions parameter is error format, conditions: %j, handlers: %j.', conditions, handlers);","    return;","  }","","  var cmethods=[] ,dmethods=[], cnames=[], dnames=[];","  for(var key in conditions) {","    if(typeof key !== 'string' || typeof conditions[key] !== 'function') {","      logger.error('transaction conditions parameter is error format, condition name: %s, condition function: %j.', key, conditions[key]);","      return;","    }","    cnames.push(key);","    cmethods.push(conditions[key]);","  }","","  var i = 0;","  // execute conditions","  async.forEachSeries(cmethods, function(method, cb) {","    method(cb);","    transactionLogger.info('[%s]:[%s] condition is executed.', name, cnames[i]);","    i++;","  }, function(err) {","    if(err) {","      process.nextTick(function() {","        transactionLogger.error('[%s]:[%s] condition is executed with err: %j.', name, cnames[--i], err.stack);","        var log = {","          name: name,","          method: cnames[i],","          time: Date.now(),","          type: 'condition',","          description: err.stack","        };","        transactionErrorLogger.error(JSON.stringify(log));","      });","      return;","    } else {","      // execute handlers","      process.nextTick(function() {","        for(var key in handlers) {","          if(typeof key !== 'string' || typeof handlers[key] !== 'function') {","            logger.error('transcation handlers parameter is error format, handler name: %s, handler function: %j.', key, handlers[key]);","            return;","          }","          dnames.push(key);","          dmethods.push(handlers[key]);","        }","","        var flag = true;","        var times = retry;","        ","        // do retry if failed util retry times","        async.whilst(","          function() {","            return retry > 0 && flag;","          },","          function(callback) {","            var j = 0;","            retry--;","            async.forEachSeries(dmethods, function(method, cb) {","              method(cb);","              transactionLogger.info('[%s]:[%s] handler is executed.', name, dnames[j]);","              j++;","            }, function(err) {","              if(err) {","                process.nextTick(function() {","                  transactionLogger.error('[%s]:[%s]:[%s] handler is executed with err: %j.', name, dnames[--j], times-retry, err.stack);","                  var log = {","                    name: name,","                    method: dnames[j],","                    retry: times-retry,","                    time: Date.now(),","                    type: 'handler',","                    description: err.stack","                  };","                  transactionErrorLogger.error(JSON.stringify(log));","                  utils.invokeCallback(callback);","                });","                return;","              }","              flag = false;","              utils.invokeCallback(callback);","              process.nextTick(function() {","                transactionLogger.info('[%s] all conditions and handlers are executed successfully.', name);","              });","            });","          },","          function(err) {","            if(err) {","              logger.error('transaction process is executed with error: %j', err);","            }","            // callback will not pass error","          }","        );","      });","    }","  });","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"9":1,"10":0,"11":0,"13":0,"14":0,"15":0,"17":0,"18":0,"19":0,"22":0,"23":0,"24":0,"25":0,"26":0,"28":0,"29":0,"32":0,"34":0,"35":0,"36":0,"37":0,"39":0,"40":0,"41":0,"42":0,"49":0,"51":0,"54":0,"55":0,"56":0,"57":0,"58":0,"60":0,"61":0,"64":0,"65":0,"68":0,"70":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"80":0,"81":0,"82":0,"83":0,"91":0,"92":0,"94":0,"96":0,"97":0,"98":0,"99":0,"104":0,"105":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/backendSession.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/backendSession.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":17},"end":{"line":3,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":79}},"2":{"start":{"line":3,"column":0},"end":{"line":13,"column":2}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":47}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":38}},"5":{"start":{"line":7,"column":2},"end":{"line":7,"column":50}},"6":{"start":{"line":10,"column":2},"end":{"line":10,"column":48}},"7":{"start":{"line":12,"column":2},"end":{"line":12,"column":17}}},"branchMap":{},"code":["var BackendSessionService = require('../common/service/backendSessionService');","","module.exports = function(app) {","  var service = new BackendSessionService(app);","  service.name = '__backendSession__';","  // export backend session service to the application context.","  app.set('backendSessionService', service, true);","","  // for compatibility as `LocalSession` is renamed to `BackendSession` ","  app.set('localSessionService', service, true);","","  return service;","};",""],"l":{"1":1,"3":1,"4":0,"5":0,"7":0,"10":0,"12":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/backendSessionService.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/backendSessionService.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":1,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":1,"65":0,"66":1,"67":0,"68":0,"69":0,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":1,"77":0,"78":0,"79":0,"80":0,"81":0,"82":1,"83":0,"84":1,"85":0,"86":1,"87":0,"88":1,"89":0,"90":1,"91":0,"92":0,"93":0,"94":0,"95":1,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},"fnMap":{"1":{"name":"(anonymous_1)","line":22,"loc":{"start":{"line":22,"column":28},"end":{"line":22,"column":42}}},"2":{"name":"(anonymous_2)","line":28,"loc":{"start":{"line":28,"column":41},"end":{"line":28,"column":56}}},"3":{"name":"(anonymous_3)","line":44,"loc":{"start":{"line":44,"column":38},"end":{"line":44,"column":68}}},"4":{"name":"(anonymous_4)","line":62,"loc":{"start":{"line":62,"column":43},"end":{"line":62,"column":73}}},"5":{"name":"(anonymous_5)","line":80,"loc":{"start":{"line":80,"column":44},"end":{"line":80,"column":82}}},"6":{"name":"(anonymous_6)","line":103,"loc":{"start":{"line":103,"column":44},"end":{"line":103,"column":82}}},"7":{"name":"(anonymous_7)","line":128,"loc":{"start":{"line":128,"column":39},"end":{"line":128,"column":74}}},"8":{"name":"(anonymous_8)","line":148,"loc":{"start":{"line":148,"column":41},"end":{"line":148,"column":76}}},"9":{"name":"(anonymous_9)","line":168,"loc":{"start":{"line":168,"column":39},"end":{"line":168,"column":81}}},"10":{"name":"(anonymous_10)","line":187,"loc":{"start":{"line":187,"column":42},"end":{"line":187,"column":82}}},"11":{"name":"(anonymous_11)","line":195,"loc":{"start":{"line":195,"column":16},"end":{"line":195,"column":73}}},"12":{"name":"(anonymous_12)","line":216,"loc":{"start":{"line":216,"column":21},"end":{"line":216,"column":45}}},"13":{"name":"(anonymous_13)","line":232,"loc":{"start":{"line":232,"column":32},"end":{"line":232,"column":50}}},"14":{"name":"(anonymous_14)","line":234,"loc":{"start":{"line":234,"column":62},"end":{"line":234,"column":76}}},"15":{"name":"(anonymous_15)","line":251,"loc":{"start":{"line":251,"column":34},"end":{"line":251,"column":52}}},"16":{"name":"(anonymous_16)","line":253,"loc":{"start":{"line":253,"column":64},"end":{"line":253,"column":78}}},"17":{"name":"(anonymous_17)","line":267,"loc":{"start":{"line":267,"column":31},"end":{"line":267,"column":52}}},"18":{"name":"(anonymous_18)","line":277,"loc":{"start":{"line":277,"column":31},"end":{"line":277,"column":45}}},"19":{"name":"(anonymous_19)","line":287,"loc":{"start":{"line":287,"column":32},"end":{"line":287,"column":50}}},"20":{"name":"(anonymous_20)","line":296,"loc":{"start":{"line":296,"column":35},"end":{"line":296,"column":48}}},"21":{"name":"(anonymous_21)","line":305,"loc":{"start":{"line":305,"column":34},"end":{"line":305,"column":45}}},"22":{"name":"(anonymous_22)","line":307,"loc":{"start":{"line":307,"column":26},"end":{"line":307,"column":42}}},"23":{"name":"(anonymous_23)","line":313,"loc":{"start":{"line":313,"column":23},"end":{"line":313,"column":57}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":40}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":62}},"3":{"start":{"line":22,"column":0},"end":{"line":24,"column":2}},"4":{"start":{"line":23,"column":2},"end":{"line":23,"column":17}},"5":{"start":{"line":26,"column":0},"end":{"line":26,"column":39}},"6":{"start":{"line":28,"column":0},"end":{"line":33,"column":2}},"7":{"start":{"line":29,"column":2},"end":{"line":31,"column":3}},"8":{"start":{"line":30,"column":4},"end":{"line":30,"column":49}},"9":{"start":{"line":32,"column":2},"end":{"line":32,"column":40}},"10":{"start":{"line":44,"column":0},"end":{"line":51,"column":2}},"11":{"start":{"line":45,"column":2},"end":{"line":45,"column":24}},"12":{"start":{"line":46,"column":2},"end":{"line":46,"column":32}},"13":{"start":{"line":47,"column":2},"end":{"line":47,"column":40}},"14":{"start":{"line":48,"column":2},"end":{"line":48,"column":19}},"15":{"start":{"line":49,"column":2},"end":{"line":50,"column":57}},"16":{"start":{"line":62,"column":0},"end":{"line":69,"column":2}},"17":{"start":{"line":63,"column":2},"end":{"line":63,"column":24}},"18":{"start":{"line":64,"column":2},"end":{"line":64,"column":32}},"19":{"start":{"line":65,"column":2},"end":{"line":65,"column":41}},"20":{"start":{"line":66,"column":2},"end":{"line":66,"column":19}},"21":{"start":{"line":67,"column":2},"end":{"line":68,"column":57}},"22":{"start":{"line":80,"column":0},"end":{"line":91,"column":2}},"23":{"start":{"line":81,"column":2},"end":{"line":81,"column":24}},"24":{"start":{"line":82,"column":2},"end":{"line":82,"column":32}},"25":{"start":{"line":83,"column":2},"end":{"line":83,"column":27}},"26":{"start":{"line":84,"column":2},"end":{"line":84,"column":19}},"27":{"start":{"line":85,"column":2},"end":{"line":89,"column":3}},"28":{"start":{"line":86,"column":4},"end":{"line":86,"column":16}},"29":{"start":{"line":88,"column":4},"end":{"line":88,"column":22}},"30":{"start":{"line":90,"column":2},"end":{"line":90,"column":72}},"31":{"start":{"line":103,"column":0},"end":{"line":114,"column":2}},"32":{"start":{"line":104,"column":2},"end":{"line":104,"column":24}},"33":{"start":{"line":105,"column":2},"end":{"line":105,"column":32}},"34":{"start":{"line":106,"column":2},"end":{"line":106,"column":27}},"35":{"start":{"line":107,"column":2},"end":{"line":107,"column":19}},"36":{"start":{"line":108,"column":2},"end":{"line":112,"column":3}},"37":{"start":{"line":109,"column":4},"end":{"line":109,"column":16}},"38":{"start":{"line":111,"column":4},"end":{"line":111,"column":22}},"39":{"start":{"line":113,"column":2},"end":{"line":113,"column":72}},"40":{"start":{"line":128,"column":0},"end":{"line":134,"column":2}},"41":{"start":{"line":129,"column":2},"end":{"line":129,"column":24}},"42":{"start":{"line":130,"column":2},"end":{"line":130,"column":32}},"43":{"start":{"line":131,"column":2},"end":{"line":131,"column":22}},"44":{"start":{"line":132,"column":2},"end":{"line":132,"column":24}},"45":{"start":{"line":133,"column":2},"end":{"line":133,"column":72}},"46":{"start":{"line":148,"column":0},"end":{"line":154,"column":2}},"47":{"start":{"line":149,"column":2},"end":{"line":149,"column":24}},"48":{"start":{"line":150,"column":2},"end":{"line":150,"column":32}},"49":{"start":{"line":151,"column":2},"end":{"line":151,"column":24}},"50":{"start":{"line":152,"column":2},"end":{"line":152,"column":24}},"51":{"start":{"line":153,"column":2},"end":{"line":153,"column":72}},"52":{"start":{"line":168,"column":0},"end":{"line":174,"column":2}},"53":{"start":{"line":169,"column":2},"end":{"line":169,"column":24}},"54":{"start":{"line":170,"column":2},"end":{"line":170,"column":32}},"55":{"start":{"line":171,"column":2},"end":{"line":171,"column":22}},"56":{"start":{"line":172,"column":2},"end":{"line":172,"column":31}},"57":{"start":{"line":173,"column":2},"end":{"line":173,"column":72}},"58":{"start":{"line":187,"column":0},"end":{"line":193,"column":2}},"59":{"start":{"line":188,"column":2},"end":{"line":188,"column":24}},"60":{"start":{"line":189,"column":2},"end":{"line":189,"column":32}},"61":{"start":{"line":190,"column":2},"end":{"line":190,"column":25}},"62":{"start":{"line":191,"column":2},"end":{"line":191,"column":29}},"63":{"start":{"line":192,"column":2},"end":{"line":192,"column":72}},"64":{"start":{"line":195,"column":0},"end":{"line":197,"column":2}},"65":{"start":{"line":196,"column":2},"end":{"line":196,"column":95}},"66":{"start":{"line":216,"column":0},"end":{"line":221,"column":2}},"67":{"start":{"line":217,"column":2},"end":{"line":219,"column":3}},"68":{"start":{"line":218,"column":4},"end":{"line":218,"column":22}},"69":{"start":{"line":220,"column":2},"end":{"line":220,"column":36}},"70":{"start":{"line":232,"column":0},"end":{"line":240,"column":2}},"71":{"start":{"line":233,"column":2},"end":{"line":233,"column":18}},"72":{"start":{"line":234,"column":2},"end":{"line":239,"column":5}},"73":{"start":{"line":235,"column":4},"end":{"line":237,"column":5}},"74":{"start":{"line":236,"column":6},"end":{"line":236,"column":21}},"75":{"start":{"line":238,"column":4},"end":{"line":238,"column":34}},"76":{"start":{"line":251,"column":0},"end":{"line":259,"column":2}},"77":{"start":{"line":252,"column":2},"end":{"line":252,"column":18}},"78":{"start":{"line":253,"column":2},"end":{"line":258,"column":5}},"79":{"start":{"line":254,"column":4},"end":{"line":256,"column":5}},"80":{"start":{"line":255,"column":6},"end":{"line":255,"column":22}},"81":{"start":{"line":257,"column":4},"end":{"line":257,"column":34}},"82":{"start":{"line":267,"column":0},"end":{"line":269,"column":2}},"83":{"start":{"line":268,"column":2},"end":{"line":268,"column":29}},"84":{"start":{"line":277,"column":0},"end":{"line":279,"column":2}},"85":{"start":{"line":278,"column":2},"end":{"line":278,"column":28}},"86":{"start":{"line":287,"column":0},"end":{"line":289,"column":2}},"87":{"start":{"line":288,"column":2},"end":{"line":288,"column":81}},"88":{"start":{"line":296,"column":0},"end":{"line":298,"column":2}},"89":{"start":{"line":297,"column":2},"end":{"line":297,"column":79}},"90":{"start":{"line":305,"column":0},"end":{"line":311,"column":2}},"91":{"start":{"line":306,"column":2},"end":{"line":306,"column":15}},"92":{"start":{"line":307,"column":2},"end":{"line":309,"column":5}},"93":{"start":{"line":308,"column":4},"end":{"line":308,"column":29}},"94":{"start":{"line":310,"column":2},"end":{"line":310,"column":13}},"95":{"start":{"line":313,"column":0},"end":{"line":335,"column":2}},"96":{"start":{"line":314,"column":2},"end":{"line":317,"column":3}},"97":{"start":{"line":315,"column":4},"end":{"line":315,"column":34}},"98":{"start":{"line":316,"column":4},"end":{"line":316,"column":11}},"99":{"start":{"line":319,"column":2},"end":{"line":322,"column":3}},"100":{"start":{"line":320,"column":4},"end":{"line":320,"column":29}},"101":{"start":{"line":321,"column":4},"end":{"line":321,"column":11}},"102":{"start":{"line":323,"column":2},"end":{"line":323,"column":20}},"103":{"start":{"line":324,"column":2},"end":{"line":333,"column":3}},"104":{"start":{"line":326,"column":6},"end":{"line":328,"column":7}},"105":{"start":{"line":327,"column":10},"end":{"line":327,"column":50}},"106":{"start":{"line":332,"column":6},"end":{"line":332,"column":39}},"107":{"start":{"line":334,"column":2},"end":{"line":334,"column":43}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"2":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":2},"end":{"line":85,"column":2}},{"start":{"line":85,"column":2},"end":{"line":85,"column":2}}]},"3":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":108,"column":2}},{"start":{"line":108,"column":2},"end":{"line":108,"column":2}}]},"4":{"line":235,"type":"if","locations":[{"start":{"line":235,"column":4},"end":{"line":235,"column":4}},{"start":{"line":235,"column":4},"end":{"line":235,"column":4}}]},"5":{"line":254,"type":"if","locations":[{"start":{"line":254,"column":4},"end":{"line":254,"column":4}},{"start":{"line":254,"column":4},"end":{"line":254,"column":4}}]},"6":{"line":314,"type":"if","locations":[{"start":{"line":314,"column":2},"end":{"line":314,"column":2}},{"start":{"line":314,"column":2},"end":{"line":314,"column":2}}]},"7":{"line":319,"type":"if","locations":[{"start":{"line":319,"column":2},"end":{"line":319,"column":2}},{"start":{"line":319,"column":2},"end":{"line":319,"column":2}}]},"8":{"line":324,"type":"if","locations":[{"start":{"line":324,"column":2},"end":{"line":324,"column":2}},{"start":{"line":324,"column":2},"end":{"line":324,"column":2}}]}},"code":["/**"," * backend session service for backend session"," */","var utils = require('../../util/utils');","","var EXPORTED_FIELDS = ['id', 'frontendId', 'uid', 'settings'];","","/**"," * Service that maintains backend sessions and the communication with frontend"," * servers."," *"," * BackendSessionService would be created in each server process and maintains"," * backend sessions for current process and communicates with the relative"," * frontend servers."," *"," * BackendSessionService instance could be accessed by"," * `app.get('backendSessionService')` or app.backendSessionService."," *"," * @class"," * @constructor"," */","var BackendSessionService = function(app) {","  this.app = app;","};","","module.exports = BackendSessionService;","","BackendSessionService.prototype.create = function(opts) {","  if(!opts) {","    throw new Error('opts should not be empty.');","  }","  return new BackendSession(opts, this);","};","","/**"," * Get backend session by frontend server id and session id."," *"," * @param  {String}   frontendId frontend server id that session attached"," * @param  {String}   sid        session id"," * @param  {Function} cb         callback function. args: cb(err, BackendSession)"," *"," * @memberOf BackendSessionService"," */","BackendSessionService.prototype.get = function(frontendId, sid, cb) {","  var namespace = 'sys';","  var service = 'sessionRemote';","  var method = 'getBackendSessionBySid';","  var args = [sid];","  rpcInvoke(this.app, frontendId, namespace, service, method,","            args, BackendSessionCB.bind(null, this, cb));","};","","/**"," * Get backend sessions by frontend server id and user id."," *"," * @param  {String}   frontendId frontend server id that session attached"," * @param  {String}   uid        user id binded with the session"," * @param  {Function} cb         callback function. args: cb(err, BackendSessions)"," *"," * @memberOf BackendSessionService"," */","BackendSessionService.prototype.getByUid = function(frontendId, uid, cb) {","  var namespace = 'sys';","  var service = 'sessionRemote';","  var method = 'getBackendSessionsByUid';","  var args = [uid];","  rpcInvoke(this.app, frontendId, namespace, service, method,","            args, BackendSessionCB.bind(null, this, cb));","};","","/**"," * Kick a session by session id."," *"," * @param  {String}   frontendId cooperating frontend server id"," * @param  {Number}   sid        session id"," * @param  {Function} cb         callback function"," *"," * @memberOf BackendSessionService"," */","BackendSessionService.prototype.kickBySid = function(frontendId, sid, reason, cb) {","  var namespace = 'sys';","  var service = 'sessionRemote';","  var method = 'kickBySid';","  var args = [sid];","  if(typeof reason === 'function') {","    cb = reason;","  }else{","    args.push(reason);","  }","  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);","};","","/**"," * Kick sessions by user id."," *"," * @param  {String}          frontendId cooperating frontend server id"," * @param  {Number|String}   uid        user id"," * @param  {String}          reason     kick reason"," * @param  {Function}        cb         callback function"," *"," * @memberOf BackendSessionService"," */","BackendSessionService.prototype.kickByUid = function(frontendId, uid, reason, cb) {","  var namespace = 'sys';","  var service = 'sessionRemote';","  var method = 'kickByUid';","  var args = [uid];","  if(typeof reason === 'function') {","    cb = reason;","  }else{","    args.push(reason);","  }","  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);","};","","/**"," * Bind the session with the specified user id. It would finally invoke the"," * the sessionService.bind in the cooperating frontend server."," *"," * @param  {String}   frontendId cooperating frontend server id"," * @param  {Number}   sid        session id"," * @param  {String}   uid        user id"," * @param  {Function} cb         callback function"," *"," * @memberOf BackendSessionService"," * @api private"," */","BackendSessionService.prototype.bind = function(frontendId, sid, uid, cb) {","  var namespace = 'sys';","  var service = 'sessionRemote';","  var method = 'bind';","  var args = [sid, uid];","  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);","};","","/**"," * Unbind the session with the specified user id. It would finally invoke the"," * the sessionService.unbind in the cooperating frontend server."," *"," * @param  {String}   frontendId cooperating frontend server id"," * @param  {Number}   sid        session id"," * @param  {String}   uid        user id"," * @param  {Function} cb         callback function"," *"," * @memberOf BackendSessionService"," * @api private"," */","BackendSessionService.prototype.unbind = function(frontendId, sid, uid, cb) {","  var namespace = 'sys';","  var service = 'sessionRemote';","  var method = 'unbind';","  var args = [sid, uid];","  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);","};","","/**"," * Push the specified customized change to the frontend internal session."," *"," * @param  {String}   frontendId cooperating frontend server id"," * @param  {Number}   sid        session id"," * @param  {String}   key        key in session that should be push"," * @param  {Object}   value      value in session, primitive js object"," * @param  {Function} cb         callback function"," *"," * @memberOf BackendSessionService"," * @api private"," */","BackendSessionService.prototype.push = function(frontendId, sid, key, value, cb) {","  var namespace = 'sys';","  var service = 'sessionRemote';","  var method = 'push';","  var args = [sid, key, value];","  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);","};","","/**"," * Push all the customized changes to the frontend internal session."," *"," * @param  {String}   frontendId cooperating frontend server id"," * @param  {Number}   sid        session id"," * @param  {Object}   settings   key/values in session that should be push"," * @param  {Function} cb         callback function"," *"," * @memberOf BackendSessionService"," * @api private"," */","BackendSessionService.prototype.pushAll = function(frontendId, sid, settings, cb) {","  var namespace = 'sys';","  var service = 'sessionRemote';","  var method = 'pushAll';","  var args = [sid, settings];","  rpcInvoke(this.app, frontendId, namespace, service, method, args, cb);","};","","var rpcInvoke = function(app, sid, namespace, service, method, args, cb) {","  app.rpcInvoke(sid, {namespace: namespace, service: service, method: method, args: args}, cb);","};","","/**"," * BackendSession is the proxy for the frontend internal session passed to handlers and"," * it helps to keep the key/value pairs for the server locally."," * Internal session locates in frontend server and should not be accessed directly."," *"," * The mainly operation on backend session should be read and any changes happen in backend"," * session is local and would be discarded in next request. You have to push the"," * changes to the frontend manually if necessary. Any push would overwrite the last push"," * of the same key silently and the changes would be saw in next request."," * And you have to make sure the transaction outside if you would push the session"," * concurrently in different processes."," *"," * See the api below for more details."," *"," * @class"," * @constructor"," */","var BackendSession = function(opts, service) {","  for(var f in opts) {","    this[f] = opts[f];","  }","  this.__sessionService__ = service;","};","","/**"," * Bind current session with the user id. It would push the uid to frontend"," * server and bind  uid to the frontend internal session."," *"," * @param  {Number|String}   uid user id"," * @param  {Function} cb  callback function"," *"," * @memberOf BackendSession"," */","BackendSession.prototype.bind = function(uid, cb) {","  var self = this;","  this.__sessionService__.bind(this.frontendId, this.id, uid, function(err) {","    if(!err) {","      self.uid = uid;","    }","    utils.invokeCallback(cb, err);","  });","};","","/**"," * Unbind current session with the user id. It would push the uid to frontend"," * server and unbind uid from the frontend internal session."," *"," * @param  {Number|String}   uid user id"," * @param  {Function} cb  callback function"," *"," * @memberOf BackendSession"," */","BackendSession.prototype.unbind = function(uid, cb) {","  var self = this;","  this.__sessionService__.unbind(this.frontendId, this.id, uid, function(err) {","    if(!err) {","      self.uid = null;","    }","    utils.invokeCallback(cb, err);","  });","};","","/**"," * Set the key/value into backend session."," *"," * @param {String} key   key"," * @param {Object} value value"," */","BackendSession.prototype.set = function(key, value) {","  this.settings[key] = value;","};","","/**"," * Get the value from backend session by key."," *"," * @param  {String} key key"," * @return {Object}     value"," */","BackendSession.prototype.get = function(key) {","  return this.settings[key];","};","","/**"," * Push the key/value in backend session to the front internal session."," *"," * @param  {String}   key key"," * @param  {Function} cb  callback function"," */","BackendSession.prototype.push = function(key, cb) {","  this.__sessionService__.push(this.frontendId, this.id, key, this.get(key), cb);","};","","/**"," * Push all the key/values in backend session to the frontend internal session."," *"," * @param  {Function} cb callback function"," */","BackendSession.prototype.pushAll = function(cb) {","  this.__sessionService__.pushAll(this.frontendId, this.id, this.settings, cb);","};","","/**"," * Export the key/values for serialization."," *"," * @api private"," */","BackendSession.prototype.export = function() {","  var res = {};","  EXPORTED_FIELDS.forEach(function(field) {","    res[field] = this[field];","  });","  return res;","};","","var BackendSessionCB = function(service, cb, err, sinfo) {","  if(err) {","    utils.invokeCallback(cb, err);","    return;","  }","","  if(!sinfo) {","    utils.invokeCallback(cb);","    return;","  }","  var sessions = [];","  if(Array.isArray(sinfo)){","      // #getByUid","      for(var i = 0,k = sinfo.length;i<k;i++){","          sessions.push(service.create(sinfo[i]));","      }","  }","  else{","      // #get","      sessions = service.create(sinfo);","  }","  utils.invokeCallback(cb, null, sessions);","};",""],"l":{"4":1,"6":1,"22":1,"23":0,"26":1,"28":1,"29":0,"30":0,"32":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":0,"80":1,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"88":0,"90":0,"103":1,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"111":0,"113":0,"128":1,"129":0,"130":0,"131":0,"132":0,"133":0,"148":1,"149":0,"150":0,"151":0,"152":0,"153":0,"168":1,"169":0,"170":0,"171":0,"172":0,"173":0,"187":1,"188":0,"189":0,"190":0,"191":0,"192":0,"195":1,"196":0,"216":1,"217":0,"218":0,"220":0,"232":1,"233":0,"234":0,"235":0,"236":0,"238":0,"251":1,"252":0,"253":0,"254":0,"255":0,"257":0,"267":1,"268":0,"277":1,"278":0,"287":1,"288":0,"296":1,"297":0,"305":1,"306":0,"307":0,"308":0,"310":0,"313":1,"314":0,"315":0,"316":0,"319":0,"320":0,"321":0,"323":0,"324":0,"326":0,"327":0,"332":0,"334":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/channel.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/channel.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":17},"end":{"line":3,"column":37}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":65}},"2":{"start":{"line":3,"column":0},"end":{"line":8,"column":2}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":46}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":43}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":31}},"6":{"start":{"line":7,"column":2},"end":{"line":7,"column":17}}},"branchMap":{},"code":["var ChannelService = require('../common/service/channelService');","","module.exports = function(app, opts) {","  var service = new ChannelService(app, opts);","  app.set('channelService', service, true);","  service.name = '__channel__';","  return service;","};"],"l":{"1":1,"3":1,"4":0,"5":0,"6":0,"7":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/channelService.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/channelService.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":1,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":1,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":1,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":1,"120":0,"121":1,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":1,"130":0,"131":1,"132":0,"133":0,"134":1,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":1,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":1,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":1,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":1,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":1,"233":0,"234":0,"235":0,"236":0,"237":1,"238":0,"239":0,"240":0,"241":0,"242":1,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":1,"250":0,"251":0,"252":0,"253":0,"254":1,"255":0,"256":0,"257":0,"258":1,"259":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},"fnMap":{"1":{"name":"(anonymous_1)","line":21,"loc":{"start":{"line":21,"column":21},"end":{"line":21,"column":41}}},"2":{"name":"(anonymous_2)","line":34,"loc":{"start":{"line":34,"column":33},"end":{"line":34,"column":46}}},"3":{"name":"(anonymous_3)","line":46,"loc":{"start":{"line":46,"column":41},"end":{"line":46,"column":56}}},"4":{"name":"(anonymous_4)","line":65,"loc":{"start":{"line":65,"column":38},"end":{"line":65,"column":61}}},"5":{"name":"(anonymous_5)","line":80,"loc":{"start":{"line":80,"column":42},"end":{"line":80,"column":57}}},"6":{"name":"(anonymous_6)","line":97,"loc":{"start":{"line":97,"column":45},"end":{"line":97,"column":82}}},"7":{"name":"(anonymous_7)","line":136,"loc":{"start":{"line":136,"column":37},"end":{"line":136,"column":75}}},"8":{"name":"(anonymous_8)","line":152,"loc":{"start":{"line":152,"column":57},"end":{"line":152,"column":68}}},"9":{"name":"(anonymous_9)","line":160,"loc":{"start":{"line":160,"column":14},"end":{"line":160,"column":33}}},"10":{"name":"(anonymous_10)","line":161,"loc":{"start":{"line":161,"column":11},"end":{"line":161,"column":25}}},"11":{"name":"(anonymous_11)","line":173,"loc":{"start":{"line":173,"column":20},"end":{"line":173,"column":39}}},"12":{"name":"(anonymous_12)","line":174,"loc":{"start":{"line":174,"column":12},"end":{"line":174,"column":23}}},"13":{"name":"(anonymous_13)","line":205,"loc":{"start":{"line":205,"column":14},"end":{"line":205,"column":38}}},"14":{"name":"(anonymous_14)","line":220,"loc":{"start":{"line":220,"column":24},"end":{"line":220,"column":43}}},"15":{"name":"(anonymous_15)","line":241,"loc":{"start":{"line":241,"column":26},"end":{"line":241,"column":45}}},"16":{"name":"(anonymous_16)","line":263,"loc":{"start":{"line":263,"column":34},"end":{"line":263,"column":45}}},"17":{"name":"(anonymous_17)","line":275,"loc":{"start":{"line":275,"column":31},"end":{"line":275,"column":42}}},"18":{"name":"(anonymous_18)","line":293,"loc":{"start":{"line":293,"column":30},"end":{"line":293,"column":44}}},"19":{"name":"(anonymous_19)","line":300,"loc":{"start":{"line":300,"column":28},"end":{"line":300,"column":39}}},"20":{"name":"(anonymous_20)","line":313,"loc":{"start":{"line":313,"column":32},"end":{"line":313,"column":63}}},"21":{"name":"(anonymous_21)","line":341,"loc":{"start":{"line":341,"column":10},"end":{"line":341,"column":37}}},"22":{"name":"(anonymous_22)","line":360,"loc":{"start":{"line":360,"column":17},"end":{"line":360,"column":43}}},"23":{"name":"(anonymous_23)","line":386,"loc":{"start":{"line":386,"column":25},"end":{"line":386,"column":80}}},"24":{"name":"(anonymous_24)","line":402,"loc":{"start":{"line":402,"column":57},"end":{"line":402,"column":68}}},"25":{"name":"(anonymous_25)","line":410,"loc":{"start":{"line":410,"column":14},"end":{"line":410,"column":33}}},"26":{"name":"(anonymous_26)","line":411,"loc":{"start":{"line":411,"column":11},"end":{"line":411,"column":32}}},"27":{"name":"(anonymous_27)","line":429,"loc":{"start":{"line":429,"column":20},"end":{"line":429,"column":34}}},"28":{"name":"(anonymous_28)","line":430,"loc":{"start":{"line":430,"column":12},"end":{"line":430,"column":23}}},"29":{"name":"(anonymous_29)","line":452,"loc":{"start":{"line":452,"column":21},"end":{"line":452,"column":40}}},"30":{"name":"(anonymous_30)","line":457,"loc":{"start":{"line":457,"column":41},"end":{"line":457,"column":61}}},"31":{"name":"(anonymous_31)","line":466,"loc":{"start":{"line":466,"column":19},"end":{"line":466,"column":33}}},"32":{"name":"(anonymous_32)","line":467,"loc":{"start":{"line":467,"column":18},"end":{"line":467,"column":29}}},"33":{"name":"(anonymous_33)","line":468,"loc":{"start":{"line":468,"column":40},"end":{"line":468,"column":61}}},"34":{"name":"(anonymous_34)","line":494,"loc":{"start":{"line":494,"column":17},"end":{"line":494,"column":44}}},"35":{"name":"(anonymous_35)","line":496,"loc":{"start":{"line":496,"column":31},"end":{"line":496,"column":45}}},"36":{"name":"(anonymous_36)","line":504,"loc":{"start":{"line":504,"column":22},"end":{"line":504,"column":49}}},"37":{"name":"(anonymous_37)","line":506,"loc":{"start":{"line":506,"column":34},"end":{"line":506,"column":48}}},"38":{"name":"(anonymous_38)","line":514,"loc":{"start":{"line":514,"column":23},"end":{"line":514,"column":47}}},"39":{"name":"(anonymous_39)","line":516,"loc":{"start":{"line":516,"column":25},"end":{"line":516,"column":45}}},"40":{"name":"(anonymous_40)","line":527,"loc":{"start":{"line":527,"column":25},"end":{"line":527,"column":45}}},"41":{"name":"(anonymous_41)","line":529,"loc":{"start":{"line":529,"column":30},"end":{"line":529,"column":44}}},"42":{"name":"(anonymous_42)","line":537,"loc":{"start":{"line":537,"column":13},"end":{"line":537,"column":34}}},"43":{"name":"(anonymous_43)","line":545,"loc":{"start":{"line":545,"column":15},"end":{"line":545,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":58}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":64}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":70}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":18}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":21}},"7":{"start":{"line":21,"column":0},"end":{"line":29,"column":2}},"8":{"start":{"line":22,"column":2},"end":{"line":22,"column":20}},"9":{"start":{"line":23,"column":2},"end":{"line":23,"column":17}},"10":{"start":{"line":24,"column":2},"end":{"line":24,"column":21}},"11":{"start":{"line":25,"column":2},"end":{"line":25,"column":28}},"12":{"start":{"line":26,"column":2},"end":{"line":26,"column":26}},"13":{"start":{"line":27,"column":2},"end":{"line":27,"column":46}},"14":{"start":{"line":28,"column":2},"end":{"line":28,"column":46}},"15":{"start":{"line":31,"column":0},"end":{"line":31,"column":32}},"16":{"start":{"line":34,"column":0},"end":{"line":36,"column":2}},"17":{"start":{"line":35,"column":2},"end":{"line":35,"column":27}},"18":{"start":{"line":46,"column":0},"end":{"line":55,"column":2}},"19":{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},"20":{"start":{"line":48,"column":4},"end":{"line":48,"column":31}},"21":{"start":{"line":51,"column":2},"end":{"line":51,"column":34}},"22":{"start":{"line":52,"column":2},"end":{"line":52,"column":53}},"23":{"start":{"line":53,"column":2},"end":{"line":53,"column":26}},"24":{"start":{"line":54,"column":2},"end":{"line":54,"column":11}},"25":{"start":{"line":65,"column":0},"end":{"line":72,"column":2}},"26":{"start":{"line":66,"column":2},"end":{"line":66,"column":36}},"27":{"start":{"line":67,"column":2},"end":{"line":70,"column":3}},"28":{"start":{"line":68,"column":4},"end":{"line":68,"column":60}},"29":{"start":{"line":69,"column":4},"end":{"line":69,"column":55}},"30":{"start":{"line":71,"column":2},"end":{"line":71,"column":17}},"31":{"start":{"line":80,"column":0},"end":{"line":84,"column":2}},"32":{"start":{"line":81,"column":2},"end":{"line":81,"column":29}},"33":{"start":{"line":82,"column":2},"end":{"line":82,"column":58}},"34":{"start":{"line":83,"column":2},"end":{"line":83,"column":47}},"35":{"start":{"line":97,"column":0},"end":{"line":122,"column":2}},"36":{"start":{"line":98,"column":2},"end":{"line":104,"column":3}},"37":{"start":{"line":99,"column":4},"end":{"line":99,"column":14}},"38":{"start":{"line":100,"column":4},"end":{"line":100,"column":16}},"39":{"start":{"line":101,"column":4},"end":{"line":101,"column":15}},"40":{"start":{"line":102,"column":4},"end":{"line":102,"column":16}},"41":{"start":{"line":103,"column":4},"end":{"line":103,"column":22}},"42":{"start":{"line":106,"column":2},"end":{"line":109,"column":3}},"43":{"start":{"line":107,"column":4},"end":{"line":107,"column":14}},"44":{"start":{"line":108,"column":4},"end":{"line":108,"column":14}},"45":{"start":{"line":111,"column":2},"end":{"line":114,"column":3}},"46":{"start":{"line":112,"column":4},"end":{"line":112,"column":68}},"47":{"start":{"line":113,"column":4},"end":{"line":113,"column":11}},"48":{"start":{"line":115,"column":2},"end":{"line":115,"column":26}},"49":{"start":{"line":116,"column":2},"end":{"line":119,"column":3}},"50":{"start":{"line":117,"column":4},"end":{"line":117,"column":21}},"51":{"start":{"line":118,"column":4},"end":{"line":118,"column":40}},"52":{"start":{"line":121,"column":2},"end":{"line":121,"column":57}},"53":{"start":{"line":136,"column":0},"end":{"line":196,"column":2}},"54":{"start":{"line":137,"column":2},"end":{"line":137,"column":21}},"55":{"start":{"line":138,"column":2},"end":{"line":138,"column":24}},"56":{"start":{"line":139,"column":2},"end":{"line":139,"column":32}},"57":{"start":{"line":140,"column":2},"end":{"line":140,"column":27}},"58":{"start":{"line":141,"column":2},"end":{"line":141,"column":44}},"59":{"start":{"line":143,"column":2},"end":{"line":147,"column":3}},"60":{"start":{"line":145,"column":4},"end":{"line":145,"column":29}},"61":{"start":{"line":146,"column":4},"end":{"line":146,"column":11}},"62":{"start":{"line":149,"column":2},"end":{"line":149,"column":29}},"63":{"start":{"line":150,"column":2},"end":{"line":150,"column":26}},"64":{"start":{"line":152,"column":2},"end":{"line":158,"column":5}},"65":{"start":{"line":153,"column":4},"end":{"line":156,"column":5}},"66":{"start":{"line":154,"column":6},"end":{"line":154,"column":61}},"67":{"start":{"line":155,"column":6},"end":{"line":155,"column":13}},"68":{"start":{"line":157,"column":4},"end":{"line":157,"column":35}},"69":{"start":{"line":160,"column":2},"end":{"line":170,"column":4}},"70":{"start":{"line":161,"column":4},"end":{"line":169,"column":6}},"71":{"start":{"line":162,"column":6},"end":{"line":166,"column":7}},"72":{"start":{"line":163,"column":8},"end":{"line":163,"column":105}},"73":{"start":{"line":164,"column":8},"end":{"line":164,"column":21}},"74":{"start":{"line":165,"column":8},"end":{"line":165,"column":15}},"75":{"start":{"line":167,"column":6},"end":{"line":167,"column":25}},"76":{"start":{"line":168,"column":6},"end":{"line":168,"column":19}},"77":{"start":{"line":172,"column":2},"end":{"line":172,"column":18}},"78":{"start":{"line":173,"column":2},"end":{"line":182,"column":4}},"79":{"start":{"line":174,"column":4},"end":{"line":181,"column":9}},"80":{"start":{"line":175,"column":6},"end":{"line":180,"column":7}},"81":{"start":{"line":176,"column":8},"end":{"line":176,"column":62}},"82":{"start":{"line":178,"column":8},"end":{"line":179,"column":70}},"83":{"start":{"line":184,"column":2},"end":{"line":184,"column":54}},"84":{"start":{"line":187,"column":2},"end":{"line":187,"column":26}},"85":{"start":{"line":188,"column":2},"end":{"line":191,"column":3}},"86":{"start":{"line":189,"column":4},"end":{"line":189,"column":42}},"87":{"start":{"line":190,"column":4},"end":{"line":190,"column":52}},"88":{"start":{"line":193,"column":2},"end":{"line":195,"column":3}},"89":{"start":{"line":194,"column":4},"end":{"line":194,"column":31}},"90":{"start":{"line":205,"column":0},"end":{"line":212,"column":2}},"91":{"start":{"line":206,"column":2},"end":{"line":206,"column":19}},"92":{"start":{"line":207,"column":2},"end":{"line":207,"column":19}},"93":{"start":{"line":208,"column":2},"end":{"line":208,"column":20}},"94":{"start":{"line":209,"column":2},"end":{"line":209,"column":36}},"95":{"start":{"line":210,"column":2},"end":{"line":210,"column":25}},"96":{"start":{"line":211,"column":2},"end":{"line":211,"column":21}},"97":{"start":{"line":220,"column":0},"end":{"line":232,"column":2}},"98":{"start":{"line":221,"column":2},"end":{"line":231,"column":3}},"99":{"start":{"line":222,"column":4},"end":{"line":222,"column":17}},"100":{"start":{"line":224,"column":4},"end":{"line":224,"column":41}},"101":{"start":{"line":225,"column":4},"end":{"line":228,"column":5}},"102":{"start":{"line":226,"column":6},"end":{"line":226,"column":47}},"103":{"start":{"line":227,"column":6},"end":{"line":227,"column":41}},"104":{"start":{"line":229,"column":4},"end":{"line":229,"column":104}},"105":{"start":{"line":230,"column":4},"end":{"line":230,"column":15}},"106":{"start":{"line":241,"column":0},"end":{"line":256,"column":2}},"107":{"start":{"line":242,"column":2},"end":{"line":244,"column":3}},"108":{"start":{"line":243,"column":4},"end":{"line":243,"column":17}},"109":{"start":{"line":245,"column":2},"end":{"line":245,"column":51}},"110":{"start":{"line":246,"column":2},"end":{"line":249,"column":3}},"111":{"start":{"line":247,"column":4},"end":{"line":247,"column":29}},"112":{"start":{"line":248,"column":4},"end":{"line":248,"column":40}},"113":{"start":{"line":250,"column":2},"end":{"line":250,"column":42}},"114":{"start":{"line":250,"column":24},"end":{"line":250,"column":42}},"115":{"start":{"line":251,"column":2},"end":{"line":251,"column":107}},"116":{"start":{"line":252,"column":2},"end":{"line":254,"column":3}},"117":{"start":{"line":253,"column":4},"end":{"line":253,"column":28}},"118":{"start":{"line":255,"column":2},"end":{"line":255,"column":13}},"119":{"start":{"line":263,"column":0},"end":{"line":266,"column":2}},"120":{"start":{"line":265,"column":2},"end":{"line":265,"column":25}},"121":{"start":{"line":275,"column":0},"end":{"line":285,"column":2}},"122":{"start":{"line":276,"column":2},"end":{"line":276,"column":37}},"123":{"start":{"line":277,"column":2},"end":{"line":277,"column":18}},"124":{"start":{"line":278,"column":2},"end":{"line":283,"column":3}},"125":{"start":{"line":279,"column":4},"end":{"line":279,"column":24}},"126":{"start":{"line":280,"column":4},"end":{"line":282,"column":5}},"127":{"start":{"line":281,"column":6},"end":{"line":281,"column":25}},"128":{"start":{"line":284,"column":2},"end":{"line":284,"column":13}},"129":{"start":{"line":293,"column":0},"end":{"line":295,"column":2}},"130":{"start":{"line":294,"column":2},"end":{"line":294,"column":27}},"131":{"start":{"line":300,"column":0},"end":{"line":303,"column":2}},"132":{"start":{"line":301,"column":2},"end":{"line":301,"column":28}},"133":{"start":{"line":302,"column":2},"end":{"line":302,"column":52}},"134":{"start":{"line":313,"column":0},"end":{"line":332,"column":2}},"135":{"start":{"line":314,"column":2},"end":{"line":317,"column":3}},"136":{"start":{"line":315,"column":4},"end":{"line":315,"column":66}},"137":{"start":{"line":316,"column":4},"end":{"line":316,"column":11}},"138":{"start":{"line":319,"column":2},"end":{"line":324,"column":3}},"139":{"start":{"line":320,"column":4},"end":{"line":320,"column":14}},"140":{"start":{"line":321,"column":4},"end":{"line":321,"column":15}},"141":{"start":{"line":322,"column":4},"end":{"line":322,"column":16}},"142":{"start":{"line":323,"column":4},"end":{"line":323,"column":22}},"143":{"start":{"line":326,"column":2},"end":{"line":329,"column":3}},"144":{"start":{"line":327,"column":4},"end":{"line":327,"column":14}},"145":{"start":{"line":328,"column":4},"end":{"line":328,"column":14}},"146":{"start":{"line":331,"column":2},"end":{"line":331,"column":81}},"147":{"start":{"line":341,"column":0},"end":{"line":355,"column":2}},"148":{"start":{"line":342,"column":2},"end":{"line":345,"column":3}},"149":{"start":{"line":343,"column":4},"end":{"line":343,"column":61}},"150":{"start":{"line":344,"column":4},"end":{"line":344,"column":17}},"151":{"start":{"line":347,"column":2},"end":{"line":347,"column":26}},"152":{"start":{"line":348,"column":2},"end":{"line":351,"column":3}},"153":{"start":{"line":349,"column":4},"end":{"line":349,"column":15}},"154":{"start":{"line":350,"column":4},"end":{"line":350,"column":24}},"155":{"start":{"line":353,"column":2},"end":{"line":353,"column":18}},"156":{"start":{"line":354,"column":2},"end":{"line":354,"column":14}},"157":{"start":{"line":360,"column":0},"end":{"line":373,"column":2}},"158":{"start":{"line":361,"column":2},"end":{"line":363,"column":3}},"159":{"start":{"line":362,"column":4},"end":{"line":362,"column":17}},"160":{"start":{"line":365,"column":2},"end":{"line":370,"column":3}},"161":{"start":{"line":366,"column":4},"end":{"line":369,"column":5}},"162":{"start":{"line":367,"column":6},"end":{"line":367,"column":25}},"163":{"start":{"line":368,"column":6},"end":{"line":368,"column":18}},"164":{"start":{"line":372,"column":2},"end":{"line":372,"column":15}},"165":{"start":{"line":386,"column":0},"end":{"line":450,"column":2}},"166":{"start":{"line":387,"column":2},"end":{"line":387,"column":31}},"167":{"start":{"line":388,"column":2},"end":{"line":388,"column":24}},"168":{"start":{"line":389,"column":2},"end":{"line":389,"column":32}},"169":{"start":{"line":390,"column":2},"end":{"line":390,"column":29}},"170":{"start":{"line":391,"column":2},"end":{"line":391,"column":33}},"171":{"start":{"line":392,"column":2},"end":{"line":392,"column":26}},"172":{"start":{"line":393,"column":2},"end":{"line":393,"column":19}},"173":{"start":{"line":395,"column":2},"end":{"line":395,"column":138}},"174":{"start":{"line":396,"column":2},"end":{"line":400,"column":3}},"175":{"start":{"line":398,"column":4},"end":{"line":398,"column":29}},"176":{"start":{"line":399,"column":4},"end":{"line":399,"column":11}},"177":{"start":{"line":402,"column":2},"end":{"line":408,"column":5}},"178":{"start":{"line":403,"column":4},"end":{"line":406,"column":5}},"179":{"start":{"line":404,"column":6},"end":{"line":404,"column":72}},"180":{"start":{"line":405,"column":6},"end":{"line":405,"column":13}},"181":{"start":{"line":407,"column":4},"end":{"line":407,"column":44}},"182":{"start":{"line":410,"column":2},"end":{"line":423,"column":4}},"183":{"start":{"line":411,"column":4},"end":{"line":422,"column":6}},"184":{"start":{"line":412,"column":6},"end":{"line":416,"column":7}},"185":{"start":{"line":413,"column":8},"end":{"line":413,"column":107}},"186":{"start":{"line":414,"column":8},"end":{"line":414,"column":21}},"187":{"start":{"line":415,"column":8},"end":{"line":415,"column":15}},"188":{"start":{"line":417,"column":6},"end":{"line":419,"column":7}},"189":{"start":{"line":418,"column":8},"end":{"line":418,"column":40}},"190":{"start":{"line":420,"column":6},"end":{"line":420,"column":25}},"191":{"start":{"line":421,"column":6},"end":{"line":421,"column":19}},"192":{"start":{"line":425,"column":2},"end":{"line":425,"column":49}},"193":{"start":{"line":427,"column":2},"end":{"line":427,"column":21}},"194":{"start":{"line":429,"column":2},"end":{"line":438,"column":4}},"195":{"start":{"line":430,"column":4},"end":{"line":437,"column":9}},"196":{"start":{"line":431,"column":6},"end":{"line":436,"column":7}},"197":{"start":{"line":432,"column":8},"end":{"line":432,"column":88}},"198":{"start":{"line":434,"column":8},"end":{"line":435,"column":78}},"199":{"start":{"line":440,"column":2},"end":{"line":440,"column":12}},"200":{"start":{"line":441,"column":2},"end":{"line":449,"column":3}},"201":{"start":{"line":442,"column":4},"end":{"line":442,"column":24}},"202":{"start":{"line":443,"column":4},"end":{"line":448,"column":5}},"203":{"start":{"line":444,"column":6},"end":{"line":444,"column":23}},"204":{"start":{"line":447,"column":6},"end":{"line":447,"column":35}},"205":{"start":{"line":452,"column":0},"end":{"line":492,"column":2}},"206":{"start":{"line":453,"column":2},"end":{"line":491,"column":1}},"207":{"start":{"line":454,"column":4},"end":{"line":454,"column":29}},"208":{"start":{"line":455,"column":4},"end":{"line":455,"column":11}},"209":{"start":{"line":457,"column":4},"end":{"line":490,"column":5}},"210":{"start":{"line":458,"column":6},"end":{"line":489,"column":5}},"211":{"start":{"line":459,"column":8},"end":{"line":459,"column":38}},"212":{"start":{"line":460,"column":8},"end":{"line":460,"column":15}},"213":{"start":{"line":462,"column":8},"end":{"line":465,"column":9}},"214":{"start":{"line":463,"column":10},"end":{"line":463,"column":35}},"215":{"start":{"line":464,"column":10},"end":{"line":464,"column":17}},"216":{"start":{"line":466,"column":8},"end":{"line":481,"column":10}},"217":{"start":{"line":467,"column":10},"end":{"line":480,"column":15}},"218":{"start":{"line":468,"column":12},"end":{"line":479,"column":15}},"219":{"start":{"line":469,"column":14},"end":{"line":478,"column":15}},"220":{"start":{"line":470,"column":16},"end":{"line":470,"column":48}},"221":{"start":{"line":471,"column":16},"end":{"line":471,"column":35}},"222":{"start":{"line":472,"column":16},"end":{"line":472,"column":35}},"223":{"start":{"line":473,"column":16},"end":{"line":473,"column":50}},"224":{"start":{"line":474,"column":16},"end":{"line":474,"column":56}},"225":{"start":{"line":475,"column":16},"end":{"line":477,"column":17}},"226":{"start":{"line":476,"column":18},"end":{"line":476,"column":62}},"227":{"start":{"line":483,"column":7},"end":{"line":487,"column":7}},"228":{"start":{"line":484,"column":8},"end":{"line":484,"column":58}},"229":{"start":{"line":485,"column":8},"end":{"line":485,"column":54}},"230":{"start":{"line":486,"column":8},"end":{"line":486,"column":22}},"231":{"start":{"line":488,"column":6},"end":{"line":488,"column":31}},"232":{"start":{"line":494,"column":0},"end":{"line":502,"column":2}},"233":{"start":{"line":495,"column":2},"end":{"line":501,"column":3}},"234":{"start":{"line":496,"column":4},"end":{"line":500,"column":7}},"235":{"start":{"line":497,"column":6},"end":{"line":499,"column":7}},"236":{"start":{"line":498,"column":8},"end":{"line":498,"column":92}},"237":{"start":{"line":504,"column":0},"end":{"line":512,"column":2}},"238":{"start":{"line":505,"column":2},"end":{"line":511,"column":3}},"239":{"start":{"line":506,"column":4},"end":{"line":510,"column":7}},"240":{"start":{"line":507,"column":6},"end":{"line":509,"column":7}},"241":{"start":{"line":508,"column":8},"end":{"line":508,"column":97}},"242":{"start":{"line":514,"column":0},"end":{"line":525,"column":2}},"243":{"start":{"line":515,"column":2},"end":{"line":524,"column":3}},"244":{"start":{"line":516,"column":4},"end":{"line":523,"column":7}},"245":{"start":{"line":517,"column":6},"end":{"line":522,"column":7}},"246":{"start":{"line":518,"column":8},"end":{"line":518,"column":78}},"247":{"start":{"line":519,"column":8},"end":{"line":519,"column":38}},"248":{"start":{"line":521,"column":8},"end":{"line":521,"column":45}},"249":{"start":{"line":527,"column":0},"end":{"line":535,"column":2}},"250":{"start":{"line":528,"column":2},"end":{"line":534,"column":3}},"251":{"start":{"line":529,"column":4},"end":{"line":533,"column":7}},"252":{"start":{"line":530,"column":6},"end":{"line":532,"column":7}},"253":{"start":{"line":531,"column":8},"end":{"line":531,"column":92}},"254":{"start":{"line":537,"column":0},"end":{"line":543,"column":2}},"255":{"start":{"line":538,"column":2},"end":{"line":542,"column":3}},"256":{"start":{"line":539,"column":4},"end":{"line":539,"column":62}},"257":{"start":{"line":541,"column":4},"end":{"line":541,"column":49}},"258":{"start":{"line":545,"column":0},"end":{"line":547,"column":2}},"259":{"start":{"line":546,"column":2},"end":{"line":546,"column":25}}},"branchMap":{"1":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":9},"end":{"line":22,"column":13}},{"start":{"line":22,"column":17},"end":{"line":22,"column":19}}]},"2":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":47,"column":2}},{"start":{"line":47,"column":2},"end":{"line":47,"column":2}}]},"3":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":2},"end":{"line":67,"column":2}},{"start":{"line":67,"column":2},"end":{"line":67,"column":2}}]},"4":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":5},"end":{"line":67,"column":13}},{"start":{"line":67,"column":17},"end":{"line":67,"column":25}}]},"5":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":2},"end":{"line":98,"column":2}},{"start":{"line":98,"column":2},"end":{"line":98,"column":2}}]},"6":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":2},"end":{"line":106,"column":2}},{"start":{"line":106,"column":2},"end":{"line":106,"column":2}}]},"7":{"line":106,"type":"binary-expr","locations":[{"start":{"line":106,"column":5},"end":{"line":106,"column":8}},{"start":{"line":106,"column":12},"end":{"line":106,"column":38}}]},"8":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":2},"end":{"line":111,"column":2}},{"start":{"line":111,"column":2},"end":{"line":111,"column":2}}]},"9":{"line":111,"type":"binary-expr","locations":[{"start":{"line":111,"column":5},"end":{"line":111,"column":10}},{"start":{"line":111,"column":14},"end":{"line":111,"column":31}}]},"10":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":2},"end":{"line":143,"column":2}},{"start":{"line":143,"column":2},"end":{"line":143,"column":2}}]},"11":{"line":143,"type":"binary-expr","locations":[{"start":{"line":143,"column":5},"end":{"line":143,"column":13}},{"start":{"line":143,"column":17},"end":{"line":143,"column":37}}]},"12":{"line":153,"type":"if","locations":[{"start":{"line":153,"column":4},"end":{"line":153,"column":4}},{"start":{"line":153,"column":4},"end":{"line":153,"column":4}}]},"13":{"line":162,"type":"if","locations":[{"start":{"line":162,"column":6},"end":{"line":162,"column":6}},{"start":{"line":162,"column":6},"end":{"line":162,"column":6}}]},"14":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":6},"end":{"line":175,"column":6}},{"start":{"line":175,"column":6},"end":{"line":175,"column":6}}]},"15":{"line":184,"type":"binary-expr","locations":[{"start":{"line":184,"column":42},"end":{"line":184,"column":46}},{"start":{"line":184,"column":50},"end":{"line":184,"column":52}}]},"16":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":2},"end":{"line":188,"column":2}},{"start":{"line":188,"column":2},"end":{"line":188,"column":2}}]},"17":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":2},"end":{"line":221,"column":2}},{"start":{"line":221,"column":2},"end":{"line":221,"column":2}}]},"18":{"line":225,"type":"if","locations":[{"start":{"line":225,"column":4},"end":{"line":225,"column":4}},{"start":{"line":225,"column":4},"end":{"line":225,"column":4}}]},"19":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":2},"end":{"line":242,"column":2}},{"start":{"line":242,"column":2},"end":{"line":242,"column":2}}]},"20":{"line":242,"type":"binary-expr","locations":[{"start":{"line":242,"column":5},"end":{"line":242,"column":9}},{"start":{"line":242,"column":13},"end":{"line":242,"column":17}}]},"21":{"line":246,"type":"if","locations":[{"start":{"line":246,"column":2},"end":{"line":246,"column":2}},{"start":{"line":246,"column":2},"end":{"line":246,"column":2}}]},"22":{"line":250,"type":"if","locations":[{"start":{"line":250,"column":2},"end":{"line":250,"column":2}},{"start":{"line":250,"column":2},"end":{"line":250,"column":2}}]},"23":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":2},"end":{"line":252,"column":2}},{"start":{"line":252,"column":2},"end":{"line":252,"column":2}}]},"24":{"line":252,"type":"binary-expr","locations":[{"start":{"line":252,"column":5},"end":{"line":252,"column":21}},{"start":{"line":252,"column":25},"end":{"line":252,"column":54}}]},"25":{"line":314,"type":"if","locations":[{"start":{"line":314,"column":2},"end":{"line":314,"column":2}},{"start":{"line":314,"column":2},"end":{"line":314,"column":2}}]},"26":{"line":319,"type":"if","locations":[{"start":{"line":319,"column":2},"end":{"line":319,"column":2}},{"start":{"line":319,"column":2},"end":{"line":319,"column":2}}]},"27":{"line":326,"type":"if","locations":[{"start":{"line":326,"column":2},"end":{"line":326,"column":2}},{"start":{"line":326,"column":2},"end":{"line":326,"column":2}}]},"28":{"line":326,"type":"binary-expr","locations":[{"start":{"line":326,"column":5},"end":{"line":326,"column":8}},{"start":{"line":326,"column":12},"end":{"line":326,"column":38}}]},"29":{"line":342,"type":"if","locations":[{"start":{"line":342,"column":2},"end":{"line":342,"column":2}},{"start":{"line":342,"column":2},"end":{"line":342,"column":2}}]},"30":{"line":348,"type":"if","locations":[{"start":{"line":348,"column":2},"end":{"line":348,"column":2}},{"start":{"line":348,"column":2},"end":{"line":348,"column":2}}]},"31":{"line":361,"type":"if","locations":[{"start":{"line":361,"column":2},"end":{"line":361,"column":2}},{"start":{"line":361,"column":2},"end":{"line":361,"column":2}}]},"32":{"line":361,"type":"binary-expr","locations":[{"start":{"line":361,"column":5},"end":{"line":361,"column":9}},{"start":{"line":361,"column":13},"end":{"line":361,"column":17}},{"start":{"line":361,"column":21},"end":{"line":361,"column":27}}]},"33":{"line":366,"type":"if","locations":[{"start":{"line":366,"column":4},"end":{"line":366,"column":4}},{"start":{"line":366,"column":4},"end":{"line":366,"column":4}}]},"34":{"line":396,"type":"if","locations":[{"start":{"line":396,"column":2},"end":{"line":396,"column":2}},{"start":{"line":396,"column":2},"end":{"line":396,"column":2}}]},"35":{"line":403,"type":"if","locations":[{"start":{"line":403,"column":4},"end":{"line":403,"column":4}},{"start":{"line":403,"column":4},"end":{"line":403,"column":4}}]},"36":{"line":412,"type":"if","locations":[{"start":{"line":412,"column":6},"end":{"line":412,"column":6}},{"start":{"line":412,"column":6},"end":{"line":412,"column":6}}]},"37":{"line":417,"type":"if","locations":[{"start":{"line":417,"column":6},"end":{"line":417,"column":6}},{"start":{"line":417,"column":6},"end":{"line":417,"column":6}}]},"38":{"line":425,"type":"binary-expr","locations":[{"start":{"line":425,"column":37},"end":{"line":425,"column":41}},{"start":{"line":425,"column":45},"end":{"line":425,"column":47}}]},"39":{"line":431,"type":"if","locations":[{"start":{"line":431,"column":6},"end":{"line":431,"column":6}},{"start":{"line":431,"column":6},"end":{"line":431,"column":6}}]},"40":{"line":443,"type":"if","locations":[{"start":{"line":443,"column":4},"end":{"line":443,"column":4}},{"start":{"line":443,"column":4},"end":{"line":443,"column":4}}]},"41":{"line":443,"type":"binary-expr","locations":[{"start":{"line":443,"column":7},"end":{"line":443,"column":12}},{"start":{"line":443,"column":16},"end":{"line":443,"column":32}}]},"42":{"line":453,"type":"if","locations":[{"start":{"line":453,"column":2},"end":{"line":453,"column":2}},{"start":{"line":453,"column":2},"end":{"line":453,"column":2}}]},"43":{"line":458,"type":"if","locations":[{"start":{"line":458,"column":6},"end":{"line":458,"column":6}},{"start":{"line":458,"column":6},"end":{"line":458,"column":6}}]},"44":{"line":462,"type":"if","locations":[{"start":{"line":462,"column":8},"end":{"line":462,"column":8}},{"start":{"line":462,"column":8},"end":{"line":462,"column":8}}]},"45":{"line":462,"type":"binary-expr","locations":[{"start":{"line":462,"column":11},"end":{"line":462,"column":23}},{"start":{"line":462,"column":27},"end":{"line":462,"column":47}}]},"46":{"line":475,"type":"if","locations":[{"start":{"line":475,"column":16},"end":{"line":475,"column":16}},{"start":{"line":475,"column":16},"end":{"line":475,"column":16}}]},"47":{"line":495,"type":"if","locations":[{"start":{"line":495,"column":2},"end":{"line":495,"column":2}},{"start":{"line":495,"column":2},"end":{"line":495,"column":2}}]},"48":{"line":497,"type":"if","locations":[{"start":{"line":497,"column":6},"end":{"line":497,"column":6}},{"start":{"line":497,"column":6},"end":{"line":497,"column":6}}]},"49":{"line":505,"type":"if","locations":[{"start":{"line":505,"column":2},"end":{"line":505,"column":2}},{"start":{"line":505,"column":2},"end":{"line":505,"column":2}}]},"50":{"line":507,"type":"if","locations":[{"start":{"line":507,"column":6},"end":{"line":507,"column":6}},{"start":{"line":507,"column":6},"end":{"line":507,"column":6}}]},"51":{"line":515,"type":"if","locations":[{"start":{"line":515,"column":2},"end":{"line":515,"column":2}},{"start":{"line":515,"column":2},"end":{"line":515,"column":2}}]},"52":{"line":517,"type":"if","locations":[{"start":{"line":517,"column":6},"end":{"line":517,"column":6}},{"start":{"line":517,"column":6},"end":{"line":517,"column":6}}]},"53":{"line":528,"type":"if","locations":[{"start":{"line":528,"column":2},"end":{"line":528,"column":2}},{"start":{"line":528,"column":2},"end":{"line":528,"column":2}}]},"54":{"line":530,"type":"if","locations":[{"start":{"line":530,"column":6},"end":{"line":530,"column":6}},{"start":{"line":530,"column":6},"end":{"line":530,"column":6}}]},"55":{"line":538,"type":"if","locations":[{"start":{"line":538,"column":2},"end":{"line":538,"column":2}},{"start":{"line":538,"column":2},"end":{"line":538,"column":2}}]}},"code":["var countDownLatch = require('../../util/countDownLatch');","var utils = require('../../util/utils');","var ChannelRemote = require('../remote/frontend/channelRemote');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","/**"," * constant"," */","var ST_INITED = 0;","var ST_DESTROYED = 1;","","/**"," * Create and maintain channels for server local."," *"," * ChannelService is created by channel component which is a default loaded"," * component of pomelo and channel service would be accessed by `app.get('channelService')`."," *"," * @class"," * @constructor"," */","var ChannelService = function(app, opts) {","  opts = opts || {};","  this.app = app;","  this.channels = {};","  this.prefix = opts.prefix;","  this.store = opts.store;","  this.broadcastFilter = opts.broadcastFilter;","  this.channelRemote = new ChannelRemote(app);","};","","module.exports = ChannelService;","","","ChannelService.prototype.start = function(cb) {","  restoreChannel(this, cb);","};","","","","/**"," * Create channel with name."," *"," * @param {String} name channel's name"," * @memberOf ChannelService"," */","ChannelService.prototype.createChannel = function(name) {","  if(this.channels[name]) {","    return this.channels[name];","  }","","  var c = new Channel(name, this);","  addToStore(this, genKey(this), genKey(this, name));","  this.channels[name] = c;","  return c;","};","","/**"," * Get channel by name."," *"," * @param {String} name channel's name"," * @param {Boolean} create if true, create channel"," * @return {Channel}"," * @memberOf ChannelService"," */","ChannelService.prototype.getChannel = function(name, create) {","  var channel = this.channels[name];","  if(!channel && !!create) {","    channel = this.channels[name] = new Channel(name, this);","    addToStore(this, genKey(this), genKey(this, name));","  }","  return channel;","};","","/**"," * Destroy channel by name."," *"," * @param {String} name channel name"," * @memberOf ChannelService"," */","ChannelService.prototype.destroyChannel = function(name) {","  delete this.channels[name];","  removeFromStore(this, genKey(this), genKey(this, name));","  removeAllFromStore(this, genKey(this, name));","};","","/**"," * Push message by uids."," * Group the uids by group. ignore any uid if sid not specified."," *"," * @param {String} route message route"," * @param {Object} msg message that would be sent to client"," * @param {Array} uids the receiver info list, [{uid: userId, sid: frontendServerId}]"," * @param {Object} opts user-defined push options, optional "," * @param {Function} cb cb(err)"," * @memberOf ChannelService"," */","ChannelService.prototype.pushMessageByUids = function(route, msg, uids, opts, cb) {","  if(typeof route !== 'string') {","    cb = opts;","    opts = uids;","    uids = msg;","    msg = route;","    route = msg.route;","  }","","  if(!cb && typeof opts === 'function') {","    cb = opts;","    opts = {};","  }","","  if(!uids || uids.length === 0) {","    utils.invokeCallback(cb, new Error('uids should not be empty'));","    return;","  }","  var groups = {}, record;","  for(var i=0, l=uids.length; i<l; i++) {","    record = uids[i];","    add(record.uid, record.sid, groups);","  }","","  sendMessageByGroup(this, route, msg, groups, opts, cb);","};","","/**"," * Broadcast message to all the connected clients."," *"," * @param  {String}   stype      frontend server type string"," * @param  {String}   route      route string"," * @param  {Object}   msg        message"," * @param  {Object}   opts       user-defined broadcast options, optional"," *                               opts.binded: push to binded sessions or all the sessions"," *                               opts.filterParam: parameters for broadcast filter."," * @param  {Function} cb         callback"," * @memberOf ChannelService"," */","ChannelService.prototype.broadcast = function(stype, route, msg, opts, cb) {","  var app = this.app;","  var namespace = 'sys';","  var service = 'channelRemote';","  var method = 'broadcast';","  var servers = app.getServersByType(stype);","","  if(!servers || servers.length === 0) {","    // server list is empty","    utils.invokeCallback(cb);","    return;","  }","","  var count = servers.length;","  var successFlag = false;","","  var latch = countDownLatch.createCountDownLatch(count, function() {","    if(!successFlag) {","      utils.invokeCallback(cb, new Error('broadcast fails'));","      return;","    }","    utils.invokeCallback(cb, null);","  });","","  var genCB = function(serverId) {","    return function(err) {","      if(err) {","        logger.error('[broadcast] fail to push message to serverId: ' + serverId + ', err:' + err.stack);","        latch.done();","        return;","      }","      successFlag = true;","      latch.done();","    };","  };","","  var self = this;","  var sendMessage = function(serverId) {","    return (function() {","      if(serverId === app.serverId) {","        self.channelRemote[method](route, msg, opts, genCB());","      } else {","        app.rpcInvoke(serverId, {namespace: namespace, service: service,","          method: method, args: [route, msg, opts]}, genCB(serverId));","      }","    }());","  };","","  opts = {type: 'broadcast', userOptions: opts || {}};","","  // for compatiblity ","  opts.isBroadcast = true;","  if(opts.userOptions) {","    opts.binded = opts.userOptions.binded;","    opts.filterParam = opts.userOptions.filterParam;","  }","","  for(var i=0, l=count; i<l; i++) {","    sendMessage(servers[i].id);","  }","};","","/**"," * Channel maintains the receiver collection for a subject. You can"," * add users into a channel and then broadcast message to them by channel."," *"," * @class channel"," * @constructor"," */","var Channel = function(name, service) {","  this.name = name;","  this.groups = {};       // group map for uids. key: sid, value: [uid]","  this.records = {};      // member records. key: uid","  this.__channelService__ = service;","  this.state = ST_INITED;","  this.userAmount =0;","};","","/**"," * Add user to channel."," *"," * @param {Number} uid user id"," * @param {String} sid frontend server id which user has connected to"," */","Channel.prototype.add = function(uid, sid) {","  if(this.state > ST_INITED) {","    return false;","  } else {","    var res = add(uid, sid, this.groups);","    if(res) {","      this.records[uid] = {sid: sid, uid: uid};","      this.userAmount =this.userAmount+1;","    }","    addToStore(this.__channelService__, genKey(this.__channelService__, this.name), genValue(sid, uid));","    return res;","  }","};","","/**"," * Remove user from channel."," *"," * @param {Number} uid user id"," * @param {String} sid frontend server id which user has connected to."," * @return [Boolean] true if success or false if fail"," */","Channel.prototype.leave = function(uid, sid) {","  if(!uid || !sid) {","    return false;","  }","  var res = deleteFrom(uid, sid, this.groups[sid]);","  if(res){","    delete this.records[uid];","    this.userAmount = this.userAmount-1;","  }","  if(this.userAmount<0) this.userAmount=0;//robust","  removeFromStore(this.__channelService__, genKey(this.__channelService__, this.name), genValue(sid, uid));","  if(this.groups[sid] && this.groups[sid].length === 0) {","    delete this.groups[sid];","  }","  return res;","};","/**"," * Get channel UserAmount in a channel.",""," *"," * @return {number } channel member amount"," */","Channel.prototype.getUserAmount = function() {"," ","  return this.userAmount;","};","","/**"," * Get channel members."," *"," * <b>Notice:</b> Heavy operation."," *"," * @return {Array} channel member uid list"," */","Channel.prototype.getMembers = function() {","  var res = [], groups = this.groups;","  var group, i, l;","  for(var sid in groups) {","    group = groups[sid];","    for(i=0, l=group.length; i<l; i++) {","      res.push(group[i]);","    }","  }","  return res;","};","","/**"," * Get Member info."," *"," * @param  {String} uid user id"," * @return {Object} member info"," */","Channel.prototype.getMember = function(uid) {","  return this.records[uid];","};","","/**"," * Destroy channel."," */","Channel.prototype.destroy = function() {","  this.state = ST_DESTROYED;","  this.__channelService__.destroyChannel(this.name);","};","","/**"," * Push message to all the members in the channel"," *"," * @param {String} route message route"," * @param {Object} msg message that would be sent to client"," * @param {Object} opts user-defined push options, optional"," * @param {Function} cb callback function"," */","Channel.prototype.pushMessage = function(route, msg, opts, cb) {","  if(this.state !== ST_INITED) {","    utils.invokeCallback(new Error('channel is not running now'));","    return;","  }","","  if(typeof route !== 'string') {","    cb = opts;","    opts = msg;","    msg = route;","    route = msg.route;","  }","","  if(!cb && typeof opts === 'function') {","    cb = opts;","    opts = {};","  }","","  sendMessageByGroup(this.__channelService__, route, msg, this.groups, opts, cb);","};","","/**"," * add uid and sid into group. ignore any uid that uid not specified."," *"," * @param uid user id"," * @param sid server id"," * @param groups {Object} grouped uids, , key: sid, value: [uid]"," */","var add = function(uid, sid, groups) {","  if(!sid) {","    logger.warn('ignore uid %j for sid not specified.', uid);","    return false;","  }","","  var group = groups[sid];","  if(!group) {","    group = [];","    groups[sid] = group;","  }","","  group.push(uid);","  return true;","};","","/**"," * delete element from array"," */","var deleteFrom = function(uid, sid, group) {","  if(!uid || !sid || !group) {","    return false;","  }","","  for(var i=0, l=group.length; i<l; i++) {","    if(group[i] === uid) {","      group.splice(i, 1);","      return true;","    }","  }","","  return false;","};","","/**"," * push message by group"," *"," * @param route {String} route route message"," * @param msg {Object} message that would be sent to client"," * @param groups {Object} grouped uids, , key: sid, value: [uid]"," * @param opts {Object} push options"," * @param cb {Function} cb(err)"," *"," * @api private"," */","var sendMessageByGroup = function(channelService, route, msg, groups, opts, cb) {","  var app = channelService.app;","  var namespace = 'sys';","  var service = 'channelRemote';","  var method = 'pushMessage';","  var count = utils.size(groups);","  var successFlag = false;","  var failIds = [];","","  logger.debug('[%s] channelService sendMessageByGroup route: %s, msg: %j, groups: %j, opts: %j', app.serverId, route, msg, groups, opts);","  if(count === 0) {","    // group is empty","    utils.invokeCallback(cb);","    return;","  }","","  var latch = countDownLatch.createCountDownLatch(count, function() {","    if(!successFlag) {","      utils.invokeCallback(cb, new Error('all uids push message fail'));","      return;","    }","    utils.invokeCallback(cb, null, failIds);","  });","","  var rpcCB = function(serverId) {","    return function(err, fails) {","      if(err) {","        logger.error('[pushMessage] fail to dispatch msg to serverId: ' + serverId + ', err:' + err.stack);","        latch.done();","        return;","      }","      if(fails) {","        failIds = failIds.concat(fails);","      }","      successFlag = true;","      latch.done();","    };","  };","","  opts = {type: 'push', userOptions: opts || {}};","  // for compatiblity","  opts.isPush = true;","  ","  var sendMessage = function(sid) {","    return (function() {","      if(sid === app.serverId) {","        channelService.channelRemote[method](route, msg, groups[sid], opts, rpcCB(sid));","      } else {","        app.rpcInvoke(sid, {namespace: namespace, service: service,","          method: method, args: [route, msg, groups[sid], opts]}, rpcCB(sid));","      }","    })();","  };","","  var group;","  for(var sid in groups) {","    group = groups[sid];","    if(group && group.length > 0) {","      sendMessage(sid);","    } else {","      // empty group","      process.nextTick(rpcCB(sid));","    }","  }","};","","var restoreChannel = function(self, cb) {","  if(!self.store) {","    utils.invokeCallback(cb);","    return;","  } else {","    loadAllFromStore(self, genKey(self), function(err, list) {","      if(!!err) {","        utils.invokeCallback(cb, err);","        return;","      } else {","        if(!list.length || !Array.isArray(list)) {","          utils.invokeCallback(cb);","          return;","        }","        var load = function(key) {","          return (function() {","            loadAllFromStore(self, key, function(err, items) {","              for(var j=0; j<items.length; j++) {","                var array = items[j].split(':');","                var sid = array[0];","                var uid = array[1];","                var channel = self.channels[name];","                var res = add(uid, sid, channel.groups);","                if(res) {","                  channel.records[uid] = {sid: sid, uid: uid};","                }","              }","            });","          })();","        };","","       for(var i=0; i<list.length; i++) {","        var name = list[i].slice(genKey(self).length + 1);","        self.channels[name] = new Channel(name, self);","        load(list[i]);","      }","      utils.invokeCallback(cb);","    }","  });","}","};","","var addToStore = function(self, key, value) {","  if(!!self.store) {","    self.store.add(key, value, function(err) {","      if(!!err) {","        logger.error('add key: %s value: %s to store, with err: %j', key, value, err.stack);","      }","    });","  }","};","","var removeFromStore = function(self, key, value) {","  if(!!self.store) {","    self.store.remove(key, value, function(err) {","      if(!!err) {","        logger.error('remove key: %s value: %s from store, with err: %j', key, value, err.stack);","      }","    });","  }","};","","var loadAllFromStore = function(self, key, cb) {","  if(!!self.store) {","    self.store.load(key, function(err, list) {","      if(!!err) {","        logger.error('load key: %s from store, with err: %j', key, err.stack);","        utils.invokeCallback(cb, err);","      } else {","        utils.invokeCallback(cb, null, list);","      }","    });","  }","};","","var removeAllFromStore = function(self, key) {","  if(!!self.store) {","    self.store.removeAll(key, function(err) {","      if(!!err) {","        logger.error('remove key: %s all members from store, with err: %j', key, err.stack);","      }","    });","  }","};","","var genKey = function(self, name) {","  if(!!name) {","    return self.prefix + ':' + self.app.serverId + ':' + name;","  } else {","    return self.prefix + ':' + self.app.serverId;","  }","};","","var genValue = function(sid, uid) {","  return sid + ':' + uid;","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"9":1,"10":1,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"31":1,"34":1,"35":0,"46":1,"47":0,"48":0,"51":0,"52":0,"53":0,"54":0,"65":1,"66":0,"67":0,"68":0,"69":0,"71":0,"80":1,"81":0,"82":0,"83":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"106":0,"107":0,"108":0,"111":0,"112":0,"113":0,"115":0,"116":0,"117":0,"118":0,"121":0,"136":1,"137":0,"138":0,"139":0,"140":0,"141":0,"143":0,"145":0,"146":0,"149":0,"150":0,"152":0,"153":0,"154":0,"155":0,"157":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"167":0,"168":0,"172":0,"173":0,"174":0,"175":0,"176":0,"178":0,"184":0,"187":0,"188":0,"189":0,"190":0,"193":0,"194":0,"205":1,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"220":1,"221":0,"222":0,"224":0,"225":0,"226":0,"227":0,"229":0,"230":0,"241":1,"242":0,"243":0,"245":0,"246":0,"247":0,"248":0,"250":0,"251":0,"252":0,"253":0,"255":0,"263":1,"265":0,"275":1,"276":0,"277":0,"278":0,"279":0,"280":0,"281":0,"284":0,"293":1,"294":0,"300":1,"301":0,"302":0,"313":1,"314":0,"315":0,"316":0,"319":0,"320":0,"321":0,"322":0,"323":0,"326":0,"327":0,"328":0,"331":0,"341":1,"342":0,"343":0,"344":0,"347":0,"348":0,"349":0,"350":0,"353":0,"354":0,"360":1,"361":0,"362":0,"365":0,"366":0,"367":0,"368":0,"372":0,"386":1,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0,"393":0,"395":0,"396":0,"398":0,"399":0,"402":0,"403":0,"404":0,"405":0,"407":0,"410":0,"411":0,"412":0,"413":0,"414":0,"415":0,"417":0,"418":0,"420":0,"421":0,"425":0,"427":0,"429":0,"430":0,"431":0,"432":0,"434":0,"440":0,"441":0,"442":0,"443":0,"444":0,"447":0,"452":1,"453":0,"454":0,"455":0,"457":0,"458":0,"459":0,"460":0,"462":0,"463":0,"464":0,"466":0,"467":0,"468":0,"469":0,"470":0,"471":0,"472":0,"473":0,"474":0,"475":0,"476":0,"483":0,"484":0,"485":0,"486":0,"488":0,"494":1,"495":0,"496":0,"497":0,"498":0,"504":1,"505":0,"506":0,"507":0,"508":0,"514":1,"515":0,"516":0,"517":0,"518":0,"519":0,"521":0,"527":1,"528":0,"529":0,"530":0,"531":0,"537":1,"538":0,"539":0,"541":0,"545":1,"546":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/countDownLatch.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/countDownLatch.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":21},"end":{"line":6,"column":47}}},"2":{"name":"(anonymous_2)","line":11,"loc":{"start":{"line":11,"column":30},"end":{"line":11,"column":41}}},"3":{"name":"(anonymous_3)","line":22,"loc":{"start":{"line":22,"column":32},"end":{"line":22,"column":43}}},"4":{"name":"(anonymous_4)","line":45,"loc":{"start":{"line":45,"column":27},"end":{"line":45,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":25}},"2":{"start":{"line":6,"column":0},"end":{"line":15,"column":2}},"3":{"start":{"line":7,"column":2},"end":{"line":7,"column":21}},"4":{"start":{"line":8,"column":2},"end":{"line":8,"column":15}},"5":{"start":{"line":9,"column":2},"end":{"line":9,"column":18}},"6":{"start":{"line":10,"column":2},"end":{"line":14,"column":3}},"7":{"start":{"line":11,"column":4},"end":{"line":13,"column":21}},"8":{"start":{"line":12,"column":6},"end":{"line":12,"column":20}},"9":{"start":{"line":22,"column":0},"end":{"line":34,"column":2}},"10":{"start":{"line":23,"column":2},"end":{"line":25,"column":3}},"11":{"start":{"line":24,"column":4},"end":{"line":24,"column":38}},"12":{"start":{"line":27,"column":2},"end":{"line":27,"column":15}},"13":{"start":{"line":28,"column":2},"end":{"line":33,"column":3}},"14":{"start":{"line":29,"column":4},"end":{"line":31,"column":5}},"15":{"start":{"line":30,"column":6},"end":{"line":30,"column":33}},"16":{"start":{"line":32,"column":4},"end":{"line":32,"column":14}},"17":{"start":{"line":45,"column":0},"end":{"line":60,"column":2}},"18":{"start":{"line":46,"column":2},"end":{"line":48,"column":3}},"19":{"start":{"line":47,"column":4},"end":{"line":47,"column":49}},"20":{"start":{"line":50,"column":2},"end":{"line":53,"column":3}},"21":{"start":{"line":51,"column":4},"end":{"line":51,"column":14}},"22":{"start":{"line":52,"column":4},"end":{"line":52,"column":14}},"23":{"start":{"line":55,"column":2},"end":{"line":57,"column":3}},"24":{"start":{"line":56,"column":4},"end":{"line":56,"column":48}},"25":{"start":{"line":59,"column":2},"end":{"line":59,"column":45}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":2},"end":{"line":10,"column":2}},{"start":{"line":10,"column":2},"end":{"line":10,"column":2}}]},"2":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":2},"end":{"line":23,"column":2}},{"start":{"line":23,"column":2},"end":{"line":23,"column":2}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":2},"end":{"line":28,"column":2}},{"start":{"line":28,"column":2},"end":{"line":28,"column":2}}]},"4":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":4}},{"start":{"line":29,"column":4},"end":{"line":29,"column":4}}]},"5":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":2},"end":{"line":46,"column":2}},{"start":{"line":46,"column":2},"end":{"line":46,"column":2}}]},"6":{"line":46,"type":"binary-expr","locations":[{"start":{"line":46,"column":5},"end":{"line":46,"column":11}},{"start":{"line":46,"column":15},"end":{"line":46,"column":25}}]},"7":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":50,"column":2}},{"start":{"line":50,"column":2},"end":{"line":50,"column":2}}]},"8":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":6},"end":{"line":50,"column":9}},{"start":{"line":50,"column":13},"end":{"line":50,"column":39}}]},"9":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":2},"end":{"line":55,"column":2}},{"start":{"line":55,"column":2},"end":{"line":55,"column":2}}]}},"code":["var exp = module.exports;","","/**"," * Count down to zero or timeout and invoke cb finally."," */","var CountDownLatch = function(count, opts, cb) {","  this.count = count;","  this.cb = cb;","  var self = this;","  if (opts.timeout) {","    this.timerId = setTimeout(function() {","      self.cb(true);","    }, opts.timeout);","  }","};","","/**"," * Call when a task finish to count down."," *"," * @api public"," */","CountDownLatch.prototype.done = function() {","  if(this.count <= 0) {","    throw new Error('illegal state.');","  }","","  this.count--;","  if (this.count === 0) {","    if (this.timerId) {","      clearTimeout(this.timerId);","    }","    this.cb();","  }","};","","/**"," * Create a count down latch"," *"," * @param {Integer} count"," * @param {Object} opts, opts.timeout indicates timeout, optional param"," * @param {Function} cb, cb(isTimeout)"," *"," * @api public"," */","exp.createCountDownLatch = function(count, opts, cb) {","  if(!count || count <= 0) {","    throw new Error('count should be positive.');","  }","","  if (!cb && typeof opts === 'function') {","    cb = opts;","    opts = {};","  }","","  if(typeof cb !== 'function') {","    throw new Error('cb should be a function.');","  }","","  return new CountDownLatch(count, opts, cb);","};",""],"l":{"1":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"22":1,"23":0,"24":0,"27":0,"28":0,"29":0,"30":0,"32":0,"45":1,"46":0,"47":0,"50":0,"51":0,"52":0,"55":0,"56":0,"59":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/remote/frontend/channelRemote.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/remote/frontend/channelRemote.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":31}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":13},"end":{"line":12,"column":27}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":31},"end":{"line":25,"column":68}}},"4":{"name":"(anonymous_4)","line":48,"loc":{"start":{"line":48,"column":47},"end":{"line":48,"column":61}}},"5":{"name":"(anonymous_5)","line":61,"loc":{"start":{"line":61,"column":29},"end":{"line":61,"column":60}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":43}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":70}},"3":{"start":{"line":8,"column":0},"end":{"line":10,"column":2}},"4":{"start":{"line":9,"column":2},"end":{"line":9,"column":25}},"5":{"start":{"line":12,"column":0},"end":{"line":14,"column":2}},"6":{"start":{"line":13,"column":2},"end":{"line":13,"column":17}},"7":{"start":{"line":25,"column":0},"end":{"line":51,"column":2}},"8":{"start":{"line":26,"column":2},"end":{"line":31,"column":3}},"9":{"start":{"line":27,"column":4},"end":{"line":28,"column":20}},"10":{"start":{"line":29,"column":4},"end":{"line":29,"column":71}},"11":{"start":{"line":30,"column":4},"end":{"line":30,"column":11}},"12":{"start":{"line":33,"column":2},"end":{"line":33,"column":52}},"13":{"start":{"line":35,"column":2},"end":{"line":35,"column":54}},"14":{"start":{"line":36,"column":2},"end":{"line":36,"column":44}},"15":{"start":{"line":37,"column":2},"end":{"line":46,"column":3}},"16":{"start":{"line":38,"column":4},"end":{"line":38,"column":48}},"17":{"start":{"line":39,"column":4},"end":{"line":45,"column":5}},"18":{"start":{"line":40,"column":6},"end":{"line":40,"column":26}},"19":{"start":{"line":42,"column":6},"end":{"line":44,"column":7}},"20":{"start":{"line":43,"column":8},"end":{"line":43,"column":34}},"21":{"start":{"line":47,"column":2},"end":{"line":47,"column":99}},"22":{"start":{"line":48,"column":2},"end":{"line":50,"column":5}},"23":{"start":{"line":49,"column":4},"end":{"line":49,"column":41}},"24":{"start":{"line":61,"column":0},"end":{"line":65,"column":2}},"25":{"start":{"line":62,"column":2},"end":{"line":62,"column":52}},"26":{"start":{"line":64,"column":2},"end":{"line":64,"column":51}}},"branchMap":{"1":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":26,"column":2}},{"start":{"line":26,"column":2},"end":{"line":26,"column":2}}]},"2":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]}},"code":["/**"," * Remote channel service for frontend server."," * Receive push request from backend servers and push it to clients."," */","var utils = require('../../../util/utils');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","module.exports = function(app) {","  return new Remote(app);","};","","var Remote = function(app) {","  this.app = app;","};","","/**"," * Push message to client by uids."," *"," * @param  {String}   route route string of message"," * @param  {Object}   msg   message"," * @param  {Array}    uids  user ids that would receive the message"," * @param  {Object}   opts  push options"," * @param  {Function} cb    callback function"," */","Remote.prototype.pushMessage = function(route, msg, uids, opts, cb) {","  if(!msg){","    logger.error('Can not send empty message! route : %j, compressed msg : %j',","        route, msg);","    utils.invokeCallback(cb, new Error('can not send empty message.'));","    return;","  }","  ","  var connector = this.app.components.__connector__;","","  var sessionService = this.app.get('sessionService');","  var fails = [], sids = [], sessions, j, k;","  for(var i=0, l=uids.length; i<l; i++) {","    sessions = sessionService.getByUid(uids[i]);","    if(!sessions) {","      fails.push(uids[i]);","    } else {","      for(j=0, k=sessions.length; j<k; j++) {","        sids.push(sessions[j].id);","      }","    }","  }","  logger.debug('[%s] pushMessage uids: %j, msg: %j, sids: %j', this.app.serverId, uids, msg, sids);","  connector.send(null, route, msg, sids, opts, function(err) {","    utils.invokeCallback(cb, err, fails);","  });","};","","/**"," * Broadcast to all the client connectd with current frontend server."," *"," * @param  {String}    route  route string"," * @param  {Object}    msg    message"," * @param  {Boolean}   opts   broadcast options. "," * @param  {Function}  cb     callback function"," */","Remote.prototype.broadcast = function(route, msg, opts, cb) {","  var connector = this.app.components.__connector__;","","  connector.send(null, route, msg, null, opts, cb);","};",""],"l":{"5":1,"6":1,"8":1,"9":0,"12":1,"13":0,"25":1,"26":0,"27":0,"29":0,"30":0,"33":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"42":0,"43":0,"47":0,"48":0,"49":0,"61":1,"62":0,"64":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/connection.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/connection.js","s":{"1":1,"2":1,"3":0,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":17},"end":{"line":6,"column":31}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":16},"end":{"line":10,"column":30}}},"3":{"name":"(anonymous_3)","line":17,"loc":{"start":{"line":17,"column":15},"end":{"line":17,"column":27}}},"4":{"name":"(anonymous_4)","line":18,"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":23}}},"5":{"name":"(anonymous_5)","line":19,"loc":{"start":{"line":19,"column":17},"end":{"line":19,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":71}},"2":{"start":{"line":6,"column":0},"end":{"line":8,"column":2}},"3":{"start":{"line":7,"column":2},"end":{"line":7,"column":28}},"4":{"start":{"line":10,"column":0},"end":{"line":33,"column":2}},"5":{"start":{"line":11,"column":2},"end":{"line":11,"column":17}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":44}},"7":{"start":{"line":15,"column":2},"end":{"line":15,"column":26}},"8":{"start":{"line":17,"column":2},"end":{"line":23,"column":4}},"9":{"start":{"line":18,"column":4},"end":{"line":22,"column":9}},"10":{"start":{"line":19,"column":10},"end":{"line":21,"column":12}},"11":{"start":{"line":20,"column":12},"end":{"line":20,"column":66}},"12":{"start":{"line":25,"column":2},"end":{"line":32,"column":3}},"13":{"start":{"line":26,"column":4},"end":{"line":31,"column":5}},"14":{"start":{"line":27,"column":6},"end":{"line":27,"column":31}},"15":{"start":{"line":28,"column":6},"end":{"line":30,"column":7}},"16":{"start":{"line":29,"column":8},"end":{"line":29,"column":28}},"17":{"start":{"line":35,"column":0},"end":{"line":35,"column":44}}},"branchMap":{"1":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":4},"end":{"line":26,"column":4}},{"start":{"line":26,"column":4},"end":{"line":26,"column":4}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":7},"end":{"line":26,"column":20}},{"start":{"line":26,"column":24},"end":{"line":26,"column":36}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":6},"end":{"line":28,"column":6}},{"start":{"line":28,"column":6},"end":{"line":28,"column":6}}]}},"code":["var ConnectionService = require('../common/service/connectionService');","","/**"," * Connection component for statistics connection status of frontend servers"," */","module.exports = function(app) {","  return new Component(app);","};","","var Component = function(app) {","  this.app = app;","  this.service = new ConnectionService(app);","","  // proxy the service methods except the lifecycle interfaces of component","  var method, self = this;","","  var getFun = function(m) {","    return (function() {","          return function() {","            return self.service[m].apply(self.service, arguments);","          };","    })();","  };","","  for(var m in this.service) {","    if(m !== 'start' && m !== 'stop') {","      method = this.service[m];","      if(typeof method === 'function') {","        this[m] = getFun(m);","      }","    }","  }","};","","Component.prototype.name = '__connection__';",""],"l":{"1":1,"6":1,"7":0,"10":1,"11":0,"12":0,"15":0,"17":0,"18":0,"19":0,"20":0,"25":0,"26":0,"27":0,"28":0,"29":0,"35":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/connectionService.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/connectionService.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":1,"23":0,"24":0,"25":0,"26":1,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":14},"end":{"line":5,"column":28}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":21},"end":{"line":23,"column":41}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":21},"end":{"line":36,"column":41}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":30},"end":{"line":52,"column":41}}},"5":{"name":"(anonymous_5)","line":61,"loc":{"start":{"line":61,"column":24},"end":{"line":61,"column":38}}},"6":{"name":"(anonymous_6)","line":73,"loc":{"start":{"line":73,"column":30},"end":{"line":73,"column":44}}},"7":{"name":"(anonymous_7)","line":87,"loc":{"start":{"line":87,"column":24},"end":{"line":87,"column":35}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":10,"column":2}},"2":{"start":{"line":6,"column":2},"end":{"line":6,"column":36}},"3":{"start":{"line":7,"column":2},"end":{"line":7,"column":21}},"4":{"start":{"line":8,"column":2},"end":{"line":8,"column":24}},"5":{"start":{"line":9,"column":2},"end":{"line":9,"column":20}},"6":{"start":{"line":12,"column":0},"end":{"line":12,"column":25}},"7":{"start":{"line":14,"column":0},"end":{"line":14,"column":28}},"8":{"start":{"line":23,"column":0},"end":{"line":29,"column":2}},"9":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"10":{"start":{"line":25,"column":4},"end":{"line":25,"column":24}},"11":{"start":{"line":27,"column":2},"end":{"line":27,"column":17}},"12":{"start":{"line":28,"column":2},"end":{"line":28,"column":27}},"13":{"start":{"line":36,"column":0},"end":{"line":47,"column":2}},"14":{"start":{"line":37,"column":4},"end":{"line":37,"column":33}},"15":{"start":{"line":38,"column":4},"end":{"line":40,"column":5}},"16":{"start":{"line":39,"column":8},"end":{"line":39,"column":15}},"17":{"start":{"line":42,"column":4},"end":{"line":46,"column":5}},"18":{"start":{"line":43,"column":8},"end":{"line":45,"column":9}},"19":{"start":{"line":44,"column":12},"end":{"line":44,"column":30}},"20":{"start":{"line":52,"column":0},"end":{"line":54,"column":2}},"21":{"start":{"line":53,"column":2},"end":{"line":53,"column":19}},"22":{"start":{"line":61,"column":0},"end":{"line":66,"column":2}},"23":{"start":{"line":62,"column":2},"end":{"line":64,"column":3}},"24":{"start":{"line":63,"column":4},"end":{"line":63,"column":24}},"25":{"start":{"line":65,"column":2},"end":{"line":65,"column":27}},"26":{"start":{"line":73,"column":0},"end":{"line":80,"column":2}},"27":{"start":{"line":74,"column":2},"end":{"line":76,"column":3}},"28":{"start":{"line":75,"column":4},"end":{"line":75,"column":21}},"29":{"start":{"line":77,"column":2},"end":{"line":79,"column":3}},"30":{"start":{"line":78,"column":4},"end":{"line":78,"column":32}},"31":{"start":{"line":87,"column":0},"end":{"line":94,"column":2}},"32":{"start":{"line":88,"column":2},"end":{"line":88,"column":16}},"33":{"start":{"line":89,"column":2},"end":{"line":91,"column":3}},"34":{"start":{"line":90,"column":4},"end":{"line":90,"column":33}},"35":{"start":{"line":93,"column":2},"end":{"line":93,"column":119}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":24,"column":2}},{"start":{"line":24,"column":2},"end":{"line":24,"column":2}}]},"2":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":4}},{"start":{"line":38,"column":4},"end":{"line":38,"column":4}}]},"3":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":8},"end":{"line":43,"column":8}},{"start":{"line":43,"column":8},"end":{"line":43,"column":8}}]},"4":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":12},"end":{"line":43,"column":34}},{"start":{"line":43,"column":38},"end":{"line":43,"column":67}}]},"5":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":2},"end":{"line":62,"column":2}},{"start":{"line":62,"column":2},"end":{"line":62,"column":2}}]},"6":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":2},"end":{"line":74,"column":2}},{"start":{"line":74,"column":2},"end":{"line":74,"column":2}}]},"7":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":2},"end":{"line":77,"column":2}},{"start":{"line":77,"column":2},"end":{"line":77,"column":2}}]}},"code":["/**"," * connection statistics service"," * record connection, login count and list"," */","var Service = function(app) {","  this.serverId = app.getServerId();","  this.connCount = 0;","  this.loginedCount = 0;","  this.logined = {};","};","","module.exports = Service;","","var pro = Service.prototype;","","","/**"," * Add logined user."," *"," * @param uid {String} user id"," * @param info {Object} record for logined user"," */","pro.addLoginedUser = function(uid, info) {","  if(!this.logined[uid]) {","    this.loginedCount++;","  }","  info.uid = uid;","  this.logined[uid] = info;","};","","/**"," * Update user info."," * @param uid {String} user id"," * @param info {Object} info for update."," */","pro.updateUserInfo = function(uid, info) {","    var user = this.logined[uid];","    if (!user) {","        return;","    }","","    for (var p in info) {","        if (info.hasOwnProperty(p) && typeof info[p] !== 'function') {","            user[p] = info[p];","        }","    }","};","","/**"," * Increase connection count"," */","pro.increaseConnectionCount = function() {","  this.connCount++;","};","","/**"," * Remote logined user"," *"," * @param uid {String} user id"," */","pro.removeLoginedUser = function(uid) {","  if(!!this.logined[uid]) {","    this.loginedCount--;","  }","  delete this.logined[uid];","};","","/**"," * Decrease connection count"," *"," * @param uid {String} uid"," */","pro.decreaseConnectionCount = function(uid) {","  if(this.connCount) {","    this.connCount--;","  }","  if(!!uid) {","    this.removeLoginedUser(uid);","  }","};","","/**"," * Get statistics info"," *"," * @return {Object} statistics info"," */","pro.getStatisticsInfo = function() {","  var list = [];","  for(var uid in this.logined) {","    list.push(this.logined[uid]);","  }","","  return {serverId: this.serverId, totalConnCount: this.connCount, loginedCount: this.loginedCount, loginedList: list};","};",""],"l":{"5":1,"6":0,"7":0,"8":0,"9":0,"12":1,"14":1,"23":1,"24":0,"25":0,"27":0,"28":0,"36":1,"37":0,"38":0,"39":0,"42":0,"43":0,"44":0,"52":1,"53":0,"61":1,"62":0,"63":0,"65":0,"73":1,"74":0,"75":0,"77":0,"78":0,"87":1,"88":0,"89":0,"90":0,"93":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/connector.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/connector.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":1,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":1,"78":0,"79":0,"80":0,"81":0,"82":1,"83":0,"84":0,"85":0,"86":0,"87":1,"88":0,"89":1,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":1,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":1,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":1,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":1,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":1,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":1,"213":0,"214":0,"215":1,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":1,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":1,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":37}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":16},"end":{"line":19,"column":36}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":12},"end":{"line":50,"column":25}}},"4":{"name":"(anonymous_4)","line":57,"loc":{"start":{"line":57,"column":21},"end":{"line":57,"column":32}}},"5":{"name":"(anonymous_5)","line":64,"loc":{"start":{"line":64,"column":21},"end":{"line":64,"column":32}}},"6":{"name":"(anonymous_6)","line":73,"loc":{"start":{"line":73,"column":17},"end":{"line":73,"column":30}}},"7":{"name":"(anonymous_7)","line":78,"loc":{"start":{"line":78,"column":11},"end":{"line":78,"column":31}}},"8":{"name":"(anonymous_8)","line":88,"loc":{"start":{"line":88,"column":11},"end":{"line":88,"column":56}}},"9":{"name":"(anonymous_9)","line":106,"loc":{"start":{"line":106,"column":16},"end":{"line":106,"column":61}}},"10":{"name":"(anonymous_10)","line":112,"loc":{"start":{"line":112,"column":35},"end":{"line":112,"column":60}}},"11":{"name":"(anonymous_11)","line":122,"loc":{"start":{"line":122,"column":45},"end":{"line":122,"column":70}}},"12":{"name":"(anonymous_12)","line":133,"loc":{"start":{"line":133,"column":13},"end":{"line":133,"column":59}}},"13":{"name":"(anonymous_13)","line":135,"loc":{"start":{"line":135,"column":21},"end":{"line":135,"column":32}}},"14":{"name":"(anonymous_14)","line":144,"loc":{"start":{"line":144,"column":16},"end":{"line":144,"column":34}}},"15":{"name":"(anonymous_15)","line":151,"loc":{"start":{"line":151,"column":16},"end":{"line":151,"column":29}}},"16":{"name":"(anonymous_16)","line":155,"loc":{"start":{"line":155,"column":19},"end":{"line":155,"column":39}}},"17":{"name":"(anonymous_17)","line":169,"loc":{"start":{"line":169,"column":26},"end":{"line":169,"column":46}}},"18":{"name":"(anonymous_18)","line":175,"loc":{"start":{"line":175,"column":17},"end":{"line":175,"column":38}}},"19":{"name":"(anonymous_19)","line":181,"loc":{"start":{"line":181,"column":14},"end":{"line":181,"column":29}}},"20":{"name":"(anonymous_20)","line":198,"loc":{"start":{"line":198,"column":22},"end":{"line":198,"column":42}}},"21":{"name":"(anonymous_21)","line":221,"loc":{"start":{"line":221,"column":17},"end":{"line":221,"column":40}}},"22":{"name":"(anonymous_22)","line":238,"loc":{"start":{"line":238,"column":26},"end":{"line":238,"column":37}}},"23":{"name":"(anonymous_23)","line":248,"loc":{"start":{"line":248,"column":21},"end":{"line":248,"column":32}}},"24":{"name":"(anonymous_24)","line":259,"loc":{"start":{"line":259,"column":23},"end":{"line":259,"column":37}}},"25":{"name":"(anonymous_25)","line":288,"loc":{"start":{"line":288,"column":25},"end":{"line":288,"column":62}}},"26":{"name":"(anonymous_26)","line":290,"loc":{"start":{"line":290,"column":30},"end":{"line":290,"column":50}}},"27":{"name":"(anonymous_27)","line":299,"loc":{"start":{"line":299,"column":39},"end":{"line":299,"column":59}}},"28":{"name":"(anonymous_28)","line":310,"loc":{"start":{"line":310,"column":22},"end":{"line":310,"column":52}}},"29":{"name":"(anonymous_29)","line":331,"loc":{"start":{"line":331,"column":17},"end":{"line":331,"column":40}}},"30":{"name":"(anonymous_30)","line":346,"loc":{"start":{"line":346,"column":21},"end":{"line":346,"column":35}}},"31":{"name":"(anonymous_31)","line":359,"loc":{"start":{"line":359,"column":23},"end":{"line":359,"column":37}}},"32":{"name":"(anonymous_32)","line":369,"loc":{"start":{"line":369,"column":21},"end":{"line":369,"column":52}}},"33":{"name":"(anonymous_33)","line":374,"loc":{"start":{"line":374,"column":20},"end":{"line":374,"column":49}}},"34":{"name":"(anonymous_34)","line":381,"loc":{"start":{"line":381,"column":61},"end":{"line":381,"column":87}}},"35":{"name":"(anonymous_35)","line":399,"loc":{"start":{"line":399,"column":6},"end":{"line":399,"column":17}}},"36":{"name":"(anonymous_36)","line":406,"loc":{"start":{"line":406,"column":22},"end":{"line":406,"column":38}}},"37":{"name":"(anonymous_37)","line":417,"loc":{"start":{"line":417,"column":20},"end":{"line":417,"column":49}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":70}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":59}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":34}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":36}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":39}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":37}},"7":{"start":{"line":8,"column":0},"end":{"line":10,"column":2}},"8":{"start":{"line":9,"column":2},"end":{"line":9,"column":34}},"9":{"start":{"line":19,"column":0},"end":{"line":44,"column":2}},"10":{"start":{"line":20,"column":2},"end":{"line":20,"column":20}},"11":{"start":{"line":21,"column":2},"end":{"line":21,"column":17}},"12":{"start":{"line":22,"column":2},"end":{"line":22,"column":43}},"13":{"start":{"line":23,"column":2},"end":{"line":23,"column":28}},"14":{"start":{"line":24,"column":2},"end":{"line":24,"column":28}},"15":{"start":{"line":25,"column":2},"end":{"line":25,"column":34}},"16":{"start":{"line":26,"column":2},"end":{"line":26,"column":42}},"17":{"start":{"line":27,"column":2},"end":{"line":27,"column":42}},"18":{"start":{"line":28,"column":2},"end":{"line":28,"column":40}},"19":{"start":{"line":29,"column":2},"end":{"line":29,"column":17}},"20":{"start":{"line":30,"column":2},"end":{"line":30,"column":22}},"21":{"start":{"line":32,"column":2},"end":{"line":34,"column":3}},"22":{"start":{"line":33,"column":4},"end":{"line":33,"column":61}},"23":{"start":{"line":36,"column":2},"end":{"line":38,"column":3}},"24":{"start":{"line":37,"column":4},"end":{"line":37,"column":57}},"25":{"start":{"line":41,"column":2},"end":{"line":41,"column":21}},"26":{"start":{"line":42,"column":2},"end":{"line":42,"column":22}},"27":{"start":{"line":43,"column":2},"end":{"line":43,"column":25}},"28":{"start":{"line":46,"column":0},"end":{"line":46,"column":30}},"29":{"start":{"line":48,"column":0},"end":{"line":48,"column":27}},"30":{"start":{"line":50,"column":0},"end":{"line":71,"column":2}},"31":{"start":{"line":51,"column":2},"end":{"line":51,"column":47}},"32":{"start":{"line":52,"column":2},"end":{"line":52,"column":49}},"33":{"start":{"line":53,"column":2},"end":{"line":53,"column":55}},"34":{"start":{"line":56,"column":2},"end":{"line":61,"column":3}},"35":{"start":{"line":57,"column":4},"end":{"line":59,"column":7}},"36":{"start":{"line":58,"column":6},"end":{"line":58,"column":110}},"37":{"start":{"line":60,"column":4},"end":{"line":60,"column":11}},"38":{"start":{"line":63,"column":2},"end":{"line":68,"column":3}},"39":{"start":{"line":64,"column":4},"end":{"line":66,"column":7}},"40":{"start":{"line":65,"column":6},"end":{"line":65,"column":111}},"41":{"start":{"line":67,"column":4},"end":{"line":67,"column":11}},"42":{"start":{"line":70,"column":2},"end":{"line":70,"column":23}},"43":{"start":{"line":73,"column":0},"end":{"line":76,"column":2}},"44":{"start":{"line":74,"column":2},"end":{"line":74,"column":27}},"45":{"start":{"line":75,"column":2},"end":{"line":75,"column":69}},"46":{"start":{"line":78,"column":0},"end":{"line":86,"column":2}},"47":{"start":{"line":79,"column":2},"end":{"line":85,"column":3}},"48":{"start":{"line":80,"column":4},"end":{"line":80,"column":35}},"49":{"start":{"line":81,"column":4},"end":{"line":81,"column":26}},"50":{"start":{"line":82,"column":4},"end":{"line":82,"column":11}},"51":{"start":{"line":84,"column":4},"end":{"line":84,"column":25}},"52":{"start":{"line":88,"column":0},"end":{"line":104,"column":2}},"53":{"start":{"line":89,"column":2},"end":{"line":89,"column":142}},"54":{"start":{"line":90,"column":2},"end":{"line":92,"column":3}},"55":{"start":{"line":91,"column":4},"end":{"line":91,"column":62}},"56":{"start":{"line":94,"column":2},"end":{"line":94,"column":17}},"57":{"start":{"line":95,"column":2},"end":{"line":101,"column":3}},"58":{"start":{"line":97,"column":4},"end":{"line":97,"column":53}},"59":{"start":{"line":98,"column":9},"end":{"line":101,"column":3}},"60":{"start":{"line":100,"column":4},"end":{"line":100,"column":52}},"61":{"start":{"line":103,"column":2},"end":{"line":103,"column":51}},"62":{"start":{"line":106,"column":0},"end":{"line":131,"column":1}},"63":{"start":{"line":107,"column":2},"end":{"line":107,"column":17}},"64":{"start":{"line":108,"column":2},"end":{"line":108,"column":18}},"65":{"start":{"line":110,"column":2},"end":{"line":130,"column":3}},"66":{"start":{"line":112,"column":4},"end":{"line":119,"column":7}},"67":{"start":{"line":113,"column":6},"end":{"line":115,"column":7}},"68":{"start":{"line":114,"column":8},"end":{"line":114,"column":23}},"69":{"start":{"line":117,"column":6},"end":{"line":117,"column":23}},"70":{"start":{"line":118,"column":6},"end":{"line":118,"column":55}},"71":{"start":{"line":120,"column":9},"end":{"line":130,"column":3}},"72":{"start":{"line":122,"column":4},"end":{"line":129,"column":7}},"73":{"start":{"line":123,"column":6},"end":{"line":125,"column":7}},"74":{"start":{"line":124,"column":8},"end":{"line":124,"column":23}},"75":{"start":{"line":127,"column":6},"end":{"line":127,"column":23}},"76":{"start":{"line":128,"column":6},"end":{"line":128,"column":55}},"77":{"start":{"line":133,"column":0},"end":{"line":142,"column":1}},"78":{"start":{"line":134,"column":2},"end":{"line":138,"column":3}},"79":{"start":{"line":135,"column":4},"end":{"line":137,"column":7}},"80":{"start":{"line":136,"column":6},"end":{"line":136,"column":85}},"81":{"start":{"line":140,"column":2},"end":{"line":141,"column":21}},"82":{"start":{"line":144,"column":0},"end":{"line":149,"column":2}},"83":{"start":{"line":145,"column":2},"end":{"line":145,"column":29}},"84":{"start":{"line":146,"column":2},"end":{"line":146,"column":47}},"85":{"start":{"line":147,"column":2},"end":{"line":147,"column":23}},"86":{"start":{"line":148,"column":2},"end":{"line":148,"column":25}},"87":{"start":{"line":151,"column":0},"end":{"line":153,"column":2}},"88":{"start":{"line":152,"column":2},"end":{"line":152,"column":23}},"89":{"start":{"line":155,"column":0},"end":{"line":167,"column":2}},"90":{"start":{"line":156,"column":2},"end":{"line":156,"column":33}},"91":{"start":{"line":157,"column":2},"end":{"line":159,"column":3}},"92":{"start":{"line":158,"column":4},"end":{"line":158,"column":42}},"93":{"start":{"line":161,"column":2},"end":{"line":163,"column":3}},"94":{"start":{"line":162,"column":4},"end":{"line":162,"column":21}},"95":{"start":{"line":165,"column":2},"end":{"line":165,"column":37}},"96":{"start":{"line":166,"column":2},"end":{"line":166,"column":63}},"97":{"start":{"line":169,"column":0},"end":{"line":173,"column":2}},"98":{"start":{"line":170,"column":2},"end":{"line":170,"column":63}},"99":{"start":{"line":171,"column":2},"end":{"line":171,"column":37}},"100":{"start":{"line":172,"column":2},"end":{"line":172,"column":74}},"101":{"start":{"line":175,"column":0},"end":{"line":219,"column":2}},"102":{"start":{"line":176,"column":2},"end":{"line":178,"column":3}},"103":{"start":{"line":177,"column":4},"end":{"line":177,"column":28}},"104":{"start":{"line":180,"column":2},"end":{"line":180,"column":35}},"105":{"start":{"line":181,"column":2},"end":{"line":190,"column":4}},"106":{"start":{"line":182,"column":4},"end":{"line":188,"column":5}},"107":{"start":{"line":183,"column":6},"end":{"line":183,"column":42}},"108":{"start":{"line":184,"column":6},"end":{"line":187,"column":7}},"109":{"start":{"line":185,"column":8},"end":{"line":185,"column":28}},"110":{"start":{"line":186,"column":8},"end":{"line":186,"column":20}},"111":{"start":{"line":189,"column":4},"end":{"line":189,"column":17}},"112":{"start":{"line":192,"column":2},"end":{"line":194,"column":3}},"113":{"start":{"line":193,"column":4},"end":{"line":193,"column":11}},"114":{"start":{"line":196,"column":2},"end":{"line":218,"column":3}},"115":{"start":{"line":197,"column":4},"end":{"line":197,"column":20}},"116":{"start":{"line":198,"column":4},"end":{"line":215,"column":7}},"117":{"start":{"line":199,"column":6},"end":{"line":203,"column":7}},"118":{"start":{"line":200,"column":8},"end":{"line":200,"column":65}},"119":{"start":{"line":201,"column":8},"end":{"line":201,"column":47}},"120":{"start":{"line":202,"column":8},"end":{"line":202,"column":15}},"121":{"start":{"line":204,"column":6},"end":{"line":208,"column":7}},"122":{"start":{"line":205,"column":8},"end":{"line":205,"column":67}},"123":{"start":{"line":206,"column":8},"end":{"line":206,"column":47}},"124":{"start":{"line":207,"column":8},"end":{"line":207,"column":15}},"125":{"start":{"line":209,"column":6},"end":{"line":214,"column":7}},"126":{"start":{"line":210,"column":8},"end":{"line":210,"column":15}},"127":{"start":{"line":212,"column":8},"end":{"line":212,"column":47}},"128":{"start":{"line":213,"column":8},"end":{"line":213,"column":15}},"129":{"start":{"line":217,"column":4},"end":{"line":217,"column":43}},"130":{"start":{"line":221,"column":0},"end":{"line":286,"column":2}},"131":{"start":{"line":222,"column":2},"end":{"line":222,"column":42}},"132":{"start":{"line":223,"column":2},"end":{"line":223,"column":52}},"133":{"start":{"line":224,"column":2},"end":{"line":232,"column":3}},"134":{"start":{"line":225,"column":4},"end":{"line":225,"column":46}},"135":{"start":{"line":226,"column":4},"end":{"line":226,"column":60}},"136":{"start":{"line":227,"column":4},"end":{"line":231,"column":5}},"137":{"start":{"line":228,"column":6},"end":{"line":228,"column":100}},"138":{"start":{"line":229,"column":6},"end":{"line":229,"column":26}},"139":{"start":{"line":230,"column":6},"end":{"line":230,"column":13}},"140":{"start":{"line":235,"column":2},"end":{"line":235,"column":41}},"141":{"start":{"line":236,"column":2},"end":{"line":236,"column":21}},"142":{"start":{"line":238,"column":2},"end":{"line":246,"column":5}},"143":{"start":{"line":239,"column":4},"end":{"line":241,"column":5}},"144":{"start":{"line":240,"column":6},"end":{"line":240,"column":13}},"145":{"start":{"line":242,"column":4},"end":{"line":242,"column":18}},"146":{"start":{"line":243,"column":4},"end":{"line":245,"column":5}},"147":{"start":{"line":244,"column":6},"end":{"line":244,"column":59}},"148":{"start":{"line":248,"column":2},"end":{"line":256,"column":5}},"149":{"start":{"line":249,"column":4},"end":{"line":251,"column":5}},"150":{"start":{"line":250,"column":6},"end":{"line":250,"column":13}},"151":{"start":{"line":252,"column":4},"end":{"line":252,"column":18}},"152":{"start":{"line":253,"column":4},"end":{"line":255,"column":5}},"153":{"start":{"line":254,"column":6},"end":{"line":254,"column":59}},"154":{"start":{"line":259,"column":2},"end":{"line":285,"column":5}},"155":{"start":{"line":260,"column":4},"end":{"line":260,"column":19}},"156":{"start":{"line":261,"column":4},"end":{"line":263,"column":5}},"157":{"start":{"line":262,"column":6},"end":{"line":262,"column":60}},"158":{"start":{"line":265,"column":4},"end":{"line":269,"column":5}},"159":{"start":{"line":266,"column":6},"end":{"line":266,"column":39}},"160":{"start":{"line":267,"column":11},"end":{"line":269,"column":5}},"161":{"start":{"line":268,"column":6},"end":{"line":268,"column":48}},"162":{"start":{"line":270,"column":4},"end":{"line":273,"column":5}},"163":{"start":{"line":272,"column":6},"end":{"line":272,"column":13}},"164":{"start":{"line":276,"column":4},"end":{"line":282,"column":5}},"165":{"start":{"line":277,"column":6},"end":{"line":277,"column":56}},"166":{"start":{"line":278,"column":6},"end":{"line":281,"column":7}},"167":{"start":{"line":279,"column":8},"end":{"line":279,"column":70}},"168":{"start":{"line":280,"column":8},"end":{"line":280,"column":15}},"169":{"start":{"line":284,"column":4},"end":{"line":284,"column":39}},"170":{"start":{"line":288,"column":0},"end":{"line":308,"column":1}},"171":{"start":{"line":289,"column":2},"end":{"line":307,"column":3}},"172":{"start":{"line":290,"column":4},"end":{"line":297,"column":7}},"173":{"start":{"line":291,"column":6},"end":{"line":294,"column":7}},"174":{"start":{"line":292,"column":8},"end":{"line":292,"column":75}},"175":{"start":{"line":293,"column":8},"end":{"line":293,"column":15}},"176":{"start":{"line":296,"column":6},"end":{"line":296,"column":43}},"177":{"start":{"line":298,"column":9},"end":{"line":307,"column":3}},"178":{"start":{"line":299,"column":4},"end":{"line":306,"column":7}},"179":{"start":{"line":300,"column":6},"end":{"line":303,"column":7}},"180":{"start":{"line":301,"column":8},"end":{"line":301,"column":75}},"181":{"start":{"line":302,"column":8},"end":{"line":302,"column":15}},"182":{"start":{"line":305,"column":6},"end":{"line":305,"column":43}},"183":{"start":{"line":310,"column":0},"end":{"line":326,"column":1}},"184":{"start":{"line":311,"column":2},"end":{"line":314,"column":3}},"185":{"start":{"line":313,"column":4},"end":{"line":313,"column":11}},"186":{"start":{"line":317,"column":2},"end":{"line":323,"column":3}},"187":{"start":{"line":318,"column":4},"end":{"line":318,"column":54}},"188":{"start":{"line":319,"column":4},"end":{"line":322,"column":5}},"189":{"start":{"line":320,"column":6},"end":{"line":320,"column":68}},"190":{"start":{"line":321,"column":6},"end":{"line":321,"column":13}},"191":{"start":{"line":325,"column":2},"end":{"line":325,"column":37}},"192":{"start":{"line":331,"column":0},"end":{"line":367,"column":2}},"193":{"start":{"line":332,"column":2},"end":{"line":333,"column":20}},"194":{"start":{"line":334,"column":2},"end":{"line":334,"column":38}},"195":{"start":{"line":335,"column":2},"end":{"line":337,"column":3}},"196":{"start":{"line":336,"column":4},"end":{"line":336,"column":19}},"197":{"start":{"line":339,"column":2},"end":{"line":339,"column":64}},"198":{"start":{"line":340,"column":2},"end":{"line":340,"column":97}},"199":{"start":{"line":343,"column":2},"end":{"line":343,"column":56}},"200":{"start":{"line":344,"column":2},"end":{"line":344,"column":51}},"201":{"start":{"line":345,"column":2},"end":{"line":345,"column":55}},"202":{"start":{"line":346,"column":2},"end":{"line":357,"column":5}},"203":{"start":{"line":347,"column":4},"end":{"line":347,"column":78}},"204":{"start":{"line":349,"column":4},"end":{"line":355,"column":5}},"205":{"start":{"line":350,"column":6},"end":{"line":354,"column":9}},"206":{"start":{"line":356,"column":4},"end":{"line":356,"column":54}},"207":{"start":{"line":359,"column":2},"end":{"line":364,"column":5}},"208":{"start":{"line":360,"column":4},"end":{"line":362,"column":5}},"209":{"start":{"line":361,"column":6},"end":{"line":361,"column":45}},"210":{"start":{"line":363,"column":4},"end":{"line":363,"column":56}},"211":{"start":{"line":366,"column":2},"end":{"line":366,"column":17}},"212":{"start":{"line":369,"column":0},"end":{"line":372,"column":2}},"213":{"start":{"line":370,"column":2},"end":{"line":370,"column":43}},"214":{"start":{"line":371,"column":2},"end":{"line":371,"column":48}},"215":{"start":{"line":374,"column":0},"end":{"line":401,"column":2}},"216":{"start":{"line":375,"column":2},"end":{"line":375,"column":97}},"217":{"start":{"line":376,"column":2},"end":{"line":376,"column":40}},"218":{"start":{"line":377,"column":2},"end":{"line":380,"column":3}},"219":{"start":{"line":378,"column":4},"end":{"line":378,"column":64}},"220":{"start":{"line":379,"column":4},"end":{"line":379,"column":11}},"221":{"start":{"line":381,"column":2},"end":{"line":400,"column":5}},"222":{"start":{"line":382,"column":4},"end":{"line":385,"column":5}},"223":{"start":{"line":383,"column":6},"end":{"line":383,"column":64}},"224":{"start":{"line":384,"column":6},"end":{"line":384,"column":13}},"225":{"start":{"line":386,"column":4},"end":{"line":386,"column":33}},"226":{"start":{"line":386,"column":26},"end":{"line":386,"column":33}},"227":{"start":{"line":387,"column":4},"end":{"line":387,"column":25}},"228":{"start":{"line":387,"column":15},"end":{"line":387,"column":25}},"229":{"start":{"line":388,"column":4},"end":{"line":390,"column":5}},"230":{"start":{"line":389,"column":6},"end":{"line":389,"column":22}},"231":{"start":{"line":391,"column":4},"end":{"line":394,"column":6}},"232":{"start":{"line":396,"column":4},"end":{"line":396,"column":27}},"233":{"start":{"line":398,"column":4},"end":{"line":399,"column":21}},"234":{"start":{"line":406,"column":0},"end":{"line":415,"column":2}},"235":{"start":{"line":407,"column":2},"end":{"line":409,"column":3}},"236":{"start":{"line":408,"column":4},"end":{"line":408,"column":16}},"237":{"start":{"line":410,"column":2},"end":{"line":410,"column":31}},"238":{"start":{"line":411,"column":2},"end":{"line":413,"column":3}},"239":{"start":{"line":412,"column":4},"end":{"line":412,"column":16}},"240":{"start":{"line":414,"column":2},"end":{"line":414,"column":33}},"241":{"start":{"line":417,"column":0},"end":{"line":456,"column":2}},"242":{"start":{"line":418,"column":2},"end":{"line":418,"column":32}},"243":{"start":{"line":419,"column":2},"end":{"line":422,"column":3}},"244":{"start":{"line":420,"column":4},"end":{"line":420,"column":86}},"245":{"start":{"line":421,"column":4},"end":{"line":421,"column":17}},"246":{"start":{"line":424,"column":2},"end":{"line":424,"column":13}},"247":{"start":{"line":426,"column":2},"end":{"line":429,"column":3}},"248":{"start":{"line":427,"column":4},"end":{"line":427,"column":44}},"249":{"start":{"line":428,"column":4},"end":{"line":428,"column":17}},"250":{"start":{"line":431,"column":2},"end":{"line":442,"column":3}},"251":{"start":{"line":432,"column":4},"end":{"line":432,"column":40}},"252":{"start":{"line":433,"column":4},"end":{"line":439,"column":5}},"253":{"start":{"line":434,"column":6},"end":{"line":434,"column":35}},"254":{"start":{"line":435,"column":6},"end":{"line":435,"column":36}},"255":{"start":{"line":437,"column":6},"end":{"line":437,"column":77}},"256":{"start":{"line":438,"column":6},"end":{"line":438,"column":19}},"257":{"start":{"line":441,"column":4},"end":{"line":441,"column":35}},"258":{"start":{"line":444,"column":2},"end":{"line":447,"column":3}},"259":{"start":{"line":445,"column":4},"end":{"line":445,"column":88}},"260":{"start":{"line":446,"column":4},"end":{"line":446,"column":17}},"261":{"start":{"line":449,"column":2},"end":{"line":449,"column":29}},"262":{"start":{"line":451,"column":2},"end":{"line":451,"column":41}},"263":{"start":{"line":452,"column":2},"end":{"line":453,"column":43}},"264":{"start":{"line":453,"column":4},"end":{"line":453,"column":43}},"265":{"start":{"line":455,"column":2},"end":{"line":455,"column":43}}},"branchMap":{"1":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":9},"end":{"line":20,"column":13}},{"start":{"line":20,"column":17},"end":{"line":20,"column":19}}]},"2":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":32,"column":2}},{"start":{"line":32,"column":2},"end":{"line":32,"column":2}}]},"3":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":2}},{"start":{"line":36,"column":2},"end":{"line":36,"column":2}}]},"4":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":2},"end":{"line":56,"column":2}},{"start":{"line":56,"column":2},"end":{"line":56,"column":2}}]},"5":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":2},"end":{"line":63,"column":2}},{"start":{"line":63,"column":2},"end":{"line":63,"column":2}}]},"6":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":2},"end":{"line":79,"column":2}},{"start":{"line":79,"column":2},"end":{"line":79,"column":2}}]},"7":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":2},"end":{"line":90,"column":2}},{"start":{"line":90,"column":2},"end":{"line":90,"column":2}}]},"8":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":2},"end":{"line":95,"column":2}},{"start":{"line":95,"column":2},"end":{"line":95,"column":2}}]},"9":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":9},"end":{"line":98,"column":9}},{"start":{"line":98,"column":9},"end":{"line":98,"column":9}}]},"10":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":2},"end":{"line":110,"column":2}},{"start":{"line":110,"column":2},"end":{"line":110,"column":2}}]},"11":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":6},"end":{"line":113,"column":6}},{"start":{"line":113,"column":6},"end":{"line":113,"column":6}}]},"12":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":9},"end":{"line":120,"column":9}},{"start":{"line":120,"column":9},"end":{"line":120,"column":9}}]},"13":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":6},"end":{"line":123,"column":6}},{"start":{"line":123,"column":6},"end":{"line":123,"column":6}}]},"14":{"line":134,"type":"if","locations":[{"start":{"line":134,"column":2},"end":{"line":134,"column":2}},{"start":{"line":134,"column":2},"end":{"line":134,"column":2}}]},"15":{"line":136,"type":"binary-expr","locations":[{"start":{"line":136,"column":13},"end":{"line":136,"column":15}},{"start":{"line":136,"column":19},"end":{"line":136,"column":84}}]},"16":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":2},"end":{"line":157,"column":2}},{"start":{"line":157,"column":2},"end":{"line":157,"column":2}}]},"17":{"line":161,"type":"if","locations":[{"start":{"line":161,"column":2},"end":{"line":161,"column":2}},{"start":{"line":161,"column":2},"end":{"line":161,"column":2}}]},"18":{"line":176,"type":"if","locations":[{"start":{"line":176,"column":2},"end":{"line":176,"column":2}},{"start":{"line":176,"column":2},"end":{"line":176,"column":2}}]},"19":{"line":184,"type":"if","locations":[{"start":{"line":184,"column":6},"end":{"line":184,"column":6}},{"start":{"line":184,"column":6},"end":{"line":184,"column":6}}]},"20":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":2},"end":{"line":192,"column":2}},{"start":{"line":192,"column":2},"end":{"line":192,"column":2}}]},"21":{"line":192,"type":"binary-expr","locations":[{"start":{"line":192,"column":6},"end":{"line":192,"column":33}},{"start":{"line":192,"column":37},"end":{"line":192,"column":60}}]},"22":{"line":196,"type":"if","locations":[{"start":{"line":196,"column":2},"end":{"line":196,"column":2}},{"start":{"line":196,"column":2},"end":{"line":196,"column":2}}]},"23":{"line":196,"type":"binary-expr","locations":[{"start":{"line":196,"column":6},"end":{"line":196,"column":25}},{"start":{"line":196,"column":29},"end":{"line":196,"column":68}}]},"24":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":6},"end":{"line":199,"column":6}},{"start":{"line":199,"column":6},"end":{"line":199,"column":6}}]},"25":{"line":204,"type":"if","locations":[{"start":{"line":204,"column":6},"end":{"line":204,"column":6}},{"start":{"line":204,"column":6},"end":{"line":204,"column":6}}]},"26":{"line":209,"type":"if","locations":[{"start":{"line":209,"column":6},"end":{"line":209,"column":6}},{"start":{"line":209,"column":6},"end":{"line":209,"column":6}}]},"27":{"line":224,"type":"if","locations":[{"start":{"line":224,"column":2},"end":{"line":224,"column":2}},{"start":{"line":224,"column":2},"end":{"line":224,"column":2}}]},"28":{"line":224,"type":"binary-expr","locations":[{"start":{"line":224,"column":6},"end":{"line":224,"column":21}},{"start":{"line":224,"column":25},"end":{"line":224,"column":39}}]},"29":{"line":227,"type":"if","locations":[{"start":{"line":227,"column":4},"end":{"line":227,"column":4}},{"start":{"line":227,"column":4},"end":{"line":227,"column":4}}]},"30":{"line":239,"type":"if","locations":[{"start":{"line":239,"column":4},"end":{"line":239,"column":4}},{"start":{"line":239,"column":4},"end":{"line":239,"column":4}}]},"31":{"line":243,"type":"if","locations":[{"start":{"line":243,"column":4},"end":{"line":243,"column":4}},{"start":{"line":243,"column":4},"end":{"line":243,"column":4}}]},"32":{"line":249,"type":"if","locations":[{"start":{"line":249,"column":4},"end":{"line":249,"column":4}},{"start":{"line":249,"column":4},"end":{"line":249,"column":4}}]},"33":{"line":253,"type":"if","locations":[{"start":{"line":253,"column":4},"end":{"line":253,"column":4}},{"start":{"line":253,"column":4},"end":{"line":253,"column":4}}]},"34":{"line":261,"type":"if","locations":[{"start":{"line":261,"column":4},"end":{"line":261,"column":4}},{"start":{"line":261,"column":4},"end":{"line":261,"column":4}}]},"35":{"line":265,"type":"if","locations":[{"start":{"line":265,"column":4},"end":{"line":265,"column":4}},{"start":{"line":265,"column":4},"end":{"line":265,"column":4}}]},"36":{"line":267,"type":"if","locations":[{"start":{"line":267,"column":11},"end":{"line":267,"column":11}},{"start":{"line":267,"column":11},"end":{"line":267,"column":11}}]},"37":{"line":270,"type":"if","locations":[{"start":{"line":270,"column":4},"end":{"line":270,"column":4}},{"start":{"line":270,"column":4},"end":{"line":270,"column":4}}]},"38":{"line":276,"type":"if","locations":[{"start":{"line":276,"column":4},"end":{"line":276,"column":4}},{"start":{"line":276,"column":4},"end":{"line":276,"column":4}}]},"39":{"line":278,"type":"if","locations":[{"start":{"line":278,"column":6},"end":{"line":278,"column":6}},{"start":{"line":278,"column":6},"end":{"line":278,"column":6}}]},"40":{"line":289,"type":"if","locations":[{"start":{"line":289,"column":2},"end":{"line":289,"column":2}},{"start":{"line":289,"column":2},"end":{"line":289,"column":2}}]},"41":{"line":291,"type":"if","locations":[{"start":{"line":291,"column":6},"end":{"line":291,"column":6}},{"start":{"line":291,"column":6},"end":{"line":291,"column":6}}]},"42":{"line":298,"type":"if","locations":[{"start":{"line":298,"column":9},"end":{"line":298,"column":9}},{"start":{"line":298,"column":9},"end":{"line":298,"column":9}}]},"43":{"line":300,"type":"if","locations":[{"start":{"line":300,"column":6},"end":{"line":300,"column":6}},{"start":{"line":300,"column":6},"end":{"line":300,"column":6}}]},"44":{"line":311,"type":"if","locations":[{"start":{"line":311,"column":2},"end":{"line":311,"column":2}},{"start":{"line":311,"column":2},"end":{"line":311,"column":2}}]},"45":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":2},"end":{"line":317,"column":2}},{"start":{"line":317,"column":2},"end":{"line":317,"column":2}}]},"46":{"line":319,"type":"if","locations":[{"start":{"line":319,"column":4},"end":{"line":319,"column":4}},{"start":{"line":319,"column":4},"end":{"line":319,"column":4}}]},"47":{"line":335,"type":"if","locations":[{"start":{"line":335,"column":2},"end":{"line":335,"column":2}},{"start":{"line":335,"column":2},"end":{"line":335,"column":2}}]},"48":{"line":349,"type":"if","locations":[{"start":{"line":349,"column":4},"end":{"line":349,"column":4}},{"start":{"line":349,"column":4},"end":{"line":349,"column":4}}]},"49":{"line":360,"type":"if","locations":[{"start":{"line":360,"column":4},"end":{"line":360,"column":4}},{"start":{"line":360,"column":4},"end":{"line":360,"column":4}}]},"50":{"line":377,"type":"if","locations":[{"start":{"line":377,"column":2},"end":{"line":377,"column":2}},{"start":{"line":377,"column":2},"end":{"line":377,"column":2}}]},"51":{"line":382,"type":"if","locations":[{"start":{"line":382,"column":4},"end":{"line":382,"column":4}},{"start":{"line":382,"column":4},"end":{"line":382,"column":4}}]},"52":{"line":382,"type":"binary-expr","locations":[{"start":{"line":382,"column":8},"end":{"line":382,"column":12}},{"start":{"line":382,"column":16},"end":{"line":382,"column":23}}]},"53":{"line":386,"type":"if","locations":[{"start":{"line":386,"column":4},"end":{"line":386,"column":4}},{"start":{"line":386,"column":4},"end":{"line":386,"column":4}}]},"54":{"line":386,"type":"binary-expr","locations":[{"start":{"line":386,"column":8},"end":{"line":386,"column":15}},{"start":{"line":386,"column":19},"end":{"line":386,"column":24}}]},"55":{"line":387,"type":"if","locations":[{"start":{"line":387,"column":4},"end":{"line":387,"column":4}},{"start":{"line":387,"column":4},"end":{"line":387,"column":4}}]},"56":{"line":388,"type":"if","locations":[{"start":{"line":388,"column":4},"end":{"line":388,"column":4}},{"start":{"line":388,"column":4},"end":{"line":388,"column":4}}]},"57":{"line":388,"type":"binary-expr","locations":[{"start":{"line":388,"column":8},"end":{"line":388,"column":13}},{"start":{"line":388,"column":17},"end":{"line":388,"column":27}}]},"58":{"line":393,"type":"binary-expr","locations":[{"start":{"line":393,"column":19},"end":{"line":393,"column":23}},{"start":{"line":393,"column":27},"end":{"line":393,"column":29}}]},"59":{"line":407,"type":"if","locations":[{"start":{"line":407,"column":2},"end":{"line":407,"column":2}},{"start":{"line":407,"column":2},"end":{"line":407,"column":2}}]},"60":{"line":411,"type":"if","locations":[{"start":{"line":411,"column":2},"end":{"line":411,"column":2}},{"start":{"line":411,"column":2},"end":{"line":411,"column":2}}]},"61":{"line":419,"type":"if","locations":[{"start":{"line":419,"column":2},"end":{"line":419,"column":2}},{"start":{"line":419,"column":2},"end":{"line":419,"column":2}}]},"62":{"line":426,"type":"if","locations":[{"start":{"line":426,"column":2},"end":{"line":426,"column":2}},{"start":{"line":426,"column":2},"end":{"line":426,"column":2}}]},"63":{"line":431,"type":"if","locations":[{"start":{"line":431,"column":2},"end":{"line":431,"column":2}},{"start":{"line":431,"column":2},"end":{"line":431,"column":2}}]},"64":{"line":433,"type":"if","locations":[{"start":{"line":433,"column":4},"end":{"line":433,"column":4}},{"start":{"line":433,"column":4},"end":{"line":433,"column":4}}]},"65":{"line":444,"type":"if","locations":[{"start":{"line":444,"column":2},"end":{"line":444,"column":2}},{"start":{"line":444,"column":2},"end":{"line":444,"column":2}}]},"66":{"line":444,"type":"binary-expr","locations":[{"start":{"line":444,"column":6},"end":{"line":444,"column":15}},{"start":{"line":444,"column":19},"end":{"line":444,"column":28}}]},"67":{"line":452,"type":"if","locations":[{"start":{"line":452,"column":2},"end":{"line":452,"column":2}},{"start":{"line":452,"column":2},"end":{"line":452,"column":2}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var taskManager = require('../common/manager/taskManager');","var pomelo = require('../pomelo');","var rsa = require(\"node-bignumber\");","var events = require('../util/events');","var utils = require('../util/utils');","","module.exports = function(app, opts) {","  return new Component(app, opts);","};","","/**"," * Connector component. Receive client requests and attach session with socket."," *"," * @param {Object} app  current application context"," * @param {Object} opts attach parameters"," *                      opts.connector {Object} provides low level network and protocol details implementation between server and clients."," */","var Component = function(app, opts) {","  opts = opts || {};","  this.app = app;","  this.connector = getConnector(app, opts);","  this.encode = opts.encode;","  this.decode = opts.decode;","  this.useCrypto = opts.useCrypto;","  this.useHostFilter = opts.useHostFilter;","  this.useAsyncCoder = opts.useAsyncCoder;","  this.blacklistFun = opts.blacklistFun;","  this.keys = {};","  this.blacklist = [];","","  if (opts.useDict) {","    app.load(pomelo.dictionary, app.get('dictionaryConfig'));","  }","","  if (opts.useProtobuf) {","    app.load(pomelo.protobuf, app.get('protobufConfig'));","  }","","  // component dependencies","  this.server = null;","  this.session = null;","  this.connection = null;","};","","var pro = Component.prototype;","","pro.name = '__connector__';","","pro.start = function(cb) {","  this.server = this.app.components.__server__;","  this.session = this.app.components.__session__;","  this.connection = this.app.components.__connection__;","","  // check component dependencies","  if (!this.server) {","    process.nextTick(function() {","      utils.invokeCallback(cb, new Error('fail to start connector component for no server component loaded'));","    });","    return;","  }","","  if (!this.session) {","    process.nextTick(function() {","      utils.invokeCallback(cb, new Error('fail to start connector component for no session component loaded'));","    });","    return;","  }","","  process.nextTick(cb);","};","","pro.afterStart = function(cb) {","  this.connector.start(cb);","  this.connector.on('connection', hostFilter.bind(this, bindEvents));","};","","pro.stop = function(force, cb) {","  if (this.connector) {","    this.connector.stop(force, cb);","    this.connector = null;","    return;","  } else {","    process.nextTick(cb);","  }","};","","pro.send = function(reqId, route, msg, recvs, opts, cb) {","  logger.debug('[%s] send message reqId: %s, route: %s, msg: %j, receivers: %j, opts: %j', this.app.serverId, reqId, route, msg, recvs, opts);","  if (this.useAsyncCoder) {","    return this.sendAsync(reqId, route, msg, recvs, opts, cb);","  }","","  var emsg = msg;","  if (this.encode) {","    // use costumized encode","    emsg = this.encode.call(this, reqId, route, msg);","  } else if (this.connector.encode) {","    // use connector default encode","    emsg = this.connector.encode(reqId, route, msg);","  }","","  this.doSend(reqId, route, emsg, recvs, opts, cb);","};","","pro.sendAsync = function(reqId, route, msg, recvs, opts, cb) {","  var emsg = msg;","  var self = this;","","  if (this.encode) {","    // use costumized encode","    this.encode(reqId, route, msg, function(err, encodeMsg) {","      if (err) {","        return cb(err);","      }","","      emsg = encodeMsg;","      self.doSend(reqId, route, emsg, recvs, opts, cb);","    });","  } else if (this.connector.encode) {","    // use connector default encode","    this.connector.encode(reqId, route, msg, function(err, encodeMsg) {","      if (err) {","        return cb(err);","      }","","      emsg = encodeMsg;","      self.doSend(reqId, route, emsg, recvs, opts, cb);","    });","  }","}","","pro.doSend = function(reqId, route, emsg, recvs, opts, cb) {","  if (!emsg) {","    process.nextTick(function() {","      return cb && cb(new Error('fail to send message for encode result is empty.'));","    });","  }","","  this.app.components.__pushScheduler__.schedule(reqId, route, emsg,","    recvs, opts, cb);","}","","pro.setPubKey = function(id, key) {","  var pubKey = new rsa.Key();","  pubKey.n = new rsa.BigInteger(key.rsa_n, 16);","  pubKey.e = key.rsa_e;","  this.keys[id] = pubKey;","};","","pro.getPubKey = function(id) {","  return this.keys[id];","};","","var getConnector = function(app, opts) {","  var connector = opts.connector;","  if (!connector) {","    return getDefaultConnector(app, opts);","  }","","  if (typeof connector !== 'function') {","    return connector;","  }","","  var curServer = app.getCurServer();","  return connector(curServer.clientPort, curServer.host, opts);","};","","var getDefaultConnector = function(app, opts) {","  var DefaultConnector = require('../connectors/sioconnector');","  var curServer = app.getCurServer();","  return new DefaultConnector(curServer.clientPort, curServer.host, opts);","};","","var hostFilter = function(cb, socket) {","  if(!this.useHostFilter) {","    return cb(this, socket);","  }","","  var ip = socket.remoteAddress.ip;","  var check = function(list) {","    for (var address in list) {","      var exp = new RegExp(list[address]);","      if (exp.test(ip)) {","        socket.disconnect();","        return true;","      }","    }","    return false;","  };","  // dynamical check","  if (this.blacklist.length !== 0 && !!check(this.blacklist)) {","    return;","  }","  // static check","  if (!!this.blacklistFun && typeof this.blacklistFun === 'function') {","    var self = this;","    self.blacklistFun(function(err, list) {","      if (!!err) {","        logger.error('connector blacklist error: %j', err.stack);","        utils.invokeCallback(cb, self, socket);","        return;","      }","      if (!Array.isArray(list)) {","        logger.error('connector blacklist is not array: %j', list);","        utils.invokeCallback(cb, self, socket);","        return;","      }","      if (!!check(list)) {","        return;","      } else {","        utils.invokeCallback(cb, self, socket);","        return;","      }","    });","  } else {","    utils.invokeCallback(cb, this, socket);","  }","};","","var bindEvents = function(self, socket) {","  var curServer = self.app.getCurServer();","  var maxConnections = curServer['max-connections'];","  if (self.connection && maxConnections) {","    self.connection.increaseConnectionCount();","    var statisticInfo = self.connection.getStatisticsInfo();","    if (statisticInfo.totalConnCount > maxConnections) {","      logger.warn('the server %s has reached the max connections %s', curServer.id, maxConnections);","      socket.disconnect();","      return;","    }","  }","","  //create session for connection","  var session = getSession(self, socket);","  var closed = false;","","  socket.on('disconnect', function() {","    if (closed) {","      return;","    }","    closed = true;","    if (self.connection) {","      self.connection.decreaseConnectionCount(session.uid);","    }","  });","","  socket.on('error', function() {","    if (closed) {","      return;","    }","    closed = true;","    if (self.connection) {","      self.connection.decreaseConnectionCount(session.uid);","    }","  });","","  // new message","  socket.on('message', function(msg) {","    var dmsg = msg;","    if (self.useAsyncCoder) {","      return handleMessageAsync(self, msg, session, socket);","    }","","    if (self.decode) {","      dmsg = self.decode(msg, session);","    } else if (self.connector.decode) {","      dmsg = self.connector.decode(msg, socket);","    }","    if (!dmsg) {","      // discard invalid message","      return;","    }","","    // use rsa crypto","    if (self.useCrypto) {","      var verified = verifyMessage(self, session, dmsg);","      if (!verified) {","        logger.error('fail to verify the data received from client.');","        return;","      }","    }","","    handleMessage(self, session, dmsg);","  }); //on message end","};","","var handleMessageAsync = function(self, msg, session, socket) {","  if (self.decode) {","    self.decode(msg, session, function(err, dmsg) {","      if (err) {","        logger.error('fail to decode message from client %s .', err.stack);","        return;","      }","","      doHandleMessage(self, dmsg, session);","    });","  } else if (self.connector.decode) {","    self.connector.decode(msg, socket, function(err, dmsg) {","      if (err) {","        logger.error('fail to decode message from client %s .', err.stack);","        return;","      }","","      doHandleMessage(self, dmsg, session);","    });","  }","}","","var doHandleMessage = function(self, dmsg, session) {","  if (!dmsg) {","    // discard invalid message","    return;","  }","","  // use rsa crypto","  if (self.useCrypto) {","    var verified = verifyMessage(self, session, dmsg);","    if (!verified) {","      logger.error('fail to verify the data received from client.');","      return;","    }","  }","","  handleMessage(self, session, dmsg);","}","","/**"," * get session for current connection"," */","var getSession = function(self, socket) {","  var app = self.app,","    sid = socket.id;","  var session = self.session.get(sid);","  if (session) {","    return session;","  }","","  session = self.session.create(sid, app.getServerId(), socket);","  logger.debug('[%s] getSession session is created with session id: %s', app.getServerId(), sid);","","  // bind events for session","  socket.on('disconnect', session.closed.bind(session));","  socket.on('error', session.closed.bind(session));","  session.on('closed', onSessionClose.bind(null, app));","  session.on('bind', function(uid) {","    logger.debug('session on [%s] bind with uid: %s', self.app.serverId, uid);","    // update connection statistics if necessary","    if (self.connection) {","      self.connection.addLoginedUser(uid, {","        loginTime: Date.now(),","        uid: uid,","        address: socket.remoteAddress.ip + ':' + socket.remoteAddress.port","      });","    }","    self.app.event.emit(events.BIND_SESSION, session);","  });","","  session.on('unbind', function(uid) {","    if (self.connection) {","      self.connection.removeLoginedUser(uid);","    }","    self.app.event.emit(events.UNBIND_SESSION, session);","  });","","  return session;","};","","var onSessionClose = function(app, session, reason) {","  taskManager.closeQueue(session.id, true);","  app.event.emit(events.CLOSE_SESSION, session);","};","","var handleMessage = function(self, session, msg) {","  logger.debug('[%s] handleMessage session id: %s, msg: %j', self.app.serverId, session.id, msg);","  var type = checkServerType(msg.route);","  if (!type) {","    logger.error('invalid route string. route : %j', msg.route);","    return;","  }","  self.server.globalHandle(msg, session.toFrontendSession(), function(err, resp, opts) {","    if (resp && !msg.id) {","      logger.warn('try to response to a notify: %j', msg.route);","      return;","    }","    if (!msg.id && !resp) return;","    if (!resp) resp = {};","    if (!!err && !resp.code) {","      resp.code = 500;","    }","    opts = {","      type: 'response',","      userOptions: opts || {}","    };","    // for compatiablity","    opts.isResponse = true;","","    self.send(msg.id, msg.route, resp, [session.id], opts,","      function() {});","  });","};","","/**"," * Get server type form request message."," */","var checkServerType = function(route) {","  if (!route) {","    return null;","  }","  var idx = route.indexOf('.');","  if (idx < 0) {","    return null;","  }","  return route.substring(0, idx);","};","","var verifyMessage = function(self, session, msg) {","  var sig = msg.body.__crypto__;","  if (!sig) {","    logger.error('receive data from client has no signature [%s]', self.app.serverId);","    return false;","  }","","  var pubKey;","","  if (!session) {","    logger.error('could not find session.');","    return false;","  }","","  if (!session.get('pubKey')) {","    pubKey = self.getPubKey(session.id);","    if (!!pubKey) {","      delete self.keys[session.id];","      session.set('pubKey', pubKey);","    } else {","      logger.error('could not get public key, session id is %s', session.id);","      return false;","    }","  } else {","    pubKey = session.get('pubKey');","  }","","  if (!pubKey.n || !pubKey.e) {","    logger.error('could not verify message without public key [%s]', self.app.serverId);","    return false;","  }","","  delete msg.body.__crypto__;","","  var message = JSON.stringify(msg.body);","  if (utils.hasChineseChar(message))","    message = utils.unicodeToUtf8(message);","","  return pubKey.verifyString(message, sig);","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"9":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"32":0,"33":0,"36":0,"37":0,"41":0,"42":0,"43":0,"46":1,"48":1,"50":1,"51":0,"52":0,"53":0,"56":0,"57":0,"58":0,"60":0,"63":0,"64":0,"65":0,"67":0,"70":0,"73":1,"74":0,"75":0,"78":1,"79":0,"80":0,"81":0,"82":0,"84":0,"88":1,"89":0,"90":0,"91":0,"94":0,"95":0,"97":0,"98":0,"100":0,"103":0,"106":1,"107":0,"108":0,"110":0,"112":0,"113":0,"114":0,"117":0,"118":0,"120":0,"122":0,"123":0,"124":0,"127":0,"128":0,"133":1,"134":0,"135":0,"136":0,"140":0,"144":1,"145":0,"146":0,"147":0,"148":0,"151":1,"152":0,"155":1,"156":0,"157":0,"158":0,"161":0,"162":0,"165":0,"166":0,"169":1,"170":0,"171":0,"172":0,"175":1,"176":0,"177":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"189":0,"192":0,"193":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"204":0,"205":0,"206":0,"207":0,"209":0,"210":0,"212":0,"213":0,"217":0,"221":1,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"235":0,"236":0,"238":0,"239":0,"240":0,"242":0,"243":0,"244":0,"248":0,"249":0,"250":0,"252":0,"253":0,"254":0,"259":0,"260":0,"261":0,"262":0,"265":0,"266":0,"267":0,"268":0,"270":0,"272":0,"276":0,"277":0,"278":0,"279":0,"280":0,"284":0,"288":1,"289":0,"290":0,"291":0,"292":0,"293":0,"296":0,"298":0,"299":0,"300":0,"301":0,"302":0,"305":0,"310":1,"311":0,"313":0,"317":0,"318":0,"319":0,"320":0,"321":0,"325":0,"331":1,"332":0,"334":0,"335":0,"336":0,"339":0,"340":0,"343":0,"344":0,"345":0,"346":0,"347":0,"349":0,"350":0,"356":0,"359":0,"360":0,"361":0,"363":0,"366":0,"369":1,"370":0,"371":0,"374":1,"375":0,"376":0,"377":0,"378":0,"379":0,"381":0,"382":0,"383":0,"384":0,"386":0,"387":0,"388":0,"389":0,"391":0,"396":0,"398":0,"406":1,"407":0,"408":0,"410":0,"411":0,"412":0,"414":0,"417":1,"418":0,"419":0,"420":0,"421":0,"424":0,"426":0,"427":0,"428":0,"431":0,"432":0,"433":0,"434":0,"435":0,"437":0,"438":0,"441":0,"444":0,"445":0,"446":0,"449":0,"451":0,"452":0,"453":0,"455":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/manager/taskManager.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/manager/taskManager.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":17,"loc":{"start":{"line":17,"column":18},"end":{"line":17,"column":56}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":21},"end":{"line":33,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":16}},"4":{"start":{"line":7,"column":0},"end":{"line":7,"column":23}},"5":{"start":{"line":17,"column":0},"end":{"line":25,"column":2}},"6":{"start":{"line":18,"column":2},"end":{"line":18,"column":26}},"7":{"start":{"line":19,"column":2},"end":{"line":22,"column":3}},"8":{"start":{"line":20,"column":4},"end":{"line":20,"column":49}},"9":{"start":{"line":21,"column":4},"end":{"line":21,"column":24}},"10":{"start":{"line":24,"column":2},"end":{"line":24,"column":44}},"11":{"start":{"line":33,"column":0},"end":{"line":41,"column":2}},"12":{"start":{"line":34,"column":2},"end":{"line":37,"column":3}},"13":{"start":{"line":36,"column":4},"end":{"line":36,"column":11}},"14":{"start":{"line":39,"column":2},"end":{"line":39,"column":27}},"15":{"start":{"line":40,"column":2},"end":{"line":40,"column":21}}},"branchMap":{"1":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":2},"end":{"line":19,"column":2}},{"start":{"line":19,"column":2},"end":{"line":19,"column":2}}]},"2":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":2},"end":{"line":34,"column":2}},{"start":{"line":34,"column":2},"end":{"line":34,"column":2}}]}},"code":["var sequeue = require('seq-queue');","","var manager = module.exports;","","var queues = {};","","manager.timeout = 3000;","","/**"," * Add tasks into task group. Create the task group if it dose not exist."," *"," * @param {String}   key       task key"," * @param {Function} fn        task callback"," * @param {Function} ontimeout task timeout callback"," * @param {Number}   timeout   timeout for task"," */","manager.addTask = function(key, fn, ontimeout, timeout) {","  var queue = queues[key];","  if(!queue) {","    queue = sequeue.createQueue(manager.timeout);","    queues[key] = queue;","  }","","  return queue.push(fn, ontimeout, timeout);","};","","/**"," * Destroy task group"," *"," * @param  {String} key   task key"," * @param  {Boolean} force whether close task group directly"," */","manager.closeQueue = function(key, force) {","  if(!queues[key]) {","    // ignore illeagle key","    return;","  }","","  queues[key].close(force);","  delete queues[key];","};",""],"l":{"1":1,"3":1,"5":1,"7":1,"17":1,"18":0,"19":0,"20":0,"21":0,"24":0,"33":1,"34":0,"36":0,"39":0,"40":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/dictionary.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/dictionary.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":0,"54":1,"55":0,"56":1,"57":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":37}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":36}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":12},"end":{"line":33,"column":25}}},"4":{"name":"(anonymous_4)","line":85,"loc":{"start":{"line":85,"column":14},"end":{"line":85,"column":25}}},"5":{"name":"(anonymous_5)","line":89,"loc":{"start":{"line":89,"column":15},"end":{"line":89,"column":26}}},"6":{"name":"(anonymous_6)","line":93,"loc":{"start":{"line":93,"column":17},"end":{"line":93,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":38}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":43}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":31}},"7":{"start":{"line":8,"column":0},"end":{"line":10,"column":2}},"8":{"start":{"line":9,"column":2},"end":{"line":9,"column":34}},"9":{"start":{"line":12,"column":0},"end":{"line":27,"column":2}},"10":{"start":{"line":13,"column":2},"end":{"line":13,"column":17}},"11":{"start":{"line":14,"column":2},"end":{"line":14,"column":17}},"12":{"start":{"line":15,"column":2},"end":{"line":15,"column":18}},"13":{"start":{"line":16,"column":2},"end":{"line":16,"column":26}},"14":{"start":{"line":17,"column":2},"end":{"line":17,"column":20}},"15":{"start":{"line":20,"column":2},"end":{"line":20,"column":62}},"16":{"start":{"line":21,"column":2},"end":{"line":23,"column":3}},"17":{"start":{"line":22,"column":4},"end":{"line":22,"column":18}},"18":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"19":{"start":{"line":25,"column":4},"end":{"line":25,"column":25}},"20":{"start":{"line":29,"column":0},"end":{"line":29,"column":30}},"21":{"start":{"line":31,"column":0},"end":{"line":31,"column":28}},"22":{"start":{"line":33,"column":0},"end":{"line":83,"column":2}},"23":{"start":{"line":34,"column":2},"end":{"line":34,"column":40}},"24":{"start":{"line":35,"column":2},"end":{"line":35,"column":18}},"25":{"start":{"line":38,"column":2},"end":{"line":54,"column":3}},"26":{"start":{"line":39,"column":4},"end":{"line":39,"column":68}},"27":{"start":{"line":40,"column":4},"end":{"line":42,"column":5}},"28":{"start":{"line":41,"column":6},"end":{"line":41,"column":15}},"29":{"start":{"line":44,"column":4},"end":{"line":44,"column":44}},"30":{"start":{"line":46,"column":4},"end":{"line":53,"column":5}},"31":{"start":{"line":47,"column":6},"end":{"line":47,"column":35}},"32":{"start":{"line":48,"column":6},"end":{"line":52,"column":7}},"33":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"34":{"start":{"line":50,"column":10},"end":{"line":50,"column":59}},"35":{"start":{"line":57,"column":2},"end":{"line":57,"column":16}},"36":{"start":{"line":58,"column":2},"end":{"line":58,"column":11}},"37":{"start":{"line":59,"column":2},"end":{"line":59,"column":8}},"38":{"start":{"line":60,"column":2},"end":{"line":64,"column":3}},"39":{"start":{"line":61,"column":4},"end":{"line":61,"column":17}},"40":{"start":{"line":62,"column":4},"end":{"line":62,"column":33}},"41":{"start":{"line":63,"column":4},"end":{"line":63,"column":32}},"42":{"start":{"line":67,"column":2},"end":{"line":78,"column":3}},"43":{"start":{"line":68,"column":4},"end":{"line":68,"column":44}},"44":{"start":{"line":70,"column":4},"end":{"line":70,"column":29}},"45":{"start":{"line":71,"column":4},"end":{"line":77,"column":5}},"46":{"start":{"line":72,"column":6},"end":{"line":72,"column":29}},"47":{"start":{"line":74,"column":6},"end":{"line":74,"column":31}},"48":{"start":{"line":75,"column":6},"end":{"line":75,"column":30}},"49":{"start":{"line":76,"column":6},"end":{"line":76,"column":13}},"50":{"start":{"line":80,"column":2},"end":{"line":80,"column":93}},"51":{"start":{"line":82,"column":2},"end":{"line":82,"column":27}},"52":{"start":{"line":85,"column":0},"end":{"line":87,"column":2}},"53":{"start":{"line":86,"column":2},"end":{"line":86,"column":19}},"54":{"start":{"line":89,"column":0},"end":{"line":91,"column":2}},"55":{"start":{"line":90,"column":2},"end":{"line":90,"column":20}},"56":{"start":{"line":93,"column":0},"end":{"line":95,"column":2}},"57":{"start":{"line":94,"column":2},"end":{"line":94,"column":22}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":2},"end":{"line":21,"column":2}},{"start":{"line":21,"column":2},"end":{"line":21,"column":2}}]},"2":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":5},"end":{"line":21,"column":11}},{"start":{"line":21,"column":15},"end":{"line":21,"column":26}}]},"3":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":24,"column":2}},{"start":{"line":24,"column":2},"end":{"line":24,"column":2}}]},"4":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]},"5":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":49,"column":8}},{"start":{"line":49,"column":8},"end":{"line":49,"column":8}}]},"6":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":2},"end":{"line":67,"column":2}},{"start":{"line":67,"column":2},"end":{"line":67,"column":2}}]}},"code":["var fs = require('fs');","var path = require('path');","var utils = require('../util/utils');","var Loader = require('pomelo-loader');","var pathUtil = require('../util/pathUtil');","var crypto = require('crypto');","","module.exports = function(app, opts) {","  return new Component(app, opts);","};","","var Component = function(app, opts) {","  this.app = app;","  this.dict = {};","  this.abbrs = {};","  this.userDicPath = null;","  this.version = \"\";","","  //Set user dictionary","  var p = path.join(app.getBase(), '/config/dictionary.json');","  if(!!opts && !!opts.dict) {","    p = opts.dict;","  }","  if(fs.existsSync(p)) {","    this.userDicPath = p;","  }","};","","var pro = Component.prototype;","","pro.name = '__dictionary__';","","pro.start = function(cb) {","  var servers = this.app.get('servers');","  var routes = [];","","  //Load all the handler files","  for(var serverType in servers) {","    var p = pathUtil.getHandlerPath(this.app.getBase(), serverType);","    if(!p) {","      continue;","    }","","    var handlers = Loader.load(p, this.app);","","    for(var name in handlers) {","      var handler = handlers[name];","      for(var key in handler) {","        if(typeof(handler[key]) === 'function') {","          routes.push(serverType + '.' + name + '.' + key);","        }","      }","    }","  }","","  //Sort the route to make sure all the routers abbr are the same in all the servers","  routes.sort();","  var abbr;","  var i;","  for(i = 0; i < routes.length; i++) {","    abbr = i + 1;","    this.abbrs[abbr] = routes[i];","    this.dict[routes[i]] = abbr;","  }","","  //Load user dictionary","  if(!!this.userDicPath) {","    var userDic = require(this.userDicPath);","","    abbr = routes.length + 1;","    for(i = 0; i < userDic.length; i++) {","      var route = userDic[i];","","      this.abbrs[abbr] = route;","      this.dict[route] = abbr;","      abbr++;","    }","  }","  ","  this.version = crypto.createHash('md5').update(JSON.stringify(this.dict)).digest('base64');","","  utils.invokeCallback(cb);","};","","pro.getDict = function() {","  return this.dict;","};","","pro.getAbbrs = function() {","  return this.abbrs;","};","","pro.getVersion = function() {","  return this.version;","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"9":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"20":0,"21":0,"22":0,"24":0,"25":0,"29":1,"31":1,"33":1,"34":0,"35":0,"38":0,"39":0,"40":0,"41":0,"44":0,"46":0,"47":0,"48":0,"49":0,"50":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"67":0,"68":0,"70":0,"71":0,"72":0,"74":0,"75":0,"76":0,"80":0,"82":0,"85":1,"86":0,"89":1,"90":0,"93":1,"94":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-loader/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-loader/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}}},"branchMap":{},"code":["module.exports = require('./lib/loader');"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-loader/lib/loader.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-loader/lib/loader.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":1,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":1,"49":0,"50":1,"51":0,"52":0,"53":0,"54":0,"55":1,"56":0,"57":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":24,"loc":{"start":{"line":24,"column":22},"end":{"line":24,"column":47}}},"2":{"name":"(anonymous_2)","line":42,"loc":{"start":{"line":42,"column":15},"end":{"line":42,"column":37}}},"3":{"name":"(anonymous_3)","line":58,"loc":{"start":{"line":58,"column":15},"end":{"line":58,"column":39}}},"4":{"name":"(anonymous_4)","line":98,"loc":{"start":{"line":98,"column":20},"end":{"line":98,"column":41}}},"5":{"name":"(anonymous_5)","line":112,"loc":{"start":{"line":112,"column":13},"end":{"line":112,"column":28}}},"6":{"name":"(anonymous_6)","line":116,"loc":{"start":{"line":116,"column":12},"end":{"line":116,"column":27}}},"7":{"name":"(anonymous_7)","line":120,"loc":{"start":{"line":120,"column":18},"end":{"line":120,"column":45}}},"8":{"name":"(anonymous_8)","line":129,"loc":{"start":{"line":129,"column":22},"end":{"line":129,"column":38}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":23}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"3":{"start":{"line":24,"column":0},"end":{"line":40,"column":2}},"4":{"start":{"line":25,"column":1},"end":{"line":27,"column":2}},"5":{"start":{"line":26,"column":2},"end":{"line":26,"column":60}},"6":{"start":{"line":29,"column":2},"end":{"line":33,"column":3}},"7":{"start":{"line":30,"column":4},"end":{"line":30,"column":35}},"8":{"start":{"line":32,"column":4},"end":{"line":32,"column":14}},"9":{"start":{"line":35,"column":1},"end":{"line":37,"column":2}},"10":{"start":{"line":36,"column":2},"end":{"line":36,"column":47}},"11":{"start":{"line":39,"column":1},"end":{"line":39,"column":33}},"12":{"start":{"line":42,"column":0},"end":{"line":56,"column":2}},"13":{"start":{"line":43,"column":1},"end":{"line":43,"column":29}},"14":{"start":{"line":45,"column":1},"end":{"line":47,"column":2}},"15":{"start":{"line":46,"column":2},"end":{"line":46,"column":9}},"16":{"start":{"line":49,"column":1},"end":{"line":53,"column":2}},"17":{"start":{"line":52,"column":2},"end":{"line":52,"column":17}},"18":{"start":{"line":55,"column":1},"end":{"line":55,"column":10}},"19":{"start":{"line":58,"column":0},"end":{"line":90,"column":2}},"20":{"start":{"line":59,"column":1},"end":{"line":59,"column":34}},"21":{"start":{"line":60,"column":1},"end":{"line":63,"column":2}},"22":{"start":{"line":61,"column":2},"end":{"line":61,"column":46}},"23":{"start":{"line":62,"column":2},"end":{"line":62,"column":9}},"24":{"start":{"line":65,"column":1},"end":{"line":67,"column":2}},"25":{"start":{"line":66,"column":2},"end":{"line":66,"column":14}},"26":{"start":{"line":69,"column":1},"end":{"line":69,"column":25}},"27":{"start":{"line":70,"column":1},"end":{"line":87,"column":2}},"28":{"start":{"line":71,"column":2},"end":{"line":71,"column":16}},"29":{"start":{"line":72,"column":2},"end":{"line":72,"column":17}},"30":{"start":{"line":74,"column":2},"end":{"line":77,"column":3}},"31":{"start":{"line":76,"column":3},"end":{"line":76,"column":12}},"32":{"start":{"line":79,"column":2},"end":{"line":79,"column":28}},"33":{"start":{"line":81,"column":2},"end":{"line":83,"column":3}},"34":{"start":{"line":82,"column":3},"end":{"line":82,"column":12}},"35":{"start":{"line":85,"column":2},"end":{"line":85,"column":53}},"36":{"start":{"line":86,"column":2},"end":{"line":86,"column":16}},"37":{"start":{"line":89,"column":1},"end":{"line":89,"column":12}},"38":{"start":{"line":98,"column":0},"end":{"line":110,"column":2}},"39":{"start":{"line":99,"column":1},"end":{"line":101,"column":2}},"40":{"start":{"line":100,"column":2},"end":{"line":100,"column":24}},"41":{"start":{"line":103,"column":1},"end":{"line":105,"column":2}},"42":{"start":{"line":104,"column":2},"end":{"line":104,"column":15}},"43":{"start":{"line":107,"column":1},"end":{"line":107,"column":65}},"44":{"start":{"line":108,"column":1},"end":{"line":108,"column":31}},"45":{"start":{"line":109,"column":1},"end":{"line":109,"column":23}},"46":{"start":{"line":112,"column":0},"end":{"line":114,"column":2}},"47":{"start":{"line":113,"column":1},"end":{"line":113,"column":35}},"48":{"start":{"line":116,"column":0},"end":{"line":118,"column":2}},"49":{"start":{"line":117,"column":1},"end":{"line":117,"column":40}},"50":{"start":{"line":120,"column":0},"end":{"line":127,"column":2}},"51":{"start":{"line":121,"column":1},"end":{"line":121,"column":28}},"52":{"start":{"line":122,"column":1},"end":{"line":124,"column":2}},"53":{"start":{"line":123,"column":2},"end":{"line":123,"column":51}},"54":{"start":{"line":126,"column":1},"end":{"line":126,"column":11}},"55":{"start":{"line":129,"column":0},"end":{"line":132,"column":1}},"56":{"start":{"line":130,"column":4},"end":{"line":130,"column":49}},"57":{"start":{"line":131,"column":4},"end":{"line":131,"column":26}}},"branchMap":{"1":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},{"start":{"line":25,"column":1},"end":{"line":25,"column":1}}]},"2":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},{"start":{"line":35,"column":1},"end":{"line":35,"column":1}}]},"3":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},{"start":{"line":45,"column":1},"end":{"line":45,"column":1}}]},"4":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},{"start":{"line":49,"column":1},"end":{"line":49,"column":1}}]},"5":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},{"start":{"line":60,"column":1},"end":{"line":60,"column":1}}]},"6":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},{"start":{"line":65,"column":1},"end":{"line":65,"column":1}}]},"7":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":2},"end":{"line":74,"column":2}},{"start":{"line":74,"column":2},"end":{"line":74,"column":2}}]},"8":{"line":74,"type":"binary-expr","locations":[{"start":{"line":74,"column":5},"end":{"line":74,"column":16}},{"start":{"line":74,"column":20},"end":{"line":74,"column":45}}]},"9":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":2},"end":{"line":81,"column":2}},{"start":{"line":81,"column":2},"end":{"line":81,"column":2}}]},"10":{"line":85,"type":"binary-expr","locations":[{"start":{"line":85,"column":13},"end":{"line":85,"column":19}},{"start":{"line":85,"column":23},"end":{"line":85,"column":52}}]},"11":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},{"start":{"line":99,"column":1},"end":{"line":99,"column":1}}]},"12":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},{"start":{"line":103,"column":1},"end":{"line":103,"column":1}}]},"13":{"line":122,"type":"if","locations":[{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},{"start":{"line":122,"column":1},"end":{"line":122,"column":1}}]}},"code":["/**"," * Loader Module"," */","","var fs = require('fs');","var path = require('path');","","/**"," * Load modules under the path."," * If the module is a function, loader would treat it as a factory function "," * and invoke it with the context parameter to get a instance of the module."," * Else loader would just require the module."," * Module instance can specify a name property and it would use file name as "," * the default name if there is no name property. All loaded modules under the "," * path would be add to an empty root object with the name as the key."," * "," * @param  {String} mpath    the path of modules. Load all the files under the "," *                           path, but *not* recursively if the path contain "," *                           any sub-directory. "," * @param  {Object} context  the context parameter that would be pass to the "," *                           module factory function."," * @return {Object}          module that has loaded."," */","module.exports.load = function(mpath, context) {","\tif(!mpath) {","\t\tthrow new Error('opts or opts.path should not be empty.');","\t}","","  try {","    mpath = fs.realpathSync(mpath);","  } catch(err) {","    throw err;","  }","","\tif(!isDir(mpath)) {","\t\tthrow new Error('path should be directory.');","\t}","","\treturn loadPath(mpath, context);","};","","var loadFile = function(fp, context) {","\tvar m = requireUncached(fp);","","\tif(!m) {","\t\treturn;","\t}","","\tif(typeof m === 'function') {","\t\t// if the module provides a factory function ","\t\t// then invoke it to get a instance","\t\tm = m(context);","\t}","","\treturn m;","};","","var loadPath = function(path, context) {","\tvar files = fs.readdirSync(path);","\tif(files.length === 0) {","\t\tconsole.warn('path is empty, path:' + path);","\t\treturn;","\t}","","\tif(path.charAt(path.length - 1) !== '/') {","\t\tpath += '/';","\t}","\t\t","\tvar fp, fn, m, res = {};","\tfor(var i=0, l=files.length; i<l; i++) {","\t\tfn = files[i];","\t\tfp = path + fn;","\t\t","\t\tif(!isFile(fp) || !checkFileType(fn, '.js')) {","\t\t\t// only load js file type","\t\t\tcontinue;","\t\t}","\t\t","\t\tm = loadFile(fp, context);","\t\t","\t\tif(!m) {","\t\t\tcontinue;","\t\t}","","\t\tvar name = m.name || getFileName(fn, '.js'.length);","\t\tres[name] = m;","\t}","\t","\treturn res;","};","","/**"," * Check file suffix",""," * @param fn {String} file name"," * @param suffix {String} suffix string, such as .js, etc."," */","var checkFileType = function(fn, suffix) {","\tif(suffix.charAt(0) !== '.') {","\t\tsuffix = '.' + suffix;","\t}","\t","\tif(fn.length <= suffix.length) {","\t\treturn false;","\t}","\t","\tvar str = fn.substring(fn.length - suffix.length).toLowerCase();","\tsuffix = suffix.toLowerCase();","\treturn str === suffix;","};","","var isFile = function(path) {","\treturn fs.statSync(path).isFile();","};","","var isDir = function(path) {","\treturn fs.statSync(path).isDirectory();","};","","var getFileName = function(fp, suffixLength) {","\tvar fn = path.basename(fp);","\tif(fn.length > suffixLength) {","\t\treturn fn.substring(0, fn.length - suffixLength);","\t}","","\treturn fn;","};","","var requireUncached = function(module){","    delete require.cache[require.resolve(module)]","    return require(module)","}"],"l":{"5":1,"6":1,"24":1,"25":0,"26":0,"29":0,"30":0,"32":0,"35":0,"36":0,"39":0,"42":1,"43":0,"45":0,"46":0,"49":0,"52":0,"55":0,"58":1,"59":0,"60":0,"61":0,"62":0,"65":0,"66":0,"69":0,"70":0,"71":0,"72":0,"74":0,"76":0,"79":0,"81":0,"82":0,"85":0,"86":0,"89":0,"98":1,"99":0,"100":0,"103":0,"104":0,"107":0,"108":0,"109":0,"112":1,"113":0,"116":1,"117":0,"120":1,"121":0,"122":0,"123":0,"126":0,"129":1,"130":0,"131":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/pathUtil.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/pathUtil.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":1,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":1,"24":0,"25":0,"26":1,"27":0,"28":1,"29":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":23},"end":{"line":12,"column":38}}},"2":{"name":"(anonymous_2)","line":24,"loc":{"start":{"line":24,"column":24},"end":{"line":24,"column":54}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":18},"end":{"line":36,"column":48}}},"4":{"name":"(anonymous_4)","line":48,"loc":{"start":{"line":48,"column":24},"end":{"line":48,"column":42}}},"5":{"name":"(anonymous_5)","line":51,"loc":{"start":{"line":51,"column":22},"end":{"line":51,"column":35}}},"6":{"name":"(anonymous_6)","line":68,"loc":{"start":{"line":68,"column":23},"end":{"line":68,"column":61}}},"7":{"name":"(anonymous_7)","line":79,"loc":{"start":{"line":79,"column":21},"end":{"line":79,"column":51}}},"8":{"name":"(anonymous_8)","line":90,"loc":{"start":{"line":90,"column":20},"end":{"line":90,"column":38}}},"9":{"name":"(anonymous_9)","line":100,"loc":{"start":{"line":100,"column":17},"end":{"line":100,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":25}},"5":{"start":{"line":12,"column":0},"end":{"line":15,"column":2}},"6":{"start":{"line":13,"column":2},"end":{"line":13,"column":59}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":37}},"8":{"start":{"line":24,"column":0},"end":{"line":27,"column":2}},"9":{"start":{"line":25,"column":2},"end":{"line":25,"column":80}},"10":{"start":{"line":26,"column":2},"end":{"line":26,"column":37}},"11":{"start":{"line":36,"column":0},"end":{"line":39,"column":2}},"12":{"start":{"line":37,"column":2},"end":{"line":37,"column":78}},"13":{"start":{"line":38,"column":2},"end":{"line":38,"column":37}},"14":{"start":{"line":48,"column":0},"end":{"line":58,"column":2}},"15":{"start":{"line":49,"column":2},"end":{"line":49,"column":49}},"16":{"start":{"line":50,"column":2},"end":{"line":50,"column":35}},"17":{"start":{"line":51,"column":2},"end":{"line":57,"column":5}},"18":{"start":{"line":52,"column":4},"end":{"line":54,"column":5}},"19":{"start":{"line":53,"column":6},"end":{"line":53,"column":19}},"20":{"start":{"line":56,"column":4},"end":{"line":56,"column":58}},"21":{"start":{"line":68,"column":0},"end":{"line":70,"column":2}},"22":{"start":{"line":69,"column":2},"end":{"line":69,"column":68}},"23":{"start":{"line":79,"column":0},"end":{"line":82,"column":2}},"24":{"start":{"line":80,"column":2},"end":{"line":80,"column":81}},"25":{"start":{"line":81,"column":2},"end":{"line":81,"column":37}},"26":{"start":{"line":90,"column":0},"end":{"line":92,"column":2}},"27":{"start":{"line":91,"column":2},"end":{"line":91,"column":50}},"28":{"start":{"line":100,"column":0},"end":{"line":102,"column":2}},"29":{"start":{"line":101,"column":2},"end":{"line":101,"column":47}}},"branchMap":{"1":{"line":14,"type":"cond-expr","locations":[{"start":{"line":14,"column":28},"end":{"line":14,"column":29}},{"start":{"line":14,"column":32},"end":{"line":14,"column":36}}]},"2":{"line":26,"type":"cond-expr","locations":[{"start":{"line":26,"column":28},"end":{"line":26,"column":29}},{"start":{"line":26,"column":32},"end":{"line":26,"column":36}}]},"3":{"line":38,"type":"cond-expr","locations":[{"start":{"line":38,"column":28},"end":{"line":38,"column":29}},{"start":{"line":38,"column":32},"end":{"line":38,"column":36}}]},"4":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"5":{"line":81,"type":"cond-expr","locations":[{"start":{"line":81,"column":28},"end":{"line":81,"column":29}},{"start":{"line":81,"column":32},"end":{"line":81,"column":36}}]}},"code":["var fs = require('fs');","var path = require('path');","var Constants = require('./constants');","var exp = module.exports;","","/**"," * Get system remote service path"," *"," * @param  {String} role server role: frontend, backend"," * @return {String}      path string if the path exist else null"," */","exp.getSysRemotePath = function(role) {","  var p = path.join(__dirname, '/../common/remote/', role);","  return fs.existsSync(p) ? p : null;","};","","/**"," * Get user remote service path"," *"," * @param  {String} appBase    application base path"," * @param  {String} serverType server type"," * @return {String}            path string if the path exist else null"," */","exp.getUserRemotePath = function(appBase, serverType) {","  var p = path.join(appBase, '/app/servers/', serverType, Constants.DIR.REMOTE);","  return fs.existsSync(p) ? p : null;","};","","/**"," * Get user remote cron path"," * "," * @param  {String} appBase    application base path"," * @param  {String} serverType server type"," * @return {String}            path string if the path exist else null"," */","exp.getCronPath = function(appBase, serverType) {","  var p = path.join(appBase, '/app/servers/', serverType, Constants.DIR.CRON);","  return fs.existsSync(p) ? p : null;","};","","/**"," * List all the subdirectory names of user remote directory"," * which hold the codes for all the server types."," *"," * @param  {String} appBase application base path"," * @return {Array}         all the subdiretory name under servers/"," */","exp.listUserRemoteDir = function(appBase) {","  var base = path.join(appBase, '/app/servers/');","  var files = fs.readdirSync(base);","  return files.filter(function(fn) {","    if(fn.charAt(0) === '.') {","      return false;","    }","","    return fs.statSync(path.join(base, fn)).isDirectory();","  });","};","","/**"," * Compose remote path record"," *"," * @param  {String} namespace  remote path namespace, such as: 'sys', 'user'"," * @param  {String} serverType"," * @param  {String} path       remote service source path"," * @return {Object}            remote path record"," */","exp.remotePathRecord = function(namespace, serverType, path) {","  return {namespace: namespace, serverType: serverType, path: path};","};","","/**"," * Get handler path"," *"," * @param  {String} appBase    application base path"," * @param  {String} serverType server type"," * @return {String}            path string if the path exist else null"," */","exp.getHandlerPath = function(appBase, serverType) {","  var p = path.join(appBase, '/app/servers/', serverType, Constants.DIR.HANDLER);","  return fs.existsSync(p) ? p : null;","};","","/**"," * Get admin script root path."," *"," * @param  {String} appBase application base path"," * @return {String}         script path string"," */","exp.getScriptPath = function(appBase) {","  return path.join(appBase, Constants.DIR.SCRIPT);","};","","/**"," * Get logs path."," *"," * @param  {String} appBase application base path"," * @return {String}         logs path string"," */","exp.getLogPath = function(appBase) {","  return path.join(appBase, Constants.DIR.LOG);","};"],"l":{"1":1,"2":1,"3":1,"4":1,"12":1,"13":0,"14":0,"24":1,"25":0,"26":0,"36":1,"37":0,"38":0,"48":1,"49":0,"50":0,"51":0,"52":0,"53":0,"56":0,"68":1,"69":0,"79":1,"80":0,"81":0,"90":1,"91":0,"100":1,"101":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/master.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/master.js","s":{"1":1,"2":1,"3":0,"4":1,"5":0,"6":1,"7":1,"8":1,"9":0,"10":1,"11":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":17},"end":{"line":12,"column":38}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":16},"end":{"line":21,"column":37}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":12},"end":{"line":35,"column":26}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":11},"end":{"line":46,"column":32}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":41}},"2":{"start":{"line":12,"column":0},"end":{"line":14,"column":2}},"3":{"start":{"line":13,"column":1},"end":{"line":13,"column":33}},"4":{"start":{"line":21,"column":0},"end":{"line":23,"column":2}},"5":{"start":{"line":22,"column":1},"end":{"line":22,"column":37}},"6":{"start":{"line":25,"column":0},"end":{"line":25,"column":30}},"7":{"start":{"line":27,"column":0},"end":{"line":27,"column":24}},"8":{"start":{"line":35,"column":0},"end":{"line":37,"column":2}},"9":{"start":{"line":36,"column":2},"end":{"line":36,"column":24}},"10":{"start":{"line":46,"column":0},"end":{"line":48,"column":2}},"11":{"start":{"line":47,"column":2},"end":{"line":47,"column":23}}},"branchMap":{},"code":["/**"," * Component for master."," */","var Master = require('../master/master');","","/**"," * Component factory function"," *"," * @param  {Object} app  current application context"," * @return {Object}      component instances"," */","module.exports = function (app, opts) {","\treturn new Component(app, opts);","};","","/**","* Master component class","*","* @param {Object} app  current application context","*/","var Component = function (app, opts) {","\tthis.master = new Master(app, opts);","};","","var pro = Component.prototype;","","pro.name = '__master__';","","/**"," * Component lifecycle function"," *"," * @param  {Function} cb"," * @return {Void}"," */","pro.start = function (cb) {","  this.master.start(cb);","};","","/**"," * Component lifecycle function"," *"," * @param  {Boolean}   force whether stop the component immediately"," * @param  {Function}  cb"," * @return {Void}"," */","pro.stop = function (force, cb) {","  this.master.stop(cb);","};",""],"l":{"4":1,"12":1,"13":0,"21":1,"22":0,"25":1,"27":1,"35":1,"36":0,"46":1,"47":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/master/master.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/master/master.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":1,"80":0,"81":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":13},"end":{"line":11,"column":33}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":25},"end":{"line":26,"column":38}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":27},"end":{"line":32,"column":41}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":42},"end":{"line":36,"column":56}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":33},"end":{"line":49,"column":47}}},"6":{"name":"(anonymous_6)","line":56,"loc":{"start":{"line":56,"column":37},"end":{"line":56,"column":51}}},"7":{"name":"(anonymous_7)","line":61,"loc":{"start":{"line":61,"column":38},"end":{"line":61,"column":71}}},"8":{"name":"(anonymous_8)","line":69,"loc":{"start":{"line":69,"column":21},"end":{"line":69,"column":36}}},"9":{"name":"(anonymous_9)","line":70,"loc":{"start":{"line":70,"column":31},"end":{"line":70,"column":42}}},"10":{"name":"(anonymous_10)","line":71,"loc":{"start":{"line":71,"column":34},"end":{"line":71,"column":49}}},"11":{"name":"(anonymous_11)","line":87,"loc":{"start":{"line":87,"column":19},"end":{"line":87,"column":30}}},"12":{"name":"(anonymous_12)","line":89,"loc":{"start":{"line":89,"column":32},"end":{"line":89,"column":49}}},"13":{"name":"(anonymous_13)","line":101,"loc":{"start":{"line":101,"column":21},"end":{"line":101,"column":32}}},"14":{"name":"(anonymous_14)","line":110,"loc":{"start":{"line":110,"column":36},"end":{"line":110,"column":53}}},"15":{"name":"(anonymous_15)","line":114,"loc":{"start":{"line":114,"column":37},"end":{"line":114,"column":58}}},"16":{"name":"(anonymous_16)","line":123,"loc":{"start":{"line":123,"column":24},"end":{"line":123,"column":37}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":70}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":78}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":78}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":37}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":47}},"9":{"start":{"line":9,"column":0},"end":{"line":9,"column":45}},"10":{"start":{"line":11,"column":0},"end":{"line":22,"column":2}},"11":{"start":{"line":12,"column":2},"end":{"line":12,"column":17}},"12":{"start":{"line":13,"column":2},"end":{"line":13,"column":36}},"13":{"start":{"line":14,"column":2},"end":{"line":14,"column":23}},"14":{"start":{"line":15,"column":2},"end":{"line":15,"column":20}},"15":{"start":{"line":16,"column":2},"end":{"line":16,"column":20}},"16":{"start":{"line":18,"column":2},"end":{"line":18,"column":35}},"17":{"start":{"line":19,"column":2},"end":{"line":19,"column":50}},"18":{"start":{"line":20,"column":2},"end":{"line":20,"column":40}},"19":{"start":{"line":21,"column":2},"end":{"line":21,"column":55}},"20":{"start":{"line":24,"column":0},"end":{"line":24,"column":24}},"21":{"start":{"line":26,"column":0},"end":{"line":121,"column":2}},"22":{"start":{"line":27,"column":2},"end":{"line":27,"column":71}},"23":{"start":{"line":28,"column":2},"end":{"line":28,"column":51}},"24":{"start":{"line":30,"column":2},"end":{"line":30,"column":18}},"25":{"start":{"line":32,"column":2},"end":{"line":47,"column":5}},"26":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"27":{"start":{"line":34,"column":6},"end":{"line":34,"column":22}},"28":{"start":{"line":36,"column":4},"end":{"line":46,"column":7}},"29":{"start":{"line":37,"column":6},"end":{"line":40,"column":7}},"30":{"start":{"line":38,"column":8},"end":{"line":38,"column":38}},"31":{"start":{"line":39,"column":8},"end":{"line":39,"column":15}},"32":{"start":{"line":42,"column":6},"end":{"line":44,"column":7}},"33":{"start":{"line":43,"column":8},"end":{"line":43,"column":37}},"34":{"start":{"line":45,"column":6},"end":{"line":45,"column":31}},"35":{"start":{"line":49,"column":2},"end":{"line":54,"column":5}},"36":{"start":{"line":50,"column":4},"end":{"line":53,"column":5}},"37":{"start":{"line":51,"column":6},"end":{"line":51,"column":72}},"38":{"start":{"line":52,"column":6},"end":{"line":52,"column":13}},"39":{"start":{"line":56,"column":2},"end":{"line":58,"column":5}},"40":{"start":{"line":57,"column":4},"end":{"line":57,"column":32}},"41":{"start":{"line":61,"column":2},"end":{"line":107,"column":5}},"42":{"start":{"line":62,"column":4},"end":{"line":62,"column":103}},"43":{"start":{"line":63,"column":4},"end":{"line":63,"column":18}},"44":{"start":{"line":64,"column":4},"end":{"line":64,"column":17}},"45":{"start":{"line":65,"column":4},"end":{"line":65,"column":25}},"46":{"start":{"line":66,"column":4},"end":{"line":66,"column":44}},"47":{"start":{"line":67,"column":4},"end":{"line":67,"column":72}},"48":{"start":{"line":68,"column":4},"end":{"line":106,"column":5}},"49":{"start":{"line":69,"column":6},"end":{"line":85,"column":8}},"50":{"start":{"line":70,"column":8},"end":{"line":84,"column":17}},"51":{"start":{"line":71,"column":10},"end":{"line":83,"column":13}},"52":{"start":{"line":72,"column":12},"end":{"line":82,"column":13}},"53":{"start":{"line":73,"column":14},"end":{"line":73,"column":23}},"54":{"start":{"line":75,"column":14},"end":{"line":75,"column":22}},"55":{"start":{"line":76,"column":14},"end":{"line":80,"column":15}},"56":{"start":{"line":77,"column":16},"end":{"line":77,"column":57}},"57":{"start":{"line":79,"column":16},"end":{"line":79,"column":61}},"58":{"start":{"line":81,"column":14},"end":{"line":81,"column":29}},"59":{"start":{"line":86,"column":6},"end":{"line":86,"column":21}},"60":{"start":{"line":87,"column":6},"end":{"line":105,"column":8}},"61":{"start":{"line":88,"column":8},"end":{"line":88,"column":32}},"62":{"start":{"line":89,"column":8},"end":{"line":104,"column":11}},"63":{"start":{"line":90,"column":10},"end":{"line":100,"column":11}},"64":{"start":{"line":91,"column":12},"end":{"line":91,"column":91}},"65":{"start":{"line":92,"column":12},"end":{"line":92,"column":19}},"66":{"start":{"line":93,"column":17},"end":{"line":100,"column":11}},"67":{"start":{"line":94,"column":12},"end":{"line":99,"column":13}},"68":{"start":{"line":95,"column":14},"end":{"line":95,"column":49}},"69":{"start":{"line":97,"column":14},"end":{"line":97,"column":102}},"70":{"start":{"line":98,"column":14},"end":{"line":98,"column":21}},"71":{"start":{"line":101,"column":10},"end":{"line":103,"column":44}},"72":{"start":{"line":102,"column":12},"end":{"line":102,"column":48}},"73":{"start":{"line":110,"column":2},"end":{"line":112,"column":5}},"74":{"start":{"line":111,"column":4},"end":{"line":111,"column":56}},"75":{"start":{"line":114,"column":2},"end":{"line":120,"column":5}},"76":{"start":{"line":115,"column":4},"end":{"line":119,"column":5}},"77":{"start":{"line":116,"column":6},"end":{"line":116,"column":45}},"78":{"start":{"line":118,"column":6},"end":{"line":118,"column":44}},"79":{"start":{"line":123,"column":0},"end":{"line":126,"column":2}},"80":{"start":{"line":124,"column":2},"end":{"line":124,"column":28}},"81":{"start":{"line":125,"column":2},"end":{"line":125,"column":23}}},"branchMap":{"1":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":9},"end":{"line":16,"column":13}},{"start":{"line":16,"column":17},"end":{"line":16,"column":19}}]},"2":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"3":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":6},"end":{"line":37,"column":6}},{"start":{"line":37,"column":6},"end":{"line":37,"column":6}}]},"4":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":6},"end":{"line":42,"column":6}},{"start":{"line":42,"column":6},"end":{"line":42,"column":6}}]},"5":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":4},"end":{"line":50,"column":4}},{"start":{"line":50,"column":4},"end":{"line":50,"column":4}}]},"6":{"line":62,"type":"binary-expr","locations":[{"start":{"line":62,"column":78},"end":{"line":62,"column":84}},{"start":{"line":62,"column":88},"end":{"line":62,"column":100}}]},"7":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":20},"end":{"line":67,"column":65}},{"start":{"line":67,"column":69},"end":{"line":67,"column":71}}]},"8":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":68,"column":4}},{"start":{"line":68,"column":4},"end":{"line":68,"column":4}}]},"9":{"line":68,"type":"binary-expr","locations":[{"start":{"line":68,"column":7},"end":{"line":68,"column":15}},{"start":{"line":68,"column":20},"end":{"line":68,"column":70}},{"start":{"line":68,"column":74},"end":{"line":68,"column":125}},{"start":{"line":68,"column":130},"end":{"line":68,"column":155}}]},"10":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":12},"end":{"line":72,"column":12}},{"start":{"line":72,"column":12},"end":{"line":72,"column":12}}]},"11":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":14},"end":{"line":76,"column":14}},{"start":{"line":76,"column":14},"end":{"line":76,"column":14}}]},"12":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":10},"end":{"line":90,"column":10}},{"start":{"line":90,"column":10},"end":{"line":90,"column":10}}]},"13":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":17},"end":{"line":93,"column":17}},{"start":{"line":93,"column":17},"end":{"line":93,"column":17}}]},"14":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":12},"end":{"line":94,"column":12}},{"start":{"line":94,"column":12},"end":{"line":94,"column":12}}]},"15":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":4},"end":{"line":115,"column":4}},{"start":{"line":115,"column":4},"end":{"line":115,"column":4}}]}},"code":["var starter = require('./starter');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var crashLogger = require('pomelo-logger').getLogger('crash-log', __filename);","var adminLogger = require('pomelo-logger').getLogger('admin-log', __filename);","var admin = require('pomelo-admin');","var util = require('util');","var utils = require('../util/utils');","var moduleUtil = require('../util/moduleUtil');","var Constants = require('../util/constants');","","var Server = function(app, opts) {","  this.app = app;","  this.masterInfo = app.getMaster();","  this.registered = {};","  this.modules = [];","  opts = opts || {};","  ","  opts.port = this.masterInfo.port;","  opts.env = this.app.get(Constants.RESERVED.ENV);","  this.closeWatcher = opts.closeWatcher;","  this.masterConsole = admin.createMasterConsole(opts);","};","","module.exports = Server;","","Server.prototype.start = function(cb) {","  moduleUtil.registerDefaultModules(true, this.app, this.closeWatcher);","  moduleUtil.loadModules(this, this.masterConsole);","","  var self = this;","  // start master console","  this.masterConsole.start(function(err) {","    if(err) {","      process.exit(0);","    }","    moduleUtil.startModules(self.modules, function(err) {","      if(err) {","        utils.invokeCallback(cb, err);","        return;","      }","","      if(self.app.get(Constants.RESERVED.MODE) !== Constants.RESERVED.STAND_ALONE) {","        starter.runServers(self.app);","      }","      utils.invokeCallback(cb);","    });","  });","  ","  this.masterConsole.on('error', function(err) {","    if(!!err) {","      logger.error('masterConsole encounters with error: ' + err.stack);","      return;","    }","  });","  ","  this.masterConsole.on('reconnect', function(info){","    self.app.addServers([info]);","  });","","  // monitor servers disconnect event","  this.masterConsole.on('disconnect', function(id, type, info, reason) {","    crashLogger.info(util.format('[%s],[%s],[%s],[%s]', type, id, Date.now(), reason || 'disconnect'));","    var count = 0;","    var time = 0;","    var pingTimer = null;","    var server = self.app.getServerById(id);","    var stopFlags = self.app.get(Constants.RESERVED.STOP_SERVERS) || [];","    if(!!server && (server[Constants.RESERVED.AUTO_RESTART] === 'true' || server[Constants.RESERVED.RESTART_FORCE] === 'true') && stopFlags.indexOf(id) < 0) {","      var setTimer = function(time) {","        pingTimer = setTimeout(function() {","          utils.ping(server.host, function(flag) {","            if(flag)  {","              handle();","            } else {","              count++;","              if(count > 3) {","                time = Constants.TIME.TIME_WAIT_MAX_PING;","              } else {","                time = Constants.TIME.TIME_WAIT_PING * count;","              }","              setTimer(time);","            }","          });","        }, time);","      };","      setTimer(time);","      var handle = function() {","        clearTimeout(pingTimer);","        utils.checkPort(server, function(status) {","          if(status === 'error') {","            utils.invokeCallback(cb, new Error('Check port command executed with error.'));","            return;","          } else if(status === 'busy') {","            if(!!server[Constants.RESERVED.RESTART_FORCE]) {","              starter.kill([info.pid], [server]);","            } else {","              utils.invokeCallback(cb, new Error('Port occupied already, check your server to add.'));","              return;","            }","          }","          setTimeout(function() {","            starter.run(self.app, server, null);","          }, Constants.TIME.TIME_WAIT_STOP);","        });","      };","    }","  });","","  // monitor servers register event","  this.masterConsole.on('register', function(record) {","    starter.bindCpu(record.id, record.pid, record.host);","  });","","  this.masterConsole.on('admin-log', function(log, error) {","    if(error) {","      adminLogger.error(JSON.stringify(log));","    } else {","      adminLogger.info(JSON.stringify(log));","    }","  });","};","","Server.prototype.stop = function(cb) {","  this.masterConsole.stop();","  process.nextTick(cb);","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"18":0,"19":0,"20":0,"21":0,"24":1,"26":1,"27":0,"28":0,"30":0,"32":0,"33":0,"34":0,"36":0,"37":0,"38":0,"39":0,"42":0,"43":0,"45":0,"49":0,"50":0,"51":0,"52":0,"56":0,"57":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"75":0,"76":0,"77":0,"79":0,"81":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"97":0,"98":0,"101":0,"102":0,"110":0,"111":0,"114":0,"115":0,"116":0,"118":0,"123":1,"124":0,"125":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":6,"9":6,"10":6,"11":6,"12":5,"13":0},"b":{"1":[6,0],"2":[5,1]},"f":{"1":6,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":51},"end":{"line":9,"column":70}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":42},"end":{"line":14,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":53}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":72}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":74}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":60}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":21}},"7":{"start":{"line":9,"column":0},"end":{"line":19,"column":3}},"8":{"start":{"line":10,"column":1},"end":{"line":18,"column":2}},"9":{"start":{"line":11,"column":2},"end":{"line":11,"column":59}},"10":{"start":{"line":12,"column":2},"end":{"line":12,"column":49}},"11":{"start":{"line":13,"column":2},"end":{"line":17,"column":3}},"12":{"start":{"line":14,"column":3},"end":{"line":16,"column":6}},"13":{"start":{"line":15,"column":4},"end":{"line":15,"column":19}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},{"start":{"line":10,"column":1},"end":{"line":10,"column":1}}]},"2":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":2},"end":{"line":13,"column":2}},{"start":{"line":13,"column":2},"end":{"line":13,"column":2}}]}},"code":["var fs = require('fs');","var consoleService = require('./lib/consoleService');","","module.exports.createMasterConsole = consoleService.createMasterConsole;","module.exports.createMonitorConsole = consoleService.createMonitorConsole;","module.exports.adminClient = require('./lib/client/client');","","exports.modules = {};","fs.readdirSync(__dirname + '/lib/modules').forEach(function(filename) {","\tif (/\\.js$/.test(filename)) {","\t\tvar name = filename.substr(0, filename.lastIndexOf('.'));","\t\tvar _module = require('./lib/modules/' + name);","\t\tif (!_module.moduleError) {","\t\t\texports.modules.__defineGetter__(name, function() {","\t\t\t\treturn _module;","\t\t\t});","\t\t}","\t}","});"],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"8":1,"9":1,"10":6,"11":6,"12":6,"13":6,"14":5,"15":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/consoleService.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/consoleService.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":1,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":1,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":1,"110":0,"111":1,"112":0,"113":1,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":1,"129":0,"130":0,"131":1,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":1,"142":0,"143":0,"144":0,"145":0,"146":1,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":1,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":1,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":1,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":1,"202":0,"203":0,"204":0,"205":1,"206":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0,0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0,0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0,0],"50":[0,0],"51":[0,0],"52":[0,0,0],"53":[0,0],"54":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":21},"end":{"line":26,"column":36}}},"2":{"name":"(anonymous_2)","line":66,"loc":{"start":{"line":66,"column":33},"end":{"line":66,"column":46}}},"3":{"name":"(anonymous_3)","line":69,"loc":{"start":{"line":69,"column":31},"end":{"line":69,"column":45}}},"4":{"name":"(anonymous_4)","line":78,"loc":{"start":{"line":78,"column":20},"end":{"line":78,"column":31}}},"5":{"name":"(anonymous_5)","line":100,"loc":{"start":{"line":100,"column":32},"end":{"line":100,"column":43}}},"6":{"name":"(anonymous_6)","line":114,"loc":{"start":{"line":114,"column":36},"end":{"line":114,"column":63}}},"7":{"name":"(anonymous_7)","line":124,"loc":{"start":{"line":124,"column":34},"end":{"line":124,"column":53}}},"8":{"name":"(anonymous_8)","line":140,"loc":{"start":{"line":140,"column":35},"end":{"line":140,"column":54}}},"9":{"name":"(anonymous_9)","line":162,"loc":{"start":{"line":162,"column":35},"end":{"line":162,"column":71}}},"10":{"name":"(anonymous_10)","line":206,"loc":{"start":{"line":206,"column":35},"end":{"line":206,"column":72}}},"11":{"name":"(anonymous_11)","line":240,"loc":{"start":{"line":240,"column":31},"end":{"line":240,"column":57}}},"12":{"name":"(anonymous_12)","line":250,"loc":{"start":{"line":250,"column":31},"end":{"line":250,"column":50}}},"13":{"name":"(anonymous_13)","line":262,"loc":{"start":{"line":262,"column":21},"end":{"line":262,"column":57}}},"14":{"name":"(anonymous_14)","line":298,"loc":{"start":{"line":298,"column":20},"end":{"line":298,"column":46}}},"15":{"name":"(anonymous_15)","line":317,"loc":{"start":{"line":317,"column":20},"end":{"line":317,"column":35}}},"16":{"name":"(anonymous_16)","line":325,"loc":{"start":{"line":325,"column":51},"end":{"line":325,"column":65}}},"17":{"name":"(anonymous_17)","line":329,"loc":{"start":{"line":329,"column":52},"end":{"line":329,"column":66}}},"18":{"name":"(anonymous_18)","line":343,"loc":{"start":{"line":343,"column":18},"end":{"line":343,"column":48}}},"19":{"name":"(anonymous_19)","line":344,"loc":{"start":{"line":344,"column":17},"end":{"line":344,"column":28}}},"20":{"name":"(anonymous_20)","line":354,"loc":{"start":{"line":354,"column":18},"end":{"line":354,"column":62}}},"21":{"name":"(anonymous_21)","line":374,"loc":{"start":{"line":374,"column":20},"end":{"line":374,"column":64}}},"22":{"name":"(anonymous_22)","line":400,"loc":{"start":{"line":400,"column":21},"end":{"line":400,"column":65}}},"23":{"name":"(anonymous_23)","line":423,"loc":{"start":{"line":423,"column":17},"end":{"line":423,"column":64}}},"24":{"name":"(anonymous_24)","line":458,"loc":{"start":{"line":458,"column":37},"end":{"line":458,"column":52}}},"25":{"name":"(anonymous_25)","line":473,"loc":{"start":{"line":473,"column":38},"end":{"line":473,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":82}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":53}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":50}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":50}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":43}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":42}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":27}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":24}},"10":{"start":{"line":26,"column":0},"end":{"line":56,"column":2}},"11":{"start":{"line":27,"column":1},"end":{"line":27,"column":25}},"12":{"start":{"line":28,"column":1},"end":{"line":28,"column":23}},"13":{"start":{"line":29,"column":1},"end":{"line":29,"column":21}},"14":{"start":{"line":30,"column":1},"end":{"line":30,"column":18}},"15":{"start":{"line":31,"column":1},"end":{"line":31,"column":27}},"16":{"start":{"line":33,"column":1},"end":{"line":33,"column":19}},"17":{"start":{"line":34,"column":1},"end":{"line":38,"column":3}},"18":{"start":{"line":40,"column":1},"end":{"line":55,"column":2}},"19":{"start":{"line":41,"column":2},"end":{"line":41,"column":57}},"20":{"start":{"line":42,"column":2},"end":{"line":42,"column":69}},"21":{"start":{"line":43,"column":2},"end":{"line":43,"column":43}},"22":{"start":{"line":45,"column":2},"end":{"line":45,"column":24}},"23":{"start":{"line":46,"column":2},"end":{"line":46,"column":20}},"24":{"start":{"line":47,"column":2},"end":{"line":47,"column":24}},"25":{"start":{"line":48,"column":2},"end":{"line":48,"column":70}},"26":{"start":{"line":49,"column":2},"end":{"line":54,"column":5}},"27":{"start":{"line":58,"column":0},"end":{"line":58,"column":44}},"28":{"start":{"line":66,"column":0},"end":{"line":93,"column":2}},"29":{"start":{"line":67,"column":1},"end":{"line":86,"column":2}},"30":{"start":{"line":68,"column":2},"end":{"line":68,"column":18}},"31":{"start":{"line":69,"column":2},"end":{"line":81,"column":5}},"32":{"start":{"line":70,"column":3},"end":{"line":73,"column":4}},"33":{"start":{"line":71,"column":4},"end":{"line":71,"column":34}},"34":{"start":{"line":72,"column":4},"end":{"line":72,"column":11}},"35":{"start":{"line":75,"column":3},"end":{"line":75,"column":45}},"36":{"start":{"line":76,"column":3},"end":{"line":76,"column":47}},"37":{"start":{"line":77,"column":3},"end":{"line":77,"column":46}},"38":{"start":{"line":78,"column":3},"end":{"line":80,"column":6}},"39":{"start":{"line":79,"column":4},"end":{"line":79,"column":29}},"40":{"start":{"line":83,"column":2},"end":{"line":83,"column":84}},"41":{"start":{"line":84,"column":2},"end":{"line":84,"column":47}},"42":{"start":{"line":85,"column":2},"end":{"line":85,"column":41}},"43":{"start":{"line":88,"column":1},"end":{"line":88,"column":40}},"44":{"start":{"line":90,"column":1},"end":{"line":92,"column":2}},"45":{"start":{"line":91,"column":2},"end":{"line":91,"column":19}},"46":{"start":{"line":100,"column":0},"end":{"line":105,"column":2}},"47":{"start":{"line":101,"column":1},"end":{"line":103,"column":2}},"48":{"start":{"line":102,"column":2},"end":{"line":102,"column":20}},"49":{"start":{"line":104,"column":1},"end":{"line":104,"column":20}},"50":{"start":{"line":114,"column":0},"end":{"line":116,"column":2}},"51":{"start":{"line":115,"column":1},"end":{"line":115,"column":65}},"52":{"start":{"line":124,"column":0},"end":{"line":132,"column":2}},"53":{"start":{"line":125,"column":1},"end":{"line":125,"column":37}},"54":{"start":{"line":126,"column":1},"end":{"line":130,"column":2}},"55":{"start":{"line":127,"column":2},"end":{"line":127,"column":23}},"56":{"start":{"line":128,"column":2},"end":{"line":128,"column":30}},"57":{"start":{"line":129,"column":2},"end":{"line":129,"column":14}},"58":{"start":{"line":131,"column":1},"end":{"line":131,"column":14}},"59":{"start":{"line":140,"column":0},"end":{"line":151,"column":2}},"60":{"start":{"line":141,"column":1},"end":{"line":141,"column":37}},"61":{"start":{"line":142,"column":1},"end":{"line":149,"column":2}},"62":{"start":{"line":143,"column":2},"end":{"line":143,"column":24}},"63":{"start":{"line":144,"column":2},"end":{"line":147,"column":3}},"64":{"start":{"line":145,"column":3},"end":{"line":145,"column":36}},"65":{"start":{"line":146,"column":3},"end":{"line":146,"column":25}},"66":{"start":{"line":148,"column":2},"end":{"line":148,"column":14}},"67":{"start":{"line":150,"column":1},"end":{"line":150,"column":14}},"68":{"start":{"line":162,"column":0},"end":{"line":204,"column":2}},"69":{"start":{"line":163,"column":1},"end":{"line":163,"column":17}},"70":{"start":{"line":164,"column":1},"end":{"line":164,"column":32}},"71":{"start":{"line":165,"column":1},"end":{"line":169,"column":2}},"72":{"start":{"line":166,"column":2},"end":{"line":166,"column":48}},"73":{"start":{"line":167,"column":2},"end":{"line":167,"column":37}},"74":{"start":{"line":168,"column":2},"end":{"line":168,"column":9}},"75":{"start":{"line":171,"column":1},"end":{"line":175,"column":2}},"76":{"start":{"line":172,"column":2},"end":{"line":172,"column":50}},"77":{"start":{"line":173,"column":2},"end":{"line":173,"column":43}},"78":{"start":{"line":174,"column":2},"end":{"line":174,"column":9}},"79":{"start":{"line":177,"column":1},"end":{"line":177,"column":23}},"80":{"start":{"line":178,"column":1},"end":{"line":182,"column":2}},"81":{"start":{"line":179,"column":2},"end":{"line":179,"column":80}},"82":{"start":{"line":180,"column":2},"end":{"line":180,"column":72}},"83":{"start":{"line":181,"column":2},"end":{"line":181,"column":9}},"84":{"start":{"line":184,"column":1},"end":{"line":189,"column":2}},"85":{"start":{"line":191,"column":1},"end":{"line":191,"column":71}},"86":{"start":{"line":192,"column":1},"end":{"line":197,"column":2}},"87":{"start":{"line":193,"column":2},"end":{"line":193,"column":24}},"88":{"start":{"line":194,"column":2},"end":{"line":194,"column":38}},"89":{"start":{"line":195,"column":2},"end":{"line":195,"column":30}},"90":{"start":{"line":196,"column":2},"end":{"line":196,"column":9}},"91":{"start":{"line":199,"column":1},"end":{"line":201,"column":2}},"92":{"start":{"line":200,"column":2},"end":{"line":200,"column":30}},"93":{"start":{"line":203,"column":1},"end":{"line":203,"column":37}},"94":{"start":{"line":206,"column":0},"end":{"line":230,"column":1}},"95":{"start":{"line":207,"column":1},"end":{"line":207,"column":17}},"96":{"start":{"line":208,"column":1},"end":{"line":208,"column":34}},"97":{"start":{"line":209,"column":1},"end":{"line":212,"column":2}},"98":{"start":{"line":210,"column":2},"end":{"line":210,"column":35}},"99":{"start":{"line":211,"column":2},"end":{"line":211,"column":9}},"100":{"start":{"line":214,"column":1},"end":{"line":218,"column":2}},"101":{"start":{"line":220,"column":1},"end":{"line":220,"column":69}},"102":{"start":{"line":221,"column":1},"end":{"line":226,"column":2}},"103":{"start":{"line":222,"column":2},"end":{"line":222,"column":24}},"104":{"start":{"line":223,"column":2},"end":{"line":223,"column":38}},"105":{"start":{"line":224,"column":2},"end":{"line":224,"column":30}},"106":{"start":{"line":225,"column":2},"end":{"line":225,"column":9}},"107":{"start":{"line":228,"column":1},"end":{"line":228,"column":29}},"108":{"start":{"line":229,"column":1},"end":{"line":229,"column":30}},"109":{"start":{"line":240,"column":0},"end":{"line":242,"column":2}},"110":{"start":{"line":241,"column":1},"end":{"line":241,"column":31}},"111":{"start":{"line":250,"column":0},"end":{"line":252,"column":2}},"112":{"start":{"line":251,"column":1},"end":{"line":251,"column":30}},"113":{"start":{"line":262,"column":0},"end":{"line":289,"column":2}},"114":{"start":{"line":263,"column":1},"end":{"line":267,"column":3}},"115":{"start":{"line":269,"column":1},"end":{"line":286,"column":2}},"116":{"start":{"line":270,"column":2},"end":{"line":285,"column":3}},"117":{"start":{"line":272,"column":3},"end":{"line":272,"column":36}},"118":{"start":{"line":273,"column":3},"end":{"line":273,"column":42}},"119":{"start":{"line":275,"column":3},"end":{"line":277,"column":4}},"120":{"start":{"line":276,"column":4},"end":{"line":276,"column":21}},"121":{"start":{"line":278,"column":3},"end":{"line":280,"column":4}},"122":{"start":{"line":279,"column":4},"end":{"line":279,"column":24}},"123":{"start":{"line":281,"column":3},"end":{"line":281,"column":48}},"124":{"start":{"line":282,"column":3},"end":{"line":282,"column":32}},"125":{"start":{"line":283,"column":3},"end":{"line":283,"column":35}},"126":{"start":{"line":284,"column":3},"end":{"line":284,"column":26}},"127":{"start":{"line":288,"column":1},"end":{"line":288,"column":15}},"128":{"start":{"line":298,"column":0},"end":{"line":309,"column":2}},"129":{"start":{"line":299,"column":1},"end":{"line":308,"column":2}},"130":{"start":{"line":300,"column":2},"end":{"line":307,"column":6}},"131":{"start":{"line":317,"column":0},"end":{"line":333,"column":2}},"132":{"start":{"line":318,"column":1},"end":{"line":318,"column":28}},"133":{"start":{"line":319,"column":1},"end":{"line":319,"column":26}},"134":{"start":{"line":320,"column":1},"end":{"line":322,"column":2}},"135":{"start":{"line":321,"column":2},"end":{"line":321,"column":9}},"136":{"start":{"line":324,"column":1},"end":{"line":332,"column":2}},"137":{"start":{"line":325,"column":2},"end":{"line":327,"column":5}},"138":{"start":{"line":326,"column":3},"end":{"line":326,"column":61}},"139":{"start":{"line":329,"column":2},"end":{"line":331,"column":5}},"140":{"start":{"line":330,"column":3},"end":{"line":330,"column":61}},"141":{"start":{"line":343,"column":0},"end":{"line":349,"column":2}},"142":{"start":{"line":344,"column":1},"end":{"line":348,"column":4}},"143":{"start":{"line":345,"column":2},"end":{"line":345,"column":54}},"144":{"start":{"line":346,"column":2},"end":{"line":346,"column":22}},"145":{"start":{"line":347,"column":2},"end":{"line":347,"column":32}},"146":{"start":{"line":354,"column":0},"end":{"line":369,"column":2}},"147":{"start":{"line":355,"column":1},"end":{"line":355,"column":38}},"148":{"start":{"line":357,"column":1},"end":{"line":357,"column":17}},"149":{"start":{"line":358,"column":1},"end":{"line":364,"column":2}},"150":{"start":{"line":359,"column":2},"end":{"line":361,"column":3}},"151":{"start":{"line":360,"column":3},"end":{"line":360,"column":12}},"152":{"start":{"line":363,"column":2},"end":{"line":363,"column":24}},"153":{"start":{"line":366,"column":1},"end":{"line":368,"column":4}},"154":{"start":{"line":374,"column":0},"end":{"line":395,"column":2}},"155":{"start":{"line":375,"column":1},"end":{"line":379,"column":2}},"156":{"start":{"line":376,"column":2},"end":{"line":376,"column":62}},"157":{"start":{"line":377,"column":2},"end":{"line":377,"column":23}},"158":{"start":{"line":378,"column":2},"end":{"line":378,"column":9}},"159":{"start":{"line":381,"column":1},"end":{"line":381,"column":38}},"160":{"start":{"line":382,"column":1},"end":{"line":385,"column":2}},"161":{"start":{"line":383,"column":2},"end":{"line":383,"column":30}},"162":{"start":{"line":384,"column":2},"end":{"line":384,"column":9}},"163":{"start":{"line":387,"column":1},"end":{"line":394,"column":2}},"164":{"start":{"line":388,"column":2},"end":{"line":388,"column":34}},"165":{"start":{"line":389,"column":2},"end":{"line":389,"column":62}},"166":{"start":{"line":390,"column":2},"end":{"line":390,"column":28}},"167":{"start":{"line":392,"column":2},"end":{"line":392,"column":34}},"168":{"start":{"line":393,"column":2},"end":{"line":393,"column":28}},"169":{"start":{"line":400,"column":0},"end":{"line":421,"column":2}},"170":{"start":{"line":401,"column":1},"end":{"line":405,"column":2}},"171":{"start":{"line":402,"column":2},"end":{"line":402,"column":62}},"172":{"start":{"line":403,"column":2},"end":{"line":403,"column":23}},"173":{"start":{"line":404,"column":2},"end":{"line":404,"column":9}},"174":{"start":{"line":407,"column":1},"end":{"line":407,"column":38}},"175":{"start":{"line":408,"column":1},"end":{"line":411,"column":2}},"176":{"start":{"line":409,"column":2},"end":{"line":409,"column":30}},"177":{"start":{"line":410,"column":2},"end":{"line":410,"column":9}},"178":{"start":{"line":413,"column":1},"end":{"line":420,"column":2}},"179":{"start":{"line":414,"column":2},"end":{"line":414,"column":35}},"180":{"start":{"line":415,"column":2},"end":{"line":415,"column":63}},"181":{"start":{"line":416,"column":2},"end":{"line":416,"column":28}},"182":{"start":{"line":418,"column":2},"end":{"line":418,"column":35}},"183":{"start":{"line":419,"column":2},"end":{"line":419,"column":28}},"184":{"start":{"line":423,"column":0},"end":{"line":450,"column":1}},"185":{"start":{"line":424,"column":1},"end":{"line":433,"column":2}},"186":{"start":{"line":425,"column":2},"end":{"line":427,"column":3}},"187":{"start":{"line":426,"column":3},"end":{"line":426,"column":12}},"188":{"start":{"line":429,"column":2},"end":{"line":429,"column":26}},"189":{"start":{"line":430,"column":2},"end":{"line":432,"column":3}},"190":{"start":{"line":431,"column":3},"end":{"line":431,"column":12}},"191":{"start":{"line":435,"column":1},"end":{"line":435,"column":29}},"192":{"start":{"line":436,"column":1},"end":{"line":438,"column":2}},"193":{"start":{"line":437,"column":2},"end":{"line":437,"column":27}},"194":{"start":{"line":440,"column":1},"end":{"line":440,"column":45}},"195":{"start":{"line":441,"column":1},"end":{"line":448,"column":2}},"196":{"start":{"line":442,"column":2},"end":{"line":442,"column":33}},"197":{"start":{"line":443,"column":2},"end":{"line":445,"column":3}},"198":{"start":{"line":444,"column":3},"end":{"line":444,"column":38}},"199":{"start":{"line":447,"column":2},"end":{"line":447,"column":29}},"200":{"start":{"line":449,"column":1},"end":{"line":449,"column":10}},"201":{"start":{"line":458,"column":0},"end":{"line":462,"column":2}},"202":{"start":{"line":459,"column":1},"end":{"line":459,"column":19}},"203":{"start":{"line":460,"column":1},"end":{"line":460,"column":20}},"204":{"start":{"line":461,"column":1},"end":{"line":461,"column":33}},"205":{"start":{"line":473,"column":0},"end":{"line":475,"column":2}},"206":{"start":{"line":474,"column":1},"end":{"line":474,"column":33}}},"branchMap":{"1":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},{"start":{"line":40,"column":1},"end":{"line":40,"column":1}}]},"2":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":18},"end":{"line":41,"column":31}},{"start":{"line":41,"column":35},"end":{"line":41,"column":56}}]},"3":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":20},"end":{"line":42,"column":35}},{"start":{"line":42,"column":39},"end":{"line":42,"column":68}}]},"4":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":20},"end":{"line":48,"column":35}},{"start":{"line":48,"column":39},"end":{"line":48,"column":69}}]},"5":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},{"start":{"line":67,"column":1},"end":{"line":67,"column":1}}]},"6":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":3},"end":{"line":70,"column":3}},{"start":{"line":70,"column":3},"end":{"line":70,"column":3}}]},"7":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},{"start":{"line":126,"column":1},"end":{"line":126,"column":1}}]},"8":{"line":126,"type":"binary-expr","locations":[{"start":{"line":126,"column":5},"end":{"line":126,"column":11}},{"start":{"line":126,"column":15},"end":{"line":126,"column":29}}]},"9":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},{"start":{"line":142,"column":1},"end":{"line":142,"column":1}}]},"10":{"line":142,"type":"binary-expr","locations":[{"start":{"line":142,"column":5},"end":{"line":142,"column":11}},{"start":{"line":142,"column":15},"end":{"line":142,"column":28}}]},"11":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":2},"end":{"line":144,"column":2}},{"start":{"line":144,"column":2},"end":{"line":144,"column":2}}]},"12":{"line":144,"type":"binary-expr","locations":[{"start":{"line":144,"column":6},"end":{"line":144,"column":21}},{"start":{"line":144,"column":25},"end":{"line":144,"column":37}}]},"13":{"line":165,"type":"if","locations":[{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},{"start":{"line":165,"column":1},"end":{"line":165,"column":1}}]},"14":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},{"start":{"line":171,"column":1},"end":{"line":171,"column":1}}]},"15":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},{"start":{"line":178,"column":1},"end":{"line":178,"column":1}}]},"16":{"line":178,"type":"binary-expr","locations":[{"start":{"line":178,"column":5},"end":{"line":178,"column":12}},{"start":{"line":178,"column":16},"end":{"line":178,"column":52}}]},"17":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},{"start":{"line":192,"column":1},"end":{"line":192,"column":1}}]},"18":{"line":192,"type":"binary-expr","locations":[{"start":{"line":192,"column":5},"end":{"line":192,"column":17}},{"start":{"line":192,"column":21},"end":{"line":192,"column":33}}]},"19":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},{"start":{"line":199,"column":1},"end":{"line":199,"column":1}}]},"20":{"line":209,"type":"if","locations":[{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},{"start":{"line":209,"column":1},"end":{"line":209,"column":1}}]},"21":{"line":209,"type":"binary-expr","locations":[{"start":{"line":209,"column":5},"end":{"line":209,"column":9}},{"start":{"line":209,"column":13},"end":{"line":209,"column":38}}]},"22":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},{"start":{"line":221,"column":1},"end":{"line":221,"column":1}}]},"23":{"line":221,"type":"binary-expr","locations":[{"start":{"line":221,"column":5},"end":{"line":221,"column":17}},{"start":{"line":221,"column":21},"end":{"line":221,"column":33}}]},"24":{"line":269,"type":"if","locations":[{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},{"start":{"line":269,"column":1},"end":{"line":269,"column":1}}]},"25":{"line":269,"type":"binary-expr","locations":[{"start":{"line":269,"column":5},"end":{"line":269,"column":16}},{"start":{"line":269,"column":20},"end":{"line":269,"column":35}}]},"26":{"line":270,"type":"if","locations":[{"start":{"line":270,"column":2},"end":{"line":270,"column":2}},{"start":{"line":270,"column":2},"end":{"line":270,"column":2}}]},"27":{"line":270,"type":"binary-expr","locations":[{"start":{"line":270,"column":6},"end":{"line":270,"column":21}},{"start":{"line":270,"column":25},"end":{"line":270,"column":54}},{"start":{"line":270,"column":58},"end":{"line":270,"column":72}},{"start":{"line":270,"column":76},"end":{"line":270,"column":105}}]},"28":{"line":272,"type":"binary-expr","locations":[{"start":{"line":272,"column":18},"end":{"line":272,"column":30}},{"start":{"line":272,"column":34},"end":{"line":272,"column":35}}]},"29":{"line":273,"type":"binary-expr","locations":[{"start":{"line":273,"column":21},"end":{"line":273,"column":36}},{"start":{"line":273,"column":40},"end":{"line":273,"column":41}}]},"30":{"line":275,"type":"if","locations":[{"start":{"line":275,"column":3},"end":{"line":275,"column":3}},{"start":{"line":275,"column":3},"end":{"line":275,"column":3}}]},"31":{"line":278,"type":"if","locations":[{"start":{"line":278,"column":3},"end":{"line":278,"column":3}},{"start":{"line":278,"column":3},"end":{"line":278,"column":3}}]},"32":{"line":299,"type":"if","locations":[{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},{"start":{"line":299,"column":1},"end":{"line":299,"column":1}}]},"33":{"line":299,"type":"binary-expr","locations":[{"start":{"line":299,"column":5},"end":{"line":299,"column":11}},{"start":{"line":299,"column":15},"end":{"line":299,"column":30}}]},"34":{"line":320,"type":"if","locations":[{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},{"start":{"line":320,"column":1},"end":{"line":320,"column":1}}]},"35":{"line":320,"type":"binary-expr","locations":[{"start":{"line":320,"column":5},"end":{"line":320,"column":13}},{"start":{"line":320,"column":17},"end":{"line":320,"column":24}},{"start":{"line":320,"column":28},"end":{"line":320,"column":42}},{"start":{"line":320,"column":46},"end":{"line":320,"column":60}}]},"36":{"line":324,"type":"if","locations":[{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},{"start":{"line":324,"column":1},"end":{"line":324,"column":1}}]},"37":{"line":359,"type":"if","locations":[{"start":{"line":359,"column":2},"end":{"line":359,"column":2}},{"start":{"line":359,"column":2},"end":{"line":359,"column":2}}]},"38":{"line":375,"type":"if","locations":[{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},{"start":{"line":375,"column":1},"end":{"line":375,"column":1}}]},"39":{"line":382,"type":"if","locations":[{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},{"start":{"line":382,"column":1},"end":{"line":382,"column":1}}]},"40":{"line":387,"type":"if","locations":[{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},{"start":{"line":387,"column":1},"end":{"line":387,"column":1}}]},"41":{"line":401,"type":"if","locations":[{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},{"start":{"line":401,"column":1},"end":{"line":401,"column":1}}]},"42":{"line":408,"type":"if","locations":[{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},{"start":{"line":408,"column":1},"end":{"line":408,"column":1}}]},"43":{"line":413,"type":"if","locations":[{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},{"start":{"line":413,"column":1},"end":{"line":413,"column":1}}]},"44":{"line":424,"type":"if","locations":[{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},{"start":{"line":424,"column":1},"end":{"line":424,"column":1}}]},"45":{"line":425,"type":"if","locations":[{"start":{"line":425,"column":2},"end":{"line":425,"column":2}},{"start":{"line":425,"column":2},"end":{"line":425,"column":2}}]},"46":{"line":425,"type":"binary-expr","locations":[{"start":{"line":425,"column":6},"end":{"line":425,"column":32}},{"start":{"line":425,"column":36},"end":{"line":425,"column":62}}]},"47":{"line":430,"type":"if","locations":[{"start":{"line":430,"column":2},"end":{"line":430,"column":2}},{"start":{"line":430,"column":2},"end":{"line":430,"column":2}}]},"48":{"line":430,"type":"binary-expr","locations":[{"start":{"line":430,"column":6},"end":{"line":430,"column":13}},{"start":{"line":430,"column":17},"end":{"line":430,"column":78}}]},"49":{"line":430,"type":"binary-expr","locations":[{"start":{"line":430,"column":19},"end":{"line":430,"column":36}},{"start":{"line":430,"column":40},"end":{"line":430,"column":56}},{"start":{"line":430,"column":60},"end":{"line":430,"column":77}}]},"50":{"line":436,"type":"if","locations":[{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},{"start":{"line":436,"column":1},"end":{"line":436,"column":1}}]},"51":{"line":441,"type":"if","locations":[{"start":{"line":441,"column":1},"end":{"line":441,"column":1}},{"start":{"line":441,"column":1},"end":{"line":441,"column":1}}]},"52":{"line":441,"type":"binary-expr","locations":[{"start":{"line":441,"column":5},"end":{"line":441,"column":12}},{"start":{"line":441,"column":16},"end":{"line":441,"column":28}},{"start":{"line":441,"column":32},"end":{"line":441,"column":50}}]},"53":{"line":443,"type":"if","locations":[{"start":{"line":443,"column":2},"end":{"line":443,"column":2}},{"start":{"line":443,"column":2},"end":{"line":443,"column":2}}]},"54":{"line":459,"type":"binary-expr","locations":[{"start":{"line":459,"column":8},"end":{"line":459,"column":12}},{"start":{"line":459,"column":16},"end":{"line":459,"column":18}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-admin', 'ConsoleService');","var MonitorAgent = require('./monitor/monitorAgent');","var EventEmitter = require('events').EventEmitter;","var MasterAgent = require('./master/masterAgent');","var schedule = require('pomelo-scheduler');","var protocol = require('./util/protocol');","var utils = require('./util/utils');","var util = require('util');","","var MS_OF_SECOND = 1000;","","/**"," * ConsoleService Constructor"," *"," * @class ConsoleService"," * @constructor"," * @param {Object} opts construct parameter"," *                 opts.type \t{String} server type, 'master', 'connector', etc."," *                 opts.id \t\t{String} server id"," *                 opts.host \t{String} (monitor only) master server host"," *                 opts.port \t{String | Number} listen port for master or master port for monitor"," *                 opts.master  {Boolean} current service is master or monitor"," *                 opts.info \t{Object} more server info for current server, {id, serverType, host, port}"," * @api public"," */","var ConsoleService = function(opts) {","\tEventEmitter.call(this);","\tthis.port = opts.port;","\tthis.env = opts.env;","\tthis.values = {};","\tthis.master = opts.master;","","\tthis.modules = {};","\tthis.commands = {","\t\t'list': listCommand,","\t\t'enable': enableCommand,","\t\t'disable': disableCommand","\t};","","\tif (this.master) {","\t\tthis.authUser = opts.authUser || utils.defaultAuthUser;","\t\tthis.authServer = opts.authServer || utils.defaultAuthServerMaster;","\t\tthis.agent = new MasterAgent(this, opts);","\t} else {","\t\tthis.type = opts.type;","\t\tthis.id = opts.id;","\t\tthis.host = opts.host;","\t\tthis.authServer = opts.authServer || utils.defaultAuthServerMonitor;","\t\tthis.agent = new MonitorAgent({","\t\t\tconsoleService: this,","\t\t\tid: this.id,","\t\t\ttype: this.type,","\t\t\tinfo: opts.info","\t\t});","\t}","};","","util.inherits(ConsoleService, EventEmitter);","","/**"," * start master or monitor"," *"," * @param {Function} cb callback function"," * @api public"," */","ConsoleService.prototype.start = function(cb) {","\tif (this.master) {","\t\tvar self = this;","\t\tthis.agent.listen(this.port, function(err) {","\t\t\tif (!!err) {","\t\t\t\tutils.invokeCallback(cb, err);","\t\t\t\treturn;","\t\t\t}","","\t\t\texportEvent(self, self.agent, 'register');","\t\t\texportEvent(self, self.agent, 'disconnect');","\t\t\texportEvent(self, self.agent, 'reconnect');","\t\t\tprocess.nextTick(function() {","\t\t\t\tutils.invokeCallback(cb);","\t\t\t});","\t\t});","\t} else {","\t\tlogger.info('try to connect master: %j, %j, %j', this.type, this.host, this.port);","\t\tthis.agent.connect(this.port, this.host, cb);","\t\texportEvent(this, this.agent, 'close');","\t}","","\texportEvent(this, this.agent, 'error');","","\tfor (var mid in this.modules) {","\t\tthis.enable(mid);","\t}","};","","/**"," * stop console modules and stop master server"," *"," * @api public"," */","ConsoleService.prototype.stop = function() {","\tfor (var mid in this.modules) {","\t\tthis.disable(mid);","\t}","\tthis.agent.close();","};","","/**"," * register a new adminConsole module"," *"," * @param {String} moduleId adminConsole id/name"," * @param {Object} module module object"," * @api public"," */","ConsoleService.prototype.register = function(moduleId, module) {","\tthis.modules[moduleId] = registerRecord(this, moduleId, module);","};","","/**"," * enable adminConsole module"," *"," * @param {String} moduleId adminConsole id/name"," * @api public"," */","ConsoleService.prototype.enable = function(moduleId) {","\tvar record = this.modules[moduleId];","\tif (record && !record.enable) {","\t\trecord.enable = true;","\t\taddToSchedule(this, record);","\t\treturn true;","\t}","\treturn false;","};","","/**"," * disable adminConsole module"," *"," * @param {String} moduleId adminConsole id/name"," * @api public"," */","ConsoleService.prototype.disable = function(moduleId) {","\tvar record = this.modules[moduleId];","\tif (record && record.enable) {","\t\trecord.enable = false;","\t\tif (record.schedule && record.jobId) {","\t\t\tschedule.cancelJob(record.jobId);","\t\t\tschedule.jobId = null;","\t\t}","\t\treturn true;","\t}","\treturn false;","};","","/**"," * call concrete module and handler(monitorHandler,masterHandler,clientHandler)"," *"," * @param {String} moduleId adminConsole id/name"," * @param {String} method handler"," * @param {Object} msg message"," * @param {Function} cb callback function"," * @api public"," */","ConsoleService.prototype.execute = function(moduleId, method, msg, cb) {","\tvar self = this;","\tvar m = this.modules[moduleId];","\tif (!m) {","\t\tlogger.error('unknown module: %j.', moduleId);","\t\tcb('unknown moduleId:' + moduleId);","\t\treturn;","\t}","","\tif (!m.enable) {","\t\tlogger.error('module %j is disable.', moduleId);","\t\tcb('module ' + moduleId + ' is disable');","\t\treturn;","\t}","","\tvar module = m.module;","\tif (!module || typeof module[method] !== 'function') {","\t\tlogger.error('module %j dose not have a method called %j.', moduleId, method);","\t\tcb('module ' + moduleId + ' dose not have a method called ' + method);","\t\treturn;","\t}","","\tvar log = {","\t\taction: 'execute',","\t\tmoduleId: moduleId,","\t\tmethod: method,","\t\tmsg: msg","\t}","","\tvar aclMsg = aclControl(self.agent, 'execute', method, moduleId, msg);","\tif (aclMsg !== 0 && aclMsg !== 1) {","\t\tlog['error'] = aclMsg;","\t\tself.emit('admin-log', log, aclMsg);","\t\tcb(new Error(aclMsg), null);","\t\treturn;","\t}","","\tif (method === 'clientHandler') {","\t\tself.emit('admin-log', log);","\t}","","\tmodule[method](this.agent, msg, cb);","};","","ConsoleService.prototype.command = function(command, moduleId, msg, cb) {","\tvar self = this;","\tvar fun = this.commands[command];","\tif (!fun || typeof fun !== 'function') {","\t\tcb('unknown command:' + command);","\t\treturn;","\t}","","\tvar log = {","\t\taction: 'command',","\t\tmoduleId: moduleId,","\t\tmsg: msg","\t}","","\tvar aclMsg = aclControl(self.agent, 'command', null, moduleId, msg);","\tif (aclMsg !== 0 && aclMsg !== 1) {","\t\tlog['error'] = aclMsg;","\t\tself.emit('admin-log', log, aclMsg);","\t\tcb(new Error(aclMsg), null);","\t\treturn;","\t}","","\tself.emit('admin-log', log);","\tfun(this, moduleId, msg, cb);","}","","/**"," * set module data to a map"," *"," * @param {String} moduleId adminConsole id/name"," * @param {Object} value module data"," * @api public"," */","","ConsoleService.prototype.set = function(moduleId, value) {","\tthis.values[moduleId] = value;","};","","/**"," * get module data from map"," *"," * @param {String} moduleId adminConsole id/name"," * @api public"," */","ConsoleService.prototype.get = function(moduleId) {","\treturn this.values[moduleId];","};","","/**"," * register a module service"," *"," * @param {Object} service consoleService object"," * @param {String} moduleId adminConsole id/name"," * @param {Object} module module object"," * @api private"," */","var registerRecord = function(service, moduleId, module) {","\tvar record = {","\t\tmoduleId: moduleId,","\t\tmodule: module,","\t\tenable: false","\t};","","\tif (module.type && module.interval) {","\t\tif (!service.master && record.module.type === 'push' || service.master && record.module.type !== 'push') {","\t\t\t// push for monitor or pull for master(default)","\t\t\trecord.delay = module.delay || 0;","\t\t\trecord.interval = module.interval || 1;","\t\t\t// normalize the arguments","\t\t\tif (record.delay < 0) {","\t\t\t\trecord.delay = 0;","\t\t\t}","\t\t\tif (record.interval < 0) {","\t\t\t\trecord.interval = 1;","\t\t\t}","\t\t\trecord.interval = Math.ceil(record.interval);","\t\t\trecord.delay *= MS_OF_SECOND;","\t\t\trecord.interval *= MS_OF_SECOND;","\t\t\trecord.schedule = true;","\t\t}","\t}","","\treturn record;","};","","/**"," * schedule console module"," *"," * @param {Object} service consoleService object"," * @param {Object} record  module object"," * @api private"," */","var addToSchedule = function(service, record) {","\tif (record && record.schedule) {","\t\trecord.jobId = schedule.scheduleJob({","\t\t\t\tstart: Date.now() + record.delay,","\t\t\t\tperiod: record.interval","\t\t\t},","\t\t\tdoScheduleJob, {","\t\t\t\tservice: service,","\t\t\t\trecord: record","\t\t\t});","\t}","};","","/**"," * run schedule job"," *"," * @param {Object} args argments"," * @api private"," */","var doScheduleJob = function(args) {","\tvar service = args.service;","\tvar record = args.record;","\tif (!service || !record || !record.module || !record.enable) {","\t\treturn;","\t}","","\tif (service.master) {","\t\trecord.module.masterHandler(service.agent, null, function(err) {","\t\t\tlogger.error('interval push should not have a callback.');","\t\t});","\t} else {","\t\trecord.module.monitorHandler(service.agent, null, function(err) {","\t\t\tlogger.error('interval push should not have a callback.');","\t\t});","\t}","};","","/**"," * export closure function out"," *"," * @param {Function} outer outer function"," * @param {Function} inner inner function"," * @param {object} event"," * @api private"," */","var exportEvent = function(outer, inner, event) {","\tinner.on(event, function() {","\t\tvar args = Array.prototype.slice.call(arguments, 0);","\t\targs.unshift(event);","\t\touter.emit.apply(outer, args);","\t});","};","","/**"," * List current modules"," */","var listCommand = function(consoleService, moduleId, msg, cb) {","\tvar modules = consoleService.modules;","","\tvar result = [];","\tfor (var moduleId in modules) {","\t\tif (/^__\\w+__$/.test(moduleId)) {","\t\t\tcontinue;","\t\t}","","\t\tresult.push(moduleId);","\t}","","\tcb(null, {","\t\tmodules: result","\t});","};","","/**"," * enable module in current server"," */","var enableCommand = function(consoleService, moduleId, msg, cb) {","\tif (!moduleId) {","\t\tlogger.error('fail to enable admin module for ' + moduleId);","\t\tcb('empty moduleId');","\t\treturn;","\t}","","\tvar modules = consoleService.modules;","\tif (!modules[moduleId]) {","\t\tcb(null, protocol.PRO_FAIL);","\t\treturn;","\t}","","\tif (consoleService.master) {","\t\tconsoleService.enable(moduleId);","\t\tconsoleService.agent.notifyCommand(\"enable\", moduleId, msg);","\t\tcb(null, protocol.PRO_OK);","\t} else {","\t\tconsoleService.enable(moduleId);","\t\tcb(null, protocol.PRO_OK);","\t}","};","","/**"," * disable module in current server"," */","var disableCommand = function(consoleService, moduleId, msg, cb) {","\tif (!moduleId) {","\t\tlogger.error('fail to enable admin module for ' + moduleId);","\t\tcb('empty moduleId');","\t\treturn;","\t}","","\tvar modules = consoleService.modules;","\tif (!modules[moduleId]) {","\t\tcb(null, protocol.PRO_FAIL);","\t\treturn;","\t}","","\tif (consoleService.master) {","\t\tconsoleService.disable(moduleId);","\t\tconsoleService.agent.notifyCommand(\"disable\", moduleId, msg);","\t\tcb(null, protocol.PRO_OK);","\t} else {","\t\tconsoleService.disable(moduleId);","\t\tcb(null, protocol.PRO_OK);","\t}","};","","var aclControl = function(agent, action, method, moduleId, msg) {","\tif (action === 'execute') {","\t\tif (method !== 'clientHandler' || moduleId !== '__console__') {","\t\t\treturn 0;","\t\t}","","\t\tvar signal = msg.signal;","\t\tif (!signal || !(signal === 'stop' || signal === 'add' || signal === 'kill')) {","\t\t\treturn 0;","\t\t}","\t}","","\tvar clientId = msg.clientId;","\tif (!clientId) {","\t\treturn 'Unknow clientId';","\t}","","\tvar _client = agent.getClientById(clientId);","\tif (_client && _client.info && _client.info.level) {","\t\tvar level = _client.info.level;","\t\tif (level > 1) {","\t\t\treturn 'Command permission denied';","\t\t}","\t} else {","\t\treturn 'Client info error';","\t}","\treturn 1;","}","","/**"," * Create master ConsoleService"," *"," * @param {Object} opts construct parameter"," *                      opts.port {String | Number} listen port for master console"," */","module.exports.createMasterConsole = function(opts) {","\topts = opts || {};","\topts.master = true;","\treturn new ConsoleService(opts);","};","","/**"," * Create monitor ConsoleService"," *"," * @param {Object} opts construct parameter"," *                      opts.type {String} server type, 'master', 'connector', etc."," *                      opts.id {String} server id"," *                      opts.host {String} master server host"," *                      opts.port {String | Number} master port"," */","module.exports.createMonitorConsole = function(opts) {","\treturn new ConsoleService(opts);","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"10":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"33":0,"34":0,"40":0,"41":0,"42":0,"43":0,"45":0,"46":0,"47":0,"48":0,"49":0,"58":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"75":0,"76":0,"77":0,"78":0,"79":0,"83":0,"84":0,"85":0,"88":0,"90":0,"91":0,"100":1,"101":0,"102":0,"104":0,"114":1,"115":0,"124":1,"125":0,"126":0,"127":0,"128":0,"129":0,"131":0,"140":1,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"148":0,"150":0,"162":1,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"171":0,"172":0,"173":0,"174":0,"177":0,"178":0,"179":0,"180":0,"181":0,"184":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"199":0,"200":0,"203":0,"206":1,"207":0,"208":0,"209":0,"210":0,"211":0,"214":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"228":0,"229":0,"240":1,"241":0,"250":1,"251":0,"262":1,"263":0,"269":0,"270":0,"272":0,"273":0,"275":0,"276":0,"278":0,"279":0,"281":0,"282":0,"283":0,"284":0,"288":0,"298":1,"299":0,"300":0,"317":1,"318":0,"319":0,"320":0,"321":0,"324":0,"325":0,"326":0,"329":0,"330":0,"343":1,"344":0,"345":0,"346":0,"347":0,"354":1,"355":0,"357":0,"358":0,"359":0,"360":0,"363":0,"366":0,"374":1,"375":0,"376":0,"377":0,"378":0,"381":0,"382":0,"383":0,"384":0,"387":0,"388":0,"389":0,"390":0,"392":0,"393":0,"400":1,"401":0,"402":0,"403":0,"404":0,"407":0,"408":0,"409":0,"410":0,"413":0,"414":0,"415":0,"416":0,"418":0,"419":0,"423":1,"424":0,"425":0,"426":0,"429":0,"430":0,"431":0,"435":0,"436":0,"437":0,"440":0,"441":0,"442":0,"443":0,"444":0,"447":0,"449":0,"458":1,"459":0,"460":0,"461":0,"473":1,"474":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/monitor/monitorAgent.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/monitor/monitorAgent.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":1,"84":0,"85":0,"86":0,"87":0,"88":1,"89":0,"90":1,"91":0,"92":1,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":1,"105":0,"106":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":19},"end":{"line":26,"column":34}}},"2":{"name":"(anonymous_2)","line":49,"loc":{"start":{"line":49,"column":33},"end":{"line":49,"column":58}}},"3":{"name":"(anonymous_3)","line":55,"loc":{"start":{"line":55,"column":13},"end":{"line":55,"column":24}}},"4":{"name":"(anonymous_4)","line":66,"loc":{"start":{"line":66,"column":29},"end":{"line":66,"column":43}}},"5":{"name":"(anonymous_5)","line":76,"loc":{"start":{"line":76,"column":28},"end":{"line":76,"column":42}}},"6":{"name":"(anonymous_6)","line":85,"loc":{"start":{"line":85,"column":71},"end":{"line":85,"column":90}}},"7":{"name":"(anonymous_7)","line":103,"loc":{"start":{"line":103,"column":76},"end":{"line":103,"column":95}}},"8":{"name":"(anonymous_8)","line":117,"loc":{"start":{"line":117,"column":28},"end":{"line":117,"column":39}}},"9":{"name":"(anonymous_9)","line":132,"loc":{"start":{"line":132,"column":25},"end":{"line":132,"column":41}}},"10":{"name":"(anonymous_10)","line":138,"loc":{"start":{"line":138,"column":26},"end":{"line":138,"column":40}}},"11":{"name":"(anonymous_11)","line":147,"loc":{"start":{"line":147,"column":31},"end":{"line":147,"column":48}}},"12":{"name":"(anonymous_12)","line":152,"loc":{"start":{"line":152,"column":30},"end":{"line":152,"column":41}}},"13":{"name":"(anonymous_13)","line":165,"loc":{"start":{"line":165,"column":33},"end":{"line":165,"column":47}}},"14":{"name":"(anonymous_14)","line":177,"loc":{"start":{"line":177,"column":31},"end":{"line":177,"column":42}}},"15":{"name":"(anonymous_15)","line":192,"loc":{"start":{"line":192,"column":29},"end":{"line":192,"column":55}}},"16":{"name":"(anonymous_16)","line":202,"loc":{"start":{"line":202,"column":29},"end":{"line":202,"column":48}}},"17":{"name":"(anonymous_17)","line":213,"loc":{"start":{"line":213,"column":32},"end":{"line":213,"column":56}}},"18":{"name":"(anonymous_18)","line":222,"loc":{"start":{"line":222,"column":33},"end":{"line":222,"column":61}}},"19":{"name":"(anonymous_19)","line":233,"loc":{"start":{"line":233,"column":32},"end":{"line":233,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":80}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":56}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":50}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":37}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":18}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":21}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":22}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":18}},"11":{"start":{"line":12,"column":0},"end":{"line":12,"column":31}},"12":{"start":{"line":26,"column":0},"end":{"line":37,"column":2}},"13":{"start":{"line":27,"column":2},"end":{"line":27,"column":26}},"14":{"start":{"line":28,"column":2},"end":{"line":28,"column":17}},"15":{"start":{"line":29,"column":2},"end":{"line":29,"column":19}},"16":{"start":{"line":30,"column":2},"end":{"line":30,"column":20}},"17":{"start":{"line":31,"column":2},"end":{"line":31,"column":21}},"18":{"start":{"line":32,"column":2},"end":{"line":32,"column":22}},"19":{"start":{"line":33,"column":2},"end":{"line":33,"column":24}},"20":{"start":{"line":34,"column":2},"end":{"line":34,"column":24}},"21":{"start":{"line":35,"column":2},"end":{"line":35,"column":25}},"22":{"start":{"line":36,"column":2},"end":{"line":36,"column":44}},"23":{"start":{"line":39,"column":0},"end":{"line":39,"column":42}},"24":{"start":{"line":49,"column":0},"end":{"line":170,"column":2}},"25":{"start":{"line":50,"column":2},"end":{"line":53,"column":3}},"26":{"start":{"line":51,"column":4},"end":{"line":51,"column":60}},"27":{"start":{"line":52,"column":4},"end":{"line":52,"column":11}},"28":{"start":{"line":55,"column":2},"end":{"line":55,"column":26}},"29":{"start":{"line":57,"column":2},"end":{"line":57,"column":42}},"30":{"start":{"line":58,"column":2},"end":{"line":58,"column":34}},"31":{"start":{"line":65,"column":2},"end":{"line":65,"column":18}},"32":{"start":{"line":66,"column":2},"end":{"line":74,"column":5}},"33":{"start":{"line":67,"column":4},"end":{"line":73,"column":5}},"34":{"start":{"line":68,"column":6},"end":{"line":68,"column":33}},"35":{"start":{"line":69,"column":6},"end":{"line":69,"column":11}},"36":{"start":{"line":71,"column":6},"end":{"line":71,"column":25}},"37":{"start":{"line":72,"column":6},"end":{"line":72,"column":78}},"38":{"start":{"line":76,"column":2},"end":{"line":115,"column":5}},"39":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"40":{"start":{"line":78,"column":6},"end":{"line":78,"column":13}},"41":{"start":{"line":81,"column":4},"end":{"line":81,"column":30}},"42":{"start":{"line":83,"column":4},"end":{"line":114,"column":5}},"43":{"start":{"line":85,"column":6},"end":{"line":87,"column":9}},"44":{"start":{"line":89,"column":6},"end":{"line":89,"column":30}},"45":{"start":{"line":90,"column":6},"end":{"line":100,"column":7}},"46":{"start":{"line":92,"column":8},"end":{"line":92,"column":44}},"47":{"start":{"line":93,"column":8},"end":{"line":96,"column":9}},"48":{"start":{"line":94,"column":10},"end":{"line":94,"column":51}},"49":{"start":{"line":95,"column":10},"end":{"line":95,"column":17}},"50":{"start":{"line":97,"column":8},"end":{"line":97,"column":38}},"51":{"start":{"line":98,"column":8},"end":{"line":98,"column":36}},"52":{"start":{"line":99,"column":8},"end":{"line":99,"column":15}},"53":{"start":{"line":103,"column":6},"end":{"line":113,"column":9}},"54":{"start":{"line":104,"column":8},"end":{"line":112,"column":9}},"55":{"start":{"line":105,"column":10},"end":{"line":105,"column":61}},"56":{"start":{"line":106,"column":10},"end":{"line":108,"column":11}},"57":{"start":{"line":107,"column":12},"end":{"line":107,"column":41}},"58":{"start":{"line":111,"column":10},"end":{"line":111,"column":61}},"59":{"start":{"line":117,"column":2},"end":{"line":136,"column":5}},"60":{"start":{"line":118,"column":4},"end":{"line":121,"column":5}},"61":{"start":{"line":120,"column":6},"end":{"line":120,"column":13}},"62":{"start":{"line":122,"column":4},"end":{"line":122,"column":30}},"63":{"start":{"line":123,"column":4},"end":{"line":129,"column":6}},"64":{"start":{"line":130,"column":4},"end":{"line":130,"column":52}},"65":{"start":{"line":131,"column":4},"end":{"line":131,"column":38}},"66":{"start":{"line":132,"column":4},"end":{"line":135,"column":7}},"67":{"start":{"line":133,"column":6},"end":{"line":133,"column":27}},"68":{"start":{"line":134,"column":6},"end":{"line":134,"column":35}},"69":{"start":{"line":138,"column":2},"end":{"line":145,"column":5}},"70":{"start":{"line":139,"column":4},"end":{"line":144,"column":5}},"71":{"start":{"line":141,"column":6},"end":{"line":141,"column":14}},"72":{"start":{"line":143,"column":6},"end":{"line":143,"column":30}},"73":{"start":{"line":147,"column":2},"end":{"line":150,"column":5}},"74":{"start":{"line":148,"column":4},"end":{"line":148,"column":27}},"75":{"start":{"line":149,"column":4},"end":{"line":149,"column":23}},"76":{"start":{"line":152,"column":2},"end":{"line":163,"column":5}},"77":{"start":{"line":153,"column":4},"end":{"line":153,"column":30}},"78":{"start":{"line":154,"column":4},"end":{"line":160,"column":6}},"79":{"start":{"line":162,"column":4},"end":{"line":162,"column":34}},"80":{"start":{"line":165,"column":2},"end":{"line":169,"column":5}},"81":{"start":{"line":166,"column":4},"end":{"line":168,"column":5}},"82":{"start":{"line":167,"column":6},"end":{"line":167,"column":33}},"83":{"start":{"line":177,"column":0},"end":{"line":183,"column":2}},"84":{"start":{"line":178,"column":2},"end":{"line":180,"column":3}},"85":{"start":{"line":179,"column":4},"end":{"line":179,"column":11}},"86":{"start":{"line":181,"column":2},"end":{"line":181,"column":25}},"87":{"start":{"line":182,"column":2},"end":{"line":182,"column":27}},"88":{"start":{"line":192,"column":0},"end":{"line":194,"column":2}},"89":{"start":{"line":193,"column":2},"end":{"line":193,"column":43}},"90":{"start":{"line":202,"column":0},"end":{"line":204,"column":2}},"91":{"start":{"line":203,"column":2},"end":{"line":203,"column":43}},"92":{"start":{"line":213,"column":0},"end":{"line":220,"column":2}},"93":{"start":{"line":214,"column":2},"end":{"line":217,"column":3}},"94":{"start":{"line":215,"column":4},"end":{"line":215,"column":66}},"95":{"start":{"line":216,"column":4},"end":{"line":216,"column":11}},"96":{"start":{"line":218,"column":2},"end":{"line":218,"column":71}},"97":{"start":{"line":222,"column":0},"end":{"line":231,"column":2}},"98":{"start":{"line":223,"column":2},"end":{"line":226,"column":3}},"99":{"start":{"line":224,"column":4},"end":{"line":224,"column":67}},"100":{"start":{"line":225,"column":4},"end":{"line":225,"column":11}},"101":{"start":{"line":227,"column":2},"end":{"line":227,"column":27}},"102":{"start":{"line":228,"column":2},"end":{"line":228,"column":29}},"103":{"start":{"line":229,"column":2},"end":{"line":229,"column":72}},"104":{"start":{"line":233,"column":0},"end":{"line":235,"column":1}},"105":{"start":{"line":234,"column":2},"end":{"line":234,"column":31}},"106":{"start":{"line":237,"column":0},"end":{"line":237,"column":30}}},"branchMap":{"1":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":50,"column":2}},{"start":{"line":50,"column":2},"end":{"line":50,"column":2}}]},"2":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":7},"end":{"line":55,"column":9}},{"start":{"line":55,"column":13},"end":{"line":55,"column":26}}]},"3":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":67,"column":4}},{"start":{"line":67,"column":4},"end":{"line":67,"column":4}}]},"4":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":8},"end":{"line":67,"column":11}},{"start":{"line":67,"column":15},"end":{"line":67,"column":43}}]},"5":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":77,"column":4}},{"start":{"line":77,"column":4},"end":{"line":77,"column":4}}]},"6":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":4},"end":{"line":83,"column":4}},{"start":{"line":83,"column":4},"end":{"line":83,"column":4}}]},"7":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":6},"end":{"line":90,"column":6}},{"start":{"line":90,"column":6},"end":{"line":90,"column":6}}]},"8":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":8},"end":{"line":93,"column":8}},{"start":{"line":93,"column":8},"end":{"line":93,"column":8}}]},"9":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":8},"end":{"line":104,"column":8}},{"start":{"line":104,"column":8},"end":{"line":104,"column":8}}]},"10":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":10},"end":{"line":106,"column":10}},{"start":{"line":106,"column":10},"end":{"line":106,"column":10}}]},"11":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":118,"column":4}},{"start":{"line":118,"column":4},"end":{"line":118,"column":4}}]},"12":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":4},"end":{"line":139,"column":4}},{"start":{"line":139,"column":4},"end":{"line":139,"column":4}}]},"13":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":166,"column":4}},{"start":{"line":166,"column":4},"end":{"line":166,"column":4}}]},"14":{"line":166,"type":"binary-expr","locations":[{"start":{"line":166,"column":8},"end":{"line":166,"column":11}},{"start":{"line":166,"column":15},"end":{"line":166,"column":43}}]},"15":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":2},"end":{"line":178,"column":2}},{"start":{"line":178,"column":2},"end":{"line":178,"column":2}}]},"16":{"line":214,"type":"if","locations":[{"start":{"line":214,"column":2},"end":{"line":214,"column":2}},{"start":{"line":214,"column":2},"end":{"line":214,"column":2}}]},"17":{"line":223,"type":"if","locations":[{"start":{"line":223,"column":2},"end":{"line":223,"column":2}},{"start":{"line":223,"column":2},"end":{"line":223,"column":2}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-admin', 'MonitorAgent');","var MqttClient = require('../protocol/mqtt/mqttClient');","var EventEmitter = require('events').EventEmitter;","var protocol = require('../util/protocol');","var utils = require('../util/utils');","var Util = require('util');","","var ST_INITED = 1;","var ST_CONNECTED = 2;","var ST_REGISTERED = 3;","var ST_CLOSED = 4;","var STATUS_INTERVAL = 5 * 1000; // 60 seconds","","/**"," * MonitorAgent Constructor"," *"," * @class MasterAgent"," * @constructor"," * @param {Object} opts construct parameter"," *                 opts.consoleService {Object} consoleService"," *                 opts.id             {String} server id"," *                 opts.type           {String} server type, 'master', 'connector', etc."," *                 opts.info           {Object} more server info for current server, {id, serverType, host, port}"," * @api public"," */","var MonitorAgent = function(opts) {","  EventEmitter.call(this);","  this.reqId = 1;","  this.opts = opts;","  this.id = opts.id;","  this.socket = null;","  this.callbacks = {};","  this.type = opts.type;","  this.info = opts.info;","  this.state = ST_INITED;","  this.consoleService = opts.consoleService;","};","","Util.inherits(MonitorAgent, EventEmitter);","","/**"," * register and connect to master server"," *"," * @param {String} port"," * @param {String} host"," * @param {Function} cb callback function"," * @api public"," */","MonitorAgent.prototype.connect = function(port, host, cb) {","  if (this.state > ST_INITED) {","    logger.error('monitor client has connected or closed.');","    return;","  }","","  cb = cb || function() {}","","  this.socket = new MqttClient(this.opts);","  this.socket.connect(host, port);","","  // this.socket = sclient.connect(host + ':' + port, {","  //   'force new connection': true,","  //   'reconnect': true,","  //   'max reconnection attempts': 20","  // });","  var self = this;","  this.socket.on('register', function(msg) {","    if (msg && msg.code === protocol.PRO_OK) {","      self.state = ST_REGISTERED;","      cb();","    } else {","      self.emit('close');","      logger.error('server %j %j register master failed', self.id, self.type);","    }","  });","","  this.socket.on('monitor', function(msg) {","    if (self.state !== ST_REGISTERED) {","      return;","    }","","    msg = protocol.parse(msg);","","    if (msg.command) {","      // a command from master","      self.consoleService.command(msg.command, msg.moduleId, msg.body, function(err, res) {","        //notify should not have a callback","      });","    } else {","      var respId = msg.respId;","      if (respId) {","        // a response from monitor","        var respCb = self.callbacks[respId];","        if (!respCb) {","          logger.warn('unknown resp id:' + respId);","          return;","        }","        delete self.callbacks[respId];","        respCb(msg.error, msg.body);","        return;","      }","","      // request from master","      self.consoleService.execute(msg.moduleId, 'monitorHandler', msg.body, function(err, res) {","        if (protocol.isRequest(msg)) {","          var resp = protocol.composeResponse(msg, err, res);","          if (resp) {","            self.doSend('monitor', resp);","          }","        } else {","          //notify should not have a callback","          logger.error('notify should not have a callback.');","        }","      });","    }","  });","","  this.socket.on('connect', function() {","    if (self.state > ST_INITED) {","      //ignore reconnect","      return;","    }","    self.state = ST_CONNECTED;","    var req = {","      id: self.id,","      type: 'monitor',","      serverType: self.type,","      pid: process.pid,","      info: self.info","    };","    var authServer = self.consoleService.authServer;","    var env = self.consoleService.env;","    authServer(req, env, function(token) {","      req['token'] = token;","      self.doSend('register', req);","    });","  });","","  this.socket.on('error', function(err) {","    if (self.state < ST_CONNECTED) {","      // error occurs during connecting stage","      cb(err);","    } else {","      self.emit('error', err);","    }","  });","","  this.socket.on('disconnect', function(reason) {","    self.state = ST_CLOSED;","    self.emit('close');","  });","","  this.socket.on('reconnect', function() {","    self.state = ST_CONNECTED;","    var req = {","      id: self.id,","      type: 'monitor',","      info: self.info,","      pid: process.pid,","      serverType: self.type","    };","","    self.doSend('reconnect', req);","  });","","  this.socket.on('reconnect_ok', function(msg) {","    if (msg && msg.code === protocol.PRO_OK) {","      self.state = ST_REGISTERED;","    }","  });","};","","/**"," * close monitor agent"," *"," * @api public"," */","MonitorAgent.prototype.close = function() {","  if (this.state >= ST_CLOSED) {","    return;","  }","  this.state = ST_CLOSED;","  this.socket.disconnect();","};","","/**"," * set module"," *"," * @param {String} moduleId module id/name"," * @param {Object} value module object"," * @api public"," */","MonitorAgent.prototype.set = function(moduleId, value) {","  this.consoleService.set(moduleId, value);","};","","/**"," * get module"," *"," * @param {String} moduleId module id/name"," * @api public"," */","MonitorAgent.prototype.get = function(moduleId) {","  return this.consoleService.get(moduleId);","};","","/**"," * notify master server without callback"," *"," * @param {String} moduleId module id/name"," * @param {Object} msg message"," * @api public"," */","MonitorAgent.prototype.notify = function(moduleId, msg) {","  if (this.state !== ST_REGISTERED) {","    logger.error('agent can not notify now, state:' + this.state);","    return;","  }","  this.doSend('monitor', protocol.composeRequest(null, moduleId, msg));","  // this.socket.emit('monitor', protocol.composeRequest(null, moduleId, msg));","};","","MonitorAgent.prototype.request = function(moduleId, msg, cb) {","  if (this.state !== ST_REGISTERED) {","    logger.error('agent can not request now, state:' + this.state);","    return;","  }","  var reqId = this.reqId++;","  this.callbacks[reqId] = cb;","  this.doSend('monitor', protocol.composeRequest(reqId, moduleId, msg));","  // this.socket.emit('monitor', protocol.composeRequest(reqId, moduleId, msg));","};","","MonitorAgent.prototype.doSend = function(topic, msg) {","  this.socket.send(topic, msg);","}","","module.exports = MonitorAgent;"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"9":1,"10":1,"11":1,"12":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"39":1,"49":1,"50":0,"51":0,"52":0,"55":0,"57":0,"58":0,"65":0,"66":0,"67":0,"68":0,"69":0,"71":0,"72":0,"76":0,"77":0,"78":0,"81":0,"83":0,"85":0,"89":0,"90":0,"92":0,"93":0,"94":0,"95":0,"97":0,"98":0,"99":0,"103":0,"104":0,"105":0,"106":0,"107":0,"111":0,"117":0,"118":0,"120":0,"122":0,"123":0,"130":0,"131":0,"132":0,"133":0,"134":0,"138":0,"139":0,"141":0,"143":0,"147":0,"148":0,"149":0,"152":0,"153":0,"154":0,"162":0,"165":0,"166":0,"167":0,"177":1,"178":0,"179":0,"181":0,"182":0,"192":1,"193":0,"202":1,"203":0,"213":1,"214":0,"215":0,"216":0,"218":0,"222":1,"223":0,"224":0,"225":0,"227":0,"228":0,"229":0,"233":1,"234":0,"237":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/protocol/mqtt/mqttClient.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/protocol/mqtt/mqttClient.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":1,"76":0,"77":1,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":1,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":1,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":1,"112":0,"113":0,"114":0,"115":0,"116":0,"117":1,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":1,"132":0,"133":1,"134":0,"135":0,"136":0,"137":1,"138":0,"139":0,"140":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":32}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":31},"end":{"line":33,"column":56}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":12},"end":{"line":34,"column":23}}},"4":{"name":"(anonymous_4)","line":64,"loc":{"start":{"line":64,"column":27},"end":{"line":64,"column":38}}},"5":{"name":"(anonymous_5)","line":81,"loc":{"start":{"line":81,"column":27},"end":{"line":81,"column":41}}},"6":{"name":"(anonymous_6)","line":90,"loc":{"start":{"line":90,"column":25},"end":{"line":90,"column":36}}},"7":{"name":"(anonymous_7)","line":95,"loc":{"start":{"line":95,"column":25},"end":{"line":95,"column":39}}},"8":{"name":"(anonymous_8)","line":101,"loc":{"start":{"line":101,"column":28},"end":{"line":101,"column":39}}},"9":{"name":"(anonymous_9)","line":105,"loc":{"start":{"line":105,"column":30},"end":{"line":105,"column":41}}},"10":{"name":"(anonymous_10)","line":111,"loc":{"start":{"line":111,"column":27},"end":{"line":111,"column":51}}},"11":{"name":"(anonymous_11)","line":120,"loc":{"start":{"line":120,"column":28},"end":{"line":120,"column":49}}},"12":{"name":"(anonymous_12)","line":128,"loc":{"start":{"line":128,"column":37},"end":{"line":128,"column":48}}},"13":{"name":"(anonymous_13)","line":151,"loc":{"start":{"line":151,"column":34},"end":{"line":151,"column":58}}},"14":{"name":"(anonymous_14)","line":159,"loc":{"start":{"line":159,"column":29},"end":{"line":159,"column":40}}},"15":{"name":"(anonymous_15)","line":166,"loc":{"start":{"line":166,"column":33},"end":{"line":166,"column":44}}},"16":{"name":"(anonymous_16)","line":177,"loc":{"start":{"line":177,"column":31},"end":{"line":177,"column":42}}},"17":{"name":"(anonymous_17)","line":184,"loc":{"start":{"line":184,"column":38},"end":{"line":184,"column":49}}},"18":{"name":"(anonymous_18)","line":189,"loc":{"start":{"line":189,"column":35},"end":{"line":189,"column":46}}},"19":{"name":"(anonymous_19)","line":194,"loc":{"start":{"line":194,"column":38},"end":{"line":194,"column":49}}},"20":{"name":"(anonymous_20)","line":217,"loc":{"start":{"line":217,"column":34},"end":{"line":217,"column":45}}},"21":{"name":"(anonymous_21)","line":221,"loc":{"start":{"line":221,"column":29},"end":{"line":221,"column":40}}},"22":{"name":"(anonymous_22)","line":227,"loc":{"start":{"line":227,"column":28},"end":{"line":227,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":78}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":48}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":41}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":27}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":25}},"7":{"start":{"line":8,"column":0},"end":{"line":29,"column":1}},"8":{"start":{"line":9,"column":1},"end":{"line":9,"column":25}},"9":{"start":{"line":10,"column":1},"end":{"line":10,"column":44}},"10":{"start":{"line":11,"column":1},"end":{"line":11,"column":19}},"11":{"start":{"line":12,"column":1},"end":{"line":12,"column":20}},"12":{"start":{"line":13,"column":1},"end":{"line":13,"column":25}},"13":{"start":{"line":14,"column":1},"end":{"line":14,"column":18}},"14":{"start":{"line":15,"column":1},"end":{"line":15,"column":18}},"15":{"start":{"line":16,"column":1},"end":{"line":16,"column":20}},"16":{"start":{"line":17,"column":1},"end":{"line":17,"column":20}},"17":{"start":{"line":18,"column":1},"end":{"line":18,"column":20}},"18":{"start":{"line":19,"column":1},"end":{"line":19,"column":21}},"19":{"start":{"line":20,"column":1},"end":{"line":20,"column":23}},"20":{"start":{"line":21,"column":1},"end":{"line":21,"column":24}},"21":{"start":{"line":22,"column":1},"end":{"line":22,"column":25}},"22":{"start":{"line":23,"column":1},"end":{"line":23,"column":26}},"23":{"start":{"line":24,"column":1},"end":{"line":24,"column":28}},"24":{"start":{"line":25,"column":1},"end":{"line":25,"column":25}},"25":{"start":{"line":26,"column":1},"end":{"line":26,"column":96}},"26":{"start":{"line":27,"column":1},"end":{"line":27,"column":64}},"27":{"start":{"line":28,"column":1},"end":{"line":28,"column":70}},"28":{"start":{"line":31,"column":0},"end":{"line":31,"column":40}},"29":{"start":{"line":33,"column":0},"end":{"line":118,"column":1}},"30":{"start":{"line":34,"column":1},"end":{"line":34,"column":25}},"31":{"start":{"line":35,"column":1},"end":{"line":37,"column":2}},"32":{"start":{"line":36,"column":2},"end":{"line":36,"column":60}},"33":{"start":{"line":39,"column":1},"end":{"line":43,"column":2}},"34":{"start":{"line":40,"column":2},"end":{"line":40,"column":19}},"35":{"start":{"line":42,"column":2},"end":{"line":42,"column":19}},"36":{"start":{"line":45,"column":1},"end":{"line":49,"column":2}},"37":{"start":{"line":46,"column":2},"end":{"line":46,"column":19}},"38":{"start":{"line":48,"column":2},"end":{"line":48,"column":19}},"39":{"start":{"line":51,"column":1},"end":{"line":51,"column":17}},"40":{"start":{"line":52,"column":1},"end":{"line":52,"column":21}},"41":{"start":{"line":54,"column":1},"end":{"line":54,"column":57}},"42":{"start":{"line":55,"column":1},"end":{"line":55,"column":31}},"43":{"start":{"line":58,"column":1},"end":{"line":60,"column":4}},"44":{"start":{"line":62,"column":1},"end":{"line":62,"column":19}},"45":{"start":{"line":64,"column":1},"end":{"line":79,"column":4}},"46":{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},"47":{"start":{"line":66,"column":3},"end":{"line":66,"column":10}},"48":{"start":{"line":69,"column":2},"end":{"line":69,"column":24}},"49":{"start":{"line":71,"column":2},"end":{"line":71,"column":24}},"50":{"start":{"line":73,"column":2},"end":{"line":78,"column":3}},"51":{"start":{"line":74,"column":3},"end":{"line":74,"column":24}},"52":{"start":{"line":75,"column":3},"end":{"line":75,"column":8}},"53":{"start":{"line":77,"column":3},"end":{"line":77,"column":26}},"54":{"start":{"line":81,"column":1},"end":{"line":88,"column":4}},"55":{"start":{"line":82,"column":2},"end":{"line":82,"column":24}},"56":{"start":{"line":83,"column":2},"end":{"line":83,"column":35}},"57":{"start":{"line":84,"column":2},"end":{"line":84,"column":24}},"58":{"start":{"line":87,"column":2},"end":{"line":87,"column":24}},"59":{"start":{"line":90,"column":1},"end":{"line":93,"column":4}},"60":{"start":{"line":91,"column":2},"end":{"line":91,"column":85}},"61":{"start":{"line":92,"column":2},"end":{"line":92,"column":23}},"62":{"start":{"line":95,"column":1},"end":{"line":99,"column":4}},"63":{"start":{"line":96,"column":2},"end":{"line":96,"column":85}},"64":{"start":{"line":98,"column":2},"end":{"line":98,"column":23}},"65":{"start":{"line":101,"column":1},"end":{"line":103,"column":4}},"66":{"start":{"line":102,"column":2},"end":{"line":102,"column":29}},"67":{"start":{"line":105,"column":1},"end":{"line":109,"column":4}},"68":{"start":{"line":106,"column":2},"end":{"line":106,"column":90}},"69":{"start":{"line":107,"column":2},"end":{"line":107,"column":35}},"70":{"start":{"line":108,"column":2},"end":{"line":108,"column":23}},"71":{"start":{"line":111,"column":1},"end":{"line":117,"column":3}},"72":{"start":{"line":112,"column":2},"end":{"line":116,"column":3}},"73":{"start":{"line":113,"column":3},"end":{"line":113,"column":20}},"74":{"start":{"line":115,"column":3},"end":{"line":115,"column":15}},"75":{"start":{"line":120,"column":0},"end":{"line":126,"column":1}},"76":{"start":{"line":122,"column":1},"end":{"line":125,"column":3}},"77":{"start":{"line":128,"column":0},"end":{"line":149,"column":1}},"78":{"start":{"line":130,"column":1},"end":{"line":132,"column":2}},"79":{"start":{"line":131,"column":2},"end":{"line":131,"column":9}},"80":{"start":{"line":134,"column":1},"end":{"line":134,"column":36}},"81":{"start":{"line":135,"column":1},"end":{"line":135,"column":30}},"82":{"start":{"line":136,"column":1},"end":{"line":136,"column":28}},"83":{"start":{"line":137,"column":1},"end":{"line":137,"column":20}},"84":{"start":{"line":138,"column":1},"end":{"line":138,"column":20}},"85":{"start":{"line":139,"column":1},"end":{"line":139,"column":24}},"86":{"start":{"line":140,"column":1},"end":{"line":140,"column":20}},"87":{"start":{"line":141,"column":1},"end":{"line":141,"column":20}},"88":{"start":{"line":142,"column":1},"end":{"line":142,"column":20}},"89":{"start":{"line":144,"column":1},"end":{"line":148,"column":2}},"90":{"start":{"line":145,"column":2},"end":{"line":145,"column":19}},"91":{"start":{"line":147,"column":2},"end":{"line":147,"column":14}},"92":{"start":{"line":151,"column":0},"end":{"line":164,"column":1}},"93":{"start":{"line":152,"column":1},"end":{"line":152,"column":17}},"94":{"start":{"line":153,"column":1},"end":{"line":155,"column":2}},"95":{"start":{"line":154,"column":2},"end":{"line":154,"column":9}},"96":{"start":{"line":157,"column":1},"end":{"line":157,"column":25}},"97":{"start":{"line":159,"column":1},"end":{"line":163,"column":18}},"98":{"start":{"line":160,"column":2},"end":{"line":160,"column":27}},"99":{"start":{"line":161,"column":2},"end":{"line":161,"column":100}},"100":{"start":{"line":162,"column":2},"end":{"line":162,"column":45}},"101":{"start":{"line":166,"column":0},"end":{"line":182,"column":1}},"102":{"start":{"line":167,"column":1},"end":{"line":167,"column":80}},"103":{"start":{"line":168,"column":1},"end":{"line":170,"column":2}},"104":{"start":{"line":169,"column":2},"end":{"line":169,"column":33}},"105":{"start":{"line":172,"column":1},"end":{"line":172,"column":29}},"106":{"start":{"line":174,"column":1},"end":{"line":174,"column":17}},"107":{"start":{"line":177,"column":1},"end":{"line":181,"column":11}},"108":{"start":{"line":178,"column":2},"end":{"line":178,"column":52}},"109":{"start":{"line":179,"column":2},"end":{"line":179,"column":24}},"110":{"start":{"line":180,"column":2},"end":{"line":180,"column":17}},"111":{"start":{"line":184,"column":0},"end":{"line":192,"column":1}},"112":{"start":{"line":185,"column":1},"end":{"line":185,"column":32}},"113":{"start":{"line":186,"column":1},"end":{"line":186,"column":30}},"114":{"start":{"line":188,"column":1},"end":{"line":188,"column":17}},"115":{"start":{"line":189,"column":1},"end":{"line":191,"column":20}},"116":{"start":{"line":190,"column":2},"end":{"line":190,"column":24}},"117":{"start":{"line":194,"column":0},"end":{"line":215,"column":1}},"118":{"start":{"line":195,"column":1},"end":{"line":197,"column":2}},"119":{"start":{"line":196,"column":2},"end":{"line":196,"column":9}},"120":{"start":{"line":199,"column":1},"end":{"line":199,"column":22}},"121":{"start":{"line":200,"column":1},"end":{"line":200,"column":45}},"122":{"start":{"line":201,"column":1},"end":{"line":214,"column":2}},"123":{"start":{"line":202,"column":2},"end":{"line":210,"column":3}},"124":{"start":{"line":203,"column":3},"end":{"line":206,"column":4}},"125":{"start":{"line":204,"column":4},"end":{"line":204,"column":92}},"126":{"start":{"line":205,"column":4},"end":{"line":205,"column":17}},"127":{"start":{"line":208,"column":3},"end":{"line":208,"column":25}},"128":{"start":{"line":209,"column":3},"end":{"line":209,"column":30}},"129":{"start":{"line":212,"column":2},"end":{"line":212,"column":24}},"130":{"start":{"line":213,"column":2},"end":{"line":213,"column":29}},"131":{"start":{"line":217,"column":0},"end":{"line":219,"column":1}},"132":{"start":{"line":218,"column":1},"end":{"line":218,"column":14}},"133":{"start":{"line":221,"column":0},"end":{"line":225,"column":1}},"134":{"start":{"line":222,"column":1},"end":{"line":222,"column":24}},"135":{"start":{"line":223,"column":1},"end":{"line":223,"column":20}},"136":{"start":{"line":224,"column":1},"end":{"line":224,"column":26}},"137":{"start":{"line":227,"column":0},"end":{"line":230,"column":1}},"138":{"start":{"line":228,"column":1},"end":{"line":228,"column":25}},"139":{"start":{"line":229,"column":1},"end":{"line":229,"column":17}},"140":{"start":{"line":232,"column":0},"end":{"line":232,"column":28}}},"branchMap":{"1":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":26},"end":{"line":26,"column":48}},{"start":{"line":26,"column":52},"end":{"line":26,"column":95}}]},"2":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":16},"end":{"line":27,"column":28}},{"start":{"line":27,"column":32},"end":{"line":27,"column":63}}]},"3":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":18},"end":{"line":28,"column":32}},{"start":{"line":28,"column":36},"end":{"line":28,"column":69}}]},"4":{"line":34,"type":"binary-expr","locations":[{"start":{"line":34,"column":6},"end":{"line":34,"column":8}},{"start":{"line":34,"column":12},"end":{"line":34,"column":25}}]},"5":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},{"start":{"line":35,"column":1},"end":{"line":35,"column":1}}]},"6":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},{"start":{"line":39,"column":1},"end":{"line":39,"column":1}}]},"7":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},{"start":{"line":45,"column":1},"end":{"line":45,"column":1}}]},"8":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":2},"end":{"line":65,"column":2}},{"start":{"line":65,"column":2},"end":{"line":65,"column":2}}]},"9":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":2},"end":{"line":73,"column":2}},{"start":{"line":73,"column":2},"end":{"line":73,"column":2}}]},"10":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":2},"end":{"line":112,"column":2}},{"start":{"line":112,"column":2},"end":{"line":112,"column":2}}]},"11":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},{"start":{"line":130,"column":1},"end":{"line":130,"column":1}}]},"12":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},{"start":{"line":144,"column":1},"end":{"line":144,"column":1}}]},"13":{"line":153,"type":"if","locations":[{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},{"start":{"line":153,"column":1},"end":{"line":153,"column":1}}]},"14":{"line":167,"type":"binary-expr","locations":[{"start":{"line":167,"column":13},"end":{"line":167,"column":36}},{"start":{"line":167,"column":40},"end":{"line":167,"column":79}}]},"15":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},{"start":{"line":168,"column":1},"end":{"line":168,"column":1}}]},"16":{"line":195,"type":"if","locations":[{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},{"start":{"line":195,"column":1},"end":{"line":195,"column":1}}]},"17":{"line":201,"type":"if","locations":[{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},{"start":{"line":201,"column":1},"end":{"line":201,"column":1}}]},"18":{"line":202,"type":"if","locations":[{"start":{"line":202,"column":2},"end":{"line":202,"column":2}},{"start":{"line":202,"column":2},"end":{"line":202,"column":2}}]},"19":{"line":203,"type":"if","locations":[{"start":{"line":203,"column":3},"end":{"line":203,"column":3}},{"start":{"line":203,"column":3},"end":{"line":203,"column":3}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-admin', 'MqttClient');","var EventEmitter = require('events').EventEmitter;","var constants = require('../../util/constants');","var MqttCon = require('mqtt-connection');","var Util = require('util');","var net = require('net');","","var MqttClient = function(opts) {","\tEventEmitter.call(this);","\tthis.clientId = 'MQTT_ADMIN_' + Date.now();","\tthis.id = opts.id;","\tthis.requests = {};","\tthis.connectedTimes = 1;","\tthis.host = null;","\tthis.port = null;","\tthis.socket = null;","\tthis.lastPing = -1;","\tthis.lastPong = -1;","\tthis.closed = false;","\tthis.timeoutId = null;","\tthis.connected = false;","\tthis.reconnectId = null;","\tthis.timeoutFlag = false;","\tthis.keepaliveTimer = null;","\tthis.reconnectDelay = 0;","\tthis.reconnectDelayMax = opts.reconnectDelayMax || constants.DEFAULT_PARAM.RECONNECT_DELAY_MAX;","\tthis.timeout = opts.timeout || constants.DEFAULT_PARAM.TIMEOUT;","\tthis.keepalive = opts.keepalive || constants.DEFAULT_PARAM.KEEPALIVE;","}","","Util.inherits(MqttClient, EventEmitter);","","MqttClient.prototype.connect = function(host, port, cb) {","\tcb = cb || function() {}","\tif (this.connected) {","\t\treturn cb(new Error('MqttClient has already connected.'));","\t}","","\tif (host) {","\t\tthis.host = host;","\t} else {","\t\thost = this.host;","\t}","","\tif (port) {","\t\tthis.port = port;","\t} else {","\t\tport = this.port;","\t}","","\tvar self = this;","\tthis.closed = false;","","\tvar stream = net.createConnection(this.port, this.host);","\tthis.socket = MqttCon(stream);","","\t// logger.info('try to connect %s %s', this.host, this.port);","\tthis.socket.connect({","\t\tclientId: this.clientId","\t});","","\tthis.addTimeout();","","\tthis.socket.on('connack', function() {","\t\tif (self.connected) {","\t\t\treturn;","\t\t}","","\t\tself.connected = true;","","\t\tself.setupKeepAlive();","","\t\tif (self.connectedTimes++ == 1) {","\t\t\tself.emit('connect');","\t\t\tcb();","\t\t} else {","\t\t\tself.emit('reconnect');","\t\t}","\t});","","\tthis.socket.on('publish', function(pkg) {","\t\tvar topic = pkg.topic;","\t\tvar msg = pkg.payload.toString();","\t\tmsg = JSON.parse(msg);","","\t\t// logger.debug('[MqttClient] publish %s %j', topic, msg);","\t\tself.emit(topic, msg);","\t});","","\tthis.socket.on('close', function() {","\t\tlogger.error('mqtt socket is close, remote server host: %s, port: %s', host, port);","\t\tself.onSocketClose();","\t});","","\tthis.socket.on('error', function(err) {","\t\tlogger.error('mqtt socket is error, remote server host: %s, port: %s', host, port);","\t\t// self.emit('error', new Error('[MqttClient] socket is error, remote server ' + host + ':' + port));","\t\tself.onSocketClose();","\t});","","\tthis.socket.on('pingresp', function() {","\t\tself.lastPong = Date.now();","\t});","","\tthis.socket.on('disconnect', function() {","\t\tlogger.error('mqtt socket is disconnect, remote server host: %s, port: %s', host, port);","\t\tself.emit('disconnect', self.id);","\t\tself.onSocketClose();","\t});","","\tthis.socket.on('timeout', function(reconnectFlag) {","\t\tif (reconnectFlag) {","\t\t\tself.reconnect();","\t\t} else {","\t\t\tself.exit();","\t\t}","\t})","}","","MqttClient.prototype.send = function(topic, msg) {","\t// console.log('MqttClient send %s %j ~~~', topic, msg);","\tthis.socket.publish({","\t\ttopic: topic,","\t\tpayload: JSON.stringify(msg)","\t})","}","","MqttClient.prototype.onSocketClose = function() {","\t// console.log('onSocketClose ' + this.closed);","\tif (this.closed) {","\t\treturn;","\t}","","\tclearInterval(this.keepaliveTimer);","\tclearTimeout(this.timeoutId);","\tthis.keepaliveTimer = null;","\tthis.lastPing = -1;","\tthis.lastPong = -1;","\tthis.connected = false;","\tthis.closed = true;","\tdelete this.socket;","\tthis.socket = null;","","\tif (this.connectedTimes > 1) {","\t\tthis.reconnect();","\t} else {","\t\tthis.exit();","\t}","}","","MqttClient.prototype.addTimeout = function(reconnectFlag) {","\tvar self = this;","\tif (this.timeoutFlag) {","\t\treturn;","\t}","","\tthis.timeoutFlag = true;","","\tthis.timeoutId = setTimeout(function() {","\t\tself.timeoutFlag = false;","\t\tlogger.error('mqtt client connect %s:%d timeout %d s', self.host, self.port, self.timeout / 1000);","\t\tself.socket.emit('timeout', reconnectFlag);","\t}, self.timeout);","}","","MqttClient.prototype.reconnect = function() {","\tvar delay = this.reconnectDelay * 2 || constants.DEFAULT_PARAM.RECONNECT_DELAY;","\tif (delay > this.reconnectDelayMax) {","\t\tdelay = this.reconnectDelayMax;","\t}","","\tthis.reconnectDelay = delay;","","\tvar self = this;","","\t// logger.debug('[MqttClient] reconnect %d ...', delay);","\tthis.reconnectId = setTimeout(function() {","\t\tlogger.info('reconnect delay %d s', delay / 1000);","\t\tself.addTimeout(true);","\t\tself.connect();","\t}, delay);","}","","MqttClient.prototype.setupKeepAlive = function() {","\tclearTimeout(this.reconnectId);","\tclearTimeout(this.timeoutId);","","\tvar self = this;","\tthis.keepaliveTimer = setInterval(function() {","\t\tself.checkKeepAlive();","\t}, this.keepalive);","}","","MqttClient.prototype.checkKeepAlive = function() {","\tif (this.closed) {","\t\treturn;","\t}","","\tvar now = Date.now();","\tvar KEEP_ALIVE_TIMEOUT = this.keepalive * 2;","\tif (this.lastPing > 0) {","\t\tif (this.lastPong < this.lastPing) {","\t\t\tif (now - this.lastPing > KEEP_ALIVE_TIMEOUT) {","\t\t\t\tlogger.error('mqtt rpc client checkKeepAlive error timeout for %d', KEEP_ALIVE_TIMEOUT);","\t\t\t\tthis.close();","\t\t\t}","\t\t} else {","\t\t\tthis.socket.pingreq();","\t\t\tthis.lastPing = Date.now();","\t\t}","\t} else {","\t\tthis.socket.pingreq();","\t\tthis.lastPing = Date.now();","\t}","}","","MqttClient.prototype.disconnect = function() {","\tthis.close();","}","","MqttClient.prototype.close = function() {","\tthis.connected = false;","\tthis.closed = true;","\tthis.socket.disconnect();","}","","MqttClient.prototype.exit = function() {","\tlogger.info('exit ...');","\tprocess.exit(0);","}","","module.exports = MqttClient;"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"31":1,"33":1,"34":0,"35":0,"36":0,"39":0,"40":0,"42":0,"45":0,"46":0,"48":0,"51":0,"52":0,"54":0,"55":0,"58":0,"62":0,"64":0,"65":0,"66":0,"69":0,"71":0,"73":0,"74":0,"75":0,"77":0,"81":0,"82":0,"83":0,"84":0,"87":0,"90":0,"91":0,"92":0,"95":0,"96":0,"98":0,"101":0,"102":0,"105":0,"106":0,"107":0,"108":0,"111":0,"112":0,"113":0,"115":0,"120":1,"122":0,"128":1,"130":0,"131":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"144":0,"145":0,"147":0,"151":1,"152":0,"153":0,"154":0,"157":0,"159":0,"160":0,"161":0,"162":0,"166":1,"167":0,"168":0,"169":0,"172":0,"174":0,"177":0,"178":0,"179":0,"180":0,"184":1,"185":0,"186":0,"188":0,"189":0,"190":0,"194":1,"195":0,"196":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"208":0,"209":0,"212":0,"213":0,"217":1,"218":0,"221":1,"222":0,"223":0,"224":0,"227":1,"228":0,"229":0,"232":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/constants.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/constants.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":10,"column":2}}},"branchMap":{},"code":["module.exports = {","\tDEFAULT_PARAM: {","\t\tKEEPALIVE: 60 * 1000,","\t\tTIMEOUT: 5 * 1000,","\t\tRECONNECT_DELAY: 1 * 1000,","\t\tRECONNECT_DELAY_MAX: 60 * 1000","\t},","\tTYPE_CLIENT: 'client',","\tTYPE_MONITOR: 'monitor'","};"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/protocol.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/protocol.js","s":{"1":1,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":1,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":25},"end":{"line":1,"column":54}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":26},"end":{"line":18,"column":50}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":25},"end":{"line":31,"column":63}}},"4":{"name":"(anonymous_4)","line":49,"loc":{"start":{"line":49,"column":16},"end":{"line":49,"column":30}}},"5":{"name":"(anonymous_5)","line":56,"loc":{"start":{"line":56,"column":20},"end":{"line":56,"column":34}}},"6":{"name":"(anonymous_6)","line":60,"loc":{"start":{"line":60,"column":17},"end":{"line":60,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":16,"column":2}},"2":{"start":{"line":2,"column":1},"end":{"line":15,"column":2}},"3":{"start":{"line":4,"column":2},"end":{"line":8,"column":5}},"4":{"start":{"line":11,"column":2},"end":{"line":14,"column":4}},"5":{"start":{"line":18,"column":0},"end":{"line":29,"column":2}},"6":{"start":{"line":19,"column":1},"end":{"line":26,"column":2}},"7":{"start":{"line":21,"column":2},"end":{"line":25,"column":5}},"8":{"start":{"line":28,"column":1},"end":{"line":28,"column":13}},"9":{"start":{"line":31,"column":0},"end":{"line":47,"column":1}},"10":{"start":{"line":32,"column":1},"end":{"line":46,"column":2}},"11":{"start":{"line":34,"column":2},"end":{"line":39,"column":5}},"12":{"start":{"line":41,"column":2},"end":{"line":45,"column":5}},"13":{"start":{"line":49,"column":0},"end":{"line":54,"column":2}},"14":{"start":{"line":50,"column":1},"end":{"line":52,"column":2}},"15":{"start":{"line":51,"column":2},"end":{"line":51,"column":25}},"16":{"start":{"line":53,"column":1},"end":{"line":53,"column":12}},"17":{"start":{"line":56,"column":0},"end":{"line":58,"column":2}},"18":{"start":{"line":57,"column":1},"end":{"line":57,"column":27}},"19":{"start":{"line":60,"column":0},"end":{"line":70,"column":2}},"20":{"start":{"line":62,"column":1},"end":{"line":64,"column":2}},"21":{"start":{"line":63,"column":2},"end":{"line":63,"column":16}},"22":{"start":{"line":65,"column":1},"end":{"line":68,"column":3}},"23":{"start":{"line":69,"column":1},"end":{"line":69,"column":12}},"24":{"start":{"line":72,"column":0},"end":{"line":72,"column":19}},"25":{"start":{"line":73,"column":0},"end":{"line":73,"column":22}}},"branchMap":{"1":{"line":2,"type":"if","locations":[{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},{"start":{"line":2,"column":1},"end":{"line":2,"column":1}}]},"2":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},{"start":{"line":19,"column":1},"end":{"line":19,"column":1}}]},"3":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},{"start":{"line":32,"column":1},"end":{"line":32,"column":1}}]},"4":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},{"start":{"line":50,"column":1},"end":{"line":50,"column":1}}]},"5":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":9},"end":{"line":57,"column":12}},{"start":{"line":57,"column":16},"end":{"line":57,"column":25}}]},"6":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},{"start":{"line":62,"column":1},"end":{"line":62,"column":1}}]}},"code":["exports.composeRequest = function(id, moduleId, body) {","\tif (id) {","\t\t// request message","\t\treturn JSON.stringify({","\t\t\treqId: id,","\t\t\tmoduleId: moduleId,","\t\t\tbody: body","\t\t});","\t} else {","\t\t// notify message","\t\treturn {","\t\t\tmoduleId: moduleId,","\t\t\tbody: body","\t\t};","\t}","};","","exports.composeResponse = function(req, err, res) {","\tif (req.reqId) {","\t\t// request only","\t\treturn JSON.stringify({","\t\t\trespId: req.reqId,","\t\t\terror: cloneError(err),","\t\t\tbody: res","\t\t});","\t}","\t// invalid message(notify dose not need response)","\treturn null;","};","","exports.composeCommand = function(id, command, moduleId, body) {","\tif (id) {","\t\t// command message","\t\treturn JSON.stringify({","\t\t\treqId: id,","\t\t\tcommand: command,","\t\t\tmoduleId: moduleId,","\t\t\tbody: body","\t\t});","\t} else {","\t\treturn JSON.stringify({","\t\t\tcommand: command,","\t\t\tmoduleId: moduleId,","\t\t\tbody: body","\t\t});","\t}","}","","exports.parse = function(msg) {","\tif (typeof msg === 'string') {","\t\treturn JSON.parse(msg);","\t}","\treturn msg;","};","","exports.isRequest = function(msg) {","\treturn (msg && msg.reqId);","};","","var cloneError = function(origin) {","\t// copy the stack infos for Error instance json result is empty","\tif (!(origin instanceof Error)) {","\t\treturn origin;","\t}","\tvar res = {","\t\tmessage: origin.message,","\t\tstack: origin.stack","\t};","\treturn res;","};","","exports.PRO_OK = 1;","exports.PRO_FAIL = -1;"],"l":{"1":1,"2":0,"4":0,"11":0,"18":1,"19":0,"21":0,"28":0,"31":1,"32":0,"34":0,"41":0,"49":1,"50":0,"51":0,"53":0,"56":1,"57":0,"60":1,"62":0,"63":0,"65":0,"69":0,"72":1,"73":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/utils.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/utils.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":1,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":1,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":23},"end":{"line":11,"column":36}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":15},"end":{"line":20,"column":38}}},"3":{"name":"(anonymous_3)","line":46,"loc":{"start":{"line":46,"column":22},"end":{"line":46,"column":49}}},"4":{"name":"(anonymous_4)","line":54,"loc":{"start":{"line":54,"column":13},"end":{"line":54,"column":33}}},"5":{"name":"(anonymous_5)","line":71,"loc":{"start":{"line":71,"column":12},"end":{"line":71,"column":26}}},"6":{"name":"(anonymous_6)","line":78,"loc":{"start":{"line":78,"column":24},"end":{"line":78,"column":47}}},"7":{"name":"(anonymous_7)","line":120,"loc":{"start":{"line":120,"column":32},"end":{"line":120,"column":55}}},"8":{"name":"(anonymous_8)","line":158,"loc":{"start":{"line":158,"column":33},"end":{"line":158,"column":56}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":23}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"6":{"start":{"line":11,"column":0},"end":{"line":15,"column":2}},"7":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"8":{"start":{"line":13,"column":8},"end":{"line":13,"column":65}},"9":{"start":{"line":20,"column":0},"end":{"line":44,"column":2}},"10":{"start":{"line":21,"column":4},"end":{"line":21,"column":36}},"11":{"start":{"line":22,"column":4},"end":{"line":30,"column":6}},"12":{"start":{"line":32,"column":4},"end":{"line":34,"column":5}},"13":{"start":{"line":33,"column":8},"end":{"line":33,"column":99}},"14":{"start":{"line":35,"column":4},"end":{"line":41,"column":5}},"15":{"start":{"line":36,"column":8},"end":{"line":40,"column":9}},"16":{"start":{"line":37,"column":12},"end":{"line":39,"column":58}},"17":{"start":{"line":43,"column":4},"end":{"line":43,"column":18}},"18":{"start":{"line":46,"column":0},"end":{"line":49,"column":1}},"19":{"start":{"line":47,"column":4},"end":{"line":48,"column":46}},"20":{"start":{"line":54,"column":0},"end":{"line":69,"column":2}},"21":{"start":{"line":55,"column":4},"end":{"line":55,"column":18}},"22":{"start":{"line":56,"column":4},"end":{"line":67,"column":5}},"23":{"start":{"line":57,"column":8},"end":{"line":66,"column":9}},"24":{"start":{"line":58,"column":12},"end":{"line":61,"column":13}},"25":{"start":{"line":59,"column":16},"end":{"line":59,"column":24}},"26":{"start":{"line":60,"column":16},"end":{"line":60,"column":25}},"27":{"start":{"line":63,"column":12},"end":{"line":65,"column":13}},"28":{"start":{"line":64,"column":16},"end":{"line":64,"column":24}},"29":{"start":{"line":68,"column":4},"end":{"line":68,"column":17}},"30":{"start":{"line":71,"column":0},"end":{"line":76,"column":1}},"31":{"start":{"line":72,"column":4},"end":{"line":72,"column":42}},"32":{"start":{"line":73,"column":4},"end":{"line":73,"column":23}},"33":{"start":{"line":74,"column":4},"end":{"line":74,"column":31}},"34":{"start":{"line":75,"column":4},"end":{"line":75,"column":15}},"35":{"start":{"line":78,"column":0},"end":{"line":118,"column":1}},"36":{"start":{"line":79,"column":4},"end":{"line":79,"column":25}},"37":{"start":{"line":80,"column":4},"end":{"line":80,"column":54}},"38":{"start":{"line":81,"column":4},"end":{"line":81,"column":69}},"39":{"start":{"line":82,"column":4},"end":{"line":82,"column":74}},"40":{"start":{"line":83,"column":4},"end":{"line":90,"column":5}},"41":{"start":{"line":84,"column":8},"end":{"line":84,"column":43}},"42":{"start":{"line":85,"column":11},"end":{"line":90,"column":5}},"43":{"start":{"line":86,"column":8},"end":{"line":86,"column":41}},"44":{"start":{"line":88,"column":8},"end":{"line":88,"column":17}},"45":{"start":{"line":89,"column":8},"end":{"line":89,"column":15}},"46":{"start":{"line":91,"column":4},"end":{"line":91,"column":35}},"47":{"start":{"line":92,"column":4},"end":{"line":92,"column":35}},"48":{"start":{"line":93,"column":4},"end":{"line":93,"column":25}},"49":{"start":{"line":95,"column":4},"end":{"line":95,"column":31}},"50":{"start":{"line":96,"column":4},"end":{"line":116,"column":5}},"51":{"start":{"line":97,"column":8},"end":{"line":107,"column":9}},"52":{"start":{"line":98,"column":12},"end":{"line":98,"column":36}},"53":{"start":{"line":99,"column":12},"end":{"line":99,"column":23}},"54":{"start":{"line":100,"column":12},"end":{"line":106,"column":13}},"55":{"start":{"line":101,"column":16},"end":{"line":101,"column":48}},"56":{"start":{"line":102,"column":16},"end":{"line":105,"column":17}},"57":{"start":{"line":103,"column":20},"end":{"line":103,"column":29}},"58":{"start":{"line":104,"column":20},"end":{"line":104,"column":27}},"59":{"start":{"line":109,"column":8},"end":{"line":115,"column":9}},"60":{"start":{"line":110,"column":12},"end":{"line":110,"column":36}},"61":{"start":{"line":111,"column":12},"end":{"line":114,"column":13}},"62":{"start":{"line":112,"column":16},"end":{"line":112,"column":25}},"63":{"start":{"line":113,"column":16},"end":{"line":113,"column":23}},"64":{"start":{"line":117,"column":4},"end":{"line":117,"column":13}},"65":{"start":{"line":120,"column":0},"end":{"line":156,"column":1}},"66":{"start":{"line":121,"column":4},"end":{"line":121,"column":23}},"67":{"start":{"line":122,"column":4},"end":{"line":122,"column":33}},"68":{"start":{"line":123,"column":4},"end":{"line":123,"column":29}},"69":{"start":{"line":124,"column":4},"end":{"line":127,"column":5}},"70":{"start":{"line":125,"column":8},"end":{"line":125,"column":17}},"71":{"start":{"line":126,"column":8},"end":{"line":126,"column":15}},"72":{"start":{"line":129,"column":4},"end":{"line":129,"column":23}},"73":{"start":{"line":130,"column":4},"end":{"line":130,"column":54}},"74":{"start":{"line":131,"column":4},"end":{"line":131,"column":68}},"75":{"start":{"line":132,"column":4},"end":{"line":132,"column":27}},"76":{"start":{"line":133,"column":4},"end":{"line":135,"column":5}},"77":{"start":{"line":134,"column":8},"end":{"line":134,"column":76}},"78":{"start":{"line":137,"column":4},"end":{"line":144,"column":5}},"79":{"start":{"line":138,"column":8},"end":{"line":138,"column":38}},"80":{"start":{"line":139,"column":11},"end":{"line":144,"column":5}},"81":{"start":{"line":140,"column":8},"end":{"line":140,"column":39}},"82":{"start":{"line":142,"column":8},"end":{"line":142,"column":17}},"83":{"start":{"line":143,"column":8},"end":{"line":143,"column":15}},"84":{"start":{"line":146,"column":4},"end":{"line":146,"column":29}},"85":{"start":{"line":147,"column":4},"end":{"line":153,"column":5}},"86":{"start":{"line":148,"column":8},"end":{"line":148,"column":32}},"87":{"start":{"line":149,"column":8},"end":{"line":152,"column":9}},"88":{"start":{"line":150,"column":12},"end":{"line":150,"column":21}},"89":{"start":{"line":151,"column":12},"end":{"line":151,"column":19}},"90":{"start":{"line":154,"column":4},"end":{"line":154,"column":14}},"91":{"start":{"line":155,"column":4},"end":{"line":155,"column":11}},"92":{"start":{"line":158,"column":0},"end":{"line":189,"column":1}},"93":{"start":{"line":159,"column":4},"end":{"line":159,"column":23}},"94":{"start":{"line":160,"column":4},"end":{"line":160,"column":33}},"95":{"start":{"line":162,"column":4},"end":{"line":162,"column":23}},"96":{"start":{"line":163,"column":4},"end":{"line":163,"column":54}},"97":{"start":{"line":164,"column":4},"end":{"line":164,"column":68}},"98":{"start":{"line":165,"column":4},"end":{"line":165,"column":27}},"99":{"start":{"line":166,"column":4},"end":{"line":168,"column":5}},"100":{"start":{"line":167,"column":8},"end":{"line":167,"column":76}},"101":{"start":{"line":170,"column":4},"end":{"line":177,"column":5}},"102":{"start":{"line":171,"column":8},"end":{"line":171,"column":38}},"103":{"start":{"line":172,"column":11},"end":{"line":177,"column":5}},"104":{"start":{"line":173,"column":8},"end":{"line":173,"column":39}},"105":{"start":{"line":175,"column":8},"end":{"line":175,"column":17}},"106":{"start":{"line":176,"column":8},"end":{"line":176,"column":15}},"107":{"start":{"line":179,"column":4},"end":{"line":179,"column":29}},"108":{"start":{"line":180,"column":4},"end":{"line":186,"column":5}},"109":{"start":{"line":181,"column":8},"end":{"line":181,"column":32}},"110":{"start":{"line":182,"column":8},"end":{"line":185,"column":9}},"111":{"start":{"line":183,"column":12},"end":{"line":183,"column":32}},"112":{"start":{"line":184,"column":12},"end":{"line":184,"column":19}},"113":{"start":{"line":187,"column":4},"end":{"line":187,"column":13}},"114":{"start":{"line":188,"column":4},"end":{"line":188,"column":11}}},"branchMap":{"1":{"line":12,"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":12,"column":4}},{"start":{"line":12,"column":4},"end":{"line":12,"column":4}}]},"2":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":8},"end":{"line":12,"column":12}},{"start":{"line":12,"column":16},"end":{"line":12,"column":40}}]},"3":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":13},"end":{"line":21,"column":19}},{"start":{"line":21,"column":23},"end":{"line":21,"column":35}}]},"4":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":4},"end":{"line":32,"column":4}},{"start":{"line":32,"column":4},"end":{"line":32,"column":4}}]},"5":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":8},"end":{"line":36,"column":8}},{"start":{"line":36,"column":8},"end":{"line":36,"column":8}}]},"6":{"line":38,"type":"cond-expr","locations":[{"start":{"line":38,"column":41},"end":{"line":38,"column":45}},{"start":{"line":39,"column":16},"end":{"line":39,"column":56}}]},"7":{"line":47,"type":"binary-expr","locations":[{"start":{"line":47,"column":12},"end":{"line":47,"column":47}},{"start":{"line":48,"column":9},"end":{"line":48,"column":44}}]},"8":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":57,"column":8}},{"start":{"line":57,"column":8},"end":{"line":57,"column":8}}]},"9":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":12},"end":{"line":57,"column":33}},{"start":{"line":57,"column":37},"end":{"line":57,"column":65}}]},"10":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":12},"end":{"line":58,"column":12}},{"start":{"line":58,"column":12},"end":{"line":58,"column":12}}]},"11":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":12},"end":{"line":63,"column":12}},{"start":{"line":63,"column":12},"end":{"line":63,"column":12}}]},"12":{"line":63,"type":"binary-expr","locations":[{"start":{"line":63,"column":16},"end":{"line":63,"column":20}},{"start":{"line":63,"column":24},"end":{"line":63,"column":47}}]},"13":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":4},"end":{"line":83,"column":4}},{"start":{"line":83,"column":4},"end":{"line":83,"column":4}}]},"14":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":11},"end":{"line":85,"column":11}},{"start":{"line":85,"column":11},"end":{"line":85,"column":11}}]},"15":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":4},"end":{"line":96,"column":4}},{"start":{"line":96,"column":4},"end":{"line":96,"column":4}}]},"16":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":12},"end":{"line":100,"column":12}},{"start":{"line":100,"column":12},"end":{"line":100,"column":12}}]},"17":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":16},"end":{"line":102,"column":16}},{"start":{"line":102,"column":16},"end":{"line":102,"column":16}}]},"18":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":12},"end":{"line":111,"column":12}},{"start":{"line":111,"column":12},"end":{"line":111,"column":12}}]},"19":{"line":111,"type":"binary-expr","locations":[{"start":{"line":111,"column":16},"end":{"line":111,"column":45}},{"start":{"line":111,"column":49},"end":{"line":111,"column":78}}]},"20":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":4},"end":{"line":124,"column":4}},{"start":{"line":124,"column":4},"end":{"line":124,"column":4}}]},"21":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":4},"end":{"line":133,"column":4}},{"start":{"line":133,"column":4},"end":{"line":133,"column":4}}]},"22":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":4},"end":{"line":137,"column":4}},{"start":{"line":137,"column":4},"end":{"line":137,"column":4}}]},"23":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":11},"end":{"line":139,"column":11}},{"start":{"line":139,"column":11},"end":{"line":139,"column":11}}]},"24":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":8},"end":{"line":149,"column":8}},{"start":{"line":149,"column":8},"end":{"line":149,"column":8}}]},"25":{"line":149,"type":"binary-expr","locations":[{"start":{"line":149,"column":12},"end":{"line":149,"column":35}},{"start":{"line":149,"column":39},"end":{"line":149,"column":64}}]},"26":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":166,"column":4}},{"start":{"line":166,"column":4},"end":{"line":166,"column":4}}]},"27":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":4},"end":{"line":170,"column":4}},{"start":{"line":170,"column":4},"end":{"line":170,"column":4}}]},"28":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":11},"end":{"line":172,"column":11}},{"start":{"line":172,"column":11},"end":{"line":172,"column":11}}]},"29":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":8},"end":{"line":182,"column":8}},{"start":{"line":182,"column":8},"end":{"line":182,"column":8}}]}},"code":["var crypto = require('crypto');","var util = require('util');","var path = require('path');","var fs = require('fs');","","var utils = module.exports;","","/**"," * Check and invoke callback"," */","utils.invokeCallback = function(cb) {","    if (!!cb && typeof cb === 'function') {","        cb.apply(null, Array.prototype.slice.call(arguments, 1));","    }","};","","/*"," * Date format"," */","utils.format = function(date, format) {","    format = format || 'MM-dd-hhmm';","    var o = {","        \"M+\": date.getMonth() + 1, //month","        \"d+\": date.getDate(), //day","        \"h+\": date.getHours(), //hour","        \"m+\": date.getMinutes(), //minute","        \"s+\": date.getSeconds(), //second","        \"q+\": Math.floor((date.getMonth() + 3) / 3), //quarter","        \"S\": date.getMilliseconds() //millisecond","    };","","    if (/(y+)/.test(format)) {","        format = format.replace(RegExp.$1, (date.getFullYear() + \"\").substr(4 - RegExp.$1.length));","    }","    for (var k in o) {","        if (new RegExp(\"(\" + k + \")\").test(format)) {","            format = format.replace(RegExp.$1,","                RegExp.$1.length === 1 ? o[k] :","                (\"00\" + o[k]).substr((\"\" + o[k]).length));","        }","    }","","    return format;","};","","utils.compareServer = function(server1, server2) {","    return (server1['host'] === server2['host']) &&","        (server1['port'] === server2['port']);","}","","/**"," * Get the count of elements of object"," */","utils.size = function(obj, type) {","    var count = 0;","    for (var i in obj) {","        if (obj.hasOwnProperty(i) && typeof obj[i] !== 'function') {","            if (!type) {","                count++;","                continue;","            }","","            if (type && type === obj[i]['type']) {","                count++;","            }","        }","    }","    return count;","};","","utils.md5 = function(str) {","    var md5sum = crypto.createHash('md5');","    md5sum.update(str);","    str = md5sum.digest('hex');","    return str;","}","","utils.defaultAuthUser = function(msg, env, cb) {","    var adminUser = null;","    var appBase = path.dirname(require.main.filename);","    var adminUserPath = path.join(appBase, '/config/adminUser.json');","    var presentPath = path.join(appBase, 'config', env, 'adminUser.json');","    if (fs.existsSync(adminUserPath)) {","        adminUser = require(adminUserPath);","    } else if (fs.existsSync(presentPath)) {","        adminUser = require(presentPath);","    } else {","        cb(null);","        return;","    }","    var username = msg['username'];","    var password = msg['password'];","    var md5 = msg['md5'];","","    var len = adminUser.length;","    if (md5) {","        for (var i = 0; i < len; i++) {","            var user = adminUser[i];","            var p = \"\";","            if (user['username'] === username) {","                p = utils.md5(user['password']);","                if (password === p) {","                    cb(user);","                    return;","                }","            }","        }","    } else {","        for (var i = 0; i < len; i++) {","            var user = adminUser[i];","            if (user['username'] === username && user['password'] === password) {","                cb(user);","                return;","            }","        }","    }","    cb(null);","}","","utils.defaultAuthServerMaster = function(msg, env, cb) {","    var id = msg['id'];","    var type = msg['serverType'];","    var token = msg['token'];","    if (type === 'master') {","        cb('ok');","        return;","    }","","    var servers = null;","    var appBase = path.dirname(require.main.filename);","    var serverPath = path.join(appBase, '/config/adminServer.json');","    var presentPath = null;","    if (env) {","        presentPath = path.join(appBase, 'config', env, 'adminServer.json');","    }","","    if (fs.existsSync(serverPath)) {","        servers = require(serverPath);","    } else if (fs.existsSync(presentPath)) {","        servers = require(presentPath);","    } else {","        cb('ok');","        return;","    }","","    var len = servers.length;","    for (var i = 0; i < len; i++) {","        var server = servers[i];","        if (server['type'] === type && server['token'] === token) {","            cb('ok');","            return;","        }","    }","    cb('bad');","    return;","}","","utils.defaultAuthServerMonitor = function(msg, env, cb) {","    var id = msg['id'];","    var type = msg['serverType'];","","    var servers = null;","    var appBase = path.dirname(require.main.filename);","    var serverPath = path.join(appBase, '/config/adminServer.json');","    var presentPath = null;","    if (env) {","        presentPath = path.join(appBase, 'config', env, 'adminServer.json');","    }","","    if (fs.existsSync(serverPath)) {","        servers = require(serverPath);","    } else if (fs.existsSync(presentPath)) {","        servers = require(presentPath);","    } else {","        cb('ok');","        return;","    }","","    var len = servers.length;","    for (var i = 0; i < len; i++) {","        var server = servers[i];","        if (server['type'] === type) {","            cb(server['token']);","            return;","        }","    }","    cb(null);","    return;","}"],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"11":1,"12":0,"13":0,"20":1,"21":0,"22":0,"32":0,"33":0,"35":0,"36":0,"37":0,"43":0,"46":1,"47":0,"54":1,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"63":0,"64":0,"68":0,"71":1,"72":0,"73":0,"74":0,"75":0,"78":1,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"88":0,"89":0,"91":0,"92":0,"93":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"109":0,"110":0,"111":0,"112":0,"113":0,"117":0,"120":1,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"137":0,"138":0,"139":0,"140":0,"142":0,"143":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"154":0,"155":0,"158":1,"159":0,"160":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"170":0,"171":0,"172":0,"173":0,"175":0,"176":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"187":0,"188":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/master/masterAgent.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/master/masterAgent.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1,"61":0,"62":0,"63":0,"64":0,"65":1,"66":0,"67":1,"68":0,"69":1,"70":0,"71":1,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":1,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":1,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":1,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":1,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":1,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":1,"146":0,"147":0,"148":0,"149":0,"150":1,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":1,"159":0,"160":0,"161":0,"162":0,"163":1,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":1,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":1,"200":0,"201":1,"202":0,"203":1,"204":0,"205":1,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":1,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":1,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":1,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":1,"260":1,"261":1,"262":1,"263":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":18},"end":{"line":28,"column":49}}},"2":{"name":"(anonymous_2)","line":52,"loc":{"start":{"line":52,"column":31},"end":{"line":52,"column":50}}},"3":{"name":"(anonymous_3)","line":64,"loc":{"start":{"line":64,"column":13},"end":{"line":64,"column":24}}},"4":{"name":"(anonymous_4)","line":67,"loc":{"start":{"line":67,"column":26},"end":{"line":67,"column":40}}},"5":{"name":"(anonymous_5)","line":72,"loc":{"start":{"line":72,"column":32},"end":{"line":72,"column":43}}},"6":{"name":"(anonymous_6)","line":73,"loc":{"start":{"line":73,"column":17},"end":{"line":73,"column":28}}},"7":{"name":"(anonymous_7)","line":78,"loc":{"start":{"line":78,"column":31},"end":{"line":78,"column":48}}},"8":{"name":"(anonymous_8)","line":86,"loc":{"start":{"line":86,"column":26},"end":{"line":86,"column":40}}},"9":{"name":"(anonymous_9)","line":92,"loc":{"start":{"line":92,"column":25},"end":{"line":92,"column":39}}},"10":{"name":"(anonymous_10)","line":97,"loc":{"start":{"line":97,"column":24},"end":{"line":97,"column":38}}},"11":{"name":"(anonymous_11)","line":101,"loc":{"start":{"line":101,"column":27},"end":{"line":101,"column":41}}},"12":{"name":"(anonymous_12)","line":105,"loc":{"start":{"line":105,"column":28},"end":{"line":105,"column":39}}},"13":{"name":"(anonymous_13)","line":109,"loc":{"start":{"line":109,"column":23},"end":{"line":109,"column":34}}},"14":{"name":"(anonymous_14)","line":113,"loc":{"start":{"line":113,"column":23},"end":{"line":113,"column":37}}},"15":{"name":"(anonymous_15)","line":124,"loc":{"start":{"line":124,"column":30},"end":{"line":124,"column":41}}},"16":{"name":"(anonymous_16)","line":139,"loc":{"start":{"line":139,"column":28},"end":{"line":139,"column":54}}},"17":{"name":"(anonymous_17)","line":149,"loc":{"start":{"line":149,"column":28},"end":{"line":149,"column":47}}},"18":{"name":"(anonymous_18)","line":159,"loc":{"start":{"line":159,"column":38},"end":{"line":159,"column":57}}},"19":{"name":"(anonymous_19)","line":172,"loc":{"start":{"line":172,"column":32},"end":{"line":172,"column":70}}},"20":{"name":"(anonymous_20)","line":177,"loc":{"start":{"line":177,"column":13},"end":{"line":177,"column":24}}},"21":{"name":"(anonymous_21)","line":212,"loc":{"start":{"line":212,"column":38},"end":{"line":212,"column":88}}},"22":{"name":"(anonymous_22)","line":249,"loc":{"start":{"line":249,"column":35},"end":{"line":249,"column":69}}},"23":{"name":"(anonymous_23)","line":274,"loc":{"start":{"line":274,"column":39},"end":{"line":274,"column":85}}},"24":{"name":"(anonymous_24)","line":307,"loc":{"start":{"line":307,"column":41},"end":{"line":307,"column":75}}},"25":{"name":"(anonymous_25)","line":330,"loc":{"start":{"line":330,"column":37},"end":{"line":330,"column":67}}},"26":{"name":"(anonymous_26)","line":351,"loc":{"start":{"line":351,"column":34},"end":{"line":351,"column":58}}},"27":{"name":"(anonymous_27)","line":367,"loc":{"start":{"line":367,"column":37},"end":{"line":367,"column":71}}},"28":{"name":"(anonymous_28)","line":380,"loc":{"start":{"line":380,"column":38},"end":{"line":380,"column":71}}},"29":{"name":"(anonymous_29)","line":397,"loc":{"start":{"line":397,"column":20},"end":{"line":397,"column":65}}},"30":{"name":"(anonymous_30)","line":428,"loc":{"start":{"line":428,"column":23},"end":{"line":428,"column":55}}},"31":{"name":"(anonymous_31)","line":479,"loc":{"start":{"line":479,"column":20},"end":{"line":479,"column":59}}},"32":{"name":"(anonymous_32)","line":492,"loc":{"start":{"line":492,"column":19},"end":{"line":492,"column":58}}},"33":{"name":"(anonymous_33)","line":496,"loc":{"start":{"line":496,"column":13},"end":{"line":496,"column":42}}},"34":{"name":"(anonymous_34)","line":508,"loc":{"start":{"line":508,"column":24},"end":{"line":508,"column":57}}},"35":{"name":"(anonymous_35)","line":524,"loc":{"start":{"line":524,"column":23},"end":{"line":524,"column":65}}},"36":{"name":"(anonymous_36)","line":540,"loc":{"start":{"line":540,"column":35},"end":{"line":540,"column":61}}},"37":{"name":"(anonymous_37)","line":559,"loc":{"start":{"line":559,"column":21},"end":{"line":559,"column":36}}},"38":{"name":"(anonymous_38)","line":588,"loc":{"start":{"line":588,"column":37},"end":{"line":588,"column":63}}},"39":{"name":"(anonymous_39)","line":592,"loc":{"start":{"line":592,"column":23},"end":{"line":592,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":79}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":56}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":50}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":43}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":37}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":18}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":19}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":18}},"11":{"start":{"line":28,"column":0},"end":{"line":42,"column":2}},"12":{"start":{"line":29,"column":2},"end":{"line":29,"column":26}},"13":{"start":{"line":30,"column":2},"end":{"line":30,"column":17}},"14":{"start":{"line":31,"column":2},"end":{"line":31,"column":18}},"15":{"start":{"line":32,"column":2},"end":{"line":32,"column":19}},"16":{"start":{"line":33,"column":2},"end":{"line":33,"column":20}},"17":{"start":{"line":34,"column":2},"end":{"line":34,"column":20}},"18":{"start":{"line":35,"column":2},"end":{"line":35,"column":20}},"19":{"start":{"line":36,"column":2},"end":{"line":36,"column":21}},"20":{"start":{"line":37,"column":2},"end":{"line":37,"column":21}},"21":{"start":{"line":38,"column":2},"end":{"line":38,"column":22}},"22":{"start":{"line":39,"column":2},"end":{"line":39,"column":25}},"23":{"start":{"line":40,"column":2},"end":{"line":40,"column":34}},"24":{"start":{"line":41,"column":2},"end":{"line":41,"column":39}},"25":{"start":{"line":44,"column":0},"end":{"line":44,"column":41}},"26":{"start":{"line":52,"column":0},"end":{"line":117,"column":2}},"27":{"start":{"line":53,"column":2},"end":{"line":56,"column":3}},"28":{"start":{"line":54,"column":4},"end":{"line":54,"column":56}},"29":{"start":{"line":55,"column":4},"end":{"line":55,"column":11}},"30":{"start":{"line":58,"column":2},"end":{"line":58,"column":26}},"31":{"start":{"line":59,"column":2},"end":{"line":59,"column":33}},"32":{"start":{"line":60,"column":2},"end":{"line":60,"column":27}},"33":{"start":{"line":64,"column":2},"end":{"line":64,"column":26}},"34":{"start":{"line":66,"column":2},"end":{"line":66,"column":18}},"35":{"start":{"line":67,"column":2},"end":{"line":70,"column":5}},"36":{"start":{"line":68,"column":4},"end":{"line":68,"column":28}},"37":{"start":{"line":69,"column":4},"end":{"line":69,"column":12}},"38":{"start":{"line":72,"column":2},"end":{"line":76,"column":5}},"39":{"start":{"line":73,"column":4},"end":{"line":75,"column":7}},"40":{"start":{"line":74,"column":6},"end":{"line":74,"column":11}},"41":{"start":{"line":78,"column":2},"end":{"line":116,"column":5}},"42":{"start":{"line":80,"column":4},"end":{"line":80,"column":42}},"43":{"start":{"line":81,"column":4},"end":{"line":81,"column":33}},"44":{"start":{"line":82,"column":4},"end":{"line":82,"column":36}},"45":{"start":{"line":84,"column":4},"end":{"line":84,"column":37}},"46":{"start":{"line":86,"column":4},"end":{"line":89,"column":7}},"47":{"start":{"line":88,"column":6},"end":{"line":88,"column":35}},"48":{"start":{"line":92,"column":4},"end":{"line":94,"column":7}},"49":{"start":{"line":93,"column":6},"end":{"line":93,"column":34}},"50":{"start":{"line":97,"column":4},"end":{"line":99,"column":7}},"51":{"start":{"line":98,"column":6},"end":{"line":98,"column":33}},"52":{"start":{"line":101,"column":4},"end":{"line":103,"column":7}},"53":{"start":{"line":102,"column":6},"end":{"line":102,"column":36}},"54":{"start":{"line":105,"column":4},"end":{"line":107,"column":7}},"55":{"start":{"line":106,"column":6},"end":{"line":106,"column":34}},"56":{"start":{"line":109,"column":4},"end":{"line":111,"column":7}},"57":{"start":{"line":110,"column":6},"end":{"line":110,"column":34}},"58":{"start":{"line":113,"column":4},"end":{"line":115,"column":7}},"59":{"start":{"line":114,"column":6},"end":{"line":114,"column":32}},"60":{"start":{"line":124,"column":0},"end":{"line":130,"column":2}},"61":{"start":{"line":125,"column":2},"end":{"line":127,"column":3}},"62":{"start":{"line":126,"column":4},"end":{"line":126,"column":11}},"63":{"start":{"line":128,"column":2},"end":{"line":128,"column":25}},"64":{"start":{"line":129,"column":2},"end":{"line":129,"column":22}},"65":{"start":{"line":139,"column":0},"end":{"line":141,"column":2}},"66":{"start":{"line":140,"column":2},"end":{"line":140,"column":43}},"67":{"start":{"line":149,"column":0},"end":{"line":151,"column":2}},"68":{"start":{"line":150,"column":2},"end":{"line":150,"column":43}},"69":{"start":{"line":159,"column":0},"end":{"line":161,"column":2}},"70":{"start":{"line":160,"column":2},"end":{"line":160,"column":32}},"71":{"start":{"line":172,"column":0},"end":{"line":200,"column":2}},"72":{"start":{"line":173,"column":2},"end":{"line":175,"column":3}},"73":{"start":{"line":174,"column":4},"end":{"line":174,"column":17}},"74":{"start":{"line":177,"column":2},"end":{"line":177,"column":26}},"75":{"start":{"line":179,"column":2},"end":{"line":179,"column":27}},"76":{"start":{"line":180,"column":2},"end":{"line":180,"column":29}},"77":{"start":{"line":182,"column":2},"end":{"line":184,"column":3}},"78":{"start":{"line":183,"column":4},"end":{"line":183,"column":31}},"79":{"start":{"line":186,"column":2},"end":{"line":189,"column":3}},"80":{"start":{"line":191,"column":2},"end":{"line":191,"column":36}},"81":{"start":{"line":192,"column":2},"end":{"line":195,"column":3}},"82":{"start":{"line":193,"column":4},"end":{"line":193,"column":51}},"83":{"start":{"line":194,"column":4},"end":{"line":194,"column":17}},"84":{"start":{"line":197,"column":2},"end":{"line":197,"column":53}},"85":{"start":{"line":199,"column":2},"end":{"line":199,"column":14}},"86":{"start":{"line":212,"column":0},"end":{"line":239,"column":2}},"87":{"start":{"line":213,"column":2},"end":{"line":215,"column":3}},"88":{"start":{"line":214,"column":4},"end":{"line":214,"column":17}},"89":{"start":{"line":217,"column":2},"end":{"line":217,"column":36}},"90":{"start":{"line":218,"column":2},"end":{"line":221,"column":3}},"91":{"start":{"line":219,"column":4},"end":{"line":219,"column":73}},"92":{"start":{"line":220,"column":4},"end":{"line":220,"column":17}},"93":{"start":{"line":223,"column":2},"end":{"line":223,"column":27}},"94":{"start":{"line":224,"column":2},"end":{"line":224,"column":29}},"95":{"start":{"line":226,"column":2},"end":{"line":236,"column":3}},"96":{"start":{"line":227,"column":4},"end":{"line":227,"column":55}},"97":{"start":{"line":229,"column":4},"end":{"line":229,"column":41}},"98":{"start":{"line":230,"column":4},"end":{"line":235,"column":5}},"99":{"start":{"line":231,"column":6},"end":{"line":234,"column":7}},"100":{"start":{"line":232,"column":8},"end":{"line":232,"column":62}},"101":{"start":{"line":233,"column":8},"end":{"line":233,"column":14}},"102":{"start":{"line":238,"column":2},"end":{"line":238,"column":14}},"103":{"start":{"line":249,"column":0},"end":{"line":263,"column":2}},"104":{"start":{"line":250,"column":2},"end":{"line":252,"column":3}},"105":{"start":{"line":251,"column":4},"end":{"line":251,"column":17}},"106":{"start":{"line":254,"column":2},"end":{"line":254,"column":36}},"107":{"start":{"line":255,"column":2},"end":{"line":258,"column":3}},"108":{"start":{"line":256,"column":4},"end":{"line":256,"column":73}},"109":{"start":{"line":257,"column":4},"end":{"line":257,"column":17}},"110":{"start":{"line":260,"column":2},"end":{"line":260,"column":52}},"111":{"start":{"line":262,"column":2},"end":{"line":262,"column":14}},"112":{"start":{"line":274,"column":0},"end":{"line":297,"column":2}},"113":{"start":{"line":275,"column":2},"end":{"line":277,"column":3}},"114":{"start":{"line":276,"column":4},"end":{"line":276,"column":17}},"115":{"start":{"line":279,"column":2},"end":{"line":279,"column":36}},"116":{"start":{"line":280,"column":2},"end":{"line":283,"column":3}},"117":{"start":{"line":281,"column":4},"end":{"line":281,"column":77}},"118":{"start":{"line":282,"column":4},"end":{"line":282,"column":17}},"119":{"start":{"line":285,"column":2},"end":{"line":295,"column":3}},"120":{"start":{"line":286,"column":4},"end":{"line":286,"column":54}},"121":{"start":{"line":288,"column":4},"end":{"line":288,"column":41}},"122":{"start":{"line":289,"column":4},"end":{"line":294,"column":5}},"123":{"start":{"line":290,"column":6},"end":{"line":293,"column":7}},"124":{"start":{"line":291,"column":8},"end":{"line":291,"column":61}},"125":{"start":{"line":292,"column":8},"end":{"line":292,"column":14}},"126":{"start":{"line":296,"column":2},"end":{"line":296,"column":14}},"127":{"start":{"line":307,"column":0},"end":{"line":320,"column":2}},"128":{"start":{"line":308,"column":2},"end":{"line":310,"column":3}},"129":{"start":{"line":309,"column":4},"end":{"line":309,"column":17}},"130":{"start":{"line":312,"column":2},"end":{"line":312,"column":39}},"131":{"start":{"line":313,"column":2},"end":{"line":316,"column":3}},"132":{"start":{"line":314,"column":4},"end":{"line":314,"column":79}},"133":{"start":{"line":315,"column":4},"end":{"line":315,"column":17}},"134":{"start":{"line":318,"column":2},"end":{"line":318,"column":43}},"135":{"start":{"line":319,"column":2},"end":{"line":319,"column":14}},"136":{"start":{"line":330,"column":0},"end":{"line":342,"column":2}},"137":{"start":{"line":331,"column":2},"end":{"line":333,"column":3}},"138":{"start":{"line":332,"column":4},"end":{"line":332,"column":17}},"139":{"start":{"line":335,"column":2},"end":{"line":335,"column":32}},"140":{"start":{"line":336,"column":2},"end":{"line":339,"column":3}},"141":{"start":{"line":337,"column":4},"end":{"line":337,"column":73}},"142":{"start":{"line":338,"column":4},"end":{"line":338,"column":17}},"143":{"start":{"line":340,"column":2},"end":{"line":340,"column":41}},"144":{"start":{"line":341,"column":2},"end":{"line":341,"column":14}},"145":{"start":{"line":351,"column":0},"end":{"line":357,"column":2}},"146":{"start":{"line":352,"column":2},"end":{"line":354,"column":3}},"147":{"start":{"line":353,"column":4},"end":{"line":353,"column":17}},"148":{"start":{"line":355,"column":2},"end":{"line":355,"column":47}},"149":{"start":{"line":356,"column":2},"end":{"line":356,"column":14}},"150":{"start":{"line":367,"column":0},"end":{"line":378,"column":2}},"151":{"start":{"line":368,"column":2},"end":{"line":370,"column":3}},"152":{"start":{"line":369,"column":4},"end":{"line":369,"column":17}},"153":{"start":{"line":372,"column":2},"end":{"line":372,"column":38}},"154":{"start":{"line":373,"column":2},"end":{"line":376,"column":3}},"155":{"start":{"line":374,"column":4},"end":{"line":374,"column":75}},"156":{"start":{"line":375,"column":4},"end":{"line":375,"column":17}},"157":{"start":{"line":377,"column":2},"end":{"line":377,"column":51}},"158":{"start":{"line":380,"column":0},"end":{"line":386,"column":2}},"159":{"start":{"line":381,"column":2},"end":{"line":383,"column":3}},"160":{"start":{"line":382,"column":4},"end":{"line":382,"column":17}},"161":{"start":{"line":384,"column":2},"end":{"line":384,"column":55}},"162":{"start":{"line":385,"column":2},"end":{"line":385,"column":14}},"163":{"start":{"line":397,"column":0},"end":{"line":418,"column":2}},"164":{"start":{"line":398,"column":2},"end":{"line":404,"column":4}},"165":{"start":{"line":405,"column":2},"end":{"line":416,"column":3}},"166":{"start":{"line":406,"column":4},"end":{"line":406,"column":31}},"167":{"start":{"line":408,"column":4},"end":{"line":415,"column":5}},"168":{"start":{"line":409,"column":6},"end":{"line":409,"column":31}},"169":{"start":{"line":410,"column":6},"end":{"line":410,"column":65}},"170":{"start":{"line":411,"column":6},"end":{"line":411,"column":24}},"171":{"start":{"line":413,"column":6},"end":{"line":413,"column":65}},"172":{"start":{"line":414,"column":6},"end":{"line":414,"column":26}},"173":{"start":{"line":417,"column":2},"end":{"line":417,"column":16}},"174":{"start":{"line":428,"column":0},"end":{"line":468,"column":2}},"175":{"start":{"line":429,"column":2},"end":{"line":467,"column":3}},"176":{"start":{"line":430,"column":4},"end":{"line":430,"column":29}},"177":{"start":{"line":433,"column":4},"end":{"line":433,"column":33}},"178":{"start":{"line":434,"column":4},"end":{"line":436,"column":5}},"179":{"start":{"line":435,"column":6},"end":{"line":435,"column":13}},"180":{"start":{"line":437,"column":4},"end":{"line":437,"column":31}},"181":{"start":{"line":438,"column":4},"end":{"line":466,"column":5}},"182":{"start":{"line":439,"column":6},"end":{"line":439,"column":29}},"183":{"start":{"line":440,"column":6},"end":{"line":440,"column":37}},"184":{"start":{"line":441,"column":6},"end":{"line":451,"column":7}},"185":{"start":{"line":442,"column":8},"end":{"line":447,"column":9}},"186":{"start":{"line":443,"column":10},"end":{"line":446,"column":11}},"187":{"start":{"line":444,"column":12},"end":{"line":444,"column":30}},"188":{"start":{"line":445,"column":12},"end":{"line":445,"column":18}},"189":{"start":{"line":448,"column":8},"end":{"line":450,"column":9}},"190":{"start":{"line":449,"column":10},"end":{"line":449,"column":37}},"191":{"start":{"line":454,"column":6},"end":{"line":454,"column":38}},"192":{"start":{"line":455,"column":6},"end":{"line":465,"column":7}},"193":{"start":{"line":456,"column":8},"end":{"line":461,"column":9}},"194":{"start":{"line":457,"column":10},"end":{"line":460,"column":11}},"195":{"start":{"line":458,"column":12},"end":{"line":458,"column":32}},"196":{"start":{"line":459,"column":12},"end":{"line":459,"column":18}},"197":{"start":{"line":462,"column":8},"end":{"line":464,"column":9}},"198":{"start":{"line":463,"column":10},"end":{"line":463,"column":36}},"199":{"start":{"line":479,"column":0},"end":{"line":481,"column":2}},"200":{"start":{"line":480,"column":2},"end":{"line":480,"column":75}},"201":{"start":{"line":492,"column":0},"end":{"line":494,"column":2}},"202":{"start":{"line":493,"column":2},"end":{"line":493,"column":74}},"203":{"start":{"line":496,"column":0},"end":{"line":498,"column":1}},"204":{"start":{"line":497,"column":2},"end":{"line":497,"column":26}},"205":{"start":{"line":508,"column":0},"end":{"line":522,"column":2}},"206":{"start":{"line":509,"column":2},"end":{"line":509,"column":53}},"207":{"start":{"line":511,"column":2},"end":{"line":521,"column":3}},"208":{"start":{"line":512,"column":4},"end":{"line":515,"column":5}},"209":{"start":{"line":513,"column":6},"end":{"line":513,"column":37}},"210":{"start":{"line":514,"column":6},"end":{"line":514,"column":37}},"211":{"start":{"line":517,"column":4},"end":{"line":520,"column":5}},"212":{"start":{"line":518,"column":6},"end":{"line":518,"column":38}},"213":{"start":{"line":519,"column":6},"end":{"line":519,"column":37}},"214":{"start":{"line":524,"column":0},"end":{"line":538,"column":2}},"215":{"start":{"line":525,"column":2},"end":{"line":525,"column":62}},"216":{"start":{"line":527,"column":2},"end":{"line":537,"column":3}},"217":{"start":{"line":528,"column":4},"end":{"line":531,"column":5}},"218":{"start":{"line":529,"column":6},"end":{"line":529,"column":37}},"219":{"start":{"line":530,"column":6},"end":{"line":530,"column":37}},"220":{"start":{"line":533,"column":4},"end":{"line":536,"column":5}},"221":{"start":{"line":534,"column":6},"end":{"line":534,"column":38}},"222":{"start":{"line":535,"column":6},"end":{"line":535,"column":37}},"223":{"start":{"line":540,"column":0},"end":{"line":586,"column":2}},"224":{"start":{"line":541,"column":2},"end":{"line":544,"column":3}},"225":{"start":{"line":543,"column":4},"end":{"line":543,"column":58}},"226":{"start":{"line":546,"column":2},"end":{"line":546,"column":18}},"227":{"start":{"line":547,"column":2},"end":{"line":547,"column":30}},"228":{"start":{"line":548,"column":2},"end":{"line":555,"column":3}},"229":{"start":{"line":550,"column":4},"end":{"line":553,"column":7}},"230":{"start":{"line":554,"column":4},"end":{"line":554,"column":61}},"231":{"start":{"line":557,"column":2},"end":{"line":557,"column":46}},"232":{"start":{"line":558,"column":2},"end":{"line":558,"column":36}},"233":{"start":{"line":559,"column":2},"end":{"line":585,"column":5}},"234":{"start":{"line":560,"column":4},"end":{"line":567,"column":5}},"235":{"start":{"line":562,"column":6},"end":{"line":565,"column":9}},"236":{"start":{"line":566,"column":6},"end":{"line":566,"column":81}},"237":{"start":{"line":569,"column":4},"end":{"line":575,"column":5}},"238":{"start":{"line":570,"column":6},"end":{"line":573,"column":9}},"239":{"start":{"line":574,"column":6},"end":{"line":574,"column":67}},"240":{"start":{"line":577,"column":4},"end":{"line":577,"column":66}},"241":{"start":{"line":578,"column":4},"end":{"line":578,"column":62}},"242":{"start":{"line":579,"column":4},"end":{"line":582,"column":7}},"243":{"start":{"line":584,"column":4},"end":{"line":584,"column":9}},"244":{"start":{"line":588,"column":0},"end":{"line":613,"column":2}},"245":{"start":{"line":589,"column":2},"end":{"line":589,"column":18}},"246":{"start":{"line":590,"column":2},"end":{"line":590,"column":50}},"247":{"start":{"line":591,"column":2},"end":{"line":591,"column":36}},"248":{"start":{"line":592,"column":2},"end":{"line":612,"column":5}},"249":{"start":{"line":593,"column":4},"end":{"line":600,"column":5}},"250":{"start":{"line":594,"column":6},"end":{"line":597,"column":9}},"251":{"start":{"line":598,"column":6},"end":{"line":598,"column":42}},"252":{"start":{"line":599,"column":6},"end":{"line":599,"column":13}},"253":{"start":{"line":602,"column":4},"end":{"line":602,"column":88}},"254":{"start":{"line":604,"column":4},"end":{"line":607,"column":7}},"255":{"start":{"line":608,"column":4},"end":{"line":608,"column":29}},"256":{"start":{"line":609,"column":4},"end":{"line":609,"column":27}},"257":{"start":{"line":610,"column":4},"end":{"line":610,"column":36}},"258":{"start":{"line":611,"column":4},"end":{"line":611,"column":13}},"259":{"start":{"line":615,"column":0},"end":{"line":615,"column":38}},"260":{"start":{"line":617,"column":0},"end":{"line":617,"column":52}},"261":{"start":{"line":619,"column":0},"end":{"line":619,"column":52}},"262":{"start":{"line":621,"column":0},"end":{"line":621,"column":58}},"263":{"start":{"line":623,"column":0},"end":{"line":623,"column":29}}},"branchMap":{"1":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":53,"column":2}},{"start":{"line":53,"column":2},"end":{"line":53,"column":2}}]},"2":{"line":64,"type":"binary-expr","locations":[{"start":{"line":64,"column":7},"end":{"line":64,"column":9}},{"start":{"line":64,"column":13},"end":{"line":64,"column":26}}]},"3":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":2},"end":{"line":125,"column":2}},{"start":{"line":125,"column":2},"end":{"line":125,"column":2}}]},"4":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":2},"end":{"line":173,"column":2}},{"start":{"line":173,"column":2},"end":{"line":173,"column":2}}]},"5":{"line":177,"type":"binary-expr","locations":[{"start":{"line":177,"column":7},"end":{"line":177,"column":9}},{"start":{"line":177,"column":13},"end":{"line":177,"column":26}}]},"6":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":2},"end":{"line":182,"column":2}},{"start":{"line":182,"column":2},"end":{"line":182,"column":2}}]},"7":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":2},"end":{"line":192,"column":2}},{"start":{"line":192,"column":2},"end":{"line":192,"column":2}}]},"8":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":2},"end":{"line":213,"column":2}},{"start":{"line":213,"column":2},"end":{"line":213,"column":2}}]},"9":{"line":218,"type":"if","locations":[{"start":{"line":218,"column":2},"end":{"line":218,"column":2}},{"start":{"line":218,"column":2},"end":{"line":218,"column":2}}]},"10":{"line":226,"type":"if","locations":[{"start":{"line":226,"column":2},"end":{"line":226,"column":2}},{"start":{"line":226,"column":2},"end":{"line":226,"column":2}}]},"11":{"line":231,"type":"if","locations":[{"start":{"line":231,"column":6},"end":{"line":231,"column":6}},{"start":{"line":231,"column":6},"end":{"line":231,"column":6}}]},"12":{"line":250,"type":"if","locations":[{"start":{"line":250,"column":2},"end":{"line":250,"column":2}},{"start":{"line":250,"column":2},"end":{"line":250,"column":2}}]},"13":{"line":255,"type":"if","locations":[{"start":{"line":255,"column":2},"end":{"line":255,"column":2}},{"start":{"line":255,"column":2},"end":{"line":255,"column":2}}]},"14":{"line":275,"type":"if","locations":[{"start":{"line":275,"column":2},"end":{"line":275,"column":2}},{"start":{"line":275,"column":2},"end":{"line":275,"column":2}}]},"15":{"line":280,"type":"if","locations":[{"start":{"line":280,"column":2},"end":{"line":280,"column":2}},{"start":{"line":280,"column":2},"end":{"line":280,"column":2}}]},"16":{"line":285,"type":"if","locations":[{"start":{"line":285,"column":2},"end":{"line":285,"column":2}},{"start":{"line":285,"column":2},"end":{"line":285,"column":2}}]},"17":{"line":290,"type":"if","locations":[{"start":{"line":290,"column":6},"end":{"line":290,"column":6}},{"start":{"line":290,"column":6},"end":{"line":290,"column":6}}]},"18":{"line":308,"type":"if","locations":[{"start":{"line":308,"column":2},"end":{"line":308,"column":2}},{"start":{"line":308,"column":2},"end":{"line":308,"column":2}}]},"19":{"line":313,"type":"if","locations":[{"start":{"line":313,"column":2},"end":{"line":313,"column":2}},{"start":{"line":313,"column":2},"end":{"line":313,"column":2}}]},"20":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":6},"end":{"line":313,"column":13}},{"start":{"line":313,"column":17},"end":{"line":313,"column":36}}]},"21":{"line":331,"type":"if","locations":[{"start":{"line":331,"column":2},"end":{"line":331,"column":2}},{"start":{"line":331,"column":2},"end":{"line":331,"column":2}}]},"22":{"line":336,"type":"if","locations":[{"start":{"line":336,"column":2},"end":{"line":336,"column":2}},{"start":{"line":336,"column":2},"end":{"line":336,"column":2}}]},"23":{"line":336,"type":"binary-expr","locations":[{"start":{"line":336,"column":6},"end":{"line":336,"column":11}},{"start":{"line":336,"column":15},"end":{"line":336,"column":32}}]},"24":{"line":352,"type":"if","locations":[{"start":{"line":352,"column":2},"end":{"line":352,"column":2}},{"start":{"line":352,"column":2},"end":{"line":352,"column":2}}]},"25":{"line":368,"type":"if","locations":[{"start":{"line":368,"column":2},"end":{"line":368,"column":2}},{"start":{"line":368,"column":2},"end":{"line":368,"column":2}}]},"26":{"line":373,"type":"if","locations":[{"start":{"line":373,"column":2},"end":{"line":373,"column":2}},{"start":{"line":373,"column":2},"end":{"line":373,"column":2}}]},"27":{"line":381,"type":"if","locations":[{"start":{"line":381,"column":2},"end":{"line":381,"column":2}},{"start":{"line":381,"column":2},"end":{"line":381,"column":2}}]},"28":{"line":405,"type":"if","locations":[{"start":{"line":405,"column":2},"end":{"line":405,"column":2}},{"start":{"line":405,"column":2},"end":{"line":405,"column":2}}]},"29":{"line":408,"type":"if","locations":[{"start":{"line":408,"column":4},"end":{"line":408,"column":4}},{"start":{"line":408,"column":4},"end":{"line":408,"column":4}}]},"30":{"line":410,"type":"binary-expr","locations":[{"start":{"line":410,"column":39},"end":{"line":410,"column":58}},{"start":{"line":410,"column":62},"end":{"line":410,"column":64}}]},"31":{"line":413,"type":"binary-expr","locations":[{"start":{"line":413,"column":40},"end":{"line":413,"column":58}},{"start":{"line":413,"column":62},"end":{"line":413,"column":64}}]},"32":{"line":429,"type":"if","locations":[{"start":{"line":429,"column":2},"end":{"line":429,"column":2}},{"start":{"line":429,"column":2},"end":{"line":429,"column":2}}]},"33":{"line":434,"type":"if","locations":[{"start":{"line":434,"column":4},"end":{"line":434,"column":4}},{"start":{"line":434,"column":4},"end":{"line":434,"column":4}}]},"34":{"line":438,"type":"if","locations":[{"start":{"line":438,"column":4},"end":{"line":438,"column":4}},{"start":{"line":438,"column":4},"end":{"line":438,"column":4}}]},"35":{"line":441,"type":"if","locations":[{"start":{"line":441,"column":6},"end":{"line":441,"column":6}},{"start":{"line":441,"column":6},"end":{"line":441,"column":6}}]},"36":{"line":443,"type":"if","locations":[{"start":{"line":443,"column":10},"end":{"line":443,"column":10}},{"start":{"line":443,"column":10},"end":{"line":443,"column":10}}]},"37":{"line":448,"type":"if","locations":[{"start":{"line":448,"column":8},"end":{"line":448,"column":8}},{"start":{"line":448,"column":8},"end":{"line":448,"column":8}}]},"38":{"line":455,"type":"if","locations":[{"start":{"line":455,"column":6},"end":{"line":455,"column":6}},{"start":{"line":455,"column":6},"end":{"line":455,"column":6}}]},"39":{"line":457,"type":"if","locations":[{"start":{"line":457,"column":10},"end":{"line":457,"column":10}},{"start":{"line":457,"column":10},"end":{"line":457,"column":10}}]},"40":{"line":462,"type":"if","locations":[{"start":{"line":462,"column":8},"end":{"line":462,"column":8}},{"start":{"line":462,"column":8},"end":{"line":462,"column":8}}]},"41":{"line":511,"type":"if","locations":[{"start":{"line":511,"column":2},"end":{"line":511,"column":2}},{"start":{"line":511,"column":2},"end":{"line":511,"column":2}}]},"42":{"line":527,"type":"if","locations":[{"start":{"line":527,"column":2},"end":{"line":527,"column":2}},{"start":{"line":527,"column":2},"end":{"line":527,"column":2}}]},"43":{"line":541,"type":"if","locations":[{"start":{"line":541,"column":2},"end":{"line":541,"column":2}},{"start":{"line":541,"column":2},"end":{"line":541,"column":2}}]},"44":{"line":548,"type":"if","locations":[{"start":{"line":548,"column":2},"end":{"line":548,"column":2}},{"start":{"line":548,"column":2},"end":{"line":548,"column":2}}]},"45":{"line":560,"type":"if","locations":[{"start":{"line":560,"column":4},"end":{"line":560,"column":4}},{"start":{"line":560,"column":4},"end":{"line":560,"column":4}}]},"46":{"line":569,"type":"if","locations":[{"start":{"line":569,"column":4},"end":{"line":569,"column":4}},{"start":{"line":569,"column":4},"end":{"line":569,"column":4}}]},"47":{"line":593,"type":"if","locations":[{"start":{"line":593,"column":4},"end":{"line":593,"column":4}},{"start":{"line":593,"column":4},"end":{"line":593,"column":4}}]},"48":{"line":608,"type":"binary-expr","locations":[{"start":{"line":608,"column":15},"end":{"line":608,"column":23}},{"start":{"line":608,"column":27},"end":{"line":608,"column":29}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-admin', 'MasterAgent');","var MqttServer = require('../protocol/mqtt/mqttServer');","var EventEmitter = require('events').EventEmitter;","var MasterSocket = require('./masterSocket');","var protocol = require('../util/protocol');","var utils = require('../util/utils');","var Util = require('util');","","var ST_INITED = 1;","var ST_STARTED = 2;","var ST_CLOSED = 3;","","/**"," * MasterAgent Constructor"," *"," * @class MasterAgent"," * @constructor"," * @param {Object} opts construct parameter"," *                 opts.consoleService {Object} consoleService"," *                 opts.id             {String} server id"," *                 opts.type           {String} server type, 'master', 'connector', etc."," *                 opts.socket         {Object} socket-io object"," *                 opts.reqId          {Number} reqId add by 1"," *                 opts.callbacks      {Object} callbacks"," *                 opts.state          {Number} MasterAgent state"," * @api public"," */","var MasterAgent = function(consoleService, opts) {","  EventEmitter.call(this);","  this.reqId = 1;","  this.idMap = {};","  this.msgMap = {};","  this.typeMap = {};","  this.clients = {};","  this.sockets = {};","  this.slaveMap = {};","  this.server = null;","  this.callbacks = {};","  this.state = ST_INITED;","  this.whitelist = opts.whitelist;","  this.consoleService = consoleService;","};","","Util.inherits(MasterAgent, EventEmitter);","","/**"," * master listen to a port and handle register and request"," *"," * @param {String} port"," * @api public"," */","MasterAgent.prototype.listen = function(port, cb) {","  if (this.state > ST_INITED) {","    logger.error('master agent has started or closed.');","    return;","  }","","  this.state = ST_STARTED;","  this.server = new MqttServer();","  this.server.listen(port);","  // this.server = sio.listen(port);","  // this.server.set('log level', 0);","","  cb = cb || function() {}","","  var self = this;","  this.server.on('error', function(err) {","    self.emit('error', err);","    cb(err);","  });","","  this.server.once('listening', function() {","    setImmediate(function() {","      cb();","    });","  });","","  this.server.on('connection', function(socket) {","    // var id, type, info, registered, username;","    var masterSocket = new MasterSocket();","    masterSocket['agent'] = self;","    masterSocket['socket'] = socket;","","    self.sockets[socket.id] = socket;","","    socket.on('register', function(msg) {","      // register a new connection","      masterSocket.onRegister(msg);","    }); // end of on 'register'","","    // message from monitor","    socket.on('monitor', function(msg) {","      masterSocket.onMonitor(msg);","    }); // end of on 'monitor'","","    // message from client","    socket.on('client', function(msg) {","      masterSocket.onClient(msg);","    }); // end of on 'client'","","    socket.on('reconnect', function(msg) {","      masterSocket.onReconnect(msg);","    });","","    socket.on('disconnect', function() {","      masterSocket.onDisconnect();","    });","","    socket.on('close', function() {","      masterSocket.onDisconnect();","    });","","    socket.on('error', function(err) {","      masterSocket.onError(err);","    });","  }); // end of on 'connection'","}; // end of listen","","/**"," * close master agent"," *"," * @api public"," */","MasterAgent.prototype.close = function() {","  if (this.state > ST_STARTED) {","    return;","  }","  this.state = ST_CLOSED;","  this.server.close();","};","","/**"," * set module"," *"," * @param {String} moduleId module id/name"," * @param {Object} value module object"," * @api public"," */","MasterAgent.prototype.set = function(moduleId, value) {","  this.consoleService.set(moduleId, value);","};","","/**"," * get module"," *"," * @param {String} moduleId module id/name"," * @api public"," */","MasterAgent.prototype.get = function(moduleId) {","  return this.consoleService.get(moduleId);","};","","/**"," * getClientById"," *"," * @param {String} clientId"," * @api public"," */","MasterAgent.prototype.getClientById = function(clientId) {","  return this.clients[clientId];","};","","/**"," * request monitor{master node} data from monitor"," *"," * @param {String} serverId"," * @param {String} moduleId module id/name"," * @param {Object} msg"," * @param {Function} callback function"," * @api public"," */","MasterAgent.prototype.request = function(serverId, moduleId, msg, cb) {","  if (this.state > ST_STARTED) {","    return false;","  }","","  cb = cb || function() {}","","  var curId = this.reqId++;","  this.callbacks[curId] = cb;","","  if (!this.msgMap[serverId]) {","    this.msgMap[serverId] = {};","  }","","  this.msgMap[serverId][curId] = {","    moduleId: moduleId,","    msg: msg","  }","","  var record = this.idMap[serverId];","  if (!record) {","    cb(new Error('unknown server id:' + serverId));","    return false;","  }","","  sendToMonitor(record.socket, curId, moduleId, msg);","","  return true;","};","","/**"," * request server data from monitor by serverInfo{host:port}"," *"," * @param {String} serverId"," * @param {Object} serverInfo"," * @param {String} moduleId module id/name"," * @param {Object} msg"," * @param {Function} callback function"," * @api public"," */","MasterAgent.prototype.requestServer = function(serverId, serverInfo, moduleId, msg, cb) {","  if (this.state > ST_STARTED) {","    return false;","  }","","  var record = this.idMap[serverId];","  if (!record) {","    utils.invokeCallback(cb, new Error('unknown server id:' + serverId));","    return false;","  }","","  var curId = this.reqId++;","  this.callbacks[curId] = cb;","","  if (utils.compareServer(record, serverInfo)) {","    sendToMonitor(record.socket, curId, moduleId, msg);","  } else {","    var slaves = this.slaveMap[serverId];","    for (var i = 0, l = slaves.length; i < l; i++) {","      if (utils.compareServer(slaves[i], serverInfo)) {","        sendToMonitor(slaves[i].socket, curId, moduleId, msg);","        break;","      }","    }","  }","","  return true;","};","","/**"," * notify a monitor{master node} by id without callback"," *"," * @param {String} serverId"," * @param {String} moduleId module id/name"," * @param {Object} msg"," * @api public"," */","MasterAgent.prototype.notifyById = function(serverId, moduleId, msg) {","  if (this.state > ST_STARTED) {","    return false;","  }","","  var record = this.idMap[serverId];","  if (!record) {","    logger.error('fail to notifyById for unknown server id:' + serverId);","    return false;","  }","","  sendToMonitor(record.socket, null, moduleId, msg);","","  return true;","};","","/**"," * notify a monitor by server{host:port} without callback"," *"," * @param {String} serverId"," * @param {Object} serverInfo{host:port}"," * @param {String} moduleId module id/name"," * @param {Object} msg"," * @api public"," */","MasterAgent.prototype.notifyByServer = function(serverId, serverInfo, moduleId, msg) {","  if (this.state > ST_STARTED) {","    return false;","  }","","  var record = this.idMap[serverId];","  if (!record) {","    logger.error('fail to notifyByServer for unknown server id:' + serverId);","    return false;","  }","","  if (utils.compareServer(record, serverInfo)) {","    sendToMonitor(record.socket, null, moduleId, msg);","  } else {","    var slaves = this.slaveMap[serverId];","    for (var i = 0, l = slaves.length; i < l; i++) {","      if (utils.compareServer(slaves[i], serverInfo)) {","        sendToMonitor(slaves[i].socket, null, moduleId, msg);","        break;","      }","    }","  }","  return true;","};","","/**"," * notify slaves by id without callback"," *"," * @param {String} serverId"," * @param {String} moduleId module id/name"," * @param {Object} msg"," * @api public"," */","MasterAgent.prototype.notifySlavesById = function(serverId, moduleId, msg) {","  if (this.state > ST_STARTED) {","    return false;","  }","","  var slaves = this.slaveMap[serverId];","  if (!slaves || slaves.length === 0) {","    logger.error('fail to notifySlavesById for unknown server id:' + serverId);","    return false;","  }","","  broadcastMonitors(slaves, moduleId, msg);","  return true;","};","","/**"," * notify monitors by type without callback"," *"," * @param {String} type serverType"," * @param {String} moduleId module id/name"," * @param {Object} msg"," * @api public"," */","MasterAgent.prototype.notifyByType = function(type, moduleId, msg) {","  if (this.state > ST_STARTED) {","    return false;","  }","","  var list = this.typeMap[type];","  if (!list || list.length === 0) {","    logger.error('fail to notifyByType for unknown server type:' + type);","    return false;","  }","  broadcastMonitors(list, moduleId, msg);","  return true;","};","","/**"," * notify all the monitors without callback"," *"," * @param {String} moduleId module id/name"," * @param {Object} msg"," * @api public"," */","MasterAgent.prototype.notifyAll = function(moduleId, msg) {","  if (this.state > ST_STARTED) {","    return false;","  }","  broadcastMonitors(this.idMap, moduleId, msg);","  return true;","};","","/**"," * notify a client by id without callback"," *"," * @param {String} clientId"," * @param {String} moduleId module id/name"," * @param {Object} msg"," * @api public"," */","MasterAgent.prototype.notifyClient = function(clientId, moduleId, msg) {","  if (this.state > ST_STARTED) {","    return false;","  }","","  var record = this.clients[clientId];","  if (!record) {","    logger.error('fail to notifyClient for unknown client id:' + clientId);","    return false;","  }","  sendToClient(record.socket, null, moduleId, msg);","};","","MasterAgent.prototype.notifyCommand = function(command, moduleId, msg) {","  if (this.state > ST_STARTED) {","    return false;","  }","  broadcastCommand(this.idMap, command, moduleId, msg);","  return true;","};","","/**"," * add monitor,client to connection -- idMap"," *"," * @param {Object} agent agent object"," * @param {String} id"," * @param {String} type serverType"," * @param {Object} socket socket-io object"," * @api private"," */","var addConnection = function(agent, id, type, pid, info, socket) {","  var record = {","    id: id,","    type: type,","    pid: pid,","    info: info,","    socket: socket","  };","  if (type === 'client') {","    agent.clients[id] = record;","  } else {","    if (!agent.idMap[id]) {","      agent.idMap[id] = record;","      var list = agent.typeMap[type] = agent.typeMap[type] || [];","      list.push(record);","    } else {","      var slaves = agent.slaveMap[id] = agent.slaveMap[id] || [];","      slaves.push(record);","    }","  }","  return record;","};","","/**"," * remove monitor,client connection -- idMap"," *"," * @param {Object} agent agent object"," * @param {String} id"," * @param {String} type serverType"," * @api private"," */","var removeConnection = function(agent, id, type, info) {","  if (type === 'client') {","    delete agent.clients[id];","  } else {","    // remove master node in idMap and typeMap","    var record = agent.idMap[id];","    if (!record) {","      return;","    }","    var _info = record['info']; // info {host, port}","    if (utils.compareServer(_info, info)) {","      delete agent.idMap[id];","      var list = agent.typeMap[type];","      if (list) {","        for (var i = 0, l = list.length; i < l; i++) {","          if (list[i].id === id) {","            list.splice(i, 1);","            break;","          }","        }","        if (list.length === 0) {","          delete agent.typeMap[type];","        }","      }","    } else {","      // remove slave node in slaveMap","      var slaves = agent.slaveMap[id];","      if (slaves) {","        for (var i = 0, l = slaves.length; i < l; i++) {","          if (utils.compareServer(slaves[i]['info'], info)) {","            slaves.splice(i, 1);","            break;","          }","        }","        if (slaves.length === 0) {","          delete agent.slaveMap[id];","        }","      }","    }","  }","};","","/**"," * send msg to monitor"," *"," * @param {Object} socket socket-io object"," * @param {Number} reqId request id"," * @param {String} moduleId module id/name"," * @param {Object} msg message"," * @api private"," */","var sendToMonitor = function(socket, reqId, moduleId, msg) {","  doSend(socket, 'monitor', protocol.composeRequest(reqId, moduleId, msg));","};","","/**"," * send msg to client"," *"," * @param {Object} socket socket-io object"," * @param {Number} reqId request id"," * @param {String} moduleId module id/name"," * @param {Object} msg message"," * @api private"," */","var sendToClient = function(socket, reqId, moduleId, msg) {","  doSend(socket, 'client', protocol.composeRequest(reqId, moduleId, msg));","};","","var doSend = function(socket, topic, msg) {","  socket.send(topic, msg);","}","","/**"," * broadcast msg to monitor"," *"," * @param {Object} record registered modules"," * @param {String} moduleId module id/name"," * @param {Object} msg message"," * @api private"," */","var broadcastMonitors = function(records, moduleId, msg) {","  msg = protocol.composeRequest(null, moduleId, msg);","","  if (records instanceof Array) {","    for (var i = 0, l = records.length; i < l; i++) {","      var socket = records[i].socket;","      doSend(socket, 'monitor', msg);","    }","  } else {","    for (var id in records) {","      var socket = records[id].socket;","      doSend(socket, 'monitor', msg);","    }","  }","};","","var broadcastCommand = function(records, command, moduleId, msg) {","  msg = protocol.composeCommand(null, command, moduleId, msg);","","  if (records instanceof Array) {","    for (var i = 0, l = records.length; i < l; i++) {","      var socket = records[i].socket;","      doSend(socket, 'monitor', msg);","    }","  } else {","    for (var id in records) {","      var socket = records[id].socket;","      doSend(socket, 'monitor', msg);","    }","  }","};","","MasterAgent.prototype.doAuthUser = function(msg, socket, cb) {","  if (!msg.id) {","    // client should has a client id","    return cb(new Error('client should has a client id'));","  }","","  var self = this;","  var username = msg.username;","  if (!username) {","    // client should auth with username","    doSend(socket, 'register', {","      code: protocol.PRO_FAIL,","      msg: 'client should auth with username'","    });","    return cb(new Error('client should auth with username'));","  }","","  var authUser = self.consoleService.authUser;","  var env = self.consoleService.env;","  authUser(msg, env, function(user) {","    if (!user) {","      // client should auth with username","      doSend(socket, 'register', {","        code: protocol.PRO_FAIL,","        msg: 'client auth failed with username or password error'","      });","      return cb(new Error('client auth failed with username or password error'));","    }","","    if (self.clients[msg.id]) {","      doSend(socket, 'register', {","        code: protocol.PRO_FAIL,","        msg: 'id has been registered. id:' + msg.id","      });","      return cb(new Error('id has been registered. id:' + msg.id));","    }","","    logger.info('client user : ' + username + ' login to master');","    addConnection(self, msg.id, msg.type, null, user, socket);","    doSend(socket, 'register', {","      code: protocol.PRO_OK,","      msg: 'ok'","    });","","    cb();","  });","};","","MasterAgent.prototype.doAuthServer = function(msg, socket, cb) {","  var self = this;","  var authServer = self.consoleService.authServer;","  var env = self.consoleService.env;","  authServer(msg, env, function(status) {","    if (status !== 'ok') {","      doSend(socket, 'register', {","        code: protocol.PRO_FAIL,","        msg: 'server auth failed'","      });","      cb(new Error('server auth failed'));","      return;","    }","","    var record = addConnection(self, msg.id, msg.serverType, msg.pid, msg.info, socket);","","    doSend(socket, 'register', {","      code: protocol.PRO_OK,","      msg: 'ok'","    });","    msg.info = msg.info || {}","    msg.info.pid = msg.pid;","    self.emit('register', msg.info);","    cb(null);","  });","};","","MasterAgent.prototype.doSend = doSend;","","MasterAgent.prototype.sendToMonitor = sendToMonitor;","","MasterAgent.prototype.addConnection = addConnection;","","MasterAgent.prototype.removeConnection = removeConnection;","","module.exports = MasterAgent;"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"9":1,"10":1,"11":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"44":1,"52":1,"53":0,"54":0,"55":0,"58":0,"59":0,"60":0,"64":0,"66":0,"67":0,"68":0,"69":0,"72":0,"73":0,"74":0,"78":0,"80":0,"81":0,"82":0,"84":0,"86":0,"88":0,"92":0,"93":0,"97":0,"98":0,"101":0,"102":0,"105":0,"106":0,"109":0,"110":0,"113":0,"114":0,"124":1,"125":0,"126":0,"128":0,"129":0,"139":1,"140":0,"149":1,"150":0,"159":1,"160":0,"172":1,"173":0,"174":0,"177":0,"179":0,"180":0,"182":0,"183":0,"186":0,"191":0,"192":0,"193":0,"194":0,"197":0,"199":0,"212":1,"213":0,"214":0,"217":0,"218":0,"219":0,"220":0,"223":0,"224":0,"226":0,"227":0,"229":0,"230":0,"231":0,"232":0,"233":0,"238":0,"249":1,"250":0,"251":0,"254":0,"255":0,"256":0,"257":0,"260":0,"262":0,"274":1,"275":0,"276":0,"279":0,"280":0,"281":0,"282":0,"285":0,"286":0,"288":0,"289":0,"290":0,"291":0,"292":0,"296":0,"307":1,"308":0,"309":0,"312":0,"313":0,"314":0,"315":0,"318":0,"319":0,"330":1,"331":0,"332":0,"335":0,"336":0,"337":0,"338":0,"340":0,"341":0,"351":1,"352":0,"353":0,"355":0,"356":0,"367":1,"368":0,"369":0,"372":0,"373":0,"374":0,"375":0,"377":0,"380":1,"381":0,"382":0,"384":0,"385":0,"397":1,"398":0,"405":0,"406":0,"408":0,"409":0,"410":0,"411":0,"413":0,"414":0,"417":0,"428":1,"429":0,"430":0,"433":0,"434":0,"435":0,"437":0,"438":0,"439":0,"440":0,"441":0,"442":0,"443":0,"444":0,"445":0,"448":0,"449":0,"454":0,"455":0,"456":0,"457":0,"458":0,"459":0,"462":0,"463":0,"479":1,"480":0,"492":1,"493":0,"496":1,"497":0,"508":1,"509":0,"511":0,"512":0,"513":0,"514":0,"517":0,"518":0,"519":0,"524":1,"525":0,"527":0,"528":0,"529":0,"530":0,"533":0,"534":0,"535":0,"540":1,"541":0,"543":0,"546":0,"547":0,"548":0,"550":0,"554":0,"557":0,"558":0,"559":0,"560":0,"562":0,"566":0,"569":0,"570":0,"574":0,"577":0,"578":0,"579":0,"584":0,"588":1,"589":0,"590":0,"591":0,"592":0,"593":0,"594":0,"598":0,"599":0,"602":0,"604":0,"608":0,"609":0,"610":0,"611":0,"615":1,"617":1,"619":1,"621":1,"623":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/protocol/mqtt/mqttServer.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/protocol/mqtt/mqttServer.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":1,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":17},"end":{"line":9,"column":36}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":30},"end":{"line":17,"column":45}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":25},"end":{"line":35,"column":39}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":30},"end":{"line":40,"column":47}}},"5":{"name":"(anonymous_5)","line":44,"loc":{"start":{"line":44,"column":23},"end":{"line":44,"column":37}}},"6":{"name":"(anonymous_6)","line":50,"loc":{"start":{"line":50,"column":23},"end":{"line":50,"column":37}}},"7":{"name":"(anonymous_7)","line":59,"loc":{"start":{"line":59,"column":23},"end":{"line":59,"column":34}}},"8":{"name":"(anonymous_8)","line":63,"loc":{"start":{"line":63,"column":16},"end":{"line":63,"column":37}}},"9":{"name":"(anonymous_9)","line":74,"loc":{"start":{"line":74,"column":28},"end":{"line":74,"column":49}}},"10":{"name":"(anonymous_10)","line":81,"loc":{"start":{"line":81,"column":29},"end":{"line":81,"column":40}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":78}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":25}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":14}},"7":{"start":{"line":9,"column":0},"end":{"line":13,"column":2}},"8":{"start":{"line":10,"column":1},"end":{"line":10,"column":25}},"9":{"start":{"line":11,"column":1},"end":{"line":11,"column":21}},"10":{"start":{"line":12,"column":1},"end":{"line":12,"column":20}},"11":{"start":{"line":15,"column":0},"end":{"line":15,"column":40}},"12":{"start":{"line":17,"column":0},"end":{"line":72,"column":2}},"13":{"start":{"line":19,"column":1},"end":{"line":22,"column":2}},"14":{"start":{"line":20,"column":2},"end":{"line":20,"column":40}},"15":{"start":{"line":21,"column":2},"end":{"line":21,"column":9}},"16":{"start":{"line":24,"column":1},"end":{"line":24,"column":20}},"17":{"start":{"line":26,"column":1},"end":{"line":26,"column":17}},"18":{"start":{"line":28,"column":1},"end":{"line":28,"column":32}},"19":{"start":{"line":29,"column":1},"end":{"line":29,"column":26}},"20":{"start":{"line":31,"column":1},"end":{"line":31,"column":48}},"21":{"start":{"line":33,"column":1},"end":{"line":33,"column":64}},"22":{"start":{"line":35,"column":1},"end":{"line":38,"column":4}},"23":{"start":{"line":37,"column":2},"end":{"line":37,"column":26}},"24":{"start":{"line":40,"column":1},"end":{"line":71,"column":4}},"25":{"start":{"line":41,"column":2},"end":{"line":41,"column":31}},"26":{"start":{"line":42,"column":2},"end":{"line":42,"column":25}},"27":{"start":{"line":44,"column":2},"end":{"line":48,"column":5}},"28":{"start":{"line":45,"column":3},"end":{"line":47,"column":6}},"29":{"start":{"line":50,"column":2},"end":{"line":57,"column":5}},"30":{"start":{"line":51,"column":3},"end":{"line":51,"column":25}},"31":{"start":{"line":52,"column":3},"end":{"line":52,"column":36}},"32":{"start":{"line":53,"column":3},"end":{"line":53,"column":25}},"33":{"start":{"line":56,"column":3},"end":{"line":56,"column":27}},"34":{"start":{"line":59,"column":2},"end":{"line":61,"column":5}},"35":{"start":{"line":60,"column":3},"end":{"line":60,"column":21}},"36":{"start":{"line":63,"column":2},"end":{"line":68,"column":4}},"37":{"start":{"line":64,"column":3},"end":{"line":67,"column":6}},"38":{"start":{"line":70,"column":2},"end":{"line":70,"column":34}},"39":{"start":{"line":74,"column":0},"end":{"line":79,"column":1}},"40":{"start":{"line":75,"column":1},"end":{"line":78,"column":4}},"41":{"start":{"line":81,"column":0},"end":{"line":89,"column":2}},"42":{"start":{"line":82,"column":1},"end":{"line":84,"column":2}},"43":{"start":{"line":83,"column":2},"end":{"line":83,"column":9}},"44":{"start":{"line":86,"column":1},"end":{"line":86,"column":20}},"45":{"start":{"line":87,"column":1},"end":{"line":87,"column":21}},"46":{"start":{"line":88,"column":1},"end":{"line":88,"column":21}},"47":{"start":{"line":91,"column":0},"end":{"line":91,"column":28}}},"branchMap":{"1":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},{"start":{"line":19,"column":1},"end":{"line":19,"column":1}}]},"2":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},{"start":{"line":82,"column":1},"end":{"line":82,"column":1}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-admin', 'MqttServer');","var EventEmitter = require('events').EventEmitter;","var MqttCon = require('mqtt-connection');","var Util = require('util');","var net = require('net');","","var curId = 1;","","var MqttServer = function(opts, cb) {","\tEventEmitter.call(this);","\tthis.inited = false;","\tthis.closed = true;","};","","Util.inherits(MqttServer, EventEmitter);","","MqttServer.prototype.listen = function(port) {","\t//check status","\tif (this.inited) {","\t\tthis.cb(new Error('already inited.'));","\t\treturn;","\t}","","\tthis.inited = true;","","\tvar self = this;","","\tthis.server = new net.Server();","\tthis.server.listen(port);","","\tlogger.info('[MqttServer] listen on %d', port);","","\tthis.server.on('listening', this.emit.bind(this, 'listening'));","","\tthis.server.on('error', function(err) {","\t\t// logger.error('mqtt server is error: %j', err.stack);","\t\tself.emit('error', err);","\t});","","\tthis.server.on('connection', function(stream) {","\t\tvar socket = MqttCon(stream);","\t\tsocket['id'] = curId++;","","\t\tsocket.on('connect', function(pkg) {","\t\t\tsocket.connack({","\t\t\t\treturnCode: 0","\t\t\t});","\t\t});","","\t\tsocket.on('publish', function(pkg) {","\t\t\tvar topic = pkg.topic;","\t\t\tvar msg = pkg.payload.toString();","\t\t\tmsg = JSON.parse(msg);","","\t\t\t// logger.debug('[MqttServer] publish %s %j', topic, msg);","\t\t\tsocket.emit(topic, msg);","\t\t});","","\t\tsocket.on('pingreq', function() {","\t\t\tsocket.pingresp();","\t\t});","","\t\tsocket.send = function(topic, msg) {","\t\t\tsocket.publish({","\t\t\t\ttopic: topic,","\t\t\t\tpayload: JSON.stringify(msg)","\t\t\t});","\t\t};","","\t\tself.emit('connection', socket);","\t});","};","","MqttServer.prototype.send = function(topic, msg) {","\tthis.socket.publish({","\t\ttopic: topic,","\t\tpayload: msg","\t});","}","","MqttServer.prototype.close = function() {","\tif (this.closed) {","\t\treturn;","\t}","","\tthis.closed = true;","\tthis.server.close();","\tthis.emit('closed');","};","","module.exports = MqttServer;"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"9":1,"10":0,"11":0,"12":0,"15":1,"17":1,"19":0,"20":0,"21":0,"24":0,"26":0,"28":0,"29":0,"31":0,"33":0,"35":0,"37":0,"40":0,"41":0,"42":0,"44":0,"45":0,"50":0,"51":0,"52":0,"53":0,"56":0,"59":0,"60":0,"63":0,"64":0,"70":0,"74":1,"75":0,"81":1,"82":0,"83":0,"86":0,"87":0,"88":0,"91":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/master/masterSocket.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/master/masterSocket.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":1,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":1,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":1,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":1,"149":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":19},"end":{"line":5,"column":30}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":36},"end":{"line":15,"column":50}}},"3":{"name":"(anonymous_3)","line":30,"loc":{"start":{"line":30,"column":37},"end":{"line":30,"column":51}}},"4":{"name":"(anonymous_4)","line":50,"loc":{"start":{"line":50,"column":39},"end":{"line":50,"column":53}}},"5":{"name":"(anonymous_5)","line":70,"loc":{"start":{"line":70,"column":35},"end":{"line":70,"column":49}}},"6":{"name":"(anonymous_6)","line":105,"loc":{"start":{"line":105,"column":76},"end":{"line":105,"column":95}}},"7":{"name":"(anonymous_7)","line":118,"loc":{"start":{"line":118,"column":34},"end":{"line":118,"column":48}}},"8":{"name":"(anonymous_8)","line":142,"loc":{"start":{"line":142,"column":70},"end":{"line":142,"column":89}}},"9":{"name":"(anonymous_9)","line":156,"loc":{"start":{"line":156,"column":75},"end":{"line":156,"column":94}}},"10":{"name":"(anonymous_10)","line":170,"loc":{"start":{"line":170,"column":37},"end":{"line":170,"column":56}}},"11":{"name":"(anonymous_11)","line":211,"loc":{"start":{"line":211,"column":38},"end":{"line":211,"column":49}}},"12":{"name":"(anonymous_12)","line":242,"loc":{"start":{"line":242,"column":42},"end":{"line":242,"column":61}}},"13":{"name":"(anonymous_13)","line":262,"loc":{"start":{"line":262,"column":33},"end":{"line":262,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":80}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":43}},"4":{"start":{"line":5,"column":0},"end":{"line":13,"column":1}},"5":{"start":{"line":6,"column":1},"end":{"line":6,"column":16}},"6":{"start":{"line":7,"column":1},"end":{"line":7,"column":18}},"7":{"start":{"line":8,"column":1},"end":{"line":8,"column":18}},"8":{"start":{"line":9,"column":1},"end":{"line":9,"column":19}},"9":{"start":{"line":10,"column":1},"end":{"line":10,"column":20}},"10":{"start":{"line":11,"column":1},"end":{"line":11,"column":22}},"11":{"start":{"line":12,"column":1},"end":{"line":12,"column":25}},"12":{"start":{"line":15,"column":0},"end":{"line":68,"column":1}},"13":{"start":{"line":16,"column":1},"end":{"line":18,"column":2}},"14":{"start":{"line":17,"column":2},"end":{"line":17,"column":9}},"15":{"start":{"line":20,"column":1},"end":{"line":20,"column":17}},"16":{"start":{"line":21,"column":1},"end":{"line":21,"column":23}},"17":{"start":{"line":22,"column":1},"end":{"line":22,"column":27}},"18":{"start":{"line":23,"column":1},"end":{"line":23,"column":26}},"19":{"start":{"line":25,"column":1},"end":{"line":39,"column":2}},"20":{"start":{"line":27,"column":2},"end":{"line":27,"column":21}},"21":{"start":{"line":28,"column":2},"end":{"line":28,"column":25}},"22":{"start":{"line":29,"column":2},"end":{"line":29,"column":23}},"23":{"start":{"line":30,"column":2},"end":{"line":37,"column":5}},"24":{"start":{"line":31,"column":3},"end":{"line":33,"column":4}},"25":{"start":{"line":32,"column":4},"end":{"line":32,"column":31}},"26":{"start":{"line":35,"column":3},"end":{"line":35,"column":32}},"27":{"start":{"line":36,"column":3},"end":{"line":36,"column":26}},"28":{"start":{"line":38,"column":2},"end":{"line":38,"column":9}},"29":{"start":{"line":41,"column":1},"end":{"line":60,"column":2}},"30":{"start":{"line":42,"column":2},"end":{"line":44,"column":3}},"31":{"start":{"line":43,"column":3},"end":{"line":43,"column":10}},"32":{"start":{"line":47,"column":2},"end":{"line":47,"column":21}},"33":{"start":{"line":48,"column":2},"end":{"line":48,"column":29}},"34":{"start":{"line":49,"column":2},"end":{"line":49,"column":23}},"35":{"start":{"line":50,"column":2},"end":{"line":56,"column":5}},"36":{"start":{"line":51,"column":3},"end":{"line":53,"column":4}},"37":{"start":{"line":52,"column":4},"end":{"line":52,"column":31}},"38":{"start":{"line":55,"column":3},"end":{"line":55,"column":26}},"39":{"start":{"line":58,"column":2},"end":{"line":58,"column":34}},"40":{"start":{"line":59,"column":2},"end":{"line":59,"column":9}},"41":{"start":{"line":62,"column":1},"end":{"line":65,"column":4}},"42":{"start":{"line":67,"column":1},"end":{"line":67,"column":21}},"43":{"start":{"line":70,"column":0},"end":{"line":116,"column":1}},"44":{"start":{"line":71,"column":1},"end":{"line":71,"column":26}},"45":{"start":{"line":72,"column":1},"end":{"line":77,"column":2}},"46":{"start":{"line":75,"column":2},"end":{"line":75,"column":22}},"47":{"start":{"line":76,"column":2},"end":{"line":76,"column":9}},"48":{"start":{"line":79,"column":1},"end":{"line":79,"column":17}},"49":{"start":{"line":80,"column":1},"end":{"line":80,"column":22}},"50":{"start":{"line":81,"column":1},"end":{"line":84,"column":2}},"51":{"start":{"line":82,"column":2},"end":{"line":82,"column":84}},"52":{"start":{"line":83,"column":2},"end":{"line":83,"column":9}},"53":{"start":{"line":86,"column":1},"end":{"line":86,"column":27}},"54":{"start":{"line":87,"column":1},"end":{"line":87,"column":25}},"55":{"start":{"line":88,"column":1},"end":{"line":102,"column":2}},"56":{"start":{"line":90,"column":2},"end":{"line":90,"column":40}},"57":{"start":{"line":91,"column":2},"end":{"line":94,"column":3}},"58":{"start":{"line":92,"column":3},"end":{"line":92,"column":44}},"59":{"start":{"line":93,"column":3},"end":{"line":93,"column":10}},"60":{"start":{"line":96,"column":2},"end":{"line":96,"column":19}},"61":{"start":{"line":97,"column":2},"end":{"line":99,"column":3}},"62":{"start":{"line":98,"column":3},"end":{"line":98,"column":40}},"63":{"start":{"line":100,"column":2},"end":{"line":100,"column":38}},"64":{"start":{"line":101,"column":2},"end":{"line":101,"column":33}},"65":{"start":{"line":105,"column":1},"end":{"line":115,"column":4}},"66":{"start":{"line":106,"column":2},"end":{"line":114,"column":3}},"67":{"start":{"line":107,"column":3},"end":{"line":107,"column":54}},"68":{"start":{"line":108,"column":3},"end":{"line":110,"column":4}},"69":{"start":{"line":109,"column":4},"end":{"line":109,"column":47}},"70":{"start":{"line":113,"column":3},"end":{"line":113,"column":53}},"71":{"start":{"line":118,"column":0},"end":{"line":168,"column":1}},"72":{"start":{"line":119,"column":1},"end":{"line":119,"column":26}},"73":{"start":{"line":120,"column":1},"end":{"line":124,"column":2}},"74":{"start":{"line":123,"column":2},"end":{"line":123,"column":29}},"75":{"start":{"line":126,"column":1},"end":{"line":126,"column":22}},"76":{"start":{"line":127,"column":1},"end":{"line":130,"column":2}},"77":{"start":{"line":128,"column":2},"end":{"line":128,"column":81}},"78":{"start":{"line":129,"column":2},"end":{"line":129,"column":9}},"79":{"start":{"line":132,"column":1},"end":{"line":132,"column":27}},"80":{"start":{"line":134,"column":1},"end":{"line":134,"column":30}},"81":{"start":{"line":135,"column":1},"end":{"line":135,"column":32}},"82":{"start":{"line":136,"column":1},"end":{"line":136,"column":24}},"83":{"start":{"line":138,"column":1},"end":{"line":138,"column":17}},"84":{"start":{"line":140,"column":1},"end":{"line":167,"column":2}},"85":{"start":{"line":142,"column":2},"end":{"line":152,"column":5}},"86":{"start":{"line":143,"column":3},"end":{"line":151,"column":4}},"87":{"start":{"line":144,"column":4},"end":{"line":144,"column":55}},"88":{"start":{"line":145,"column":4},"end":{"line":147,"column":5}},"89":{"start":{"line":146,"column":5},"end":{"line":146,"column":47}},"90":{"start":{"line":150,"column":4},"end":{"line":150,"column":54}},"91":{"start":{"line":156,"column":2},"end":{"line":166,"column":5}},"92":{"start":{"line":157,"column":3},"end":{"line":165,"column":4}},"93":{"start":{"line":158,"column":4},"end":{"line":158,"column":55}},"94":{"start":{"line":159,"column":4},"end":{"line":161,"column":5}},"95":{"start":{"line":160,"column":5},"end":{"line":160,"column":47}},"96":{"start":{"line":164,"column":4},"end":{"line":164,"column":54}},"97":{"start":{"line":170,"column":0},"end":{"line":209,"column":1}},"98":{"start":{"line":172,"column":1},"end":{"line":174,"column":2}},"99":{"start":{"line":173,"column":2},"end":{"line":173,"column":9}},"100":{"start":{"line":176,"column":1},"end":{"line":176,"column":23}},"101":{"start":{"line":177,"column":1},"end":{"line":179,"column":2}},"102":{"start":{"line":178,"column":2},"end":{"line":178,"column":9}},"103":{"start":{"line":181,"column":1},"end":{"line":181,"column":26}},"104":{"start":{"line":184,"column":1},"end":{"line":191,"column":2}},"105":{"start":{"line":186,"column":2},"end":{"line":189,"column":5}},"106":{"start":{"line":190,"column":2},"end":{"line":190,"column":9}},"107":{"start":{"line":193,"column":1},"end":{"line":193,"column":36}},"108":{"start":{"line":194,"column":1},"end":{"line":194,"column":103}},"109":{"start":{"line":196,"column":1},"end":{"line":196,"column":20}},"110":{"start":{"line":197,"column":1},"end":{"line":197,"column":27}},"111":{"start":{"line":198,"column":1},"end":{"line":198,"column":24}},"112":{"start":{"line":199,"column":1},"end":{"line":199,"column":20}},"113":{"start":{"line":200,"column":1},"end":{"line":200,"column":22}},"114":{"start":{"line":201,"column":1},"end":{"line":204,"column":4}},"115":{"start":{"line":206,"column":1},"end":{"line":206,"column":40}},"116":{"start":{"line":208,"column":1},"end":{"line":208,"column":33}},"117":{"start":{"line":211,"column":0},"end":{"line":240,"column":1}},"118":{"start":{"line":212,"column":1},"end":{"line":212,"column":26}},"119":{"start":{"line":213,"column":1},"end":{"line":215,"column":2}},"120":{"start":{"line":214,"column":2},"end":{"line":214,"column":39}},"121":{"start":{"line":217,"column":1},"end":{"line":217,"column":34}},"122":{"start":{"line":218,"column":1},"end":{"line":220,"column":2}},"123":{"start":{"line":219,"column":2},"end":{"line":219,"column":9}},"124":{"start":{"line":222,"column":1},"end":{"line":222,"column":18}},"125":{"start":{"line":223,"column":1},"end":{"line":223,"column":22}},"126":{"start":{"line":224,"column":1},"end":{"line":224,"column":22}},"127":{"start":{"line":225,"column":1},"end":{"line":225,"column":30}},"128":{"start":{"line":227,"column":1},"end":{"line":227,"column":53}},"129":{"start":{"line":228,"column":1},"end":{"line":231,"column":2}},"130":{"start":{"line":229,"column":2},"end":{"line":229,"column":58}},"131":{"start":{"line":230,"column":2},"end":{"line":230,"column":48}},"132":{"start":{"line":233,"column":1},"end":{"line":235,"column":2}},"133":{"start":{"line":234,"column":2},"end":{"line":234,"column":51}},"134":{"start":{"line":237,"column":1},"end":{"line":237,"column":25}},"135":{"start":{"line":238,"column":1},"end":{"line":238,"column":16}},"136":{"start":{"line":239,"column":1},"end":{"line":239,"column":18}},"137":{"start":{"line":242,"column":0},"end":{"line":260,"column":1}},"138":{"start":{"line":243,"column":1},"end":{"line":243,"column":26}},"139":{"start":{"line":245,"column":1},"end":{"line":245,"column":43}},"140":{"start":{"line":247,"column":1},"end":{"line":249,"column":2}},"141":{"start":{"line":248,"column":2},"end":{"line":248,"column":9}},"142":{"start":{"line":251,"column":1},"end":{"line":251,"column":48}},"143":{"start":{"line":253,"column":1},"end":{"line":259,"column":2}},"144":{"start":{"line":254,"column":2},"end":{"line":254,"column":30}},"145":{"start":{"line":255,"column":2},"end":{"line":255,"column":36}},"146":{"start":{"line":256,"column":2},"end":{"line":256,"column":27}},"147":{"start":{"line":258,"column":2},"end":{"line":258,"column":58}},"148":{"start":{"line":262,"column":0},"end":{"line":265,"column":1}},"149":{"start":{"line":267,"column":0},"end":{"line":267,"column":30}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},{"start":{"line":16,"column":1},"end":{"line":16,"column":1}}]},"2":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":5},"end":{"line":16,"column":9}},{"start":{"line":16,"column":13},"end":{"line":16,"column":22}}]},"3":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},{"start":{"line":25,"column":1},"end":{"line":25,"column":1}}]},"4":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":3},"end":{"line":31,"column":3}},{"start":{"line":31,"column":3},"end":{"line":31,"column":3}}]},"5":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},{"start":{"line":41,"column":1},"end":{"line":41,"column":1}}]},"6":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":2},"end":{"line":42,"column":2}},{"start":{"line":42,"column":2},"end":{"line":42,"column":2}}]},"7":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":3},"end":{"line":51,"column":3}},{"start":{"line":51,"column":3},"end":{"line":51,"column":3}}]},"8":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},{"start":{"line":72,"column":1},"end":{"line":72,"column":1}}]},"9":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},{"start":{"line":81,"column":1},"end":{"line":81,"column":1}}]},"10":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},{"start":{"line":88,"column":1},"end":{"line":88,"column":1}}]},"11":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":2},"end":{"line":91,"column":2}},{"start":{"line":91,"column":2},"end":{"line":91,"column":2}}]},"12":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":2},"end":{"line":97,"column":2}},{"start":{"line":97,"column":2},"end":{"line":97,"column":2}}]},"13":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":2},"end":{"line":106,"column":2}},{"start":{"line":106,"column":2},"end":{"line":106,"column":2}}]},"14":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":3},"end":{"line":108,"column":3}},{"start":{"line":108,"column":3},"end":{"line":108,"column":3}}]},"15":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},{"start":{"line":120,"column":1},"end":{"line":120,"column":1}}]},"16":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},{"start":{"line":127,"column":1},"end":{"line":127,"column":1}}]},"17":{"line":140,"type":"if","locations":[{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},{"start":{"line":140,"column":1},"end":{"line":140,"column":1}}]},"18":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":3},"end":{"line":143,"column":3}},{"start":{"line":143,"column":3},"end":{"line":143,"column":3}}]},"19":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"20":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":3},"end":{"line":157,"column":3}},{"start":{"line":157,"column":3},"end":{"line":157,"column":3}}]},"21":{"line":159,"type":"if","locations":[{"start":{"line":159,"column":4},"end":{"line":159,"column":4}},{"start":{"line":159,"column":4},"end":{"line":159,"column":4}}]},"22":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},{"start":{"line":172,"column":1},"end":{"line":172,"column":1}}]},"23":{"line":172,"type":"binary-expr","locations":[{"start":{"line":172,"column":5},"end":{"line":172,"column":9}},{"start":{"line":172,"column":13},"end":{"line":172,"column":22}}]},"24":{"line":177,"type":"if","locations":[{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},{"start":{"line":177,"column":1},"end":{"line":177,"column":1}}]},"25":{"line":184,"type":"if","locations":[{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},{"start":{"line":184,"column":1},"end":{"line":184,"column":1}}]},"26":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},{"start":{"line":213,"column":1},"end":{"line":213,"column":1}}]},"27":{"line":218,"type":"if","locations":[{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},{"start":{"line":218,"column":1},"end":{"line":218,"column":1}}]},"28":{"line":228,"type":"if","locations":[{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},{"start":{"line":228,"column":1},"end":{"line":228,"column":1}}]},"29":{"line":233,"type":"if","locations":[{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},{"start":{"line":233,"column":1},"end":{"line":233,"column":1}}]},"30":{"line":233,"type":"binary-expr","locations":[{"start":{"line":233,"column":5},"end":{"line":233,"column":35}},{"start":{"line":233,"column":39},"end":{"line":233,"column":49}}]},"31":{"line":247,"type":"if","locations":[{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},{"start":{"line":247,"column":1},"end":{"line":247,"column":1}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-admin', 'MasterSocket');","var Constants = require('../util/constants');","var protocol = require('../util/protocol');","","var MasterSocket = function() {","\tthis.id = null;","\tthis.type = null;","\tthis.info = null;","\tthis.agent = null;","\tthis.socket = null;","\tthis.username = null;","\tthis.registered = false;","}","","MasterSocket.prototype.onRegister = function(msg) {","\tif (!msg || !msg.type) {","\t\treturn;","\t}","","\tvar self = this;","\tvar serverId = msg.id;","\tvar serverType = msg.type;","\tvar socket = this.socket;","","\tif (serverType == Constants.TYPE_CLIENT) {","\t\t// client connection not join the map","\t\tthis.id = serverId;","\t\tthis.type = serverType;","\t\tthis.info = 'client';","\t\tthis.agent.doAuthUser(msg, socket, function(err) {","\t\t\tif (err) {","\t\t\t\treturn socket.disconnect();","\t\t\t}","","\t\t\tself.username = msg.username;","\t\t\tself.registered = true;","\t\t});","\t\treturn;","\t} // end of if(serverType === 'client')","","\tif (serverType == Constants.TYPE_MONITOR) {","\t\tif (!serverId) {","\t\t\treturn;","\t\t}","","\t\t// if is a normal server","\t\tthis.id = serverId;","\t\tthis.type = msg.serverType;","\t\tthis.info = msg.info;","\t\tthis.agent.doAuthServer(msg, socket, function(err) {","\t\t\tif (err) {","\t\t\t\treturn socket.disconnect();","\t\t\t}","","\t\t\tself.registered = true;","\t\t});","","\t\tthis.repushQosMessage(serverId);","\t\treturn;","\t} // end of if(serverType === 'monitor') ","","\tthis.agent.doSend(socket, 'register', {","\t\tcode: protocol.PRO_FAIL,","\t\tmsg: 'unknown auth master type'","\t});","","\tsocket.disconnect();","}","","MasterSocket.prototype.onMonitor = function(msg) {","\tvar socket = this.socket;","\tif (!this.registered) {","\t\t// not register yet, ignore any message","\t\t// kick connections","\t\tsocket.disconnect();","\t\treturn;","\t}","","\tvar self = this;","\tvar type = this.type;","\tif (type === Constants.TYPE_CLIENT) {","\t\tlogger.error('invalid message from monitor, but current connect type is client.');","\t\treturn;","\t}","","\tmsg = protocol.parse(msg);","\tvar respId = msg.respId;","\tif (respId) {","\t\t// a response from monitor","\t\tvar cb = self.agent.callbacks[respId];","\t\tif (!cb) {","\t\t\tlogger.warn('unknown resp id:' + respId);","\t\t\treturn;","\t\t}","","\t\tvar id = this.id;","\t\tif (self.agent.msgMap[id]) {","\t\t\tdelete self.agent.msgMap[id][respId];","\t\t}","\t\tdelete self.agent.callbacks[respId];","\t\treturn cb(msg.error, msg.body);","\t}","","\t// a request or a notify from monitor","\tself.agent.consoleService.execute(msg.moduleId, 'masterHandler', msg.body, function(err, res) {","\t\tif (protocol.isRequest(msg)) {","\t\t\tvar resp = protocol.composeResponse(msg, err, res);","\t\t\tif (resp) {","\t\t\t\tself.agent.doSend(socket, 'monitor', resp);","\t\t\t}","\t\t} else {","\t\t\t//notify should not have a callback","\t\t\tlogger.warn('notify should not have a callback.');","\t\t}","\t});","}","","MasterSocket.prototype.onClient = function(msg) {","\tvar socket = this.socket;","\tif (!this.registered) {","\t\t// not register yet, ignore any message","\t\t// kick connections","\t\treturn socket.disconnect();","\t}","","\tvar type = this.type;","\tif (type !== Constants.TYPE_CLIENT) {","\t\tlogger.error('invalid message to client, but current connect type is ' + type);","\t\treturn;","\t}","","\tmsg = protocol.parse(msg);","","\tvar msgCommand = msg.command;","\tvar msgModuleId = msg.moduleId;","\tvar msgBody = msg.body;","","\tvar self = this;","","\tif (msgCommand) {","\t\t// a command from client","\t\tself.agent.consoleService.command(msgCommand, msgModuleId, msgBody, function(err, res) {","\t\t\tif (protocol.isRequest(msg)) {","\t\t\t\tvar resp = protocol.composeResponse(msg, err, res);","\t\t\t\tif (resp) {","\t\t\t\t\tself.agent.doSend(socket, 'client', resp);","\t\t\t\t}","\t\t\t} else {","\t\t\t\t//notify should not have a callback","\t\t\t\tlogger.warn('notify should not have a callback.');","\t\t\t}","\t\t});","\t} else {","\t\t// a request or a notify from client","\t\t// and client should not have any response to master for master would not request anything from client","\t\tself.agent.consoleService.execute(msgModuleId, 'clientHandler', msgBody, function(err, res) {","\t\t\tif (protocol.isRequest(msg)) {","\t\t\t\tvar resp = protocol.composeResponse(msg, err, res);","\t\t\t\tif (resp) {","\t\t\t\t\tself.agent.doSend(socket, 'client', resp);","\t\t\t\t}","\t\t\t} else {","\t\t\t\t//notify should not have a callback","\t\t\t\tlogger.warn('notify should not have a callback.');","\t\t\t}","\t\t});","\t}","}","","MasterSocket.prototype.onReconnect = function(msg, pid) {","\t// reconnect a new connection","\tif (!msg || !msg.type) {","\t\treturn;","\t}","","\tvar serverId = msg.id;","\tif (!serverId) {","\t\treturn;","\t}","","\tvar socket = this.socket;","","\t// if is a normal server","\tif (this.agent.idMap[serverId]) {","\t\t// id has been registered","\t\tthis.agent.doSend(socket, 'reconnect_ok', {","\t\t\tcode: protocol.PRO_FAIL,","\t\t\tmsg: 'id has been registered. id:' + serverId","\t\t});","\t\treturn;","\t}","","\tvar msgServerType = msg.serverType;","\tvar record = this.agent.addConnection(this.agent, serverId, msgServerType, msg.pid, msg.info, socket);","","\tthis.id = serverId;","\tthis.type = msgServerType;","\tthis.registered = true;","\tmsg.info.pid = pid;","\tthis.info = msg.info;","\tthis.agent.doSend(socket, 'reconnect_ok', {","\t\tcode: protocol.PRO_OK,","\t\tmsg: 'ok'","\t});","","\tthis.agent.emit('reconnect', msg.info);","","\tthis.repushQosMessage(serverId);","}","","MasterSocket.prototype.onDisconnect = function() {","\tvar socket = this.socket;","\tif (socket) {","\t\tdelete this.agent.sockets[socket.id];","\t}","","\tvar registered = this.registered;","\tif (!registered) {","\t\treturn;","\t}","","\tvar id = this.id;","\tvar type = this.type;","\tvar info = this.info;","\tvar username = this.username;","","\tlogger.debug('disconnect %s %s %j', id, type, info);","\tif (registered) {","\t\tthis.agent.removeConnection(this.agent, id, type, info);","\t\tthis.agent.emit('disconnect', id, type, info);","\t}","","\tif (type === Constants.TYPE_CLIENT && registered) {","\t\tlogger.info('client user ' + username + ' exit');","\t}","","\tthis.registered = false;","\tthis.id = null;","\tthis.type = null;","}","","MasterSocket.prototype.repushQosMessage = function(serverId) {","\tvar socket = this.socket;","\t// repush qos message","\tvar qosMsgs = this.agent.msgMap[serverId];","","\tif (!qosMsgs) {","\t\treturn;","\t}","","\tlogger.debug('repush qos message %j', qosMsgs);","","\tfor (var reqId in qosMsgs) {","\t\tvar qosMsg = qosMsgs[reqId];","\t\tvar moduleId = qosMsg['moduleId'];","\t\tvar tmsg = qosMsg['msg'];","","\t\tthis.agent.sendToMonitor(socket, reqId, moduleId, tmsg);","\t}","}","","MasterSocket.prototype.onError = function(err) {","\t// logger.error('server %s error %s', this.id, err.stack);","\t// this.onDisconnect();","}","","module.exports = MasterSocket;"],"l":{"1":1,"2":1,"3":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"15":1,"16":0,"17":0,"20":0,"21":0,"22":0,"23":0,"25":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"35":0,"36":0,"38":0,"41":0,"42":0,"43":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"55":0,"58":0,"59":0,"62":0,"67":0,"70":1,"71":0,"72":0,"75":0,"76":0,"79":0,"80":0,"81":0,"82":0,"83":0,"86":0,"87":0,"88":0,"90":0,"91":0,"92":0,"93":0,"96":0,"97":0,"98":0,"100":0,"101":0,"105":0,"106":0,"107":0,"108":0,"109":0,"113":0,"118":1,"119":0,"120":0,"123":0,"126":0,"127":0,"128":0,"129":0,"132":0,"134":0,"135":0,"136":0,"138":0,"140":0,"142":0,"143":0,"144":0,"145":0,"146":0,"150":0,"156":0,"157":0,"158":0,"159":0,"160":0,"164":0,"170":1,"172":0,"173":0,"176":0,"177":0,"178":0,"181":0,"184":0,"186":0,"190":0,"193":0,"194":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"206":0,"208":0,"211":1,"212":0,"213":0,"214":0,"217":0,"218":0,"219":0,"222":0,"223":0,"224":0,"225":0,"227":0,"228":0,"229":0,"230":0,"233":0,"234":0,"237":0,"238":0,"239":0,"242":1,"243":0,"245":0,"247":0,"248":0,"251":0,"253":0,"254":0,"255":0,"256":0,"258":0,"262":1,"267":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/schedule.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/schedule.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":1,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":1,"65":0,"66":1,"67":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"scheduleJob","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":47}}},"2":{"name":"cancelJob","line":49,"loc":{"start":{"line":49,"column":0},"end":{"line":49,"column":22}}},"3":{"name":"setTimer","line":68,"loc":{"start":{"line":68,"column":0},"end":{"line":68,"column":22}}},"4":{"name":"excuteJob","line":77,"loc":{"start":{"line":77,"column":0},"end":{"line":77,"column":20}}},"5":{"name":"peekNextJob","line":107,"loc":{"start":{"line":107,"column":0},"end":{"line":107,"column":22}}},"6":{"name":"getNextJob","line":125,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":21}}},"7":{"name":"comparator","line":136,"loc":{"start":{"line":136,"column":0},"end":{"line":136,"column":27}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":47}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":30}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":19}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":53}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":13}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":58}},"7":{"start":{"line":13,"column":0},"end":{"line":13,"column":14}},"8":{"start":{"line":14,"column":0},"end":{"line":14,"column":10}},"9":{"start":{"line":18,"column":0},"end":{"line":18,"column":18}},"10":{"start":{"line":23,"column":0},"end":{"line":44,"column":1}},"11":{"start":{"line":24,"column":2},"end":{"line":24,"column":53}},"12":{"start":{"line":25,"column":2},"end":{"line":25,"column":36}},"13":{"start":{"line":26,"column":2},"end":{"line":26,"column":18}},"14":{"start":{"line":28,"column":2},"end":{"line":28,"column":16}},"15":{"start":{"line":29,"column":2},"end":{"line":32,"column":4}},"16":{"start":{"line":34,"column":2},"end":{"line":34,"column":28}},"17":{"start":{"line":35,"column":2},"end":{"line":40,"column":3}},"18":{"start":{"line":36,"column":4},"end":{"line":36,"column":25}},"19":{"start":{"line":37,"column":4},"end":{"line":37,"column":18}},"20":{"start":{"line":39,"column":4},"end":{"line":39,"column":18}},"21":{"start":{"line":42,"column":2},"end":{"line":42,"column":23}},"22":{"start":{"line":43,"column":2},"end":{"line":43,"column":16}},"23":{"start":{"line":49,"column":0},"end":{"line":60,"column":1}},"24":{"start":{"line":50,"column":2},"end":{"line":50,"column":28}},"25":{"start":{"line":51,"column":2},"end":{"line":57,"column":3}},"26":{"start":{"line":52,"column":4},"end":{"line":52,"column":16}},"27":{"start":{"line":53,"column":4},"end":{"line":53,"column":19}},"28":{"start":{"line":55,"column":4},"end":{"line":55,"column":24}},"29":{"start":{"line":56,"column":4},"end":{"line":56,"column":16}},"30":{"start":{"line":58,"column":2},"end":{"line":58,"column":17}},"31":{"start":{"line":59,"column":2},"end":{"line":59,"column":14}},"32":{"start":{"line":68,"column":0},"end":{"line":72,"column":1}},"33":{"start":{"line":69,"column":2},"end":{"line":69,"column":22}},"34":{"start":{"line":71,"column":2},"end":{"line":71,"column":61}},"35":{"start":{"line":77,"column":0},"end":{"line":101,"column":1}},"36":{"start":{"line":78,"column":2},"end":{"line":78,"column":26}},"37":{"start":{"line":79,"column":2},"end":{"line":79,"column":14}},"38":{"start":{"line":81,"column":2},"end":{"line":93,"column":3}},"39":{"start":{"line":82,"column":4},"end":{"line":82,"column":14}},"40":{"start":{"line":83,"column":4},"end":{"line":83,"column":16}},"41":{"start":{"line":85,"column":4},"end":{"line":85,"column":34}},"42":{"start":{"line":87,"column":4},"end":{"line":91,"column":5}},"43":{"start":{"line":88,"column":6},"end":{"line":88,"column":25}},"44":{"start":{"line":90,"column":6},"end":{"line":90,"column":47}},"45":{"start":{"line":92,"column":4},"end":{"line":92,"column":24}},"46":{"start":{"line":96,"column":2},"end":{"line":97,"column":11}},"47":{"start":{"line":97,"column":4},"end":{"line":97,"column":11}},"48":{"start":{"line":100,"column":2},"end":{"line":100,"column":16}},"49":{"start":{"line":107,"column":0},"end":{"line":119,"column":1}},"50":{"start":{"line":108,"column":2},"end":{"line":109,"column":16}},"51":{"start":{"line":109,"column":4},"end":{"line":109,"column":16}},"52":{"start":{"line":111,"column":2},"end":{"line":111,"column":17}},"53":{"start":{"line":113,"column":2},"end":{"line":116,"column":35}},"54":{"start":{"line":114,"column":4},"end":{"line":114,"column":31}},"55":{"start":{"line":115,"column":4},"end":{"line":115,"column":25}},"56":{"start":{"line":115,"column":13},"end":{"line":115,"column":25}},"57":{"start":{"line":118,"column":2},"end":{"line":118,"column":26}},"58":{"start":{"line":125,"column":0},"end":{"line":134,"column":1}},"59":{"start":{"line":126,"column":2},"end":{"line":126,"column":17}},"60":{"start":{"line":128,"column":2},"end":{"line":131,"column":3}},"61":{"start":{"line":129,"column":4},"end":{"line":129,"column":28}},"62":{"start":{"line":130,"column":4},"end":{"line":130,"column":18}},"63":{"start":{"line":133,"column":2},"end":{"line":133,"column":26}},"64":{"start":{"line":136,"column":0},"end":{"line":138,"column":1}},"65":{"start":{"line":137,"column":2},"end":{"line":137,"column":27}},"66":{"start":{"line":140,"column":0},"end":{"line":140,"column":41}},"67":{"start":{"line":141,"column":0},"end":{"line":141,"column":37}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":35,"column":2}},{"start":{"line":35,"column":2},"end":{"line":35,"column":2}}]},"2":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":5},"end":{"line":35,"column":12}},{"start":{"line":35,"column":16},"end":{"line":35,"column":40}}]},"3":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":2},"end":{"line":51,"column":2}},{"start":{"line":51,"column":2},"end":{"line":51,"column":2}}]},"4":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":5},"end":{"line":51,"column":11}},{"start":{"line":51,"column":15},"end":{"line":51,"column":31}}]},"5":{"line":81,"type":"binary-expr","locations":[{"start":{"line":81,"column":8},"end":{"line":81,"column":13}},{"start":{"line":81,"column":17},"end":{"line":81,"column":55}}]},"6":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":4},"end":{"line":87,"column":4}},{"start":{"line":87,"column":4},"end":{"line":87,"column":4}}]},"7":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":2},"end":{"line":96,"column":2}},{"start":{"line":96,"column":2},"end":{"line":96,"column":2}}]},"8":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":108,"column":2}},{"start":{"line":108,"column":2},"end":{"line":108,"column":2}}]},"9":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":4},"end":{"line":115,"column":4}},{"start":{"line":115,"column":4},"end":{"line":115,"column":4}}]},"10":{"line":116,"type":"binary-expr","locations":[{"start":{"line":116,"column":9},"end":{"line":116,"column":13}},{"start":{"line":116,"column":17},"end":{"line":116,"column":33}}]},"11":{"line":118,"type":"cond-expr","locations":[{"start":{"line":118,"column":17},"end":{"line":118,"column":20}},{"start":{"line":118,"column":21},"end":{"line":118,"column":25}}]},"12":{"line":128,"type":"binary-expr","locations":[{"start":{"line":128,"column":8},"end":{"line":128,"column":12}},{"start":{"line":128,"column":16},"end":{"line":128,"column":32}}]},"13":{"line":133,"type":"cond-expr","locations":[{"start":{"line":133,"column":17},"end":{"line":133,"column":20}},{"start":{"line":133,"column":21},"end":{"line":133,"column":25}}]}},"code":["/**"," * The main class and interface of the schedule module"," */","var PriorityQueue = require('./priorityQueue');","var Job = require('./job.js');","var timerCount = 0;","","var logger = require('log4js').getLogger(__filename);","","var map = {};","var queue = PriorityQueue.createPriorityQueue(comparator);","","var jobId = 0;","var timer;","","//The accuracy of the scheduler, it will affect the performance when the schedule tasks are","//crowded together","var accuracy = 10;","","/**"," * Schedule a new Job"," */","function scheduleJob(trigger, jobFunc, jobData){","  var job = Job.createJob(trigger, jobFunc, jobData);","  var excuteTime = job.excuteTime();","  var id = job.id;","","  map[id] = job;","  var element = {","    id : id,","    time : excuteTime","  };","","  var curJob = queue.peek();","  if(!curJob || excuteTime < curJob.time){","    queue.offer(element);","    setTimer(job);","","    return job.id;","  }","","  queue.offer(element);","  return job.id;","}","","/**"," * Cancel Job"," */","function cancelJob(id){","  var curJob = queue.peek();","  if(curJob && id === curJob.id){ // to avoid queue.peek() is null","    queue.pop();","    delete map[id];","","    clearTimeout(timer);","    excuteJob();","  }","  delete map[id];","  return true;","}","","/**"," * Clear last timeout and schedule the next job, it will automaticly run the job that"," * need to run now"," * @param job The job need to schedule"," * @return void"," */","function setTimer(job){","  clearTimeout(timer);","","  timer = setTimeout(excuteJob, job.excuteTime()-Date.now());","}","","/**"," * The function used to ran the schedule job, and setTimeout for next running job"," */","function excuteJob(){","  var job = peekNextJob();","  var nextJob;","","  while(!!job && (job.excuteTime()-Date.now())<accuracy){","    job.run();","    queue.pop();","","    var nextTime = job.nextTime();","","    if(nextTime === null){","      delete map[job.id];","    }else{","      queue.offer({id:job.id, time: nextTime});","    }","    job = peekNextJob();","  }","","  //If all the job have been canceled","  if(!job)","    return;","","  //Run next schedule","  setTimer(job);","}","","/**"," * Return, but not remove the next valid job"," * @return Next valid job"," */","function peekNextJob(){","  if(queue.size() <= 0)","    return null;","","  var job = null;","","  do{","    job = map[queue.peek().id];","    if(!job) queue.pop();","  }while(!job && queue.size() > 0);","","  return (!!job)?job:null;","}","","/**"," * Return and remove the next valid job"," * @return Next valid job"," */","function getNextJob(){","  var job = null;","","  while(!job && queue.size() > 0){","    var id = queue.pop().id;","    job = map[id];","  }","","  return (!!job)?job:null;","}","","function comparator(e1, e2){","  return e1.time > e2.time;","}","","module.exports.scheduleJob = scheduleJob;","module.exports.cancelJob = cancelJob;",""],"l":{"4":1,"5":1,"6":1,"8":1,"10":1,"11":1,"13":1,"14":1,"18":1,"23":1,"24":0,"25":0,"26":0,"28":0,"29":0,"34":0,"35":0,"36":0,"37":0,"39":0,"42":0,"43":0,"49":1,"50":0,"51":0,"52":0,"53":0,"55":0,"56":0,"58":0,"59":0,"68":1,"69":0,"71":0,"77":1,"78":0,"79":0,"81":0,"82":0,"83":0,"85":0,"87":0,"88":0,"90":0,"92":0,"96":0,"97":0,"100":0,"107":1,"108":0,"109":0,"111":0,"113":0,"114":0,"115":0,"118":0,"125":1,"126":0,"128":0,"129":0,"130":0,"133":0,"136":1,"137":0,"140":1,"141":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/priorityQueue.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/priorityQueue.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1,"48":0,"49":0,"50":0,"51":1,"52":0,"53":1,"54":1},"b":{"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0],"7":[0,0],"8":[0,0]},"f":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"fnMap":{"1":{"name":"(anonymous_1)","line":4,"loc":{"start":{"line":4,"column":20},"end":{"line":4,"column":40}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":11},"end":{"line":10,"column":31}}},"3":{"name":"(anonymous_3)","line":21,"loc":{"start":{"line":21,"column":11},"end":{"line":21,"column":21}}},"4":{"name":"(anonymous_4)","line":29,"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":29}}},"5":{"name":"(anonymous_5)","line":54,"loc":{"start":{"line":54,"column":10},"end":{"line":54,"column":20}}},"6":{"name":"(anonymous_6)","line":98,"loc":{"start":{"line":98,"column":11},"end":{"line":98,"column":21}}},"7":{"name":"(anonymous_7)","line":104,"loc":{"start":{"line":104,"column":25},"end":{"line":104,"column":40}}},"8":{"name":"(anonymous_8)","line":108,"loc":{"start":{"line":108,"column":37},"end":{"line":108,"column":57}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":6,"column":1}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":24}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":34}},"4":{"start":{"line":10,"column":0},"end":{"line":15,"column":1}},"5":{"start":{"line":11,"column":2},"end":{"line":11,"column":87}},"6":{"start":{"line":13,"column":2},"end":{"line":13,"column":19}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":20}},"8":{"start":{"line":21,"column":0},"end":{"line":23,"column":2}},"9":{"start":{"line":22,"column":2},"end":{"line":22,"column":23}},"10":{"start":{"line":29,"column":0},"end":{"line":48,"column":2}},"11":{"start":{"line":30,"column":2},"end":{"line":30,"column":26}},"12":{"start":{"line":31,"column":2},"end":{"line":31,"column":33}},"13":{"start":{"line":33,"column":2},"end":{"line":33,"column":35}},"14":{"start":{"line":35,"column":2},"end":{"line":35,"column":28}},"15":{"start":{"line":37,"column":2},"end":{"line":47,"column":3}},"16":{"start":{"line":38,"column":4},"end":{"line":38,"column":51}},"17":{"start":{"line":39,"column":4},"end":{"line":46,"column":5}},"18":{"start":{"line":40,"column":6},"end":{"line":40,"column":36}},"19":{"start":{"line":41,"column":6},"end":{"line":41,"column":33}},"20":{"start":{"line":43,"column":6},"end":{"line":43,"column":22}},"21":{"start":{"line":45,"column":6},"end":{"line":45,"column":12}},"22":{"start":{"line":54,"column":0},"end":{"line":92,"column":2}},"23":{"start":{"line":55,"column":2},"end":{"line":55,"column":26}},"24":{"start":{"line":56,"column":2},"end":{"line":56,"column":33}},"25":{"start":{"line":58,"column":2},"end":{"line":59,"column":16}},"26":{"start":{"line":59,"column":4},"end":{"line":59,"column":16}},"27":{"start":{"line":62,"column":2},"end":{"line":62,"column":26}},"28":{"start":{"line":64,"column":2},"end":{"line":64,"column":38}},"29":{"start":{"line":66,"column":2},"end":{"line":66,"column":14}},"30":{"start":{"line":67,"column":2},"end":{"line":67,"column":23}},"31":{"start":{"line":68,"column":2},"end":{"line":68,"column":23}},"32":{"start":{"line":69,"column":2},"end":{"line":69,"column":20}},"33":{"start":{"line":70,"column":2},"end":{"line":70,"column":18}},"34":{"start":{"line":72,"column":2},"end":{"line":89,"column":3}},"35":{"start":{"line":73,"column":4},"end":{"line":85,"column":5}},"36":{"start":{"line":74,"column":6},"end":{"line":74,"column":32}},"37":{"start":{"line":75,"column":6},"end":{"line":75,"column":26}},"38":{"start":{"line":77,"column":6},"end":{"line":77,"column":18}},"39":{"start":{"line":78,"column":10},"end":{"line":85,"column":5}},"40":{"start":{"line":79,"column":6},"end":{"line":79,"column":31}},"41":{"start":{"line":80,"column":6},"end":{"line":80,"column":25}},"42":{"start":{"line":82,"column":6},"end":{"line":82,"column":17}},"43":{"start":{"line":84,"column":6},"end":{"line":84,"column":12}},"44":{"start":{"line":87,"column":4},"end":{"line":87,"column":21}},"45":{"start":{"line":88,"column":4},"end":{"line":88,"column":21}},"46":{"start":{"line":91,"column":2},"end":{"line":91,"column":18}},"47":{"start":{"line":98,"column":0},"end":{"line":102,"column":1}},"48":{"start":{"line":99,"column":2},"end":{"line":100,"column":16}},"49":{"start":{"line":100,"column":4},"end":{"line":100,"column":16}},"50":{"start":{"line":101,"column":2},"end":{"line":101,"column":24}},"51":{"start":{"line":104,"column":0},"end":{"line":106,"column":1}},"52":{"start":{"line":105,"column":2},"end":{"line":105,"column":15}},"53":{"start":{"line":108,"column":0},"end":{"line":110,"column":1}},"54":{"start":{"line":109,"column":2},"end":{"line":109,"column":39}}},"branchMap":{"1":{"line":11,"type":"cond-expr","locations":[{"start":{"line":11,"column":52},"end":{"line":11,"column":62}},{"start":{"line":11,"column":63},"end":{"line":11,"column":86}}]},"2":{"line":38,"type":"cond-expr","locations":[{"start":{"line":38,"column":32},"end":{"line":38,"column":39}},{"start":{"line":38,"column":41},"end":{"line":38,"column":50}}]},"3":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"4":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":58,"column":2}},{"start":{"line":58,"column":2},"end":{"line":58,"column":2}}]},"5":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":73,"column":4}},{"start":{"line":73,"column":4},"end":{"line":73,"column":4}}]},"6":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":7},"end":{"line":73,"column":26}},{"start":{"line":73,"column":30},"end":{"line":73,"column":64}},{"start":{"line":73,"column":68},"end":{"line":73,"column":101}}]},"7":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":10},"end":{"line":78,"column":10}},{"start":{"line":78,"column":10},"end":{"line":78,"column":10}}]},"8":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":2},"end":{"line":99,"column":2}},{"start":{"line":99,"column":2},"end":{"line":99,"column":2}}]}},"code":["/**"," * The PriorityQeueu class"," */","var PriorityQueue = function(comparator){","  this.init(comparator);","}","","var pro = PriorityQueue.prototype;","","pro.init = function(comparator){","  this._comparator = typeof(comparator)=='function'?comparator:this._defaultComparator;","  ","  this._queue = [];","  this._tailPos = 0;","}","","/**"," * Return the size of the pirority queue"," * @return PirorityQueue size"," */","pro.size = function(){","  return this._tailPos;","};","  ","/**"," * Insert an element to the queue"," * @param element The element to insert"," */","pro.offer = function(element){","  var queue = this._queue;","  var compare = this._comparator;","  ","  queue[this._tailPos++] = element;","  ","  var pos = this._tailPos-1;","  ","  while(pos > 0){","    var parentPos = (pos%2==0)?(pos/2-1):(pos-1)/2;","    if(compare(queue[parentPos], element)){","      queue[pos] = queue[parentPos];","      queue[parentPos] = element;","      ","      pos = parentPos;","    }else{","      break;","    }","  }","};","          ","/**"," * Get and remove the first element in the queue"," * @return The first element"," */        ","pro.pop = function(){","  var queue = this._queue;","  var compare = this._comparator;","  ","  if(this._tailPos == 0)","    return null;","  ","  ","  var headNode = queue[0];","  ","  var tail = queue[this._tailPos - 1];","","  var pos = 0;","  var left = pos*2 + 1;","  var right = left + 1;","  queue[pos] = tail;","  this._tailPos--;","  ","  while(left < this._tailPos){    ","    if(right<this._tailPos && compare(queue[left], queue[right]) && compare(queue[pos], queue[right])){","      queue[pos] = queue[right];","      queue[right] = tail;","      ","      pos = right;","    }else if(compare(queue[pos],queue[left])){","      queue[pos] = queue[left];","      queue[left] = tail;","      ","      pos = left;","    }else{","      break;","    }","    ","    left = pos*2 + 1;","    right = left + 1;","  }","  ","  return headNode;","};","","/**"," * Get but not remove the first element in the queue"," * @return The first element"," */","pro.peek = function(){","  if(this._tailPos == 0)","    return null;","  return this._queue[0];","}","","pro._defaultComparator = function(a , b){","  return a > b;","}","","module.exports.createPriorityQueue = function(comparator){","  return new PriorityQueue(comparator);","}"],"l":{"4":1,"5":1,"8":1,"10":1,"11":1,"13":1,"14":1,"21":1,"22":0,"29":1,"30":0,"31":0,"33":0,"35":0,"37":0,"38":0,"39":0,"40":0,"41":0,"43":0,"45":0,"54":1,"55":0,"56":0,"58":0,"59":0,"62":0,"64":0,"66":0,"67":0,"68":0,"69":0,"70":0,"72":0,"73":0,"74":0,"75":0,"77":0,"78":0,"79":0,"80":0,"82":0,"84":0,"87":0,"88":0,"91":0,"98":1,"99":0,"100":0,"101":0,"104":1,"105":0,"108":1,"109":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/job.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/job.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":1,"34":0,"35":1,"36":0,"37":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":21,"loc":{"start":{"line":21,"column":10},"end":{"line":21,"column":45}}},"2":{"name":"(anonymous_2)","line":42,"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":20}}},"3":{"name":"(anonymous_3)","line":58,"loc":{"start":{"line":58,"column":15},"end":{"line":58,"column":25}}},"4":{"name":"(anonymous_4)","line":62,"loc":{"start":{"line":62,"column":17},"end":{"line":62,"column":27}}},"5":{"name":"createJob","line":73,"loc":{"start":{"line":73,"column":0},"end":{"line":73,"column":45}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":47}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":14}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":19}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":18}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":17}},"7":{"start":{"line":13,"column":0},"end":{"line":13,"column":20}},"8":{"start":{"line":15,"column":0},"end":{"line":15,"column":53}},"9":{"start":{"line":19,"column":0},"end":{"line":19,"column":18}},"10":{"start":{"line":21,"column":0},"end":{"line":35,"column":2}},"11":{"start":{"line":22,"column":2},"end":{"line":22,"column":39}},"12":{"start":{"line":23,"column":2},"end":{"line":23,"column":22}},"13":{"start":{"line":25,"column":2},"end":{"line":31,"column":3}},"14":{"start":{"line":26,"column":4},"end":{"line":26,"column":25}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":60}},"16":{"start":{"line":28,"column":8},"end":{"line":31,"column":3}},"17":{"start":{"line":29,"column":4},"end":{"line":29,"column":27}},"18":{"start":{"line":30,"column":4},"end":{"line":30,"column":62}},"19":{"start":{"line":33,"column":2},"end":{"line":33,"column":20}},"20":{"start":{"line":34,"column":2},"end":{"line":34,"column":19}},"21":{"start":{"line":37,"column":0},"end":{"line":37,"column":24}},"22":{"start":{"line":42,"column":0},"end":{"line":53,"column":2}},"23":{"start":{"line":43,"column":2},"end":{"line":52,"column":3}},"24":{"start":{"line":44,"column":4},"end":{"line":44,"column":15}},"25":{"start":{"line":45,"column":4},"end":{"line":45,"column":19}},"26":{"start":{"line":46,"column":4},"end":{"line":46,"column":46}},"27":{"start":{"line":47,"column":4},"end":{"line":48,"column":98}},"28":{"start":{"line":48,"column":6},"end":{"line":48,"column":98}},"29":{"start":{"line":49,"column":4},"end":{"line":49,"column":25}},"30":{"start":{"line":51,"column":4},"end":{"line":51,"column":61}},"31":{"start":{"line":58,"column":0},"end":{"line":60,"column":2}},"32":{"start":{"line":59,"column":2},"end":{"line":59,"column":39}},"33":{"start":{"line":62,"column":0},"end":{"line":64,"column":2}},"34":{"start":{"line":63,"column":4},"end":{"line":63,"column":37}},"35":{"start":{"line":73,"column":0},"end":{"line":75,"column":1}},"36":{"start":{"line":74,"column":2},"end":{"line":74,"column":44}},"37":{"start":{"line":77,"column":0},"end":{"line":77,"column":37}}},"branchMap":{"1":{"line":22,"type":"cond-expr","locations":[{"start":{"line":22,"column":26},"end":{"line":22,"column":33}},{"start":{"line":22,"column":34},"end":{"line":22,"column":38}}]},"2":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":2},"end":{"line":25,"column":2}},{"start":{"line":25,"column":2},"end":{"line":25,"column":2}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":8}},{"start":{"line":28,"column":8},"end":{"line":28,"column":8}}]},"4":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]}},"code":["/**"," * This is the class of the job used in schedule module"," */","var cronTrigger = require('./cronTrigger');","var simpleTrigger = require('./simpleTrigger');","","var jobId = 1;","","var SIMPLE_JOB = 1;","var CRON_JOB  = 2;","var jobCount = 0;","","var warnLimit = 500;","","var logger = require('log4js').getLogger(__filename);","","","//For test","var lateCount = 0;","","var Job = function(trigger, jobFunc, jobData){","  this.data = (!!jobData)?jobData:null;","  this.func = jobFunc;","","  if(typeof(trigger) == 'string'){","    this.type = CRON_JOB;","    this.trigger = cronTrigger.createTrigger(trigger, this);","  }else if(typeof(trigger) == 'object'){","    this.type = SIMPLE_JOB;","    this.trigger = simpleTrigger.createTrigger(trigger, this);","  }","","  this.id = jobId++;","  this.runTime = 0;","};","","var pro = Job.prototype;","","/**"," * Run the job code"," */","pro.run = function(){","  try{","    jobCount++;","    this.runTime++;","    var late = Date.now() - this.excuteTime();","    if(late>warnLimit)","      logger.warn('run Job count ' + jobCount + ' late :' + late + ' lateCount ' + (++lateCount));","    this.func(this.data);","  }catch(e){","    logger.error(\"Job run error for exception ! \" + e.stack);","  }","};","","/**"," * Compute the next excution time"," */","pro.nextTime = function(){","  return this.trigger.nextExcuteTime();","};","","pro.excuteTime = function(){","    return this.trigger.excuteTime();","};","","/**"," * The Interface to create Job"," * @param trigger The trigger to use"," * @param jobFunc The function the job to run"," * @param jobDate The date the job use"," * @return The new instance of the give job or null if fail"," */","function createJob(trigger, jobFunc, jobData){","  return new Job(trigger, jobFunc, jobData);","}","","module.exports.createJob = createJob;"],"l":{"4":1,"5":1,"7":1,"9":1,"10":1,"11":1,"13":1,"15":1,"19":1,"21":1,"22":0,"23":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"33":0,"34":0,"37":1,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"51":0,"58":1,"59":0,"62":1,"63":0,"73":1,"74":0,"77":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/cronTrigger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/cronTrigger.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":1,"14":1,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":1,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":1,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":1,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":1,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":1,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":1,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":1,"191":0,"192":0,"193":1,"194":0,"195":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":19,"loc":{"start":{"line":19,"column":18},"end":{"line":19,"column":40}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":17},"end":{"line":32,"column":27}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":21},"end":{"line":41,"column":35}}},"4":{"name":"nextCronTime","line":159,"loc":{"start":{"line":159,"column":0},"end":{"line":159,"column":38}}},"5":{"name":"timeMatch","line":186,"loc":{"start":{"line":186,"column":0},"end":{"line":186,"column":35}}},"6":{"name":"(anonymous_6)","line":212,"loc":{"start":{"line":212,"column":20},"end":{"line":212,"column":41}}},"7":{"name":"(anonymous_7)","line":238,"loc":{"start":{"line":238,"column":20},"end":{"line":238,"column":43}}},"8":{"name":"(anonymous_8)","line":273,"loc":{"start":{"line":273,"column":11},"end":{"line":273,"column":25}}},"9":{"name":"decodeRangeTime","line":285,"loc":{"start":{"line":285,"column":0},"end":{"line":285,"column":38}}},"10":{"name":"decodePeriodTime","line":303,"loc":{"start":{"line":303,"column":0},"end":{"line":303,"column":45}}},"11":{"name":"checkNum","line":327,"loc":{"start":{"line":327,"column":0},"end":{"line":327,"column":33}}},"12":{"name":"getDomLimit","line":348,"loc":{"start":{"line":348,"column":0},"end":{"line":348,"column":33}}},"13":{"name":"createTrigger","line":359,"loc":{"start":{"line":359,"column":0},"end":{"line":359,"column":36}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":53}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":15}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":12}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":13}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":12}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":14}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":12}},"8":{"start":{"line":13,"column":0},"end":{"line":13,"column":55}},"9":{"start":{"line":19,"column":0},"end":{"line":25,"column":2}},"10":{"start":{"line":20,"column":2},"end":{"line":20,"column":45}},"11":{"start":{"line":22,"column":2},"end":{"line":22,"column":50}},"12":{"start":{"line":24,"column":2},"end":{"line":24,"column":17}},"13":{"start":{"line":27,"column":0},"end":{"line":27,"column":32}},"14":{"start":{"line":32,"column":0},"end":{"line":34,"column":2}},"15":{"start":{"line":33,"column":2},"end":{"line":33,"column":23}},"16":{"start":{"line":41,"column":0},"end":{"line":151,"column":2}},"17":{"start":{"line":43,"column":2},"end":{"line":43,"column":35}},"18":{"start":{"line":44,"column":2},"end":{"line":44,"column":15}},"19":{"start":{"line":46,"column":2},"end":{"line":46,"column":33}},"20":{"start":{"line":47,"column":2},"end":{"line":47,"column":28}},"21":{"start":{"line":48,"column":2},"end":{"line":48,"column":26}},"22":{"start":{"line":50,"column":2},"end":{"line":147,"column":3}},"23":{"start":{"line":51,"column":2},"end":{"line":147,"column":3}},"24":{"start":{"line":52,"column":4},"end":{"line":55,"column":5}},"25":{"start":{"line":53,"column":6},"end":{"line":53,"column":68}},"26":{"start":{"line":54,"column":6},"end":{"line":54,"column":18}},"27":{"start":{"line":56,"column":4},"end":{"line":77,"column":5}},"28":{"start":{"line":57,"column":6},"end":{"line":57,"column":72}},"29":{"start":{"line":59,"column":6},"end":{"line":60,"column":20}},"30":{"start":{"line":60,"column":8},"end":{"line":60,"column":20}},"31":{"start":{"line":62,"column":6},"end":{"line":70,"column":7}},"32":{"start":{"line":63,"column":8},"end":{"line":63,"column":45}},"33":{"start":{"line":64,"column":8},"end":{"line":64,"column":25}},"34":{"start":{"line":65,"column":8},"end":{"line":65,"column":24}},"35":{"start":{"line":66,"column":8},"end":{"line":66,"column":25}},"36":{"start":{"line":67,"column":8},"end":{"line":67,"column":27}},"37":{"start":{"line":68,"column":8},"end":{"line":68,"column":27}},"38":{"start":{"line":69,"column":8},"end":{"line":69,"column":17}},"39":{"start":{"line":71,"column":6},"end":{"line":71,"column":31}},"40":{"start":{"line":73,"column":6},"end":{"line":73,"column":22}},"41":{"start":{"line":74,"column":6},"end":{"line":74,"column":23}},"42":{"start":{"line":75,"column":6},"end":{"line":75,"column":25}},"43":{"start":{"line":76,"column":6},"end":{"line":76,"column":25}},"44":{"start":{"line":79,"column":4},"end":{"line":103,"column":5}},"45":{"start":{"line":80,"column":6},"end":{"line":80,"column":70}},"46":{"start":{"line":82,"column":6},"end":{"line":98,"column":58}},"47":{"start":{"line":83,"column":8},"end":{"line":83,"column":69}},"48":{"start":{"line":84,"column":8},"end":{"line":85,"column":22}},"49":{"start":{"line":85,"column":10},"end":{"line":85,"column":22}},"50":{"start":{"line":88,"column":8},"end":{"line":95,"column":9}},"51":{"start":{"line":89,"column":10},"end":{"line":89,"column":45}},"52":{"start":{"line":90,"column":10},"end":{"line":90,"column":26}},"53":{"start":{"line":91,"column":10},"end":{"line":91,"column":27}},"54":{"start":{"line":92,"column":10},"end":{"line":92,"column":29}},"55":{"start":{"line":93,"column":10},"end":{"line":93,"column":29}},"56":{"start":{"line":94,"column":10},"end":{"line":94,"column":27}},"57":{"start":{"line":97,"column":9},"end":{"line":97,"column":31}},"58":{"start":{"line":100,"column":6},"end":{"line":100,"column":23}},"59":{"start":{"line":101,"column":6},"end":{"line":101,"column":25}},"60":{"start":{"line":102,"column":6},"end":{"line":102,"column":25}},"61":{"start":{"line":105,"column":4},"end":{"line":119,"column":5}},"62":{"start":{"line":106,"column":6},"end":{"line":106,"column":70}},"63":{"start":{"line":108,"column":6},"end":{"line":114,"column":7}},"64":{"start":{"line":109,"column":9},"end":{"line":109,"column":42}},"65":{"start":{"line":110,"column":9},"end":{"line":110,"column":33}},"66":{"start":{"line":111,"column":9},"end":{"line":111,"column":28}},"67":{"start":{"line":112,"column":9},"end":{"line":112,"column":28}},"68":{"start":{"line":113,"column":9},"end":{"line":113,"column":18}},"69":{"start":{"line":116,"column":6},"end":{"line":116,"column":30}},"70":{"start":{"line":117,"column":6},"end":{"line":117,"column":25}},"71":{"start":{"line":118,"column":6},"end":{"line":118,"column":25}},"72":{"start":{"line":121,"column":4},"end":{"line":133,"column":5}},"73":{"start":{"line":122,"column":6},"end":{"line":122,"column":73}},"74":{"start":{"line":124,"column":6},"end":{"line":129,"column":7}},"75":{"start":{"line":125,"column":9},"end":{"line":125,"column":44}},"76":{"start":{"line":126,"column":9},"end":{"line":126,"column":37}},"77":{"start":{"line":127,"column":9},"end":{"line":127,"column":28}},"78":{"start":{"line":128,"column":9},"end":{"line":128,"column":18}},"79":{"start":{"line":131,"column":6},"end":{"line":131,"column":34}},"80":{"start":{"line":132,"column":6},"end":{"line":132,"column":25}},"81":{"start":{"line":135,"column":4},"end":{"line":145,"column":5}},"82":{"start":{"line":136,"column":6},"end":{"line":136,"column":76}},"83":{"start":{"line":138,"column":6},"end":{"line":142,"column":7}},"84":{"start":{"line":139,"column":9},"end":{"line":139,"column":48}},"85":{"start":{"line":140,"column":9},"end":{"line":140,"column":37}},"86":{"start":{"line":141,"column":9},"end":{"line":141,"column":18}},"87":{"start":{"line":144,"column":6},"end":{"line":144,"column":34}},"88":{"start":{"line":146,"column":4},"end":{"line":146,"column":10}},"89":{"start":{"line":149,"column":2},"end":{"line":149,"column":33}},"90":{"start":{"line":150,"column":2},"end":{"line":150,"column":23}},"91":{"start":{"line":159,"column":0},"end":{"line":178,"column":1}},"92":{"start":{"line":160,"column":2},"end":{"line":160,"column":13}},"93":{"start":{"line":162,"column":2},"end":{"line":174,"column":3}},"94":{"start":{"line":163,"column":4},"end":{"line":166,"column":22}},"95":{"start":{"line":164,"column":6},"end":{"line":164,"column":19}},"96":{"start":{"line":166,"column":6},"end":{"line":166,"column":22}},"97":{"start":{"line":167,"column":8},"end":{"line":174,"column":3}},"98":{"start":{"line":168,"column":4},"end":{"line":169,"column":25}},"99":{"start":{"line":169,"column":6},"end":{"line":169,"column":25}},"100":{"start":{"line":171,"column":4},"end":{"line":173,"column":27}},"101":{"start":{"line":172,"column":6},"end":{"line":173,"column":27}},"102":{"start":{"line":173,"column":8},"end":{"line":173,"column":27}},"103":{"start":{"line":176,"column":2},"end":{"line":176,"column":86}},"104":{"start":{"line":177,"column":2},"end":{"line":177,"column":14}},"105":{"start":{"line":186,"column":0},"end":{"line":205,"column":1}},"106":{"start":{"line":187,"column":2},"end":{"line":202,"column":3}},"107":{"start":{"line":188,"column":4},"end":{"line":189,"column":18}},"108":{"start":{"line":189,"column":6},"end":{"line":189,"column":18}},"109":{"start":{"line":190,"column":4},"end":{"line":191,"column":18}},"110":{"start":{"line":191,"column":6},"end":{"line":191,"column":18}},"111":{"start":{"line":192,"column":4},"end":{"line":192,"column":17}},"112":{"start":{"line":193,"column":8},"end":{"line":202,"column":3}},"113":{"start":{"line":194,"column":4},"end":{"line":195,"column":19}},"114":{"start":{"line":195,"column":6},"end":{"line":195,"column":19}},"115":{"start":{"line":197,"column":4},"end":{"line":199,"column":20}},"116":{"start":{"line":198,"column":6},"end":{"line":199,"column":20}},"117":{"start":{"line":199,"column":8},"end":{"line":199,"column":20}},"118":{"start":{"line":201,"column":4},"end":{"line":201,"column":17}},"119":{"start":{"line":204,"column":2},"end":{"line":204,"column":14}},"120":{"start":{"line":212,"column":0},"end":{"line":231,"column":1}},"121":{"start":{"line":213,"column":2},"end":{"line":213,"column":43}},"122":{"start":{"line":215,"column":2},"end":{"line":218,"column":3}},"123":{"start":{"line":216,"column":4},"end":{"line":216,"column":25}},"124":{"start":{"line":217,"column":4},"end":{"line":217,"column":16}},"125":{"start":{"line":220,"column":2},"end":{"line":228,"column":3}},"126":{"start":{"line":221,"column":4},"end":{"line":221,"column":57}},"127":{"start":{"line":223,"column":4},"end":{"line":227,"column":5}},"128":{"start":{"line":224,"column":6},"end":{"line":225,"column":66}},"129":{"start":{"line":226,"column":6},"end":{"line":226,"column":18}},"130":{"start":{"line":230,"column":2},"end":{"line":230,"column":19}},"131":{"start":{"line":238,"column":0},"end":{"line":278,"column":1}},"132":{"start":{"line":239,"column":2},"end":{"line":239,"column":18}},"133":{"start":{"line":240,"column":2},"end":{"line":240,"column":15}},"134":{"start":{"line":242,"column":2},"end":{"line":267,"column":3}},"135":{"start":{"line":243,"column":4},"end":{"line":243,"column":14}},"136":{"start":{"line":244,"column":8},"end":{"line":267,"column":3}},"137":{"start":{"line":245,"column":4},"end":{"line":245,"column":37}},"138":{"start":{"line":246,"column":4},"end":{"line":257,"column":5}},"139":{"start":{"line":247,"column":6},"end":{"line":247,"column":28}},"140":{"start":{"line":248,"column":6},"end":{"line":256,"column":20}},"141":{"start":{"line":249,"column":8},"end":{"line":249,"column":38}},"142":{"start":{"line":250,"column":12},"end":{"line":256,"column":20}},"143":{"start":{"line":251,"column":8},"end":{"line":251,"column":45}},"144":{"start":{"line":252,"column":12},"end":{"line":256,"column":20}},"145":{"start":{"line":253,"column":8},"end":{"line":253,"column":31}},"146":{"start":{"line":254,"column":8},"end":{"line":254,"column":26}},"147":{"start":{"line":256,"column":8},"end":{"line":256,"column":20}},"148":{"start":{"line":258,"column":8},"end":{"line":267,"column":3}},"149":{"start":{"line":259,"column":4},"end":{"line":259,"column":37}},"150":{"start":{"line":260,"column":8},"end":{"line":267,"column":3}},"151":{"start":{"line":261,"column":4},"end":{"line":261,"column":44}},"152":{"start":{"line":262,"column":8},"end":{"line":267,"column":3}},"153":{"start":{"line":263,"column":4},"end":{"line":263,"column":30}},"154":{"start":{"line":264,"column":4},"end":{"line":264,"column":22}},"155":{"start":{"line":266,"column":4},"end":{"line":266,"column":16}},"156":{"start":{"line":269,"column":2},"end":{"line":271,"column":3}},"157":{"start":{"line":270,"column":4},"end":{"line":270,"column":26}},"158":{"start":{"line":273,"column":2},"end":{"line":275,"column":5}},"159":{"start":{"line":274,"column":4},"end":{"line":274,"column":17}},"160":{"start":{"line":277,"column":2},"end":{"line":277,"column":13}},"161":{"start":{"line":285,"column":0},"end":{"line":298,"column":1}},"162":{"start":{"line":286,"column":2},"end":{"line":286,"column":33}},"163":{"start":{"line":288,"column":2},"end":{"line":288,"column":30}},"164":{"start":{"line":289,"column":2},"end":{"line":289,"column":30}},"165":{"start":{"line":290,"column":2},"end":{"line":293,"column":3}},"166":{"start":{"line":291,"column":4},"end":{"line":291,"column":36}},"167":{"start":{"line":292,"column":4},"end":{"line":292,"column":16}},"168":{"start":{"line":295,"column":2},"end":{"line":297,"column":3}},"169":{"start":{"line":296,"column":4},"end":{"line":296,"column":15}},"170":{"start":{"line":303,"column":0},"end":{"line":318,"column":1}},"171":{"start":{"line":304,"column":2},"end":{"line":304,"column":33}},"172":{"start":{"line":305,"column":2},"end":{"line":305,"column":27}},"173":{"start":{"line":306,"column":2},"end":{"line":306,"column":27}},"174":{"start":{"line":308,"column":2},"end":{"line":308,"column":32}},"175":{"start":{"line":309,"column":2},"end":{"line":309,"column":32}},"176":{"start":{"line":311,"column":2},"end":{"line":312,"column":11}},"177":{"start":{"line":312,"column":4},"end":{"line":312,"column":11}},"178":{"start":{"line":314,"column":2},"end":{"line":317,"column":3}},"179":{"start":{"line":315,"column":4},"end":{"line":316,"column":17}},"180":{"start":{"line":316,"column":6},"end":{"line":316,"column":17}},"181":{"start":{"line":327,"column":0},"end":{"line":340,"column":1}},"182":{"start":{"line":328,"column":2},"end":{"line":329,"column":17}},"183":{"start":{"line":329,"column":4},"end":{"line":329,"column":17}},"184":{"start":{"line":331,"column":2},"end":{"line":332,"column":16}},"185":{"start":{"line":332,"column":4},"end":{"line":332,"column":16}},"186":{"start":{"line":334,"column":2},"end":{"line":337,"column":3}},"187":{"start":{"line":335,"column":4},"end":{"line":336,"column":19}},"188":{"start":{"line":336,"column":6},"end":{"line":336,"column":19}},"189":{"start":{"line":339,"column":2},"end":{"line":339,"column":14}},"190":{"start":{"line":348,"column":0},"end":{"line":352,"column":1}},"191":{"start":{"line":349,"column":2},"end":{"line":349,"column":40}},"192":{"start":{"line":351,"column":2},"end":{"line":351,"column":24}},"193":{"start":{"line":359,"column":0},"end":{"line":361,"column":1}},"194":{"start":{"line":360,"column":2},"end":{"line":360,"column":39}},"195":{"start":{"line":363,"column":0},"end":{"line":363,"column":45}}},"branchMap":{"1":{"line":43,"type":"cond-expr","locations":[{"start":{"line":43,"column":16},"end":{"line":43,"column":20}},{"start":{"line":43,"column":21},"end":{"line":43,"column":34}}]},"2":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"3":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":4}},{"start":{"line":56,"column":4},"end":{"line":56,"column":4}}]},"4":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":6},"end":{"line":59,"column":6}},{"start":{"line":59,"column":6},"end":{"line":59,"column":6}}]},"5":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":6},"end":{"line":62,"column":6}},{"start":{"line":62,"column":6},"end":{"line":62,"column":6}}]},"6":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"7":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":7},"end":{"line":79,"column":51}},{"start":{"line":79,"column":55},"end":{"line":79,"column":98}}]},"8":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":8},"end":{"line":84,"column":8}},{"start":{"line":84,"column":8},"end":{"line":84,"column":8}}]},"9":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":8},"end":{"line":88,"column":8}},{"start":{"line":88,"column":8},"end":{"line":88,"column":8}}]},"10":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":11},"end":{"line":88,"column":36}},{"start":{"line":88,"column":40},"end":{"line":88,"column":58}}]},"11":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":4},"end":{"line":105,"column":4}},{"start":{"line":105,"column":4},"end":{"line":105,"column":4}}]},"12":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":6},"end":{"line":108,"column":6}},{"start":{"line":108,"column":6},"end":{"line":108,"column":6}}]},"13":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":4},"end":{"line":121,"column":4}},{"start":{"line":121,"column":4},"end":{"line":121,"column":4}}]},"14":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":6},"end":{"line":124,"column":6}},{"start":{"line":124,"column":6},"end":{"line":124,"column":6}}]},"15":{"line":135,"type":"if","locations":[{"start":{"line":135,"column":4},"end":{"line":135,"column":4}},{"start":{"line":135,"column":4},"end":{"line":135,"column":4}}]},"16":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":6},"end":{"line":138,"column":6}},{"start":{"line":138,"column":6},"end":{"line":138,"column":6}}]},"17":{"line":162,"type":"if","locations":[{"start":{"line":162,"column":2},"end":{"line":162,"column":2}},{"start":{"line":162,"column":2},"end":{"line":162,"column":2}}]},"18":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":4},"end":{"line":163,"column":4}},{"start":{"line":163,"column":4},"end":{"line":163,"column":4}}]},"19":{"line":167,"type":"if","locations":[{"start":{"line":167,"column":8},"end":{"line":167,"column":8}},{"start":{"line":167,"column":8},"end":{"line":167,"column":8}}]},"20":{"line":167,"type":"binary-expr","locations":[{"start":{"line":167,"column":11},"end":{"line":167,"column":39}},{"start":{"line":167,"column":43},"end":{"line":167,"column":68}}]},"21":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":4},"end":{"line":168,"column":4}},{"start":{"line":168,"column":4},"end":{"line":168,"column":4}}]},"22":{"line":168,"type":"binary-expr","locations":[{"start":{"line":168,"column":7},"end":{"line":168,"column":27}},{"start":{"line":168,"column":31},"end":{"line":168,"column":67}}]},"23":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":6},"end":{"line":172,"column":6}},{"start":{"line":172,"column":6},"end":{"line":172,"column":6}}]},"24":{"line":187,"type":"if","locations":[{"start":{"line":187,"column":2},"end":{"line":187,"column":2}},{"start":{"line":187,"column":2},"end":{"line":187,"column":2}}]},"25":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":4},"end":{"line":188,"column":4}},{"start":{"line":188,"column":4},"end":{"line":188,"column":4}}]},"26":{"line":190,"type":"if","locations":[{"start":{"line":190,"column":4},"end":{"line":190,"column":4}},{"start":{"line":190,"column":4},"end":{"line":190,"column":4}}]},"27":{"line":193,"type":"if","locations":[{"start":{"line":193,"column":8},"end":{"line":193,"column":8}},{"start":{"line":193,"column":8},"end":{"line":193,"column":8}}]},"28":{"line":193,"type":"binary-expr","locations":[{"start":{"line":193,"column":11},"end":{"line":193,"column":39}},{"start":{"line":193,"column":43},"end":{"line":193,"column":68}}]},"29":{"line":194,"type":"if","locations":[{"start":{"line":194,"column":4},"end":{"line":194,"column":4}},{"start":{"line":194,"column":4},"end":{"line":194,"column":4}}]},"30":{"line":194,"type":"binary-expr","locations":[{"start":{"line":194,"column":7},"end":{"line":194,"column":26}},{"start":{"line":194,"column":30},"end":{"line":194,"column":66}}]},"31":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":6},"end":{"line":198,"column":6}},{"start":{"line":198,"column":6},"end":{"line":198,"column":6}}]},"32":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":2},"end":{"line":215,"column":2}},{"start":{"line":215,"column":2},"end":{"line":215,"column":2}}]},"33":{"line":223,"type":"if","locations":[{"start":{"line":223,"column":4},"end":{"line":223,"column":4}},{"start":{"line":223,"column":4},"end":{"line":223,"column":4}}]},"34":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":2},"end":{"line":242,"column":2}},{"start":{"line":242,"column":2},"end":{"line":242,"column":2}}]},"35":{"line":244,"type":"if","locations":[{"start":{"line":244,"column":8},"end":{"line":244,"column":8}},{"start":{"line":244,"column":8},"end":{"line":244,"column":8}}]},"36":{"line":248,"type":"if","locations":[{"start":{"line":248,"column":6},"end":{"line":248,"column":6}},{"start":{"line":248,"column":6},"end":{"line":248,"column":6}}]},"37":{"line":250,"type":"if","locations":[{"start":{"line":250,"column":12},"end":{"line":250,"column":12}},{"start":{"line":250,"column":12},"end":{"line":250,"column":12}}]},"38":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":12},"end":{"line":252,"column":12}},{"start":{"line":252,"column":12},"end":{"line":252,"column":12}}]},"39":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8}},{"start":{"line":258,"column":8},"end":{"line":258,"column":8}}]},"40":{"line":260,"type":"if","locations":[{"start":{"line":260,"column":8},"end":{"line":260,"column":8}},{"start":{"line":260,"column":8},"end":{"line":260,"column":8}}]},"41":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":8},"end":{"line":262,"column":8}},{"start":{"line":262,"column":8},"end":{"line":262,"column":8}}]},"42":{"line":290,"type":"if","locations":[{"start":{"line":290,"column":2},"end":{"line":290,"column":2}},{"start":{"line":290,"column":2},"end":{"line":290,"column":2}}]},"43":{"line":311,"type":"if","locations":[{"start":{"line":311,"column":2},"end":{"line":311,"column":2}},{"start":{"line":311,"column":2},"end":{"line":311,"column":2}}]},"44":{"line":315,"type":"if","locations":[{"start":{"line":315,"column":4},"end":{"line":315,"column":4}},{"start":{"line":315,"column":4},"end":{"line":315,"column":4}}]},"45":{"line":328,"type":"if","locations":[{"start":{"line":328,"column":2},"end":{"line":328,"column":2}},{"start":{"line":328,"column":2},"end":{"line":328,"column":2}}]},"46":{"line":331,"type":"if","locations":[{"start":{"line":331,"column":2},"end":{"line":331,"column":2}},{"start":{"line":331,"column":2},"end":{"line":331,"column":2}}]},"47":{"line":335,"type":"if","locations":[{"start":{"line":335,"column":4},"end":{"line":335,"column":4}},{"start":{"line":335,"column":4},"end":{"line":335,"column":4}}]},"48":{"line":335,"type":"binary-expr","locations":[{"start":{"line":335,"column":7},"end":{"line":335,"column":18}},{"start":{"line":335,"column":22},"end":{"line":335,"column":33}}]}},"code":["/**"," * This is the trigger used to decode the cronTimer and calculate the next excution time of the cron Trigger."," */","var logger = require('log4js').getLogger(__filename);","","var SECOND = 0;","var MIN = 1;","var HOUR = 2;","var DOM = 3;","var MONTH = 4;","var DOW = 5;","","var Limit = [[0,59],[0,59],[0,24],[1,31],[0,11],[0,6]];","","/**"," * The constructor of the CronTrigger"," * @param trigger The trigger str used to build the cronTrigger instance"," */","var CronTrigger = function(trigger, job){","  this.trigger = this.decodeTrigger(trigger);","","  this.nextTime = this.nextExcuteTime(Date.now());","","  this.job = job;","};","","var pro = CronTrigger.prototype;","","/**"," * Get the current excuteTime of trigger"," */","pro.excuteTime = function(){","  return this.nextTime;","};","","/**"," * Caculate the next valid cronTime after the given time"," * @param The given time point"," * @return The nearest valid time after the given time point"," */","pro.nextExcuteTime = function(time){","  //add 1s to the time so it must be the next time","  time = !!time?time:this.nextTime;","  time += 1000;","","  var cronTrigger = this.trigger;","  var date = new Date(time);","  date.setMilliseconds(0);","","  outmost:","  while(true){","    if(date.getFullYear() > 2999){","      logger.error(\"Can't compute the next time, exceed the limit\");","      return null;","    }","    if(!timeMatch(date.getMonth(), cronTrigger[MONTH])){","      var nextMonth = nextCronTime(date.getMonth(), cronTrigger[MONTH]);","","      if(nextMonth == null)","        return null;","","      if(nextMonth <= date.getMonth()){","        date.setYear(date.getFullYear() + 1);","        date.setMonth(0);","        date.setDate(1);","        date.setHours(0);","        date.setMinutes(0);","        date.setSeconds(0);","        continue;","      }","      date.setMonth(nextMonth);","","      date.setDate(1);","      date.setHours(0);","      date.setMinutes(0);","      date.setSeconds(0);","    }","","    if(!timeMatch(date.getDate(), cronTrigger[DOM]) || !timeMatch(date.getDay(), cronTrigger[DOW])){","      var domLimit = getDomLimit(date.getFullYear(), date.getMonth());","","      do{","        var nextDom = nextCronTime(date.getDate(), cronTrigger[DOM]);","        if(nextDom == null)","          return null;","","        //If the date is in the next month, add month","        if(nextDom <= date.getDate() || nextDom > domLimit){","          date.setMonth(date.getMonth() + 1);","          date.setDate(1);","          date.setHours(0);","          date.setMinutes(0);","          date.setSeconds(0);","          continue outmost;","        }","","         date.setDate(nextDom);","      }while(!timeMatch(date.getDay(), cronTrigger[DOW]));","","      date.setHours(0);","      date.setMinutes(0);","      date.setSeconds(0);","    }","","    if(!timeMatch(date.getHours(), cronTrigger[HOUR])){","      var nextHour = nextCronTime(date.getHours(), cronTrigger[HOUR]);","","      if(nextHour <= date.getHours()){","         date.setDate(date.getDate() + 1);","         date.setHours(nextHour);","         date.setMinutes(0);","         date.setSeconds(0);","         continue;","      }","","      date.setHours(nextHour);","      date.setMinutes(0);","      date.setSeconds(0);","    }","","    if(!timeMatch(date.getMinutes(), cronTrigger[MIN])){","      var nextMinute = nextCronTime(date.getMinutes(), cronTrigger[MIN]);","","      if(nextMinute <= date.getMinutes()){","         date.setHours(date.getHours() + 1);","         date.setMinutes(nextMinute);","         date.setSeconds(0);","         continue;","      }","","      date.setMinutes(nextMinute);","      date.setSeconds(0);","    }","","    if(!timeMatch(date.getSeconds(), cronTrigger[SECOND])){","      var nextSecond = nextCronTime(date.getSeconds(), cronTrigger[SECOND]);","","      if(nextSecond <= date.getSeconds()){","         date.setMinutes(date.getMinutes() + 1);","         date.setSeconds(nextSecond);","         continue;","      }","","      date.setSeconds(nextSecond);","    }","    break;","  }","","  this.nextTime = date.getTime();","  return this.nextTime;","};","","/**"," * return the next match time of the given value"," * @param value The time value"," * @param cronTime The cronTime need to match"," * @return The match value or null if unmatch(it offten means an error occur)."," */","function nextCronTime(value, cronTime){","  value += 1;","","  if(typeof(cronTime) == 'number'){","    if(cronTime == -1)","      return value;","    else","      return cronTime;","  }else if(typeof(cronTime) == 'object' && cronTime instanceof Array){","    if(value <= cronTime[0] || value > cronTime[cronTime.length -1])","      return cronTime[0];","","    for(var i = 0; i < cronTime.length; i++)","      if(value <= cronTime[i])","        return cronTime[i];","  }","","  logger.warn('Compute next Time error! value :' + value + ' cronTime : ' + cronTime);","  return null;","}","","/**"," * Match the given value to the cronTime"," * @param value The given value"," * @param cronTime The cronTime"," * @return The match result"," */","function timeMatch(value, cronTime){","  if(typeof(cronTime) == 'number'){","    if(cronTime == -1)","      return true;","    if(value == cronTime)","      return true;","    return false;","  }else if(typeof(cronTime) == 'object' && cronTime instanceof Array){","    if(value < cronTime[0] || value > cronTime[cronTime.length -1])","      return false;","","    for(var i = 0; i < cronTime.length; i++)","      if(value == cronTime[i])","        return true;","","    return false;","  }","","  return null;","}","","/**"," * Decude the cronTrigger string to arrays"," * @param cronTimeStr The cronTimeStr need to decode, like \"0 12 * * * 3\""," * @return The array to represent the cronTimer"," */","pro.decodeTrigger = function(cronTimeStr){","  var cronTimes = cronTimeStr.split(/\\s+/);","","  if(cronTimes.length != 6){","    console.log('error');","    return null;","  }","","  for(var i = 0; i < cronTimes.length; i++){","    cronTimes[i] = (this.decodeTimeStr(cronTimes[i], i));","","    if(!checkNum(cronTimes[i], Limit[i][0], Limit[i][1])){","      logger.error('Decode crontime error, value exceed limit!' +","        JSON.stringify({cronTime: cronTimes[i], limit:Limit[i]}));","      return null;","    }","  }","","  return cronTimes;","}","","/**"," * Decode the cron Time string"," * @param timeStr The cron time string, like: 1,2 or 1-3"," * @return A sorted array, like [1,2,3]"," */","pro.decodeTimeStr = function(timeStr, type){","  var result = {};","  var arr = [];","","  if(timeStr=='*'){","    return -1;","  }else if(timeStr.search(',')>0){","    var timeArr = timeStr.split(',');","    for(var i = 0; i < timeArr.length; i++){","      var time = timeArr[i];","      if(time.match(/^\\d+-\\d+$/)){","        decodeRangeTime(result, time);","      }else if(time.match(/^\\d+\\/\\d+/)){","        decodePeriodTime(result, time, type);","      }else if(!isNaN(time)){","        var num = Number(time);","        result[num] = num;","      }else","        return null;","    }","  }else if(timeStr.match(/^\\d+-\\d+$/)){","    decodeRangeTime(result, timeStr);","  }else if(timeStr.match(/^\\d+\\/\\d+/)){","    decodePeriodTime(result, timeStr, type);","  }else if(!isNaN(timeStr)){","    var num = Number(timeStr);","    result[num] = num;","  }else{","    return null;","  }","","  for(var key in result){","    arr.push(result[key]);","  }","","  arr.sort(function(a, b){","    return a - b;","  });","","  return arr;","}","","/**"," * Decode time range"," * @param map The decode map"," * @param timeStr The range string, like 2-5"," */","function decodeRangeTime(map, timeStr){","  var times = timeStr.split('-');","","  times[0] = Number(times[0]);","  times[1] = Number(times[1]);","  if(times[0] > times[1]){","    console.log(\"Error time range\");","    return null;","  }","","  for(var i = times[0]; i <= times[1]; i++){","    map[i] = i;","  }","}","","/**"," * Compute the period timer"," */","function decodePeriodTime(map, timeStr, type){","  var times = timeStr.split('/');","  var min = Limit[type][0];","  var max = Limit[type][1];","","  var remind = Number(times[0]);","  var period = Number(times[1]);","","  if(period==0)","    return;","","  for(var i = min; i <= max; i++){","    if(i%period == remind)","      map[i] = i;","  }","}","","/**"," * Check if the numbers are valid"," * @param nums The numbers array need to check"," * @param min Minimus value"," * @param max Maximam value"," * @return If all the numbers are in the data range"," */","function checkNum(nums, min, max){","  if(nums == null)","    return false;","","  if(nums == -1)","    return true;","","  for(var i = 0; i < nums.length; i++){","    if(nums[i]<min || nums[i]>max)","      return false;","  }","","  return true;","}","","/**"," * Get the date limit of given month"," * @param The given year"," * @month The given month"," * @return The date count of given month"," */","function getDomLimit(year, month){","  var date = new Date(year, month+1, 0);","","  return date.getDate();","}","","/**"," * Create cronTrigger"," * @param trigger The Cron Trigger string"," * @return The Cron trigger"," */","function createTrigger(trigger, job){","  return new CronTrigger(trigger, job);","}","","module.exports.createTrigger = createTrigger;",""],"l":{"4":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"13":1,"19":1,"20":0,"22":0,"24":0,"27":1,"32":1,"33":0,"41":1,"43":0,"44":0,"46":0,"47":0,"48":0,"50":0,"51":0,"52":0,"53":0,"54":0,"56":0,"57":0,"59":0,"60":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"71":0,"73":0,"74":0,"75":0,"76":0,"79":0,"80":0,"82":0,"83":0,"84":0,"85":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"97":0,"100":0,"101":0,"102":0,"105":0,"106":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"116":0,"117":0,"118":0,"121":0,"122":0,"124":0,"125":0,"126":0,"127":0,"128":0,"131":0,"132":0,"135":0,"136":0,"138":0,"139":0,"140":0,"141":0,"144":0,"146":0,"149":0,"150":0,"159":1,"160":0,"162":0,"163":0,"164":0,"166":0,"167":0,"168":0,"169":0,"171":0,"172":0,"173":0,"176":0,"177":0,"186":1,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"197":0,"198":0,"199":0,"201":0,"204":0,"212":1,"213":0,"215":0,"216":0,"217":0,"220":0,"221":0,"223":0,"224":0,"226":0,"230":0,"238":1,"239":0,"240":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"256":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"266":0,"269":0,"270":0,"273":0,"274":0,"277":0,"285":1,"286":0,"288":0,"289":0,"290":0,"291":0,"292":0,"295":0,"296":0,"303":1,"304":0,"305":0,"306":0,"308":0,"309":0,"311":0,"312":0,"314":0,"315":0,"316":0,"327":1,"328":0,"329":0,"331":0,"332":0,"334":0,"335":0,"336":0,"339":0,"348":1,"349":0,"351":0,"359":1,"360":0,"363":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/simpleTrigger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/node_modules/pomelo-scheduler/lib/simpleTrigger.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1,"8":1,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":20},"end":{"line":9,"column":42}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":17},"end":{"line":26,"column":27}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":21},"end":{"line":34,"column":31}}},"4":{"name":"createTrigger","line":52,"loc":{"start":{"line":52,"column":0},"end":{"line":52,"column":36}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":25}},"2":{"start":{"line":9,"column":0},"end":{"line":19,"column":2}},"3":{"start":{"line":10,"column":2},"end":{"line":10,"column":61}},"4":{"start":{"line":13,"column":2},"end":{"line":13,"column":53}},"5":{"start":{"line":16,"column":2},"end":{"line":16,"column":50}},"6":{"start":{"line":18,"column":2},"end":{"line":18,"column":17}},"7":{"start":{"line":21,"column":0},"end":{"line":21,"column":34}},"8":{"start":{"line":26,"column":0},"end":{"line":28,"column":2}},"9":{"start":{"line":27,"column":2},"end":{"line":27,"column":23}},"10":{"start":{"line":34,"column":0},"end":{"line":47,"column":2}},"11":{"start":{"line":35,"column":2},"end":{"line":35,"column":27}},"12":{"start":{"line":37,"column":2},"end":{"line":38,"column":16}},"13":{"start":{"line":38,"column":4},"end":{"line":38,"column":16}},"14":{"start":{"line":40,"column":2},"end":{"line":40,"column":26}},"15":{"start":{"line":42,"column":2},"end":{"line":44,"column":3}},"16":{"start":{"line":43,"column":4},"end":{"line":43,"column":76}},"17":{"start":{"line":46,"column":2},"end":{"line":46,"column":23}},"18":{"start":{"line":52,"column":0},"end":{"line":54,"column":1}},"19":{"start":{"line":53,"column":2},"end":{"line":53,"column":41}},"20":{"start":{"line":56,"column":0},"end":{"line":56,"column":45}}},"branchMap":{"1":{"line":10,"type":"cond-expr","locations":[{"start":{"line":10,"column":36},"end":{"line":10,"column":49}},{"start":{"line":10,"column":50},"end":{"line":10,"column":60}}]},"2":{"line":13,"type":"cond-expr","locations":[{"start":{"line":13,"column":35},"end":{"line":13,"column":49}},{"start":{"line":13,"column":50},"end":{"line":13,"column":52}}]},"3":{"line":16,"type":"cond-expr","locations":[{"start":{"line":16,"column":33},"end":{"line":16,"column":46}},{"start":{"line":16,"column":47},"end":{"line":16,"column":49}}]},"4":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":2}},{"start":{"line":37,"column":2},"end":{"line":37,"column":2}}]},"5":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":6},"end":{"line":37,"column":20}},{"start":{"line":37,"column":24},"end":{"line":37,"column":54}},{"start":{"line":37,"column":59},"end":{"line":37,"column":70}}]},"6":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":2},"end":{"line":42,"column":2}},{"start":{"line":42,"column":2},"end":{"line":42,"column":2}}]},"7":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":5},"end":{"line":42,"column":17}},{"start":{"line":42,"column":21},"end":{"line":42,"column":47}}]}},"code":["/**"," * This is the tirgger that use an object as trigger."," */","var SKIP_OLD_JOB = false;","","/**"," * The constructor of simple trigger"," */","var SimpleTrigger = function(trigger, job){","  this.nextTime = (!!trigger.start)?trigger.start:Date.now();","","  //The rec","  this.period = (!!trigger.period)?trigger.period:-1;","","  //The running count of the job, -1 means no limit","  this.count = (!!trigger.count)?trigger.count:-1;","","  this.job = job;","};","","var pro = SimpleTrigger.prototype;","","/**"," * Get the current excuteTime of rigger"," */","pro.excuteTime = function(){","  return this.nextTime;","};","","/**"," * Get the next excuteTime of the trigger, and set the trigger's excuteTime"," * @return Next excute time"," */","pro.nextExcuteTime = function(){","  var period = this.period;","","  if((this.count > 0 && this.count <= this.job.runTime) || period <= 0)","    return null;","","  this.nextTime += period;","","  if(SKIP_OLD_JOB && this.nextTime < Date.now()){","    this.nextTime += Math.floor((Date.now()-this.nextTime)/period) * period;","  }","","  return this.nextTime;","};","","/**"," * Create Simple trigger"," */","function createTrigger(trigger, job){","  return new SimpleTrigger(trigger, job);","}","","module.exports.createTrigger = createTrigger;"],"l":{"4":1,"9":1,"10":0,"13":0,"16":0,"18":0,"21":1,"26":1,"27":0,"34":1,"35":0,"37":0,"38":0,"40":0,"42":0,"43":0,"46":0,"52":1,"53":0,"56":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/client/client.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/client/client.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":1,"80":1,"81":1,"82":1,"83":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":13},"end":{"line":12,"column":27}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":10},"end":{"line":26,"column":39}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":28},"end":{"line":42,"column":39}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":29},"end":{"line":56,"column":43}}},"5":{"name":"(anonymous_5)","line":66,"loc":{"start":{"line":66,"column":27},"end":{"line":66,"column":41}}},"6":{"name":"(anonymous_6)","line":81,"loc":{"start":{"line":81,"column":26},"end":{"line":81,"column":40}}},"7":{"name":"(anonymous_7)","line":89,"loc":{"start":{"line":89,"column":31},"end":{"line":89,"column":48}}},"8":{"name":"(anonymous_8)","line":95,"loc":{"start":{"line":95,"column":10},"end":{"line":95,"column":38}}},"9":{"name":"(anonymous_9)","line":107,"loc":{"start":{"line":107,"column":9},"end":{"line":107,"column":33}}},"10":{"name":"(anonymous_10)","line":117,"loc":{"start":{"line":117,"column":10},"end":{"line":117,"column":47}}},"11":{"name":"(anonymous_11)","line":128,"loc":{"start":{"line":128,"column":9},"end":{"line":128,"column":30}}},"12":{"name":"(anonymous_12)","line":132,"loc":{"start":{"line":132,"column":5},"end":{"line":132,"column":31}}},"13":{"name":"(anonymous_13)","line":137,"loc":{"start":{"line":137,"column":7},"end":{"line":137,"column":23}}}},"statementMap":{"1":{"start":{"line":7,"column":0},"end":{"line":7,"column":56}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":43}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":37}},"4":{"start":{"line":12,"column":0},"end":{"line":23,"column":2}},"5":{"start":{"line":13,"column":1},"end":{"line":13,"column":14}},"6":{"start":{"line":14,"column":1},"end":{"line":14,"column":16}},"7":{"start":{"line":15,"column":1},"end":{"line":15,"column":21}},"8":{"start":{"line":16,"column":1},"end":{"line":16,"column":21}},"9":{"start":{"line":17,"column":1},"end":{"line":17,"column":31}},"10":{"start":{"line":18,"column":1},"end":{"line":18,"column":20}},"11":{"start":{"line":19,"column":1},"end":{"line":19,"column":17}},"12":{"start":{"line":20,"column":1},"end":{"line":20,"column":39}},"13":{"start":{"line":21,"column":1},"end":{"line":21,"column":39}},"14":{"start":{"line":22,"column":1},"end":{"line":22,"column":32}},"15":{"start":{"line":25,"column":0},"end":{"line":152,"column":2}},"16":{"start":{"line":27,"column":2},"end":{"line":27,"column":15}},"17":{"start":{"line":28,"column":2},"end":{"line":28,"column":18}},"18":{"start":{"line":30,"column":2},"end":{"line":30,"column":53}},"19":{"start":{"line":31,"column":2},"end":{"line":33,"column":5}},"20":{"start":{"line":35,"column":2},"end":{"line":35,"column":34}},"21":{"start":{"line":42,"column":2},"end":{"line":54,"column":5}},"22":{"start":{"line":43,"column":3},"end":{"line":43,"column":36}},"23":{"start":{"line":44,"column":3},"end":{"line":46,"column":4}},"24":{"start":{"line":45,"column":4},"end":{"line":45,"column":45}},"25":{"start":{"line":47,"column":3},"end":{"line":53,"column":6}},"26":{"start":{"line":56,"column":2},"end":{"line":64,"column":5}},"27":{"start":{"line":57,"column":3},"end":{"line":60,"column":4}},"28":{"start":{"line":58,"column":4},"end":{"line":58,"column":16}},"29":{"start":{"line":59,"column":4},"end":{"line":59,"column":11}},"30":{"start":{"line":62,"column":3},"end":{"line":62,"column":37}},"31":{"start":{"line":63,"column":3},"end":{"line":63,"column":8}},"32":{"start":{"line":66,"column":2},"end":{"line":79,"column":5}},"33":{"start":{"line":67,"column":3},"end":{"line":67,"column":29}},"34":{"start":{"line":68,"column":3},"end":{"line":78,"column":4}},"35":{"start":{"line":70,"column":4},"end":{"line":70,"column":40}},"36":{"start":{"line":71,"column":4},"end":{"line":71,"column":38}},"37":{"start":{"line":72,"column":4},"end":{"line":74,"column":5}},"38":{"start":{"line":73,"column":5},"end":{"line":73,"column":29}},"39":{"start":{"line":75,"column":10},"end":{"line":78,"column":4}},"40":{"start":{"line":77,"column":4},"end":{"line":77,"column":33}},"41":{"start":{"line":81,"column":2},"end":{"line":87,"column":5}},"42":{"start":{"line":82,"column":3},"end":{"line":84,"column":4}},"43":{"start":{"line":83,"column":4},"end":{"line":83,"column":12}},"44":{"start":{"line":86,"column":3},"end":{"line":86,"column":27}},"45":{"start":{"line":89,"column":2},"end":{"line":92,"column":5}},"46":{"start":{"line":90,"column":3},"end":{"line":90,"column":33}},"47":{"start":{"line":91,"column":3},"end":{"line":91,"column":22}},"48":{"start":{"line":96,"column":2},"end":{"line":96,"column":24}},"49":{"start":{"line":98,"column":2},"end":{"line":98,"column":18}},"50":{"start":{"line":99,"column":2},"end":{"line":99,"column":25}},"51":{"start":{"line":100,"column":2},"end":{"line":100,"column":31}},"52":{"start":{"line":101,"column":2},"end":{"line":101,"column":55}},"53":{"start":{"line":102,"column":2},"end":{"line":102,"column":26}},"54":{"start":{"line":103,"column":2},"end":{"line":103,"column":29}},"55":{"start":{"line":109,"column":2},"end":{"line":109,"column":18}},"56":{"start":{"line":110,"column":2},"end":{"line":110,"column":25}},"57":{"start":{"line":111,"column":2},"end":{"line":111,"column":31}},"58":{"start":{"line":112,"column":2},"end":{"line":112,"column":57}},"59":{"start":{"line":113,"column":2},"end":{"line":113,"column":29}},"60":{"start":{"line":118,"column":2},"end":{"line":118,"column":24}},"61":{"start":{"line":119,"column":2},"end":{"line":119,"column":18}},"62":{"start":{"line":120,"column":2},"end":{"line":120,"column":25}},"63":{"start":{"line":121,"column":2},"end":{"line":121,"column":31}},"64":{"start":{"line":122,"column":2},"end":{"line":122,"column":71}},"65":{"start":{"line":123,"column":2},"end":{"line":123,"column":26}},"66":{"start":{"line":124,"column":2},"end":{"line":124,"column":36}},"67":{"start":{"line":129,"column":2},"end":{"line":129,"column":31}},"68":{"start":{"line":133,"column":2},"end":{"line":133,"column":54}},"69":{"start":{"line":134,"column":2},"end":{"line":134,"column":39}},"70":{"start":{"line":138,"column":2},"end":{"line":138,"column":40}},"71":{"start":{"line":139,"column":2},"end":{"line":141,"column":3}},"72":{"start":{"line":140,"column":3},"end":{"line":140,"column":10}},"73":{"start":{"line":143,"column":2},"end":{"line":143,"column":54}},"74":{"start":{"line":144,"column":2},"end":{"line":144,"column":15}},"75":{"start":{"line":145,"column":2},"end":{"line":150,"column":3}},"76":{"start":{"line":146,"column":3},"end":{"line":146,"column":27}},"77":{"start":{"line":147,"column":3},"end":{"line":149,"column":4}},"78":{"start":{"line":148,"column":4},"end":{"line":148,"column":31}},"79":{"start":{"line":154,"column":0},"end":{"line":154,"column":21}},"80":{"start":{"line":155,"column":0},"end":{"line":155,"column":24}},"81":{"start":{"line":156,"column":0},"end":{"line":156,"column":25}},"82":{"start":{"line":157,"column":0},"end":{"line":157,"column":21}},"83":{"start":{"line":159,"column":0},"end":{"line":159,"column":24}}},"branchMap":{"1":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":7},"end":{"line":19,"column":10}},{"start":{"line":19,"column":14},"end":{"line":19,"column":16}}]},"2":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":17},"end":{"line":20,"column":32}},{"start":{"line":20,"column":36},"end":{"line":20,"column":38}}]},"3":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":17},"end":{"line":21,"column":32}},{"start":{"line":21,"column":36},"end":{"line":21,"column":38}}]},"4":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":12},"end":{"line":22,"column":22}},{"start":{"line":22,"column":26},"end":{"line":22,"column":31}}]},"5":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":3},"end":{"line":44,"column":3}},{"start":{"line":44,"column":3},"end":{"line":44,"column":3}}]},"6":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":3},"end":{"line":57,"column":3}},{"start":{"line":57,"column":3},"end":{"line":57,"column":3}}]},"7":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":3},"end":{"line":68,"column":3}},{"start":{"line":68,"column":3},"end":{"line":68,"column":3}}]},"8":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":4},"end":{"line":72,"column":4}},{"start":{"line":72,"column":4},"end":{"line":72,"column":4}}]},"9":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":8},"end":{"line":72,"column":10}},{"start":{"line":72,"column":14},"end":{"line":72,"column":38}}]},"10":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":10},"end":{"line":75,"column":10}},{"start":{"line":75,"column":10},"end":{"line":75,"column":10}}]},"11":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":3},"end":{"line":82,"column":3}},{"start":{"line":82,"column":3},"end":{"line":82,"column":3}}]},"12":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":11}},{"start":{"line":98,"column":15},"end":{"line":98,"column":17}}]},"13":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":8},"end":{"line":109,"column":11}},{"start":{"line":109,"column":15},"end":{"line":109,"column":17}}]},"14":{"line":119,"type":"binary-expr","locations":[{"start":{"line":119,"column":8},"end":{"line":119,"column":11}},{"start":{"line":119,"column":15},"end":{"line":119,"column":17}}]},"15":{"line":133,"type":"binary-expr","locations":[{"start":{"line":133,"column":26},"end":{"line":133,"column":47}},{"start":{"line":133,"column":51},"end":{"line":133,"column":53}}]},"16":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":2},"end":{"line":139,"column":2}},{"start":{"line":139,"column":2},"end":{"line":139,"column":2}}]},"17":{"line":139,"type":"binary-expr","locations":[{"start":{"line":139,"column":6},"end":{"line":139,"column":16}},{"start":{"line":139,"column":20},"end":{"line":139,"column":37}}]},"18":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":3},"end":{"line":147,"column":3}},{"start":{"line":147,"column":3},"end":{"line":147,"column":3}}]}},"code":["/*!"," * Pomelo -- commandLine Client"," * Copyright(c) 2015 fantasyni <fantasyni@163.com>"," * MIT Licensed"," */","","var MqttClient = require('../protocol/mqtt/mqttClient');","var protocol = require('../util/protocol');","// var io = require('socket.io-client');","var utils = require('../util/utils');","","var Client = function(opt) {","\tthis.id = \"\";","\tthis.reqId = 1;","\tthis.callbacks = {};","\tthis.listeners = {};","\tthis.state = Client.ST_INITED;","\tthis.socket = null;","\topt = opt || {};","\tthis.username = opt['username'] || \"\";","\tthis.password = opt['password'] || \"\";","\tthis.md5 = opt['md5'] || false;","};","","Client.prototype = {","\tconnect: function(id, host, port, cb) {","\t\tthis.id = id;","\t\tvar self = this;","","\t\tconsole.log('try to connect ' + host + ':' + port);","\t\tthis.socket = new MqttClient({","\t\t\tid: id","\t\t});","","\t\tthis.socket.connect(host, port);","","\t\t// this.socket = io.connect('http://' + host + ':' + port, {","\t\t// \t'force new connection': true,","\t\t// \t'reconnect': false","\t\t// });","","\t\tthis.socket.on('connect', function() {","\t\t\tself.state = Client.ST_CONNECTED;","\t\t\tif (self.md5) {","\t\t\t\tself.password = utils.md5(self.password);","\t\t\t}","\t\t\tself.doSend('register', {","\t\t\t\ttype: \"client\",","\t\t\t\tid: id,","\t\t\t\tusername: self.username,","\t\t\t\tpassword: self.password,","\t\t\t\tmd5: self.md5","\t\t\t});","\t\t});","","\t\tthis.socket.on('register', function(res) {","\t\t\tif (res.code !== protocol.PRO_OK) {","\t\t\t\tcb(res.msg);","\t\t\t\treturn;","\t\t\t}","","\t\t\tself.state = Client.ST_REGISTERED;","\t\t\tcb();","\t\t});","","\t\tthis.socket.on('client', function(msg) {","\t\t\tmsg = protocol.parse(msg);","\t\t\tif (msg.respId) {","\t\t\t\t// response for request","\t\t\t\tvar cb = self.callbacks[msg.respId];","\t\t\t\tdelete self.callbacks[msg.respId];","\t\t\t\tif (cb && typeof cb === 'function') {","\t\t\t\t\tcb(msg.error, msg.body);","\t\t\t\t}","\t\t\t} else if (msg.moduleId) {","\t\t\t\t// notify","\t\t\t\tself.emit(msg.moduleId, msg);","\t\t\t}","\t\t});","","\t\tthis.socket.on('error', function(err) {","\t\t\tif (self.state < Client.ST_CONNECTED) {","\t\t\t\tcb(err);","\t\t\t}","","\t\t\tself.emit('error', err);","\t\t});","","\t\tthis.socket.on('disconnect', function(reason) {","\t\t\tthis.state = Client.ST_CLOSED;","\t\t\tself.emit('close');","\t\t});","\t},","","\trequest: function(moduleId, msg, cb) {","\t\tvar id = this.reqId++;","\t\t// something dirty: attach current client id into msg","\t\tmsg = msg || {};","\t\tmsg.clientId = this.id;","\t\tmsg.username = this.username;","\t\tvar req = protocol.composeRequest(id, moduleId, msg);","\t\tthis.callbacks[id] = cb;","\t\tthis.doSend('client', req);","\t\t// this.socket.emit('client', req);","\t},","","\tnotify: function(moduleId, msg) {","\t\t// something dirty: attach current client id into msg","\t\tmsg = msg || {};","\t\tmsg.clientId = this.id;","\t\tmsg.username = this.username;","\t\tvar req = protocol.composeRequest(null, moduleId, msg);","\t\tthis.doSend('client', req);","\t\t// this.socket.emit('client', req);","\t},","","\tcommand: function(command, moduleId, msg, cb) {","\t\tvar id = this.reqId++;","\t\tmsg = msg || {};","\t\tmsg.clientId = this.id;","\t\tmsg.username = this.username;","\t\tvar commandReq = protocol.composeCommand(id, command, moduleId, msg);","\t\tthis.callbacks[id] = cb;","\t\tthis.doSend('client', commandReq);","\t\t// this.socket.emit('client', commandReq);","\t},","","\tdoSend: function(topic, msg) {","\t\tthis.socket.send(topic, msg);","\t},","","\ton: function(event, listener) {","\t\tthis.listeners[event] = this.listeners[event] || [];","\t\tthis.listeners[event].push(listener);","\t},","","\temit: function(event) {","\t\tvar listeners = this.listeners[event];","\t\tif (!listeners || !listeners.length) {","\t\t\treturn;","\t\t}","","\t\tvar args = Array.prototype.slice.call(arguments, 1);","\t\tvar listener;","\t\tfor (var i = 0, l = listeners.length; i < l; i++) {","\t\t\tlistener = listeners[i];","\t\t\tif (typeof listener === 'function') {","\t\t\t\tlistener.apply(null, args);","\t\t\t}","\t\t}","\t}","};","","Client.ST_INITED = 1;","Client.ST_CONNECTED = 2;","Client.ST_REGISTERED = 3;","Client.ST_CLOSED = 4;","","module.exports = Client;"],"l":{"7":1,"8":1,"10":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"25":1,"27":0,"28":0,"30":0,"31":0,"35":0,"42":0,"43":0,"44":0,"45":0,"47":0,"56":0,"57":0,"58":0,"59":0,"62":0,"63":0,"66":0,"67":0,"68":0,"70":0,"71":0,"72":0,"73":0,"75":0,"77":0,"81":0,"82":0,"83":0,"86":0,"89":0,"90":0,"91":0,"96":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"109":0,"110":0,"111":0,"112":0,"113":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"129":0,"133":0,"134":0,"138":0,"139":0,"140":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"154":1,"155":1,"156":1,"157":1,"159":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/monitorLog.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/monitorLog.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":1,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":17},"end":{"line":12,"column":32}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":13},"end":{"line":26,"column":28}}},"3":{"name":"(anonymous_3)","line":40,"loc":{"start":{"line":40,"column":34},"end":{"line":40,"column":59}}},"4":{"name":"(anonymous_4)","line":47,"loc":{"start":{"line":47,"column":27},"end":{"line":47,"column":43}}},"5":{"name":"(anonymous_5)","line":60,"loc":{"start":{"line":60,"column":33},"end":{"line":60,"column":58}}},"6":{"name":"(anonymous_6)","line":61,"loc":{"start":{"line":61,"column":59},"end":{"line":61,"column":78}}},"7":{"name":"(anonymous_7)","line":71,"loc":{"start":{"line":71,"column":16},"end":{"line":71,"column":46}}},"8":{"name":"(anonymous_8)","line":78,"loc":{"start":{"line":78,"column":44},"end":{"line":78,"column":68}}},"9":{"name":"(anonymous_9)","line":108,"loc":{"start":{"line":108,"column":21},"end":{"line":108,"column":49}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":76}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":41}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":27}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":30}},"5":{"start":{"line":12,"column":0},"end":{"line":14,"column":2}},"6":{"start":{"line":13,"column":1},"end":{"line":13,"column":25}},"7":{"start":{"line":16,"column":0},"end":{"line":16,"column":39}},"8":{"start":{"line":26,"column":0},"end":{"line":30,"column":2}},"9":{"start":{"line":27,"column":1},"end":{"line":27,"column":19}},"10":{"start":{"line":28,"column":1},"end":{"line":28,"column":23}},"11":{"start":{"line":29,"column":1},"end":{"line":29,"column":51}},"12":{"start":{"line":40,"column":0},"end":{"line":50,"column":2}},"13":{"start":{"line":41,"column":1},"end":{"line":44,"column":2}},"14":{"start":{"line":42,"column":2},"end":{"line":42,"column":47}},"15":{"start":{"line":43,"column":2},"end":{"line":43,"column":9}},"16":{"start":{"line":46,"column":1},"end":{"line":46,"column":25}},"17":{"start":{"line":47,"column":1},"end":{"line":49,"column":4}},"18":{"start":{"line":48,"column":2},"end":{"line":48,"column":45}},"19":{"start":{"line":60,"column":0},"end":{"line":68,"column":2}},"20":{"start":{"line":61,"column":1},"end":{"line":67,"column":4}},"21":{"start":{"line":62,"column":2},"end":{"line":65,"column":3}},"22":{"start":{"line":63,"column":3},"end":{"line":63,"column":52}},"23":{"start":{"line":64,"column":3},"end":{"line":64,"column":10}},"24":{"start":{"line":66,"column":2},"end":{"line":66,"column":16}},"25":{"start":{"line":71,"column":0},"end":{"line":106,"column":2}},"26":{"start":{"line":72,"column":1},"end":{"line":72,"column":25}},"27":{"start":{"line":73,"column":1},"end":{"line":73,"column":27}},"28":{"start":{"line":74,"column":1},"end":{"line":74,"column":29}},"29":{"start":{"line":75,"column":1},"end":{"line":75,"column":67}},"30":{"start":{"line":77,"column":1},"end":{"line":77,"column":18}},"31":{"start":{"line":78,"column":1},"end":{"line":105,"column":4}},"32":{"start":{"line":79,"column":2},"end":{"line":79,"column":18}},"33":{"start":{"line":80,"column":2},"end":{"line":80,"column":57}},"34":{"start":{"line":82,"column":2},"end":{"line":84,"column":3}},"35":{"start":{"line":83,"column":3},"end":{"line":83,"column":26}},"36":{"start":{"line":86,"column":2},"end":{"line":86,"column":30}},"37":{"start":{"line":87,"column":2},"end":{"line":102,"column":3}},"38":{"start":{"line":88,"column":3},"end":{"line":88,"column":16}},"39":{"start":{"line":89,"column":3},"end":{"line":89,"column":12}},"40":{"start":{"line":90,"column":3},"end":{"line":95,"column":4}},"41":{"start":{"line":91,"column":4},"end":{"line":91,"column":33}},"42":{"start":{"line":93,"column":4},"end":{"line":93,"column":54}},"43":{"start":{"line":94,"column":4},"end":{"line":94,"column":13}},"44":{"start":{"line":96,"column":3},"end":{"line":96,"column":24}},"45":{"start":{"line":97,"column":3},"end":{"line":97,"column":42}},"46":{"start":{"line":98,"column":3},"end":{"line":98,"column":27}},"47":{"start":{"line":99,"column":3},"end":{"line":99,"column":32}},"48":{"start":{"line":100,"column":3},"end":{"line":100,"column":26}},"49":{"start":{"line":101,"column":3},"end":{"line":101,"column":21}},"50":{"start":{"line":104,"column":2},"end":{"line":104,"column":48}},"51":{"start":{"line":108,"column":0},"end":{"line":110,"column":2}},"52":{"start":{"line":109,"column":1},"end":{"line":109,"column":42}}},"branchMap":{"1":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":12}},{"start":{"line":27,"column":16},"end":{"line":27,"column":18}}]},"2":{"line":29,"type":"binary-expr","locations":[{"start":{"line":29,"column":17},"end":{"line":29,"column":30}},{"start":{"line":29,"column":34},"end":{"line":29,"column":50}}]},"3":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},{"start":{"line":41,"column":1},"end":{"line":41,"column":1}}]},"4":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":2},"end":{"line":62,"column":2}},{"start":{"line":62,"column":2},"end":{"line":62,"column":2}}]},"5":{"line":97,"type":"binary-expr","locations":[{"start":{"line":97,"column":15},"end":{"line":97,"column":25}},{"start":{"line":97,"column":29},"end":{"line":97,"column":41}}]}},"code":["/*!"," * Pomelo -- consoleModule monitorLog"," * Copyright(c) 2012 fantasyni <fantasyni@163.com>"," * MIT Licensed"," */","var logger = require('pomelo-logger').getLogger('pomelo-admin', __filename);","var exec = require('child_process').exec;","var path = require('path');","","var DEFAULT_INTERVAL = 5 * 60;\t\t// in second","","module.exports = function(opts) {","\treturn new Module(opts);","};","","module.exports.moduleId = 'monitorLog';","","/**"," * Initialize a new 'Module' with the given 'opts'"," *"," * @class Module"," * @constructor"," * @param {object} opts"," * @api public"," */","var Module = function(opts) {","\topts = opts || {};","\tthis.root = opts.path;","\tthis.interval = opts.interval || DEFAULT_INTERVAL;","};",""," /**"," * collect monitor data from monitor"," *"," * @param {Object} agent monitorAgent object"," * @param {Object} msg client message"," * @param {Function} cb callback function"," * @api public"," */","Module.prototype.monitorHandler = function(agent, msg, cb) {","\tif(!msg.logfile) {","\t\tcb(new Error('logfile should not be empty'));","\t\treturn;","\t}","","\tvar serverId = agent.id;","\tfetchLogs(this.root, msg, function (data) {","\t\tcb(null, {serverId: serverId, body: data});","\t});","};","","/**"," * Handle client request"," *"," * @param {Object} agent masterAgent object"," * @param {Object} msg client message"," * @param {Function} cb callback function"," * @api public"," */","Module.prototype.clientHandler = function(agent, msg, cb) {","\tagent.request(msg.serverId, module.exports.moduleId, msg, function(err, res) {","\t\tif(err) {","\t\t\tlogger.error('fail to run log for ' + err.stack);","\t\t\treturn;","\t\t}","\t\tcb(null, res);","\t});","};","","//get the latest logs","var fetchLogs = function(root, msg, callback) {","\tvar number = msg.number;","\tvar logfile = msg.logfile;","\tvar serverId = msg.serverId;","\tvar filePath = path.join(root, getLogFileName(logfile, serverId));","","\tvar endLogs = [];","\texec('tail -n ' + number + ' ' + filePath, function(error, output) {","\t\tvar endOut = [];","\t\toutput = output.replace(/^\\s+|\\s+$/g, \"\").split(/\\s+/);","","\t\tfor(var i=5; i<output.length; i+=6) {","\t\t\tendOut.push(output[i]);","\t\t}","","\t\tvar endLength=endOut.length;","\t\tfor(var j=0; j<endLength; j++) {","\t\t\tvar map = {};","\t\t\tvar json;","\t\t\ttry{","\t\t\t\tjson = JSON.parse(endOut[j]);","\t\t\t} catch(e) {","\t\t\t\tlogger.error('the log cannot parsed to json, '+e);","\t\t\t\tcontinue;","\t\t\t}","\t\t\tmap.time = json.time;","\t\t\tmap.route = json.route || json.service;","\t\t\tmap.serverId = serverId;","\t\t\tmap.timeUsed = json.timeUsed;","\t\t\tmap.params = endOut[j];","\t\t\tendLogs.push(map);","\t\t}","","\t\tcallback({logfile:logfile,dataArray:endLogs});","\t});","};","","var getLogFileName = function(logfile, serverId) {","\treturn logfile + '-' + serverId + '.log';","};"],"l":{"6":1,"7":1,"8":1,"10":1,"12":1,"13":0,"16":1,"26":1,"27":0,"28":0,"29":0,"40":1,"41":0,"42":0,"43":0,"46":0,"47":0,"48":0,"60":1,"61":0,"62":0,"63":0,"64":0,"66":0,"71":1,"72":0,"73":0,"74":0,"75":0,"77":0,"78":0,"79":0,"80":0,"82":0,"83":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"93":0,"94":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"104":0,"108":1,"109":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/nodeInfo.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/nodeInfo.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":17},"end":{"line":12,"column":32}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":13},"end":{"line":18,"column":28}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":34},"end":{"line":25,"column":59}}},"4":{"name":"(anonymous_4)","line":32,"loc":{"start":{"line":32,"column":37},"end":{"line":32,"column":58}}},"5":{"name":"(anonymous_5)","line":38,"loc":{"start":{"line":38,"column":33},"end":{"line":38,"column":58}}},"6":{"name":"(anonymous_6)","line":54,"loc":{"start":{"line":54,"column":33},"end":{"line":54,"column":58}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":76}},"3":{"start":{"line":9,"column":0},"end":{"line":9,"column":30}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":23}},"5":{"start":{"line":12,"column":0},"end":{"line":14,"column":2}},"6":{"start":{"line":13,"column":1},"end":{"line":13,"column":25}},"7":{"start":{"line":16,"column":0},"end":{"line":16,"column":37}},"8":{"start":{"line":18,"column":0},"end":{"line":23,"column":2}},"9":{"start":{"line":19,"column":1},"end":{"line":19,"column":19}},"10":{"start":{"line":20,"column":1},"end":{"line":20,"column":33}},"11":{"start":{"line":21,"column":1},"end":{"line":21,"column":51}},"12":{"start":{"line":22,"column":1},"end":{"line":22,"column":42}},"13":{"start":{"line":25,"column":0},"end":{"line":36,"column":2}},"14":{"start":{"line":26,"column":1},"end":{"line":26,"column":25}},"15":{"start":{"line":27,"column":1},"end":{"line":27,"column":23}},"16":{"start":{"line":28,"column":1},"end":{"line":31,"column":3}},"17":{"start":{"line":32,"column":1},"end":{"line":34,"column":4}},"18":{"start":{"line":33,"column":2},"end":{"line":33,"column":74}},"19":{"start":{"line":38,"column":0},"end":{"line":52,"column":2}},"20":{"start":{"line":39,"column":1},"end":{"line":42,"column":2}},"21":{"start":{"line":40,"column":2},"end":{"line":40,"column":43}},"22":{"start":{"line":41,"column":2},"end":{"line":41,"column":9}},"23":{"start":{"line":44,"column":1},"end":{"line":44,"column":19}},"24":{"start":{"line":45,"column":1},"end":{"line":45,"column":47}},"25":{"start":{"line":46,"column":1},"end":{"line":49,"column":2}},"26":{"start":{"line":47,"column":2},"end":{"line":47,"column":12}},"27":{"start":{"line":48,"column":2},"end":{"line":48,"column":43}},"28":{"start":{"line":51,"column":1},"end":{"line":51,"column":27}},"29":{"start":{"line":54,"column":0},"end":{"line":56,"column":2}},"30":{"start":{"line":55,"column":1},"end":{"line":55,"column":52}}},"branchMap":{"1":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":12}},{"start":{"line":19,"column":16},"end":{"line":19,"column":18}}]},"2":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":13},"end":{"line":20,"column":22}},{"start":{"line":20,"column":26},"end":{"line":20,"column":32}}]},"3":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":17},"end":{"line":21,"column":30}},{"start":{"line":21,"column":34},"end":{"line":21,"column":50}}]},"4":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":14},"end":{"line":22,"column":24}},{"start":{"line":22,"column":28},"end":{"line":22,"column":41}}]},"5":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},{"start":{"line":39,"column":1},"end":{"line":39,"column":1}}]},"6":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},{"start":{"line":46,"column":1},"end":{"line":46,"column":1}}]},"7":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":10},"end":{"line":55,"column":44}},{"start":{"line":55,"column":48},"end":{"line":55,"column":50}}]}},"code":["/*!"," * Pomelo -- consoleModule nodeInfo processInfo"," * Copyright(c) 2012 fantasyni <fantasyni@163.com>"," * MIT Licensed"," */","var monitor = require('pomelo-monitor');","var logger = require('pomelo-logger').getLogger('pomelo-admin', __filename);","","var DEFAULT_INTERVAL = 5 * 60;\t\t// in second","var DEFAULT_DELAY = 10;\t\t\t\t\t\t// in second","","module.exports = function(opts) {","\treturn new Module(opts);","};","","module.exports.moduleId = 'nodeInfo';","","var Module = function(opts) {","\topts = opts || {};","\tthis.type = opts.type || 'pull';","\tthis.interval = opts.interval || DEFAULT_INTERVAL;","\tthis.delay = opts.delay || DEFAULT_DELAY;","};","","Module.prototype.monitorHandler = function(agent, msg, cb) {","\tvar serverId = agent.id;","\tvar pid = process.pid;","\tvar params = {","\t\tserverId: serverId,","\t\tpid: pid","\t};","\tmonitor.psmonitor.getPsInfo(params, function (err, data) {","\t\tagent.notify(module.exports.moduleId, {serverId: agent.id, body: data});","\t});","","};","","Module.prototype.masterHandler = function(agent, msg, cb) {","\tif(!msg) {","\t\tagent.notifyAll(module.exports.moduleId);","\t\treturn;","\t}","","\tvar body=msg.body;","\tvar data = agent.get(module.exports.moduleId);","\tif(!data) {","\t\tdata = {};","\t\tagent.set(module.exports.moduleId, data);","\t}","","\tdata[msg.serverId] = body;","};","","Module.prototype.clientHandler = function(agent, msg, cb) {","\tcb(null, agent.get(module.exports.moduleId) || {});","};",""],"l":{"6":1,"7":1,"9":1,"10":1,"12":1,"13":0,"16":1,"18":1,"19":0,"20":0,"21":0,"22":0,"25":1,"26":0,"27":0,"28":0,"32":0,"33":0,"38":1,"39":0,"40":0,"41":0,"44":0,"45":0,"46":0,"47":0,"48":0,"51":0,"54":1,"55":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-monitor/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-monitor/index.js","s":{"1":1,"2":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":57}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":57}}},"branchMap":{},"code":["module.exports.psmonitor=require('./lib/processMonitor');","module.exports.sysmonitor=require('./lib/systemMonitor');",""],"l":{"1":1,"2":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-monitor/lib/processMonitor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-monitor/lib/processMonitor.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"getPsInfo","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":36}}},"2":{"name":"(anonymous_2)","line":28,"loc":{"start":{"line":28,"column":11},"end":{"line":28,"column":33}}},"3":{"name":"format","line":51,"loc":{"start":{"line":51,"column":0},"end":{"line":51,"column":33}}},"4":{"name":"(anonymous_4)","line":77,"loc":{"start":{"line":77,"column":27},"end":{"line":77,"column":49}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":7,"column":35}},"2":{"start":{"line":13,"column":0},"end":{"line":13,"column":37}},"3":{"start":{"line":23,"column":0},"end":{"line":40,"column":1}},"4":{"start":{"line":24,"column":1},"end":{"line":24,"column":44}},"5":{"start":{"line":24,"column":37},"end":{"line":24,"column":44}},"6":{"start":{"line":25,"column":1},"end":{"line":25,"column":21}},"7":{"start":{"line":26,"column":1},"end":{"line":26,"column":57}},"8":{"start":{"line":28,"column":1},"end":{"line":39,"column":4}},"9":{"start":{"line":29,"column":2},"end":{"line":37,"column":3}},"10":{"start":{"line":30,"column":3},"end":{"line":34,"column":4}},"11":{"start":{"line":31,"column":4},"end":{"line":31,"column":40}},"12":{"start":{"line":33,"column":4},"end":{"line":33,"column":52}},"13":{"start":{"line":35,"column":3},"end":{"line":35,"column":23}},"14":{"start":{"line":36,"column":3},"end":{"line":36,"column":10}},"15":{"start":{"line":38,"column":4},"end":{"line":38,"column":36}},"16":{"start":{"line":51,"column":0},"end":{"line":94,"column":1}},"17":{"start":{"line":52,"column":1},"end":{"line":52,"column":40}},"18":{"start":{"line":53,"column":1},"end":{"line":53,"column":70}},"19":{"start":{"line":54,"column":1},"end":{"line":54,"column":24}},"20":{"start":{"line":55,"column":1},"end":{"line":59,"column":2}},"21":{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},"22":{"start":{"line":57,"column":3},"end":{"line":57,"column":35}},"23":{"start":{"line":60,"column":1},"end":{"line":60,"column":13}},"24":{"start":{"line":61,"column":1},"end":{"line":61,"column":16}},"25":{"start":{"line":62,"column":1},"end":{"line":62,"column":30}},"26":{"start":{"line":63,"column":1},"end":{"line":63,"column":43}},"27":{"start":{"line":64,"column":1},"end":{"line":64,"column":30}},"28":{"start":{"line":65,"column":1},"end":{"line":65,"column":30}},"29":{"start":{"line":66,"column":1},"end":{"line":66,"column":30}},"30":{"start":{"line":67,"column":1},"end":{"line":67,"column":27}},"31":{"start":{"line":68,"column":1},"end":{"line":68,"column":27}},"32":{"start":{"line":69,"column":1},"end":{"line":69,"column":20}},"33":{"start":{"line":70,"column":1},"end":{"line":76,"column":2}},"34":{"start":{"line":71,"column":2},"end":{"line":71,"column":13}},"35":{"start":{"line":72,"column":2},"end":{"line":72,"column":13}},"36":{"start":{"line":73,"column":2},"end":{"line":73,"column":13}},"37":{"start":{"line":74,"column":2},"end":{"line":74,"column":15}},"38":{"start":{"line":75,"column":2},"end":{"line":75,"column":9}},"39":{"start":{"line":77,"column":1},"end":{"line":93,"column":4}},"40":{"start":{"line":78,"column":2},"end":{"line":81,"column":3}},"41":{"start":{"line":79,"column":3},"end":{"line":79,"column":60}},"42":{"start":{"line":80,"column":3},"end":{"line":80,"column":10}},"43":{"start":{"line":82,"column":2},"end":{"line":82,"column":73}},"44":{"start":{"line":83,"column":2},"end":{"line":87,"column":3}},"45":{"start":{"line":84,"column":4},"end":{"line":86,"column":4}},"46":{"start":{"line":85,"column":4},"end":{"line":85,"column":36}},"47":{"start":{"line":88,"column":2},"end":{"line":88,"column":28}},"48":{"start":{"line":89,"column":2},"end":{"line":89,"column":28}},"49":{"start":{"line":90,"column":2},"end":{"line":90,"column":28}},"50":{"start":{"line":92,"column":2},"end":{"line":92,"column":15}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},{"start":{"line":24,"column":1},"end":{"line":24,"column":1}}]},"2":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"3":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":3},"end":{"line":30,"column":3}},{"start":{"line":30,"column":3},"end":{"line":30,"column":3}}]},"4":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":2},"end":{"line":56,"column":2}},{"start":{"line":56,"column":2},"end":{"line":56,"column":2}}]},"5":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},{"start":{"line":70,"column":1},"end":{"line":70,"column":1}}]},"6":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":2},"end":{"line":78,"column":2}},{"start":{"line":78,"column":2},"end":{"line":78,"column":2}}]},"7":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":4},"end":{"line":84,"column":4}},{"start":{"line":84,"column":4},"end":{"line":84,"column":4}}]}},"code":["/**"," *Module dependencies"," */","","var exec = require('child_process').exec","\t, spawn = require('child_process').spawn","\t, util = require('../utils/util');","","/**"," * Expose 'getPsInfo' constructor"," */","","module.exports.getPsInfo = getPsInfo;","","/**"," * get the process information by command 'ps auxw | grep serverId | grep pid'"," *"," * @param {Object} param"," * @param {Function} callback"," * @api public"," */","","function getPsInfo(param, callback) { ","\tif (process.platform === 'windows') return;","\tvar pid = param.pid;","\tvar cmd = \"ps auxw | grep \" + pid + \" | grep -v 'grep'\";","\t//var cmd = \"ps auxw | grep -E '.+?\\\\s+\" + pid + \"\\\\s+'\"  ;","\texec(cmd, function(err, output) {","\t\tif (!!err) {","\t\t\tif (err.code === 1) {","\t\t\t\tconsole.log('the content is null!');","\t\t\t} else {","\t\t\t\tconsole.error('getPsInfo failed! ' + err.stack);","\t\t\t}","\t\t\tcallback(err, null);","\t\t\treturn;","\t\t} ","    format(param, output, callback);","\t});","};","","/**"," * convert serverInfo to required format, and the callback will handle the serverInfo "," *"," * @param {Object} param, contains serverId etc"," * @param {String} data, the output if the command 'ps'"," * @param {Function} cb"," * @api private"," */","","function format(param, data, cb) {","\tvar time = util.formatTime(new Date());","\tvar outArray = data.toString().replace(/^\\s+|\\s+$/g,\"\").split(/\\s+/);","\tvar outValueArray = [];","\tfor (var i = 0; i < outArray.length; i++) {","\t\tif ((!isNaN(outArray[i]))) {","\t\t\toutValueArray.push(outArray[i]);","\t\t}","\t}","\tvar ps = {};","\tps.time = time;","\tps.serverId = param.serverId;","\tps.serverType = ps.serverId.split('-')[0];","\tvar pid = ps.pid = param.pid;","\tps.cpuAvg = outValueArray[1];","\tps.memAvg = outValueArray[2];","\tps.vsz = outValueArray[3];","\tps.rss = outValueArray[4];","\toutValueArray = [];","\tif (process.platform === 'darwin') {","\t\tps.usr = 0;","\t\tps.sys = 0;","\t\tps.gue = 0;","\t\tcb(null, ps);","\t\treturn;","\t}","\texec('pidstat -p ' + pid, function(err, output) {","\t\tif (!!err) {","\t\t\tconsole.error('the command pidstat failed! ', err.stack);","\t\t\treturn;","\t\t}","\t\tvar outArray = output.toString().replace(/^\\s+|\\s+$/g,\"\").split(/\\s+/);","\t\tfor (var i = 0; i < outArray.length; i++) {","\t\t  if ((!isNaN(outArray[i]))) {","\t\t\t\toutValueArray.push(outArray[i]);","\t\t\t}","\t\t}","\t\tps.usr = outValueArray[1];","\t\tps.sys = outValueArray[2];","\t\tps.gue = outValueArray[3];","","\t\tcb(null, ps);","\t});","};","",""],"l":{"5":1,"13":1,"23":1,"24":0,"25":0,"26":0,"28":0,"29":0,"30":0,"31":0,"33":0,"35":0,"36":0,"38":0,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"77":0,"78":0,"79":0,"80":0,"82":0,"83":0,"84":0,"85":0,"88":0,"89":0,"90":0,"92":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-monitor/utils/util.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-monitor/utils/util.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"formatTime","line":4,"loc":{"start":{"line":4,"column":0},"end":{"line":4,"column":26}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":11,"column":1}},"2":{"start":{"line":5,"column":1},"end":{"line":5,"column":28}},"3":{"start":{"line":6,"column":1},"end":{"line":6,"column":29}},"4":{"start":{"line":7,"column":1},"end":{"line":7,"column":24}},"5":{"start":{"line":8,"column":1},"end":{"line":8,"column":40}},"6":{"start":{"line":9,"column":1},"end":{"line":9,"column":51}},"7":{"start":{"line":10,"column":2},"end":{"line":10,"column":17}},"8":{"start":{"line":12,"column":0},"end":{"line":12,"column":39}}},"branchMap":{},"code":["/**"," * convert Date as  yyyy-mm-dd hh:mm:ss"," */","function formatTime(date) {","\tvar n = date.getFullYear(); ","\tvar y = date.getMonth() + 1;","\tvar r = date.getDate(); ","\tvar mytime = date.toLocaleTimeString(); ","\tvar mytimes = n+ \"-\" + y + \"-\" + r + \" \" + mytime;","  return mytimes;","}","module.exports.formatTime = formatTime;",""],"l":{"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"12":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-monitor/lib/systemMonitor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-monitor/lib/systemMonitor.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":0,"43":1,"44":0,"45":1,"46":0,"47":1,"48":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"getSysInfo","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":30}}},"2":{"name":"(anonymous_2)","line":27,"loc":{"start":{"line":27,"column":18},"end":{"line":27,"column":40}}},"3":{"name":"format","line":45,"loc":{"start":{"line":45,"column":0},"end":{"line":45,"column":22}}},"4":{"name":"getBasicInfo","line":85,"loc":{"start":{"line":85,"column":0},"end":{"line":85,"column":24}}},"5":{"name":"(anonymous_5)","line":115,"loc":{"start":{"line":115,"column":16},"end":{"line":115,"column":26}}},"6":{"name":"(anonymous_6)","line":117,"loc":{"start":{"line":117,"column":12},"end":{"line":117,"column":22}}},"7":{"name":"(anonymous_7)","line":119,"loc":{"start":{"line":119,"column":16},"end":{"line":119,"column":26}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":7,"column":40}},"2":{"start":{"line":9,"column":0},"end":{"line":9,"column":14}},"3":{"start":{"line":15,"column":0},"end":{"line":15,"column":39}},"4":{"start":{"line":24,"column":0},"end":{"line":36,"column":1}},"5":{"start":{"line":25,"column":1},"end":{"line":25,"column":44}},"6":{"start":{"line":25,"column":37},"end":{"line":25,"column":44}},"7":{"start":{"line":26,"column":2},"end":{"line":26,"column":30}},"8":{"start":{"line":27,"column":2},"end":{"line":35,"column":5}},"9":{"start":{"line":28,"column":2},"end":{"line":34,"column":3}},"10":{"start":{"line":29,"column":3},"end":{"line":29,"column":52}},"11":{"start":{"line":30,"column":3},"end":{"line":30,"column":25}},"12":{"start":{"line":32,"column":3},"end":{"line":32,"column":34}},"13":{"start":{"line":33,"column":3},"end":{"line":33,"column":26}},"14":{"start":{"line":45,"column":0},"end":{"line":76,"column":1}},"15":{"start":{"line":46,"column":1},"end":{"line":46,"column":40}},"16":{"start":{"line":47,"column":2},"end":{"line":47,"column":75}},"17":{"start":{"line":48,"column":2},"end":{"line":48,"column":25}},"18":{"start":{"line":49,"column":2},"end":{"line":54,"column":3}},"19":{"start":{"line":50,"column":4},"end":{"line":53,"column":5}},"20":{"start":{"line":51,"column":6},"end":{"line":51,"column":59}},"21":{"start":{"line":52,"column":6},"end":{"line":52,"column":16}},"22":{"start":{"line":55,"column":2},"end":{"line":75,"column":3}},"23":{"start":{"line":56,"column":4},"end":{"line":73,"column":5}},"24":{"start":{"line":74,"column":4},"end":{"line":74,"column":23}},"25":{"start":{"line":85,"column":0},"end":{"line":91,"column":1}},"26":{"start":{"line":86,"column":1},"end":{"line":86,"column":17}},"27":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"28":{"start":{"line":88,"column":4},"end":{"line":88,"column":30}},"29":{"start":{"line":90,"column":1},"end":{"line":90,"column":15}},"30":{"start":{"line":93,"column":0},"end":{"line":93,"column":28}},"31":{"start":{"line":95,"column":0},"end":{"line":95,"column":20}},"32":{"start":{"line":97,"column":0},"end":{"line":97,"column":28}},"33":{"start":{"line":99,"column":0},"end":{"line":99,"column":20}},"34":{"start":{"line":101,"column":0},"end":{"line":101,"column":26}},"35":{"start":{"line":103,"column":0},"end":{"line":103,"column":24}},"36":{"start":{"line":105,"column":0},"end":{"line":105,"column":26}},"37":{"start":{"line":107,"column":0},"end":{"line":107,"column":28}},"38":{"start":{"line":109,"column":0},"end":{"line":109,"column":26}},"39":{"start":{"line":111,"column":0},"end":{"line":111,"column":20}},"40":{"start":{"line":113,"column":0},"end":{"line":113,"column":46}},"41":{"start":{"line":115,"column":0},"end":{"line":115,"column":52}},"42":{"start":{"line":115,"column":27},"end":{"line":115,"column":50}},"43":{"start":{"line":117,"column":0},"end":{"line":117,"column":44}},"44":{"start":{"line":117,"column":23},"end":{"line":117,"column":42}},"45":{"start":{"line":119,"column":0},"end":{"line":119,"column":52}},"46":{"start":{"line":119,"column":27},"end":{"line":119,"column":50}},"47":{"start":{"line":121,"column":0},"end":{"line":121,"column":39}},"48":{"start":{"line":123,"column":0},"end":{"line":123,"column":29}}},"branchMap":{"1":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},{"start":{"line":25,"column":1},"end":{"line":25,"column":1}}]},"2":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":2},"end":{"line":28,"column":2}},{"start":{"line":28,"column":2},"end":{"line":28,"column":2}}]},"3":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":4},"end":{"line":50,"column":4}},{"start":{"line":50,"column":4},"end":{"line":50,"column":4}}]},"4":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":2},"end":{"line":55,"column":2}},{"start":{"line":55,"column":2},"end":{"line":55,"column":2}}]}},"code":["/**"," * Module dependencies"," */","","var os = require('os')","\t, util = require('../utils/util')","\t, exec = require('child_process').exec;","","var info = {};","","/*"," * Expose 'getSysInfo' constructor"," */","","module.exports.getSysInfo = getSysInfo;","","/**"," * get information of operating-system"," *"," * @param {Function} callback"," * @api public"," */","","function getSysInfo(callback) {","\tif (process.platform === 'windows') return;","  var reData = getBasicInfo();","  exec('iostat ', function(err, output) {","\t\tif (!!err) {","\t\t\tconsole.error('getSysInfo failed! ' + err.stack);","\t\t\tcallback(err, reData);","\t\t} else {","\t\t\treData.iostat = format(output);","\t\t\tcallback(null, reData);","\t\t}","  });","};","","/**"," * analysis the disk i/o data,return a map contains kb_read,kb_wrtn ect."," *"," * @param {String} data, the output of the command 'iostat'"," * @api private"," */","","function format(data) {","\tvar time = util.formatTime(new Date());","  var output_array = data.toString().replace(/^\\s+|\\s+$/g,\"\").split(/\\s+/);","  var output_values = [];","  for (var i = 0, counter = 0; i < output_array.length; i++) {","    if(!isNaN(output_array[i])) {","      output_values[counter] = parseFloat(output_array[i]);","      counter++;","    }","  }","  if (output_values.length > 0) {","    output_hash = {","      date: time,","      disk: {","        kb_read: output_values[9],","        kb_wrtn: output_values[10],","        kb_read_per: output_values[7],","        kb_wrtn_per: output_values[8],","        tps: output_values[6]","      },","      cpu: {","        cpu_user: output_values[0],","        cpu_nice: output_values[1],","        cpu_system: output_values[2],","        cpu_iowait: output_values[3],","        cpu_steal: output_values[4],","        cpu_idle: output_values[5]","      }","    }","    return output_hash;","  }","};","","/**"," * get basic information of operating-system"," * "," * @return {Object} result"," * @api private"," */","","function getBasicInfo() {","\tvar result = {};","  for (var key in info) {","    result[key] = info[key]();","  }  ","\treturn result;","};","","info.hostname = os.hostname;","","info.type = os.type;","","info.platform = os.platform;","","info.arch = os.arch;","","info.release = os.release;","","info.uptime = os.uptime;","","info.loadavg = os.loadavg;","","info.totalmem = os.totalmem;","","info.freemem = os.freemem;","","info.cpus = os.cpus;","","info.networkInterfaces = os.networkInterfaces;","","info.versions = function(){return process.versions};","","info.arch = function(){return process.arch};","","info.platform = function(){return process.platform};","","info.memoryUsage = process.memoryUsage;","","info.uptime = process.uptime;","","",""],"l":{"5":1,"9":1,"15":1,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"32":0,"33":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"55":0,"56":0,"74":0,"85":1,"86":0,"87":0,"88":0,"90":0,"93":1,"95":1,"97":1,"99":1,"101":1,"103":1,"105":1,"107":1,"109":1,"111":1,"113":1,"115":1,"117":1,"119":1,"121":1,"123":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/profiler.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/profiler.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":0,"62":0,"63":0,"64":0},"b":{"1":[0,0],"2":[1,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":17},"end":{"line":13,"column":32}}},"2":{"name":"(anonymous_2)","line":27,"loc":{"start":{"line":27,"column":13},"end":{"line":27,"column":28}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":34},"end":{"line":33,"column":59}}},"4":{"name":"(anonymous_4)","line":53,"loc":{"start":{"line":53,"column":11},"end":{"line":53,"column":34}}},"5":{"name":"(anonymous_5)","line":65,"loc":{"start":{"line":65,"column":10},"end":{"line":65,"column":22}}},"6":{"name":"(anonymous_6)","line":73,"loc":{"start":{"line":73,"column":33},"end":{"line":73,"column":58}}},"7":{"name":"(anonymous_7)","line":81,"loc":{"start":{"line":81,"column":33},"end":{"line":81,"column":58}}},"8":{"name":"(anonymous_8)","line":103,"loc":{"start":{"line":103,"column":11},"end":{"line":103,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":76}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":20}},"4":{"start":{"line":5,"column":0},"end":{"line":8,"column":1}},"5":{"start":{"line":6,"column":1},"end":{"line":6,"column":35}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":23}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":51}},"8":{"start":{"line":13,"column":0},"end":{"line":19,"column":2}},"9":{"start":{"line":14,"column":1},"end":{"line":18,"column":2}},"10":{"start":{"line":15,"column":2},"end":{"line":15,"column":12}},"11":{"start":{"line":17,"column":2},"end":{"line":17,"column":26}},"12":{"start":{"line":21,"column":0},"end":{"line":23,"column":1}},"13":{"start":{"line":22,"column":1},"end":{"line":22,"column":32}},"14":{"start":{"line":25,"column":0},"end":{"line":25,"column":37}},"15":{"start":{"line":27,"column":0},"end":{"line":31,"column":2}},"16":{"start":{"line":28,"column":1},"end":{"line":30,"column":2}},"17":{"start":{"line":29,"column":2},"end":{"line":29,"column":34}},"18":{"start":{"line":33,"column":0},"end":{"line":71,"column":2}},"19":{"start":{"line":34,"column":1},"end":{"line":34,"column":72}},"20":{"start":{"line":35,"column":1},"end":{"line":70,"column":2}},"21":{"start":{"line":36,"column":2},"end":{"line":45,"column":3}},"22":{"start":{"line":37,"column":3},"end":{"line":37,"column":29}},"23":{"start":{"line":39,"column":3},"end":{"line":39,"column":37}},"24":{"start":{"line":40,"column":3},"end":{"line":40,"column":16}},"25":{"start":{"line":41,"column":3},"end":{"line":41,"column":38}},"26":{"start":{"line":42,"column":3},"end":{"line":42,"column":47}},"27":{"start":{"line":43,"column":3},"end":{"line":43,"column":17}},"28":{"start":{"line":44,"column":3},"end":{"line":44,"column":90}},"29":{"start":{"line":47,"column":2},"end":{"line":47,"column":41}},"30":{"start":{"line":48,"column":4},"end":{"line":48,"column":54}},"31":{"start":{"line":49,"column":2},"end":{"line":49,"column":68}},"32":{"start":{"line":50,"column":2},"end":{"line":50,"column":55}},"33":{"start":{"line":51,"column":2},"end":{"line":51,"column":11}},"34":{"start":{"line":52,"column":2},"end":{"line":69,"column":5}},"35":{"start":{"line":54,"column":4},"end":{"line":54,"column":23}},"36":{"start":{"line":55,"column":4},"end":{"line":61,"column":6}},"37":{"start":{"line":62,"column":4},"end":{"line":62,"column":21}},"38":{"start":{"line":63,"column":4},"end":{"line":63,"column":92}},"39":{"start":{"line":66,"column":4},"end":{"line":66,"column":108}},"40":{"start":{"line":67,"column":4},"end":{"line":67,"column":34}},"41":{"start":{"line":73,"column":0},"end":{"line":79,"column":2}},"42":{"start":{"line":74,"column":1},"end":{"line":78,"column":2}},"43":{"start":{"line":75,"column":2},"end":{"line":75,"column":57}},"44":{"start":{"line":77,"column":2},"end":{"line":77,"column":40}},"45":{"start":{"line":81,"column":0},"end":{"line":101,"column":2}},"46":{"start":{"line":82,"column":1},"end":{"line":85,"column":2}},"47":{"start":{"line":83,"column":2},"end":{"line":83,"column":23}},"48":{"start":{"line":84,"column":2},"end":{"line":84,"column":9}},"49":{"start":{"line":87,"column":1},"end":{"line":89,"column":2}},"50":{"start":{"line":88,"column":2},"end":{"line":88,"column":24}},"51":{"start":{"line":90,"column":1},"end":{"line":90,"column":17}},"52":{"start":{"line":91,"column":1},"end":{"line":91,"column":37}},"53":{"start":{"line":92,"column":1},"end":{"line":92,"column":25}},"54":{"start":{"line":93,"column":1},"end":{"line":93,"column":25}},"55":{"start":{"line":94,"column":1},"end":{"line":94,"column":29}},"56":{"start":{"line":96,"column":1},"end":{"line":98,"column":2}},"57":{"start":{"line":97,"column":2},"end":{"line":97,"column":9}},"58":{"start":{"line":100,"column":1},"end":{"line":100,"column":49}},"59":{"start":{"line":103,"column":0},"end":{"line":111,"column":2}},"60":{"start":{"line":104,"column":1},"end":{"line":104,"column":18}},"61":{"start":{"line":105,"column":1},"end":{"line":105,"column":25}},"62":{"start":{"line":107,"column":1},"end":{"line":109,"column":2}},"63":{"start":{"line":108,"column":2},"end":{"line":108,"column":20}},"64":{"start":{"line":110,"column":1},"end":{"line":110,"column":19}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},{"start":{"line":14,"column":1},"end":{"line":14,"column":1}}]},"2":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":0},"end":{"line":21,"column":0}},{"start":{"line":21,"column":0},"end":{"line":21,"column":0}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},{"start":{"line":28,"column":1},"end":{"line":28,"column":1}}]},"4":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":4},"end":{"line":28,"column":8}},{"start":{"line":28,"column":12},"end":{"line":28,"column":25}}]},"5":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},{"start":{"line":35,"column":1},"end":{"line":35,"column":1}}]},"6":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":2}},{"start":{"line":36,"column":2},"end":{"line":36,"column":2}}]},"7":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},{"start":{"line":74,"column":1},"end":{"line":74,"column":1}}]},"8":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},{"start":{"line":82,"column":1},"end":{"line":82,"column":1}}]},"9":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},{"start":{"line":87,"column":1},"end":{"line":87,"column":1}}]},"10":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},{"start":{"line":96,"column":1},"end":{"line":96,"column":1}}]},"11":{"line":96,"type":"binary-expr","locations":[{"start":{"line":96,"column":5},"end":{"line":96,"column":24}},{"start":{"line":96,"column":28},"end":{"line":96,"column":68}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-admin', __filename);","var utils = require('../util/utils');","","var profiler = null;","try {","\tprofiler = require('v8-profiler');","} catch(e) {","}","","var fs = require('fs');","var ProfileProxy = require('../util/profileProxy');","","module.exports = function(opts) {","\tif (!profiler) {","\t\treturn {};","\t} else {","\t\treturn new Module(opts);","\t}","};","","if (!profiler) {","\tmodule.exports.moduleError = 1;","}","","module.exports.moduleId = 'profiler';","","var Module = function(opts) {","\tif(opts && opts.isMaster) {","\t\tthis.proxy = new ProfileProxy();","\t}","};","","Module.prototype.monitorHandler = function(agent, msg, cb) {","\tvar type = msg.type, action = msg.action, uid = msg.uid, result = null;","\tif (type === 'CPU') {","\t\tif (action === 'start') {","\t\t\tprofiler.startProfiling();","\t\t} else {","\t\t\tresult = profiler.stopProfiling();","\t\t\tvar res = {};","\t\t\tres.head = result.getTopDownRoot();","\t\t\tres.bottomUpHead = result.getBottomUpRoot();","\t\t\tres.msg = msg;","\t\t\tagent.notify(module.exports.moduleId, {clientId: msg.clientId, type: type, body: res});","\t\t}","\t} else {","\t\tvar snapshot = profiler.takeSnapshot();","    var appBase = path.dirname(require.main.filename);","\t\tvar name = appBase + '/logs/' + utils.format(new Date()) + '.log';","\t\tvar log = fs.createWriteStream(name, {'flags': 'a'});","\t\tvar data;","\t\tsnapshot.serialize({","\t\t\tonData: function (chunk, size) {","\t\t\t\tchunk = chunk + '';","\t\t\t\tdata = {","\t\t\t\t\tmethod:'Profiler.addHeapSnapshotChunk',","\t\t\t\t\tparams:{","\t\t\t\t\t\tuid: uid,","\t\t\t\t\t\tchunk: chunk","\t\t\t\t\t}","\t\t\t\t};","\t\t\t\tlog.write(chunk);","\t\t\t\tagent.notify(module.exports.moduleId, {clientId: msg.clientId, type: type, body: data});","\t\t\t},","\t\t\tonEnd: function () {","\t\t\t\tagent.notify(module.exports.moduleId, {clientId: msg.clientId, type: type, body: {params: {uid: uid}}});","\t\t\t\tprofiler.deleteAllSnapshots();","\t\t\t}","\t\t});","\t}","};","","Module.prototype.masterHandler = function(agent, msg, cb) {","\tif(msg.type === 'CPU') {","\t\tthis.proxy.stopCallBack(msg.body, msg.clientId, agent);","\t} else {","\t\tthis.proxy.takeSnapCallBack(msg.body);","\t}","};","","Module.prototype.clientHandler = function(agent, msg, cb) {","\tif(msg.action === 'list') {","\t\tlist(agent, msg, cb);","\t\treturn;","\t}","","\tif(typeof msg === 'string') {","\t\tmsg = JSON.parse(msg);","\t}","\tvar id = msg.id;","\tvar command = msg.method.split('.');","\tvar method = command[1];","\tvar params = msg.params;","\tvar clientId = msg.clientId;","","\tif (!this.proxy[method] || typeof this.proxy[method] !== 'function') {","\t\treturn;","\t}","","\tthis.proxy[method](id, params, clientId, agent);","};","","var list = function(agent, msg, cb) {","\tvar servers = [];","\tvar idMap = agent.idMap;","","\tfor(var sid in idMap){","\t\tservers.push(sid);","\t}","\tcb(null, servers);","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"10":1,"11":1,"13":1,"14":0,"15":0,"17":0,"21":1,"22":1,"25":1,"27":1,"28":0,"29":0,"33":1,"34":0,"35":0,"36":0,"37":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"54":0,"55":0,"62":0,"63":0,"66":0,"67":0,"73":1,"74":0,"75":0,"77":0,"81":1,"82":0,"83":0,"84":0,"87":0,"88":0,"90":0,"91":0,"92":0,"93":0,"94":0,"96":0,"97":0,"100":0,"103":1,"104":0,"105":0,"107":0,"108":0,"110":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/profileProxy.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/profileProxy.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":1,"8":1,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":1,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":1,"64":0,"65":0,"66":1,"67":0,"68":1,"69":0,"70":1,"71":0,"72":0,"73":0,"74":0,"75":1,"76":0,"77":0,"78":0,"79":1,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":12},"end":{"line":6,"column":22}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":13},"end":{"line":19,"column":51}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":26},"end":{"line":25,"column":64}}},"4":{"name":"(anonymous_4)","line":31,"loc":{"start":{"line":31,"column":17},"end":{"line":31,"column":55}}},"5":{"name":"(anonymous_5)","line":37,"loc":{"start":{"line":37,"column":22},"end":{"line":37,"column":60}}},"6":{"name":"(anonymous_6)","line":43,"loc":{"start":{"line":43,"column":24},"end":{"line":43,"column":62}}},"7":{"name":"(anonymous_7)","line":60,"loc":{"start":{"line":60,"column":23},"end":{"line":60,"column":61}}},"8":{"name":"(anonymous_8)","line":72,"loc":{"start":{"line":72,"column":23},"end":{"line":72,"column":39}}},"9":{"name":"(anonymous_9)","line":91,"loc":{"start":{"line":91,"column":17},"end":{"line":91,"column":55}}},"10":{"name":"(anonymous_10)","line":95,"loc":{"start":{"line":95,"column":28},"end":{"line":95,"column":39}}},"11":{"name":"(anonymous_11)","line":107,"loc":{"start":{"line":107,"column":15},"end":{"line":107,"column":63}}},"12":{"name":"(anonymous_12)","line":129,"loc":{"start":{"line":129,"column":20},"end":{"line":129,"column":41}}},"13":{"name":"(anonymous_13)","line":136,"loc":{"start":{"line":136,"column":17},"end":{"line":136,"column":51}}},"14":{"name":"(anonymous_14)","line":140,"loc":{"start":{"line":140,"column":16},"end":{"line":140,"column":46}}},"15":{"name":"(anonymous_15)","line":144,"loc":{"start":{"line":144,"column":12},"end":{"line":144,"column":50}}},"16":{"name":"(anonymous_16)","line":152,"loc":{"start":{"line":152,"column":11},"end":{"line":152,"column":49}}},"17":{"name":"(anonymous_17)","line":158,"loc":{"start":{"line":158,"column":19},"end":{"line":158,"column":50}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":27}},"4":{"start":{"line":6,"column":0},"end":{"line":13,"column":2}},"5":{"start":{"line":7,"column":1},"end":{"line":10,"column":3}},"6":{"start":{"line":12,"column":1},"end":{"line":12,"column":29}},"7":{"start":{"line":15,"column":0},"end":{"line":15,"column":23}},"8":{"start":{"line":17,"column":0},"end":{"line":17,"column":26}},"9":{"start":{"line":19,"column":0},"end":{"line":23,"column":2}},"10":{"start":{"line":20,"column":1},"end":{"line":22,"column":21}},"11":{"start":{"line":25,"column":0},"end":{"line":29,"column":2}},"12":{"start":{"line":26,"column":1},"end":{"line":28,"column":21}},"13":{"start":{"line":31,"column":0},"end":{"line":35,"column":2}},"14":{"start":{"line":32,"column":1},"end":{"line":34,"column":21}},"15":{"start":{"line":37,"column":0},"end":{"line":41,"column":2}},"16":{"start":{"line":38,"column":1},"end":{"line":40,"column":21}},"17":{"start":{"line":43,"column":0},"end":{"line":58,"column":2}},"18":{"start":{"line":44,"column":1},"end":{"line":44,"column":18}},"19":{"start":{"line":45,"column":1},"end":{"line":54,"column":2}},"20":{"start":{"line":46,"column":2},"end":{"line":53,"column":3}},"21":{"start":{"line":47,"column":3},"end":{"line":47,"column":48}},"22":{"start":{"line":48,"column":3},"end":{"line":52,"column":6}},"23":{"start":{"line":55,"column":1},"end":{"line":57,"column":21}},"24":{"start":{"line":60,"column":0},"end":{"line":70,"column":2}},"25":{"start":{"line":61,"column":1},"end":{"line":61,"column":22}},"26":{"start":{"line":63,"column":1},"end":{"line":63,"column":98}},"27":{"start":{"line":65,"column":1},"end":{"line":68,"column":21}},"28":{"start":{"line":69,"column":1},"end":{"line":69,"column":42}},"29":{"start":{"line":72,"column":0},"end":{"line":89,"column":2}},"30":{"start":{"line":73,"column":1},"end":{"line":73,"column":32}},"31":{"start":{"line":74,"column":1},"end":{"line":74,"column":52}},"32":{"start":{"line":75,"column":1},"end":{"line":81,"column":2}},"33":{"start":{"line":76,"column":2},"end":{"line":76,"column":16}},"34":{"start":{"line":77,"column":2},"end":{"line":77,"column":21}},"35":{"start":{"line":78,"column":2},"end":{"line":78,"column":26}},"36":{"start":{"line":79,"column":2},"end":{"line":79,"column":21}},"37":{"start":{"line":80,"column":2},"end":{"line":80,"column":23}},"38":{"start":{"line":82,"column":1},"end":{"line":87,"column":2}},"39":{"start":{"line":83,"column":2},"end":{"line":83,"column":32}},"40":{"start":{"line":84,"column":2},"end":{"line":84,"column":28}},"41":{"start":{"line":86,"column":2},"end":{"line":86,"column":25}},"42":{"start":{"line":88,"column":1},"end":{"line":88,"column":48}},"43":{"start":{"line":91,"column":0},"end":{"line":105,"column":2}},"44":{"start":{"line":92,"column":1},"end":{"line":92,"column":54}},"45":{"start":{"line":93,"column":1},"end":{"line":93,"column":17}},"46":{"start":{"line":94,"column":1},"end":{"line":104,"column":2}},"47":{"start":{"line":95,"column":2},"end":{"line":101,"column":11}},"48":{"start":{"line":96,"column":3},"end":{"line":96,"column":52}},"49":{"start":{"line":97,"column":3},"end":{"line":100,"column":4}},"50":{"start":{"line":98,"column":4},"end":{"line":98,"column":27}},"51":{"start":{"line":99,"column":4},"end":{"line":99,"column":56}},"52":{"start":{"line":103,"column":2},"end":{"line":103,"column":53}},"53":{"start":{"line":107,"column":0},"end":{"line":127,"column":2}},"54":{"start":{"line":108,"column":1},"end":{"line":108,"column":22}},"55":{"start":{"line":109,"column":1},"end":{"line":126,"column":2}},"56":{"start":{"line":110,"column":2},"end":{"line":113,"column":3}},"57":{"start":{"line":111,"column":3},"end":{"line":111,"column":36}},"58":{"start":{"line":112,"column":3},"end":{"line":112,"column":112}},"59":{"start":{"line":114,"column":2},"end":{"line":114,"column":95}},"60":{"start":{"line":115,"column":2},"end":{"line":115,"column":110}},"61":{"start":{"line":116,"column":8},"end":{"line":126,"column":2}},"62":{"start":{"line":117,"column":2},"end":{"line":125,"column":22}},"63":{"start":{"line":129,"column":0},"end":{"line":134,"column":2}},"64":{"start":{"line":130,"column":1},"end":{"line":130,"column":25}},"65":{"start":{"line":131,"column":1},"end":{"line":131,"column":24}},"66":{"start":{"line":136,"column":0},"end":{"line":138,"column":2}},"67":{"start":{"line":137,"column":1},"end":{"line":137,"column":81}},"68":{"start":{"line":140,"column":0},"end":{"line":142,"column":2}},"69":{"start":{"line":141,"column":1},"end":{"line":141,"column":63}},"70":{"start":{"line":144,"column":0},"end":{"line":150,"column":2}},"71":{"start":{"line":145,"column":1},"end":{"line":145,"column":22}},"72":{"start":{"line":147,"column":1},"end":{"line":147,"column":97}},"73":{"start":{"line":148,"column":1},"end":{"line":148,"column":104}},"74":{"start":{"line":149,"column":1},"end":{"line":149,"column":42}},"75":{"start":{"line":152,"column":0},"end":{"line":156,"column":2}},"76":{"start":{"line":153,"column":1},"end":{"line":153,"column":22}},"77":{"start":{"line":154,"column":1},"end":{"line":154,"column":96}},"78":{"start":{"line":155,"column":1},"end":{"line":155,"column":42}},"79":{"start":{"line":158,"column":0},"end":{"line":175,"column":2}},"80":{"start":{"line":159,"column":1},"end":{"line":159,"column":23}},"81":{"start":{"line":160,"column":1},"end":{"line":160,"column":51}},"82":{"start":{"line":161,"column":1},"end":{"line":168,"column":2}},"83":{"start":{"line":162,"column":2},"end":{"line":162,"column":16}},"84":{"start":{"line":163,"column":2},"end":{"line":163,"column":23}},"85":{"start":{"line":164,"column":2},"end":{"line":164,"column":25}},"86":{"start":{"line":165,"column":2},"end":{"line":165,"column":35}},"87":{"start":{"line":166,"column":2},"end":{"line":166,"column":21}},"88":{"start":{"line":167,"column":2},"end":{"line":167,"column":23}},"89":{"start":{"line":169,"column":1},"end":{"line":169,"column":21}},"90":{"start":{"line":170,"column":1},"end":{"line":170,"column":47}},"91":{"start":{"line":171,"column":1},"end":{"line":174,"column":21}}},"branchMap":{"1":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":11},"end":{"line":73,"column":26}},{"start":{"line":73,"column":30},"end":{"line":73,"column":31}}]},"2":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},{"start":{"line":75,"column":1},"end":{"line":75,"column":1}}]},"3":{"line":75,"type":"binary-expr","locations":[{"start":{"line":75,"column":5},"end":{"line":75,"column":14}},{"start":{"line":75,"column":18},"end":{"line":75,"column":33}}]},"4":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},{"start":{"line":82,"column":1},"end":{"line":82,"column":1}}]},"5":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},{"start":{"line":94,"column":1},"end":{"line":94,"column":1}}]},"6":{"line":94,"type":"binary-expr","locations":[{"start":{"line":94,"column":5},"end":{"line":94,"column":13}},{"start":{"line":94,"column":17},"end":{"line":94,"column":32}}]},"7":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":3},"end":{"line":97,"column":3}},{"start":{"line":97,"column":3},"end":{"line":97,"column":3}}]},"8":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},{"start":{"line":109,"column":1},"end":{"line":109,"column":1}}]},"9":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":8},"end":{"line":116,"column":8}},{"start":{"line":116,"column":8},"end":{"line":116,"column":8}}]},"10":{"line":161,"type":"if","locations":[{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},{"start":{"line":161,"column":1},"end":{"line":161,"column":1}}]},"11":{"line":161,"type":"binary-expr","locations":[{"start":{"line":161,"column":5},"end":{"line":161,"column":14}},{"start":{"line":161,"column":18},"end":{"line":161,"column":33}}]}},"code":["var fs = require('fs');","","var HeapProfileType = 'HEAP';","var CPUProfileType = 'CPU';","","var Proxy = function(){","\tthis.profiles = {","\t\tHEAP: {},","\t\tCPU: {}","\t};","","\tthis.isProfilingCPU = false;","};","","module.exports = Proxy;","","var pro = Proxy.prototype;","","pro.enable = function(id, params, clientId, agent) {","\tthis.sendResult(id,{","\t\tresult : true","\t}, clientId, agent);","};","","pro.causesRecompilation = function(id, params, clientId, agent) {","\tthis.sendResult(id,{","\t\tresult: false","\t}, clientId, agent);","};","","pro.isSampling = function(id, params, clientId, agent) {","\tthis.sendResult(id,{","\t\tresult: true","\t}, clientId, agent);","};","","pro.hasHeapProfiler = function(id, params, clientId, agent) {","\tthis.sendResult(id,{","\t\tresult: true","\t}, clientId, agent);","};","","pro.getProfileHeaders = function(id, params, clientId, agent) {","\tvar headers = [];","\tfor (var type in this.profiles) {","\t\tfor (var profileId in this.profiles[type]) {","\t\t\tvar profile = this.profiles[type][profileId];","\t\t\theaders.push({","\t\t\t\ttitle: profile.title,","\t\t\t\tuid: profile.uid,","\t\t\t\ttypeId: type","\t\t\t});","\t\t}","\t}","\tthis.sendResult(id, {","\t\theaders: headers","\t}, clientId, agent);","};","","pro.takeHeapSnapshot = function(id, params, clientId, agent) {","\tvar uid = params.uid;","","\tagent.notifyById(uid, 'profiler', {type: 'heap', action: 'start', uid: uid, clientId: clientId});","","\tthis.sendEvent({","\t\tmethod: 'Profiler.addProfileHeader', ","\t\tparams: {header: {title: uid, uid: uid, typeId: HeapProfileType}}","\t}, clientId, agent);","\tthis.sendResult(id, {}, clientId, agent);","};","","pro.takeSnapCallBack = function (data) {","\tvar uid = data.params.uid || 0;","\tvar snapShot = this.profiles[HeapProfileType][uid];","\tif (!snapShot || snapShot.finish) {","\t\tsnapShot = {};","\t\tsnapShot.data = [];","\t\tsnapShot.finish = false;","\t\tsnapShot.uid = uid;","\t\tsnapShot.title = uid;","\t}","\tif (data.method === 'Profiler.addHeapSnapshotChunk') {","\t\tvar chunk = data.params.chunk;","\t\tsnapShot.data.push(chunk);","\t} else {","\t\tsnapShot.finish = true;","\t}","\tthis.profiles[HeapProfileType][uid] = snapShot;","};","","pro.getProfile = function(id, params, clientId, agent) {","\tvar profile = this.profiles[params.type][params.uid];","\tvar self = this;","\tif (!profile || !profile.finish) {","\t\tvar timerId = setInterval(function() {","\t\t\tprofile = self.profiles[params.type][params.uid];","\t\t\tif (!!profile) {","\t\t\t\tclearInterval(timerId);","\t\t\t\tself.asyncGet(id, params, profile, clientId, agent);","\t\t\t}","\t\t}, 5000);","\t} else {","\t\tthis.asyncGet(id,params, profile, clientId, agent);","\t}","};","","pro.asyncGet = function(id, params, snapshot, clientId, agent) {","\tvar uid = params.uid;","\tif (params.type === HeapProfileType) {","\t\tfor (var index in snapshot.data) {","\t\t\tvar chunk = snapshot.data[index];","\t\t\tthis.sendEvent({method: 'Profiler.addHeapSnapshotChunk', params: {uid: uid, chunk: chunk}}, clientId, agent);","\t\t}","\t\tthis.sendEvent({method: 'Profiler.finishHeapSnapshot', params: {uid: uid}}, clientId, agent);","\t\tthis.sendResult(id, {profile: {title: snapshot.title, uid: uid, typeId: HeapProfileType}}, clientId, agent);","\t} else if (params.type === CPUProfileType) {","\t\tthis.sendResult(id,{","\t\t\tprofile: {","\t\t\t\ttitle: snapshot.title,","\t\t\t\tuid: uid,","\t\t\t\ttypeId: CPUProfileType,","\t\t\t\thead: snapshot.data.head,","\t\t\t\tbottomUpHead: snapshot.data.bottomUpHead","\t\t\t}","\t\t}, clientId, agent);","\t}","};","","pro.clearProfiles = function(id, params) {","\tthis.profiles.HEAP = {};","\tthis.profiles.CPU = {};","\t//profiler.deleteAllSnapshots();","\t//profiler.deleteAllProfiles();","};","","pro.sendResult = function(id, res, clientId, agent){","\tagent.notifyClient(clientId, 'profiler', JSON.stringify({id: id, result: res}));","};","","pro.sendEvent = function(res, clientId, agent){","\tagent.notifyClient(clientId, 'profiler', JSON.stringify(res));","};","","pro.start = function(id, params, clientId, agent) {","\tvar uid = params.uid;","","\tagent.notifyById(uid, 'profiler', {type: 'CPU', action: 'start', uid: uid, clientId: clientId});","\tthis.sendEvent({method: 'Profiler.setRecordingProfile', params: {isProfiling: true}}, clientId, agent);","\tthis.sendResult(id, {}, clientId, agent);","};","","pro.stop = function(id, params, clientId, agent) {","\tvar uid = params.uid;","\tagent.notifyById(uid, 'profiler', {type: 'CPU', action: 'stop', uid: uid, clientId: clientId});","\tthis.sendResult(id, {}, clientId, agent);","};","","pro.stopCallBack = function(res, clientId, agent) {","\tvar uid = res.msg.uid;","\tvar profiler = this.profiles[CPUProfileType][uid];","\tif (!profiler || profiler.finish){","\t\tprofiler = {};","\t\tprofiler.data = null;","\t\tprofiler.finish = true;","\t\tprofiler.typeId = CPUProfileType;","\t\tprofiler.uid = uid;","\t\tprofiler.title = uid;","\t}","\tprofiler.data = res;","\tthis.profiles[CPUProfileType][uid] = profiler;","\tthis.sendEvent({","\t\tmethod: 'Profiler.addProfileHeader', ","\t\tparams: {header: {title: profiler.title, uid: uid, typeId: CPUProfileType}}","\t}, clientId, agent);","};"],"l":{"1":1,"3":1,"4":1,"6":1,"7":0,"12":0,"15":1,"17":1,"19":1,"20":0,"25":1,"26":0,"31":1,"32":0,"37":1,"38":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"55":0,"60":1,"61":0,"63":0,"65":0,"69":0,"72":1,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"82":0,"83":0,"84":0,"86":0,"88":0,"91":1,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"103":0,"107":1,"108":0,"109":0,"110":0,"111":0,"112":0,"114":0,"115":0,"116":0,"117":0,"129":1,"130":0,"131":0,"136":1,"137":0,"140":1,"141":0,"144":1,"145":0,"147":0,"148":0,"149":0,"152":1,"153":0,"154":0,"155":0,"158":1,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"169":0,"170":0,"171":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/scripts.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/scripts.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1,"61":0,"62":0,"63":0,"64":0,"65":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":14,"loc":{"start":{"line":14,"column":17},"end":{"line":14,"column":32}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":13},"end":{"line":20,"column":28}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":34},"end":{"line":31,"column":59}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":33},"end":{"line":56,"column":58}}},"5":{"name":"(anonymous_5)","line":69,"loc":{"start":{"line":69,"column":11},"end":{"line":69,"column":50}}},"6":{"name":"(anonymous_6)","line":78,"loc":{"start":{"line":78,"column":34},"end":{"line":78,"column":59}}},"7":{"name":"(anonymous_7)","line":96,"loc":{"start":{"line":96,"column":10},"end":{"line":96,"column":49}}},"8":{"name":"(anonymous_8)","line":103,"loc":{"start":{"line":103,"column":65},"end":{"line":103,"column":85}}},"9":{"name":"(anonymous_9)","line":116,"loc":{"start":{"line":116,"column":11},"end":{"line":116,"column":50}}},"10":{"name":"(anonymous_10)","line":119,"loc":{"start":{"line":119,"column":37},"end":{"line":119,"column":51}}},"11":{"name":"(anonymous_11)","line":133,"loc":{"start":{"line":133,"column":10},"end":{"line":133,"column":49}}},"12":{"name":"(anonymous_12)","line":134,"loc":{"start":{"line":134,"column":62},"end":{"line":134,"column":81}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":76}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":40}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":23}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":23}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":27}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":27}},"8":{"start":{"line":14,"column":0},"end":{"line":16,"column":2}},"9":{"start":{"line":15,"column":4},"end":{"line":15,"column":28}},"10":{"start":{"line":18,"column":0},"end":{"line":18,"column":36}},"11":{"start":{"line":20,"column":0},"end":{"line":29,"column":2}},"12":{"start":{"line":21,"column":4},"end":{"line":21,"column":24}},"13":{"start":{"line":22,"column":4},"end":{"line":22,"column":26}},"14":{"start":{"line":23,"column":4},"end":{"line":28,"column":6}},"15":{"start":{"line":31,"column":0},"end":{"line":54,"column":2}},"16":{"start":{"line":32,"column":4},"end":{"line":39,"column":6}},"17":{"start":{"line":40,"column":4},"end":{"line":51,"column":5}},"18":{"start":{"line":41,"column":8},"end":{"line":41,"column":48}},"19":{"start":{"line":43,"column":8},"end":{"line":43,"column":36}},"20":{"start":{"line":44,"column":8},"end":{"line":48,"column":9}},"21":{"start":{"line":45,"column":12},"end":{"line":45,"column":98}},"22":{"start":{"line":47,"column":12},"end":{"line":47,"column":29}},"23":{"start":{"line":50,"column":8},"end":{"line":50,"column":31}},"24":{"start":{"line":56,"column":0},"end":{"line":64,"column":2}},"25":{"start":{"line":57,"column":4},"end":{"line":57,"column":41}},"26":{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},"27":{"start":{"line":59,"column":8},"end":{"line":59,"column":45}},"28":{"start":{"line":60,"column":8},"end":{"line":60,"column":15}},"29":{"start":{"line":63,"column":4},"end":{"line":63,"column":30}},"30":{"start":{"line":69,"column":0},"end":{"line":91,"column":2}},"31":{"start":{"line":70,"column":4},"end":{"line":70,"column":21}},"32":{"start":{"line":71,"column":4},"end":{"line":71,"column":21}},"33":{"start":{"line":72,"column":4},"end":{"line":72,"column":28}},"34":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"35":{"start":{"line":75,"column":8},"end":{"line":75,"column":26}},"36":{"start":{"line":78,"column":4},"end":{"line":90,"column":7}},"37":{"start":{"line":79,"column":8},"end":{"line":81,"column":9}},"38":{"start":{"line":80,"column":12},"end":{"line":80,"column":27}},"39":{"start":{"line":82,"column":8},"end":{"line":84,"column":9}},"40":{"start":{"line":83,"column":12},"end":{"line":83,"column":39}},"41":{"start":{"line":86,"column":8},"end":{"line":89,"column":11}},"42":{"start":{"line":96,"column":0},"end":{"line":111,"column":2}},"43":{"start":{"line":97,"column":4},"end":{"line":97,"column":32}},"44":{"start":{"line":98,"column":4},"end":{"line":101,"column":5}},"45":{"start":{"line":99,"column":8},"end":{"line":99,"column":29}},"46":{"start":{"line":100,"column":8},"end":{"line":100,"column":15}},"47":{"start":{"line":103,"column":4},"end":{"line":110,"column":7}},"48":{"start":{"line":104,"column":8},"end":{"line":107,"column":9}},"49":{"start":{"line":105,"column":12},"end":{"line":105,"column":84}},"50":{"start":{"line":106,"column":12},"end":{"line":106,"column":60}},"51":{"start":{"line":109,"column":8},"end":{"line":109,"column":23}},"52":{"start":{"line":116,"column":0},"end":{"line":128,"column":2}},"53":{"start":{"line":117,"column":4},"end":{"line":117,"column":62}},"54":{"start":{"line":119,"column":4},"end":{"line":127,"column":7}},"55":{"start":{"line":120,"column":8},"end":{"line":124,"column":9}},"56":{"start":{"line":121,"column":12},"end":{"line":121,"column":89}},"57":{"start":{"line":122,"column":12},"end":{"line":122,"column":60}},"58":{"start":{"line":123,"column":12},"end":{"line":123,"column":19}},"59":{"start":{"line":126,"column":8},"end":{"line":126,"column":13}},"60":{"start":{"line":133,"column":0},"end":{"line":141,"column":2}},"61":{"start":{"line":134,"column":4},"end":{"line":140,"column":7}},"62":{"start":{"line":135,"column":8},"end":{"line":138,"column":9}},"63":{"start":{"line":136,"column":12},"end":{"line":136,"column":64}},"64":{"start":{"line":137,"column":12},"end":{"line":137,"column":19}},"65":{"start":{"line":139,"column":8},"end":{"line":139,"column":22}}},"branchMap":{"1":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":8},"end":{"line":44,"column":8}},{"start":{"line":44,"column":8},"end":{"line":44,"column":8}}]},"2":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":58,"column":4}},{"start":{"line":58,"column":4},"end":{"line":58,"column":4}}]},"3":{"line":58,"type":"binary-expr","locations":[{"start":{"line":58,"column":8},"end":{"line":58,"column":12}},{"start":{"line":58,"column":16},"end":{"line":58,"column":41}}]},"4":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":8},"end":{"line":79,"column":8}},{"start":{"line":79,"column":8},"end":{"line":79,"column":8}}]},"5":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":4},"end":{"line":98,"column":4}},{"start":{"line":98,"column":4},"end":{"line":98,"column":4}}]},"6":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":8},"end":{"line":104,"column":8}},{"start":{"line":104,"column":8},"end":{"line":104,"column":8}}]},"7":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":8},"end":{"line":120,"column":8}},{"start":{"line":120,"column":8},"end":{"line":120,"column":8}}]},"8":{"line":135,"type":"if","locations":[{"start":{"line":135,"column":8},"end":{"line":135,"column":8}},{"start":{"line":135,"column":8},"end":{"line":135,"column":8}}]}},"code":["/*!"," * Pomelo -- consoleModule runScript"," * Copyright(c) 2012 fantasyni <fantasyni@163.com>"," * MIT Licensed"," */","var monitor = require('pomelo-monitor');","var logger = require('pomelo-logger').getLogger('pomelo-admin', __filename);","var monitor = require('pomelo-monitor');","var vm = require('vm');","var fs = require('fs');","var util = require('util');","var path = require('path');","","module.exports = function(opts) {","    return new Module(opts);","};","","module.exports.moduleId = \"scripts\";","","var Module = function(opts) {","    this.app = opts.app;","    this.root = opts.path;","    this.commands = {","        'list': list,","        'get': get,","        'save': save,","        'run': run","    };","};","","Module.prototype.monitorHandler = function(agent, msg, cb) {","    var context = {","        app: this.app,","        require: require,","        os: require('os'),","        fs: require('fs'),","        process: process,","        util: util","    };","    try {","        vm.runInNewContext(msg.script, context);","","        var result = context.result;","        if (!result) {","            cb(null, \"script result should be assigned to result value to script module context\");","        } else {","            cb(null, result);","        }","    } catch (e) {","        cb(null, e.toString());","    }","","    //cb(null, vm.runInContext(msg.script, context));","};","","Module.prototype.clientHandler = function(agent, msg, cb) {","    var fun = this.commands[msg.command];","    if (!fun || typeof fun !== 'function') {","        cb('unknown command:' + msg.command);","        return;","    }","","    fun(this, agent, msg, cb);","};","","/**"," * List server id and scripts file name"," */","var list = function(scriptModule, agent, msg, cb) {","    var servers = [];","    var scripts = [];","    var idMap = agent.idMap;","","    for (var sid in idMap) {","        servers.push(sid);","    }","","    fs.readdir(scriptModule.root, function(err, filenames) {","        if (err) {","            filenames = [];","        }","        for (var i = 0, l = filenames.length; i < l; i++) {","            scripts.push(filenames[i]);","        }","","        cb(null, {","            servers: servers,","            scripts: scripts","        });","    });","};","","/**"," * Get the content of the script file"," */","var get = function(scriptModule, agent, msg, cb) {","    var filename = msg.filename;","    if (!filename) {","        cb('empty filename');","        return;","    }","","    fs.readFile(path.join(scriptModule.root, filename), 'utf-8', function(err, data) {","        if (err) {","            logger.error('fail to read script file:' + filename + ', ' + err.stack);","            cb('fail to read script with name:' + filename);","        }","","        cb(null, data);","    });","};","","/**"," * Save a script file that posted from admin console"," */","var save = function(scriptModule, agent, msg, cb) {","    var filepath = path.join(scriptModule.root, msg.filename);","","    fs.writeFile(filepath, msg.body, function(err) {","        if (err) {","            logger.error('fail to write script file:' + msg.filename + ', ' + err.stack);","            cb('fail to write script file:' + msg.filename);","            return;","        }","","        cb();","    });","};","","/**"," * Run the script on the specified server"," */","var run = function(scriptModule, agent, msg, cb) {","    agent.request(msg.serverId, module.exports.moduleId, msg, function(err, res) {","        if (err) {","            logger.error('fail to run script for ' + err.stack);","            return;","        }","        cb(null, res);","    });","};"],"l":{"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"14":1,"15":0,"18":1,"20":1,"21":0,"22":0,"23":0,"31":1,"32":0,"40":0,"41":0,"43":0,"44":0,"45":0,"47":0,"50":0,"56":1,"57":0,"58":0,"59":0,"60":0,"63":0,"69":1,"70":0,"71":0,"72":0,"74":0,"75":0,"78":0,"79":0,"80":0,"82":0,"83":0,"86":0,"96":1,"97":0,"98":0,"99":0,"100":0,"103":0,"104":0,"105":0,"106":0,"109":0,"116":1,"117":0,"119":0,"120":0,"121":0,"122":0,"123":0,"126":0,"133":1,"134":0,"135":0,"136":0,"137":0,"139":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/systemInfo.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/systemInfo.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":17},"end":{"line":12,"column":32}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":13},"end":{"line":18,"column":28}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":34},"end":{"line":25,"column":59}}},"4":{"name":"(anonymous_4)","line":27,"loc":{"start":{"line":27,"column":31},"end":{"line":27,"column":52}}},"5":{"name":"(anonymous_5)","line":32,"loc":{"start":{"line":32,"column":33},"end":{"line":32,"column":54}}},"6":{"name":"(anonymous_6)","line":58,"loc":{"start":{"line":58,"column":33},"end":{"line":58,"column":58}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":76}},"3":{"start":{"line":9,"column":0},"end":{"line":9,"column":30}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":23}},"5":{"start":{"line":12,"column":0},"end":{"line":14,"column":2}},"6":{"start":{"line":13,"column":1},"end":{"line":13,"column":25}},"7":{"start":{"line":16,"column":0},"end":{"line":16,"column":39}},"8":{"start":{"line":18,"column":0},"end":{"line":23,"column":2}},"9":{"start":{"line":19,"column":1},"end":{"line":19,"column":19}},"10":{"start":{"line":20,"column":1},"end":{"line":20,"column":33}},"11":{"start":{"line":21,"column":1},"end":{"line":21,"column":51}},"12":{"start":{"line":22,"column":1},"end":{"line":22,"column":42}},"13":{"start":{"line":25,"column":0},"end":{"line":30,"column":2}},"14":{"start":{"line":27,"column":1},"end":{"line":29,"column":4}},"15":{"start":{"line":28,"column":2},"end":{"line":28,"column":74}},"16":{"start":{"line":32,"column":0},"end":{"line":56,"column":2}},"17":{"start":{"line":33,"column":1},"end":{"line":36,"column":2}},"18":{"start":{"line":34,"column":2},"end":{"line":34,"column":43}},"19":{"start":{"line":35,"column":2},"end":{"line":35,"column":9}},"20":{"start":{"line":38,"column":1},"end":{"line":38,"column":21}},"21":{"start":{"line":40,"column":1},"end":{"line":47,"column":3}},"22":{"start":{"line":49,"column":1},"end":{"line":49,"column":47}},"23":{"start":{"line":50,"column":1},"end":{"line":53,"column":2}},"24":{"start":{"line":51,"column":2},"end":{"line":51,"column":12}},"25":{"start":{"line":52,"column":2},"end":{"line":52,"column":43}},"26":{"start":{"line":55,"column":1},"end":{"line":55,"column":30}},"27":{"start":{"line":58,"column":0},"end":{"line":60,"column":2}},"28":{"start":{"line":59,"column":1},"end":{"line":59,"column":52}}},"branchMap":{"1":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":12}},{"start":{"line":19,"column":16},"end":{"line":19,"column":18}}]},"2":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":13},"end":{"line":20,"column":22}},{"start":{"line":20,"column":26},"end":{"line":20,"column":32}}]},"3":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":17},"end":{"line":21,"column":30}},{"start":{"line":21,"column":34},"end":{"line":21,"column":50}}]},"4":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":14},"end":{"line":22,"column":24}},{"start":{"line":22,"column":28},"end":{"line":22,"column":41}}]},"5":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},{"start":{"line":33,"column":1},"end":{"line":33,"column":1}}]},"6":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},{"start":{"line":50,"column":1},"end":{"line":50,"column":1}}]},"7":{"line":59,"type":"binary-expr","locations":[{"start":{"line":59,"column":10},"end":{"line":59,"column":44}},{"start":{"line":59,"column":48},"end":{"line":59,"column":50}}]}},"code":["/*!"," * Pomelo -- consoleModule systemInfo"," * Copyright(c) 2012 fantasyni <fantasyni@163.com>"," * MIT Licensed"," */","var monitor = require('pomelo-monitor');","var logger = require('pomelo-logger').getLogger('pomelo-admin', __filename);","","var DEFAULT_INTERVAL = 5 * 60;\t\t// in second","var DEFAULT_DELAY = 10;\t\t\t\t\t\t// in second","","module.exports = function(opts) {","\treturn new Module(opts);","};","","module.exports.moduleId = 'systemInfo';","","var Module = function(opts) {","\topts = opts || {};","\tthis.type = opts.type || 'pull';","\tthis.interval = opts.interval || DEFAULT_INTERVAL;","\tthis.delay = opts.delay || DEFAULT_DELAY;","};","","Module.prototype.monitorHandler = function(agent, msg, cb) {","\t//collect data","\tmonitor.sysmonitor.getSysInfo(function (err, data) {","\t\tagent.notify(module.exports.moduleId, {serverId: agent.id, body: data});","\t});","};","","Module.prototype.masterHandler = function(agent, msg) {","\tif(!msg) {","\t\tagent.notifyAll(module.exports.moduleId);","\t\treturn;","\t}","","\tvar body = msg.body;","","\tvar oneData = {","\t\tTime:body.iostat.date,hostname:body.hostname,serverId:msg.serverId,cpu_user:body.iostat.cpu.cpu_user,","\t\tcpu_nice:body.iostat.cpu.cpu_nice,cpu_system:body.iostat.cpu.cpu_system,cpu_iowait:body.iostat.cpu.cpu_iowait,","\t\tcpu_steal:body.iostat.cpu.cpu_steal,cpu_idle:body.iostat.cpu.cpu_idle,tps:body.iostat.disk.tps,","\t\tkb_read:body.iostat.disk.kb_read,kb_wrtn:body.iostat.disk.kb_wrtn,kb_read_per:body.iostat.disk.kb_read_per,","\t\tkb_wrtn_per:body.iostat.disk.kb_wrtn_per,totalmem:body.totalmem,freemem:body.freemem,'free/total':(body.freemem/body.totalmem),","\t\tm_1:body.loadavg[0],m_5:body.loadavg[1],m_15:body.loadavg[2]","\t};","","\tvar data = agent.get(module.exports.moduleId);","\tif(!data) {","\t\tdata = {};","\t\tagent.set(module.exports.moduleId, data);","\t}","","\tdata[msg.serverId] = oneData;","};","","Module.prototype.clientHandler = function(agent, msg, cb) {","\tcb(null, agent.get(module.exports.moduleId) || {});","};",""],"l":{"6":1,"7":1,"9":1,"10":1,"12":1,"13":0,"16":1,"18":1,"19":0,"20":0,"21":0,"22":0,"25":1,"27":0,"28":0,"32":1,"33":0,"34":0,"35":0,"38":0,"40":0,"49":0,"50":0,"51":0,"52":0,"55":0,"58":1,"59":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/watchServer.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/modules/watchServer.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":1,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":1,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":1,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":1,"154":0,"155":1,"156":0,"157":0,"158":0,"159":0,"160":0,"161":1,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":1,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":1,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":1,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":1,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":1,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":1,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":1,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":1,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0,"275":0,"276":0,"277":1,"278":0,"279":0,"280":0,"281":0,"282":0,"283":0,"284":0,"285":0,"286":0,"287":0,"288":0,"289":1,"290":0,"291":0,"292":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":1,"300":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"308":0,"309":1,"310":0,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"321":0,"322":1,"323":1,"324":0,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"331":0,"332":0,"333":1,"334":0,"335":0,"336":0,"337":0,"338":0,"339":0,"340":0,"341":0,"342":0,"343":1,"344":0,"345":0,"346":0,"347":0,"348":0,"349":0,"350":0,"351":0,"352":0,"353":0,"354":0,"355":0,"356":0,"357":0,"358":0,"359":0,"360":0,"361":0,"362":1,"363":0,"364":0,"365":0,"366":0,"367":0,"368":0,"369":0,"370":0,"371":0,"372":0,"373":0,"374":0,"375":0,"376":0,"377":0,"378":0,"379":0,"380":0,"381":1,"382":0,"383":0,"384":0,"385":0,"386":1,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0},"b":{"1":[0,0],"2":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},"fnMap":{"1":{"name":"(anonymous_1)","line":14,"loc":{"start":{"line":14,"column":17},"end":{"line":14,"column":32}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":13},"end":{"line":20,"column":28}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":34},"end":{"line":25,"column":59}}},"4":{"name":"(anonymous_4)","line":90,"loc":{"start":{"line":90,"column":33},"end":{"line":90,"column":58}}},"5":{"name":"showServers","line":159,"loc":{"start":{"line":159,"column":0},"end":{"line":159,"column":55}}},"6":{"name":"(anonymous_6)","line":164,"loc":{"start":{"line":164,"column":57},"end":{"line":164,"column":68}}},"7":{"name":"(anonymous_7)","line":175,"loc":{"start":{"line":175,"column":6},"end":{"line":175,"column":20}}},"8":{"name":"showConnections","line":203,"loc":{"start":{"line":203,"column":0},"end":{"line":203,"column":64}}},"9":{"name":"(anonymous_9)","line":214,"loc":{"start":{"line":214,"column":58},"end":{"line":214,"column":69}}},"10":{"name":"(anonymous_10)","line":226,"loc":{"start":{"line":226,"column":8},"end":{"line":226,"column":22}}},"11":{"name":"(anonymous_11)","line":241,"loc":{"start":{"line":241,"column":7},"end":{"line":241,"column":21}}},"12":{"name":"showLogins","line":270,"loc":{"start":{"line":270,"column":0},"end":{"line":270,"column":59}}},"13":{"name":"showModules","line":274,"loc":{"start":{"line":274,"column":0},"end":{"line":274,"column":55}}},"14":{"name":"showStatus","line":285,"loc":{"start":{"line":285,"column":0},"end":{"line":285,"column":54}}},"15":{"name":"(anonymous_15)","line":290,"loc":{"start":{"line":290,"column":5},"end":{"line":290,"column":24}}},"16":{"name":"(anonymous_16)","line":302,"loc":{"start":{"line":302,"column":38},"end":{"line":302,"column":58}}},"17":{"name":"showConfig","line":311,"loc":{"start":{"line":311,"column":0},"end":{"line":311,"column":66}}},"18":{"name":"(anonymous_18)","line":325,"loc":{"start":{"line":325,"column":5},"end":{"line":325,"column":24}}},"19":{"name":"showProxy","line":334,"loc":{"start":{"line":334,"column":0},"end":{"line":334,"column":65}}},"20":{"name":"(anonymous_20)","line":345,"loc":{"start":{"line":345,"column":5},"end":{"line":345,"column":24}}},"21":{"name":"showHandler","line":353,"loc":{"start":{"line":353,"column":0},"end":{"line":353,"column":67}}},"22":{"name":"(anonymous_22)","line":364,"loc":{"start":{"line":364,"column":5},"end":{"line":364,"column":24}}},"23":{"name":"showComponents","line":372,"loc":{"start":{"line":372,"column":0},"end":{"line":372,"column":70}}},"24":{"name":"(anonymous_24)","line":383,"loc":{"start":{"line":383,"column":5},"end":{"line":383,"column":24}}},"25":{"name":"showSettings","line":397,"loc":{"start":{"line":397,"column":0},"end":{"line":397,"column":68}}},"26":{"name":"(anonymous_26)","line":408,"loc":{"start":{"line":408,"column":5},"end":{"line":408,"column":24}}},"27":{"name":"dumpCPU","line":428,"loc":{"start":{"line":428,"column":0},"end":{"line":428,"column":58}}},"28":{"name":"(anonymous_28)","line":439,"loc":{"start":{"line":439,"column":5},"end":{"line":439,"column":24}}},"29":{"name":"dumpMemory","line":468,"loc":{"start":{"line":468,"column":0},"end":{"line":468,"column":61}}},"30":{"name":"(anonymous_30)","line":479,"loc":{"start":{"line":479,"column":5},"end":{"line":479,"column":24}}},"31":{"name":"(anonymous_31)","line":488,"loc":{"start":{"line":488,"column":33},"end":{"line":488,"column":47}}},"32":{"name":"getApp","line":505,"loc":{"start":{"line":505,"column":0},"end":{"line":505,"column":62}}},"33":{"name":"(anonymous_33)","line":516,"loc":{"start":{"line":516,"column":5},"end":{"line":516,"column":24}}},"34":{"name":"setApp","line":528,"loc":{"start":{"line":528,"column":0},"end":{"line":528,"column":62}}},"35":{"name":"(anonymous_35)","line":539,"loc":{"start":{"line":539,"column":5},"end":{"line":539,"column":24}}},"36":{"name":"enableApp","line":550,"loc":{"start":{"line":550,"column":0},"end":{"line":550,"column":65}}},"37":{"name":"(anonymous_37)","line":561,"loc":{"start":{"line":561,"column":5},"end":{"line":561,"column":24}}},"38":{"name":"disableApp","line":570,"loc":{"start":{"line":570,"column":0},"end":{"line":570,"column":66}}},"39":{"name":"(anonymous_39)","line":581,"loc":{"start":{"line":581,"column":5},"end":{"line":581,"column":24}}},"40":{"name":"runScript","line":590,"loc":{"start":{"line":590,"column":0},"end":{"line":590,"column":65}}},"41":{"name":"(anonymous_41)","line":601,"loc":{"start":{"line":601,"column":5},"end":{"line":601,"column":24}}},"42":{"name":"showError","line":618,"loc":{"start":{"line":618,"column":0},"end":{"line":618,"column":53}}},"43":{"name":"clone","line":622,"loc":{"start":{"line":622,"column":0},"end":{"line":622,"column":27}}},"44":{"name":"checkFilePath","line":638,"loc":{"start":{"line":638,"column":0},"end":{"line":638,"column":44}}},"45":{"name":"(anonymous_45)","line":643,"loc":{"start":{"line":643,"column":32},"end":{"line":643,"column":46}}},"46":{"name":"proxyCb","line":653,"loc":{"start":{"line":653,"column":0},"end":{"line":653,"column":35}}},"47":{"name":"handlerCb","line":681,"loc":{"start":{"line":681,"column":0},"end":{"line":681,"column":37}}},"48":{"name":"getComponentName","line":709,"loc":{"start":{"line":709,"column":0},"end":{"line":709,"column":29}}},"49":{"name":"checkJSON","line":717,"loc":{"start":{"line":717,"column":0},"end":{"line":717,"column":24}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":76}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":55}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":40}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":37}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":23}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":23}},"8":{"start":{"line":14,"column":0},"end":{"line":16,"column":2}},"9":{"start":{"line":15,"column":1},"end":{"line":15,"column":25}},"10":{"start":{"line":18,"column":0},"end":{"line":18,"column":40}},"11":{"start":{"line":20,"column":0},"end":{"line":23,"column":2}},"12":{"start":{"line":21,"column":1},"end":{"line":21,"column":19}},"13":{"start":{"line":22,"column":1},"end":{"line":22,"column":21}},"14":{"start":{"line":25,"column":0},"end":{"line":88,"column":2}},"15":{"start":{"line":26,"column":1},"end":{"line":26,"column":24}},"16":{"start":{"line":27,"column":1},"end":{"line":27,"column":30}},"17":{"start":{"line":28,"column":1},"end":{"line":28,"column":26}},"18":{"start":{"line":29,"column":1},"end":{"line":29,"column":20}},"19":{"start":{"line":31,"column":1},"end":{"line":31,"column":24}},"20":{"start":{"line":33,"column":1},"end":{"line":87,"column":2}},"21":{"start":{"line":35,"column":3},"end":{"line":35,"column":49}},"22":{"start":{"line":36,"column":3},"end":{"line":36,"column":9}},"23":{"start":{"line":38,"column":3},"end":{"line":38,"column":58}},"24":{"start":{"line":39,"column":3},"end":{"line":39,"column":9}},"25":{"start":{"line":41,"column":3},"end":{"line":41,"column":53}},"26":{"start":{"line":42,"column":3},"end":{"line":42,"column":9}},"27":{"start":{"line":44,"column":3},"end":{"line":44,"column":49}},"28":{"start":{"line":45,"column":3},"end":{"line":45,"column":9}},"29":{"start":{"line":47,"column":3},"end":{"line":47,"column":48}},"30":{"start":{"line":48,"column":3},"end":{"line":48,"column":9}},"31":{"start":{"line":50,"column":3},"end":{"line":50,"column":60}},"32":{"start":{"line":51,"column":3},"end":{"line":51,"column":9}},"33":{"start":{"line":53,"column":3},"end":{"line":53,"column":59}},"34":{"start":{"line":54,"column":3},"end":{"line":54,"column":9}},"35":{"start":{"line":56,"column":3},"end":{"line":56,"column":61}},"36":{"start":{"line":57,"column":3},"end":{"line":57,"column":9}},"37":{"start":{"line":59,"column":3},"end":{"line":59,"column":64}},"38":{"start":{"line":60,"column":3},"end":{"line":60,"column":9}},"39":{"start":{"line":62,"column":3},"end":{"line":62,"column":62}},"40":{"start":{"line":63,"column":3},"end":{"line":63,"column":9}},"41":{"start":{"line":65,"column":3},"end":{"line":65,"column":52}},"42":{"start":{"line":66,"column":3},"end":{"line":66,"column":9}},"43":{"start":{"line":68,"column":3},"end":{"line":68,"column":55}},"44":{"start":{"line":69,"column":3},"end":{"line":69,"column":9}},"45":{"start":{"line":71,"column":3},"end":{"line":71,"column":56}},"46":{"start":{"line":72,"column":3},"end":{"line":72,"column":9}},"47":{"start":{"line":74,"column":3},"end":{"line":74,"column":56}},"48":{"start":{"line":75,"column":3},"end":{"line":75,"column":9}},"49":{"start":{"line":77,"column":3},"end":{"line":77,"column":59}},"50":{"start":{"line":78,"column":3},"end":{"line":78,"column":9}},"51":{"start":{"line":80,"column":3},"end":{"line":80,"column":60}},"52":{"start":{"line":81,"column":3},"end":{"line":81,"column":9}},"53":{"start":{"line":83,"column":3},"end":{"line":83,"column":59}},"54":{"start":{"line":84,"column":3},"end":{"line":84,"column":9}},"55":{"start":{"line":86,"column":3},"end":{"line":86,"column":47}},"56":{"start":{"line":90,"column":0},"end":{"line":157,"column":2}},"57":{"start":{"line":91,"column":1},"end":{"line":91,"column":24}},"58":{"start":{"line":92,"column":1},"end":{"line":92,"column":30}},"59":{"start":{"line":93,"column":1},"end":{"line":93,"column":26}},"60":{"start":{"line":94,"column":1},"end":{"line":94,"column":20}},"61":{"start":{"line":96,"column":1},"end":{"line":99,"column":2}},"62":{"start":{"line":97,"column":2},"end":{"line":97,"column":38}},"63":{"start":{"line":98,"column":2},"end":{"line":98,"column":9}},"64":{"start":{"line":101,"column":1},"end":{"line":101,"column":23}},"65":{"start":{"line":102,"column":1},"end":{"line":156,"column":2}},"66":{"start":{"line":104,"column":3},"end":{"line":104,"column":49}},"67":{"start":{"line":105,"column":3},"end":{"line":105,"column":9}},"68":{"start":{"line":107,"column":3},"end":{"line":107,"column":58}},"69":{"start":{"line":108,"column":3},"end":{"line":108,"column":9}},"70":{"start":{"line":110,"column":3},"end":{"line":110,"column":53}},"71":{"start":{"line":111,"column":3},"end":{"line":111,"column":9}},"72":{"start":{"line":113,"column":3},"end":{"line":113,"column":49}},"73":{"start":{"line":114,"column":3},"end":{"line":114,"column":9}},"74":{"start":{"line":116,"column":3},"end":{"line":116,"column":48}},"75":{"start":{"line":117,"column":3},"end":{"line":117,"column":9}},"76":{"start":{"line":119,"column":3},"end":{"line":119,"column":60}},"77":{"start":{"line":120,"column":3},"end":{"line":120,"column":9}},"78":{"start":{"line":122,"column":3},"end":{"line":122,"column":59}},"79":{"start":{"line":123,"column":3},"end":{"line":123,"column":9}},"80":{"start":{"line":125,"column":3},"end":{"line":125,"column":61}},"81":{"start":{"line":126,"column":3},"end":{"line":126,"column":9}},"82":{"start":{"line":128,"column":3},"end":{"line":128,"column":64}},"83":{"start":{"line":129,"column":3},"end":{"line":129,"column":9}},"84":{"start":{"line":131,"column":3},"end":{"line":131,"column":62}},"85":{"start":{"line":132,"column":3},"end":{"line":132,"column":9}},"86":{"start":{"line":134,"column":3},"end":{"line":134,"column":52}},"87":{"start":{"line":135,"column":3},"end":{"line":135,"column":9}},"88":{"start":{"line":137,"column":3},"end":{"line":137,"column":55}},"89":{"start":{"line":138,"column":3},"end":{"line":138,"column":9}},"90":{"start":{"line":140,"column":3},"end":{"line":140,"column":56}},"91":{"start":{"line":141,"column":3},"end":{"line":141,"column":9}},"92":{"start":{"line":143,"column":3},"end":{"line":143,"column":56}},"93":{"start":{"line":144,"column":3},"end":{"line":144,"column":9}},"94":{"start":{"line":146,"column":3},"end":{"line":146,"column":59}},"95":{"start":{"line":147,"column":3},"end":{"line":147,"column":9}},"96":{"start":{"line":149,"column":3},"end":{"line":149,"column":60}},"97":{"start":{"line":150,"column":3},"end":{"line":150,"column":9}},"98":{"start":{"line":152,"column":3},"end":{"line":152,"column":59}},"99":{"start":{"line":153,"column":3},"end":{"line":153,"column":9}},"100":{"start":{"line":155,"column":3},"end":{"line":155,"column":47}},"101":{"start":{"line":159,"column":0},"end":{"line":201,"column":1}},"102":{"start":{"line":160,"column":1},"end":{"line":199,"column":2}},"103":{"start":{"line":161,"column":2},"end":{"line":161,"column":18}},"104":{"start":{"line":162,"column":2},"end":{"line":162,"column":22}},"105":{"start":{"line":163,"column":2},"end":{"line":163,"column":38}},"106":{"start":{"line":164,"column":2},"end":{"line":168,"column":5}},"107":{"start":{"line":165,"column":3},"end":{"line":167,"column":6}},"108":{"start":{"line":170,"column":2},"end":{"line":179,"column":3}},"109":{"start":{"line":171,"column":3},"end":{"line":171,"column":29}},"110":{"start":{"line":172,"column":3},"end":{"line":178,"column":6}},"111":{"start":{"line":176,"column":4},"end":{"line":176,"column":40}},"112":{"start":{"line":177,"column":4},"end":{"line":177,"column":17}},"113":{"start":{"line":180,"column":8},"end":{"line":199,"column":2}},"114":{"start":{"line":181,"column":2},"end":{"line":181,"column":26}},"115":{"start":{"line":182,"column":2},"end":{"line":182,"column":30}},"116":{"start":{"line":183,"column":2},"end":{"line":183,"column":24}},"117":{"start":{"line":184,"column":2},"end":{"line":184,"column":24}},"118":{"start":{"line":185,"column":2},"end":{"line":185,"column":77}},"119":{"start":{"line":186,"column":2},"end":{"line":186,"column":50}},"120":{"start":{"line":187,"column":2},"end":{"line":198,"column":5}},"121":{"start":{"line":203,"column":0},"end":{"line":267,"column":1}},"122":{"start":{"line":204,"column":1},"end":{"line":266,"column":2}},"123":{"start":{"line":205,"column":2},"end":{"line":251,"column":3}},"124":{"start":{"line":206,"column":3},"end":{"line":206,"column":19}},"125":{"start":{"line":207,"column":3},"end":{"line":207,"column":23}},"126":{"start":{"line":208,"column":3},"end":{"line":208,"column":17}},"127":{"start":{"line":209,"column":3},"end":{"line":213,"column":4}},"128":{"start":{"line":210,"column":4},"end":{"line":212,"column":5}},"129":{"start":{"line":211,"column":5},"end":{"line":211,"column":13}},"130":{"start":{"line":214,"column":3},"end":{"line":218,"column":6}},"131":{"start":{"line":215,"column":4},"end":{"line":217,"column":7}},"132":{"start":{"line":220,"column":3},"end":{"line":231,"column":4}},"133":{"start":{"line":221,"column":4},"end":{"line":221,"column":30}},"134":{"start":{"line":222,"column":4},"end":{"line":230,"column":5}},"135":{"start":{"line":223,"column":5},"end":{"line":229,"column":8}},"136":{"start":{"line":227,"column":6},"end":{"line":227,"column":42}},"137":{"start":{"line":228,"column":6},"end":{"line":228,"column":19}},"138":{"start":{"line":233,"column":3},"end":{"line":233,"column":37}},"139":{"start":{"line":234,"column":3},"end":{"line":236,"column":4}},"140":{"start":{"line":235,"column":4},"end":{"line":235,"column":47}},"141":{"start":{"line":237,"column":3},"end":{"line":250,"column":4}},"142":{"start":{"line":238,"column":4},"end":{"line":247,"column":7}},"143":{"start":{"line":242,"column":5},"end":{"line":242,"column":25}},"144":{"start":{"line":243,"column":5},"end":{"line":243,"column":41}},"145":{"start":{"line":244,"column":5},"end":{"line":246,"column":8}},"146":{"start":{"line":249,"column":4},"end":{"line":249,"column":64}},"147":{"start":{"line":252,"column":8},"end":{"line":266,"column":2}},"148":{"start":{"line":253,"column":2},"end":{"line":253,"column":49}},"149":{"start":{"line":254,"column":2},"end":{"line":260,"column":3}},"150":{"start":{"line":255,"column":3},"end":{"line":258,"column":6}},"151":{"start":{"line":259,"column":3},"end":{"line":259,"column":10}},"152":{"start":{"line":262,"column":2},"end":{"line":265,"column":5}},"153":{"start":{"line":270,"column":0},"end":{"line":272,"column":1}},"154":{"start":{"line":271,"column":1},"end":{"line":271,"column":56}},"155":{"start":{"line":274,"column":0},"end":{"line":283,"column":1}},"156":{"start":{"line":275,"column":1},"end":{"line":275,"column":44}},"157":{"start":{"line":276,"column":1},"end":{"line":276,"column":17}},"158":{"start":{"line":277,"column":1},"end":{"line":279,"column":2}},"159":{"start":{"line":278,"column":2},"end":{"line":278,"column":22}},"160":{"start":{"line":280,"column":1},"end":{"line":282,"column":4}},"161":{"start":{"line":285,"column":0},"end":{"line":309,"column":1}},"162":{"start":{"line":286,"column":1},"end":{"line":308,"column":2}},"163":{"start":{"line":287,"column":2},"end":{"line":294,"column":5}},"164":{"start":{"line":291,"column":3},"end":{"line":293,"column":6}},"165":{"start":{"line":295,"column":8},"end":{"line":308,"column":2}},"166":{"start":{"line":296,"column":2},"end":{"line":296,"column":26}},"167":{"start":{"line":297,"column":2},"end":{"line":297,"column":24}},"168":{"start":{"line":298,"column":2},"end":{"line":301,"column":4}},"169":{"start":{"line":302,"column":2},"end":{"line":307,"column":5}},"170":{"start":{"line":303,"column":3},"end":{"line":306,"column":5}},"171":{"start":{"line":311,"column":0},"end":{"line":332,"column":1}},"172":{"start":{"line":312,"column":1},"end":{"line":331,"column":2}},"173":{"start":{"line":313,"column":2},"end":{"line":319,"column":3}},"174":{"start":{"line":314,"column":3},"end":{"line":317,"column":6}},"175":{"start":{"line":318,"column":3},"end":{"line":318,"column":10}},"176":{"start":{"line":321,"column":2},"end":{"line":327,"column":5}},"177":{"start":{"line":326,"column":3},"end":{"line":326,"column":17}},"178":{"start":{"line":328,"column":8},"end":{"line":331,"column":2}},"179":{"start":{"line":329,"column":2},"end":{"line":329,"column":29}},"180":{"start":{"line":330,"column":2},"end":{"line":330,"column":39}},"181":{"start":{"line":334,"column":0},"end":{"line":351,"column":1}},"182":{"start":{"line":335,"column":1},"end":{"line":350,"column":2}},"183":{"start":{"line":336,"column":2},"end":{"line":339,"column":3}},"184":{"start":{"line":337,"column":3},"end":{"line":337,"column":23}},"185":{"start":{"line":338,"column":3},"end":{"line":338,"column":10}},"186":{"start":{"line":341,"column":2},"end":{"line":347,"column":5}},"187":{"start":{"line":346,"column":3},"end":{"line":346,"column":17}},"188":{"start":{"line":348,"column":8},"end":{"line":350,"column":2}},"189":{"start":{"line":349,"column":2},"end":{"line":349,"column":28}},"190":{"start":{"line":353,"column":0},"end":{"line":370,"column":1}},"191":{"start":{"line":354,"column":1},"end":{"line":369,"column":2}},"192":{"start":{"line":355,"column":2},"end":{"line":358,"column":3}},"193":{"start":{"line":356,"column":3},"end":{"line":356,"column":23}},"194":{"start":{"line":357,"column":3},"end":{"line":357,"column":10}},"195":{"start":{"line":360,"column":2},"end":{"line":366,"column":5}},"196":{"start":{"line":365,"column":3},"end":{"line":365,"column":17}},"197":{"start":{"line":367,"column":8},"end":{"line":369,"column":2}},"198":{"start":{"line":368,"column":2},"end":{"line":368,"column":30}},"199":{"start":{"line":372,"column":0},"end":{"line":395,"column":1}},"200":{"start":{"line":373,"column":1},"end":{"line":394,"column":2}},"201":{"start":{"line":374,"column":2},"end":{"line":377,"column":3}},"202":{"start":{"line":375,"column":3},"end":{"line":375,"column":23}},"203":{"start":{"line":376,"column":3},"end":{"line":376,"column":10}},"204":{"start":{"line":379,"column":2},"end":{"line":385,"column":5}},"205":{"start":{"line":384,"column":3},"end":{"line":384,"column":17}},"206":{"start":{"line":386,"column":8},"end":{"line":394,"column":2}},"207":{"start":{"line":387,"column":2},"end":{"line":387,"column":35}},"208":{"start":{"line":388,"column":2},"end":{"line":388,"column":15}},"209":{"start":{"line":389,"column":2},"end":{"line":392,"column":3}},"210":{"start":{"line":390,"column":3},"end":{"line":390,"column":36}},"211":{"start":{"line":391,"column":3},"end":{"line":391,"column":52}},"212":{"start":{"line":393,"column":2},"end":{"line":393,"column":16}},"213":{"start":{"line":397,"column":0},"end":{"line":426,"column":1}},"214":{"start":{"line":398,"column":1},"end":{"line":425,"column":2}},"215":{"start":{"line":399,"column":2},"end":{"line":402,"column":3}},"216":{"start":{"line":400,"column":3},"end":{"line":400,"column":23}},"217":{"start":{"line":401,"column":3},"end":{"line":401,"column":10}},"218":{"start":{"line":404,"column":2},"end":{"line":410,"column":5}},"219":{"start":{"line":409,"column":3},"end":{"line":409,"column":17}},"220":{"start":{"line":411,"column":8},"end":{"line":425,"column":2}},"221":{"start":{"line":412,"column":2},"end":{"line":412,"column":31}},"222":{"start":{"line":413,"column":2},"end":{"line":413,"column":15}},"223":{"start":{"line":414,"column":2},"end":{"line":423,"column":3}},"224":{"start":{"line":415,"column":3},"end":{"line":417,"column":4}},"225":{"start":{"line":416,"column":4},"end":{"line":416,"column":13}},"226":{"start":{"line":418,"column":3},"end":{"line":421,"column":4}},"227":{"start":{"line":419,"column":4},"end":{"line":419,"column":24}},"228":{"start":{"line":420,"column":4},"end":{"line":420,"column":13}},"229":{"start":{"line":422,"column":3},"end":{"line":422,"column":29}},"230":{"start":{"line":424,"column":2},"end":{"line":424,"column":16}},"231":{"start":{"line":428,"column":0},"end":{"line":466,"column":1}},"232":{"start":{"line":429,"column":1},"end":{"line":465,"column":2}},"233":{"start":{"line":430,"column":2},"end":{"line":433,"column":3}},"234":{"start":{"line":431,"column":3},"end":{"line":431,"column":23}},"235":{"start":{"line":432,"column":3},"end":{"line":432,"column":10}},"236":{"start":{"line":435,"column":2},"end":{"line":441,"column":5}},"237":{"start":{"line":440,"column":3},"end":{"line":440,"column":16}},"238":{"start":{"line":442,"column":8},"end":{"line":465,"column":2}},"239":{"start":{"line":443,"column":2},"end":{"line":443,"column":29}},"240":{"start":{"line":444,"column":2},"end":{"line":444,"column":35}},"241":{"start":{"line":445,"column":2},"end":{"line":445,"column":29}},"242":{"start":{"line":446,"column":2},"end":{"line":446,"column":50}},"243":{"start":{"line":468,"column":0},"end":{"line":503,"column":1}},"244":{"start":{"line":469,"column":1},"end":{"line":502,"column":2}},"245":{"start":{"line":470,"column":2},"end":{"line":473,"column":3}},"246":{"start":{"line":471,"column":3},"end":{"line":471,"column":23}},"247":{"start":{"line":472,"column":3},"end":{"line":472,"column":10}},"248":{"start":{"line":475,"column":2},"end":{"line":481,"column":5}},"249":{"start":{"line":480,"column":3},"end":{"line":480,"column":16}},"250":{"start":{"line":482,"column":8},"end":{"line":502,"column":2}},"251":{"start":{"line":483,"column":2},"end":{"line":483,"column":35}},"252":{"start":{"line":484,"column":2},"end":{"line":484,"column":29}},"253":{"start":{"line":485,"column":2},"end":{"line":487,"column":3}},"254":{"start":{"line":486,"column":3},"end":{"line":486,"column":41}},"255":{"start":{"line":488,"column":2},"end":{"line":501,"column":5}},"256":{"start":{"line":489,"column":3},"end":{"line":492,"column":4}},"257":{"start":{"line":490,"column":4},"end":{"line":490,"column":12}},"258":{"start":{"line":491,"column":4},"end":{"line":491,"column":11}},"259":{"start":{"line":493,"column":3},"end":{"line":493,"column":23}},"260":{"start":{"line":494,"column":3},"end":{"line":500,"column":4}},"261":{"start":{"line":495,"column":4},"end":{"line":495,"column":35}},"262":{"start":{"line":496,"column":4},"end":{"line":496,"column":37}},"263":{"start":{"line":497,"column":4},"end":{"line":497,"column":42}},"264":{"start":{"line":499,"column":4},"end":{"line":499,"column":40}},"265":{"start":{"line":505,"column":0},"end":{"line":526,"column":1}},"266":{"start":{"line":506,"column":1},"end":{"line":525,"column":2}},"267":{"start":{"line":507,"column":2},"end":{"line":510,"column":3}},"268":{"start":{"line":508,"column":3},"end":{"line":508,"column":23}},"269":{"start":{"line":509,"column":3},"end":{"line":509,"column":10}},"270":{"start":{"line":512,"column":2},"end":{"line":518,"column":5}},"271":{"start":{"line":517,"column":3},"end":{"line":517,"column":17}},"272":{"start":{"line":519,"column":8},"end":{"line":525,"column":2}},"273":{"start":{"line":520,"column":2},"end":{"line":520,"column":27}},"274":{"start":{"line":521,"column":2},"end":{"line":523,"column":3}},"275":{"start":{"line":522,"column":3},"end":{"line":522,"column":18}},"276":{"start":{"line":524,"column":2},"end":{"line":524,"column":24}},"277":{"start":{"line":528,"column":0},"end":{"line":548,"column":1}},"278":{"start":{"line":529,"column":1},"end":{"line":547,"column":2}},"279":{"start":{"line":530,"column":2},"end":{"line":533,"column":3}},"280":{"start":{"line":531,"column":3},"end":{"line":531,"column":23}},"281":{"start":{"line":532,"column":3},"end":{"line":532,"column":10}},"282":{"start":{"line":535,"column":2},"end":{"line":541,"column":5}},"283":{"start":{"line":540,"column":3},"end":{"line":540,"column":17}},"284":{"start":{"line":542,"column":8},"end":{"line":547,"column":2}},"285":{"start":{"line":543,"column":2},"end":{"line":543,"column":25}},"286":{"start":{"line":544,"column":2},"end":{"line":544,"column":29}},"287":{"start":{"line":545,"column":2},"end":{"line":545,"column":22}},"288":{"start":{"line":546,"column":2},"end":{"line":546,"column":47}},"289":{"start":{"line":550,"column":0},"end":{"line":568,"column":1}},"290":{"start":{"line":551,"column":1},"end":{"line":567,"column":2}},"291":{"start":{"line":552,"column":2},"end":{"line":555,"column":3}},"292":{"start":{"line":553,"column":3},"end":{"line":553,"column":23}},"293":{"start":{"line":554,"column":3},"end":{"line":554,"column":10}},"294":{"start":{"line":557,"column":2},"end":{"line":563,"column":5}},"295":{"start":{"line":562,"column":3},"end":{"line":562,"column":17}},"296":{"start":{"line":564,"column":8},"end":{"line":567,"column":2}},"297":{"start":{"line":565,"column":2},"end":{"line":565,"column":20}},"298":{"start":{"line":566,"column":2},"end":{"line":566,"column":38}},"299":{"start":{"line":570,"column":0},"end":{"line":588,"column":1}},"300":{"start":{"line":571,"column":1},"end":{"line":587,"column":2}},"301":{"start":{"line":572,"column":2},"end":{"line":575,"column":3}},"302":{"start":{"line":573,"column":3},"end":{"line":573,"column":23}},"303":{"start":{"line":574,"column":3},"end":{"line":574,"column":10}},"304":{"start":{"line":577,"column":2},"end":{"line":583,"column":5}},"305":{"start":{"line":582,"column":3},"end":{"line":582,"column":17}},"306":{"start":{"line":584,"column":8},"end":{"line":587,"column":2}},"307":{"start":{"line":585,"column":2},"end":{"line":585,"column":21}},"308":{"start":{"line":586,"column":2},"end":{"line":586,"column":39}},"309":{"start":{"line":590,"column":0},"end":{"line":616,"column":1}},"310":{"start":{"line":591,"column":1},"end":{"line":615,"column":2}},"311":{"start":{"line":592,"column":2},"end":{"line":595,"column":3}},"312":{"start":{"line":593,"column":3},"end":{"line":593,"column":23}},"313":{"start":{"line":594,"column":3},"end":{"line":594,"column":10}},"314":{"start":{"line":597,"column":2},"end":{"line":603,"column":5}},"315":{"start":{"line":602,"column":3},"end":{"line":602,"column":17}},"316":{"start":{"line":604,"column":8},"end":{"line":615,"column":2}},"317":{"start":{"line":605,"column":2},"end":{"line":608,"column":4}},"318":{"start":{"line":609,"column":2},"end":{"line":614,"column":3}},"319":{"start":{"line":610,"column":3},"end":{"line":610,"column":60}},"320":{"start":{"line":611,"column":3},"end":{"line":611,"column":38}},"321":{"start":{"line":613,"column":3},"end":{"line":613,"column":21}},"322":{"start":{"line":618,"column":0},"end":{"line":620,"column":1}},"323":{"start":{"line":622,"column":0},"end":{"line":636,"column":1}},"324":{"start":{"line":623,"column":1},"end":{"line":623,"column":17}},"325":{"start":{"line":624,"column":1},"end":{"line":624,"column":14}},"326":{"start":{"line":625,"column":1},"end":{"line":631,"column":2}},"327":{"start":{"line":626,"column":2},"end":{"line":628,"column":3}},"328":{"start":{"line":627,"column":3},"end":{"line":627,"column":12}},"329":{"start":{"line":629,"column":2},"end":{"line":629,"column":11}},"330":{"start":{"line":630,"column":2},"end":{"line":630,"column":25}},"331":{"start":{"line":632,"column":1},"end":{"line":634,"column":2}},"332":{"start":{"line":635,"column":1},"end":{"line":635,"column":15}},"333":{"start":{"line":638,"column":0},"end":{"line":651,"column":1}},"334":{"start":{"line":639,"column":1},"end":{"line":642,"column":2}},"335":{"start":{"line":640,"column":2},"end":{"line":640,"column":28}},"336":{"start":{"line":641,"column":2},"end":{"line":641,"column":9}},"337":{"start":{"line":643,"column":1},"end":{"line":650,"column":3}},"338":{"start":{"line":644,"column":2},"end":{"line":647,"column":3}},"339":{"start":{"line":645,"column":3},"end":{"line":645,"column":32}},"340":{"start":{"line":646,"column":3},"end":{"line":646,"column":10}},"341":{"start":{"line":648,"column":2},"end":{"line":648,"column":26}},"342":{"start":{"line":649,"column":2},"end":{"line":649,"column":11}},"343":{"start":{"line":653,"column":0},"end":{"line":679,"column":1}},"344":{"start":{"line":654,"column":1},"end":{"line":654,"column":14}},"345":{"start":{"line":655,"column":1},"end":{"line":655,"column":42}},"346":{"start":{"line":656,"column":1},"end":{"line":678,"column":2}},"347":{"start":{"line":657,"column":2},"end":{"line":657,"column":46}},"348":{"start":{"line":658,"column":2},"end":{"line":658,"column":42}},"349":{"start":{"line":659,"column":2},"end":{"line":675,"column":3}},"350":{"start":{"line":660,"column":3},"end":{"line":660,"column":43}},"351":{"start":{"line":662,"column":3},"end":{"line":662,"column":35}},"352":{"start":{"line":663,"column":3},"end":{"line":663,"column":27}},"353":{"start":{"line":664,"column":3},"end":{"line":664,"column":18}},"354":{"start":{"line":665,"column":3},"end":{"line":673,"column":4}},"355":{"start":{"line":666,"column":4},"end":{"line":666,"column":24}},"356":{"start":{"line":667,"column":4},"end":{"line":667,"column":27}},"357":{"start":{"line":668,"column":4},"end":{"line":672,"column":5}},"358":{"start":{"line":669,"column":5},"end":{"line":671,"column":6}},"359":{"start":{"line":670,"column":6},"end":{"line":670,"column":43}},"360":{"start":{"line":674,"column":3},"end":{"line":674,"column":17}},"361":{"start":{"line":677,"column":2},"end":{"line":677,"column":24}},"362":{"start":{"line":681,"column":0},"end":{"line":707,"column":1}},"363":{"start":{"line":682,"column":1},"end":{"line":682,"column":14}},"364":{"start":{"line":683,"column":1},"end":{"line":683,"column":44}},"365":{"start":{"line":684,"column":1},"end":{"line":706,"column":2}},"366":{"start":{"line":685,"column":2},"end":{"line":685,"column":58}},"367":{"start":{"line":686,"column":2},"end":{"line":686,"column":42}},"368":{"start":{"line":687,"column":2},"end":{"line":703,"column":3}},"369":{"start":{"line":688,"column":3},"end":{"line":688,"column":43}},"370":{"start":{"line":690,"column":3},"end":{"line":690,"column":35}},"371":{"start":{"line":691,"column":3},"end":{"line":691,"column":21}},"372":{"start":{"line":692,"column":3},"end":{"line":692,"column":18}},"373":{"start":{"line":693,"column":3},"end":{"line":701,"column":4}},"374":{"start":{"line":694,"column":4},"end":{"line":694,"column":20}},"375":{"start":{"line":695,"column":4},"end":{"line":695,"column":23}},"376":{"start":{"line":696,"column":4},"end":{"line":700,"column":5}},"377":{"start":{"line":697,"column":5},"end":{"line":699,"column":6}},"378":{"start":{"line":698,"column":6},"end":{"line":698,"column":37}},"379":{"start":{"line":702,"column":3},"end":{"line":702,"column":17}},"380":{"start":{"line":705,"column":2},"end":{"line":705,"column":26}},"381":{"start":{"line":709,"column":0},"end":{"line":715,"column":1}},"382":{"start":{"line":710,"column":1},"end":{"line":710,"column":32}},"383":{"start":{"line":711,"column":1},"end":{"line":713,"column":2}},"384":{"start":{"line":712,"column":2},"end":{"line":712,"column":11}},"385":{"start":{"line":714,"column":1},"end":{"line":714,"column":10}},"386":{"start":{"line":717,"column":0},"end":{"line":727,"column":1}},"387":{"start":{"line":718,"column":1},"end":{"line":720,"column":2}},"388":{"start":{"line":719,"column":2},"end":{"line":719,"column":14}},"389":{"start":{"line":721,"column":1},"end":{"line":725,"column":2}},"390":{"start":{"line":722,"column":2},"end":{"line":722,"column":22}},"391":{"start":{"line":724,"column":2},"end":{"line":724,"column":15}},"392":{"start":{"line":726,"column":1},"end":{"line":726,"column":13}}},"branchMap":{"1":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":12}},{"start":{"line":21,"column":16},"end":{"line":21,"column":18}}]},"2":{"line":33,"type":"switch","locations":[{"start":{"line":34,"column":2},"end":{"line":36,"column":9}},{"start":{"line":37,"column":2},"end":{"line":39,"column":9}},{"start":{"line":40,"column":2},"end":{"line":42,"column":9}},{"start":{"line":43,"column":2},"end":{"line":45,"column":9}},{"start":{"line":46,"column":2},"end":{"line":48,"column":9}},{"start":{"line":49,"column":2},"end":{"line":51,"column":9}},{"start":{"line":52,"column":2},"end":{"line":54,"column":9}},{"start":{"line":55,"column":2},"end":{"line":57,"column":9}},{"start":{"line":58,"column":2},"end":{"line":60,"column":9}},{"start":{"line":61,"column":2},"end":{"line":63,"column":9}},{"start":{"line":64,"column":2},"end":{"line":66,"column":9}},{"start":{"line":67,"column":2},"end":{"line":69,"column":9}},{"start":{"line":70,"column":2},"end":{"line":72,"column":9}},{"start":{"line":73,"column":2},"end":{"line":75,"column":9}},{"start":{"line":76,"column":2},"end":{"line":78,"column":9}},{"start":{"line":79,"column":2},"end":{"line":81,"column":9}},{"start":{"line":82,"column":2},"end":{"line":84,"column":9}},{"start":{"line":85,"column":2},"end":{"line":86,"column":47}}]},"3":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},{"start":{"line":96,"column":1},"end":{"line":96,"column":1}}]},"4":{"line":96,"type":"binary-expr","locations":[{"start":{"line":96,"column":5},"end":{"line":96,"column":10}},{"start":{"line":96,"column":14},"end":{"line":96,"column":22}}]},"5":{"line":102,"type":"switch","locations":[{"start":{"line":103,"column":2},"end":{"line":105,"column":9}},{"start":{"line":106,"column":2},"end":{"line":108,"column":9}},{"start":{"line":109,"column":2},"end":{"line":111,"column":9}},{"start":{"line":112,"column":2},"end":{"line":114,"column":9}},{"start":{"line":115,"column":2},"end":{"line":117,"column":9}},{"start":{"line":118,"column":2},"end":{"line":120,"column":9}},{"start":{"line":121,"column":2},"end":{"line":123,"column":9}},{"start":{"line":124,"column":2},"end":{"line":126,"column":9}},{"start":{"line":127,"column":2},"end":{"line":129,"column":9}},{"start":{"line":130,"column":2},"end":{"line":132,"column":9}},{"start":{"line":133,"column":2},"end":{"line":135,"column":9}},{"start":{"line":136,"column":2},"end":{"line":138,"column":9}},{"start":{"line":139,"column":2},"end":{"line":141,"column":9}},{"start":{"line":142,"column":2},"end":{"line":144,"column":9}},{"start":{"line":145,"column":2},"end":{"line":147,"column":9}},{"start":{"line":148,"column":2},"end":{"line":150,"column":9}},{"start":{"line":151,"column":2},"end":{"line":153,"column":9}},{"start":{"line":154,"column":2},"end":{"line":155,"column":47}}]},"6":{"line":160,"type":"if","locations":[{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},{"start":{"line":160,"column":1},"end":{"line":160,"column":1}}]},"7":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":8},"end":{"line":180,"column":8}},{"start":{"line":180,"column":8},"end":{"line":180,"column":8}}]},"8":{"line":204,"type":"if","locations":[{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},{"start":{"line":204,"column":1},"end":{"line":204,"column":1}}]},"9":{"line":205,"type":"if","locations":[{"start":{"line":205,"column":2},"end":{"line":205,"column":2}},{"start":{"line":205,"column":2},"end":{"line":205,"column":2}}]},"10":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":4},"end":{"line":210,"column":4}},{"start":{"line":210,"column":4},"end":{"line":210,"column":4}}]},"11":{"line":222,"type":"if","locations":[{"start":{"line":222,"column":4},"end":{"line":222,"column":4}},{"start":{"line":222,"column":4},"end":{"line":222,"column":4}}]},"12":{"line":234,"type":"if","locations":[{"start":{"line":234,"column":3},"end":{"line":234,"column":3}},{"start":{"line":234,"column":3},"end":{"line":234,"column":3}}]},"13":{"line":237,"type":"if","locations":[{"start":{"line":237,"column":3},"end":{"line":237,"column":3}},{"start":{"line":237,"column":3},"end":{"line":237,"column":3}}]},"14":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":8},"end":{"line":252,"column":8}},{"start":{"line":252,"column":8},"end":{"line":252,"column":8}}]},"15":{"line":254,"type":"if","locations":[{"start":{"line":254,"column":2},"end":{"line":254,"column":2}},{"start":{"line":254,"column":2},"end":{"line":254,"column":2}}]},"16":{"line":286,"type":"if","locations":[{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},{"start":{"line":286,"column":1},"end":{"line":286,"column":1}}]},"17":{"line":295,"type":"if","locations":[{"start":{"line":295,"column":8},"end":{"line":295,"column":8}},{"start":{"line":295,"column":8},"end":{"line":295,"column":8}}]},"18":{"line":312,"type":"if","locations":[{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},{"start":{"line":312,"column":1},"end":{"line":312,"column":1}}]},"19":{"line":313,"type":"if","locations":[{"start":{"line":313,"column":2},"end":{"line":313,"column":2}},{"start":{"line":313,"column":2},"end":{"line":313,"column":2}}]},"20":{"line":315,"type":"binary-expr","locations":[{"start":{"line":315,"column":18},"end":{"line":315,"column":41}},{"start":{"line":315,"column":45},"end":{"line":315,"column":76}}]},"21":{"line":328,"type":"if","locations":[{"start":{"line":328,"column":8},"end":{"line":328,"column":8}},{"start":{"line":328,"column":8},"end":{"line":328,"column":8}}]},"22":{"line":335,"type":"if","locations":[{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},{"start":{"line":335,"column":1},"end":{"line":335,"column":1}}]},"23":{"line":336,"type":"if","locations":[{"start":{"line":336,"column":2},"end":{"line":336,"column":2}},{"start":{"line":336,"column":2},"end":{"line":336,"column":2}}]},"24":{"line":348,"type":"if","locations":[{"start":{"line":348,"column":8},"end":{"line":348,"column":8}},{"start":{"line":348,"column":8},"end":{"line":348,"column":8}}]},"25":{"line":354,"type":"if","locations":[{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},{"start":{"line":354,"column":1},"end":{"line":354,"column":1}}]},"26":{"line":355,"type":"if","locations":[{"start":{"line":355,"column":2},"end":{"line":355,"column":2}},{"start":{"line":355,"column":2},"end":{"line":355,"column":2}}]},"27":{"line":367,"type":"if","locations":[{"start":{"line":367,"column":8},"end":{"line":367,"column":8}},{"start":{"line":367,"column":8},"end":{"line":367,"column":8}}]},"28":{"line":373,"type":"if","locations":[{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},{"start":{"line":373,"column":1},"end":{"line":373,"column":1}}]},"29":{"line":374,"type":"if","locations":[{"start":{"line":374,"column":2},"end":{"line":374,"column":2}},{"start":{"line":374,"column":2},"end":{"line":374,"column":2}}]},"30":{"line":386,"type":"if","locations":[{"start":{"line":386,"column":8},"end":{"line":386,"column":8}},{"start":{"line":386,"column":8},"end":{"line":386,"column":8}}]},"31":{"line":398,"type":"if","locations":[{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},{"start":{"line":398,"column":1},"end":{"line":398,"column":1}}]},"32":{"line":399,"type":"if","locations":[{"start":{"line":399,"column":2},"end":{"line":399,"column":2}},{"start":{"line":399,"column":2},"end":{"line":399,"column":2}}]},"33":{"line":411,"type":"if","locations":[{"start":{"line":411,"column":8},"end":{"line":411,"column":8}},{"start":{"line":411,"column":8},"end":{"line":411,"column":8}}]},"34":{"line":415,"type":"if","locations":[{"start":{"line":415,"column":3},"end":{"line":415,"column":3}},{"start":{"line":415,"column":3},"end":{"line":415,"column":3}}]},"35":{"line":415,"type":"binary-expr","locations":[{"start":{"line":415,"column":7},"end":{"line":415,"column":29}},{"start":{"line":415,"column":33},"end":{"line":415,"column":56}}]},"36":{"line":418,"type":"if","locations":[{"start":{"line":418,"column":3},"end":{"line":418,"column":3}},{"start":{"line":418,"column":3},"end":{"line":418,"column":3}}]},"37":{"line":429,"type":"if","locations":[{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},{"start":{"line":429,"column":1},"end":{"line":429,"column":1}}]},"38":{"line":430,"type":"if","locations":[{"start":{"line":430,"column":2},"end":{"line":430,"column":2}},{"start":{"line":430,"column":2},"end":{"line":430,"column":2}}]},"39":{"line":442,"type":"if","locations":[{"start":{"line":442,"column":8},"end":{"line":442,"column":8}},{"start":{"line":442,"column":8},"end":{"line":442,"column":8}}]},"40":{"line":469,"type":"if","locations":[{"start":{"line":469,"column":1},"end":{"line":469,"column":1}},{"start":{"line":469,"column":1},"end":{"line":469,"column":1}}]},"41":{"line":470,"type":"if","locations":[{"start":{"line":470,"column":2},"end":{"line":470,"column":2}},{"start":{"line":470,"column":2},"end":{"line":470,"column":2}}]},"42":{"line":482,"type":"if","locations":[{"start":{"line":482,"column":8},"end":{"line":482,"column":8}},{"start":{"line":482,"column":8},"end":{"line":482,"column":8}}]},"43":{"line":485,"type":"if","locations":[{"start":{"line":485,"column":2},"end":{"line":485,"column":2}},{"start":{"line":485,"column":2},"end":{"line":485,"column":2}}]},"44":{"line":489,"type":"if","locations":[{"start":{"line":489,"column":3},"end":{"line":489,"column":3}},{"start":{"line":489,"column":3},"end":{"line":489,"column":3}}]},"45":{"line":506,"type":"if","locations":[{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},{"start":{"line":506,"column":1},"end":{"line":506,"column":1}}]},"46":{"line":507,"type":"if","locations":[{"start":{"line":507,"column":2},"end":{"line":507,"column":2}},{"start":{"line":507,"column":2},"end":{"line":507,"column":2}}]},"47":{"line":519,"type":"if","locations":[{"start":{"line":519,"column":8},"end":{"line":519,"column":8}},{"start":{"line":519,"column":8},"end":{"line":519,"column":8}}]},"48":{"line":521,"type":"if","locations":[{"start":{"line":521,"column":2},"end":{"line":521,"column":2}},{"start":{"line":521,"column":2},"end":{"line":521,"column":2}}]},"49":{"line":524,"type":"binary-expr","locations":[{"start":{"line":524,"column":11},"end":{"line":524,"column":14}},{"start":{"line":524,"column":18},"end":{"line":524,"column":22}}]},"50":{"line":529,"type":"if","locations":[{"start":{"line":529,"column":1},"end":{"line":529,"column":1}},{"start":{"line":529,"column":1},"end":{"line":529,"column":1}}]},"51":{"line":530,"type":"if","locations":[{"start":{"line":530,"column":2},"end":{"line":530,"column":2}},{"start":{"line":530,"column":2},"end":{"line":530,"column":2}}]},"52":{"line":542,"type":"if","locations":[{"start":{"line":542,"column":8},"end":{"line":542,"column":8}},{"start":{"line":542,"column":8},"end":{"line":542,"column":8}}]},"53":{"line":551,"type":"if","locations":[{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},{"start":{"line":551,"column":1},"end":{"line":551,"column":1}}]},"54":{"line":552,"type":"if","locations":[{"start":{"line":552,"column":2},"end":{"line":552,"column":2}},{"start":{"line":552,"column":2},"end":{"line":552,"column":2}}]},"55":{"line":564,"type":"if","locations":[{"start":{"line":564,"column":8},"end":{"line":564,"column":8}},{"start":{"line":564,"column":8},"end":{"line":564,"column":8}}]},"56":{"line":571,"type":"if","locations":[{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},{"start":{"line":571,"column":1},"end":{"line":571,"column":1}}]},"57":{"line":572,"type":"if","locations":[{"start":{"line":572,"column":2},"end":{"line":572,"column":2}},{"start":{"line":572,"column":2},"end":{"line":572,"column":2}}]},"58":{"line":584,"type":"if","locations":[{"start":{"line":584,"column":8},"end":{"line":584,"column":8}},{"start":{"line":584,"column":8},"end":{"line":584,"column":8}}]},"59":{"line":591,"type":"if","locations":[{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},{"start":{"line":591,"column":1},"end":{"line":591,"column":1}}]},"60":{"line":592,"type":"if","locations":[{"start":{"line":592,"column":2},"end":{"line":592,"column":2}},{"start":{"line":592,"column":2},"end":{"line":592,"column":2}}]},"61":{"line":604,"type":"if","locations":[{"start":{"line":604,"column":8},"end":{"line":604,"column":8}},{"start":{"line":604,"column":8},"end":{"line":604,"column":8}}]},"62":{"line":626,"type":"if","locations":[{"start":{"line":626,"column":2},"end":{"line":626,"column":2}},{"start":{"line":626,"column":2},"end":{"line":626,"column":2}}]},"63":{"line":626,"type":"binary-expr","locations":[{"start":{"line":626,"column":6},"end":{"line":626,"column":36}},{"start":{"line":626,"column":40},"end":{"line":626,"column":68}}]},"64":{"line":632,"type":"if","locations":[{"start":{"line":632,"column":1},"end":{"line":632,"column":1}},{"start":{"line":632,"column":1},"end":{"line":632,"column":1}}]},"65":{"line":639,"type":"if","locations":[{"start":{"line":639,"column":1},"end":{"line":639,"column":1}},{"start":{"line":639,"column":1},"end":{"line":639,"column":1}}]},"66":{"line":639,"type":"binary-expr","locations":[{"start":{"line":639,"column":5},"end":{"line":639,"column":11}},{"start":{"line":639,"column":15},"end":{"line":639,"column":38}}]},"67":{"line":644,"type":"if","locations":[{"start":{"line":644,"column":2},"end":{"line":644,"column":2}},{"start":{"line":644,"column":2},"end":{"line":644,"column":2}}]},"68":{"line":656,"type":"if","locations":[{"start":{"line":656,"column":1},"end":{"line":656,"column":1}},{"start":{"line":656,"column":1},"end":{"line":656,"column":1}}]},"69":{"line":656,"type":"binary-expr","locations":[{"start":{"line":656,"column":5},"end":{"line":656,"column":14}},{"start":{"line":656,"column":18},"end":{"line":656,"column":34}},{"start":{"line":656,"column":38},"end":{"line":656,"column":67}}]},"70":{"line":659,"type":"if","locations":[{"start":{"line":659,"column":2},"end":{"line":659,"column":2}},{"start":{"line":659,"column":2},"end":{"line":659,"column":2}}]},"71":{"line":669,"type":"if","locations":[{"start":{"line":669,"column":5},"end":{"line":669,"column":5}},{"start":{"line":669,"column":5},"end":{"line":669,"column":5}}]},"72":{"line":684,"type":"if","locations":[{"start":{"line":684,"column":1},"end":{"line":684,"column":1}},{"start":{"line":684,"column":1},"end":{"line":684,"column":1}}]},"73":{"line":684,"type":"binary-expr","locations":[{"start":{"line":684,"column":5},"end":{"line":684,"column":15}},{"start":{"line":684,"column":19},"end":{"line":684,"column":36}},{"start":{"line":684,"column":40},"end":{"line":684,"column":81}}]},"74":{"line":687,"type":"if","locations":[{"start":{"line":687,"column":2},"end":{"line":687,"column":2}},{"start":{"line":687,"column":2},"end":{"line":687,"column":2}}]},"75":{"line":697,"type":"if","locations":[{"start":{"line":697,"column":5},"end":{"line":697,"column":5}},{"start":{"line":697,"column":5},"end":{"line":697,"column":5}}]},"76":{"line":711,"type":"if","locations":[{"start":{"line":711,"column":1},"end":{"line":711,"column":1}},{"start":{"line":711,"column":1},"end":{"line":711,"column":1}}]},"77":{"line":718,"type":"if","locations":[{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},{"start":{"line":718,"column":1},"end":{"line":718,"column":1}}]}},"code":["/*!"," * Pomelo -- consoleModule watchServer"," * Copyright(c) 2013 fantasyni <fantasyni@163.com>"," * MIT Licensed"," */","var logger = require('pomelo-logger').getLogger('pomelo-admin', __filename);","var countDownLatch = require('../util/countDownLatch');","var monitor = require('pomelo-monitor');","var utils = require('../util/utils');","var util = require('util');","var fs = require('fs');","var vm = require('vm');","","module.exports = function(opts) {","\treturn new Module(opts);","};","","module.exports.moduleId = 'watchServer';","","var Module = function(opts) {","\topts = opts || {};","\tthis.app = opts.app;","};","","Module.prototype.monitorHandler = function(agent, msg, cb) {","\tvar comd = msg['comd'];","\tvar context = msg['context'];","\tvar param = msg['param'];","\tvar app = this.app;","","\tvar handle = 'monitor';","","\tswitch (comd) {","\t\tcase 'servers':","\t\t\tshowServers(handle, agent, comd, context, cb);","\t\t\tbreak;","\t\tcase 'connections':","\t\t\tshowConnections(handle, agent, app, comd, context, cb);","\t\t\tbreak;","\t\tcase 'logins':","\t\t\tshowLogins(handle, agent, app, comd, context, cb);","\t\t\tbreak;","\t\tcase 'modules':","\t\t\tshowModules(handle, agent, comd, context, cb);","\t\t\tbreak;","\t\tcase 'status':","\t\t\tshowStatus(handle, agent, comd, context, cb);","\t\t\tbreak;","\t\tcase 'config':","\t\t\tshowConfig(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'proxy':","\t\t\tshowProxy(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'handler':","\t\t\tshowHandler(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'components':","\t\t\tshowComponents(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'settings':","\t\t\tshowSettings(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'cpu':","\t\t\tdumpCPU(handle, agent, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'memory':","\t\t\tdumpMemory(handle, agent, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'get':","\t\t\tgetApp(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'set':","\t\t\tsetApp(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'enable':","\t\t\tenableApp(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'disable':","\t\t\tdisableApp(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'run':","\t\t\trunScript(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tdefault:","\t\t\tshowError(handle, agent, comd, context, cb);","\t}","};","","Module.prototype.clientHandler = function(agent, msg, cb) {","\tvar comd = msg['comd'];","\tvar context = msg['context'];","\tvar param = msg['param'];","\tvar app = this.app; // master app","","\tif (!comd || !context) {","\t\tcb('lack of comd or context param');","\t\treturn;","\t}","","\tvar handle = 'client';","\tswitch (comd) {","\t\tcase 'servers':","\t\t\tshowServers(handle, agent, comd, context, cb);","\t\t\tbreak;","\t\tcase 'connections':","\t\t\tshowConnections(handle, agent, app, comd, context, cb);","\t\t\tbreak;","\t\tcase 'logins':","\t\t\tshowLogins(handle, agent, app, comd, context, cb);","\t\t\tbreak;","\t\tcase 'modules':","\t\t\tshowModules(handle, agent, comd, context, cb);","\t\t\tbreak;","\t\tcase 'status':","\t\t\tshowStatus(handle, agent, comd, context, cb);","\t\t\tbreak;","\t\tcase 'config':","\t\t\tshowConfig(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'proxy':","\t\t\tshowProxy(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'handler':","\t\t\tshowHandler(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'components':","\t\t\tshowComponents(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'settings':","\t\t\tshowSettings(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'cpu':","\t\t\tdumpCPU(handle, agent, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'memory':","\t\t\tdumpMemory(handle, agent, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'get':","\t\t\tgetApp(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'set':","\t\t\tsetApp(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'enable':","\t\t\tenableApp(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'disable':","\t\t\tdisableApp(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tcase 'run':","\t\t\trunScript(handle, agent, app, comd, context, param, cb);","\t\t\tbreak;","\t\tdefault:","\t\t\tshowError(handle, agent, comd, context, cb);","\t}","};","","function showServers(handle, agent, comd, context, cb) {","\tif (handle === 'client') {","\t\tvar sid, record;","\t\tvar serverInfo = {};","\t\tvar count = utils.size(agent.idMap);","\t\tvar latch = countDownLatch.createCountDownLatch(count, function() {","\t\t\tcb(null, {","\t\t\t\tmsg: serverInfo","\t\t\t});","\t\t});","","\t\tfor (sid in agent.idMap) {","\t\t\trecord = agent.idMap[sid];","\t\t\tagent.request(record.id, module.exports.moduleId, {","\t\t\t\tcomd: comd,","\t\t\t\tcontext: context","\t\t\t}, function(msg) {","\t\t\t\tserverInfo[msg.serverId] = msg.body;","\t\t\t\tlatch.done();","\t\t\t});","\t\t}","\t} else if (handle === 'monitor') {","\t\tvar serverId = agent.id;","\t\tvar serverType = agent.type;","\t\tvar info = agent.info;","\t\tvar pid = process.pid;","\t\tvar heapUsed = (process.memoryUsage().heapUsed / (1000 * 1000)).toFixed(2);","\t\tvar uptime = (process.uptime() / 60).toFixed(2);","\t\tcb({","\t\t\tserverId: serverId,","\t\t\tbody: {","\t\t\t\tserverId: serverId,","\t\t\t\tserverType: serverType,","\t\t\t\thost: info['host'],","\t\t\t\tport: info['port'],","\t\t\t\tpid: pid,","\t\t\t\theapUsed: heapUsed,","\t\t\t\tuptime: uptime","\t\t\t}","\t\t});","\t}","","}","","function showConnections(handle, agent, app, comd, context, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tvar sid, record;","\t\t\tvar serverInfo = {};","\t\t\tvar count = 0;","\t\t\tfor (var key in agent.idMap) {","\t\t\t\tif (agent.idMap[key].info.frontend === 'true') {","\t\t\t\t\tcount++;","\t\t\t\t}","\t\t\t}","\t\t\tvar latch = countDownLatch.createCountDownLatch(count, function() {","\t\t\t\tcb(null, {","\t\t\t\t\tmsg: serverInfo","\t\t\t\t});","\t\t\t});","","\t\t\tfor (sid in agent.idMap) {","\t\t\t\trecord = agent.idMap[sid];","\t\t\t\tif (record.info.frontend === 'true') {","\t\t\t\t\tagent.request(record.id, module.exports.moduleId, {","\t\t\t\t\t\tcomd: comd,","\t\t\t\t\t\tcontext: context","\t\t\t\t\t}, function(msg) {","\t\t\t\t\t\tserverInfo[msg.serverId] = msg.body;","\t\t\t\t\t\tlatch.done();","\t\t\t\t\t});","\t\t\t\t}","\t\t\t}","\t\t} else {","\t\t\tvar record = agent.idMap[context];","\t\t\tif (!record) {","\t\t\t\tcb(\"the server \" + context + \" not exist\");","\t\t\t}","\t\t\tif (record.info.frontend === 'true') {","\t\t\t\tagent.request(record.id, module.exports.moduleId, {","\t\t\t\t\tcomd: comd,","\t\t\t\t\tcontext: context","\t\t\t\t}, function(msg) {","\t\t\t\t\tvar serverInfo = {};","\t\t\t\t\tserverInfo[msg.serverId] = msg.body;","\t\t\t\t\tcb(null, {","\t\t\t\t\t\tmsg: serverInfo","\t\t\t\t\t});","\t\t\t\t});","\t\t\t} else {","\t\t\t\tcb('\\nthis command should be applied to frontend server\\n');","\t\t\t}","\t\t}","\t} else if (handle === 'monitor') {","\t\tvar connection = app.components.__connection__;","\t\tif (!connection) {","\t\t\tcb({","\t\t\t\tserverId: agent.id,","\t\t\t\tbody: 'error'","\t\t\t});","\t\t\treturn;","\t\t}","","\t\tcb({","\t\t\tserverId: agent.id,","\t\t\tbody: connection.getStatisticsInfo()","\t\t});","\t}","}","","","function showLogins(handle, agent, app, comd, context, cb) {","\tshowConnections(handle, agent, app, comd, context, cb);","}","","function showModules(handle, agent, comd, context, cb) {","\tvar modules = agent.consoleService.modules;","\tvar result = [];","\tfor (var module in modules) {","\t\tresult.push(module);","\t}","\tcb(null, {","\t\tmsg: result","\t});","}","","function showStatus(handle, agent, comd, context, cb) {","\tif (handle === 'client') {","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, {","\t\t\t\tmsg: msg","\t\t\t});","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar serverId = agent.id;","\t\tvar pid = process.pid;","\t\tvar params = {","\t\t\tserverId: serverId,","\t\t\tpid: pid","\t\t};","\t\tmonitor.psmonitor.getPsInfo(params, function(err, data) {","\t\t\tcb(null, {","\t\t\t\tserverId: agent.id,","\t\t\t\tbody: data","\t\t\t})","\t\t});","\t}","}","","function showConfig(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (param === 'master') {","\t\t\tcb(null, {","\t\t\t\tmasterConfig: app.get('masterConfig') || 'no config to master in app.js',","\t\t\t\tmasterInfo: app.get('master')","\t\t\t});","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar key = param + 'Config';","\t\tcb(null, clone(param, app.get(key)));","\t}","}","","function showProxy(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tproxyCb(app, context, cb);","\t}","}","","function showHandler(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\thandlerCb(app, context, cb);","\t}","}","","function showComponents(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar _components = app.components;","\t\tvar res = {};","\t\tfor (var key in _components) {","\t\t\tvar name = getComponentName(key);","\t\t\tres[name] = clone(name, app.get(name + 'Config'))","\t\t}","\t\tcb(null, res);","\t}","}","","function showSettings(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar _settings = app.settings;","\t\tvar res = {};","\t\tfor (var key in _settings) {","\t\t\tif (key.match(/^__\\w+__$/) || key.match(/\\w+Config$/)) {","\t\t\t\tcontinue;","\t\t\t}","\t\t\tif (!checkJSON(_settings[key])) {","\t\t\t\tres[key] = 'Object';","\t\t\t\tcontinue;","\t\t\t}","\t\t\tres[key] = _settings[key];","\t\t}","\t\tcb(null, res);","\t}","}","","function dumpCPU(handle, agent, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(err, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar times = param['times'];","\t\tvar filepath = param['filepath'];","\t\tvar force = param['force'];","\t\tcb(null, 'cpu dump is unused in 1.0 of pomelo');","\t\t/**","\t\tif (!/\\.cpuprofile$/.test(filepath)) {","\t\t\tfilepath = filepath + '.cpuprofile';","\t\t}","\t\tif (!times || !/^[0-9]*[1-9][0-9]*$/.test(times)) {","\t\t\tcb('no times or times invalid error');","\t\t\treturn;","\t\t}","\t\tcheckFilePath(filepath, force, function(err) {","\t\t\tif (err) {","\t\t\t\tcb(err);","\t\t\t\treturn;","\t\t\t}","\t\t\t//ndump.cpu(filepath, times);","\t\t\tcb(null, filepath + ' cpu dump ok');","\t\t});","\t\t*/","","\t}","}","","function dumpMemory(handle, agent, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(err, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar filepath = param['filepath'];","\t\tvar force = param['force'];","\t\tif (!/\\.heapsnapshot$/.test(filepath)) {","\t\t\tfilepath = filepath + '.heapsnapshot';","\t\t}","\t\tcheckFilePath(filepath, force, function(err) {","\t\t\tif (err) {","\t\t\t\tcb(err);","\t\t\t\treturn;","\t\t\t}","\t\t\tvar heapdump = null;","\t\t\ttry {","\t\t\t\theapdump = require('heapdump');","\t\t\t\theapdump.writeSnapshot(filepath);","\t\t\t\tcb(null, filepath + ' memory dump ok')","\t\t\t} catch (e) {","\t\t\t\tcb('pomelo-admin require heapdump');","\t\t\t}","\t\t});","\t}","}","","function getApp(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar res = app.get(param);","\t\tif (!checkJSON(res)) {","\t\t\tres = 'object';","\t\t}","\t\tcb(null, res || null);","\t}","}","","function setApp(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar key = param['key'];","\t\tvar value = param['value'];","\t\tapp.set(key, value);","\t\tcb(null, 'set ' + key + ':' + value + ' ok');","\t}","}","","function enableApp(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tapp.enable(param);","\t\tcb(null, 'enable ' + param + ' ok');","\t}","}","","function disableApp(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tapp.disable(param);","\t\tcb(null, 'disable ' + param + ' ok');","\t}","}","","function runScript(handle, agent, app, comd, context, param, cb) {","\tif (handle === 'client') {","\t\tif (context === 'all') {","\t\t\tcb('context error');","\t\t\treturn;","\t\t}","","\t\tagent.request(context, module.exports.moduleId, {","\t\t\tcomd: comd,","\t\t\tparam: param,","\t\t\tcontext: context","\t\t}, function(err, msg) {","\t\t\tcb(null, msg);","\t\t});","\t} else if (handle === 'monitor') {","\t\tvar ctx = {","\t\t\tapp: app,","\t\t\tresult: null","\t\t};","\t\ttry {","\t\t\tvm.runInNewContext('result = ' + param, ctx, 'myApp.vm');","\t\t\tcb(null, util.inspect(ctx.result));","\t\t} catch (e) {","\t\t\tcb(null, e.stack);","\t\t}","\t}","}","","function showError(handle, agent, comd, context, cb) {","","}","","function clone(param, obj) {","\tvar result = {};","\tvar flag = 1;","\tfor (var key in obj) {","\t\tif (typeof obj[key] === 'function' || typeof obj[key] === 'object') {","\t\t\tcontinue;","\t\t}","\t\tflag = 0;","\t\tresult[key] = obj[key];","\t}","\tif (flag) {","\t\t// return 'no ' + param + 'Config info';","\t}","\treturn result;","}","","function checkFilePath(filepath, force, cb) {","\tif (!force && fs.existsSync(filepath)) {","\t\tcb('filepath file exist');","\t\treturn;","\t}","\tfs.writeFile(filepath, 'test', function(err) {","\t\tif (err) {","\t\t\tcb('filepath invalid error');","\t\t\treturn;","\t\t}","\t\tfs.unlinkSync(filepath);","\t\tcb(null);","\t})","}","","function proxyCb(app, context, cb) {","\tvar msg = {};","\tvar __proxy__ = app.components.__proxy__;","\tif (__proxy__ && __proxy__.client && __proxy__.client.proxies.user) {","\t\tvar proxies = __proxy__.client.proxies.user;","\t\tvar server = app.getServerById(context);","\t\tif (!server) {","\t\t\tcb('no server with this id ' + context);","\t\t} else {","\t\t\tvar type = server['serverType'];","\t\t\tvar tmp = proxies[type];","\t\t\tmsg[type] = {};","\t\t\tfor (var _proxy in tmp) {","\t\t\t\tvar r = tmp[_proxy];","\t\t\t\tmsg[type][_proxy] = {};","\t\t\t\tfor (var _rpc in r) {","\t\t\t\t\tif (typeof r[_rpc] === 'function') {","\t\t\t\t\t\tmsg[type][_proxy][_rpc] = 'function';","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","\t\t\tcb(null, msg);","\t\t}","\t} else {","\t\tcb('no proxy loaded');","\t}","}","","function handlerCb(app, context, cb) {","\tvar msg = {};","\tvar __server__ = app.components.__server__;","\tif (__server__ && __server__.server && __server__.server.handlerService.handlers) {","\t\tvar handles = __server__.server.handlerService.handlers;","\t\tvar server = app.getServerById(context);","\t\tif (!server) {","\t\t\tcb('no server with this id ' + context);","\t\t} else {","\t\t\tvar type = server['serverType'];","\t\t\tvar tmp = handles;","\t\t\tmsg[type] = {};","\t\t\tfor (var _p in tmp) {","\t\t\t\tvar r = tmp[_p];","\t\t\t\tmsg[type][_p] = {};","\t\t\t\tfor (var _r in r) {","\t\t\t\t\tif (typeof r[_r] === 'function') {","\t\t\t\t\t\tmsg[type][_p][_r] = 'function';","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","\t\t\tcb(null, msg);","\t\t}","\t} else {","\t\tcb('no handler loaded');","\t}","}","","function getComponentName(c) {","\tvar t = c.match(/^__(\\w+)__$/);","\tif (t) {","\t\tt = t[1];","\t}","\treturn t;","}","","function checkJSON(obj) {","\tif (!obj) {","\t\treturn true;","\t}","\ttry {","\t\tJSON.stringify(obj);","\t} catch (e) {","\t\treturn false;","\t}","\treturn true;","}"],"l":{"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"14":1,"15":0,"18":1,"20":1,"21":0,"22":0,"25":1,"26":0,"27":0,"28":0,"29":0,"31":0,"33":0,"35":0,"36":0,"38":0,"39":0,"41":0,"42":0,"44":0,"45":0,"47":0,"48":0,"50":0,"51":0,"53":0,"54":0,"56":0,"57":0,"59":0,"60":0,"62":0,"63":0,"65":0,"66":0,"68":0,"69":0,"71":0,"72":0,"74":0,"75":0,"77":0,"78":0,"80":0,"81":0,"83":0,"84":0,"86":0,"90":1,"91":0,"92":0,"93":0,"94":0,"96":0,"97":0,"98":0,"101":0,"102":0,"104":0,"105":0,"107":0,"108":0,"110":0,"111":0,"113":0,"114":0,"116":0,"117":0,"119":0,"120":0,"122":0,"123":0,"125":0,"126":0,"128":0,"129":0,"131":0,"132":0,"134":0,"135":0,"137":0,"138":0,"140":0,"141":0,"143":0,"144":0,"146":0,"147":0,"149":0,"150":0,"152":0,"153":0,"155":0,"159":1,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"170":0,"171":0,"172":0,"176":0,"177":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"203":1,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"214":0,"215":0,"220":0,"221":0,"222":0,"223":0,"227":0,"228":0,"233":0,"234":0,"235":0,"237":0,"238":0,"242":0,"243":0,"244":0,"249":0,"252":0,"253":0,"254":0,"255":0,"259":0,"262":0,"270":1,"271":0,"274":1,"275":0,"276":0,"277":0,"278":0,"280":0,"285":1,"286":0,"287":0,"291":0,"295":0,"296":0,"297":0,"298":0,"302":0,"303":0,"311":1,"312":0,"313":0,"314":0,"318":0,"321":0,"326":0,"328":0,"329":0,"330":0,"334":1,"335":0,"336":0,"337":0,"338":0,"341":0,"346":0,"348":0,"349":0,"353":1,"354":0,"355":0,"356":0,"357":0,"360":0,"365":0,"367":0,"368":0,"372":1,"373":0,"374":0,"375":0,"376":0,"379":0,"384":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"393":0,"397":1,"398":0,"399":0,"400":0,"401":0,"404":0,"409":0,"411":0,"412":0,"413":0,"414":0,"415":0,"416":0,"418":0,"419":0,"420":0,"422":0,"424":0,"428":1,"429":0,"430":0,"431":0,"432":0,"435":0,"440":0,"442":0,"443":0,"444":0,"445":0,"446":0,"468":1,"469":0,"470":0,"471":0,"472":0,"475":0,"480":0,"482":0,"483":0,"484":0,"485":0,"486":0,"488":0,"489":0,"490":0,"491":0,"493":0,"494":0,"495":0,"496":0,"497":0,"499":0,"505":1,"506":0,"507":0,"508":0,"509":0,"512":0,"517":0,"519":0,"520":0,"521":0,"522":0,"524":0,"528":1,"529":0,"530":0,"531":0,"532":0,"535":0,"540":0,"542":0,"543":0,"544":0,"545":0,"546":0,"550":1,"551":0,"552":0,"553":0,"554":0,"557":0,"562":0,"564":0,"565":0,"566":0,"570":1,"571":0,"572":0,"573":0,"574":0,"577":0,"582":0,"584":0,"585":0,"586":0,"590":1,"591":0,"592":0,"593":0,"594":0,"597":0,"602":0,"604":0,"605":0,"609":0,"610":0,"611":0,"613":0,"618":1,"622":1,"623":0,"624":0,"625":0,"626":0,"627":0,"629":0,"630":0,"632":0,"635":0,"638":1,"639":0,"640":0,"641":0,"643":0,"644":0,"645":0,"646":0,"648":0,"649":0,"653":1,"654":0,"655":0,"656":0,"657":0,"658":0,"659":0,"660":0,"662":0,"663":0,"664":0,"665":0,"666":0,"667":0,"668":0,"669":0,"670":0,"674":0,"677":0,"681":1,"682":0,"683":0,"684":0,"685":0,"686":0,"687":0,"688":0,"690":0,"691":0,"692":0,"693":0,"694":0,"695":0,"696":0,"697":0,"698":0,"702":0,"705":0,"709":1,"710":0,"711":0,"712":0,"714":0,"717":1,"718":0,"719":0,"721":0,"722":0,"724":0,"726":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/countDownLatch.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-admin/lib/util/countDownLatch.js","s":{"1":1,"2":1,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":21},"end":{"line":6,"column":41}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":32},"end":{"line":16,"column":43}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":27},"end":{"line":32,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":25}},"2":{"start":{"line":6,"column":0},"end":{"line":9,"column":2}},"3":{"start":{"line":7,"column":2},"end":{"line":7,"column":21}},"4":{"start":{"line":8,"column":2},"end":{"line":8,"column":15}},"5":{"start":{"line":16,"column":0},"end":{"line":25,"column":2}},"6":{"start":{"line":17,"column":2},"end":{"line":19,"column":3}},"7":{"start":{"line":18,"column":4},"end":{"line":18,"column":38}},"8":{"start":{"line":21,"column":2},"end":{"line":21,"column":15}},"9":{"start":{"line":22,"column":2},"end":{"line":24,"column":3}},"10":{"start":{"line":23,"column":4},"end":{"line":23,"column":14}},"11":{"start":{"line":32,"column":0},"end":{"line":41,"column":2}},"12":{"start":{"line":33,"column":2},"end":{"line":35,"column":3}},"13":{"start":{"line":34,"column":4},"end":{"line":34,"column":49}},"14":{"start":{"line":36,"column":2},"end":{"line":38,"column":3}},"15":{"start":{"line":37,"column":4},"end":{"line":37,"column":48}},"16":{"start":{"line":40,"column":2},"end":{"line":40,"column":39}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":2},"end":{"line":17,"column":2}},{"start":{"line":17,"column":2},"end":{"line":17,"column":2}}]},"2":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":2},"end":{"line":22,"column":2}},{"start":{"line":22,"column":2},"end":{"line":22,"column":2}}]},"3":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":2},"end":{"line":33,"column":2}},{"start":{"line":33,"column":2},"end":{"line":33,"column":2}}]},"4":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":5},"end":{"line":33,"column":11}},{"start":{"line":33,"column":15},"end":{"line":33,"column":25}}]},"5":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":2}},{"start":{"line":36,"column":2},"end":{"line":36,"column":2}}]}},"code":["var exp = module.exports;","","/**"," * Count down to zero and invoke cb finally."," */","var CountDownLatch = function(count, cb) {","  this.count = count;","  this.cb = cb;","};","","/**"," * Call when a task finish to count down."," *"," * @api public"," */","CountDownLatch.prototype.done = function() {","  if(this.count <= 0) {","    throw new Error('illegal state.');","  }","","  this.count--;","  if (this.count === 0) {","    this.cb();","  }","};","","/**"," * create a count down latch"," *"," * @api public"," */","exp.createCountDownLatch = function(count, cb) {","  if(!count || count <= 0) {","    throw new Error('count should be positive.');","  }","  if(typeof cb !== 'function') {","    throw new Error('cb should be a function.');","  }","","  return new CountDownLatch(count, cb);","};",""],"l":{"1":1,"6":1,"7":0,"8":0,"16":1,"17":0,"18":0,"21":0,"22":0,"23":0,"32":1,"33":0,"34":0,"36":0,"37":0,"40":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/moduleUtil.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/util/moduleUtil.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":18},"end":{"line":13,"column":49}}},"2":{"name":"(anonymous_2)","line":47,"loc":{"start":{"line":47,"column":19},"end":{"line":47,"column":41}}},"3":{"name":"(anonymous_3)","line":59,"loc":{"start":{"line":59,"column":29},"end":{"line":59,"column":67}}},"4":{"name":"(anonymous_4)","line":82,"loc":{"start":{"line":82,"column":18},"end":{"line":82,"column":52}}},"5":{"name":"(anonymous_5)","line":90,"loc":{"start":{"line":90,"column":17},"end":{"line":90,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":36}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":39}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":37}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":43}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":70}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":25}},"9":{"start":{"line":13,"column":0},"end":{"line":45,"column":2}},"10":{"start":{"line":15,"column":2},"end":{"line":15,"column":57}},"11":{"start":{"line":17,"column":2},"end":{"line":19,"column":3}},"12":{"start":{"line":18,"column":4},"end":{"line":18,"column":11}},"13":{"start":{"line":21,"column":2},"end":{"line":21,"column":19}},"14":{"start":{"line":22,"column":2},"end":{"line":24,"column":3}},"15":{"start":{"line":23,"column":4},"end":{"line":23,"column":30}},"16":{"start":{"line":26,"column":2},"end":{"line":26,"column":31}},"17":{"start":{"line":27,"column":2},"end":{"line":44,"column":3}},"18":{"start":{"line":28,"column":4},"end":{"line":28,"column":24}},"19":{"start":{"line":29,"column":4},"end":{"line":33,"column":5}},"20":{"start":{"line":30,"column":6},"end":{"line":30,"column":58}},"21":{"start":{"line":32,"column":6},"end":{"line":32,"column":29}},"22":{"start":{"line":35,"column":4},"end":{"line":35,"column":50}},"23":{"start":{"line":37,"column":4},"end":{"line":40,"column":5}},"24":{"start":{"line":38,"column":6},"end":{"line":38,"column":47}},"25":{"start":{"line":39,"column":6},"end":{"line":39,"column":15}},"26":{"start":{"line":42,"column":4},"end":{"line":42,"column":46}},"27":{"start":{"line":43,"column":4},"end":{"line":43,"column":30}},"28":{"start":{"line":47,"column":0},"end":{"line":54,"column":2}},"29":{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},"30":{"start":{"line":51,"column":4},"end":{"line":51,"column":11}},"31":{"start":{"line":53,"column":2},"end":{"line":53,"column":36}},"32":{"start":{"line":59,"column":0},"end":{"line":80,"column":2}},"33":{"start":{"line":60,"column":2},"end":{"line":66,"column":3}},"34":{"start":{"line":61,"column":4},"end":{"line":65,"column":5}},"35":{"start":{"line":62,"column":6},"end":{"line":62,"column":73}},"36":{"start":{"line":64,"column":6},"end":{"line":64,"column":74}},"37":{"start":{"line":67,"column":2},"end":{"line":67,"column":57}},"38":{"start":{"line":68,"column":2},"end":{"line":68,"column":81}},"39":{"start":{"line":69,"column":2},"end":{"line":79,"column":3}},"40":{"start":{"line":70,"column":4},"end":{"line":73,"column":5}},"41":{"start":{"line":71,"column":6},"end":{"line":71,"column":50}},"42":{"start":{"line":72,"column":6},"end":{"line":72,"column":48}},"43":{"start":{"line":74,"column":4},"end":{"line":74,"column":92}},"44":{"start":{"line":75,"column":4},"end":{"line":75,"column":101}},"45":{"start":{"line":76,"column":4},"end":{"line":78,"column":5}},"46":{"start":{"line":77,"column":6},"end":{"line":77,"column":48}},"47":{"start":{"line":82,"column":0},"end":{"line":96,"column":2}},"48":{"start":{"line":83,"column":2},"end":{"line":86,"column":3}},"49":{"start":{"line":84,"column":4},"end":{"line":84,"column":34}},"50":{"start":{"line":85,"column":4},"end":{"line":85,"column":11}},"51":{"start":{"line":88,"column":2},"end":{"line":88,"column":30}},"52":{"start":{"line":89,"column":2},"end":{"line":95,"column":3}},"53":{"start":{"line":90,"column":4},"end":{"line":92,"column":7}},"54":{"start":{"line":91,"column":6},"end":{"line":91,"column":47}},"55":{"start":{"line":94,"column":4},"end":{"line":94,"column":45}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":2},"end":{"line":17,"column":2}},{"start":{"line":17,"column":2},"end":{"line":17,"column":2}}]},"2":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":4}},{"start":{"line":29,"column":4},"end":{"line":29,"column":4}}]},"3":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":15},"end":{"line":35,"column":30}},{"start":{"line":35,"column":34},"end":{"line":35,"column":49}}]},"4":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"5":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":50,"column":2}},{"start":{"line":50,"column":2},"end":{"line":50,"column":2}}]},"6":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":60,"column":2}},{"start":{"line":60,"column":2},"end":{"line":60,"column":2}}]},"7":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":61,"column":4}},{"start":{"line":61,"column":4},"end":{"line":61,"column":4}}]},"8":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":69,"column":2}},{"start":{"line":69,"column":2},"end":{"line":69,"column":2}}]},"9":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":4}},{"start":{"line":70,"column":4},"end":{"line":70,"column":4}}]},"10":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":4},"end":{"line":76,"column":4}},{"start":{"line":76,"column":4},"end":{"line":76,"column":4}}]},"11":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":2},"end":{"line":83,"column":2}},{"start":{"line":83,"column":2},"end":{"line":83,"column":2}}]},"12":{"line":83,"type":"binary-expr","locations":[{"start":{"line":83,"column":5},"end":{"line":83,"column":8}},{"start":{"line":83,"column":12},"end":{"line":83,"column":35}}]},"13":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":2},"end":{"line":89,"column":2}},{"start":{"line":89,"column":2},"end":{"line":89,"column":2}}]},"14":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":5},"end":{"line":89,"column":11}},{"start":{"line":89,"column":15},"end":{"line":89,"column":49}}]}},"code":["var os = require('os');","var admin = require('pomelo-admin');","var utils = require('./utils');","var Constants = require('./constants');","var pathUtil = require('./pathUtil');","var starter = require('../master/starter');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var pro = module.exports;","","/**"," * Load admin modules"," */","pro.loadModules = function(self, consoleService) {","  // load app register modules","  var _modules = self.app.get(Constants.KEYWORDS.MODULE);","","  if(!_modules) {","    return;","  }","","  var modules = [];","  for(var m in _modules){","    modules.push(_modules[m]);","  }","  ","  var record, moduleId, module;","  for(var i=0, l=modules.length; i<l; i++) {","    record = modules[i];","    if(typeof record.module === 'function') {","      module = record.module(record.opts, consoleService);","    } else {","      module = record.module;","    }","","    moduleId = record.moduleId || module.moduleId;","","    if(!moduleId) {","      logger.warn('ignore an unknown module.');","      continue;","    }","","    consoleService.register(moduleId, module);","    self.modules.push(module);","  }","};","","pro.startModules = function(modules, cb) {","  // invoke the start lifecycle method of modules","","  if(!modules) {","    return;","  }","  startModule(null, modules, 0, cb);","};","","/**"," * Append the default system admin modules"," */","pro.registerDefaultModules = function(isMaster, app, closeWatcher) {","  if(!closeWatcher) {","    if(isMaster) {","      app.registerAdmin(require('../modules/masterwatcher'), {app: app});","    } else {","      app.registerAdmin(require('../modules/monitorwatcher'), {app: app});","    }","  }","  app.registerAdmin(admin.modules.watchServer,{app:app});","  app.registerAdmin(require('../modules/console'), {app: app, starter: starter});","  if(app.enabled('systemMonitor')) {","    if(os.platform() !== Constants.PLATFORM.WIN) {","      app.registerAdmin(admin.modules.systemInfo);","      app.registerAdmin(admin.modules.nodeInfo);","    }","    app.registerAdmin(admin.modules.monitorLog, {path: pathUtil.getLogPath(app.getBase())});","    app.registerAdmin(admin.modules.scripts, {app:app, path: pathUtil.getScriptPath(app.getBase())});","    if(os.platform() !== Constants.PLATFORM.WIN) {","      app.registerAdmin(admin.modules.profiler);","    }","  }","};","","var startModule = function(err, modules, index, cb) {","  if(err || index >= modules.length) {","    utils.invokeCallback(cb, err);","    return;","  }","","  var module = modules[index];","  if(module && typeof module.start === 'function') {","    module.start(function(err) {","      startModule(err, modules, index + 1, cb);","    });","  } else {","    startModule(err, modules, index + 1, cb);","  }","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"13":1,"15":0,"17":0,"18":0,"21":0,"22":0,"23":0,"26":0,"27":0,"28":0,"29":0,"30":0,"32":0,"35":0,"37":0,"38":0,"39":0,"42":0,"43":0,"47":1,"50":0,"51":0,"53":0,"59":1,"60":0,"61":0,"62":0,"64":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"74":0,"75":0,"76":0,"77":0,"82":1,"83":0,"84":0,"85":0,"88":0,"89":0,"90":0,"91":0,"94":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/monitor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/monitor.js","s":{"1":1,"2":1,"3":0,"4":1,"5":0,"6":1,"7":1,"8":1,"9":0,"10":1,"11":0,"12":1,"13":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":15,"loc":{"start":{"line":15,"column":17},"end":{"line":15,"column":37}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":16},"end":{"line":19,"column":36}}},"3":{"name":"(anonymous_3)","line":27,"loc":{"start":{"line":27,"column":12},"end":{"line":27,"column":25}}},"4":{"name":"(anonymous_4)","line":31,"loc":{"start":{"line":31,"column":11},"end":{"line":31,"column":31}}},"5":{"name":"(anonymous_5)","line":35,"loc":{"start":{"line":35,"column":16},"end":{"line":35,"column":37}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":44}},"2":{"start":{"line":15,"column":0},"end":{"line":17,"column":2}},"3":{"start":{"line":16,"column":2},"end":{"line":16,"column":34}},"4":{"start":{"line":19,"column":0},"end":{"line":21,"column":2}},"5":{"start":{"line":20,"column":2},"end":{"line":20,"column":40}},"6":{"start":{"line":23,"column":0},"end":{"line":23,"column":30}},"7":{"start":{"line":25,"column":0},"end":{"line":25,"column":25}},"8":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"9":{"start":{"line":28,"column":2},"end":{"line":28,"column":25}},"10":{"start":{"line":31,"column":0},"end":{"line":33,"column":2}},"11":{"start":{"line":32,"column":2},"end":{"line":32,"column":24}},"12":{"start":{"line":35,"column":0},"end":{"line":37,"column":2}},"13":{"start":{"line":36,"column":2},"end":{"line":36,"column":37}}},"branchMap":{},"code":["/**"," * Component for monitor."," * Load and start monitor client."," */","var Monitor = require('../monitor/monitor');","","","","/**"," * Component factory function"," *"," * @param  {Object} app  current application context"," * @return {Object}      component instances"," */","module.exports = function(app, opts) {","  return new Component(app, opts);","};","","var Component = function(app, opts) {","  this.monitor = new Monitor(app, opts);","};","","var pro = Component.prototype;","","pro.name = '__monitor__';","","pro.start = function(cb) {","  this.monitor.start(cb);","};","","pro.stop = function(force, cb) {","  this.monitor.stop(cb);","};","","pro.reconnect = function(masterInfo) {","  this.monitor.reconnect(masterInfo);","};",""],"l":{"5":1,"15":1,"16":0,"19":1,"20":0,"23":1,"25":1,"27":1,"28":0,"31":1,"32":0,"35":1,"36":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/monitor/monitor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/monitor/monitor.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":1,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":14},"end":{"line":11,"column":34}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":39}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":33},"end":{"line":37,"column":46}}},"4":{"name":"(anonymous_4)","line":41,"loc":{"start":{"line":41,"column":28},"end":{"line":41,"column":42}}},"5":{"name":"(anonymous_5)","line":46,"loc":{"start":{"line":46,"column":42},"end":{"line":46,"column":56}}},"6":{"name":"(anonymous_6)","line":52,"loc":{"start":{"line":52,"column":34},"end":{"line":52,"column":48}}},"7":{"name":"(anonymous_7)","line":60,"loc":{"start":{"line":60,"column":25},"end":{"line":60,"column":38}}},"8":{"name":"(anonymous_8)","line":63,"loc":{"start":{"line":63,"column":19},"end":{"line":63,"column":30}}},"9":{"name":"(anonymous_9)","line":69,"loc":{"start":{"line":69,"column":30},"end":{"line":69,"column":51}}},"10":{"name":"(anonymous_10)","line":71,"loc":{"start":{"line":71,"column":12},"end":{"line":71,"column":23}}},"11":{"name":"(anonymous_11)","line":80,"loc":{"start":{"line":80,"column":22},"end":{"line":80,"column":33}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":70}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":36}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":47}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":37}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":45}},"6":{"start":{"line":11,"column":0},"end":{"line":28,"column":2}},"7":{"start":{"line":12,"column":2},"end":{"line":12,"column":20}},"8":{"start":{"line":13,"column":2},"end":{"line":13,"column":17}},"9":{"start":{"line":14,"column":2},"end":{"line":14,"column":39}},"10":{"start":{"line":15,"column":2},"end":{"line":15,"column":36}},"11":{"start":{"line":16,"column":2},"end":{"line":16,"column":20}},"12":{"start":{"line":17,"column":2},"end":{"line":17,"column":40}},"13":{"start":{"line":19,"column":2},"end":{"line":27,"column":5}},"14":{"start":{"line":30,"column":0},"end":{"line":30,"column":25}},"15":{"start":{"line":32,"column":0},"end":{"line":35,"column":2}},"16":{"start":{"line":33,"column":2},"end":{"line":33,"column":72}},"17":{"start":{"line":34,"column":2},"end":{"line":34,"column":24}},"18":{"start":{"line":37,"column":0},"end":{"line":58,"column":2}},"19":{"start":{"line":38,"column":2},"end":{"line":38,"column":52}},"20":{"start":{"line":40,"column":2},"end":{"line":40,"column":18}},"21":{"start":{"line":41,"column":2},"end":{"line":50,"column":5}},"22":{"start":{"line":42,"column":4},"end":{"line":45,"column":5}},"23":{"start":{"line":43,"column":6},"end":{"line":43,"column":36}},"24":{"start":{"line":44,"column":6},"end":{"line":44,"column":13}},"25":{"start":{"line":46,"column":4},"end":{"line":49,"column":7}},"26":{"start":{"line":47,"column":6},"end":{"line":47,"column":36}},"27":{"start":{"line":48,"column":6},"end":{"line":48,"column":13}},"28":{"start":{"line":52,"column":2},"end":{"line":57,"column":5}},"29":{"start":{"line":53,"column":4},"end":{"line":56,"column":5}},"30":{"start":{"line":54,"column":6},"end":{"line":54,"column":74}},"31":{"start":{"line":55,"column":6},"end":{"line":55,"column":13}},"32":{"start":{"line":60,"column":0},"end":{"line":66,"column":2}},"33":{"start":{"line":61,"column":2},"end":{"line":61,"column":29}},"34":{"start":{"line":62,"column":2},"end":{"line":62,"column":20}},"35":{"start":{"line":63,"column":2},"end":{"line":65,"column":5}},"36":{"start":{"line":64,"column":4},"end":{"line":64,"column":29}},"37":{"start":{"line":69,"column":0},"end":{"line":84,"column":2}},"38":{"start":{"line":70,"column":2},"end":{"line":70,"column":18}},"39":{"start":{"line":71,"column":2},"end":{"line":83,"column":5}},"40":{"start":{"line":72,"column":4},"end":{"line":79,"column":7}},"41":{"start":{"line":80,"column":4},"end":{"line":82,"column":7}},"42":{"start":{"line":81,"column":6},"end":{"line":81,"column":80}}},"branchMap":{"1":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":9},"end":{"line":12,"column":13}},{"start":{"line":12,"column":17},"end":{"line":12,"column":19}}]},"2":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]},"3":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":4},"end":{"line":53,"column":4}},{"start":{"line":53,"column":4},"end":{"line":53,"column":4}}]}},"code":["/**"," * Component for monitor."," * Load and start monitor client."," */","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var admin = require('pomelo-admin');","var moduleUtil = require('../util/moduleUtil');","var utils = require('../util/utils');","var Constants = require('../util/constants');","","var Monitor = function(app, opts) {","  opts = opts || {};","  this.app = app;","  this.serverInfo = app.getCurServer();","  this.masterInfo = app.getMaster();","  this.modules = [];","  this.closeWatcher = opts.closeWatcher;","","  this.monitorConsole = admin.createMonitorConsole({","    id: this.serverInfo.id,","    type: this.app.getServerType(),","    host: this.masterInfo.host,","    port: this.masterInfo.port,","    info: this.serverInfo,","    env: this.app.get(Constants.RESERVED.ENV),","    authServer: app.get('adminAuthServerMonitor') // auth server function","  });","};","","module.exports = Monitor;","","Monitor.prototype.start = function(cb) {","  moduleUtil.registerDefaultModules(false, this.app, this.closeWatcher);","  this.startConsole(cb);","};","","Monitor.prototype.startConsole = function(cb) {","  moduleUtil.loadModules(this, this.monitorConsole);","","  var self = this;","  this.monitorConsole.start(function(err) {","    if (err) {","      utils.invokeCallback(cb, err);","      return;","    }","    moduleUtil.startModules(self.modules, function(err) {","      utils.invokeCallback(cb, err);","      return;","    });","  });","","  this.monitorConsole.on('error', function(err) {","    if(!!err) {","      logger.error('monitorConsole encounters with error: %j', err.stack);","      return;","    }","  });","};","","Monitor.prototype.stop = function(cb) {","  this.monitorConsole.stop();","  this.modules = [];","  process.nextTick(function() {","    utils.invokeCallback(cb);","  });","};","","// monitor reconnect to master","Monitor.prototype.reconnect = function(masterInfo) {","  var self = this;","  this.stop(function() {","    self.monitorConsole = admin.createMonitorConsole({","      id: self.serverInfo.id,","      type: self.app.getServerType(),","      host: masterInfo.host,","      port: masterInfo.port,","      info: self.serverInfo,","      env: self.app.get(Constants.RESERVED.ENV)","    });","    self.startConsole(function() {","      logger.info('restart modules for server : %j finish.', self.app.serverId);","    });","  });","};"],"l":{"5":1,"6":1,"7":1,"8":1,"9":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"19":0,"30":1,"32":1,"33":0,"34":0,"37":1,"38":0,"40":0,"41":0,"42":0,"43":0,"44":0,"46":0,"47":0,"48":0,"52":0,"53":0,"54":0,"55":0,"60":1,"61":0,"62":0,"63":0,"64":0,"69":1,"70":0,"71":0,"72":0,"80":0,"81":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/protobuf.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/protobuf.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1,"27":1,"28":1,"29":0,"30":1,"31":0,"32":1,"33":0,"34":1,"35":0,"36":1,"37":0,"38":1,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":1,"69":0,"70":0,"71":0,"72":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":37}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":36}}},"3":{"name":"(anonymous_3)","line":39,"loc":{"start":{"line":39,"column":13},"end":{"line":39,"column":32}}},"4":{"name":"(anonymous_4)","line":43,"loc":{"start":{"line":43,"column":19},"end":{"line":43,"column":38}}},"5":{"name":"(anonymous_5)","line":47,"loc":{"start":{"line":47,"column":13},"end":{"line":47,"column":32}}},"6":{"name":"(anonymous_6)","line":51,"loc":{"start":{"line":51,"column":16},"end":{"line":51,"column":27}}},"7":{"name":"(anonymous_7)","line":59,"loc":{"start":{"line":59,"column":17},"end":{"line":59,"column":28}}},"8":{"name":"(anonymous_8)","line":63,"loc":{"start":{"line":63,"column":16},"end":{"line":63,"column":37}}},"9":{"name":"(anonymous_9)","line":87,"loc":{"start":{"line":87,"column":15},"end":{"line":87,"column":43}}},"10":{"name":"(anonymous_10)","line":93,"loc":{"start":{"line":93,"column":28},"end":{"line":93,"column":48}}},"11":{"name":"(anonymous_11)","line":114,"loc":{"start":{"line":114,"column":11},"end":{"line":114,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":31}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":70}},"7":{"start":{"line":8,"column":0},"end":{"line":10,"column":2}},"8":{"start":{"line":9,"column":2},"end":{"line":9,"column":34}},"9":{"start":{"line":12,"column":0},"end":{"line":33,"column":2}},"10":{"start":{"line":13,"column":2},"end":{"line":13,"column":17}},"11":{"start":{"line":14,"column":2},"end":{"line":14,"column":20}},"12":{"start":{"line":15,"column":2},"end":{"line":15,"column":21}},"13":{"start":{"line":16,"column":2},"end":{"line":16,"column":25}},"14":{"start":{"line":17,"column":2},"end":{"line":17,"column":25}},"15":{"start":{"line":18,"column":2},"end":{"line":18,"column":20}},"16":{"start":{"line":20,"column":2},"end":{"line":20,"column":44}},"17":{"start":{"line":21,"column":2},"end":{"line":21,"column":84}},"18":{"start":{"line":22,"column":2},"end":{"line":22,"column":121}},"19":{"start":{"line":23,"column":2},"end":{"line":23,"column":84}},"20":{"start":{"line":24,"column":2},"end":{"line":24,"column":121}},"21":{"start":{"line":26,"column":2},"end":{"line":26,"column":136}},"22":{"start":{"line":27,"column":2},"end":{"line":27,"column":136}},"23":{"start":{"line":29,"column":2},"end":{"line":29,"column":93}},"24":{"start":{"line":30,"column":2},"end":{"line":30,"column":93}},"25":{"start":{"line":32,"column":2},"end":{"line":32,"column":84}},"26":{"start":{"line":35,"column":0},"end":{"line":35,"column":30}},"27":{"start":{"line":37,"column":0},"end":{"line":37,"column":26}},"28":{"start":{"line":39,"column":0},"end":{"line":41,"column":2}},"29":{"start":{"line":40,"column":2},"end":{"line":40,"column":35}},"30":{"start":{"line":43,"column":0},"end":{"line":45,"column":2}},"31":{"start":{"line":44,"column":2},"end":{"line":44,"column":41}},"32":{"start":{"line":47,"column":0},"end":{"line":49,"column":2}},"33":{"start":{"line":48,"column":2},"end":{"line":48,"column":35}},"34":{"start":{"line":51,"column":0},"end":{"line":57,"column":2}},"35":{"start":{"line":52,"column":2},"end":{"line":56,"column":4}},"36":{"start":{"line":59,"column":0},"end":{"line":61,"column":2}},"37":{"start":{"line":60,"column":2},"end":{"line":60,"column":22}},"38":{"start":{"line":63,"column":0},"end":{"line":85,"column":2}},"39":{"start":{"line":64,"column":2},"end":{"line":66,"column":3}},"40":{"start":{"line":65,"column":4},"end":{"line":65,"column":11}},"41":{"start":{"line":68,"column":2},"end":{"line":70,"column":3}},"42":{"start":{"line":69,"column":4},"end":{"line":69,"column":54}},"43":{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},"44":{"start":{"line":73,"column":4},"end":{"line":73,"column":54}},"45":{"start":{"line":76,"column":2},"end":{"line":76,"column":87}},"46":{"start":{"line":77,"column":2},"end":{"line":77,"column":76}},"47":{"start":{"line":80,"column":2},"end":{"line":80,"column":69}},"48":{"start":{"line":81,"column":2},"end":{"line":83,"column":3}},"49":{"start":{"line":82,"column":4},"end":{"line":82,"column":32}},"50":{"start":{"line":84,"column":2},"end":{"line":84,"column":32}},"51":{"start":{"line":87,"column":0},"end":{"line":112,"column":2}},"52":{"start":{"line":88,"column":2},"end":{"line":90,"column":3}},"53":{"start":{"line":89,"column":4},"end":{"line":89,"column":11}},"54":{"start":{"line":92,"column":2},"end":{"line":92,"column":18}},"55":{"start":{"line":93,"column":2},"end":{"line":111,"column":5}},"56":{"start":{"line":94,"column":4},"end":{"line":110,"column":5}},"57":{"start":{"line":95,"column":6},"end":{"line":95,"column":52}},"58":{"start":{"line":96,"column":6},"end":{"line":102,"column":7}},"59":{"start":{"line":97,"column":8},"end":{"line":97,"column":42}},"60":{"start":{"line":98,"column":8},"end":{"line":98,"column":35}},"61":{"start":{"line":100,"column":8},"end":{"line":100,"column":42}},"62":{"start":{"line":101,"column":8},"end":{"line":101,"column":35}},"63":{"start":{"line":104,"column":6},"end":{"line":104,"column":91}},"64":{"start":{"line":105,"column":6},"end":{"line":105,"column":80}},"65":{"start":{"line":106,"column":6},"end":{"line":106,"column":102}},"66":{"start":{"line":108,"column":6},"end":{"line":108,"column":62}},"67":{"start":{"line":109,"column":6},"end":{"line":109,"column":21}},"68":{"start":{"line":114,"column":0},"end":{"line":120,"column":2}},"69":{"start":{"line":115,"column":2},"end":{"line":117,"column":3}},"70":{"start":{"line":116,"column":4},"end":{"line":116,"column":32}},"71":{"start":{"line":118,"column":2},"end":{"line":118,"column":21}},"72":{"start":{"line":119,"column":2},"end":{"line":119,"column":23}}},"branchMap":{"1":{"line":14,"type":"binary-expr","locations":[{"start":{"line":14,"column":9},"end":{"line":14,"column":13}},{"start":{"line":14,"column":17},"end":{"line":14,"column":19}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":26},"end":{"line":26,"column":43}},{"start":{"line":26,"column":48},"end":{"line":26,"column":134}}]},"3":{"line":26,"type":"cond-expr","locations":[{"start":{"line":26,"column":82},"end":{"line":26,"column":114}},{"start":{"line":26,"column":117},"end":{"line":26,"column":134}}]},"4":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":26},"end":{"line":27,"column":43}},{"start":{"line":27,"column":48},"end":{"line":27,"column":134}}]},"5":{"line":27,"type":"cond-expr","locations":[{"start":{"line":27,"column":82},"end":{"line":27,"column":114}},{"start":{"line":27,"column":117},"end":{"line":27,"column":134}}]},"6":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":2},"end":{"line":64,"column":2}},{"start":{"line":64,"column":2},"end":{"line":64,"column":2}}]},"7":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":2},"end":{"line":68,"column":2}},{"start":{"line":68,"column":2},"end":{"line":68,"column":2}}]},"8":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":2},"end":{"line":72,"column":2}},{"start":{"line":72,"column":2},"end":{"line":72,"column":2}}]},"9":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":2},"end":{"line":81,"column":2}},{"start":{"line":81,"column":2},"end":{"line":81,"column":2}}]},"10":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":2},"end":{"line":88,"column":2}},{"start":{"line":88,"column":2},"end":{"line":88,"column":2}}]},"11":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":6},"end":{"line":96,"column":6}},{"start":{"line":96,"column":6},"end":{"line":96,"column":6}}]}},"code":["var fs = require('fs');","var path = require('path');","var protobuf = require('pomelo-protobuf');","var Constants = require('../util/constants');","var crypto = require('crypto');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","module.exports = function(app, opts) {","  return new Component(app, opts);","};","","var Component = function(app, opts) {","  this.app = app;","  opts = opts || {};","  this.watchers = {};","  this.serverProtos = {};","  this.clientProtos = {};","  this.version = \"\";","  ","  var env = app.get(Constants.RESERVED.ENV);","  var originServerPath = path.join(app.getBase(), Constants.FILEPATH.SERVER_PROTOS);","  var presentServerPath = path.join(Constants.FILEPATH.CONFIG_DIR, env, path.basename(Constants.FILEPATH.SERVER_PROTOS));","  var originClientPath = path.join(app.getBase(), Constants.FILEPATH.CLIENT_PROTOS);","  var presentClientPath = path.join(Constants.FILEPATH.CONFIG_DIR, env, path.basename(Constants.FILEPATH.CLIENT_PROTOS));","","  this.serverProtosPath = opts.serverProtos || (fs.existsSync(originServerPath) ? Constants.FILEPATH.SERVER_PROTOS : presentServerPath);","  this.clientProtosPath = opts.clientProtos || (fs.existsSync(originClientPath) ? Constants.FILEPATH.CLIENT_PROTOS : presentClientPath);","","  this.setProtos(Constants.RESERVED.SERVER, path.join(app.getBase(), this.serverProtosPath));","  this.setProtos(Constants.RESERVED.CLIENT, path.join(app.getBase(), this.clientProtosPath));","","  protobuf.init({encoderProtos:this.serverProtos, decoderProtos:this.clientProtos});","};","","var pro = Component.prototype;","","pro.name = '__protobuf__';","","pro.encode = function(key, msg) {","  return protobuf.encode(key, msg);","};","","pro.encode2Bytes = function(key, msg) {","  return protobuf.encode2Bytes(key, msg);","};","","pro.decode = function(key, msg) {","  return protobuf.decode(key, msg);","};","","pro.getProtos = function() {","  return {","    server : this.serverProtos,","    client : this.clientProtos,","    version : this.version","  };","};","","pro.getVersion = function() {","  return this.version;","};","","pro.setProtos = function(type, path) {","  if(!fs.existsSync(path)) {","    return;","  }","","  if(type === Constants.RESERVED.SERVER) {","    this.serverProtos = protobuf.parse(require(path));","  }","","  if(type === Constants.RESERVED.CLIENT) {","    this.clientProtos = protobuf.parse(require(path));","  }","","  var protoStr = JSON.stringify(this.clientProtos) + JSON.stringify(this.serverProtos);","  this.version = crypto.createHash('md5').update(protoStr).digest('base64');","","  //Watch file","  var watcher = fs.watch(path, this.onUpdate.bind(this, type, path));","  if (this.watchers[type]) {","    this.watchers[type].close();","  }","  this.watchers[type] = watcher;","};","","pro.onUpdate = function(type, path, event) {","  if(event !== 'change') {","    return;","  }","","  var self = this;","  fs.readFile(path, 'utf8' ,function(err, data) {","    try {","      var protos = protobuf.parse(JSON.parse(data));","      if(type === Constants.RESERVED.SERVER) {","        protobuf.setEncoderProtos(protos);","        self.serverProtos = protos;","      } else {","        protobuf.setDecoderProtos(protos);","        self.clientProtos = protos;","      }","","      var protoStr = JSON.stringify(self.clientProtos) + JSON.stringify(self.serverProtos);","      self.version = crypto.createHash('md5').update(protoStr).digest('base64');","      logger.info('change proto file , type : %j, path : %j, version : %j', type, path, self.version);","    } catch(e) {","      logger.warn(\"change proto file error! path : %j\", path);","      logger.warn(e);","    }","  });","};","","pro.stop = function(force, cb) {","  for (var type in this.watchers) {","    this.watchers[type].close();","  }","  this.watchers = {};","  process.nextTick(cb);","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"9":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"20":0,"21":0,"22":0,"23":0,"24":0,"26":0,"27":0,"29":0,"30":0,"32":0,"35":1,"37":1,"39":1,"40":0,"43":1,"44":0,"47":1,"48":0,"51":1,"52":0,"59":1,"60":0,"63":1,"64":0,"65":0,"68":0,"69":0,"72":0,"73":0,"76":0,"77":0,"80":0,"81":0,"82":0,"84":0,"87":1,"88":0,"89":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"100":0,"101":0,"104":0,"105":0,"106":0,"108":0,"109":0,"114":1,"115":0,"116":0,"118":0,"119":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/protobuf.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/protobuf.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":1,"21":0,"22":1,"23":0,"24":0,"25":0,"26":1,"27":0,"28":1,"29":0,"30":1,"31":0,"32":1,"33":0,"34":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":18},"end":{"line":13,"column":36}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":24},"end":{"line":17,"column":42}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":21},"end":{"line":31,"column":45}}},"4":{"name":"(anonymous_4)","line":37,"loc":{"start":{"line":37,"column":18},"end":{"line":37,"column":36}}},"5":{"name":"(anonymous_5)","line":41,"loc":{"start":{"line":41,"column":21},"end":{"line":41,"column":45}}},"6":{"name":"(anonymous_6)","line":48,"loc":{"start":{"line":48,"column":17},"end":{"line":48,"column":31}}},"7":{"name":"(anonymous_7)","line":52,"loc":{"start":{"line":52,"column":28},"end":{"line":52,"column":44}}},"8":{"name":"(anonymous_8)","line":56,"loc":{"start":{"line":56,"column":28},"end":{"line":56,"column":44}}},"9":{"name":"(anonymous_9)","line":60,"loc":{"start":{"line":60,"column":16},"end":{"line":60,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":30}},"5":{"start":{"line":13,"column":0},"end":{"line":15,"column":2}},"6":{"start":{"line":14,"column":1},"end":{"line":14,"column":33}},"7":{"start":{"line":17,"column":0},"end":{"line":29,"column":2}},"8":{"start":{"line":18,"column":1},"end":{"line":18,"column":36}},"9":{"start":{"line":19,"column":1},"end":{"line":22,"column":2}},"10":{"start":{"line":20,"column":2},"end":{"line":20,"column":66}},"11":{"start":{"line":21,"column":2},"end":{"line":21,"column":14}},"12":{"start":{"line":23,"column":1},"end":{"line":23,"column":43}},"13":{"start":{"line":24,"column":1},"end":{"line":26,"column":2}},"14":{"start":{"line":25,"column":2},"end":{"line":25,"column":43}},"15":{"start":{"line":28,"column":1},"end":{"line":28,"column":14}},"16":{"start":{"line":31,"column":0},"end":{"line":35,"column":2}},"17":{"start":{"line":32,"column":1},"end":{"line":32,"column":25}},"18":{"start":{"line":33,"column":1},"end":{"line":33,"column":40}},"19":{"start":{"line":34,"column":1},"end":{"line":34,"column":46}},"20":{"start":{"line":37,"column":0},"end":{"line":39,"column":2}},"21":{"start":{"line":38,"column":1},"end":{"line":38,"column":33}},"22":{"start":{"line":41,"column":0},"end":{"line":46,"column":2}},"23":{"start":{"line":42,"column":1},"end":{"line":42,"column":25}},"24":{"start":{"line":43,"column":1},"end":{"line":43,"column":36}},"25":{"start":{"line":45,"column":1},"end":{"line":45,"column":53}},"26":{"start":{"line":48,"column":0},"end":{"line":50,"column":2}},"27":{"start":{"line":49,"column":1},"end":{"line":49,"column":27}},"28":{"start":{"line":52,"column":0},"end":{"line":54,"column":2}},"29":{"start":{"line":53,"column":1},"end":{"line":53,"column":22}},"30":{"start":{"line":56,"column":0},"end":{"line":58,"column":2}},"31":{"start":{"line":57,"column":1},"end":{"line":57,"column":22}},"32":{"start":{"line":60,"column":0},"end":{"line":67,"column":2}},"33":{"start":{"line":62,"column":1},"end":{"line":62,"column":34}},"34":{"start":{"line":65,"column":1},"end":{"line":65,"column":34}}},"branchMap":{"1":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},{"start":{"line":19,"column":1},"end":{"line":19,"column":1}}]},"2":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}]},"3":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":8},"end":{"line":32,"column":12}},{"start":{"line":32,"column":16},"end":{"line":32,"column":24}}]},"4":{"line":34,"type":"cond-expr","locations":[{"start":{"line":34,"column":17},"end":{"line":34,"column":38}},{"start":{"line":34,"column":39},"end":{"line":34,"column":45}}]},"5":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":8},"end":{"line":42,"column":12}},{"start":{"line":42,"column":16},"end":{"line":42,"column":24}}]},"6":{"line":45,"type":"cond-expr","locations":[{"start":{"line":45,"column":17},"end":{"line":45,"column":45}},{"start":{"line":45,"column":46},"end":{"line":45,"column":52}}]}},"code":["var encoder = require('./encoder');","var decoder = require('./decoder');","var parser = require('./parser');","","var Protobuf = module.exports;","","/**"," * [encode the given message, return a Buffer represent the message encoded by protobuf]"," * @param  {[type]} key The key to identify the message type."," * @param  {[type]} msg The message body, a js object."," * @return {[type]} The binary encode result in a Buffer."," */","Protobuf.encode = function(key, msg){","\treturn encoder.encode(key, msg);","};","","Protobuf.encode2Bytes = function(key, msg){","\tvar buffer = this.encode(key, msg);","\tif(!buffer || !buffer.length){","\t\tconsole.warn('encode msg failed! key : %j, msg : %j', key, msg);","\t\treturn null;","\t}","\tvar bytes = new Uint8Array(buffer.length);","\tfor(var offset = 0; offset < buffer.length; offset++){","\t\tbytes[offset] = buffer.readUInt8(offset);","\t}","","\treturn bytes;","};","","Protobuf.encodeStr = function(key, msg, code){","\tcode = code || 'base64';","\tvar buffer = Protobuf.encode(key, msg);","\treturn !!buffer?buffer.toString(code):buffer;","};","","Protobuf.decode = function(key, msg){","\treturn decoder.decode(key, msg);","};","","Protobuf.decodeStr = function(key, str, code){","\tcode = code || 'base64';","\tvar buffer = new Buffer(str, code);","","\treturn !!buffer?Protobuf.decode(key, buffer):buffer;","};","","Protobuf.parse = function(json){","\treturn parser.parse(json);","};","","Protobuf.setEncoderProtos = function(protos){","\tencoder.init(protos);","};","","Protobuf.setDecoderProtos = function(protos){","\tdecoder.init(protos);","};","","Protobuf.init = function(opts){","\t//On the serverside, use serverProtos to encode messages send to client","\tencoder.init(opts.encoderProtos);","","\t//On the serverside, user clientProtos to decode messages receive from clients","\tdecoder.init(opts.decoderProtos);","","};"],"l":{"1":1,"2":1,"3":1,"5":1,"13":1,"14":0,"17":1,"18":0,"19":0,"20":0,"21":0,"23":0,"24":0,"25":0,"28":0,"31":1,"32":0,"33":0,"34":0,"37":1,"38":0,"41":1,"42":0,"43":0,"45":0,"48":1,"49":0,"52":1,"53":0,"56":1,"57":0,"60":1,"62":0,"65":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/encoder.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/encoder.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":1,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":1,"103":0,"104":0,"105":0,"106":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0,0],"21":[0,0],"22":[0,0],"23":[0,0,0,0,0,0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":15},"end":{"line":7,"column":31}}},"2":{"name":"(anonymous_2)","line":11,"loc":{"start":{"line":11,"column":17},"end":{"line":11,"column":37}}},"3":{"name":"checkMsg","line":46,"loc":{"start":{"line":46,"column":0},"end":{"line":46,"column":30}}},"4":{"name":"encodeMsg","line":88,"loc":{"start":{"line":88,"column":0},"end":{"line":88,"column":47}}},"5":{"name":"encodeProp","line":111,"loc":{"start":{"line":111,"column":0},"end":{"line":111,"column":56}}},"6":{"name":"encodeArray","line":163,"loc":{"start":{"line":163,"column":0},"end":{"line":163,"column":58}}},"7":{"name":"writeBytes","line":181,"loc":{"start":{"line":181,"column":0},"end":{"line":181,"column":42}}},"8":{"name":"encodeTag","line":190,"loc":{"start":{"line":190,"column":0},"end":{"line":190,"column":29}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":29}},"5":{"start":{"line":7,"column":0},"end":{"line":9,"column":2}},"6":{"start":{"line":8,"column":1},"end":{"line":8,"column":28}},"7":{"start":{"line":11,"column":0},"end":{"line":41,"column":2}},"8":{"start":{"line":12,"column":1},"end":{"line":15,"column":2}},"9":{"start":{"line":13,"column":2},"end":{"line":13,"column":79}},"10":{"start":{"line":14,"column":2},"end":{"line":14,"column":14}},"11":{"start":{"line":18,"column":1},"end":{"line":18,"column":33}},"12":{"start":{"line":21,"column":1},"end":{"line":24,"column":2}},"13":{"start":{"line":22,"column":2},"end":{"line":22,"column":70}},"14":{"start":{"line":23,"column":2},"end":{"line":23,"column":14}},"15":{"start":{"line":27,"column":1},"end":{"line":27,"column":55}},"16":{"start":{"line":30,"column":1},"end":{"line":30,"column":33}},"17":{"start":{"line":31,"column":1},"end":{"line":31,"column":16}},"18":{"start":{"line":33,"column":1},"end":{"line":38,"column":2}},"19":{"start":{"line":34,"column":2},"end":{"line":34,"column":50}},"20":{"start":{"line":35,"column":2},"end":{"line":37,"column":3}},"21":{"start":{"line":36,"column":3},"end":{"line":36,"column":34}},"22":{"start":{"line":40,"column":1},"end":{"line":40,"column":13}},"23":{"start":{"line":46,"column":0},"end":{"line":86,"column":1}},"24":{"start":{"line":47,"column":1},"end":{"line":50,"column":2}},"25":{"start":{"line":48,"column":2},"end":{"line":48,"column":77}},"26":{"start":{"line":49,"column":2},"end":{"line":49,"column":15}},"27":{"start":{"line":52,"column":1},"end":{"line":83,"column":2}},"28":{"start":{"line":53,"column":2},"end":{"line":53,"column":27}},"29":{"start":{"line":56,"column":2},"end":{"line":82,"column":3}},"30":{"start":{"line":58,"column":4},"end":{"line":61,"column":5}},"31":{"start":{"line":59,"column":5},"end":{"line":59,"column":100}},"32":{"start":{"line":60,"column":5},"end":{"line":60,"column":18}},"33":{"start":{"line":63,"column":4},"end":{"line":69,"column":5}},"34":{"start":{"line":64,"column":5},"end":{"line":64,"column":92}},"35":{"start":{"line":65,"column":5},"end":{"line":68,"column":6}},"36":{"start":{"line":66,"column":6},"end":{"line":66,"column":88}},"37":{"start":{"line":67,"column":6},"end":{"line":67,"column":19}},"38":{"start":{"line":70,"column":3},"end":{"line":70,"column":9}},"39":{"start":{"line":73,"column":4},"end":{"line":73,"column":91}},"40":{"start":{"line":74,"column":4},"end":{"line":80,"column":5}},"41":{"start":{"line":75,"column":5},"end":{"line":79,"column":6}},"42":{"start":{"line":76,"column":6},"end":{"line":78,"column":7}},"43":{"start":{"line":77,"column":7},"end":{"line":77,"column":20}},"44":{"start":{"line":81,"column":3},"end":{"line":81,"column":9}},"45":{"start":{"line":85,"column":1},"end":{"line":85,"column":13}},"46":{"start":{"line":88,"column":0},"end":{"line":109,"column":1}},"47":{"start":{"line":89,"column":1},"end":{"line":106,"column":2}},"48":{"start":{"line":90,"column":2},"end":{"line":105,"column":3}},"49":{"start":{"line":91,"column":3},"end":{"line":91,"column":28}},"50":{"start":{"line":93,"column":3},"end":{"line":104,"column":4}},"51":{"start":{"line":96,"column":5},"end":{"line":96,"column":75}},"52":{"start":{"line":97,"column":5},"end":{"line":97,"column":72}},"53":{"start":{"line":98,"column":4},"end":{"line":98,"column":10}},"54":{"start":{"line":100,"column":5},"end":{"line":102,"column":6}},"55":{"start":{"line":101,"column":6},"end":{"line":101,"column":69}},"56":{"start":{"line":103,"column":4},"end":{"line":103,"column":10}},"57":{"start":{"line":108,"column":1},"end":{"line":108,"column":15}},"58":{"start":{"line":111,"column":0},"end":{"line":158,"column":1}},"59":{"start":{"line":112,"column":1},"end":{"line":112,"column":16}},"60":{"start":{"line":114,"column":1},"end":{"line":155,"column":2}},"61":{"start":{"line":116,"column":3},"end":{"line":116,"column":66}},"62":{"start":{"line":117,"column":2},"end":{"line":117,"column":8}},"63":{"start":{"line":120,"column":3},"end":{"line":120,"column":66}},"64":{"start":{"line":121,"column":2},"end":{"line":121,"column":8}},"65":{"start":{"line":123,"column":3},"end":{"line":123,"column":38}},"66":{"start":{"line":124,"column":3},"end":{"line":124,"column":15}},"67":{"start":{"line":125,"column":2},"end":{"line":125,"column":8}},"68":{"start":{"line":127,"column":3},"end":{"line":127,"column":39}},"69":{"start":{"line":128,"column":3},"end":{"line":128,"column":15}},"70":{"start":{"line":129,"column":2},"end":{"line":129,"column":8}},"71":{"start":{"line":131,"column":3},"end":{"line":131,"column":37}},"72":{"start":{"line":134,"column":3},"end":{"line":134,"column":67}},"73":{"start":{"line":136,"column":3},"end":{"line":136,"column":39}},"74":{"start":{"line":137,"column":3},"end":{"line":137,"column":20}},"75":{"start":{"line":138,"column":2},"end":{"line":138,"column":8}},"76":{"start":{"line":140,"column":3},"end":{"line":140,"column":78}},"77":{"start":{"line":141,"column":3},"end":{"line":153,"column":4}},"78":{"start":{"line":143,"column":4},"end":{"line":143,"column":75}},"79":{"start":{"line":144,"column":4},"end":{"line":144,"column":15}},"80":{"start":{"line":146,"column":4},"end":{"line":146,"column":58}},"81":{"start":{"line":148,"column":4},"end":{"line":148,"column":68}},"82":{"start":{"line":150,"column":4},"end":{"line":150,"column":46}},"83":{"start":{"line":152,"column":4},"end":{"line":152,"column":21}},"84":{"start":{"line":154,"column":2},"end":{"line":154,"column":8}},"85":{"start":{"line":157,"column":1},"end":{"line":157,"column":15}},"86":{"start":{"line":163,"column":0},"end":{"line":179,"column":1}},"87":{"start":{"line":164,"column":1},"end":{"line":164,"column":11}},"88":{"start":{"line":165,"column":1},"end":{"line":176,"column":2}},"89":{"start":{"line":166,"column":2},"end":{"line":166,"column":72}},"90":{"start":{"line":167,"column":2},"end":{"line":167,"column":72}},"91":{"start":{"line":168,"column":2},"end":{"line":170,"column":3}},"92":{"start":{"line":169,"column":3},"end":{"line":169,"column":61}},"93":{"start":{"line":172,"column":2},"end":{"line":175,"column":3}},"94":{"start":{"line":173,"column":3},"end":{"line":173,"column":73}},"95":{"start":{"line":174,"column":3},"end":{"line":174,"column":69}},"96":{"start":{"line":178,"column":1},"end":{"line":178,"column":15}},"97":{"start":{"line":181,"column":0},"end":{"line":188,"column":1}},"98":{"start":{"line":182,"column":1},"end":{"line":185,"column":2}},"99":{"start":{"line":183,"column":2},"end":{"line":183,"column":38}},"100":{"start":{"line":184,"column":2},"end":{"line":184,"column":11}},"101":{"start":{"line":187,"column":1},"end":{"line":187,"column":15}},"102":{"start":{"line":190,"column":0},"end":{"line":196,"column":1}},"103":{"start":{"line":191,"column":1},"end":{"line":191,"column":34}},"104":{"start":{"line":193,"column":1},"end":{"line":193,"column":35}},"105":{"start":{"line":193,"column":25},"end":{"line":193,"column":35}},"106":{"start":{"line":195,"column":1},"end":{"line":195,"column":43}}},"branchMap":{"1":{"line":8,"type":"binary-expr","locations":[{"start":{"line":8,"column":15},"end":{"line":8,"column":21}},{"start":{"line":8,"column":25},"end":{"line":8,"column":27}}]},"2":{"line":12,"type":"if","locations":[{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},{"start":{"line":12,"column":1},"end":{"line":12,"column":1}}]},"3":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":4},"end":{"line":12,"column":10}},{"start":{"line":12,"column":14},"end":{"line":12,"column":18}}]},"4":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},{"start":{"line":21,"column":1},"end":{"line":21,"column":1}}]},"5":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},{"start":{"line":33,"column":1},"end":{"line":33,"column":1}}]},"6":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":35,"column":2}},{"start":{"line":35,"column":2},"end":{"line":35,"column":2}}]},"7":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},{"start":{"line":47,"column":1},"end":{"line":47,"column":1}}]},"8":{"line":47,"type":"binary-expr","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":11}},{"start":{"line":47,"column":15},"end":{"line":47,"column":19}}]},"9":{"line":56,"type":"switch","locations":[{"start":{"line":57,"column":3},"end":{"line":61,"column":5}},{"start":{"line":62,"column":3},"end":{"line":70,"column":9}},{"start":{"line":71,"column":3},"end":{"line":81,"column":9}}]},"10":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":58,"column":4}},{"start":{"line":58,"column":4},"end":{"line":58,"column":4}}]},"11":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"12":{"line":64,"type":"binary-expr","locations":[{"start":{"line":64,"column":19},"end":{"line":64,"column":48}},{"start":{"line":64,"column":52},"end":{"line":64,"column":91}}]},"13":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":5},"end":{"line":65,"column":5}},{"start":{"line":65,"column":5},"end":{"line":65,"column":5}}]},"14":{"line":65,"type":"binary-expr","locations":[{"start":{"line":65,"column":8},"end":{"line":65,"column":17}},{"start":{"line":65,"column":21},"end":{"line":65,"column":50}}]},"15":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":18},"end":{"line":73,"column":47}},{"start":{"line":73,"column":51},"end":{"line":73,"column":90}}]},"16":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":74,"column":4}},{"start":{"line":74,"column":4},"end":{"line":74,"column":4}}]},"17":{"line":74,"type":"binary-expr","locations":[{"start":{"line":74,"column":7},"end":{"line":74,"column":18}},{"start":{"line":74,"column":22},"end":{"line":74,"column":31}}]},"18":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":6},"end":{"line":76,"column":6}},{"start":{"line":76,"column":6},"end":{"line":76,"column":6}}]},"19":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":2},"end":{"line":90,"column":2}},{"start":{"line":90,"column":2},"end":{"line":90,"column":2}}]},"20":{"line":93,"type":"switch","locations":[{"start":{"line":94,"column":4},"end":{"line":94,"column":21}},{"start":{"line":95,"column":4},"end":{"line":98,"column":10}},{"start":{"line":99,"column":4},"end":{"line":103,"column":10}}]},"21":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":5},"end":{"line":100,"column":5}},{"start":{"line":100,"column":5},"end":{"line":100,"column":5}}]},"22":{"line":100,"type":"binary-expr","locations":[{"start":{"line":100,"column":8},"end":{"line":100,"column":19}},{"start":{"line":100,"column":23},"end":{"line":100,"column":43}}]},"23":{"line":114,"type":"switch","locations":[{"start":{"line":115,"column":2},"end":{"line":117,"column":8}},{"start":{"line":118,"column":2},"end":{"line":118,"column":16}},{"start":{"line":119,"column":2},"end":{"line":121,"column":8}},{"start":{"line":122,"column":2},"end":{"line":125,"column":8}},{"start":{"line":126,"column":2},"end":{"line":129,"column":8}},{"start":{"line":130,"column":2},"end":{"line":138,"column":8}},{"start":{"line":139,"column":2},"end":{"line":154,"column":8}}]},"24":{"line":140,"type":"binary-expr","locations":[{"start":{"line":140,"column":17},"end":{"line":140,"column":40}},{"start":{"line":140,"column":44},"end":{"line":140,"column":77}}]},"25":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":3},"end":{"line":141,"column":3}},{"start":{"line":141,"column":3},"end":{"line":141,"column":3}}]},"26":{"line":165,"type":"if","locations":[{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},{"start":{"line":165,"column":1},"end":{"line":165,"column":1}}]},"27":{"line":193,"type":"if","locations":[{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},{"start":{"line":193,"column":1},"end":{"line":193,"column":1}}]}},"code":["var codec = require('./codec');","var constant = require('./constant');","var util = require('./util');","","var Encoder = module.exports;","","Encoder.init = function(protos){","\tthis.protos = protos || {};","};","","Encoder.encode = function(route, msg){","\tif(!route || !msg){","\t\tconsole.warn('Route or msg can not be null! route : %j, msg %j', route, msg);","\t\treturn null;","\t}","","\t//Get protos from protos map use the route as key","\tvar protos = this.protos[route];","","\t//Check msg","\tif(!checkMsg(msg, protos)){","\t\tconsole.warn('check msg failed! msg : %j, proto : %j', msg, protos);","\t\treturn null;","\t}","","\t//Set the length of the buffer 2 times bigger to prevent overflow","\tvar length = Buffer.byteLength(JSON.stringify(msg))*2;","","\t//Init buffer and offset","\tvar buffer = new Buffer(length);","\tvar offset = 0;","","\tif(!!protos){","\t\toffset = encodeMsg(buffer, offset, protos, msg);","\t\tif(offset > 0){","\t\t\treturn buffer.slice(0, offset);","\t\t}","\t}","","\treturn null;","};","","/**"," * Check if the msg follow the defination in the protos"," */","function checkMsg(msg, protos){","\tif(!protos || !msg){","\t\tconsole.warn('no protos or msg exist! msg : %j, protos : %j', msg, protos);","\t\treturn false;","\t}","","\tfor(var name in protos){","\t\tvar proto = protos[name];","","\t\t//All required element must exist","\t\tswitch(proto.option){","\t\t\tcase 'required' :","\t\t\t\tif(typeof(msg[name]) === 'undefined'){","\t\t\t\t\tconsole.warn('no property exist for required! name: %j, proto: %j, msg: %j', name, proto, msg);","\t\t\t\t\treturn false;","\t\t\t\t}","\t\t\tcase 'optional' :","\t\t\t\tif(typeof(msg[name]) !== 'undefined'){","\t\t\t\t\tvar message = protos.__messages[proto.type] || Encoder.protos['message ' + proto.type];","\t\t\t\t\tif(!!message && !checkMsg(msg[name], message)){","\t\t\t\t\t\tconsole.warn('inner proto error! name: %j, proto: %j, msg: %j', name, proto, msg);","\t\t\t\t\t\treturn false;","\t\t\t\t\t}","\t\t\t\t}","\t\t\tbreak;","\t\t\tcase 'repeated' :","\t\t\t\t//Check nest message in repeated elements","\t\t\t\tvar message = protos.__messages[proto.type] || Encoder.protos['message ' + proto.type];","\t\t\t\tif(!!msg[name] && !!message){","\t\t\t\t\tfor(var i = 0; i < msg[name].length; i++){","\t\t\t\t\t\tif(!checkMsg(msg[name][i], message)){","\t\t\t\t\t\t\treturn false;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t}","\t\t\tbreak;","\t\t}","\t}","","\treturn true;","}","","function encodeMsg(buffer, offset, protos, msg){","\tfor(var name in msg){","\t\tif(!!protos[name]){","\t\t\tvar proto = protos[name];","","\t\t\tswitch(proto.option){","\t\t\t\tcase 'required' :","\t\t\t\tcase 'optional' :","\t\t\t\t\toffset = writeBytes(buffer, offset, encodeTag(proto.type, proto.tag));","\t\t\t\t\toffset = encodeProp(msg[name], proto.type, offset, buffer, protos);","\t\t\t\tbreak;","\t\t\t\tcase 'repeated' :","\t\t\t\t\tif(!!msg[name] && msg[name].length > 0){","\t\t\t\t\t\toffset = encodeArray(msg[name], proto, offset, buffer, protos);","\t\t\t\t\t}","\t\t\t\tbreak;","\t\t\t}","\t\t}","\t}","","\treturn offset;","}","","function encodeProp(value, type, offset, buffer, protos){","\tvar length = 0;","","\tswitch(type){","\t\tcase 'uInt32':","\t\t\toffset = writeBytes(buffer, offset, codec.encodeUInt32(value));","\t\tbreak;","\t\tcase 'int32' :","\t\tcase 'sInt32':","\t\t\toffset = writeBytes(buffer, offset, codec.encodeSInt32(value));","\t\tbreak;","\t\tcase 'float':","\t\t\tbuffer.writeFloatLE(value, offset);","\t\t\toffset += 4;","\t\tbreak;","\t\tcase 'double':","\t\t\tbuffer.writeDoubleLE(value, offset);","\t\t\toffset += 8;","\t\tbreak;","\t\tcase 'string':","\t\t\tlength = Buffer.byteLength(value);","","\t\t\t//Encode length","\t\t\toffset = writeBytes(buffer, offset, codec.encodeUInt32(length));","\t\t\t//write string","\t\t\tbuffer.write(value, offset, length);","\t\t\toffset += length;","\t\tbreak;","\t\tdefault :","\t\t\tvar message = protos.__messages[type] || Encoder.protos['message ' + type];","\t\t\tif(!!message){","\t\t\t\t//Use a tmp buffer to build an internal msg","\t\t\t\tvar tmpBuffer = new Buffer(Buffer.byteLength(JSON.stringify(value))*2);","\t\t\t\tlength = 0;","","\t\t\t\tlength = encodeMsg(tmpBuffer, length, message, value);","\t\t\t\t//Encode length","\t\t\t\toffset = writeBytes(buffer, offset, codec.encodeUInt32(length));","\t\t\t\t//contact the object","\t\t\t\ttmpBuffer.copy(buffer, offset, 0, length);","","\t\t\t\toffset += length;","\t\t\t}","\t\tbreak;","\t}","","\treturn offset;","}","","/**"," * Encode reapeated properties, simple msg and object are decode differented"," */","function encodeArray(array, proto, offset, buffer, protos){","\tvar i = 0;","\tif(util.isSimpleType(proto.type)){","\t\toffset = writeBytes(buffer, offset, encodeTag(proto.type, proto.tag));","\t\toffset = writeBytes(buffer, offset, codec.encodeUInt32(array.length));","\t\tfor(i = 0; i < array.length; i++){","\t\t\toffset = encodeProp(array[i], proto.type, offset, buffer);","\t\t}","\t}else{","\t\tfor(i = 0; i < array.length; i++){","\t\t\toffset = writeBytes(buffer, offset, encodeTag(proto.type, proto.tag));","\t\t\toffset = encodeProp(array[i], proto.type, offset, buffer, protos);","\t\t}","\t}","","\treturn offset;","}","","function writeBytes(buffer, offset, bytes){","\tfor(var i = 0; i < bytes.length; i++){","\t\tbuffer.writeUInt8(bytes[i], offset);","\t\toffset++;","\t}","","\treturn offset;","}","","function encodeTag(type, tag){","\tvar value = constant.TYPES[type];","","\tif(value === undefined) value = 2;","","\treturn codec.encodeUInt32((tag<<3)|value);","}",""],"l":{"1":1,"2":1,"3":1,"5":1,"7":1,"8":0,"11":1,"12":0,"13":0,"14":0,"18":0,"21":0,"22":0,"23":0,"27":0,"30":0,"31":0,"33":0,"34":0,"35":0,"36":0,"40":0,"46":1,"47":0,"48":0,"49":0,"52":0,"53":0,"56":0,"58":0,"59":0,"60":0,"63":0,"64":0,"65":0,"66":0,"67":0,"70":0,"73":0,"74":0,"75":0,"76":0,"77":0,"81":0,"85":0,"88":1,"89":0,"90":0,"91":0,"93":0,"96":0,"97":0,"98":0,"100":0,"101":0,"103":0,"108":0,"111":1,"112":0,"114":0,"116":0,"117":0,"120":0,"121":0,"123":0,"124":0,"125":0,"127":0,"128":0,"129":0,"131":0,"134":0,"136":0,"137":0,"138":0,"140":0,"141":0,"143":0,"144":0,"146":0,"148":0,"150":0,"152":0,"154":0,"157":0,"163":1,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"172":0,"173":0,"174":0,"178":0,"181":1,"182":0,"183":0,"184":0,"187":0,"190":1,"191":0,"193":0,"195":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/codec.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/codec.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":23},"end":{"line":8,"column":36}}},"2":{"name":"(anonymous_2)","line":35,"loc":{"start":{"line":35,"column":23},"end":{"line":35,"column":36}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":23},"end":{"line":45,"column":38}}},"4":{"name":"(anonymous_4)","line":60,"loc":{"start":{"line":60,"column":23},"end":{"line":60,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":29}},"2":{"start":{"line":8,"column":0},"end":{"line":28,"column":2}},"3":{"start":{"line":9,"column":1},"end":{"line":9,"column":23}},"4":{"start":{"line":10,"column":1},"end":{"line":13,"column":2}},"5":{"start":{"line":11,"column":2},"end":{"line":11,"column":17}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":14}},"7":{"start":{"line":15,"column":1},"end":{"line":15,"column":17}},"8":{"start":{"line":16,"column":1},"end":{"line":25,"column":18}},"9":{"start":{"line":17,"column":2},"end":{"line":17,"column":20}},"10":{"start":{"line":18,"column":2},"end":{"line":18,"column":31}},"11":{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},"12":{"start":{"line":21,"column":3},"end":{"line":21,"column":19}},"13":{"start":{"line":23,"column":2},"end":{"line":23,"column":19}},"14":{"start":{"line":24,"column":2},"end":{"line":24,"column":11}},"15":{"start":{"line":27,"column":1},"end":{"line":27,"column":15}},"16":{"start":{"line":35,"column":0},"end":{"line":43,"column":2}},"17":{"start":{"line":36,"column":1},"end":{"line":36,"column":23}},"18":{"start":{"line":37,"column":1},"end":{"line":39,"column":2}},"19":{"start":{"line":38,"column":2},"end":{"line":38,"column":14}},"20":{"start":{"line":40,"column":1},"end":{"line":40,"column":31}},"21":{"start":{"line":42,"column":1},"end":{"line":42,"column":32}},"22":{"start":{"line":45,"column":0},"end":{"line":57,"column":2}},"23":{"start":{"line":46,"column":1},"end":{"line":46,"column":11}},"24":{"start":{"line":48,"column":1},"end":{"line":54,"column":2}},"25":{"start":{"line":49,"column":2},"end":{"line":49,"column":29}},"26":{"start":{"line":50,"column":2},"end":{"line":50,"column":43}},"27":{"start":{"line":51,"column":2},"end":{"line":53,"column":3}},"28":{"start":{"line":52,"column":3},"end":{"line":52,"column":12}},"29":{"start":{"line":56,"column":1},"end":{"line":56,"column":10}},"30":{"start":{"line":60,"column":0},"end":{"line":67,"column":2}},"31":{"start":{"line":61,"column":1},"end":{"line":61,"column":34}},"32":{"start":{"line":62,"column":1},"end":{"line":62,"column":31}},"33":{"start":{"line":64,"column":1},"end":{"line":64,"column":24}},"34":{"start":{"line":66,"column":1},"end":{"line":66,"column":10}}},"branchMap":{"1":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},{"start":{"line":10,"column":1},"end":{"line":10,"column":1}}]},"2":{"line":10,"type":"binary-expr","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":12}},{"start":{"line":10,"column":16},"end":{"line":10,"column":21}}]},"3":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":20,"column":2}},{"start":{"line":20,"column":2},"end":{"line":20,"column":2}}]},"4":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},{"start":{"line":37,"column":1},"end":{"line":37,"column":1}}]},"5":{"line":40,"type":"cond-expr","locations":[{"start":{"line":40,"column":10},"end":{"line":40,"column":25}},{"start":{"line":40,"column":27},"end":{"line":40,"column":30}}]},"6":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":2},"end":{"line":51,"column":2}},{"start":{"line":51,"column":2},"end":{"line":51,"column":2}}]},"7":{"line":62,"type":"cond-expr","locations":[{"start":{"line":62,"column":26},"end":{"line":62,"column":28}},{"start":{"line":62,"column":29},"end":{"line":62,"column":30}}]}},"code":["var Encoder = module.exports;","","/**"," * [encode an uInt32, return a array of bytes]"," * @param  {[integer]} num"," * @return {[array]}"," */","Encoder.encodeUInt32 = function(num){","\tvar n = parseInt(num);","\tif(isNaN(n) || n < 0){","\t\tconsole.log(n);","\t\treturn null;","\t}","","\tvar result = [];","\tdo{","\t\tvar tmp = n % 128;","\t\tvar next = Math.floor(n/128);","","\t\tif(next !== 0){","\t\t\ttmp = tmp + 128;","\t\t}","\t\tresult.push(tmp);","\t\tn = next;","\t} while(n !== 0);","","\treturn result;","};","","/**"," * [encode a sInt32, return a byte array]"," * @param  {[sInt32]} num  The sInt32 need to encode"," * @return {[array]} A byte array represent the integer"," */","Encoder.encodeSInt32 = function(num){","\tvar n = parseInt(num);","\tif(isNaN(n)){","\t\treturn null;","\t}","\tn = n<0?(Math.abs(n)*2-1):n*2;","","\treturn Encoder.encodeUInt32(n);","};","","Encoder.decodeUInt32 = function(bytes){","\tvar n = 0;","","\tfor(var i = 0; i < bytes.length; i++){","\t\tvar m = parseInt(bytes[i]);","\t\tn = n + ((m & 0x7f) * Math.pow(2,(7*i)));","\t\tif(m < 128){","\t\t\treturn n;","\t\t}","\t}","","\treturn n;","};","","","Encoder.decodeSInt32 = function(bytes){","\tvar n = this.decodeUInt32(bytes);","\tvar flag = ((n%2) === 1)?-1:1;","","\tn = ((n%2 + n)/2)*flag;","","\treturn n;","};",""],"l":{"1":1,"8":1,"9":0,"10":0,"11":0,"12":0,"15":0,"16":0,"17":0,"18":0,"20":0,"21":0,"23":0,"24":0,"27":0,"35":1,"36":0,"37":0,"38":0,"40":0,"42":0,"45":1,"46":0,"48":0,"49":0,"50":0,"51":0,"52":0,"56":0,"60":1,"61":0,"62":0,"64":0,"66":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/constant.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/constant.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":11,"column":1}}},"branchMap":{},"code":["module.exports = {","\tTYPES : {","\t\tuInt32 : 0,","\t\tsInt32 : 0,","\t\tint32 : 0,","\t\tdouble : 1,","\t\tstring : 2,","\t\tmessage : 2,","\t\tfloat : 5","\t}","}"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/util.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/util.js","s":{"1":1,"2":1,"3":0,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"1":[0,0,0,0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":20},"end":{"line":3,"column":34}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":13},"end":{"line":13,"column":33}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":3,"column":0},"end":{"line":11,"column":2}},"3":{"start":{"line":4,"column":1},"end":{"line":10,"column":25}},"4":{"start":{"line":13,"column":0},"end":{"line":28,"column":2}},"5":{"start":{"line":14,"column":1},"end":{"line":25,"column":2}},"6":{"start":{"line":15,"column":2},"end":{"line":15,"column":20}},"7":{"start":{"line":16,"column":2},"end":{"line":16,"column":20}},"8":{"start":{"line":18,"column":2},"end":{"line":24,"column":3}},"9":{"start":{"line":19,"column":3},"end":{"line":21,"column":4}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":17}},"11":{"start":{"line":22,"column":8},"end":{"line":24,"column":3}},"12":{"start":{"line":23,"column":3},"end":{"line":23,"column":16}},"13":{"start":{"line":27,"column":1},"end":{"line":27,"column":13}}},"branchMap":{"1":{"line":4,"type":"binary-expr","locations":[{"start":{"line":4,"column":10},"end":{"line":4,"column":27}},{"start":{"line":5,"column":6},"end":{"line":5,"column":23}},{"start":{"line":6,"column":6},"end":{"line":6,"column":22}},{"start":{"line":7,"column":6},"end":{"line":7,"column":23}},{"start":{"line":8,"column":6},"end":{"line":8,"column":23}},{"start":{"line":9,"column":6},"end":{"line":9,"column":22}},{"start":{"line":10,"column":6},"end":{"line":10,"column":23}}]},"2":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":2},"end":{"line":18,"column":2}},{"start":{"line":18,"column":2},"end":{"line":18,"column":2}}]},"3":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":3},"end":{"line":19,"column":3}},{"start":{"line":19,"column":3},"end":{"line":19,"column":3}}]},"4":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":22,"column":8}},{"start":{"line":22,"column":8},"end":{"line":22,"column":8}}]}},"code":["var util = module.exports;","","util.isSimpleType = function(type){","\treturn ( type === 'uInt32' ||","\t\t\t\t\t type === 'sInt32' ||","\t\t\t\t\t type === 'int32'  ||","\t\t\t\t\t type === 'uInt64' ||","\t\t\t\t\t type === 'sInt64' ||","\t\t\t\t\t type === 'float'  ||","\t\t\t\t\t type === 'double');","};","","util.equal = function(obj0, obj1){","\tfor(var key in obj0){","\t\tvar m = obj0[key];","\t\tvar n = obj1[key];","","\t\tif(typeof(m) === 'object'){","\t\t\tif(!util.equal(m, n)){","\t\t\t\treturn false;","\t\t\t}","\t\t}else if(m !== n){","\t\t\treturn false;","\t\t}","\t}","","\treturn true;","};"],"l":{"1":1,"3":1,"4":0,"13":1,"14":0,"15":0,"16":0,"18":0,"19":0,"20":0,"22":0,"23":0,"27":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/decoder.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/decoder.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":1,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":1,"33":0,"34":1,"35":0,"36":0,"37":1,"38":0,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":1,"62":0,"63":0,"64":0,"65":0,"66":0,"67":1,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":1,"80":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0,0,0,0,0,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":15},"end":{"line":9,"column":31}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":20},"end":{"line":13,"column":36}}},"3":{"name":"(anonymous_3)","line":19,"loc":{"start":{"line":19,"column":17},"end":{"line":19,"column":37}}},"4":{"name":"decodeMsg","line":32,"loc":{"start":{"line":32,"column":0},"end":{"line":32,"column":39}}},"5":{"name":"isFinish","line":59,"loc":{"start":{"line":59,"column":0},"end":{"line":59,"column":30}}},"6":{"name":"getHead","line":65,"loc":{"start":{"line":65,"column":0},"end":{"line":65,"column":18}}},"7":{"name":"peekHead","line":77,"loc":{"start":{"line":77,"column":0},"end":{"line":77,"column":19}}},"8":{"name":"decodeProp","line":86,"loc":{"start":{"line":86,"column":0},"end":{"line":86,"column":33}}},"9":{"name":"decodeArray","line":120,"loc":{"start":{"line":120,"column":0},"end":{"line":120,"column":41}}},"10":{"name":"getBytes","line":132,"loc":{"start":{"line":132,"column":0},"end":{"line":132,"column":23}}},"11":{"name":"peekBytes","line":150,"loc":{"start":{"line":150,"column":0},"end":{"line":150,"column":20}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":29}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":11}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":15}},"6":{"start":{"line":9,"column":0},"end":{"line":11,"column":2}},"7":{"start":{"line":10,"column":1},"end":{"line":10,"column":28}},"8":{"start":{"line":13,"column":0},"end":{"line":17,"column":2}},"9":{"start":{"line":14,"column":1},"end":{"line":16,"column":2}},"10":{"start":{"line":15,"column":2},"end":{"line":15,"column":23}},"11":{"start":{"line":19,"column":0},"end":{"line":30,"column":2}},"12":{"start":{"line":20,"column":1},"end":{"line":20,"column":33}},"13":{"start":{"line":22,"column":1},"end":{"line":22,"column":14}},"14":{"start":{"line":23,"column":1},"end":{"line":23,"column":12}},"15":{"start":{"line":25,"column":1},"end":{"line":27,"column":2}},"16":{"start":{"line":26,"column":2},"end":{"line":26,"column":46}},"17":{"start":{"line":29,"column":1},"end":{"line":29,"column":13}},"18":{"start":{"line":32,"column":0},"end":{"line":54,"column":1}},"19":{"start":{"line":33,"column":1},"end":{"line":51,"column":2}},"20":{"start":{"line":34,"column":2},"end":{"line":34,"column":23}},"21":{"start":{"line":35,"column":2},"end":{"line":35,"column":23}},"22":{"start":{"line":36,"column":2},"end":{"line":36,"column":21}},"23":{"start":{"line":37,"column":2},"end":{"line":37,"column":32}},"24":{"start":{"line":39,"column":2},"end":{"line":50,"column":3}},"25":{"start":{"line":42,"column":4},"end":{"line":42,"column":54}},"26":{"start":{"line":43,"column":3},"end":{"line":43,"column":9}},"27":{"start":{"line":45,"column":4},"end":{"line":47,"column":5}},"28":{"start":{"line":46,"column":5},"end":{"line":46,"column":20}},"29":{"start":{"line":48,"column":4},"end":{"line":48,"column":54}},"30":{"start":{"line":49,"column":3},"end":{"line":49,"column":9}},"31":{"start":{"line":53,"column":1},"end":{"line":53,"column":12}},"32":{"start":{"line":59,"column":0},"end":{"line":61,"column":1}},"33":{"start":{"line":60,"column":1},"end":{"line":60,"column":41}},"34":{"start":{"line":65,"column":0},"end":{"line":72,"column":1}},"35":{"start":{"line":66,"column":1},"end":{"line":66,"column":42}},"36":{"start":{"line":68,"column":1},"end":{"line":71,"column":3}},"37":{"start":{"line":77,"column":0},"end":{"line":84,"column":1}},"38":{"start":{"line":78,"column":1},"end":{"line":78,"column":43}},"39":{"start":{"line":80,"column":1},"end":{"line":83,"column":3}},"40":{"start":{"line":86,"column":0},"end":{"line":118,"column":1}},"41":{"start":{"line":87,"column":1},"end":{"line":117,"column":2}},"42":{"start":{"line":89,"column":3},"end":{"line":89,"column":41}},"43":{"start":{"line":92,"column":3},"end":{"line":92,"column":41}},"44":{"start":{"line":94,"column":3},"end":{"line":94,"column":42}},"45":{"start":{"line":95,"column":3},"end":{"line":95,"column":15}},"46":{"start":{"line":96,"column":3},"end":{"line":96,"column":16}},"47":{"start":{"line":98,"column":3},"end":{"line":98,"column":44}},"48":{"start":{"line":99,"column":3},"end":{"line":99,"column":15}},"49":{"start":{"line":100,"column":3},"end":{"line":100,"column":17}},"50":{"start":{"line":102,"column":3},"end":{"line":102,"column":47}},"51":{"start":{"line":104,"column":3},"end":{"line":104,"column":61}},"52":{"start":{"line":105,"column":3},"end":{"line":105,"column":20}},"53":{"start":{"line":107,"column":3},"end":{"line":107,"column":14}},"54":{"start":{"line":109,"column":3},"end":{"line":109,"column":90}},"55":{"start":{"line":110,"column":3},"end":{"line":115,"column":4}},"56":{"start":{"line":111,"column":4},"end":{"line":111,"column":48}},"57":{"start":{"line":112,"column":4},"end":{"line":112,"column":17}},"58":{"start":{"line":113,"column":4},"end":{"line":113,"column":43}},"59":{"start":{"line":114,"column":4},"end":{"line":114,"column":15}},"60":{"start":{"line":116,"column":2},"end":{"line":116,"column":8}},"61":{"start":{"line":120,"column":0},"end":{"line":130,"column":1}},"62":{"start":{"line":121,"column":1},"end":{"line":129,"column":2}},"63":{"start":{"line":122,"column":2},"end":{"line":122,"column":46}},"64":{"start":{"line":124,"column":2},"end":{"line":126,"column":3}},"65":{"start":{"line":125,"column":3},"end":{"line":125,"column":32}},"66":{"start":{"line":128,"column":2},"end":{"line":128,"column":39}},"67":{"start":{"line":132,"column":0},"end":{"line":148,"column":1}},"68":{"start":{"line":133,"column":1},"end":{"line":133,"column":16}},"69":{"start":{"line":134,"column":1},"end":{"line":134,"column":18}},"70":{"start":{"line":135,"column":1},"end":{"line":135,"column":22}},"71":{"start":{"line":137,"column":1},"end":{"line":137,"column":7}},"72":{"start":{"line":138,"column":1},"end":{"line":142,"column":18}},"73":{"start":{"line":139,"column":2},"end":{"line":139,"column":32}},"74":{"start":{"line":140,"column":2},"end":{"line":140,"column":16}},"75":{"start":{"line":141,"column":2},"end":{"line":141,"column":8}},"76":{"start":{"line":144,"column":1},"end":{"line":146,"column":2}},"77":{"start":{"line":145,"column":2},"end":{"line":145,"column":15}},"78":{"start":{"line":147,"column":1},"end":{"line":147,"column":14}},"79":{"start":{"line":150,"column":0},"end":{"line":152,"column":1}},"80":{"start":{"line":151,"column":1},"end":{"line":151,"column":23}}},"branchMap":{"1":{"line":10,"type":"binary-expr","locations":[{"start":{"line":10,"column":15},"end":{"line":10,"column":21}},{"start":{"line":10,"column":25},"end":{"line":10,"column":27}}]},"2":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},{"start":{"line":14,"column":1},"end":{"line":14,"column":1}}]},"3":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},{"start":{"line":25,"column":1},"end":{"line":25,"column":1}}]},"4":{"line":39,"type":"switch","locations":[{"start":{"line":40,"column":3},"end":{"line":40,"column":20}},{"start":{"line":41,"column":3},"end":{"line":43,"column":9}},{"start":{"line":44,"column":3},"end":{"line":49,"column":9}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":4},"end":{"line":45,"column":4}},{"start":{"line":45,"column":4},"end":{"line":45,"column":4}}]},"6":{"line":87,"type":"switch","locations":[{"start":{"line":88,"column":2},"end":{"line":89,"column":41}},{"start":{"line":90,"column":2},"end":{"line":90,"column":16}},{"start":{"line":91,"column":2},"end":{"line":92,"column":41}},{"start":{"line":93,"column":2},"end":{"line":96,"column":16}},{"start":{"line":97,"column":2},"end":{"line":100,"column":17}},{"start":{"line":101,"column":2},"end":{"line":107,"column":14}},{"start":{"line":108,"column":2},"end":{"line":116,"column":8}}]},"7":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":17},"end":{"line":109,"column":23}},{"start":{"line":109,"column":28},"end":{"line":109,"column":51}},{"start":{"line":109,"column":55},"end":{"line":109,"column":88}}]},"8":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":3},"end":{"line":110,"column":3}},{"start":{"line":110,"column":3},"end":{"line":110,"column":3}}]},"9":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},{"start":{"line":121,"column":1},"end":{"line":121,"column":1}}]},"10":{"line":135,"type":"binary-expr","locations":[{"start":{"line":135,"column":8},"end":{"line":135,"column":12}},{"start":{"line":135,"column":16},"end":{"line":135,"column":21}}]},"11":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},{"start":{"line":144,"column":1},"end":{"line":144,"column":1}}]}},"code":["var codec = require('./codec');","var util = require('./util');","","var Decoder = module.exports;","","var buffer;","var offset = 0;","","Decoder.init = function(protos){","\tthis.protos = protos || {};","};","","Decoder.setProtos = function(protos){","\tif(!!protos){","\t\tthis.protos = protos;","\t}","};","","Decoder.decode = function(route, buf){","\tvar protos = this.protos[route];","","\tbuffer = buf;","\toffset = 0;","","\tif(!!protos){","\t\treturn decodeMsg({}, protos, buffer.length);","\t}","","\treturn null;","};","","function decodeMsg(msg, protos, length){","\twhile(offset<length){","\t\tvar head = getHead();","\t\tvar type = head.type;","\t\tvar tag = head.tag;","\t\tvar name = protos.__tags[tag];","","\t\tswitch(protos[name].option){","\t\t\tcase 'optional' :","\t\t\tcase 'required' :","\t\t\t\tmsg[name] = decodeProp(protos[name].type, protos);","\t\t\tbreak;","\t\t\tcase 'repeated' :","\t\t\t\tif(!msg[name]){","\t\t\t\t\tmsg[name] = [];","\t\t\t\t}","\t\t\t\tdecodeArray(msg[name], protos[name].type, protos);","\t\t\tbreak;","\t\t}","\t}","","\treturn msg;","}","","/**"," * Test if the given msg is finished"," */","function isFinish(msg, protos){","\treturn (!protos.__tags[peekHead().tag]);","}","/**"," * Get property head from protobuf"," */","function getHead(){","\tvar tag = codec.decodeUInt32(getBytes());","","\treturn {","\t\ttype : tag&0x7,","\t\ttag\t: tag>>3","\t};","}","","/**"," * Get tag head without move the offset"," */","function peekHead(){","\tvar tag = codec.decodeUInt32(peekBytes());","","\treturn {","\t\ttype : tag&0x7,","\t\ttag\t: tag>>3","\t};","}","","function decodeProp(type, protos){","\tswitch(type){","\t\tcase 'uInt32':","\t\t\treturn codec.decodeUInt32(getBytes());","\t\tcase 'int32' :","\t\tcase 'sInt32' :","\t\t\treturn codec.decodeSInt32(getBytes());","\t\tcase 'float' :","\t\t\tvar float = buffer.readFloatLE(offset);","\t\t\toffset += 4;","\t\t\treturn float;","\t\tcase 'double' :","\t\t\tvar double = buffer.readDoubleLE(offset);","\t\t\toffset += 8;","\t\t\treturn double;","\t\tcase 'string' :","\t\t\tvar length = codec.decodeUInt32(getBytes());","","\t\t\tvar str =  buffer.toString('utf8', offset, offset+length);","\t\t\toffset += length;","","\t\t\treturn str;","\t\tdefault :","\t\t\tvar message = protos && (protos.__messages[type] || Decoder.protos['message ' + type]);","\t\t\tif(message){","\t\t\t\tvar length = codec.decodeUInt32(getBytes());","\t\t\t\tvar msg = {};","\t\t\t\tdecodeMsg(msg, message, offset+length);","\t\t\t\treturn msg;","\t\t\t}","\t\tbreak;","\t}","}","","function decodeArray(array, type, protos){","\tif(util.isSimpleType(type)){","\t\tvar length = codec.decodeUInt32(getBytes());","","\t\tfor(var i = 0; i < length; i++){","\t\t\tarray.push(decodeProp(type));","\t\t}","\t}else{","\t\tarray.push(decodeProp(type, protos));","\t}","}","","function getBytes(flag){","\tvar bytes = [];","\tvar pos = offset;","\tflag = flag || false;","","\tvar b;","\tdo{","\t\tvar b = buffer.readUInt8(pos);","\t\tbytes.push(b);","\t\tpos++;","\t}while(b >= 128);","","\tif(!flag){","\t\toffset = pos;","\t}","\treturn bytes;","}","","function peekBytes(){","\treturn getBytes(true);","}"],"l":{"1":1,"2":1,"4":1,"6":1,"7":1,"9":1,"10":0,"13":1,"14":0,"15":0,"19":1,"20":0,"22":0,"23":0,"25":0,"26":0,"29":0,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"39":0,"42":0,"43":0,"45":0,"46":0,"48":0,"49":0,"53":0,"59":1,"60":0,"65":1,"66":0,"68":0,"77":1,"78":0,"80":0,"86":1,"87":0,"89":0,"92":0,"94":0,"95":0,"96":0,"98":0,"99":0,"100":0,"102":0,"104":0,"105":0,"107":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"116":0,"120":1,"121":0,"122":0,"124":0,"125":0,"128":0,"132":1,"133":0,"134":0,"135":0,"137":0,"138":0,"139":0,"140":0,"141":0,"144":0,"145":0,"147":0,"150":1,"151":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/parser.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protobuf/lib/parser.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},"b":{"1":[0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":15},"end":{"line":8,"column":31}}},"2":{"name":"parseObject","line":22,"loc":{"start":{"line":22,"column":0},"end":{"line":22,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":28}},"2":{"start":{"line":8,"column":0},"end":{"line":15,"column":2}},"3":{"start":{"line":9,"column":1},"end":{"line":9,"column":15}},"4":{"start":{"line":10,"column":1},"end":{"line":12,"column":2}},"5":{"start":{"line":11,"column":2},"end":{"line":11,"column":39}},"6":{"start":{"line":14,"column":1},"end":{"line":14,"column":13}},"7":{"start":{"line":22,"column":0},"end":{"line":58,"column":1}},"8":{"start":{"line":23,"column":1},"end":{"line":23,"column":16}},"9":{"start":{"line":24,"column":1},"end":{"line":24,"column":21}},"10":{"start":{"line":25,"column":1},"end":{"line":25,"column":15}},"11":{"start":{"line":27,"column":1},"end":{"line":53,"column":2}},"12":{"start":{"line":28,"column":2},"end":{"line":28,"column":22}},"13":{"start":{"line":29,"column":2},"end":{"line":29,"column":31}},"14":{"start":{"line":31,"column":2},"end":{"line":52,"column":3}},"15":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"16":{"start":{"line":34,"column":5},"end":{"line":34,"column":14}},"17":{"start":{"line":36,"column":4},"end":{"line":36,"column":45}},"18":{"start":{"line":37,"column":4},"end":{"line":37,"column":13}},"19":{"start":{"line":42,"column":4},"end":{"line":44,"column":5}},"20":{"start":{"line":43,"column":5},"end":{"line":43,"column":14}},"21":{"start":{"line":45,"column":4},"end":{"line":49,"column":6}},"22":{"start":{"line":50,"column":4},"end":{"line":50,"column":26}},"23":{"start":{"line":55,"column":1},"end":{"line":55,"column":31}},"24":{"start":{"line":56,"column":1},"end":{"line":56,"column":21}},"25":{"start":{"line":57,"column":1},"end":{"line":57,"column":14}}},"branchMap":{"1":{"line":31,"type":"switch","locations":[{"start":{"line":32,"column":3},"end":{"line":37,"column":13}},{"start":{"line":38,"column":3},"end":{"line":38,"column":19}},{"start":{"line":39,"column":3},"end":{"line":39,"column":19}},{"start":{"line":40,"column":3},"end":{"line":51,"column":4}}]},"2":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"3":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]},"4":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":7},"end":{"line":42,"column":26}},{"start":{"line":42,"column":30},"end":{"line":42,"column":41}}]}},"code":["var Parser = module.exports;","","/**"," * [parse the original protos, give the paresed result can be used by protobuf encode/decode.]"," * @param  {[Object]} protos Original protos, in a js map."," * @return {[Object]} The presed result, a js object represent all the meta data of the given protos."," */","Parser.parse = function(protos){","\tvar maps = {};","\tfor(var key in protos){","\t\tmaps[key] = parseObject(protos[key]);","\t}","","\treturn maps;","};","","/**"," * [parse a single protos, return a object represent the result. The method can be invocked recursively.]"," * @param  {[Object]} obj The origin proto need to parse."," * @return {[Object]} The parsed result, a js object."," */","function parseObject(obj){","\tvar proto = {};","\tvar nestProtos = {};","\tvar tags = {};","","\tfor(var name in obj){","\t\tvar tag = obj[name];","\t\tvar params = name.split(' ');","","\t\tswitch(params[0]){","\t\t\tcase 'message':","\t\t\t\tif(params.length !== 2){","\t\t\t\t\tcontinue;","\t\t\t\t}","\t\t\t\tnestProtos[params[1]] = parseObject(tag);","\t\t\t\tcontinue;","\t\t\tcase 'required':","\t\t\tcase 'optional':","\t\t\tcase 'repeated':{","\t\t\t\t//params length should be 3 and tag can't be duplicated","\t\t\t\tif(params.length !== 3 || !!tags[tag]){","\t\t\t\t\tcontinue;","\t\t\t\t}","\t\t\t\tproto[params[2]] = {","\t\t\t\t\toption : params[0],","\t\t\t\t\ttype : params[1],","\t\t\t\t\ttag : tag","\t\t\t\t};","\t\t\t\ttags[tag] = params[2];","\t\t\t}","\t\t}","\t}","","\tproto.__messages = nestProtos;","\tproto.__tags = tags;","\treturn proto;","}"],"l":{"1":1,"8":1,"9":0,"10":0,"11":0,"14":0,"22":1,"23":0,"24":0,"25":0,"27":0,"28":0,"29":0,"31":0,"33":0,"34":0,"36":0,"37":0,"42":0,"43":0,"45":0,"50":0,"55":0,"56":0,"57":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/proxy.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/proxy.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":1,"55":0,"56":1,"57":0,"58":0,"59":0,"60":0,"61":0,"62":1,"63":0,"64":1,"65":0,"66":0,"67":0,"68":0,"69":0,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":1,"78":0,"79":0,"80":1,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":1,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"fnMap":{"1":{"name":"(anonymous_1)","line":22,"loc":{"start":{"line":22,"column":17},"end":{"line":22,"column":37}}},"2":{"name":"(anonymous_2)","line":45,"loc":{"start":{"line":45,"column":16},"end":{"line":45,"column":36}}},"3":{"name":"(anonymous_3)","line":64,"loc":{"start":{"line":64,"column":12},"end":{"line":64,"column":25}}},"4":{"name":"(anonymous_4)","line":90,"loc":{"start":{"line":90,"column":17},"end":{"line":90,"column":30}}},"5":{"name":"(anonymous_5)","line":92,"loc":{"start":{"line":92,"column":35},"end":{"line":92,"column":46}}},"6":{"name":"(anonymous_6)","line":95,"loc":{"start":{"line":95,"column":38},"end":{"line":95,"column":49}}},"7":{"name":"(anonymous_7)","line":107,"loc":{"start":{"line":107,"column":17},"end":{"line":107,"column":35}}},"8":{"name":"(anonymous_8)","line":121,"loc":{"start":{"line":121,"column":20},"end":{"line":121,"column":34}}},"9":{"name":"(anonymous_9)","line":130,"loc":{"start":{"line":130,"column":21},"end":{"line":130,"column":39}}},"10":{"name":"(anonymous_10)","line":149,"loc":{"start":{"line":149,"column":16},"end":{"line":149,"column":44}}},"11":{"name":"(anonymous_11)","line":160,"loc":{"start":{"line":160,"column":19},"end":{"line":160,"column":39}}},"12":{"name":"(anonymous_12)","line":177,"loc":{"start":{"line":177,"column":17},"end":{"line":177,"column":47}}},"13":{"name":"(anonymous_13)","line":195,"loc":{"start":{"line":195,"column":15},"end":{"line":195,"column":39}}},"14":{"name":"(anonymous_14)","line":208,"loc":{"start":{"line":208,"column":22},"end":{"line":208,"column":43}}},"15":{"name":"(anonymous_15)","line":231,"loc":{"start":{"line":231,"column":18},"end":{"line":231,"column":29}}},"16":{"name":"(anonymous_16)","line":232,"loc":{"start":{"line":232,"column":9},"end":{"line":232,"column":41}}},"17":{"name":"(anonymous_17)","line":251,"loc":{"start":{"line":251,"column":19},"end":{"line":251,"column":51}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":25}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":37}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":39}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":42}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":43}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":45}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":70}},"8":{"start":{"line":22,"column":0},"end":{"line":37,"column":2}},"9":{"start":{"line":23,"column":2},"end":{"line":23,"column":20}},"10":{"start":{"line":26,"column":2},"end":{"line":26,"column":60}},"11":{"start":{"line":27,"column":2},"end":{"line":27,"column":38}},"12":{"start":{"line":28,"column":2},"end":{"line":28,"column":30}},"13":{"start":{"line":29,"column":2},"end":{"line":29,"column":21}},"14":{"start":{"line":30,"column":2},"end":{"line":30,"column":26}},"15":{"start":{"line":31,"column":2},"end":{"line":34,"column":3}},"16":{"start":{"line":32,"column":4},"end":{"line":32,"column":28}},"17":{"start":{"line":33,"column":4},"end":{"line":33,"column":81}},"18":{"start":{"line":36,"column":2},"end":{"line":36,"column":34}},"19":{"start":{"line":45,"column":0},"end":{"line":52,"column":2}},"20":{"start":{"line":46,"column":2},"end":{"line":46,"column":17}},"21":{"start":{"line":47,"column":2},"end":{"line":47,"column":19}},"22":{"start":{"line":48,"column":2},"end":{"line":48,"column":45}},"23":{"start":{"line":49,"column":2},"end":{"line":49,"column":68}},"24":{"start":{"line":50,"column":2},"end":{"line":50,"column":74}},"25":{"start":{"line":51,"column":2},"end":{"line":51,"column":76}},"26":{"start":{"line":54,"column":0},"end":{"line":54,"column":30}},"27":{"start":{"line":56,"column":0},"end":{"line":56,"column":23}},"28":{"start":{"line":64,"column":0},"end":{"line":82,"column":2}},"29":{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},"30":{"start":{"line":66,"column":4},"end":{"line":66,"column":109}},"31":{"start":{"line":68,"column":2},"end":{"line":68,"column":70}},"32":{"start":{"line":69,"column":2},"end":{"line":69,"column":68}},"33":{"start":{"line":70,"column":2},"end":{"line":70,"column":75}},"34":{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},"35":{"start":{"line":73,"column":4},"end":{"line":73,"column":35}},"36":{"start":{"line":75,"column":2},"end":{"line":77,"column":3}},"37":{"start":{"line":76,"column":4},"end":{"line":76,"column":33}},"38":{"start":{"line":78,"column":2},"end":{"line":80,"column":3}},"39":{"start":{"line":79,"column":4},"end":{"line":79,"column":49}},"40":{"start":{"line":81,"column":2},"end":{"line":81,"column":23}},"41":{"start":{"line":90,"column":0},"end":{"line":100,"column":2}},"42":{"start":{"line":91,"column":2},"end":{"line":91,"column":18}},"43":{"start":{"line":92,"column":2},"end":{"line":94,"column":5}},"44":{"start":{"line":93,"column":4},"end":{"line":93,"column":36}},"45":{"start":{"line":95,"column":2},"end":{"line":97,"column":5}},"46":{"start":{"line":96,"column":4},"end":{"line":96,"column":35}},"47":{"start":{"line":98,"column":2},"end":{"line":98,"column":75}},"48":{"start":{"line":99,"column":2},"end":{"line":99,"column":24}},"49":{"start":{"line":107,"column":0},"end":{"line":114,"column":2}},"50":{"start":{"line":108,"column":2},"end":{"line":110,"column":3}},"51":{"start":{"line":109,"column":4},"end":{"line":109,"column":11}},"52":{"start":{"line":112,"column":2},"end":{"line":112,"column":45}},"53":{"start":{"line":113,"column":2},"end":{"line":113,"column":34}},"54":{"start":{"line":121,"column":0},"end":{"line":123,"column":2}},"55":{"start":{"line":122,"column":2},"end":{"line":122,"column":33}},"56":{"start":{"line":130,"column":0},"end":{"line":140,"column":2}},"57":{"start":{"line":131,"column":2},"end":{"line":133,"column":3}},"58":{"start":{"line":132,"column":4},"end":{"line":132,"column":11}},"59":{"start":{"line":136,"column":2},"end":{"line":136,"column":27}},"60":{"start":{"line":137,"column":2},"end":{"line":137,"column":45}},"61":{"start":{"line":139,"column":2},"end":{"line":139,"column":38}},"62":{"start":{"line":149,"column":0},"end":{"line":151,"column":2}},"63":{"start":{"line":150,"column":2},"end":{"line":150,"column":43}},"64":{"start":{"line":160,"column":0},"end":{"line":168,"column":2}},"65":{"start":{"line":161,"column":2},"end":{"line":161,"column":21}},"66":{"start":{"line":162,"column":2},"end":{"line":162,"column":26}},"67":{"start":{"line":163,"column":2},"end":{"line":167,"column":3}},"68":{"start":{"line":164,"column":4},"end":{"line":164,"column":39}},"69":{"start":{"line":166,"column":4},"end":{"line":166,"column":31}},"70":{"start":{"line":177,"column":0},"end":{"line":186,"column":2}},"71":{"start":{"line":178,"column":2},"end":{"line":178,"column":11}},"72":{"start":{"line":179,"column":2},"end":{"line":185,"column":3}},"73":{"start":{"line":180,"column":4},"end":{"line":180,"column":21}},"74":{"start":{"line":181,"column":4},"end":{"line":183,"column":5}},"75":{"start":{"line":182,"column":6},"end":{"line":182,"column":15}},"76":{"start":{"line":184,"column":4},"end":{"line":184,"column":50}},"77":{"start":{"line":195,"column":0},"end":{"line":198,"column":2}},"78":{"start":{"line":196,"column":2},"end":{"line":196,"column":29}},"79":{"start":{"line":197,"column":2},"end":{"line":197,"column":55}},"80":{"start":{"line":208,"column":0},"end":{"line":229,"column":2}},"81":{"start":{"line":209,"column":2},"end":{"line":211,"column":11}},"82":{"start":{"line":213,"column":2},"end":{"line":217,"column":3}},"83":{"start":{"line":214,"column":4},"end":{"line":214,"column":51}},"84":{"start":{"line":216,"column":4},"end":{"line":216,"column":50}},"85":{"start":{"line":218,"column":2},"end":{"line":220,"column":3}},"86":{"start":{"line":219,"column":4},"end":{"line":219,"column":77}},"87":{"start":{"line":223,"column":2},"end":{"line":223,"column":65}},"88":{"start":{"line":224,"column":2},"end":{"line":226,"column":3}},"89":{"start":{"line":225,"column":4},"end":{"line":225,"column":78}},"90":{"start":{"line":228,"column":2},"end":{"line":228,"column":17}},"91":{"start":{"line":231,"column":0},"end":{"line":249,"column":2}},"92":{"start":{"line":232,"column":2},"end":{"line":248,"column":4}},"93":{"start":{"line":233,"column":4},"end":{"line":233,"column":39}},"94":{"start":{"line":235,"column":4},"end":{"line":238,"column":5}},"95":{"start":{"line":236,"column":6},"end":{"line":236,"column":42}},"96":{"start":{"line":237,"column":6},"end":{"line":237,"column":13}},"97":{"start":{"line":240,"column":4},"end":{"line":241,"column":48}},"98":{"start":{"line":243,"column":4},"end":{"line":247,"column":5}},"99":{"start":{"line":244,"column":6},"end":{"line":244,"column":35}},"100":{"start":{"line":246,"column":6},"end":{"line":246,"column":42}},"101":{"start":{"line":251,"column":0},"end":{"line":261,"column":2}},"102":{"start":{"line":252,"column":2},"end":{"line":252,"column":50}},"103":{"start":{"line":253,"column":2},"end":{"line":256,"column":3}},"104":{"start":{"line":254,"column":4},"end":{"line":254,"column":73}},"105":{"start":{"line":255,"column":4},"end":{"line":255,"column":11}},"106":{"start":{"line":258,"column":2},"end":{"line":258,"column":47}},"107":{"start":{"line":259,"column":2},"end":{"line":259,"column":64}},"108":{"start":{"line":260,"column":2},"end":{"line":260,"column":49}}},"branchMap":{"1":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":9},"end":{"line":23,"column":13}},{"start":{"line":23,"column":17},"end":{"line":23,"column":19}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":19},"end":{"line":26,"column":33}},{"start":{"line":26,"column":37},"end":{"line":26,"column":50}},{"start":{"line":26,"column":54},"end":{"line":26,"column":59}}]},"3":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":18},"end":{"line":27,"column":31}},{"start":{"line":27,"column":35},"end":{"line":27,"column":37}}]},"4":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":31,"column":2}},{"start":{"line":31,"column":2},"end":{"line":31,"column":2}}]},"5":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":2},"end":{"line":65,"column":2}},{"start":{"line":65,"column":2},"end":{"line":65,"column":2}}]},"6":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":2},"end":{"line":72,"column":2}},{"start":{"line":72,"column":2},"end":{"line":72,"column":2}}]},"7":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":2},"end":{"line":75,"column":2}},{"start":{"line":75,"column":2},"end":{"line":75,"column":2}}]},"8":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":2},"end":{"line":78,"column":2}},{"start":{"line":78,"column":2},"end":{"line":78,"column":2}}]},"9":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":108,"column":2}},{"start":{"line":108,"column":2},"end":{"line":108,"column":2}}]},"10":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":6},"end":{"line":108,"column":14}},{"start":{"line":108,"column":18},"end":{"line":108,"column":33}}]},"11":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":2},"end":{"line":131,"column":2}},{"start":{"line":131,"column":2},"end":{"line":131,"column":2}}]},"12":{"line":131,"type":"binary-expr","locations":[{"start":{"line":131,"column":6},"end":{"line":131,"column":14}},{"start":{"line":131,"column":18},"end":{"line":131,"column":33}}]},"13":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":2},"end":{"line":163,"column":2}},{"start":{"line":163,"column":2},"end":{"line":163,"column":2}}]},"14":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":4},"end":{"line":181,"column":4}},{"start":{"line":181,"column":4},"end":{"line":181,"column":4}}]},"15":{"line":197,"type":"binary-expr","locations":[{"start":{"line":197,"column":9},"end":{"line":197,"column":20}},{"start":{"line":197,"column":24},"end":{"line":197,"column":54}}]},"16":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":2},"end":{"line":213,"column":2}},{"start":{"line":213,"column":2},"end":{"line":213,"column":2}}]},"17":{"line":218,"type":"if","locations":[{"start":{"line":218,"column":2},"end":{"line":218,"column":2}},{"start":{"line":218,"column":2},"end":{"line":218,"column":2}}]},"18":{"line":224,"type":"if","locations":[{"start":{"line":224,"column":2},"end":{"line":224,"column":2}},{"start":{"line":224,"column":2},"end":{"line":224,"column":2}}]},"19":{"line":235,"type":"if","locations":[{"start":{"line":235,"column":4},"end":{"line":235,"column":4}},{"start":{"line":235,"column":4},"end":{"line":235,"column":4}}]},"20":{"line":241,"type":"binary-expr","locations":[{"start":{"line":241,"column":14},"end":{"line":241,"column":26}},{"start":{"line":241,"column":30},"end":{"line":241,"column":47}}]},"21":{"line":243,"type":"if","locations":[{"start":{"line":243,"column":4},"end":{"line":243,"column":4}},{"start":{"line":243,"column":4},"end":{"line":243,"column":4}}]},"22":{"line":253,"type":"if","locations":[{"start":{"line":253,"column":2},"end":{"line":253,"column":2}},{"start":{"line":253,"column":2},"end":{"line":253,"column":2}}]},"23":{"line":253,"type":"binary-expr","locations":[{"start":{"line":253,"column":6},"end":{"line":253,"column":11}},{"start":{"line":253,"column":15},"end":{"line":253,"column":27}}]},"24":{"line":258,"type":"cond-expr","locations":[{"start":{"line":258,"column":23},"end":{"line":258,"column":40}},{"start":{"line":258,"column":44},"end":{"line":258,"column":46}}]},"25":{"line":258,"type":"binary-expr","locations":[{"start":{"line":258,"column":23},"end":{"line":258,"column":34}},{"start":{"line":258,"column":38},"end":{"line":258,"column":40}}]}},"code":["/**"," * Component for proxy."," * Generate proxies for rpc client."," */","var crc = require('crc');","var utils = require('../util/utils');","var events = require('../util/events');","var Client = require('pomelo-rpc').client;","var pathUtil = require('../util/pathUtil');","var Constants = require('../util/constants');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","/**"," * Component factory function"," *"," * @param {Object} app  current application context"," * @param {Object} opts construct parameters"," *                      opts.router: (optional) rpc message route function, route(routeParam, msg, cb),"," *                      opts.mailBoxFactory: (optional) mail box factory instance."," * @return {Object}     component instance"," */","module.exports = function(app, opts) {","  opts = opts || {};","  // proxy default config","  // cacheMsg is deprecated, just for compatibility here.","  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;","  opts.interval = opts.interval || 30;","  opts.router = genRouteFun();","  opts.context = app;","  opts.routeContext = app;","  if (app.enabled('rpcDebugLog')) {","    opts.rpcDebugLog = true;","    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);","  }","","  return new Component(app, opts);","};","","/**"," * Proxy component class"," *"," * @param {Object} app  current application context"," * @param {Object} opts construct parameters"," */","var Component = function(app, opts) {","  this.app = app;","  this.opts = opts;","  this.client = genRpcClient(this.app, opts);","  this.app.event.on(events.ADD_SERVERS, this.addServers.bind(this));","  this.app.event.on(events.REMOVE_SERVERS, this.removeServers.bind(this));","  this.app.event.on(events.REPLACE_SERVERS, this.replaceServers.bind(this));","};","","var pro = Component.prototype;","","pro.name = '__proxy__';","","/**"," * Proxy component lifecycle function"," *"," * @param {Function} cb"," * @return {Void}"," */","pro.start = function(cb) {","  if(this.opts.enableRpcLog) {","    logger.warn('enableRpcLog is deprecated in 0.8.0, please use app.rpcFilter(pomelo.rpcFilters.rpcLog())');","  }","  var rpcBefores = this.app.get(Constants.KEYWORDS.RPC_BEFORE_FILTER);","  var rpcAfters = this.app.get(Constants.KEYWORDS.RPC_AFTER_FILTER);","  var rpcErrorHandler = this.app.get(Constants.RESERVED.RPC_ERROR_HANDLER);","","  if(!!rpcBefores) {","    this.client.before(rpcBefores);","  } ","  if(!!rpcAfters) {","    this.client.after(rpcAfters);","  }","  if(!!rpcErrorHandler) {","    this.client.setErrorHandler(rpcErrorHandler);","  }","  process.nextTick(cb);","};","","/**"," * Component lifecycle callback"," *"," * @param {Function} cb"," * @return {Void}"," */","pro.afterStart = function(cb) {","  var self = this;","  this.app.__defineGetter__('rpc', function() {","    return self.client.proxies.user;","  });","  this.app.__defineGetter__('sysrpc', function() {","    return self.client.proxies.sys;","  });","  this.app.set('rpcInvoke', this.client.rpcInvoke.bind(this.client), true);","  this.client.start(cb);","};","","/**"," * Add remote server to the rpc client."," *"," * @param {Array} servers server info list, {id, serverType, host, port}"," */","pro.addServers = function(servers) {","  if (!servers || !servers.length) {","    return;","  }","","  genProxies(this.client, this.app, servers);","  this.client.addServers(servers);","};","","/**"," * Remove remote server from the rpc client."," *"," * @param  {Array} ids server id list"," */","pro.removeServers = function(ids) {","  this.client.removeServers(ids);","};","","/**"," * Replace remote servers from the rpc client."," *"," * @param  {Array} ids server id list"," */","pro.replaceServers = function(servers) {","  if (!servers || !servers.length) {","    return;","  }","","  // update proxies","  this.client.proxies = {};","  genProxies(this.client, this.app, servers);","","  this.client.replaceServers(servers);","};","","/**"," * Proxy for rpc client rpcInvoke."," *"," * @param {String}   serverId remote server id"," * @param {Object}   msg      rpc message: {serverType: serverType, service: serviceName, method: methodName, args: arguments}"," * @param {Function} cb      callback function"," */","pro.rpcInvoke = function(serverId, msg, cb) {","  this.client.rpcInvoke(serverId, msg, cb);","};","","/**"," * Generate rpc client"," *"," * @param {Object} app current application context"," * @param {Object} opts contructor parameters for rpc client"," * @return {Object} rpc client"," */","var genRpcClient = function(app, opts) {","  opts.context = app;","  opts.routeContext = app;","  if(!!opts.rpcClient) {","    return opts.rpcClient.create(opts);","  } else {","    return Client.create(opts);","  }","};","","/**"," * Generate proxy for the server infos."," *"," * @param  {Object} client rpc client instance"," * @param  {Object} app    application context"," * @param  {Array} sinfos server info list"," */","var genProxies = function(client, app, sinfos) {","  var item;","  for (var i = 0, l = sinfos.length; i < l; i++) {","    item = sinfos[i];","    if (hasProxy(client, item)) {","      continue;","    }","    client.addProxies(getProxyRecords(app, item));","  }","};","","/**"," * Check a server whether has generated proxy before"," *"," * @param  {Object}  client rpc client instance"," * @param  {Object}  sinfo  server info"," * @return {Boolean}        true or false"," */","var hasProxy = function(client, sinfo) {","  var proxy = client.proxies;","  return !!proxy.sys && !! proxy.sys[sinfo.serverType];","};","","/**"," * Get proxy path for rpc client."," * Iterate all the remote service path and create remote path record."," *"," * @param {Object} app current application context"," * @param {Object} sinfo server info, format: {id, serverType, host, port}"," * @return {Array}     remote path record array"," */","var getProxyRecords = function(app, sinfo) {","  var records = [],","    appBase = app.getBase(),","    record;","  // sys remote service path record","  if (app.isFrontend(sinfo)) {","    record = pathUtil.getSysRemotePath('frontend');","  } else {","    record = pathUtil.getSysRemotePath('backend');","  }","  if (record) {","    records.push(pathUtil.remotePathRecord('sys', sinfo.serverType, record));","  }","","  // user remote service path record","  record = pathUtil.getUserRemotePath(appBase, sinfo.serverType);","  if (record) {","    records.push(pathUtil.remotePathRecord('user', sinfo.serverType, record));","  }","","  return records;","};","","var genRouteFun = function() {","  return function(session, msg, app, cb) {","    var routes = app.get('__routes__');","","    if (!routes) {","      defaultRoute(session, msg, app, cb);","      return;","    }","","    var type = msg.serverType,","      route = routes[type] || routes['default'];","","    if (route) {","      route(session, msg, app, cb);","    } else {","      defaultRoute(session, msg, app, cb);","    }","  };","};","","var defaultRoute = function(session, msg, app, cb) {","  var list = app.getServersByType(msg.serverType);","  if (!list || !list.length) {","    cb(new Error('can not find server info for type:' + msg.serverType));","    return;","  }","","  var uid = session ? (session.uid || '') : '';","  var index = Math.abs(crc.crc32(uid.toString())) % list.length;","  utils.invokeCallback(cb, null, list[index].id);","};",""],"l":{"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"22":1,"23":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"36":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"54":1,"56":1,"64":1,"65":0,"66":0,"68":0,"69":0,"70":0,"72":0,"73":0,"75":0,"76":0,"78":0,"79":0,"81":0,"90":1,"91":0,"92":0,"93":0,"95":0,"96":0,"98":0,"99":0,"107":1,"108":0,"109":0,"112":0,"113":0,"121":1,"122":0,"130":1,"131":0,"132":0,"136":0,"137":0,"139":0,"149":1,"150":0,"160":1,"161":0,"162":0,"163":0,"164":0,"166":0,"177":1,"178":0,"179":0,"180":0,"181":0,"182":0,"184":0,"195":1,"196":0,"197":0,"208":1,"209":0,"213":0,"214":0,"216":0,"218":0,"219":0,"223":0,"224":0,"225":0,"228":0,"231":1,"232":0,"233":0,"235":0,"236":0,"237":0,"240":0,"243":0,"244":0,"246":0,"251":1,"252":0,"253":0,"254":0,"255":0,"258":0,"259":0,"260":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/index.js","s":{"1":1,"2":0,"3":0,"4":1,"5":1},"b":{"1":[0,1]},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":7,"column":1}},"2":{"start":{"line":2,"column":2},"end":{"line":2,"column":65}},"3":{"start":{"line":3,"column":2},"end":{"line":3,"column":65}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":61}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":61}}},"branchMap":{"1":{"line":1,"type":"if","locations":[{"start":{"line":1,"column":0},"end":{"line":1,"column":0}},{"start":{"line":1,"column":0},"end":{"line":1,"column":0}}]}},"code":["if(process.env.POMELO_RPC_COV) {","  module.exports.client = require('./lib-cov/rpc-client/client');","  module.exports.server = require('./lib-cov/rpc-server/server');","} else {","  module.exports.client = require('./lib/rpc-client/client');","  module.exports.server = require('./lib/rpc-server/server');","}"],"l":{"1":1,"2":0,"3":0,"5":1,"6":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/client.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/client.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":1,"61":0,"62":1,"63":0,"64":1,"65":0,"66":1,"67":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":1,"81":0,"82":1,"83":0,"84":1,"85":0,"86":1,"87":0,"88":1,"89":0,"90":1,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":1,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":1,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":1,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":1,"159":0,"160":0,"161":0,"162":0,"163":0,"164":1,"165":0,"166":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},"fnMap":{"1":{"name":"(anonymous_1)","line":22,"loc":{"start":{"line":22,"column":13},"end":{"line":22,"column":28}}},"2":{"name":"(anonymous_2)","line":46,"loc":{"start":{"line":46,"column":12},"end":{"line":46,"column":25}}},"3":{"name":"(anonymous_3)","line":53,"loc":{"start":{"line":53,"column":22},"end":{"line":53,"column":36}}},"4":{"name":"(anonymous_4)","line":70,"loc":{"start":{"line":70,"column":11},"end":{"line":70,"column":27}}},"5":{"name":"(anonymous_5)","line":86,"loc":{"start":{"line":86,"column":15},"end":{"line":86,"column":32}}},"6":{"name":"(anonymous_6)","line":102,"loc":{"start":{"line":102,"column":17},"end":{"line":102,"column":35}}},"7":{"name":"(anonymous_7)","line":116,"loc":{"start":{"line":116,"column":16},"end":{"line":116,"column":33}}},"8":{"name":"(anonymous_8)","line":125,"loc":{"start":{"line":125,"column":17},"end":{"line":125,"column":35}}},"9":{"name":"(anonymous_9)","line":134,"loc":{"start":{"line":134,"column":19},"end":{"line":134,"column":32}}},"10":{"name":"(anonymous_10)","line":143,"loc":{"start":{"line":143,"column":20},"end":{"line":143,"column":34}}},"11":{"name":"(anonymous_11)","line":152,"loc":{"start":{"line":152,"column":21},"end":{"line":152,"column":39}}},"12":{"name":"(anonymous_12)","line":164,"loc":{"start":{"line":164,"column":16},"end":{"line":164,"column":44}}},"13":{"name":"(anonymous_13)","line":189,"loc":{"start":{"line":189,"column":13},"end":{"line":189,"column":30}}},"14":{"name":"(anonymous_14)","line":200,"loc":{"start":{"line":200,"column":12},"end":{"line":200,"column":29}}},"15":{"name":"(anonymous_15)","line":211,"loc":{"start":{"line":211,"column":13},"end":{"line":211,"column":30}}},"16":{"name":"(anonymous_16)","line":222,"loc":{"start":{"line":222,"column":22},"end":{"line":222,"column":40}}},"17":{"name":"(anonymous_17)","line":233,"loc":{"start":{"line":233,"column":20},"end":{"line":233,"column":35}}},"18":{"name":"(anonymous_18)","line":246,"loc":{"start":{"line":246,"column":20},"end":{"line":246,"column":54}}},"19":{"name":"(anonymous_19)","line":278,"loc":{"start":{"line":278,"column":14},"end":{"line":278,"column":91}}},"20":{"name":"(anonymous_20)","line":302,"loc":{"start":{"line":302,"column":56},"end":{"line":302,"column":80}}},"21":{"name":"(anonymous_21)","line":322,"loc":{"start":{"line":322,"column":21},"end":{"line":322,"column":71}}},"22":{"name":"(anonymous_22)","line":342,"loc":{"start":{"line":342,"column":47},"end":{"line":342,"column":71}}},"23":{"name":"(anonymous_23)","line":357,"loc":{"start":{"line":357,"column":62},"end":{"line":357,"column":86}}},"24":{"name":"(anonymous_24)","line":373,"loc":{"start":{"line":373,"column":27},"end":{"line":373,"column":75}}},"25":{"name":"(anonymous_25)","line":385,"loc":{"start":{"line":385,"column":24},"end":{"line":385,"column":47}}},"26":{"name":"(anonymous_26)","line":387,"loc":{"start":{"line":387,"column":38},"end":{"line":387,"column":52}}},"27":{"name":"(anonymous_27)","line":406,"loc":{"start":{"line":406,"column":18},"end":{"line":406,"column":66}}},"28":{"name":"(anonymous_28)","line":426,"loc":{"start":{"line":426,"column":24},"end":{"line":426,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":76}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":49}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":39}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":39}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":38}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":37}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":37}},"9":{"start":{"line":9,"column":0},"end":{"line":9,"column":33}},"10":{"start":{"line":10,"column":0},"end":{"line":10,"column":29}},"11":{"start":{"line":15,"column":0},"end":{"line":15,"column":21}},"12":{"start":{"line":16,"column":0},"end":{"line":16,"column":22}},"13":{"start":{"line":17,"column":0},"end":{"line":17,"column":21}},"14":{"start":{"line":22,"column":0},"end":{"line":36,"column":2}},"15":{"start":{"line":23,"column":2},"end":{"line":23,"column":20}},"16":{"start":{"line":24,"column":2},"end":{"line":24,"column":31}},"17":{"start":{"line":25,"column":2},"end":{"line":25,"column":41}},"18":{"start":{"line":26,"column":2},"end":{"line":26,"column":41}},"19":{"start":{"line":27,"column":2},"end":{"line":27,"column":36}},"20":{"start":{"line":28,"column":2},"end":{"line":28,"column":38}},"21":{"start":{"line":29,"column":2},"end":{"line":31,"column":3}},"22":{"start":{"line":30,"column":4},"end":{"line":30,"column":43}},"23":{"start":{"line":32,"column":2},"end":{"line":32,"column":19}},"24":{"start":{"line":33,"column":2},"end":{"line":33,"column":20}},"25":{"start":{"line":34,"column":2},"end":{"line":34,"column":38}},"26":{"start":{"line":35,"column":2},"end":{"line":35,"column":28}},"27":{"start":{"line":38,"column":0},"end":{"line":38,"column":27}},"28":{"start":{"line":46,"column":0},"end":{"line":62,"column":2}},"29":{"start":{"line":47,"column":2},"end":{"line":50,"column":3}},"30":{"start":{"line":48,"column":4},"end":{"line":48,"column":45}},"31":{"start":{"line":49,"column":4},"end":{"line":49,"column":11}},"32":{"start":{"line":52,"column":2},"end":{"line":52,"column":18}},"33":{"start":{"line":53,"column":2},"end":{"line":61,"column":5}},"34":{"start":{"line":54,"column":4},"end":{"line":57,"column":5}},"35":{"start":{"line":55,"column":6},"end":{"line":55,"column":70}},"36":{"start":{"line":56,"column":6},"end":{"line":56,"column":21}},"37":{"start":{"line":58,"column":4},"end":{"line":58,"column":66}},"38":{"start":{"line":59,"column":4},"end":{"line":59,"column":31}},"39":{"start":{"line":60,"column":4},"end":{"line":60,"column":9}},"40":{"start":{"line":70,"column":0},"end":{"line":77,"column":2}},"41":{"start":{"line":71,"column":2},"end":{"line":74,"column":3}},"42":{"start":{"line":72,"column":4},"end":{"line":72,"column":59}},"43":{"start":{"line":73,"column":4},"end":{"line":73,"column":11}},"44":{"start":{"line":75,"column":2},"end":{"line":75,"column":28}},"45":{"start":{"line":76,"column":2},"end":{"line":76,"column":28}},"46":{"start":{"line":86,"column":0},"end":{"line":95,"column":2}},"47":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"48":{"start":{"line":88,"column":4},"end":{"line":88,"column":11}},"49":{"start":{"line":90,"column":2},"end":{"line":90,"column":57}},"50":{"start":{"line":91,"column":2},"end":{"line":93,"column":3}},"51":{"start":{"line":92,"column":4},"end":{"line":92,"column":11}},"52":{"start":{"line":94,"column":2},"end":{"line":94,"column":72}},"53":{"start":{"line":102,"column":0},"end":{"line":109,"column":2}},"54":{"start":{"line":103,"column":2},"end":{"line":105,"column":3}},"55":{"start":{"line":104,"column":4},"end":{"line":104,"column":11}},"56":{"start":{"line":106,"column":2},"end":{"line":108,"column":3}},"57":{"start":{"line":107,"column":4},"end":{"line":107,"column":30}},"58":{"start":{"line":116,"column":0},"end":{"line":118,"column":2}},"59":{"start":{"line":117,"column":2},"end":{"line":117,"column":34}},"60":{"start":{"line":125,"column":0},"end":{"line":127,"column":2}},"61":{"start":{"line":126,"column":2},"end":{"line":126,"column":36}},"62":{"start":{"line":134,"column":0},"end":{"line":136,"column":2}},"63":{"start":{"line":135,"column":2},"end":{"line":135,"column":33}},"64":{"start":{"line":143,"column":0},"end":{"line":145,"column":2}},"65":{"start":{"line":144,"column":2},"end":{"line":144,"column":35}},"66":{"start":{"line":152,"column":0},"end":{"line":154,"column":2}},"67":{"start":{"line":153,"column":2},"end":{"line":153,"column":40}},"68":{"start":{"line":164,"column":0},"end":{"line":180,"column":2}},"69":{"start":{"line":165,"column":2},"end":{"line":165,"column":37}},"70":{"start":{"line":166,"column":2},"end":{"line":166,"column":20}},"71":{"start":{"line":168,"column":2},"end":{"line":171,"column":3}},"72":{"start":{"line":169,"column":4},"end":{"line":169,"column":103}},"73":{"start":{"line":170,"column":4},"end":{"line":170,"column":81}},"74":{"start":{"line":173,"column":2},"end":{"line":178,"column":3}},"75":{"start":{"line":174,"column":4},"end":{"line":174,"column":113}},"76":{"start":{"line":175,"column":4},"end":{"line":175,"column":81}},"77":{"start":{"line":176,"column":4},"end":{"line":176,"column":82}},"78":{"start":{"line":177,"column":4},"end":{"line":177,"column":11}},"79":{"start":{"line":179,"column":2},"end":{"line":179,"column":63}},"80":{"start":{"line":189,"column":0},"end":{"line":191,"column":2}},"81":{"start":{"line":190,"column":2},"end":{"line":190,"column":31}},"82":{"start":{"line":200,"column":0},"end":{"line":202,"column":2}},"83":{"start":{"line":201,"column":2},"end":{"line":201,"column":30}},"84":{"start":{"line":211,"column":0},"end":{"line":213,"column":2}},"85":{"start":{"line":212,"column":2},"end":{"line":212,"column":31}},"86":{"start":{"line":222,"column":0},"end":{"line":224,"column":2}},"87":{"start":{"line":223,"column":2},"end":{"line":223,"column":38}},"88":{"start":{"line":233,"column":0},"end":{"line":235,"column":2}},"89":{"start":{"line":234,"column":2},"end":{"line":234,"column":30}},"90":{"start":{"line":246,"column":0},"end":{"line":264,"column":2}},"91":{"start":{"line":247,"column":2},"end":{"line":249,"column":3}},"92":{"start":{"line":248,"column":4},"end":{"line":248,"column":11}},"93":{"start":{"line":250,"column":2},"end":{"line":250,"column":16}},"94":{"start":{"line":251,"column":2},"end":{"line":251,"column":50}},"95":{"start":{"line":252,"column":2},"end":{"line":262,"column":3}},"96":{"start":{"line":253,"column":4},"end":{"line":253,"column":13}},"97":{"start":{"line":254,"column":4},"end":{"line":261,"column":5}},"98":{"start":{"line":255,"column":6},"end":{"line":260,"column":9}},"99":{"start":{"line":263,"column":2},"end":{"line":263,"column":13}},"100":{"start":{"line":278,"column":0},"end":{"line":310,"column":2}},"101":{"start":{"line":279,"column":2},"end":{"line":282,"column":3}},"102":{"start":{"line":280,"column":4},"end":{"line":280,"column":84}},"103":{"start":{"line":281,"column":4},"end":{"line":281,"column":11}},"104":{"start":{"line":283,"column":2},"end":{"line":287,"column":3}},"105":{"start":{"line":284,"column":4},"end":{"line":285,"column":68}},"106":{"start":{"line":286,"column":4},"end":{"line":286,"column":11}},"107":{"start":{"line":288,"column":2},"end":{"line":288,"column":32}},"108":{"start":{"line":289,"column":2},"end":{"line":289,"column":22}},"109":{"start":{"line":290,"column":2},"end":{"line":290,"column":37}},"110":{"start":{"line":291,"column":2},"end":{"line":297,"column":4}},"111":{"start":{"line":299,"column":2},"end":{"line":309,"column":3}},"112":{"start":{"line":300,"column":4},"end":{"line":300,"column":66}},"113":{"start":{"line":302,"column":4},"end":{"line":308,"column":7}},"114":{"start":{"line":303,"column":6},"end":{"line":305,"column":7}},"115":{"start":{"line":304,"column":8},"end":{"line":304,"column":23}},"116":{"start":{"line":307,"column":6},"end":{"line":307,"column":42}},"117":{"start":{"line":322,"column":0},"end":{"line":361,"column":2}},"118":{"start":{"line":323,"column":2},"end":{"line":360,"column":3}},"119":{"start":{"line":324,"column":4},"end":{"line":324,"column":15}},"120":{"start":{"line":325,"column":4},"end":{"line":341,"column":5}},"121":{"start":{"line":327,"column":8},"end":{"line":327,"column":27}},"122":{"start":{"line":328,"column":8},"end":{"line":328,"column":14}},"123":{"start":{"line":330,"column":8},"end":{"line":330,"column":28}},"124":{"start":{"line":331,"column":8},"end":{"line":331,"column":14}},"125":{"start":{"line":333,"column":8},"end":{"line":333,"column":27}},"126":{"start":{"line":334,"column":8},"end":{"line":334,"column":14}},"127":{"start":{"line":336,"column":8},"end":{"line":336,"column":27}},"128":{"start":{"line":337,"column":8},"end":{"line":337,"column":14}},"129":{"start":{"line":339,"column":8},"end":{"line":339,"column":27}},"130":{"start":{"line":340,"column":8},"end":{"line":340,"column":14}},"131":{"start":{"line":342,"column":4},"end":{"line":344,"column":7}},"132":{"start":{"line":343,"column":6},"end":{"line":343,"column":24}},"133":{"start":{"line":346,"column":4},"end":{"line":346,"column":22}},"134":{"start":{"line":347,"column":4},"end":{"line":356,"column":5}},"135":{"start":{"line":348,"column":6},"end":{"line":348,"column":28}},"136":{"start":{"line":349,"column":6},"end":{"line":349,"column":20}},"137":{"start":{"line":350,"column":11},"end":{"line":356,"column":5}},"138":{"start":{"line":351,"column":6},"end":{"line":351,"column":34}},"139":{"start":{"line":352,"column":6},"end":{"line":352,"column":29}},"140":{"start":{"line":354,"column":6},"end":{"line":354,"column":59}},"141":{"start":{"line":355,"column":6},"end":{"line":355,"column":13}},"142":{"start":{"line":357,"column":4},"end":{"line":359,"column":7}},"143":{"start":{"line":358,"column":6},"end":{"line":358,"column":24}},"144":{"start":{"line":373,"column":0},"end":{"line":394,"column":2}},"145":{"start":{"line":374,"column":2},"end":{"line":377,"column":3}},"146":{"start":{"line":375,"column":4},"end":{"line":375,"column":73}},"147":{"start":{"line":376,"column":4},"end":{"line":376,"column":11}},"148":{"start":{"line":378,"column":2},"end":{"line":393,"column":3}},"149":{"start":{"line":379,"column":4},"end":{"line":379,"column":68}},"150":{"start":{"line":380,"column":4},"end":{"line":383,"column":5}},"151":{"start":{"line":381,"column":6},"end":{"line":381,"column":79}},"152":{"start":{"line":382,"column":6},"end":{"line":382,"column":13}},"153":{"start":{"line":385,"column":4},"end":{"line":390,"column":11}},"154":{"start":{"line":386,"column":6},"end":{"line":386,"column":34}},"155":{"start":{"line":387,"column":6},"end":{"line":389,"column":9}},"156":{"start":{"line":388,"column":8},"end":{"line":388,"column":18}},"157":{"start":{"line":392,"column":4},"end":{"line":392,"column":40}},"158":{"start":{"line":406,"column":0},"end":{"line":415,"column":2}},"159":{"start":{"line":407,"column":2},"end":{"line":407,"column":48}},"160":{"start":{"line":408,"column":2},"end":{"line":414,"column":3}},"161":{"start":{"line":409,"column":4},"end":{"line":411,"column":5}},"162":{"start":{"line":410,"column":6},"end":{"line":410,"column":57}},"163":{"start":{"line":413,"column":4},"end":{"line":413,"column":43}},"164":{"start":{"line":426,"column":0},"end":{"line":428,"column":2}},"165":{"start":{"line":427,"column":2},"end":{"line":427,"column":26}},"166":{"start":{"line":432,"column":0},"end":{"line":432,"column":65}}},"branchMap":{"1":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":9},"end":{"line":23,"column":13}},{"start":{"line":23,"column":17},"end":{"line":23,"column":19}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":16},"end":{"line":26,"column":27}},{"start":{"line":26,"column":31},"end":{"line":26,"column":40}}]},"3":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"4":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":47,"column":2}},{"start":{"line":47,"column":2},"end":{"line":47,"column":2}}]},"5":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":4},"end":{"line":54,"column":4}},{"start":{"line":54,"column":4},"end":{"line":54,"column":4}}]},"6":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":2},"end":{"line":71,"column":2}},{"start":{"line":71,"column":2},"end":{"line":71,"column":2}}]},"7":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"8":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":2},"end":{"line":91,"column":2}},{"start":{"line":91,"column":2},"end":{"line":91,"column":2}}]},"9":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":2},"end":{"line":103,"column":2}},{"start":{"line":103,"column":2},"end":{"line":103,"column":2}}]},"10":{"line":103,"type":"binary-expr","locations":[{"start":{"line":103,"column":6},"end":{"line":103,"column":14}},{"start":{"line":103,"column":18},"end":{"line":103,"column":33}}]},"11":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":2},"end":{"line":168,"column":2}},{"start":{"line":168,"column":2},"end":{"line":168,"column":2}}]},"12":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":2},"end":{"line":173,"column":2}},{"start":{"line":173,"column":2},"end":{"line":173,"column":2}}]},"13":{"line":174,"type":"binary-expr","locations":[{"start":{"line":174,"column":4},"end":{"line":174,"column":10}},{"start":{"line":174,"column":14},"end":{"line":174,"column":112}}]},"14":{"line":247,"type":"if","locations":[{"start":{"line":247,"column":2},"end":{"line":247,"column":2}},{"start":{"line":247,"column":2},"end":{"line":247,"column":2}}]},"15":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":2},"end":{"line":252,"column":2}},{"start":{"line":252,"column":2},"end":{"line":252,"column":2}}]},"16":{"line":279,"type":"if","locations":[{"start":{"line":279,"column":2},"end":{"line":279,"column":2}},{"start":{"line":279,"column":2},"end":{"line":279,"column":2}}]},"17":{"line":283,"type":"if","locations":[{"start":{"line":283,"column":2},"end":{"line":283,"column":2}},{"start":{"line":283,"column":2},"end":{"line":283,"column":2}}]},"18":{"line":299,"type":"if","locations":[{"start":{"line":299,"column":2},"end":{"line":299,"column":2}},{"start":{"line":299,"column":2},"end":{"line":299,"column":2}}]},"19":{"line":303,"type":"if","locations":[{"start":{"line":303,"column":6},"end":{"line":303,"column":6}},{"start":{"line":303,"column":6},"end":{"line":303,"column":6}}]},"20":{"line":323,"type":"if","locations":[{"start":{"line":323,"column":2},"end":{"line":323,"column":2}},{"start":{"line":323,"column":2},"end":{"line":323,"column":2}}]},"21":{"line":325,"type":"switch","locations":[{"start":{"line":326,"column":6},"end":{"line":328,"column":14}},{"start":{"line":329,"column":6},"end":{"line":331,"column":14}},{"start":{"line":332,"column":6},"end":{"line":334,"column":14}},{"start":{"line":335,"column":6},"end":{"line":337,"column":14}},{"start":{"line":338,"column":6},"end":{"line":340,"column":14}}]},"22":{"line":347,"type":"if","locations":[{"start":{"line":347,"column":4},"end":{"line":347,"column":4}},{"start":{"line":347,"column":4},"end":{"line":347,"column":4}}]},"23":{"line":350,"type":"if","locations":[{"start":{"line":350,"column":11},"end":{"line":350,"column":11}},{"start":{"line":350,"column":11},"end":{"line":350,"column":11}}]},"24":{"line":374,"type":"if","locations":[{"start":{"line":374,"column":2},"end":{"line":374,"column":2}},{"start":{"line":374,"column":2},"end":{"line":374,"column":2}}]},"25":{"line":378,"type":"if","locations":[{"start":{"line":378,"column":2},"end":{"line":378,"column":2}},{"start":{"line":378,"column":2},"end":{"line":378,"column":2}}]},"26":{"line":380,"type":"if","locations":[{"start":{"line":380,"column":4},"end":{"line":380,"column":4}},{"start":{"line":380,"column":4},"end":{"line":380,"column":4}}]},"27":{"line":407,"type":"binary-expr","locations":[{"start":{"line":407,"column":23},"end":{"line":407,"column":41}},{"start":{"line":407,"column":45},"end":{"line":407,"column":47}}]},"28":{"line":408,"type":"if","locations":[{"start":{"line":408,"column":2},"end":{"line":408,"column":2}},{"start":{"line":408,"column":2},"end":{"line":408,"column":2}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-rpc', 'rpc-client');","var failureProcess = require('./failureProcess');","var constants = require('../util/constants');","var Station = require('./mailstation');","var Tracer = require('../util/tracer');","var Loader = require('pomelo-loader');","var utils = require('../util/utils');","var Proxy = require('../util/proxy');","var router = require('./router');","var async = require('async');","","/**"," * Client states"," */","var STATE_INITED = 1; // client has inited","var STATE_STARTED = 2; // client has started","var STATE_CLOSED = 3; // client has closed","","/**"," * RPC Client Class"," */","var Client = function(opts) {","  opts = opts || {};","  this._context = opts.context;","  this._routeContext = opts.routeContext;","  this.router = opts.router || router.df;","  this.routerType = opts.routerType;","  this.rpcDebugLog = opts.rpcDebugLog;","  if (this._context) {","    opts.clientId = this._context.serverId;","  }","  this.opts = opts;","  this.proxies = {};","  this._station = createStation(opts);","  this.state = STATE_INITED;","};","","var pro = Client.prototype;","","/**"," * Start the rpc client which would try to connect the remote servers and"," * report the result by cb."," *"," * @param cb {Function} cb(err)"," */","pro.start = function(cb) {","  if (this.state > STATE_INITED) {","    cb(new Error('rpc client has started.'));","    return;","  }","","  var self = this;","  this._station.start(function(err) {","    if (err) {","      logger.error('[pomelo-rpc] client start fail for ' + err.stack);","      return cb(err);","    }","    self._station.on('error', failureProcess.bind(self._station));","    self.state = STATE_STARTED;","    cb();","  });","};","","/**"," * Stop the rpc client."," *"," * @param  {Boolean} force"," * @return {Void}"," */","pro.stop = function(force) {","  if (this.state !== STATE_STARTED) {","    logger.warn('[pomelo-rpc] client is not running now.');","    return;","  }","  this.state = STATE_CLOSED;","  this._station.stop(force);","};","","/**"," * Add a new proxy to the rpc client which would overrid the proxy under the"," * same key."," *"," * @param {Object} record proxy description record, format:"," *                        {namespace, serverType, path}"," */","pro.addProxy = function(record) {","  if (!record) {","    return;","  }","  var proxy = generateProxy(this, record, this._context);","  if (!proxy) {","    return;","  }","  insertProxy(this.proxies, record.namespace, record.serverType, proxy);","};","","/**"," * Batch version for addProxy."," *"," * @param {Array} records list of proxy description record"," */","pro.addProxies = function(records) {","  if (!records || !records.length) {","    return;","  }","  for (var i = 0, l = records.length; i < l; i++) {","    this.addProxy(records[i]);","  }","};","","/**"," * Add new remote server to the rpc client."," *"," * @param {Object} server new server information"," */","pro.addServer = function(server) {","  this._station.addServer(server);","};","","/**"," * Batch version for add new remote server."," *"," * @param {Array} servers server info list"," */","pro.addServers = function(servers) {","  this._station.addServers(servers);","};","","/**"," * Remove remote server from the rpc client."," *"," * @param  {String|Number} id server id"," */","pro.removeServer = function(id) {","  this._station.removeServer(id);","};","","/**"," * Batch version for remove remote server."," *"," * @param  {Array} ids remote server id list"," */","pro.removeServers = function(ids) {","  this._station.removeServers(ids);","};","","/**"," * Replace remote servers."," *"," * @param {Array} servers server info list"," */","pro.replaceServers = function(servers) {","  this._station.replaceServers(servers);","};","","/**"," * Do the rpc invoke directly."," *"," * @param serverId {String} remote server id"," * @param msg {Object} rpc message. Message format:"," *    {serverType: serverType, service: serviceName, method: methodName, args: arguments}"," * @param cb {Function} cb(err, ...)"," */","pro.rpcInvoke = function(serverId, msg, cb) {","  var rpcDebugLog = this.rpcDebugLog;","  var tracer = null;","","  if (rpcDebugLog) {","    tracer = new Tracer(this.opts.rpcLogger, this.opts.rpcDebugLog, this.opts.clientId, serverId, msg);","    tracer.info('client', __filename, 'rpcInvoke', 'the entrance of rpc invoke');","  }","","  if (this.state !== STATE_STARTED) {","    tracer && tracer.error('client', __filename, 'rpcInvoke', 'fail to do rpc invoke for client is not running');","    logger.error('[pomelo-rpc] fail to do rpc invoke for client is not running');","    cb(new Error('[pomelo-rpc] fail to do rpc invoke for client is not running'));","    return;","  }","  this._station.dispatch(tracer, serverId, msg, this.opts, cb);","};","","/**"," * Add rpc before filter."," * "," * @param filter {Function} rpc before filter function."," *"," * @api public"," */","pro.before = function(filter) {","  this._station.before(filter);","};","","/**"," * Add rpc after filter."," * "," * @param filter {Function} rpc after filter function."," *"," * @api public"," */","pro.after = function(filter) {","  this._station.after(filter);","};","","/**"," * Add rpc filter."," * "," * @param filter {Function} rpc filter function."," *"," * @api public"," */","pro.filter = function(filter) {","  this._station.filter(filter);","};","","/**"," * Set rpc filter error handler."," * "," * @param handler {Function} rpc filter error handler function."," *"," * @api public"," */","pro.setErrorHandler = function(handler) {","  this._station.handleError = handler;","};","","/**"," * Create mail station."," *"," * @param opts {Object} construct parameters."," *"," * @api private"," */","var createStation = function(opts) {","  return Station.create(opts);","};","","/**"," * Generate proxies for remote servers."," *"," * @param client {Object} current client instance."," * @param record {Object} proxy reocrd info. {namespace, serverType, path}"," * @param context {Object} mailbox init context parameter"," *"," * @api private"," */","var generateProxy = function(client, record, context) {","  if (!record) {","    return;","  }","  var res, name;","  var modules = Loader.load(record.path, context);","  if (modules) {","    res = {};","    for (name in modules) {","      res[name] = Proxy.create({","        service: name,","        origin: modules[name],","        attach: record,","        proxyCB: proxyCB.bind(null, client)","      });","    }","  }","  return res;","};","","/**"," * Generate prxoy for function type field"," *"," * @param client {Object} current client instance."," * @param serviceName {String} delegated service name."," * @param methodName {String} delegated method name."," * @param args {Object} rpc invoke arguments."," * @param attach {Object} attach parameter pass to proxyCB."," * @param isToSpecifiedServer {boolean} true means rpc route to specified remote server."," *"," * @api private"," */","var proxyCB = function(client, serviceName, methodName, args, attach, isToSpecifiedServer) {","  if (client.state !== STATE_STARTED) {","    logger.error('[pomelo-rpc] fail to invoke rpc proxy for client is not running');","    return;","  }","  if (args.length < 2) {","    logger.error('[pomelo-rpc] invalid rpc invoke, arguments length less than 2, namespace: %j, serverType, %j, serviceName: %j, methodName: %j',","      attach.namespace, attach.serverType, serviceName, methodName);","    return;","  }","  var routeParam = args.shift();","  var cb = args.pop();","  var serverType = attach.serverType;","  var msg = {","    namespace: attach.namespace,","    serverType: serverType,","    service: serviceName,","    method: methodName,","    args: args","  };","","  if (isToSpecifiedServer) {","    rpcToSpecifiedServer(client, msg, serverType, routeParam, cb);","  } else {","    getRouteTarget(client, serverType, msg, routeParam, function(err, serverId) {","      if (err) {","        return cb(err);","      }","","      client.rpcInvoke(serverId, msg, cb);","    });","  }","};","","/**"," * Calculate remote target server id for rpc client."," *"," * @param client {Object} current client instance."," * @param serverType {String} remote server type."," * @param routeParam {Object} mailbox init context parameter."," * @param cb {Function} return rpc remote target server id."," *"," * @api private"," */","var getRouteTarget = function(client, serverType, msg, routeParam, cb) {","  if (!!client.routerType) {","    var method;","    switch (client.routerType) {","      case constants.SCHEDULE.ROUNDROBIN:","        method = router.rr;","        break;","      case constants.SCHEDULE.WEIGHT_ROUNDROBIN:","        method = router.wrr;","        break;","      case constants.SCHEDULE.LEAST_ACTIVE:","        method = router.la;","        break;","      case constants.SCHEDULE.CONSISTENT_HASH:","        method = router.ch;","        break;","      default:","        method = router.rd;","        break;","    }","    method.call(null, client, serverType, msg, function(err, serverId) {","      cb(err, serverId);","    });","  } else {","    var route, target;","    if (typeof client.router === 'function') {","      route = client.router;","      target = null;","    } else if (typeof client.router.route === 'function') {","      route = client.router.route;","      target = client.router;","    } else {","      logger.error('[pomelo-rpc] invalid route function.');","      return;","    }","    route.call(target, routeParam, msg, client._routeContext, function(err, serverId) {","      cb(err, serverId);","    });","  }","};","","/**"," * Rpc to specified server id or servers."," *"," * @param client     {Object} current client instance."," * @param msg        {Object} rpc message."," * @param serverType {String} remote server type."," * @param serverId   {Object} mailbox init context parameter."," *"," * @api private"," */","var rpcToSpecifiedServer = function(client, msg, serverType, serverId, cb) {","  if (typeof serverId !== 'string') {","    logger.error('[pomelo-rpc] serverId is not a string : %s', serverId);","    return;","  }","  if (serverId === '*') {","    var servers = client._routeContext.getServersByType(serverType);","    if (!servers) {","      logger.error('[pomelo-rpc] serverType %s servers not exist', serverType);","      return;","    }","","    async.each(servers, function(server, next) {","      var serverId = server['id'];","      client.rpcInvoke(serverId, msg, function(err) {","        next(err);","      });","    }, cb);","  } else {","    client.rpcInvoke(serverId, msg, cb);","  }","};","","/**"," * Add proxy into array."," * "," * @param proxies {Object} rpc proxies"," * @param namespace {String} rpc namespace sys/user"," * @param serverType {String} rpc remote server type"," * @param proxy {Object} rpc proxy"," *"," * @api private"," */","var insertProxy = function(proxies, namespace, serverType, proxy) {","  proxies[namespace] = proxies[namespace] || {};","  if (proxies[namespace][serverType]) {","    for (var attr in proxy) {","      proxies[namespace][serverType][attr] = proxy[attr];","    }","  } else {","    proxies[namespace][serverType] = proxy;","  }","};","","/**"," * RPC client factory method."," *"," * @param  {Object}      opts client init parameter."," *                       opts.context: mail box init parameter,"," *                       opts.router: (optional) rpc message route function, route(routeParam, msg, cb),"," *                       opts.mailBoxFactory: (optional) mail box factory instance."," * @return {Object}      client instance."," */","module.exports.create = function(opts) {","  return new Client(opts);","};","","// module.exports.WSMailbox = require('./mailboxes/ws-mailbox'); // socket.io ","// module.exports.WS2Mailbox = require('./mailboxes/ws2-mailbox'); // ws","module.exports.MQTTMailbox = require('./mailboxes/mqtt-mailbox'); // mqtt"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"15":1,"16":1,"17":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"32":0,"33":0,"34":0,"35":0,"38":1,"46":1,"47":0,"48":0,"49":0,"52":0,"53":0,"54":0,"55":0,"56":0,"58":0,"59":0,"60":0,"70":1,"71":0,"72":0,"73":0,"75":0,"76":0,"86":1,"87":0,"88":0,"90":0,"91":0,"92":0,"94":0,"102":1,"103":0,"104":0,"106":0,"107":0,"116":1,"117":0,"125":1,"126":0,"134":1,"135":0,"143":1,"144":0,"152":1,"153":0,"164":1,"165":0,"166":0,"168":0,"169":0,"170":0,"173":0,"174":0,"175":0,"176":0,"177":0,"179":0,"189":1,"190":0,"200":1,"201":0,"211":1,"212":0,"222":1,"223":0,"233":1,"234":0,"246":1,"247":0,"248":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"263":0,"278":1,"279":0,"280":0,"281":0,"283":0,"284":0,"286":0,"288":0,"289":0,"290":0,"291":0,"299":0,"300":0,"302":0,"303":0,"304":0,"307":0,"322":1,"323":0,"324":0,"325":0,"327":0,"328":0,"330":0,"331":0,"333":0,"334":0,"336":0,"337":0,"339":0,"340":0,"342":0,"343":0,"346":0,"347":0,"348":0,"349":0,"350":0,"351":0,"352":0,"354":0,"355":0,"357":0,"358":0,"373":1,"374":0,"375":0,"376":0,"378":0,"379":0,"380":0,"381":0,"382":0,"385":0,"386":0,"387":0,"388":0,"392":0,"406":1,"407":0,"408":0,"409":0,"410":0,"413":0,"426":1,"427":0,"432":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/failureProcess.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/failureProcess.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":1,"57":1,"58":0,"59":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0,0,0,0,0],"14":[0,0],"15":[0,0],"16":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":17},"end":{"line":5,"column":61}}},"2":{"name":"(anonymous_2)","line":48,"loc":{"start":{"line":48,"column":15},"end":{"line":48,"column":63}}},"3":{"name":"(anonymous_3)","line":86,"loc":{"start":{"line":86,"column":15},"end":{"line":86,"column":63}}},"4":{"name":"(anonymous_4)","line":103,"loc":{"start":{"line":103,"column":15},"end":{"line":103,"column":26}}},"5":{"name":"(anonymous_5)","line":113,"loc":{"start":{"line":113,"column":15},"end":{"line":113,"column":26}}},"6":{"name":"(anonymous_6)","line":140,"loc":{"start":{"line":140,"column":15},"end":{"line":140,"column":63}}},"7":{"name":"(anonymous_7)","line":156,"loc":{"start":{"line":156,"column":15},"end":{"line":156,"column":63}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":77}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":5,"column":0},"end":{"line":34,"column":2}},"5":{"start":{"line":6,"column":1},"end":{"line":6,"column":30}},"6":{"start":{"line":7,"column":1},"end":{"line":7,"column":26}},"7":{"start":{"line":8,"column":1},"end":{"line":8,"column":37}},"8":{"start":{"line":9,"column":1},"end":{"line":9,"column":23}},"9":{"start":{"line":11,"column":1},"end":{"line":17,"column":2}},"10":{"start":{"line":12,"column":2},"end":{"line":12,"column":20}},"11":{"start":{"line":13,"column":8},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":2},"end":{"line":14,"column":20}},"13":{"start":{"line":15,"column":8},"end":{"line":17,"column":2}},"14":{"start":{"line":33,"column":1},"end":{"line":33,"column":58}},"15":{"start":{"line":48,"column":0},"end":{"line":72,"column":2}},"16":{"start":{"line":49,"column":1},"end":{"line":49,"column":13}},"17":{"start":{"line":50,"column":1},"end":{"line":50,"column":17}},"18":{"start":{"line":51,"column":1},"end":{"line":51,"column":17}},"19":{"start":{"line":52,"column":1},"end":{"line":52,"column":20}},"20":{"start":{"line":53,"column":1},"end":{"line":53,"column":33}},"21":{"start":{"line":54,"column":1},"end":{"line":58,"column":2}},"22":{"start":{"line":55,"column":2},"end":{"line":55,"column":40}},"23":{"start":{"line":57,"column":2},"end":{"line":57,"column":27}},"24":{"start":{"line":60,"column":1},"end":{"line":60,"column":39}},"25":{"start":{"line":61,"column":1},"end":{"line":63,"column":2}},"26":{"start":{"line":62,"column":2},"end":{"line":62,"column":27}},"27":{"start":{"line":64,"column":1},"end":{"line":64,"column":38}},"28":{"start":{"line":66,"column":1},"end":{"line":70,"column":2}},"29":{"start":{"line":67,"column":2},"end":{"line":67,"column":105}},"30":{"start":{"line":68,"column":2},"end":{"line":68,"column":92}},"31":{"start":{"line":69,"column":2},"end":{"line":69,"column":9}},"32":{"start":{"line":71,"column":1},"end":{"line":71,"column":61}},"33":{"start":{"line":86,"column":0},"end":{"line":126,"column":2}},"34":{"start":{"line":87,"column":1},"end":{"line":87,"column":17}},"35":{"start":{"line":88,"column":1},"end":{"line":88,"column":78}},"36":{"start":{"line":89,"column":1},"end":{"line":89,"column":95}},"37":{"start":{"line":91,"column":1},"end":{"line":95,"column":2}},"38":{"start":{"line":92,"column":2},"end":{"line":92,"column":24}},"39":{"start":{"line":94,"column":2},"end":{"line":94,"column":25}},"40":{"start":{"line":96,"column":1},"end":{"line":125,"column":2}},"41":{"start":{"line":99,"column":3},"end":{"line":99,"column":76}},"42":{"start":{"line":100,"column":3},"end":{"line":100,"column":9}},"43":{"start":{"line":102,"column":3},"end":{"line":108,"column":4}},"44":{"start":{"line":103,"column":4},"end":{"line":105,"column":45}},"45":{"start":{"line":104,"column":5},"end":{"line":104,"column":40}},"46":{"start":{"line":107,"column":4},"end":{"line":107,"column":80}},"47":{"start":{"line":109,"column":3},"end":{"line":109,"column":9}},"48":{"start":{"line":112,"column":3},"end":{"line":118,"column":4}},"49":{"start":{"line":113,"column":4},"end":{"line":115,"column":45}},"50":{"start":{"line":114,"column":5},"end":{"line":114,"column":63}},"51":{"start":{"line":117,"column":4},"end":{"line":117,"column":85}},"52":{"start":{"line":119,"column":3},"end":{"line":119,"column":9}},"53":{"start":{"line":121,"column":3},"end":{"line":121,"column":56}},"54":{"start":{"line":122,"column":3},"end":{"line":122,"column":9}},"55":{"start":{"line":124,"column":3},"end":{"line":124,"column":46}},"56":{"start":{"line":140,"column":0},"end":{"line":142,"column":2}},"57":{"start":{"line":156,"column":0},"end":{"line":159,"column":2}},"58":{"start":{"line":157,"column":1},"end":{"line":157,"column":104}},"59":{"start":{"line":158,"column":1},"end":{"line":158,"column":60}}},"branchMap":{"1":{"line":6,"type":"binary-expr","locations":[{"start":{"line":6,"column":10},"end":{"line":6,"column":16}},{"start":{"line":6,"column":20},"end":{"line":6,"column":29}}]},"2":{"line":11,"type":"if","locations":[{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},{"start":{"line":11,"column":1},"end":{"line":11,"column":1}}]},"3":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":8},"end":{"line":13,"column":8}},{"start":{"line":13,"column":8},"end":{"line":13,"column":8}}]},"4":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":8}},{"start":{"line":15,"column":8},"end":{"line":15,"column":8}}]},"5":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},{"start":{"line":54,"column":1},"end":{"line":54,"column":1}}]},"6":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":5},"end":{"line":54,"column":12}},{"start":{"line":54,"column":16},"end":{"line":54,"column":31}}]},"7":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},{"start":{"line":61,"column":1},"end":{"line":61,"column":1}}]},"8":{"line":64,"type":"binary-expr","locations":[{"start":{"line":64,"column":1},"end":{"line":64,"column":7}},{"start":{"line":64,"column":12},"end":{"line":64,"column":36}}]},"9":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},{"start":{"line":66,"column":1},"end":{"line":66,"column":1}}]},"10":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":18},"end":{"line":88,"column":33}},{"start":{"line":88,"column":37},"end":{"line":88,"column":77}}]},"11":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":24},"end":{"line":89,"column":45}},{"start":{"line":89,"column":49},"end":{"line":89,"column":94}}]},"12":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},{"start":{"line":91,"column":1},"end":{"line":91,"column":1}}]},"13":{"line":96,"type":"switch","locations":[{"start":{"line":97,"column":2},"end":{"line":97,"column":46}},{"start":{"line":98,"column":2},"end":{"line":100,"column":9}},{"start":{"line":101,"column":2},"end":{"line":109,"column":9}},{"start":{"line":110,"column":2},"end":{"line":110,"column":45}},{"start":{"line":111,"column":2},"end":{"line":119,"column":9}},{"start":{"line":120,"column":2},"end":{"line":122,"column":9}},{"start":{"line":123,"column":2},"end":{"line":124,"column":46}}]},"14":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":3},"end":{"line":102,"column":3}},{"start":{"line":102,"column":3},"end":{"line":102,"column":3}}]},"15":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":3},"end":{"line":112,"column":3}},{"start":{"line":112,"column":3},"end":{"line":112,"column":3}}]},"16":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":1},"end":{"line":158,"column":3}},{"start":{"line":158,"column":7},"end":{"line":158,"column":59}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-rpc', 'failprocess');","var constants = require('../util/constants');","var utils = require('../util/utils');","","module.exports = function(code, tracer, serverId, msg, opts) {","\tvar cb = tracer && tracer.cb;","\tvar mode = opts.failMode;","\tvar FAIL_MODE = constants.FAIL_MODE;","\tvar method = failfast;","","\tif (mode == FAIL_MODE.FAILOVER) {","\t\tmethod = failover;","\t} else if (mode == FAIL_MODE.FAILBACK) {","\t\tmethod = failback;","\t} else if (mode == FAIL_MODE.FAILFAST) {","","\t}","\t// switch (mode) {","\t// \tcase constants.FAIL_MODE.FAILOVER:","\t// \t\tmethod = failover;","\t// \t\tbreak;","\t// \tcase constants.FAIL_MODE.FAILBACK:","\t// \t\tmethod = failback;","\t// \t\tbreak;","\t// \tcase constants.FAIL_MODE.FAILFAST:","\t// \t\tmethod = failfast;","\t// \t\tbreak;","\t// \tcase constants.FAIL_MODE.FAILSAFE:","\t// \tdefault:","\t// \t\tmethod = failfast;","\t// \t\tbreak;","\t// }","\tmethod.call(this, code, tracer, serverId, msg, opts, cb);","};","","/**"," * Failover rpc failure process. This will try other servers with option retries."," *"," * @param code {Number} error code number."," * @param tracer {Object} current rpc tracer."," * @param serverId {String} rpc remote target server id."," * @param msg {Object} rpc message."," * @param opts {Object} rpc client options."," * @param cb {Function} user rpc callback."," *"," * @api private"," */","var failover = function(code, tracer, serverId, msg, opts, cb) {","\tvar servers;","\tvar self = this;","\tvar counter = 0;","\tvar success = true;","\tvar serverType = msg.serverType;","\tif (!tracer || !tracer.servers) {","\t\tservers = self.serversMap[serverType];","\t} else {","\t\tservers = tracer.servers;","\t}","","\tvar index = servers.indexOf(serverId);","\tif (index >= 0) {","\t\tservers.splice(index, 1);","\t}","\ttracer && (tracer.servers = servers);","","\tif (!servers.length) {","\t\tlogger.error('[pomelo-rpc] rpc failed with all this type of servers, with serverType: %s', serverType);","\t\tcb(new Error('rpc failed with all this type of servers, with serverType: ' + serverType));","\t\treturn;","\t}","\tself.dispatch.call(self, tracer, servers[0], msg, opts, cb);","};","","/**"," * Failsafe rpc failure process."," *"," * @param code {Number} error code number."," * @param tracer {Object} current rpc tracer."," * @param serverId {String} rpc remote target server id."," * @param msg {Object} rpc message."," * @param opts {Object} rpc client options."," * @param cb {Function} user rpc callback."," *"," * @api private"," */","var failsafe = function(code, tracer, serverId, msg, opts, cb) {","\tvar self = this;","\tvar retryTimes = opts.retryTimes || constants.DEFAULT_PARAM.FAILSAFE_RETRIES;","\tvar retryConnectTime = opts.retryConnectTime || constants.DEFAULT_PARAM.FAILSAFE_CONNECT_TIME;","","\tif (!tracer.retryTimes) {","\t\ttracer.retryTimes = 1;","\t} else {","\t\ttracer.retryTimes += 1;","\t}","\tswitch (code) {","\t\tcase constants.RPC_ERROR.SERVER_NOT_STARTED:","\t\tcase constants.RPC_ERROR.NO_TRAGET_SERVER:","\t\t\tcb(new Error('rpc client is not started or cannot find remote server.'));","\t\t\tbreak;","\t\tcase constants.RPC_ERROR.FAIL_CONNECT_SERVER:","\t\t\tif (tracer.retryTimes <= retryTimes) {","\t\t\t\tsetTimeout(function() {","\t\t\t\t\tself.connect(tracer, serverId, cb);","\t\t\t\t}, retryConnectTime * tracer.retryTimes);","\t\t\t} else {","\t\t\t\tcb(new Error('rpc client failed to connect to remote server: ' + serverId));","\t\t\t}","\t\t\tbreak;","\t\tcase constants.RPC_ERROR.FAIL_FIND_MAILBOX:","\t\tcase constants.RPC_ERROR.FAIL_SEND_MESSAGE:","\t\t\tif (tracer.retryTimes <= retryTimes) {","\t\t\t\tsetTimeout(function() {","\t\t\t\t\tself.dispatch.call(self, tracer, serverId, msg, opts, cb);","\t\t\t\t}, retryConnectTime * tracer.retryTimes);","\t\t\t} else {","\t\t\t\tcb(new Error('rpc client failed to send message to remote server: ' + serverId));","\t\t\t}","\t\t\tbreak;","\t\tcase constants.RPC_ERROR.FILTER_ERROR:","\t\t\tcb(new Error('rpc client filter encounters error.'));","\t\t\tbreak;","\t\tdefault:","\t\t\tcb(new Error('rpc client unknown error.'));","\t}","};","","/**"," * Failback rpc failure process. This will try the same server with sendInterval option and retries option."," *"," * @param code {Number} error code number."," * @param tracer {Object} current rpc tracer."," * @param serverId {String} rpc remote target server id."," * @param msg {Object} rpc message."," * @param opts {Object} rpc client options."," * @param cb {Function} user rpc callback."," *"," * @api private"," */","var failback = function(code, tracer, serverId, msg, opts, cb) {","\t// todo record message in background and send the message at timing","};","","/**"," * Failfast rpc failure process. This will ignore error in rpc client."," *"," * @param code {Number} error code number."," * @param tracer {Object} current rpc tracer."," * @param serverId {String} rpc remote target server id."," * @param msg {Object} rpc message."," * @param opts {Object} rpc client options."," * @param cb {Function} user rpc callback."," *"," * @api private"," */","var failfast = function(code, tracer, serverId, msg, opts, cb) {","\tlogger.error('rpc failed with error, remote server: %s, msg: %j, error code: %s', serverId, msg, code);","\tcb && cb(new Error('rpc failed with error code: ' + code));","};"],"l":{"1":1,"2":1,"3":1,"5":1,"6":0,"7":0,"8":0,"9":0,"11":0,"12":0,"13":0,"14":0,"15":0,"33":0,"48":1,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"57":0,"60":0,"61":0,"62":0,"64":0,"66":0,"67":0,"68":0,"69":0,"71":0,"86":1,"87":0,"88":0,"89":0,"91":0,"92":0,"94":0,"96":0,"99":0,"100":0,"102":0,"103":0,"104":0,"107":0,"109":0,"112":0,"113":0,"114":0,"117":0,"119":0,"121":0,"122":0,"124":0,"140":1,"156":1,"157":0,"158":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/constants.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/constants.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":33,"column":2}}},"branchMap":{},"code":["module.exports = {","\tFAIL_MODE: {","\t\tFAILOVER: 'failover',","\t\tFAILFAST: 'failfast',","\t\tFAILSAFE: 'failsafe',","\t\tFAILBACK: 'failback'","\t},","\tSCHEDULE: {","\t\tROUNDROBIN: 'rr',","\t\tWEIGHT_ROUNDROBIN: 'wrr',","\t\tLEAST_ACTIVE: 'la',","\t\tCONSISTENT_HASH: 'ch'","\t},","\tDEFAULT_PARAM: {","\t\tFAILSAFE_RETRIES: 3,","\t\tFAILSAFE_CONNECT_TIME: 5 * 1000,","\t\tCALLBACK_TIMEOUT: 30 * 1000,","\t\tINTERVAL: 50,","\t\tGRACE_TIMEOUT: 3 * 1000,","\t\tDEFAULT_PENDING_SIZE: 10000,","\t\tKEEPALIVE: 10 * 1000","\t},","\tRPC_ERROR: {","\t\tSERVER_NOT_STARTED: 1,","\t\tNO_TRAGET_SERVER: 2,","\t\tFAIL_CONNECT_SERVER: 3,","\t\tFAIL_FIND_MAILBOX: 4,","\t\tFAIL_SEND_MESSAGE: 5,","\t\tFILTER_ERROR: 6","\t},","\tTOPIC_RPC: 'r',","\tTOPIC_HANDSHAKE: 'h'","};"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/utils.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/utils.js","s":{"1":1,"2":1,"3":0,"4":0,"5":1,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":1,"28":5,"29":0,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":0,"38":1,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":1,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":1,"72":1,"73":1,"74":10,"75":1,"76":1,"77":1,"78":0,"79":1,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[1,0],"12":[0,0,0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":5,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":23},"end":{"line":3,"column":36}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":22},"end":{"line":9,"column":41}}},"3":{"name":"(anonymous_3)","line":15,"loc":{"start":{"line":15,"column":23},"end":{"line":15,"column":37}}},"4":{"name":"(anonymous_4)","line":53,"loc":{"start":{"line":53,"column":19},"end":{"line":53,"column":31}}},"5":{"name":"(anonymous_5)","line":65,"loc":{"start":{"line":65,"column":15},"end":{"line":65,"column":30}}},"6":{"name":"(anonymous_6)","line":66,"loc":{"start":{"line":66,"column":8},"end":{"line":66,"column":22}}},"7":{"name":"(anonymous_7)","line":131,"loc":{"start":{"line":131,"column":18},"end":{"line":131,"column":32}}},"8":{"name":"(anonymous_8)","line":137,"loc":{"start":{"line":137,"column":18},"end":{"line":137,"column":32}}},"9":{"name":"(anonymous_9)","line":148,"loc":{"start":{"line":148,"column":17},"end":{"line":148,"column":32}}},"10":{"name":"(anonymous_10)","line":166,"loc":{"start":{"line":166,"column":18},"end":{"line":166,"column":34}}},"11":{"name":"(anonymous_11)","line":172,"loc":{"start":{"line":172,"column":16},"end":{"line":172,"column":33}}},"12":{"name":"(anonymous_12)","line":224,"loc":{"start":{"line":224,"column":19},"end":{"line":224,"column":30}}},"13":{"name":"(anonymous_13)","line":228,"loc":{"start":{"line":228,"column":23},"end":{"line":228,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":15}},"2":{"start":{"line":3,"column":0},"end":{"line":7,"column":2}},"3":{"start":{"line":4,"column":1},"end":{"line":6,"column":2}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":59}},"5":{"start":{"line":9,"column":0},"end":{"line":13,"column":2}},"6":{"start":{"line":10,"column":1},"end":{"line":12,"column":2}},"7":{"start":{"line":11,"column":2},"end":{"line":11,"column":23}},"8":{"start":{"line":15,"column":0},"end":{"line":44,"column":2}},"9":{"start":{"line":16,"column":1},"end":{"line":18,"column":2}},"10":{"start":{"line":17,"column":2},"end":{"line":17,"column":9}},"11":{"start":{"line":20,"column":1},"end":{"line":20,"column":35}},"12":{"start":{"line":21,"column":1},"end":{"line":23,"column":2}},"13":{"start":{"line":22,"column":2},"end":{"line":22,"column":9}},"14":{"start":{"line":25,"column":1},"end":{"line":27,"column":2}},"15":{"start":{"line":26,"column":2},"end":{"line":26,"column":26}},"16":{"start":{"line":29,"column":1},"end":{"line":29,"column":34}},"17":{"start":{"line":30,"column":1},"end":{"line":32,"column":2}},"18":{"start":{"line":31,"column":2},"end":{"line":31,"column":9}},"19":{"start":{"line":34,"column":1},"end":{"line":34,"column":16}},"20":{"start":{"line":35,"column":1},"end":{"line":39,"column":2}},"21":{"start":{"line":36,"column":2},"end":{"line":36,"column":37}},"22":{"start":{"line":38,"column":2},"end":{"line":38,"column":38}},"23":{"start":{"line":41,"column":1},"end":{"line":43,"column":2}},"24":{"start":{"line":42,"column":2},"end":{"line":42,"column":16}},"25":{"start":{"line":53,"column":0},"end":{"line":56,"column":1}},"26":{"start":{"line":54,"column":1},"end":{"line":54,"column":39}},"27":{"start":{"line":65,"column":0},"end":{"line":69,"column":1}},"28":{"start":{"line":66,"column":1},"end":{"line":68,"column":2}},"29":{"start":{"line":67,"column":2},"end":{"line":67,"column":58}},"30":{"start":{"line":78,"column":0},"end":{"line":78,"column":58}},"31":{"start":{"line":87,"column":0},"end":{"line":87,"column":43}},"32":{"start":{"line":96,"column":0},"end":{"line":96,"column":47}},"33":{"start":{"line":104,"column":0},"end":{"line":104,"column":43}},"34":{"start":{"line":113,"column":0},"end":{"line":113,"column":43}},"35":{"start":{"line":122,"column":0},"end":{"line":122,"column":45}},"36":{"start":{"line":131,"column":0},"end":{"line":135,"column":1}},"37":{"start":{"line":132,"column":1},"end":{"line":134,"column":41}},"38":{"start":{"line":137,"column":0},"end":{"line":139,"column":1}},"39":{"start":{"line":138,"column":1},"end":{"line":138,"column":30}},"40":{"start":{"line":148,"column":0},"end":{"line":157,"column":1}},"41":{"start":{"line":149,"column":1},"end":{"line":149,"column":23}},"42":{"start":{"line":150,"column":1},"end":{"line":150,"column":26}},"43":{"start":{"line":152,"column":1},"end":{"line":154,"column":2}},"44":{"start":{"line":153,"column":2},"end":{"line":153,"column":19}},"45":{"start":{"line":156,"column":1},"end":{"line":156,"column":12}},"46":{"start":{"line":166,"column":0},"end":{"line":170,"column":1}},"47":{"start":{"line":167,"column":1},"end":{"line":168,"column":14}},"48":{"start":{"line":168,"column":2},"end":{"line":168,"column":14}},"49":{"start":{"line":169,"column":1},"end":{"line":169,"column":14}},"50":{"start":{"line":172,"column":0},"end":{"line":212,"column":1}},"51":{"start":{"line":173,"column":1},"end":{"line":175,"column":2}},"52":{"start":{"line":174,"column":2},"end":{"line":174,"column":31}},"53":{"start":{"line":177,"column":1},"end":{"line":179,"column":2}},"54":{"start":{"line":178,"column":2},"end":{"line":178,"column":33}},"55":{"start":{"line":181,"column":1},"end":{"line":183,"column":2}},"56":{"start":{"line":182,"column":2},"end":{"line":182,"column":32}},"57":{"start":{"line":185,"column":1},"end":{"line":187,"column":2}},"58":{"start":{"line":186,"column":2},"end":{"line":186,"column":33}},"59":{"start":{"line":189,"column":1},"end":{"line":195,"column":2}},"60":{"start":{"line":190,"column":2},"end":{"line":192,"column":3}},"61":{"start":{"line":191,"column":3},"end":{"line":191,"column":32}},"62":{"start":{"line":194,"column":2},"end":{"line":194,"column":33}},"63":{"start":{"line":197,"column":1},"end":{"line":199,"column":2}},"64":{"start":{"line":198,"column":2},"end":{"line":198,"column":34}},"65":{"start":{"line":201,"column":1},"end":{"line":211,"column":2}},"66":{"start":{"line":202,"column":2},"end":{"line":204,"column":3}},"67":{"start":{"line":203,"column":3},"end":{"line":203,"column":33}},"68":{"start":{"line":206,"column":2},"end":{"line":208,"column":3}},"69":{"start":{"line":207,"column":3},"end":{"line":207,"column":32}},"70":{"start":{"line":210,"column":2},"end":{"line":210,"column":33}},"71":{"start":{"line":214,"column":0},"end":{"line":214,"column":106}},"72":{"start":{"line":215,"column":0},"end":{"line":215,"column":17}},"73":{"start":{"line":216,"column":0},"end":{"line":218,"column":1}},"74":{"start":{"line":217,"column":1},"end":{"line":217,"column":27}},"75":{"start":{"line":220,"column":0},"end":{"line":220,"column":28}},"76":{"start":{"line":222,"column":0},"end":{"line":222,"column":24}},"77":{"start":{"line":224,"column":0},"end":{"line":226,"column":1}},"78":{"start":{"line":225,"column":1},"end":{"line":225,"column":27}},"79":{"start":{"line":228,"column":0},"end":{"line":261,"column":1}},"80":{"start":{"line":229,"column":1},"end":{"line":229,"column":15}},"81":{"start":{"line":230,"column":1},"end":{"line":230,"column":15}},"82":{"start":{"line":231,"column":1},"end":{"line":231,"column":15}},"83":{"start":{"line":232,"column":1},"end":{"line":232,"column":16}},"84":{"start":{"line":233,"column":1},"end":{"line":233,"column":16}},"85":{"start":{"line":234,"column":1},"end":{"line":234,"column":16}},"86":{"start":{"line":236,"column":1},"end":{"line":236,"column":16}},"87":{"start":{"line":237,"column":1},"end":{"line":237,"column":16}},"88":{"start":{"line":238,"column":1},"end":{"line":238,"column":16}},"89":{"start":{"line":240,"column":1},"end":{"line":258,"column":2}},"90":{"start":{"line":241,"column":2},"end":{"line":241,"column":24}},"91":{"start":{"line":242,"column":2},"end":{"line":242,"column":29}},"92":{"start":{"line":243,"column":2},"end":{"line":243,"column":30}},"93":{"start":{"line":245,"column":2},"end":{"line":257,"column":3}},"94":{"start":{"line":246,"column":3},"end":{"line":246,"column":23}},"95":{"start":{"line":247,"column":3},"end":{"line":247,"column":28}},"96":{"start":{"line":248,"column":3},"end":{"line":248,"column":22}},"97":{"start":{"line":250,"column":3},"end":{"line":256,"column":4}},"98":{"start":{"line":251,"column":4},"end":{"line":251,"column":25}},"99":{"start":{"line":252,"column":4},"end":{"line":255,"column":5}},"100":{"start":{"line":253,"column":5},"end":{"line":253,"column":24}},"101":{"start":{"line":254,"column":5},"end":{"line":254,"column":29}},"102":{"start":{"line":260,"column":1},"end":{"line":260,"column":48}},"103":{"start":{"line":263,"column":0},"end":{"line":263,"column":23}}},"branchMap":{"1":{"line":4,"type":"if","locations":[{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},{"start":{"line":4,"column":1},"end":{"line":4,"column":1}}]},"2":{"line":10,"type":"if","locations":[{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},{"start":{"line":10,"column":1},"end":{"line":10,"column":1}}]},"3":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},{"start":{"line":16,"column":1},"end":{"line":16,"column":1}}]},"4":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},{"start":{"line":21,"column":1},"end":{"line":21,"column":1}}]},"5":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},{"start":{"line":25,"column":1},"end":{"line":25,"column":1}}]},"6":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},{"start":{"line":30,"column":1},"end":{"line":30,"column":1}}]},"7":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},{"start":{"line":35,"column":1},"end":{"line":35,"column":1}}]},"8":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},{"start":{"line":41,"column":1},"end":{"line":41,"column":1}}]},"9":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":5},"end":{"line":41,"column":8}},{"start":{"line":41,"column":12},"end":{"line":41,"column":27}}]},"10":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":8},"end":{"line":54,"column":23}},{"start":{"line":54,"column":27},"end":{"line":54,"column":38}}]},"11":{"line":78,"type":"binary-expr","locations":[{"start":{"line":78,"column":19},"end":{"line":78,"column":32}},{"start":{"line":78,"column":36},"end":{"line":78,"column":57}}]},"12":{"line":132,"type":"binary-expr","locations":[{"start":{"line":132,"column":8},"end":{"line":132,"column":11}},{"start":{"line":132,"column":15},"end":{"line":132,"column":25}},{"start":{"line":133,"column":2},"end":{"line":133,"column":41}},{"start":{"line":134,"column":2},"end":{"line":134,"column":40}}]},"13":{"line":167,"type":"if","locations":[{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},{"start":{"line":167,"column":1},"end":{"line":167,"column":1}}]},"14":{"line":167,"type":"binary-expr","locations":[{"start":{"line":167,"column":5},"end":{"line":167,"column":19}},{"start":{"line":167,"column":23},"end":{"line":167,"column":51}}]},"15":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},{"start":{"line":173,"column":1},"end":{"line":173,"column":1}}]},"16":{"line":173,"type":"binary-expr","locations":[{"start":{"line":173,"column":5},"end":{"line":173,"column":19}},{"start":{"line":173,"column":23},"end":{"line":173,"column":52}}]},"17":{"line":177,"type":"if","locations":[{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},{"start":{"line":177,"column":1},"end":{"line":177,"column":1}}]},"18":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},{"start":{"line":181,"column":1},"end":{"line":181,"column":1}}]},"19":{"line":185,"type":"if","locations":[{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},{"start":{"line":185,"column":1},"end":{"line":185,"column":1}}]},"20":{"line":189,"type":"if","locations":[{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},{"start":{"line":189,"column":1},"end":{"line":189,"column":1}}]},"21":{"line":190,"type":"if","locations":[{"start":{"line":190,"column":2},"end":{"line":190,"column":2}},{"start":{"line":190,"column":2},"end":{"line":190,"column":2}}]},"22":{"line":197,"type":"if","locations":[{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},{"start":{"line":197,"column":1},"end":{"line":197,"column":1}}]},"23":{"line":201,"type":"if","locations":[{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},{"start":{"line":201,"column":1},"end":{"line":201,"column":1}}]},"24":{"line":202,"type":"if","locations":[{"start":{"line":202,"column":2},"end":{"line":202,"column":2}},{"start":{"line":202,"column":2},"end":{"line":202,"column":2}}]},"25":{"line":206,"type":"if","locations":[{"start":{"line":206,"column":2},"end":{"line":206,"column":2}},{"start":{"line":206,"column":2},"end":{"line":206,"column":2}}]},"26":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":4},"end":{"line":252,"column":4}},{"start":{"line":252,"column":4},"end":{"line":252,"column":4}}]}},"code":["var Utils = {};","","Utils.invokeCallback = function(cb) {","\tif (typeof cb === 'function') {","\t\tcb.apply(null, Array.prototype.slice.call(arguments, 1));","\t}","};","","Utils.applyCallback = function(cb, args) {","\tif (typeof cb === 'function') {","\t\tcb.apply(null, args);","\t}","};","","Utils.getObjectClass = function(obj) {","\tif (!obj) {","\t\treturn;","\t}","","\tvar constructor = obj.constructor;","\tif (!constructor) {","\t\treturn;","\t}","","\tif (constructor.name) {","\t\treturn constructor.name;","\t}","","\tvar str = constructor.toString();","\tif (!str) {","\t\treturn;","\t}","","\tvar arr = null;","\tif (str.charAt(0) == '[') {","\t\tarr = str.match(/\\[\\w+\\s*(\\w+)\\]/);","\t} else {","\t\tarr = str.match(/function\\s*(\\w+)/);","\t}","","\tif (arr && arr.length == 2) {","\t\treturn arr[1];","\t}","};","","/**"," * Utils check float"," *"," * @param  {Float}   float"," * @return {Boolean} true|false"," * @api public"," */","Utils.checkFloat = function(v) {","\treturn v === Number(v) && v % 1 !== 0;","\t// return parseInt(v) !== v;","}","","/**"," * Utils check type"," *"," * @param  {String}   type"," * @return {Function} high order function"," * @api public"," */","Utils.isType = function(type) {","\treturn function(obj) {","\t\treturn {}.toString.call(obj) == \"[object \" + type + \"]\";","\t}","}","","/**"," * Utils check array"," *"," * @param  {Array}   array"," * @return {Boolean} true|false"," * @api public"," */","Utils.checkArray = Array.isArray || Utils.isType(\"Array\");","","/**"," * Utils check number"," *"," * @param  {Number}  number"," * @return {Boolean} true|false"," * @api public"," */","Utils.checkNumber = Utils.isType(\"Number\");","","/**"," * Utils check function"," *"," * @param  {Function}   func function"," * @return {Boolean}    true|false"," * @api public"," */","Utils.checkFunction = Utils.isType(\"Function\");","/**"," * Utils check object"," *"," * @param  {Object}   obj object"," * @return {Boolean}  true|false"," * @api public"," */","Utils.checkObject = Utils.isType(\"Object\");","","/**"," * Utils check string"," *"," * @param  {String}   string"," * @return {Boolean}  true|false"," * @api public"," */","Utils.checkString = Utils.isType(\"String\");","","/**"," * Utils check boolean"," *"," * @param  {Object}   obj object"," * @return {Boolean}  true|false"," * @api public"," */","Utils.checkBoolean = Utils.isType(\"Boolean\");","","/**"," * Utils check bean"," *"," * @param  {Object}   obj object"," * @return {Boolean}  true|false"," * @api public"," */","Utils.checkBean = function(obj) {","\treturn obj && obj['$id'] &&","\t\tUtils.checkFunction(obj['writeFields']) &&","\t\tUtils.checkFunction(obj['readFields']);","}","","Utils.checkNull = function(obj) {","\treturn !Utils.isNotNull(obj);","}","","/**"," * Utils args to array"," *"," * @param  {Object}  args arguments"," * @return {Array}   array"," * @api public"," */","Utils.to_array = function(args) {","\tvar len = args.length;","\tvar arr = new Array(len);","","\tfor (var i = 0; i < len; i++) {","\t\tarr[i] = args[i];","\t}","","\treturn arr;","}","","/**"," * Utils check is not null"," *"," * @param  {Object}   value"," * @return {Boolean}  true|false"," * @api public"," */","Utils.isNotNull = function(value) {","\tif (value !== null && typeof value !== 'undefined')","\t\treturn true;","\treturn false;","}","","Utils.getType = function(object) {","\tif (object == null || typeof object === 'undefined') {","\t\treturn Utils.typeMap['null'];","\t}","","\tif (Buffer.isBuffer(object)) {","\t\treturn Utils.typeMap['buffer'];","\t}","","\tif (Utils.checkArray(object)) {","\t\treturn Utils.typeMap['array'];","\t}","","\tif (Utils.checkString(object)) {","\t\treturn Utils.typeMap['string'];","\t}","","\tif (Utils.checkObject(object)) {","\t\tif (Utils.checkBean(object)) {","\t\t\treturn Utils.typeMap['bean'];","\t\t}","","\t\treturn Utils.typeMap['object'];","\t}","","\tif (Utils.checkBoolean(object)) {","\t\treturn Utils.typeMap['boolean'];","\t}","","\tif (Utils.checkNumber(object)) {","\t\tif (Utils.checkFloat(object)) {","\t\t\treturn Utils.typeMap['float'];","\t\t}","","\t\tif (isNaN(object)) {","\t\t\treturn Utils.typeMap['null'];","\t\t}","","\t\treturn Utils.typeMap['number'];","\t}","}","","var typeArray = ['', 'null', 'buffer', 'array', 'string', 'object', 'bean', 'boolean', 'float', 'number'];","var typeMap = {};","for (var i = 1; i <= typeArray.length; i++) {","\ttypeMap[typeArray[i]] = i;","}","","Utils.typeArray = typeArray;","","Utils.typeMap = typeMap;","","Utils.getBearcat = function() {","\treturn require('bearcat');","}","","Utils.genServicesMap = function(services) {","\tvar nMap = {}; // namespace","\tvar sMap = {}; // service","\tvar mMap = {}; // method","\tvar nList = [];","\tvar sList = [];","\tvar mList = [];","","\tvar nIndex = 0;","\tvar sIndex = 0;","\tvar mIndex = 0;","","\tfor (var namespace in services) {","\t\tnList.push(namespace);","\t\tnMap[namespace] = nIndex++;","\t\tvar s = services[namespace];","","\t\tfor (var service in s) {","\t\t\tsList.push(service);","\t\t\tsMap[service] = sIndex++;","\t\t\tvar m = s[service];","","\t\t\tfor (var method in m) {","\t\t\t\tvar func = m[method];","\t\t\t\tif (Utils.checkFunction(func)) {","\t\t\t\t\tmList.push(method);","\t\t\t\t\tmMap[method] = mIndex++;","\t\t\t\t}","\t\t\t}","\t\t}","\t}","","\treturn [nMap, sMap, mMap, nList, sList, mList];","}","","module.exports = Utils;"],"l":{"1":1,"3":1,"4":0,"5":0,"9":1,"10":0,"11":0,"15":1,"16":0,"17":0,"20":0,"21":0,"22":0,"25":0,"26":0,"29":0,"30":0,"31":0,"34":0,"35":0,"36":0,"38":0,"41":0,"42":0,"53":1,"54":0,"65":1,"66":5,"67":0,"78":1,"87":1,"96":1,"104":1,"113":1,"122":1,"131":1,"132":0,"137":1,"138":0,"148":1,"149":0,"150":0,"152":0,"153":0,"156":0,"166":1,"167":0,"168":0,"169":0,"172":1,"173":0,"174":0,"177":0,"178":0,"181":0,"182":0,"185":0,"186":0,"189":0,"190":0,"191":0,"194":0,"197":0,"198":0,"201":0,"202":0,"203":0,"206":0,"207":0,"210":0,"214":1,"215":1,"216":1,"217":10,"220":1,"222":1,"224":1,"225":0,"228":1,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"236":0,"237":0,"238":0,"240":0,"241":0,"242":0,"243":0,"245":0,"246":0,"247":0,"248":0,"250":0,"251":0,"252":0,"253":0,"254":0,"260":0,"263":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/mailstation.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/mailstation.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":1,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":0,"62":0,"63":0,"64":1,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":1,"72":0,"73":0,"74":0,"75":0,"76":1,"77":0,"78":0,"79":1,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":1,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":1,"136":0,"137":0,"138":0,"139":0,"140":1,"141":0,"142":0,"143":0,"144":0,"145":1,"146":0,"147":0,"148":1,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":1,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":1,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":1,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":1,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":1,"229":0,"230":0,"231":0,"232":0,"233":1,"234":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},"fnMap":{"1":{"name":"(anonymous_1)","line":18,"loc":{"start":{"line":18,"column":18},"end":{"line":18,"column":33}}},"2":{"name":"(anonymous_2)","line":53,"loc":{"start":{"line":53,"column":12},"end":{"line":53,"column":25}}},"3":{"name":"(anonymous_3)","line":60,"loc":{"start":{"line":60,"column":19},"end":{"line":60,"column":30}}},"4":{"name":"(anonymous_4)","line":72,"loc":{"start":{"line":72,"column":11},"end":{"line":72,"column":27}}},"5":{"name":"closeAll","line":81,"loc":{"start":{"line":81,"column":2},"end":{"line":81,"column":22}}},"6":{"name":"(anonymous_6)","line":99,"loc":{"start":{"line":99,"column":16},"end":{"line":99,"column":37}}},"7":{"name":"(anonymous_7)","line":124,"loc":{"start":{"line":124,"column":17},"end":{"line":124,"column":39}}},"8":{"name":"(anonymous_8)","line":140,"loc":{"start":{"line":140,"column":19},"end":{"line":140,"column":32}}},"9":{"name":"(anonymous_9)","line":155,"loc":{"start":{"line":155,"column":20},"end":{"line":155,"column":34}}},"10":{"name":"(anonymous_10)","line":169,"loc":{"start":{"line":169,"column":19},"end":{"line":169,"column":30}}},"11":{"name":"(anonymous_11)","line":179,"loc":{"start":{"line":179,"column":21},"end":{"line":179,"column":43}}},"12":{"name":"(anonymous_12)","line":209,"loc":{"start":{"line":209,"column":15},"end":{"line":209,"column":57}}},"13":{"name":"(anonymous_13)","line":241,"loc":{"start":{"line":241,"column":13},"end":{"line":241,"column":56}}},"14":{"name":"(anonymous_14)","line":253,"loc":{"start":{"line":253,"column":36},"end":{"line":253,"column":74}}},"15":{"name":"(anonymous_15)","line":264,"loc":{"start":{"line":264,"column":80},"end":{"line":264,"column":123}}},"16":{"name":"(anonymous_16)","line":282,"loc":{"start":{"line":282,"column":13},"end":{"line":282,"column":30}}},"17":{"name":"(anonymous_17)","line":296,"loc":{"start":{"line":296,"column":12},"end":{"line":296,"column":29}}},"18":{"name":"(anonymous_18)","line":310,"loc":{"start":{"line":310,"column":13},"end":{"line":310,"column":30}}},"19":{"name":"(anonymous_19)","line":322,"loc":{"start":{"line":322,"column":14},"end":{"line":322,"column":45}}},"20":{"name":"(anonymous_20)","line":325,"loc":{"start":{"line":325,"column":26},"end":{"line":325,"column":40}}},"21":{"name":"(anonymous_21)","line":335,"loc":{"start":{"line":335,"column":24},"end":{"line":335,"column":37}}},"22":{"name":"(anonymous_22)","line":351,"loc":{"start":{"line":351,"column":15},"end":{"line":351,"column":87}}},"23":{"name":"(anonymous_23)","line":362,"loc":{"start":{"line":362,"column":32},"end":{"line":362,"column":67}}},"24":{"name":"(anonymous_24)","line":374,"loc":{"start":{"line":374,"column":41},"end":{"line":374,"column":76}}},"25":{"name":"(anonymous_25)","line":388,"loc":{"start":{"line":388,"column":18},"end":{"line":388,"column":67}}},"26":{"name":"(anonymous_26)","line":407,"loc":{"start":{"line":407,"column":19},"end":{"line":407,"column":61}}},"27":{"name":"(anonymous_27)","line":421,"loc":{"start":{"line":421,"column":19},"end":{"line":421,"column":59}}},"28":{"name":"(anonymous_28)","line":438,"loc":{"start":{"line":438,"column":19},"end":{"line":438,"column":81}}},"29":{"name":"(anonymous_29)","line":455,"loc":{"start":{"line":455,"column":24},"end":{"line":455,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":77}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":49}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":49}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":45}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":37}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":21}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":22}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":21}},"11":{"start":{"line":18,"column":0},"end":{"line":41,"column":2}},"12":{"start":{"line":19,"column":2},"end":{"line":19,"column":26}},"13":{"start":{"line":20,"column":2},"end":{"line":20,"column":19}},"14":{"start":{"line":21,"column":2},"end":{"line":21,"column":20}},"15":{"start":{"line":22,"column":2},"end":{"line":22,"column":23}},"16":{"start":{"line":23,"column":2},"end":{"line":23,"column":20}},"17":{"start":{"line":24,"column":2},"end":{"line":24,"column":69}},"18":{"start":{"line":27,"column":2},"end":{"line":27,"column":20}},"19":{"start":{"line":28,"column":2},"end":{"line":28,"column":19}},"20":{"start":{"line":31,"column":2},"end":{"line":31,"column":21}},"21":{"start":{"line":32,"column":2},"end":{"line":32,"column":86}},"22":{"start":{"line":35,"column":2},"end":{"line":35,"column":23}},"23":{"start":{"line":38,"column":2},"end":{"line":38,"column":22}},"24":{"start":{"line":40,"column":2},"end":{"line":40,"column":28}},"25":{"start":{"line":43,"column":0},"end":{"line":43,"column":41}},"26":{"start":{"line":45,"column":0},"end":{"line":45,"column":32}},"27":{"start":{"line":53,"column":0},"end":{"line":64,"column":2}},"28":{"start":{"line":54,"column":2},"end":{"line":57,"column":3}},"29":{"start":{"line":55,"column":4},"end":{"line":55,"column":42}},"30":{"start":{"line":56,"column":4},"end":{"line":56,"column":11}},"31":{"start":{"line":59,"column":2},"end":{"line":59,"column":18}},"32":{"start":{"line":60,"column":2},"end":{"line":63,"column":5}},"33":{"start":{"line":61,"column":4},"end":{"line":61,"column":31}},"34":{"start":{"line":62,"column":4},"end":{"line":62,"column":9}},"35":{"start":{"line":72,"column":0},"end":{"line":91,"column":2}},"36":{"start":{"line":73,"column":2},"end":{"line":76,"column":3}},"37":{"start":{"line":74,"column":4},"end":{"line":74,"column":59}},"38":{"start":{"line":75,"column":4},"end":{"line":75,"column":11}},"39":{"start":{"line":77,"column":2},"end":{"line":77,"column":28}},"40":{"start":{"line":79,"column":2},"end":{"line":79,"column":18}},"41":{"start":{"line":81,"column":2},"end":{"line":85,"column":3}},"42":{"start":{"line":82,"column":4},"end":{"line":84,"column":5}},"43":{"start":{"line":83,"column":6},"end":{"line":83,"column":33}},"44":{"start":{"line":86,"column":2},"end":{"line":90,"column":3}},"45":{"start":{"line":87,"column":4},"end":{"line":87,"column":15}},"46":{"start":{"line":89,"column":4},"end":{"line":89,"column":64}},"47":{"start":{"line":99,"column":0},"end":{"line":117,"column":2}},"48":{"start":{"line":100,"column":2},"end":{"line":102,"column":3}},"49":{"start":{"line":101,"column":4},"end":{"line":101,"column":11}},"50":{"start":{"line":104,"column":2},"end":{"line":104,"column":25}},"51":{"start":{"line":105,"column":2},"end":{"line":105,"column":35}},"52":{"start":{"line":106,"column":2},"end":{"line":106,"column":32}},"53":{"start":{"line":107,"column":2},"end":{"line":107,"column":23}},"54":{"start":{"line":109,"column":2},"end":{"line":111,"column":3}},"55":{"start":{"line":110,"column":4},"end":{"line":110,"column":31}},"56":{"start":{"line":113,"column":2},"end":{"line":115,"column":3}},"57":{"start":{"line":114,"column":4},"end":{"line":114,"column":35}},"58":{"start":{"line":116,"column":2},"end":{"line":116,"column":29}},"59":{"start":{"line":124,"column":0},"end":{"line":132,"column":2}},"60":{"start":{"line":125,"column":2},"end":{"line":127,"column":3}},"61":{"start":{"line":126,"column":4},"end":{"line":126,"column":11}},"62":{"start":{"line":129,"column":2},"end":{"line":131,"column":3}},"63":{"start":{"line":130,"column":4},"end":{"line":130,"column":35}},"64":{"start":{"line":140,"column":0},"end":{"line":148,"column":2}},"65":{"start":{"line":141,"column":2},"end":{"line":141,"column":23}},"66":{"start":{"line":142,"column":2},"end":{"line":142,"column":35}},"67":{"start":{"line":143,"column":2},"end":{"line":146,"column":3}},"68":{"start":{"line":144,"column":4},"end":{"line":144,"column":20}},"69":{"start":{"line":145,"column":4},"end":{"line":145,"column":30}},"70":{"start":{"line":147,"column":2},"end":{"line":147,"column":32}},"71":{"start":{"line":155,"column":0},"end":{"line":163,"column":2}},"72":{"start":{"line":156,"column":2},"end":{"line":158,"column":3}},"73":{"start":{"line":157,"column":4},"end":{"line":157,"column":11}},"74":{"start":{"line":160,"column":2},"end":{"line":162,"column":3}},"75":{"start":{"line":161,"column":4},"end":{"line":161,"column":30}},"76":{"start":{"line":169,"column":0},"end":{"line":172,"column":1}},"77":{"start":{"line":170,"column":2},"end":{"line":170,"column":20}},"78":{"start":{"line":171,"column":2},"end":{"line":171,"column":23}},"79":{"start":{"line":179,"column":0},"end":{"line":197,"column":2}},"80":{"start":{"line":180,"column":2},"end":{"line":180,"column":22}},"81":{"start":{"line":181,"column":2},"end":{"line":183,"column":3}},"82":{"start":{"line":182,"column":4},"end":{"line":182,"column":11}},"83":{"start":{"line":185,"column":2},"end":{"line":196,"column":3}},"84":{"start":{"line":186,"column":4},"end":{"line":186,"column":31}},"85":{"start":{"line":187,"column":4},"end":{"line":187,"column":41}},"86":{"start":{"line":188,"column":4},"end":{"line":188,"column":25}},"87":{"start":{"line":189,"column":4},"end":{"line":191,"column":5}},"88":{"start":{"line":190,"column":6},"end":{"line":190,"column":33}},"89":{"start":{"line":192,"column":4},"end":{"line":192,"column":38}},"90":{"start":{"line":193,"column":4},"end":{"line":195,"column":5}},"91":{"start":{"line":194,"column":6},"end":{"line":194,"column":37}},"92":{"start":{"line":209,"column":0},"end":{"line":274,"column":2}},"93":{"start":{"line":210,"column":2},"end":{"line":210,"column":97}},"94":{"start":{"line":211,"column":2},"end":{"line":211,"column":29}},"95":{"start":{"line":212,"column":2},"end":{"line":217,"column":3}},"96":{"start":{"line":213,"column":4},"end":{"line":213,"column":90}},"97":{"start":{"line":214,"column":4},"end":{"line":214,"column":60}},"98":{"start":{"line":215,"column":4},"end":{"line":215,"column":92}},"99":{"start":{"line":216,"column":4},"end":{"line":216,"column":11}},"100":{"start":{"line":219,"column":2},"end":{"line":219,"column":18}},"101":{"start":{"line":220,"column":2},"end":{"line":220,"column":41}},"102":{"start":{"line":221,"column":2},"end":{"line":232,"column":3}},"103":{"start":{"line":222,"column":4},"end":{"line":222,"column":85}},"104":{"start":{"line":224,"column":4},"end":{"line":228,"column":5}},"105":{"start":{"line":225,"column":6},"end":{"line":225,"column":105}},"106":{"start":{"line":226,"column":6},"end":{"line":226,"column":74}},"107":{"start":{"line":227,"column":6},"end":{"line":227,"column":92}},"108":{"start":{"line":230,"column":4},"end":{"line":230,"column":52}},"109":{"start":{"line":231,"column":4},"end":{"line":231,"column":11}},"110":{"start":{"line":234,"column":2},"end":{"line":239,"column":3}},"111":{"start":{"line":235,"column":4},"end":{"line":235,"column":90}},"112":{"start":{"line":237,"column":4},"end":{"line":237,"column":52}},"113":{"start":{"line":238,"column":4},"end":{"line":238,"column":11}},"114":{"start":{"line":241,"column":2},"end":{"line":271,"column":4}},"115":{"start":{"line":242,"column":4},"end":{"line":242,"column":109}},"116":{"start":{"line":243,"column":4},"end":{"line":243,"column":43}},"117":{"start":{"line":244,"column":4},"end":{"line":246,"column":5}},"118":{"start":{"line":245,"column":6},"end":{"line":245,"column":76}},"119":{"start":{"line":247,"column":4},"end":{"line":252,"column":5}},"120":{"start":{"line":248,"column":6},"end":{"line":248,"column":103}},"121":{"start":{"line":249,"column":6},"end":{"line":249,"column":78}},"122":{"start":{"line":250,"column":6},"end":{"line":250,"column":93}},"123":{"start":{"line":251,"column":6},"end":{"line":251,"column":13}},"124":{"start":{"line":253,"column":4},"end":{"line":270,"column":7}},"125":{"start":{"line":256,"column":6},"end":{"line":262,"column":7}},"126":{"start":{"line":257,"column":8},"end":{"line":257,"column":97}},"127":{"start":{"line":258,"column":8},"end":{"line":258,"column":95}},"128":{"start":{"line":259,"column":8},"end":{"line":259,"column":27}},"129":{"start":{"line":261,"column":8},"end":{"line":261,"column":15}},"130":{"start":{"line":264,"column":6},"end":{"line":269,"column":9}},"131":{"start":{"line":265,"column":8},"end":{"line":267,"column":9}},"132":{"start":{"line":266,"column":10},"end":{"line":266,"column":74}},"133":{"start":{"line":268,"column":8},"end":{"line":268,"column":38}},"134":{"start":{"line":273,"column":2},"end":{"line":273,"column":79}},"135":{"start":{"line":282,"column":0},"end":{"line":288,"column":2}},"136":{"start":{"line":283,"column":2},"end":{"line":286,"column":3}},"137":{"start":{"line":284,"column":4},"end":{"line":284,"column":47}},"138":{"start":{"line":285,"column":4},"end":{"line":285,"column":11}},"139":{"start":{"line":287,"column":2},"end":{"line":287,"column":28}},"140":{"start":{"line":296,"column":0},"end":{"line":302,"column":2}},"141":{"start":{"line":297,"column":2},"end":{"line":300,"column":3}},"142":{"start":{"line":298,"column":4},"end":{"line":298,"column":45}},"143":{"start":{"line":299,"column":4},"end":{"line":299,"column":11}},"144":{"start":{"line":301,"column":2},"end":{"line":301,"column":27}},"145":{"start":{"line":310,"column":0},"end":{"line":313,"column":2}},"146":{"start":{"line":311,"column":2},"end":{"line":311,"column":28}},"147":{"start":{"line":312,"column":2},"end":{"line":312,"column":27}},"148":{"start":{"line":322,"column":0},"end":{"line":346,"column":2}},"149":{"start":{"line":323,"column":2},"end":{"line":323,"column":18}},"150":{"start":{"line":324,"column":2},"end":{"line":324,"column":41}},"151":{"start":{"line":325,"column":2},"end":{"line":345,"column":5}},"152":{"start":{"line":326,"column":4},"end":{"line":334,"column":5}},"153":{"start":{"line":327,"column":6},"end":{"line":327,"column":115}},"154":{"start":{"line":328,"column":6},"end":{"line":328,"column":89}},"155":{"start":{"line":329,"column":6},"end":{"line":331,"column":7}},"156":{"start":{"line":330,"column":8},"end":{"line":330,"column":40}},"157":{"start":{"line":332,"column":6},"end":{"line":332,"column":101}},"158":{"start":{"line":333,"column":6},"end":{"line":333,"column":13}},"159":{"start":{"line":335,"column":4},"end":{"line":342,"column":7}},"160":{"start":{"line":336,"column":6},"end":{"line":336,"column":36}},"161":{"start":{"line":337,"column":6},"end":{"line":340,"column":7}},"162":{"start":{"line":338,"column":8},"end":{"line":338,"column":21}},"163":{"start":{"line":339,"column":8},"end":{"line":339,"column":34}},"164":{"start":{"line":341,"column":6},"end":{"line":341,"column":29}},"165":{"start":{"line":343,"column":4},"end":{"line":343,"column":37}},"166":{"start":{"line":344,"column":4},"end":{"line":344,"column":41}},"167":{"start":{"line":351,"column":0},"end":{"line":386,"column":2}},"168":{"start":{"line":352,"column":2},"end":{"line":354,"column":3}},"169":{"start":{"line":353,"column":4},"end":{"line":353,"column":112}},"170":{"start":{"line":355,"column":2},"end":{"line":358,"column":3}},"171":{"start":{"line":356,"column":4},"end":{"line":356,"column":41}},"172":{"start":{"line":357,"column":4},"end":{"line":357,"column":11}},"173":{"start":{"line":359,"column":2},"end":{"line":359,"column":18}},"174":{"start":{"line":360,"column":2},"end":{"line":360,"column":30}},"175":{"start":{"line":361,"column":2},"end":{"line":372,"column":3}},"176":{"start":{"line":362,"column":4},"end":{"line":370,"column":7}},"177":{"start":{"line":363,"column":6},"end":{"line":363,"column":14}},"178":{"start":{"line":365,"column":6},"end":{"line":369,"column":7}},"179":{"start":{"line":366,"column":8},"end":{"line":366,"column":83}},"180":{"start":{"line":368,"column":8},"end":{"line":368,"column":113}},"181":{"start":{"line":371,"column":4},"end":{"line":371,"column":11}},"182":{"start":{"line":373,"column":2},"end":{"line":383,"column":3}},"183":{"start":{"line":374,"column":4},"end":{"line":381,"column":7}},"184":{"start":{"line":375,"column":6},"end":{"line":375,"column":14}},"185":{"start":{"line":376,"column":6},"end":{"line":380,"column":7}},"186":{"start":{"line":377,"column":8},"end":{"line":377,"column":83}},"187":{"start":{"line":379,"column":8},"end":{"line":379,"column":113}},"188":{"start":{"line":382,"column":4},"end":{"line":382,"column":11}},"189":{"start":{"line":384,"column":2},"end":{"line":384,"column":10}},"190":{"start":{"line":385,"column":2},"end":{"line":385,"column":74}},"191":{"start":{"line":388,"column":0},"end":{"line":405,"column":2}},"192":{"start":{"line":389,"column":2},"end":{"line":389,"column":115}},"193":{"start":{"line":390,"column":2},"end":{"line":390,"column":41}},"194":{"start":{"line":391,"column":2},"end":{"line":391,"column":41}},"195":{"start":{"line":392,"column":2},"end":{"line":395,"column":3}},"196":{"start":{"line":393,"column":4},"end":{"line":393,"column":62}},"197":{"start":{"line":394,"column":4},"end":{"line":394,"column":17}},"198":{"start":{"line":396,"column":2},"end":{"line":399,"column":3}},"199":{"start":{"line":397,"column":4},"end":{"line":397,"column":68}},"200":{"start":{"line":398,"column":4},"end":{"line":398,"column":17}},"201":{"start":{"line":400,"column":2},"end":{"line":400,"column":53}},"202":{"start":{"line":401,"column":2},"end":{"line":401,"column":38}},"203":{"start":{"line":402,"column":2},"end":{"line":402,"column":40}},"204":{"start":{"line":403,"column":2},"end":{"line":403,"column":40}},"205":{"start":{"line":404,"column":2},"end":{"line":404,"column":14}},"206":{"start":{"line":407,"column":0},"end":{"line":419,"column":2}},"207":{"start":{"line":408,"column":2},"end":{"line":408,"column":103}},"208":{"start":{"line":409,"column":2},"end":{"line":409,"column":43}},"209":{"start":{"line":410,"column":2},"end":{"line":412,"column":3}},"210":{"start":{"line":411,"column":4},"end":{"line":411,"column":46}},"211":{"start":{"line":413,"column":2},"end":{"line":417,"column":3}},"212":{"start":{"line":414,"column":4},"end":{"line":414,"column":110}},"213":{"start":{"line":415,"column":4},"end":{"line":415,"column":75}},"214":{"start":{"line":416,"column":4},"end":{"line":416,"column":11}},"215":{"start":{"line":418,"column":2},"end":{"line":418,"column":21}},"216":{"start":{"line":421,"column":0},"end":{"line":436,"column":2}},"217":{"start":{"line":422,"column":2},"end":{"line":422,"column":107}},"218":{"start":{"line":423,"column":2},"end":{"line":423,"column":43}},"219":{"start":{"line":424,"column":2},"end":{"line":424,"column":44}},"220":{"start":{"line":425,"column":2},"end":{"line":427,"column":3}},"221":{"start":{"line":426,"column":4},"end":{"line":426,"column":11}},"222":{"start":{"line":428,"column":2},"end":{"line":431,"column":3}},"223":{"start":{"line":429,"column":4},"end":{"line":429,"column":130}},"224":{"start":{"line":430,"column":4},"end":{"line":430,"column":95}},"225":{"start":{"line":432,"column":2},"end":{"line":434,"column":3}},"226":{"start":{"line":433,"column":4},"end":{"line":433,"column":48}},"227":{"start":{"line":435,"column":2},"end":{"line":435,"column":36}},"228":{"start":{"line":438,"column":0},"end":{"line":445,"column":2}},"229":{"start":{"line":439,"column":2},"end":{"line":444,"column":3}},"230":{"start":{"line":440,"column":4},"end":{"line":440,"column":50}},"231":{"start":{"line":442,"column":4},"end":{"line":442,"column":98}},"232":{"start":{"line":443,"column":4},"end":{"line":443,"column":89}},"233":{"start":{"line":455,"column":0},"end":{"line":457,"column":2}},"234":{"start":{"line":456,"column":2},"end":{"line":456,"column":37}}},"branchMap":{"1":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":24},"end":{"line":24,"column":43}},{"start":{"line":24,"column":47},"end":{"line":24,"column":68}}]},"2":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":21},"end":{"line":32,"column":37}},{"start":{"line":32,"column":41},"end":{"line":32,"column":85}}]},"3":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":2},"end":{"line":54,"column":2}},{"start":{"line":54,"column":2},"end":{"line":54,"column":2}}]},"4":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":2},"end":{"line":73,"column":2}},{"start":{"line":73,"column":2},"end":{"line":73,"column":2}}]},"5":{"line":86,"type":"if","locations":[{"start":{"line":86,"column":2},"end":{"line":86,"column":2}},{"start":{"line":86,"column":2},"end":{"line":86,"column":2}}]},"6":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":2},"end":{"line":100,"column":2}},{"start":{"line":100,"column":2},"end":{"line":100,"column":2}}]},"7":{"line":100,"type":"binary-expr","locations":[{"start":{"line":100,"column":6},"end":{"line":100,"column":17}},{"start":{"line":100,"column":21},"end":{"line":100,"column":35}}]},"8":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":2},"end":{"line":109,"column":2}},{"start":{"line":109,"column":2},"end":{"line":109,"column":2}}]},"9":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":2},"end":{"line":113,"column":2}},{"start":{"line":113,"column":2},"end":{"line":113,"column":2}}]},"10":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":2},"end":{"line":125,"column":2}},{"start":{"line":125,"column":2},"end":{"line":125,"column":2}}]},"11":{"line":125,"type":"binary-expr","locations":[{"start":{"line":125,"column":6},"end":{"line":125,"column":18}},{"start":{"line":125,"column":22},"end":{"line":125,"column":41}}]},"12":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":2},"end":{"line":143,"column":2}},{"start":{"line":143,"column":2},"end":{"line":143,"column":2}}]},"13":{"line":156,"type":"if","locations":[{"start":{"line":156,"column":2},"end":{"line":156,"column":2}},{"start":{"line":156,"column":2},"end":{"line":156,"column":2}}]},"14":{"line":156,"type":"binary-expr","locations":[{"start":{"line":156,"column":6},"end":{"line":156,"column":10}},{"start":{"line":156,"column":14},"end":{"line":156,"column":25}}]},"15":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":2},"end":{"line":181,"column":2}},{"start":{"line":181,"column":2},"end":{"line":181,"column":2}}]},"16":{"line":181,"type":"binary-expr","locations":[{"start":{"line":181,"column":6},"end":{"line":181,"column":18}},{"start":{"line":181,"column":22},"end":{"line":181,"column":41}}]},"17":{"line":189,"type":"if","locations":[{"start":{"line":189,"column":4},"end":{"line":189,"column":4}},{"start":{"line":189,"column":4},"end":{"line":189,"column":4}}]},"18":{"line":193,"type":"if","locations":[{"start":{"line":193,"column":4},"end":{"line":193,"column":4}},{"start":{"line":193,"column":4},"end":{"line":193,"column":4}}]},"19":{"line":210,"type":"binary-expr","locations":[{"start":{"line":210,"column":2},"end":{"line":210,"column":8}},{"start":{"line":210,"column":12},"end":{"line":210,"column":96}}]},"20":{"line":211,"type":"binary-expr","locations":[{"start":{"line":211,"column":2},"end":{"line":211,"column":8}},{"start":{"line":211,"column":13},"end":{"line":211,"column":27}}]},"21":{"line":212,"type":"if","locations":[{"start":{"line":212,"column":2},"end":{"line":212,"column":2}},{"start":{"line":212,"column":2},"end":{"line":212,"column":2}}]},"22":{"line":213,"type":"binary-expr","locations":[{"start":{"line":213,"column":4},"end":{"line":213,"column":10}},{"start":{"line":213,"column":14},"end":{"line":213,"column":89}}]},"23":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":2},"end":{"line":221,"column":2}},{"start":{"line":221,"column":2},"end":{"line":221,"column":2}}]},"24":{"line":222,"type":"binary-expr","locations":[{"start":{"line":222,"column":4},"end":{"line":222,"column":10}},{"start":{"line":222,"column":14},"end":{"line":222,"column":84}}]},"25":{"line":224,"type":"if","locations":[{"start":{"line":224,"column":4},"end":{"line":224,"column":4}},{"start":{"line":224,"column":4},"end":{"line":224,"column":4}}]},"26":{"line":225,"type":"binary-expr","locations":[{"start":{"line":225,"column":6},"end":{"line":225,"column":12}},{"start":{"line":225,"column":16},"end":{"line":225,"column":104}}]},"27":{"line":234,"type":"if","locations":[{"start":{"line":234,"column":2},"end":{"line":234,"column":2}},{"start":{"line":234,"column":2},"end":{"line":234,"column":2}}]},"28":{"line":235,"type":"binary-expr","locations":[{"start":{"line":235,"column":4},"end":{"line":235,"column":10}},{"start":{"line":235,"column":14},"end":{"line":235,"column":89}}]},"29":{"line":242,"type":"binary-expr","locations":[{"start":{"line":242,"column":4},"end":{"line":242,"column":10}},{"start":{"line":242,"column":14},"end":{"line":242,"column":108}}]},"30":{"line":244,"type":"if","locations":[{"start":{"line":244,"column":4},"end":{"line":244,"column":4}},{"start":{"line":244,"column":4},"end":{"line":244,"column":4}}]},"31":{"line":247,"type":"if","locations":[{"start":{"line":247,"column":4},"end":{"line":247,"column":4}},{"start":{"line":247,"column":4},"end":{"line":247,"column":4}}]},"32":{"line":248,"type":"binary-expr","locations":[{"start":{"line":248,"column":6},"end":{"line":248,"column":12}},{"start":{"line":248,"column":16},"end":{"line":248,"column":102}}]},"33":{"line":256,"type":"if","locations":[{"start":{"line":256,"column":6},"end":{"line":256,"column":6}},{"start":{"line":256,"column":6},"end":{"line":256,"column":6}}]},"34":{"line":257,"type":"binary-expr","locations":[{"start":{"line":257,"column":61},"end":{"line":257,"column":75}},{"start":{"line":257,"column":79},"end":{"line":257,"column":95}}]},"35":{"line":259,"type":"binary-expr","locations":[{"start":{"line":259,"column":8},"end":{"line":259,"column":10}},{"start":{"line":259,"column":14},"end":{"line":259,"column":26}}]},"36":{"line":265,"type":"if","locations":[{"start":{"line":265,"column":8},"end":{"line":265,"column":8}},{"start":{"line":265,"column":8},"end":{"line":265,"column":8}}]},"37":{"line":283,"type":"if","locations":[{"start":{"line":283,"column":2},"end":{"line":283,"column":2}},{"start":{"line":283,"column":2},"end":{"line":283,"column":2}}]},"38":{"line":297,"type":"if","locations":[{"start":{"line":297,"column":2},"end":{"line":297,"column":2}},{"start":{"line":297,"column":2},"end":{"line":297,"column":2}}]},"39":{"line":326,"type":"if","locations":[{"start":{"line":326,"column":4},"end":{"line":326,"column":4}},{"start":{"line":326,"column":4},"end":{"line":326,"column":4}}]},"40":{"line":327,"type":"binary-expr","locations":[{"start":{"line":327,"column":6},"end":{"line":327,"column":12}},{"start":{"line":327,"column":16},"end":{"line":327,"column":114}}]},"41":{"line":329,"type":"if","locations":[{"start":{"line":329,"column":6},"end":{"line":329,"column":6}},{"start":{"line":329,"column":6},"end":{"line":329,"column":6}}]},"42":{"line":337,"type":"if","locations":[{"start":{"line":337,"column":6},"end":{"line":337,"column":6}},{"start":{"line":337,"column":6},"end":{"line":337,"column":6}}]},"43":{"line":352,"type":"if","locations":[{"start":{"line":352,"column":2},"end":{"line":352,"column":2}},{"start":{"line":352,"column":2},"end":{"line":352,"column":2}}]},"44":{"line":353,"type":"binary-expr","locations":[{"start":{"line":353,"column":4},"end":{"line":353,"column":10}},{"start":{"line":353,"column":14},"end":{"line":353,"column":111}}]},"45":{"line":355,"type":"if","locations":[{"start":{"line":355,"column":2},"end":{"line":355,"column":2}},{"start":{"line":355,"column":2},"end":{"line":355,"column":2}}]},"46":{"line":355,"type":"binary-expr","locations":[{"start":{"line":355,"column":6},"end":{"line":355,"column":29}},{"start":{"line":355,"column":33},"end":{"line":355,"column":38}}]},"47":{"line":361,"type":"if","locations":[{"start":{"line":361,"column":2},"end":{"line":361,"column":2}},{"start":{"line":361,"column":2},"end":{"line":361,"column":2}}]},"48":{"line":365,"type":"if","locations":[{"start":{"line":365,"column":6},"end":{"line":365,"column":6}},{"start":{"line":365,"column":6},"end":{"line":365,"column":6}}]},"49":{"line":368,"type":"binary-expr","locations":[{"start":{"line":368,"column":31},"end":{"line":368,"column":37}},{"start":{"line":368,"column":41},"end":{"line":368,"column":49}}]},"50":{"line":368,"type":"binary-expr","locations":[{"start":{"line":368,"column":51},"end":{"line":368,"column":58}},{"start":{"line":368,"column":62},"end":{"line":368,"column":65}}]},"51":{"line":368,"type":"binary-expr","locations":[{"start":{"line":368,"column":67},"end":{"line":368,"column":74}},{"start":{"line":368,"column":78},"end":{"line":368,"column":82}}]},"52":{"line":373,"type":"if","locations":[{"start":{"line":373,"column":2},"end":{"line":373,"column":2}},{"start":{"line":373,"column":2},"end":{"line":373,"column":2}}]},"53":{"line":376,"type":"if","locations":[{"start":{"line":376,"column":6},"end":{"line":376,"column":6}},{"start":{"line":376,"column":6},"end":{"line":376,"column":6}}]},"54":{"line":379,"type":"binary-expr","locations":[{"start":{"line":379,"column":31},"end":{"line":379,"column":37}},{"start":{"line":379,"column":41},"end":{"line":379,"column":49}}]},"55":{"line":379,"type":"binary-expr","locations":[{"start":{"line":379,"column":51},"end":{"line":379,"column":58}},{"start":{"line":379,"column":62},"end":{"line":379,"column":65}}]},"56":{"line":379,"type":"binary-expr","locations":[{"start":{"line":379,"column":67},"end":{"line":379,"column":74}},{"start":{"line":379,"column":78},"end":{"line":379,"column":82}}]},"57":{"line":389,"type":"binary-expr","locations":[{"start":{"line":389,"column":2},"end":{"line":389,"column":8}},{"start":{"line":389,"column":12},"end":{"line":389,"column":114}}]},"58":{"line":392,"type":"if","locations":[{"start":{"line":392,"column":2},"end":{"line":392,"column":2}},{"start":{"line":392,"column":2},"end":{"line":392,"column":2}}]},"59":{"line":396,"type":"if","locations":[{"start":{"line":396,"column":2},"end":{"line":396,"column":2}},{"start":{"line":396,"column":2},"end":{"line":396,"column":2}}]},"60":{"line":396,"type":"binary-expr","locations":[{"start":{"line":396,"column":6},"end":{"line":396,"column":13}},{"start":{"line":396,"column":17},"end":{"line":396,"column":29}}]},"61":{"line":408,"type":"binary-expr","locations":[{"start":{"line":408,"column":2},"end":{"line":408,"column":8}},{"start":{"line":408,"column":12},"end":{"line":408,"column":102}}]},"62":{"line":410,"type":"if","locations":[{"start":{"line":410,"column":2},"end":{"line":410,"column":2}},{"start":{"line":410,"column":2},"end":{"line":410,"column":2}}]},"63":{"line":413,"type":"if","locations":[{"start":{"line":413,"column":2},"end":{"line":413,"column":2}},{"start":{"line":413,"column":2},"end":{"line":413,"column":2}}]},"64":{"line":414,"type":"binary-expr","locations":[{"start":{"line":414,"column":4},"end":{"line":414,"column":10}},{"start":{"line":414,"column":14},"end":{"line":414,"column":109}}]},"65":{"line":422,"type":"binary-expr","locations":[{"start":{"line":422,"column":2},"end":{"line":422,"column":8}},{"start":{"line":422,"column":12},"end":{"line":422,"column":106}}]},"66":{"line":425,"type":"if","locations":[{"start":{"line":425,"column":2},"end":{"line":425,"column":2}},{"start":{"line":425,"column":2},"end":{"line":425,"column":2}}]},"67":{"line":425,"type":"binary-expr","locations":[{"start":{"line":425,"column":6},"end":{"line":425,"column":14}},{"start":{"line":425,"column":18},"end":{"line":425,"column":33}}]},"68":{"line":428,"type":"if","locations":[{"start":{"line":428,"column":2},"end":{"line":428,"column":2}},{"start":{"line":428,"column":2},"end":{"line":428,"column":2}}]},"69":{"line":429,"type":"binary-expr","locations":[{"start":{"line":429,"column":4},"end":{"line":429,"column":10}},{"start":{"line":429,"column":14},"end":{"line":429,"column":129}}]},"70":{"line":439,"type":"if","locations":[{"start":{"line":439,"column":2},"end":{"line":439,"column":2}},{"start":{"line":439,"column":2},"end":{"line":439,"column":2}}]},"71":{"line":456,"type":"binary-expr","locations":[{"start":{"line":456,"column":25},"end":{"line":456,"column":29}},{"start":{"line":456,"column":33},"end":{"line":456,"column":35}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-rpc', 'MailStation');","var EventEmitter = require('events').EventEmitter;","var blackhole = require('./mailboxes/blackhole');","var defaultMailboxFactory = require('./mailbox');","var constants = require('../util/constants');","var utils = require('../util/utils');","var util = require('util');","","var STATE_INITED = 1; // station has inited","var STATE_STARTED = 2; // station has started","var STATE_CLOSED = 3; // station has closed","","/**"," * Mail station constructor."," *"," * @param {Object} opts construct parameters"," */","var MailStation = function(opts) {","  EventEmitter.call(this);","  this.opts = opts;","  this.servers = {}; // remote server info map, key: server id, value: info","  this.serversMap = {}; // remote server info map, key: serverType, value: servers array","  this.onlines = {}; // remote server online map, key: server id, value: 0/offline 1/online","  this.mailboxFactory = opts.mailboxFactory || defaultMailboxFactory;","","  // filters","  this.befores = [];","  this.afters = [];","","  // pending request queues","  this.pendings = {};","  this.pendingSize = opts.pendingSize || constants.DEFAULT_PARAM.DEFAULT_PENDING_SIZE;","","  // connecting remote server mailbox map","  this.connecting = {};","","  // working mailbox map","  this.mailboxes = {};","","  this.state = STATE_INITED;","};","","util.inherits(MailStation, EventEmitter);","","var pro = MailStation.prototype;","","/**"," * Init and start station. Connect all mailbox to remote servers."," *"," * @param  {Function} cb(err) callback function"," * @return {Void}"," */","pro.start = function(cb) {","  if (this.state > STATE_INITED) {","    cb(new Error('station has started.'));","    return;","  }","","  var self = this;","  process.nextTick(function() {","    self.state = STATE_STARTED;","    cb();","  });","};","","/**"," * Stop station and all its mailboxes"," *"," * @param  {Boolean} force whether stop station forcely"," * @return {Void}"," */","pro.stop = function(force) {","  if (this.state !== STATE_STARTED) {","    logger.warn('[pomelo-rpc] client is not running now.');","    return;","  }","  this.state = STATE_CLOSED;","","  var self = this;","","  function closeAll() {","    for (var id in self.mailboxes) {","      self.mailboxes[id].close();","    }","  }","  if (force) {","    closeAll();","  } else {","    setTimeout(closeAll, constants.DEFAULT_PARAM.GRACE_TIMEOUT);","  }","};","","/**"," * Add a new server info into the mail station and clear"," * the blackhole associated with the server id if any before."," *"," * @param {Object} serverInfo server info such as {id, host, port}"," */","pro.addServer = function(serverInfo) {","  if (!serverInfo || !serverInfo.id) {","    return;","  }","","  var id = serverInfo.id;","  var type = serverInfo.serverType;","  this.servers[id] = serverInfo;","  this.onlines[id] = 1;","","  if (!this.serversMap[type]) {","    this.serversMap[type] = [];","  }","","  if (this.serversMap[type].indexOf(id) < 0) {","    this.serversMap[type].push(id);","  }","  this.emit('addServer', id);","};","","/**"," * Batch version for add new server info."," *"," * @param {Array} serverInfos server info list"," */","pro.addServers = function(serverInfos) {","  if (!serverInfos || !serverInfos.length) {","    return;","  }","","  for (var i = 0, l = serverInfos.length; i < l; i++) {","    this.addServer(serverInfos[i]);","  }","};","","/**"," * Remove a server info from the mail station and remove"," * the mailbox instance associated with the server id."," *"," * @param  {String|Number} id server id"," */","pro.removeServer = function(id) {","  this.onlines[id] = 0;","  var mailbox = this.mailboxes[id];","  if (mailbox) {","    mailbox.close();","    delete this.mailboxes[id];","  }","  this.emit('removeServer', id);","};","","/**"," * Batch version for remove remote servers."," *"," * @param  {Array} ids server id list"," */","pro.removeServers = function(ids) {","  if (!ids || !ids.length) {","    return;","  }","","  for (var i = 0, l = ids.length; i < l; i++) {","    this.removeServer(ids[i]);","  }","};","","/**"," * Clear station infomation."," *"," */","pro.clearStation = function() {","  this.onlines = {};","  this.serversMap = {};","}","","/**"," * Replace remote servers info."," *"," * @param {Array} serverInfos server info list"," */","pro.replaceServers = function(serverInfos) {","  this.clearStation();","  if (!serverInfos || !serverInfos.length) {","    return;","  }","","  for (var i = 0, l = serverInfos.length; i < l; i++) {","    var id = serverInfos[i].id;","    var type = serverInfos[i].serverType;","    this.onlines[id] = 1;","    if (!this.serversMap[type]) {","      this.serversMap[type] = [];","    }","    this.servers[id] = serverInfos[i];","    if (this.serversMap[type].indexOf(id) < 0) {","      this.serversMap[type].push(id);","    }","  }","};","","/**"," * Dispatch rpc message to the mailbox"," *"," * @param  {Object}   tracer   rpc debug tracer"," * @param  {String}   serverId remote server id"," * @param  {Object}   msg      rpc invoke message"," * @param  {Object}   opts     rpc invoke option args"," * @param  {Function} cb       callback function"," * @return {Void}"," */","pro.dispatch = function(tracer, serverId, msg, opts, cb) {","  tracer && tracer.info('client', __filename, 'dispatch', 'dispatch rpc message to the mailbox');","  tracer && (tracer.cb = cb);","  if (this.state !== STATE_STARTED) {","    tracer && tracer.error('client', __filename, 'dispatch', 'client is not running now');","    logger.error('[pomelo-rpc] client is not running now.');","    this.emit('error', constants.RPC_ERROR.SERVER_NOT_STARTED, tracer, serverId, msg, opts);","    return;","  }","","  var self = this;","  var mailbox = this.mailboxes[serverId];","  if (!mailbox) {","    tracer && tracer.debug('client', __filename, 'dispatch', 'mailbox is not exist');","    // try to connect remote server if mailbox instance not exist yet","    if (!lazyConnect(tracer, this, serverId, this.mailboxFactory, cb)) {","      tracer && tracer.error('client', __filename, 'dispatch', 'fail to find remote server:' + serverId);","      logger.error('[pomelo-rpc] fail to find remote server:' + serverId);","      self.emit('error', constants.RPC_ERROR.NO_TRAGET_SERVER, tracer, serverId, msg, opts);","    }","    // push request to the pending queue","    addToPending(tracer, this, serverId, arguments);","    return;","  }","","  if (this.connecting[serverId]) {","    tracer && tracer.debug('client', __filename, 'dispatch', 'request add to connecting');","    // if the mailbox is connecting to remote server","    addToPending(tracer, this, serverId, arguments);","    return;","  }","","  var send = function(tracer, err, serverId, msg, opts) {","    tracer && tracer.info('client', __filename, 'send', 'get corresponding mailbox and try to send message');","    var mailbox = self.mailboxes[serverId];","    if (err) {","      return errorHandler(tracer, self, err, serverId, msg, opts, true, cb);","    }","    if (!mailbox) {","      tracer && tracer.error('client', __filename, 'send', 'can not find mailbox with id:' + serverId);","      logger.error('[pomelo-rpc] could not find mailbox with id:' + serverId);","      self.emit('error', constants.RPC_ERROR.FAIL_FIND_MAILBOX, tracer, serverId, msg, opts);","      return;","    }","    mailbox.send(tracer, msg, opts, function(tracer_send, send_err, args) {","      // var tracer_send = arguments[0];","      // var send_err = arguments[1];","      if (send_err) {","        logger.error('[pomelo-rpc] fail to send message %s', send_err.stack || send_err.message);","        self.emit('error', constants.RPC_ERROR.FAIL_SEND_MESSAGE, tracer, serverId, msg, opts);","        cb && cb(send_err);","        // utils.applyCallback(cb, send_err);","        return;","      }","      // var args = arguments[2];","      doFilter(tracer_send, null, serverId, msg, opts, self.afters, 0, 'after', function(tracer, err, serverId, msg, opts) {","        if (err) {","          errorHandler(tracer, self, err, serverId, msg, opts, false, cb);","        }","        utils.applyCallback(cb, args);","      });","    });","  };","","  doFilter(tracer, null, serverId, msg, opts, this.befores, 0, 'before', send);","};","","/**"," * Add a before filter"," *"," * @param  {[type]} filter [description]"," * @return {[type]}        [description]"," */","pro.before = function(filter) {","  if (Array.isArray(filter)) {","    this.befores = this.befores.concat(filter);","    return;","  }","  this.befores.push(filter);","};","","/**"," * Add after filter"," *"," * @param  {[type]} filter [description]"," * @return {[type]}        [description]"," */","pro.after = function(filter) {","  if (Array.isArray(filter)) {","    this.afters = this.afters.concat(filter);","    return;","  }","  this.afters.push(filter);","};","","/**"," * Add before and after filter"," *"," * @param  {[type]} filter [description]"," * @return {[type]}        [description]"," */","pro.filter = function(filter) {","  this.befores.push(filter);","  this.afters.push(filter);","};","","/**"," * Try to connect to remote server"," *"," * @param  {Object}   tracer   rpc debug tracer"," * @return {String}   serverId remote server id"," * @param  {Function}   cb     callback function"," */","pro.connect = function(tracer, serverId, cb) {","  var self = this;","  var mailbox = self.mailboxes[serverId];","  mailbox.connect(tracer, function(err) {","    if (!!err) {","      tracer && tracer.error('client', __filename, 'lazyConnect', 'fail to connect to remote server: ' + serverId);","      logger.error('[pomelo-rpc] mailbox fail to connect to remote server: ' + serverId);","      if (!!self.mailboxes[serverId]) {","        delete self.mailboxes[serverId];","      }","      self.emit('error', constants.RPC_ERROR.FAIL_CONNECT_SERVER, tracer, serverId, null, self.opts);","      return;","    }","    mailbox.on('close', function(id) {","      var mbox = self.mailboxes[id];","      if (!!mbox) {","        mbox.close();","        delete self.mailboxes[id];","      }","      self.emit('close', id);","    });","    delete self.connecting[serverId];","    flushPending(tracer, self, serverId);","  });","};","","/**"," * Do before or after filter"," */","var doFilter = function(tracer, err, serverId, msg, opts, filters, index, operate, cb) {","  if (index < filters.length) {","    tracer && tracer.info('client', __filename, 'doFilter', 'do ' + operate + ' filter ' + filters[index].name);","  }","  if (index >= filters.length || !!err) {","    cb(tracer, err, serverId, msg, opts);","    return;","  }","  var self = this;","  var filter = filters[index];","  if (typeof filter === 'function') {","    filter(serverId, msg, opts, function(target, message, options) {","      index++;","      //compatible for pomelo filter next(err) method","      if (utils.getObjectClass(target) === 'Error') {","        doFilter(tracer, target, serverId, msg, opts, filters, index, operate, cb);","      } else {","        doFilter(tracer, null, target || serverId, message || msg, options || opts, filters, index, operate, cb);","      }","    });","    return;","  }","  if (typeof filter[operate] === 'function') {","    filter[operate](serverId, msg, opts, function(target, message, options) {","      index++;","      if (utils.getObjectClass(target) === 'Error') {","        doFilter(tracer, target, serverId, msg, opts, filters, index, operate, cb);","      } else {","        doFilter(tracer, null, target || serverId, message || msg, options || opts, filters, index, operate, cb);","      }","    });","    return;","  }","  index++;","  doFilter(tracer, err, serverId, msg, opts, filters, index, operate, cb);","};","","var lazyConnect = function(tracer, station, serverId, factory, cb) {","  tracer && tracer.info('client', __filename, 'lazyConnect', 'create mailbox and try to connect to remote server');","  var server = station.servers[serverId];","  var online = station.onlines[serverId];","  if (!server) {","    logger.error('[pomelo-rpc] unknown server: %s', serverId);","    return false;","  }","  if (!online || online !== 1) {","    logger.error('[pomelo-rpc] server is not online: %s', serverId);","    return false;","  }","  var mailbox = factory.create(server, station.opts);","  station.connecting[serverId] = true;","  station.mailboxes[serverId] = mailbox;","  station.connect(tracer, serverId, cb);","  return true;","};","","var addToPending = function(tracer, station, serverId, args) {","  tracer && tracer.info('client', __filename, 'addToPending', 'add pending requests to pending queue');","  var pending = station.pendings[serverId];","  if (!pending) {","    pending = station.pendings[serverId] = [];","  }","  if (pending.length > station.pendingSize) {","    tracer && tracer.debug('client', __filename, 'addToPending', 'station pending too much for: ' + serverId);","    logger.warn('[pomelo-rpc] station pending too much for: %s', serverId);","    return;","  }","  pending.push(args);","};","","var flushPending = function(tracer, station, serverId, cb) {","  tracer && tracer.info('client', __filename, 'flushPending', 'flush pending requests to dispatch method');","  var pending = station.pendings[serverId];","  var mailbox = station.mailboxes[serverId];","  if (!pending || !pending.length) {","    return;","  }","  if (!mailbox) {","    tracer && tracer.error('client', __filename, 'flushPending', 'fail to flush pending messages for empty mailbox: ' + serverId);","    logger.error('[pomelo-rpc] fail to flush pending messages for empty mailbox: ' + serverId);","  }","  for (var i = 0, l = pending.length; i < l; i++) {","    station.dispatch.apply(station, pending[i]);","  }","  delete station.pendings[serverId];","};","","var errorHandler = function(tracer, station, err, serverId, msg, opts, flag, cb) {","  if (!!station.handleError) {","    station.handleError(err, serverId, msg, opts);","  } else {","    logger.error('[pomelo-rpc] rpc filter error with serverId: %s, err: %j', serverId, err.stack);","    station.emit('error', constants.RPC_ERROR.FILTER_ERROR, tracer, serverId, msg, opts);","  }","};","","/**"," * Mail station factory function."," *"," * @param  {Object} opts construct paramters"," *           opts.servers {Object} global server info map. {serverType: [{id, host, port, ...}, ...]}"," *           opts.mailboxFactory {Function} mailbox factory function"," * @return {Object}      mail station instance"," */","module.exports.create = function(opts) {","  return new MailStation(opts || {});","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"9":1,"10":1,"11":1,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"27":0,"28":0,"31":0,"32":0,"35":0,"38":0,"40":0,"43":1,"45":1,"53":1,"54":0,"55":0,"56":0,"59":0,"60":0,"61":0,"62":0,"72":1,"73":0,"74":0,"75":0,"77":0,"79":0,"81":1,"82":0,"83":0,"86":0,"87":0,"89":0,"99":1,"100":0,"101":0,"104":0,"105":0,"106":0,"107":0,"109":0,"110":0,"113":0,"114":0,"116":0,"124":1,"125":0,"126":0,"129":0,"130":0,"140":1,"141":0,"142":0,"143":0,"144":0,"145":0,"147":0,"155":1,"156":0,"157":0,"160":0,"161":0,"169":1,"170":0,"171":0,"179":1,"180":0,"181":0,"182":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"192":0,"193":0,"194":0,"209":1,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"219":0,"220":0,"221":0,"222":0,"224":0,"225":0,"226":0,"227":0,"230":0,"231":0,"234":0,"235":0,"237":0,"238":0,"241":0,"242":0,"243":0,"244":0,"245":0,"247":0,"248":0,"249":0,"250":0,"251":0,"253":0,"256":0,"257":0,"258":0,"259":0,"261":0,"264":0,"265":0,"266":0,"268":0,"273":0,"282":1,"283":0,"284":0,"285":0,"287":0,"296":1,"297":0,"298":0,"299":0,"301":0,"310":1,"311":0,"312":0,"322":1,"323":0,"324":0,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"332":0,"333":0,"335":0,"336":0,"337":0,"338":0,"339":0,"341":0,"343":0,"344":0,"351":1,"352":0,"353":0,"355":0,"356":0,"357":0,"359":0,"360":0,"361":0,"362":0,"363":0,"365":0,"366":0,"368":0,"371":0,"373":0,"374":0,"375":0,"376":0,"377":0,"379":0,"382":0,"384":0,"385":0,"388":1,"389":0,"390":0,"391":0,"392":0,"393":0,"394":0,"396":0,"397":0,"398":0,"400":0,"401":0,"402":0,"403":0,"404":0,"407":1,"408":0,"409":0,"410":0,"411":0,"413":0,"414":0,"415":0,"416":0,"418":0,"421":1,"422":0,"423":0,"424":0,"425":0,"426":0,"428":0,"429":0,"430":0,"432":0,"433":0,"435":0,"438":1,"439":0,"440":0,"442":0,"443":0,"455":1,"456":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/mailboxes/blackhole.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/mailboxes/blackhole.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":14},"end":{"line":7,"column":35}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":18},"end":{"line":9,"column":29}}},"3":{"name":"(anonymous_3)","line":14,"loc":{"start":{"line":14,"column":12},"end":{"line":14,"column":25}}},"4":{"name":"(anonymous_4)","line":16,"loc":{"start":{"line":16,"column":11},"end":{"line":16,"column":43}}},"5":{"name":"(anonymous_5)","line":19,"loc":{"start":{"line":19,"column":18},"end":{"line":19,"column":29}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":75}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":46}},"5":{"start":{"line":7,"column":0},"end":{"line":12,"column":2}},"6":{"start":{"line":8,"column":1},"end":{"line":8,"column":80}},"7":{"start":{"line":9,"column":1},"end":{"line":11,"column":4}},"8":{"start":{"line":10,"column":2},"end":{"line":10,"column":77}},"9":{"start":{"line":14,"column":0},"end":{"line":14,"column":28}},"10":{"start":{"line":16,"column":0},"end":{"line":22,"column":2}},"11":{"start":{"line":17,"column":1},"end":{"line":17,"column":82}},"12":{"start":{"line":18,"column":1},"end":{"line":18,"column":48}},"13":{"start":{"line":19,"column":1},"end":{"line":21,"column":4}},"14":{"start":{"line":20,"column":2},"end":{"line":20,"column":61}}},"branchMap":{"1":{"line":8,"type":"binary-expr","locations":[{"start":{"line":8,"column":1},"end":{"line":8,"column":7}},{"start":{"line":8,"column":11},"end":{"line":8,"column":79}}]},"2":{"line":17,"type":"binary-expr","locations":[{"start":{"line":17,"column":1},"end":{"line":17,"column":7}},{"start":{"line":17,"column":11},"end":{"line":17,"column":81}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-rpc', 'blackhole');","var EventEmitter = require('events').EventEmitter;","var utils = require('../../util/utils');","","var exp = module.exports = new EventEmitter();","","exp.connect = function(tracer, cb) {","\ttracer && tracer.info('client', __filename, 'connect', 'connect to blackhole');","\tprocess.nextTick(function() {","\t\tcb(new Error('fail to connect to remote server and switch to blackhole.'));","\t});","};","","exp.close = function(cb) {};","","exp.send = function(tracer, msg, opts, cb) {","\ttracer && tracer.info('client', __filename, 'send', 'send rpc msg to blackhole');","\tlogger.info('message into blackhole: %j', msg);","\tprocess.nextTick(function() {","\t\tcb(tracer, new Error('message was forward to blackhole.'));","\t});","};"],"l":{"1":1,"2":1,"3":1,"5":1,"7":1,"8":0,"9":0,"10":0,"14":1,"16":1,"17":0,"18":0,"19":0,"20":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/mailbox.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/mailbox.js","s":{"1":1,"2":1,"3":0},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":15,"loc":{"start":{"line":15,"column":24},"end":{"line":15,"column":51}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":50}},"2":{"start":{"line":15,"column":0},"end":{"line":26,"column":2}},"3":{"start":{"line":25,"column":1},"end":{"line":25,"column":41}}},"branchMap":{},"code":["/**"," * Default mailbox factory"," */","var Mailbox = require('./mailboxes/mqtt-mailbox');","// var Ws2Mailbox = require('./mailboxes/ws2-mailbox');","// var WsMailbox = require('./mailboxes/ws-mailbox');","","/**"," * default mailbox factory"," *"," * @param {Object} serverInfo single server instance info, {id, host, port, ...}"," * @param {Object} opts construct parameters"," * @return {Object} mailbox instancef"," */","module.exports.create = function(serverInfo, opts) {","\t// var mailbox = opts.mailbox || 'mqtt';","\t// var Mailbox = null;","\t// if (mailbox == 'ws') {","\t// \tMailbox = WsMailbox;","\t// } else if (mailbox == 'ws2') {","\t// \tMailbox = Ws2Mailbox;","\t// } else if (mailbox == 'mqtt') {","\t// \tMailbox = MqttMailbox;","\t// }","\treturn Mailbox.create(serverInfo, opts);","};"],"l":{"4":1,"15":1,"25":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/mailboxes/mqtt-mailbox.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/mailboxes/mqtt-mailbox.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":1,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":1,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":1,"102":0,"103":0,"104":0,"105":1,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":1,"121":0,"122":1,"123":0,"124":0,"125":0,"126":0,"127":1,"128":0,"129":1,"130":0,"131":0,"132":1,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":1,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":1,"156":0,"157":0,"158":0,"159":0,"160":0,"161":1,"162":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":14},"end":{"line":12,"column":37}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":28},"end":{"line":36,"column":49}}},"3":{"name":"(anonymous_3)","line":48,"loc":{"start":{"line":48,"column":34},"end":{"line":48,"column":45}}},"4":{"name":"(anonymous_4)","line":55,"loc":{"start":{"line":55,"column":5},"end":{"line":55,"column":16}}},"5":{"name":"(anonymous_5)","line":63,"loc":{"start":{"line":63,"column":35},"end":{"line":63,"column":46}}},"6":{"name":"(anonymous_6)","line":72,"loc":{"start":{"line":72,"column":28},"end":{"line":72,"column":42}}},"7":{"name":"(anonymous_7)","line":86,"loc":{"start":{"line":86,"column":26},"end":{"line":86,"column":40}}},"8":{"name":"(anonymous_8)","line":91,"loc":{"start":{"line":91,"column":29},"end":{"line":91,"column":40}}},"9":{"name":"(anonymous_9)","line":95,"loc":{"start":{"line":95,"column":31},"end":{"line":95,"column":48}}},"10":{"name":"(anonymous_10)","line":109,"loc":{"start":{"line":109,"column":26},"end":{"line":109,"column":37}}},"11":{"name":"(anonymous_11)","line":129,"loc":{"start":{"line":129,"column":25},"end":{"line":129,"column":57}}},"12":{"name":"(anonymous_12)","line":170,"loc":{"start":{"line":170,"column":35},"end":{"line":170,"column":46}}},"13":{"name":"(anonymous_13)","line":172,"loc":{"start":{"line":172,"column":36},"end":{"line":172,"column":47}}},"14":{"name":"(anonymous_14)","line":177,"loc":{"start":{"line":177,"column":35},"end":{"line":177,"column":46}}},"15":{"name":"(anonymous_15)","line":203,"loc":{"start":{"line":203,"column":14},"end":{"line":203,"column":37}}},"16":{"name":"(anonymous_16)","line":207,"loc":{"start":{"line":207,"column":12},"end":{"line":207,"column":30}}},"17":{"name":"(anonymous_17)","line":215,"loc":{"start":{"line":215,"column":13},"end":{"line":215,"column":35}}},"18":{"name":"(anonymous_18)","line":222,"loc":{"start":{"line":222,"column":18},"end":{"line":222,"column":42}}},"19":{"name":"(anonymous_19)","line":228,"loc":{"start":{"line":228,"column":17},"end":{"line":228,"column":40}}},"20":{"name":"(anonymous_20)","line":248,"loc":{"start":{"line":248,"column":19},"end":{"line":248,"column":53}}},"21":{"name":"(anonymous_21)","line":249,"loc":{"start":{"line":249,"column":25},"end":{"line":249,"column":36}}},"22":{"name":"(anonymous_22)","line":262,"loc":{"start":{"line":262,"column":21},"end":{"line":262,"column":43}}},"23":{"name":"(anonymous_23)","line":279,"loc":{"start":{"line":279,"column":24},"end":{"line":279,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":78}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":48}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":42}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":41}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":25}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"10":{"start":{"line":12,"column":0},"end":{"line":32,"column":2}},"11":{"start":{"line":13,"column":2},"end":{"line":13,"column":26}},"12":{"start":{"line":14,"column":2},"end":{"line":14,"column":17}},"13":{"start":{"line":15,"column":2},"end":{"line":15,"column":22}},"14":{"start":{"line":16,"column":2},"end":{"line":16,"column":26}},"15":{"start":{"line":17,"column":2},"end":{"line":17,"column":26}},"16":{"start":{"line":18,"column":2},"end":{"line":18,"column":21}},"17":{"start":{"line":19,"column":2},"end":{"line":19,"column":20}},"18":{"start":{"line":20,"column":2},"end":{"line":20,"column":18}},"19":{"start":{"line":21,"column":2},"end":{"line":21,"column":34}},"20":{"start":{"line":22,"column":2},"end":{"line":22,"column":71}},"21":{"start":{"line":23,"column":2},"end":{"line":23,"column":68}},"22":{"start":{"line":24,"column":2},"end":{"line":24,"column":79}},"23":{"start":{"line":25,"column":2},"end":{"line":25,"column":29}},"24":{"start":{"line":26,"column":2},"end":{"line":26,"column":21}},"25":{"start":{"line":27,"column":2},"end":{"line":27,"column":21}},"26":{"start":{"line":28,"column":2},"end":{"line":28,"column":25}},"27":{"start":{"line":29,"column":2},"end":{"line":29,"column":22}},"28":{"start":{"line":30,"column":2},"end":{"line":30,"column":19}},"29":{"start":{"line":31,"column":2},"end":{"line":31,"column":40}},"30":{"start":{"line":34,"column":0},"end":{"line":34,"column":37}},"31":{"start":{"line":36,"column":0},"end":{"line":104,"column":2}},"32":{"start":{"line":37,"column":2},"end":{"line":37,"column":88}},"33":{"start":{"line":38,"column":2},"end":{"line":41,"column":3}},"34":{"start":{"line":39,"column":4},"end":{"line":39,"column":93}},"35":{"start":{"line":40,"column":4},"end":{"line":40,"column":59}},"36":{"start":{"line":43,"column":2},"end":{"line":43,"column":18}},"37":{"start":{"line":45,"column":2},"end":{"line":45,"column":58}},"38":{"start":{"line":46,"column":2},"end":{"line":46,"column":32}},"39":{"start":{"line":48,"column":2},"end":{"line":51,"column":22}},"40":{"start":{"line":49,"column":4},"end":{"line":49,"column":94}},"41":{"start":{"line":50,"column":4},"end":{"line":50,"column":32}},"42":{"start":{"line":53,"column":2},"end":{"line":70,"column":5}},"43":{"start":{"line":56,"column":4},"end":{"line":58,"column":5}},"44":{"start":{"line":57,"column":6},"end":{"line":57,"column":13}},"45":{"start":{"line":60,"column":4},"end":{"line":60,"column":33}},"46":{"start":{"line":61,"column":4},"end":{"line":61,"column":26}},"47":{"start":{"line":62,"column":4},"end":{"line":66,"column":5}},"48":{"start":{"line":63,"column":6},"end":{"line":65,"column":24}},"49":{"start":{"line":64,"column":8},"end":{"line":64,"column":20}},"50":{"start":{"line":68,"column":4},"end":{"line":68,"column":26}},"51":{"start":{"line":69,"column":4},"end":{"line":69,"column":9}},"52":{"start":{"line":72,"column":2},"end":{"line":84,"column":5}},"53":{"start":{"line":73,"column":4},"end":{"line":73,"column":33}},"54":{"start":{"line":74,"column":4},"end":{"line":83,"column":5}},"55":{"start":{"line":75,"column":6},"end":{"line":75,"column":28}},"56":{"start":{"line":76,"column":6},"end":{"line":80,"column":7}},"57":{"start":{"line":77,"column":8},"end":{"line":77,"column":31}},"58":{"start":{"line":79,"column":8},"end":{"line":79,"column":30}},"59":{"start":{"line":82,"column":6},"end":{"line":82,"column":119}},"60":{"start":{"line":86,"column":2},"end":{"line":89,"column":5}},"61":{"start":{"line":87,"column":4},"end":{"line":87,"column":126}},"62":{"start":{"line":88,"column":4},"end":{"line":88,"column":32}},"63":{"start":{"line":91,"column":2},"end":{"line":93,"column":5}},"64":{"start":{"line":92,"column":4},"end":{"line":92,"column":31}},"65":{"start":{"line":95,"column":2},"end":{"line":103,"column":5}},"66":{"start":{"line":96,"column":4},"end":{"line":96,"column":114}},"67":{"start":{"line":97,"column":4},"end":{"line":97,"column":29}},"68":{"start":{"line":98,"column":4},"end":{"line":101,"column":5}},"69":{"start":{"line":99,"column":6},"end":{"line":99,"column":27}},"70":{"start":{"line":100,"column":6},"end":{"line":100,"column":92}},"71":{"start":{"line":102,"column":4},"end":{"line":102,"column":32}},"72":{"start":{"line":109,"column":0},"end":{"line":120,"column":2}},"73":{"start":{"line":110,"column":2},"end":{"line":112,"column":3}},"74":{"start":{"line":111,"column":4},"end":{"line":111,"column":11}},"75":{"start":{"line":113,"column":2},"end":{"line":113,"column":21}},"76":{"start":{"line":114,"column":2},"end":{"line":114,"column":25}},"77":{"start":{"line":115,"column":2},"end":{"line":118,"column":3}},"78":{"start":{"line":116,"column":4},"end":{"line":116,"column":34}},"79":{"start":{"line":117,"column":4},"end":{"line":117,"column":26}},"80":{"start":{"line":119,"column":2},"end":{"line":119,"column":24}},"81":{"start":{"line":129,"column":0},"end":{"line":168,"column":2}},"82":{"start":{"line":130,"column":2},"end":{"line":130,"column":82}},"83":{"start":{"line":131,"column":2},"end":{"line":135,"column":3}},"84":{"start":{"line":132,"column":4},"end":{"line":132,"column":82}},"85":{"start":{"line":133,"column":4},"end":{"line":133,"column":82}},"86":{"start":{"line":134,"column":4},"end":{"line":134,"column":11}},"87":{"start":{"line":137,"column":2},"end":{"line":141,"column":3}},"88":{"start":{"line":138,"column":4},"end":{"line":138,"column":87}},"89":{"start":{"line":139,"column":4},"end":{"line":139,"column":89}},"90":{"start":{"line":140,"column":4},"end":{"line":140,"column":11}},"91":{"start":{"line":143,"column":2},"end":{"line":143,"column":24}},"92":{"start":{"line":144,"column":2},"end":{"line":144,"column":25}},"93":{"start":{"line":145,"column":2},"end":{"line":145,"column":37}},"94":{"start":{"line":147,"column":2},"end":{"line":147,"column":10}},"95":{"start":{"line":148,"column":2},"end":{"line":162,"column":3}},"96":{"start":{"line":149,"column":4},"end":{"line":156,"column":6}},"97":{"start":{"line":158,"column":4},"end":{"line":161,"column":6}},"98":{"start":{"line":163,"column":2},"end":{"line":167,"column":3}},"99":{"start":{"line":164,"column":4},"end":{"line":164,"column":23}},"100":{"start":{"line":166,"column":4},"end":{"line":166,"column":29}},"101":{"start":{"line":170,"column":0},"end":{"line":175,"column":1}},"102":{"start":{"line":171,"column":2},"end":{"line":171,"column":18}},"103":{"start":{"line":172,"column":2},"end":{"line":174,"column":21}},"104":{"start":{"line":173,"column":4},"end":{"line":173,"column":26}},"105":{"start":{"line":177,"column":0},"end":{"line":201,"column":1}},"106":{"start":{"line":178,"column":2},"end":{"line":180,"column":3}},"107":{"start":{"line":179,"column":4},"end":{"line":179,"column":11}},"108":{"start":{"line":183,"column":2},"end":{"line":183,"column":23}},"109":{"start":{"line":184,"column":2},"end":{"line":184,"column":46}},"110":{"start":{"line":185,"column":2},"end":{"line":200,"column":3}},"111":{"start":{"line":186,"column":4},"end":{"line":196,"column":5}},"112":{"start":{"line":187,"column":6},"end":{"line":192,"column":7}},"113":{"start":{"line":188,"column":8},"end":{"line":188,"column":195}},"114":{"start":{"line":189,"column":8},"end":{"line":189,"column":36}},"115":{"start":{"line":190,"column":8},"end":{"line":190,"column":27}},"116":{"start":{"line":194,"column":6},"end":{"line":194,"column":28}},"117":{"start":{"line":195,"column":6},"end":{"line":195,"column":33}},"118":{"start":{"line":198,"column":4},"end":{"line":198,"column":26}},"119":{"start":{"line":199,"column":4},"end":{"line":199,"column":31}},"120":{"start":{"line":203,"column":0},"end":{"line":205,"column":2}},"121":{"start":{"line":204,"column":2},"end":{"line":204,"column":26}},"122":{"start":{"line":207,"column":0},"end":{"line":213,"column":2}},"123":{"start":{"line":208,"column":2},"end":{"line":210,"column":3}},"124":{"start":{"line":209,"column":4},"end":{"line":209,"column":11}},"125":{"start":{"line":211,"column":2},"end":{"line":211,"column":40}},"126":{"start":{"line":212,"column":2},"end":{"line":212,"column":21}},"127":{"start":{"line":215,"column":0},"end":{"line":220,"column":1}},"128":{"start":{"line":216,"column":2},"end":{"line":219,"column":5}},"129":{"start":{"line":222,"column":0},"end":{"line":226,"column":2}},"130":{"start":{"line":223,"column":2},"end":{"line":225,"column":3}},"131":{"start":{"line":224,"column":4},"end":{"line":224,"column":33}},"132":{"start":{"line":228,"column":0},"end":{"line":246,"column":2}},"133":{"start":{"line":229,"column":2},"end":{"line":229,"column":21}},"134":{"start":{"line":230,"column":2},"end":{"line":230,"column":33}},"135":{"start":{"line":231,"column":2},"end":{"line":231,"column":35}},"136":{"start":{"line":232,"column":2},"end":{"line":234,"column":3}},"137":{"start":{"line":233,"column":4},"end":{"line":233,"column":11}},"138":{"start":{"line":236,"column":2},"end":{"line":236,"column":33}},"139":{"start":{"line":237,"column":2},"end":{"line":237,"column":45}},"140":{"start":{"line":238,"column":2},"end":{"line":238,"column":20}},"141":{"start":{"line":239,"column":2},"end":{"line":239,"column":21}},"142":{"start":{"line":240,"column":2},"end":{"line":242,"column":3}},"143":{"start":{"line":241,"column":4},"end":{"line":241,"column":143}},"144":{"start":{"line":243,"column":2},"end":{"line":243,"column":25}},"145":{"start":{"line":245,"column":2},"end":{"line":245,"column":31}},"146":{"start":{"line":248,"column":0},"end":{"line":260,"column":2}},"147":{"start":{"line":249,"column":2},"end":{"line":258,"column":27}},"148":{"start":{"line":251,"column":4},"end":{"line":251,"column":32}},"149":{"start":{"line":252,"column":4},"end":{"line":254,"column":5}},"150":{"start":{"line":253,"column":6},"end":{"line":253,"column":34}},"151":{"start":{"line":255,"column":4},"end":{"line":255,"column":166}},"152":{"start":{"line":256,"column":4},"end":{"line":256,"column":23}},"153":{"start":{"line":257,"column":4},"end":{"line":257,"column":32}},"154":{"start":{"line":259,"column":2},"end":{"line":259,"column":30}},"155":{"start":{"line":262,"column":0},"end":{"line":269,"column":2}},"156":{"start":{"line":263,"column":2},"end":{"line":266,"column":3}},"157":{"start":{"line":264,"column":4},"end":{"line":264,"column":134}},"158":{"start":{"line":265,"column":4},"end":{"line":265,"column":11}},"159":{"start":{"line":267,"column":2},"end":{"line":267,"column":36}},"160":{"start":{"line":268,"column":2},"end":{"line":268,"column":29}},"161":{"start":{"line":279,"column":0},"end":{"line":281,"column":2}},"162":{"start":{"line":280,"column":2},"end":{"line":280,"column":41}}},"branchMap":{"1":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":19},"end":{"line":22,"column":33}},{"start":{"line":22,"column":37},"end":{"line":22,"column":70}}]},"2":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":18},"end":{"line":23,"column":31}},{"start":{"line":23,"column":35},"end":{"line":23,"column":67}}]},"3":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":22},"end":{"line":24,"column":34}},{"start":{"line":24,"column":38},"end":{"line":24,"column":78}}]},"4":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":8}},{"start":{"line":37,"column":12},"end":{"line":37,"column":87}}]},"5":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":2},"end":{"line":38,"column":2}},{"start":{"line":38,"column":2},"end":{"line":38,"column":2}}]},"6":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":10}},{"start":{"line":39,"column":14},"end":{"line":39,"column":92}}]},"7":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":4}},{"start":{"line":56,"column":4},"end":{"line":56,"column":4}}]},"8":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":62,"column":4}},{"start":{"line":62,"column":4},"end":{"line":62,"column":4}}]},"9":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":6},"end":{"line":76,"column":6}},{"start":{"line":76,"column":6},"end":{"line":76,"column":6}}]},"10":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":2},"end":{"line":110,"column":2}},{"start":{"line":110,"column":2},"end":{"line":110,"column":2}}]},"11":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":2},"end":{"line":115,"column":2}},{"start":{"line":115,"column":2},"end":{"line":115,"column":2}}]},"12":{"line":130,"type":"binary-expr","locations":[{"start":{"line":130,"column":2},"end":{"line":130,"column":8}},{"start":{"line":130,"column":12},"end":{"line":130,"column":81}}]},"13":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":2},"end":{"line":131,"column":2}},{"start":{"line":131,"column":2},"end":{"line":131,"column":2}}]},"14":{"line":132,"type":"binary-expr","locations":[{"start":{"line":132,"column":4},"end":{"line":132,"column":10}},{"start":{"line":132,"column":14},"end":{"line":132,"column":81}}]},"15":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":2},"end":{"line":137,"column":2}},{"start":{"line":137,"column":2},"end":{"line":137,"column":2}}]},"16":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":4},"end":{"line":138,"column":10}},{"start":{"line":138,"column":14},"end":{"line":138,"column":86}}]},"17":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":2},"end":{"line":148,"column":2}},{"start":{"line":148,"column":2},"end":{"line":148,"column":2}}]},"18":{"line":148,"type":"binary-expr","locations":[{"start":{"line":148,"column":6},"end":{"line":148,"column":12}},{"start":{"line":148,"column":16},"end":{"line":148,"column":32}}]},"19":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":2},"end":{"line":163,"column":2}},{"start":{"line":163,"column":2},"end":{"line":163,"column":2}}]},"20":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":2},"end":{"line":178,"column":2}},{"start":{"line":178,"column":2},"end":{"line":178,"column":2}}]},"21":{"line":185,"type":"if","locations":[{"start":{"line":185,"column":2},"end":{"line":185,"column":2}},{"start":{"line":185,"column":2},"end":{"line":185,"column":2}}]},"22":{"line":186,"type":"if","locations":[{"start":{"line":186,"column":4},"end":{"line":186,"column":4}},{"start":{"line":186,"column":4},"end":{"line":186,"column":4}}]},"23":{"line":187,"type":"if","locations":[{"start":{"line":187,"column":6},"end":{"line":187,"column":6}},{"start":{"line":187,"column":6},"end":{"line":187,"column":6}}]},"24":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":2},"end":{"line":208,"column":2}},{"start":{"line":208,"column":2},"end":{"line":208,"column":2}}]},"25":{"line":208,"type":"binary-expr","locations":[{"start":{"line":208,"column":6},"end":{"line":208,"column":20}},{"start":{"line":208,"column":24},"end":{"line":208,"column":45}}]},"26":{"line":232,"type":"if","locations":[{"start":{"line":232,"column":2},"end":{"line":232,"column":2}},{"start":{"line":232,"column":2},"end":{"line":232,"column":2}}]},"27":{"line":240,"type":"if","locations":[{"start":{"line":240,"column":2},"end":{"line":240,"column":2}},{"start":{"line":240,"column":2},"end":{"line":240,"column":2}}]},"28":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":4},"end":{"line":252,"column":4}},{"start":{"line":252,"column":4},"end":{"line":252,"column":4}}]},"29":{"line":263,"type":"if","locations":[{"start":{"line":263,"column":2},"end":{"line":263,"column":2}},{"start":{"line":263,"column":2},"end":{"line":263,"column":2}}]},"30":{"line":280,"type":"binary-expr","locations":[{"start":{"line":280,"column":29},"end":{"line":280,"column":33}},{"start":{"line":280,"column":37},"end":{"line":280,"column":39}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-rpc', 'mqtt-mailbox');","var EventEmitter = require('events').EventEmitter;","var constants = require('../../util/constants');","var Tracer = require('../../util/tracer');","var MqttCon = require('mqtt-connection');","var utils = require('../../util/utils');","var util = require('util');","var net = require('net');","","var CONNECT_TIMEOUT = 2000;","","var MailBox = function(server, opts) {","  EventEmitter.call(this);","  this.curId = 0;","  this.id = server.id;","  this.host = server.host;","  this.port = server.port;","  this.requests = {};","  this.timeout = {};","  this.queue = [];","  this.bufferMsg = opts.bufferMsg;","  this.keepalive = opts.keepalive || constants.DEFAULT_PARAM.KEEPALIVE;","  this.interval = opts.interval || constants.DEFAULT_PARAM.INTERVAL;","  this.timeoutValue = opts.timeout || constants.DEFAULT_PARAM.CALLBACK_TIMEOUT;","  this.keepaliveTimer = null;","  this.lastPing = -1;","  this.lastPong = -1;","  this.connected = false;","  this.closed = false;","  this.opts = opts;","  this.serverId = opts.context.serverId;","};","","util.inherits(MailBox, EventEmitter);","","MailBox.prototype.connect = function(tracer, cb) {","  tracer && tracer.info('client', __filename, 'connect', 'mqtt-mailbox try to connect');","  if (this.connected) {","    tracer && tracer.error('client', __filename, 'connect', 'mailbox has already connected');","    return cb(new Error('mailbox has already connected.'));","  }","","  var self = this;","","  var stream = net.createConnection(this.port, this.host);","  this.socket = MqttCon(stream);","","  var connectTimeout = setTimeout(function() {","    logger.error('rpc client %s connect to remote server %s timeout', self.serverId, self.id);","    self.emit('close', self.id);","  }, CONNECT_TIMEOUT);","","  this.socket.connect({","    clientId: 'MQTT_RPC_' + Date.now()","  }, function() {","    if (self.connected) {","      return;","    }","","    clearTimeout(connectTimeout);","    self.connected = true;","    if (self.bufferMsg) {","      self._interval = setInterval(function() {","        flush(self);","      }, self.interval);","    }","","    self.setupKeepAlive();","    cb();","  });","","  this.socket.on('publish', function(pkg) {","    pkg = pkg.payload.toString();","    try {","      pkg = JSON.parse(pkg);","      if (pkg instanceof Array) {","        processMsgs(self, pkg);","      } else {","        processMsg(self, pkg);","      }","    } catch (err) {","      logger.error('rpc client %s process remote server %s message with error: %s', self.serverId, self.id, err.stack);","    }","  });","","  this.socket.on('error', function(err) {","    logger.error('rpc socket %s is error, remote server %s host: %s, port: %s', self.serverId, self.id, self.host, self.port);","    self.emit('close', self.id);","  });","","  this.socket.on('pingresp', function() {","    self.lastPong = Date.now();","  });","","  this.socket.on('disconnect', function(reason) {","    logger.error('rpc socket %s is disconnect from remote server %s, reason: %s', self.serverId, self.id, reason);","    var reqs = self.requests;","    for (var id in reqs) {","      var ReqCb = reqs[id];","      ReqCb(tracer, new Error(self.serverId + ' disconnect with remote server ' + self.id));","    }","    self.emit('close', self.id);","  });","};","","/**"," * close mailbox"," */","MailBox.prototype.close = function() {","  if (this.closed) {","    return;","  }","  this.closed = true;","  this.connected = false;","  if (this._interval) {","    clearInterval(this._interval);","    this._interval = null;","  }","  this.socket.destroy();","};","","/**"," * send message to remote server"," *"," * @param msg {service:\"\", method:\"\", args:[]}"," * @param opts {} attach info to send method"," * @param cb declaration decided by remote interface"," */","MailBox.prototype.send = function(tracer, msg, opts, cb) {","  tracer && tracer.info('client', __filename, 'send', 'mqtt-mailbox try to send');","  if (!this.connected) {","    tracer && tracer.error('client', __filename, 'send', 'mqtt-mailbox not init');","    cb(tracer, new Error(this.serverId + ' mqtt-mailbox is not init ' + this.id));","    return;","  }","","  if (this.closed) {","    tracer && tracer.error('client', __filename, 'send', 'mailbox has already closed');","    cb(tracer, new Error(this.serverId + ' mqtt-mailbox has already closed ' + this.id));","    return;","  }","","  var id = this.curId++;","  this.requests[id] = cb;","  setCbTimeout(this, id, tracer, cb);","","  var pkg;","  if (tracer && tracer.isEnabled) {","    pkg = {","      traceId: tracer.id,","      seqId: tracer.seq,","      source: tracer.source,","      remote: tracer.remote,","      id: id,","      msg: msg","    };","  } else {","    pkg = {","      id: id,","      msg: msg","    };","  }","  if (this.bufferMsg) {","    enqueue(this, pkg);","  } else {","    doSend(this.socket, pkg);","  }","};","","MailBox.prototype.setupKeepAlive = function() {","  var self = this;","  this.keepaliveTimer = setInterval(function() {","    self.checkKeepAlive();","  }, this.keepalive);","}","","MailBox.prototype.checkKeepAlive = function() {","  if (this.closed) {","    return;","  }","","  // console.log('checkKeepAlive lastPing %d lastPong %d ~~~', this.lastPing, this.lastPong);","  var now = Date.now();","  var KEEP_ALIVE_TIMEOUT = this.keepalive * 2;","  if (this.lastPing > 0) {","    if (this.lastPong < this.lastPing) {","      if (now - this.lastPing > KEEP_ALIVE_TIMEOUT) {","        logger.error('mqtt rpc client %s checkKeepAlive timeout from remote server %s for %d lastPing: %s lastPong: %s', this.serverId, this.id, KEEP_ALIVE_TIMEOUT, this.lastPing, this.lastPong);","        this.emit('close', this.id);","        this.lastPing = -1;","        // this.close();","      }","    } else {","      this.socket.pingreq();","      this.lastPing = Date.now();","    }","  } else {","    this.socket.pingreq();","    this.lastPing = Date.now();","  }","}","","var enqueue = function(mailbox, msg) {","  mailbox.queue.push(msg);","};","","var flush = function(mailbox) {","  if (mailbox.closed || !mailbox.queue.length) {","    return;","  }","  doSend(mailbox.socket, mailbox.queue);","  mailbox.queue = [];","};","","var doSend = function(socket, msg) {","  socket.publish({","    topic: 'rpc',","    payload: JSON.stringify(msg)","  });","}","","var processMsgs = function(mailbox, pkgs) {","  for (var i = 0, l = pkgs.length; i < l; i++) {","    processMsg(mailbox, pkgs[i]);","  }","};","","var processMsg = function(mailbox, pkg) {","  var pkgId = pkg.id;","  clearCbTimeout(mailbox, pkgId);","  var cb = mailbox.requests[pkgId];","  if (!cb) {","    return;","  }","","  delete mailbox.requests[pkgId];","  var rpcDebugLog = mailbox.opts.rpcDebugLog;","  var tracer = null;","  var sendErr = null;","  if (rpcDebugLog) {","    tracer = new Tracer(mailbox.opts.rpcLogger, mailbox.opts.rpcDebugLog, mailbox.opts.clientId, pkg.source, pkg.resp, pkg.traceId, pkg.seqId);","  }","  var pkgResp = pkg.resp;","","  cb(tracer, sendErr, pkgResp);","};","","var setCbTimeout = function(mailbox, id, tracer, cb) {","  var timer = setTimeout(function() {","    // logger.warn('rpc request is timeout, id: %s, host: %s, port: %s', id, mailbox.host, mailbox.port);","    clearCbTimeout(mailbox, id);","    if (mailbox.requests[id]) {","      delete mailbox.requests[id];","    }","    var eMsg = util.format('rpc %s callback timeout %d, remote server %s host: %s, port: %s', mailbox.serverId, mailbox.timeoutValue, id, mailbox.host, mailbox.port);","    logger.error(eMsg);","    cb(tracer, new Error(eMsg));","  }, mailbox.timeoutValue);","  mailbox.timeout[id] = timer;","};","","var clearCbTimeout = function(mailbox, id) {","  if (!mailbox.timeout[id]) {","    logger.warn('timer is not exsits, serverId: %s remote: %s, host: %s, port: %s', mailbox.serverId, id, mailbox.host, mailbox.port);","    return;","  }","  clearTimeout(mailbox.timeout[id]);","  delete mailbox.timeout[id];","};","","/**"," * Factory method to create mailbox"," *"," * @param {Object} server remote server info {id:\"\", host:\"\", port:\"\"}"," * @param {Object} opts construct parameters"," *                      opts.bufferMsg {Boolean} msg should be buffered or send immediately."," *                      opts.interval {Boolean} msg queue flush interval if bufferMsg is true. default is 50 ms"," */","module.exports.create = function(server, opts) {","  return new MailBox(server, opts || {});","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"10":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"34":1,"36":1,"37":0,"38":0,"39":0,"40":0,"43":0,"45":0,"46":0,"48":0,"49":0,"50":0,"53":0,"56":0,"57":0,"60":0,"61":0,"62":0,"63":0,"64":0,"68":0,"69":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"79":0,"82":0,"86":0,"87":0,"88":0,"91":0,"92":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"102":0,"109":1,"110":0,"111":0,"113":0,"114":0,"115":0,"116":0,"117":0,"119":0,"129":1,"130":0,"131":0,"132":0,"133":0,"134":0,"137":0,"138":0,"139":0,"140":0,"143":0,"144":0,"145":0,"147":0,"148":0,"149":0,"158":0,"163":0,"164":0,"166":0,"170":1,"171":0,"172":0,"173":0,"177":1,"178":0,"179":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"194":0,"195":0,"198":0,"199":0,"203":1,"204":0,"207":1,"208":0,"209":0,"211":0,"212":0,"215":1,"216":0,"222":1,"223":0,"224":0,"228":1,"229":0,"230":0,"231":0,"232":0,"233":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"243":0,"245":0,"248":1,"249":0,"251":0,"252":0,"253":0,"255":0,"256":0,"257":0,"259":0,"262":1,"263":0,"264":0,"265":0,"267":0,"268":0,"279":1,"280":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/tracer.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/tracer.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":0,"15":1,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":13},"end":{"line":3,"column":75}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":29},"end":{"line":18,"column":65}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":24},"end":{"line":33,"column":60}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":25},"end":{"line":40,"column":61}}},"5":{"name":"(anonymous_5)","line":47,"loc":{"start":{"line":47,"column":25},"end":{"line":47,"column":61}}},"6":{"name":"(anonymous_6)","line":54,"loc":{"start":{"line":54,"column":16},"end":{"line":54,"column":33}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":32}},"2":{"start":{"line":3,"column":0},"end":{"line":14,"column":2}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":33}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"5":{"start":{"line":6,"column":4},"end":{"line":6,"column":11}},"6":{"start":{"line":8,"column":2},"end":{"line":8,"column":23}},"7":{"start":{"line":9,"column":2},"end":{"line":9,"column":23}},"8":{"start":{"line":10,"column":2},"end":{"line":10,"column":23}},"9":{"start":{"line":11,"column":2},"end":{"line":11,"column":28}},"10":{"start":{"line":12,"column":2},"end":{"line":12,"column":22}},"11":{"start":{"line":13,"column":2},"end":{"line":13,"column":17}},"12":{"start":{"line":16,"column":0},"end":{"line":16,"column":24}},"13":{"start":{"line":18,"column":0},"end":{"line":31,"column":2}},"14":{"start":{"line":19,"column":2},"end":{"line":30,"column":4}},"15":{"start":{"line":33,"column":0},"end":{"line":38,"column":2}},"16":{"start":{"line":34,"column":2},"end":{"line":36,"column":3}},"17":{"start":{"line":35,"column":4},"end":{"line":35,"column":80}},"18":{"start":{"line":37,"column":2},"end":{"line":37,"column":9}},"19":{"start":{"line":40,"column":0},"end":{"line":45,"column":2}},"20":{"start":{"line":41,"column":2},"end":{"line":43,"column":3}},"21":{"start":{"line":42,"column":4},"end":{"line":42,"column":81}},"22":{"start":{"line":44,"column":2},"end":{"line":44,"column":9}},"23":{"start":{"line":47,"column":0},"end":{"line":52,"column":2}},"24":{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},"25":{"start":{"line":49,"column":4},"end":{"line":49,"column":81}},"26":{"start":{"line":51,"column":2},"end":{"line":51,"column":9}},"27":{"start":{"line":54,"column":0},"end":{"line":62,"column":2}},"28":{"start":{"line":55,"column":2},"end":{"line":55,"column":14}},"29":{"start":{"line":56,"column":2},"end":{"line":56,"column":31}},"30":{"start":{"line":57,"column":2},"end":{"line":57,"column":29}},"31":{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},"32":{"start":{"line":59,"column":4},"end":{"line":59,"column":25}},"33":{"start":{"line":61,"column":2},"end":{"line":61,"column":12}}},"branchMap":{"1":{"line":5,"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":5,"column":2}},{"start":{"line":5,"column":2},"end":{"line":5,"column":2}}]},"2":{"line":11,"type":"binary-expr","locations":[{"start":{"line":11,"column":12},"end":{"line":11,"column":14}},{"start":{"line":11,"column":18},"end":{"line":11,"column":27}}]},"3":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":13},"end":{"line":12,"column":16}},{"start":{"line":12,"column":20},"end":{"line":12,"column":21}}]},"4":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":2},"end":{"line":34,"column":2}},{"start":{"line":34,"column":2},"end":{"line":34,"column":2}}]},"5":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":2},"end":{"line":41,"column":2}},{"start":{"line":41,"column":2},"end":{"line":41,"column":2}}]},"6":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":48,"column":2}},{"start":{"line":48,"column":2},"end":{"line":48,"column":2}}]}},"code":["var uuid = require('node-uuid');","","var Tracer = function(logger, enabledRpcLog, source, remote, msg, id, seq) {","  this.isEnabled = enabledRpcLog;","  if (!enabledRpcLog) {","    return;","  }","  this.logger = logger;","  this.source = source;","  this.remote = remote;","  this.id = id || uuid.v1();","  this.seq = seq || 1;","  this.msg = msg;","};","","module.exports = Tracer;","","Tracer.prototype.getLogger = function(role, module, method, des) {","  return {","    traceId: this.id,","    seq: this.seq++,","    role: role,","    source: this.source,","    remote: this.remote,","    module: getModule(module),","    method: method,","    args: this.msg,","    timestamp: Date.now(),","    description: des","  };","};","","Tracer.prototype.info = function(role, module, method, des) {","  if (this.isEnabled) {","    this.logger.info(JSON.stringify(this.getLogger(role, module, method, des)));","  }","  return;","};","","Tracer.prototype.debug = function(role, module, method, des) {","  if (this.isEnabled) {","    this.logger.debug(JSON.stringify(this.getLogger(role, module, method, des)));","  }","  return;","};","","Tracer.prototype.error = function(role, module, method, des) {","  if (this.isEnabled) {","    this.logger.error(JSON.stringify(this.getLogger(role, module, method, des)));","  }","  return;","};","","var getModule = function(module) {","  var rs = '';","  var strs = module.split('/');","  var lines = strs.slice(-3);","  for (var i = 0; i < lines.length; i++) {","    rs += '/' + lines[i];","  }","  return rs;","};"],"l":{"1":1,"3":1,"4":0,"5":0,"6":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"16":1,"18":1,"19":0,"33":1,"34":0,"35":0,"37":0,"40":1,"41":0,"42":0,"44":0,"47":1,"48":0,"49":0,"51":0,"54":1,"55":0,"56":0,"57":0,"58":0,"59":0,"61":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/proxy.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/proxy.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":14,"loc":{"start":{"line":14,"column":13},"end":{"line":14,"column":28}}},"2":{"name":"(anonymous_2)","line":28,"loc":{"start":{"line":28,"column":21},"end":{"line":28,"column":68}}},"3":{"name":"(anonymous_3)","line":51,"loc":{"start":{"line":51,"column":23},"end":{"line":51,"column":82}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":10},"end":{"line":52,"column":21}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":16},"end":{"line":53,"column":27}}},"6":{"name":"(anonymous_6)","line":64,"loc":{"start":{"line":64,"column":21},"end":{"line":64,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":75}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":25}},"3":{"start":{"line":14,"column":0},"end":{"line":26,"column":2}},"4":{"start":{"line":15,"column":2},"end":{"line":18,"column":3}},"5":{"start":{"line":16,"column":4},"end":{"line":16,"column":61}},"6":{"start":{"line":17,"column":4},"end":{"line":17,"column":16}},"7":{"start":{"line":20,"column":2},"end":{"line":23,"column":3}},"8":{"start":{"line":21,"column":4},"end":{"line":21,"column":86}},"9":{"start":{"line":22,"column":4},"end":{"line":22,"column":23}},"10":{"start":{"line":25,"column":2},"end":{"line":25,"column":78}},"11":{"start":{"line":28,"column":0},"end":{"line":38,"column":2}},"12":{"start":{"line":30,"column":2},"end":{"line":30,"column":15}},"13":{"start":{"line":31,"column":2},"end":{"line":35,"column":3}},"14":{"start":{"line":32,"column":4},"end":{"line":34,"column":5}},"15":{"start":{"line":33,"column":6},"end":{"line":33,"column":81}},"16":{"start":{"line":37,"column":2},"end":{"line":37,"column":13}},"17":{"start":{"line":51,"column":0},"end":{"line":76,"column":2}},"18":{"start":{"line":52,"column":2},"end":{"line":75,"column":7}},"19":{"start":{"line":53,"column":4},"end":{"line":62,"column":6}},"20":{"start":{"line":55,"column":6},"end":{"line":55,"column":33}},"21":{"start":{"line":56,"column":6},"end":{"line":56,"column":32}},"22":{"start":{"line":57,"column":6},"end":{"line":59,"column":7}},"23":{"start":{"line":58,"column":8},"end":{"line":58,"column":31}},"24":{"start":{"line":61,"column":6},"end":{"line":61,"column":53}},"25":{"start":{"line":64,"column":4},"end":{"line":72,"column":6}},"26":{"start":{"line":66,"column":6},"end":{"line":66,"column":33}},"27":{"start":{"line":67,"column":6},"end":{"line":67,"column":32}},"28":{"start":{"line":68,"column":6},"end":{"line":70,"column":7}},"29":{"start":{"line":69,"column":8},"end":{"line":69,"column":31}},"30":{"start":{"line":71,"column":6},"end":{"line":71,"column":59}},"31":{"start":{"line":74,"column":4},"end":{"line":74,"column":17}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":2},"end":{"line":15,"column":2}},{"start":{"line":15,"column":2},"end":{"line":15,"column":2}}]},"2":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":6},"end":{"line":15,"column":11}},{"start":{"line":15,"column":15},"end":{"line":15,"column":27}}]},"3":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":20,"column":2}},{"start":{"line":20,"column":2},"end":{"line":20,"column":2}}]},"4":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":6},"end":{"line":20,"column":19}},{"start":{"line":20,"column":23},"end":{"line":20,"column":57}}]},"5":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":4},"end":{"line":32,"column":4}},{"start":{"line":32,"column":4},"end":{"line":32,"column":4}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-rpc', 'rpc-proxy');","var exp = module.exports;","","/**"," * Create proxy."," *"," * @param  {Object} opts construct parameters"," *           opts.origin {Object} delegated object"," *           opts.proxyCB {Function} proxy invoke callback"," *           opts.service {String} deletgated service name"," *           opts.attach {Object} attach parameter pass to proxyCB"," * @return {Object}      proxy instance"," */","exp.create = function(opts) {","  if (!opts || !opts.origin) {","    logger.warn('opts and opts.origin should not be empty.');","    return null;","  }","","  if (!opts.proxyCB || typeof opts.proxyCB !== 'function') {","    logger.warn('opts.proxyCB is not a function, return the origin module directly.');","    return opts.origin;","  }","","  return genObjectProxy(opts.service, opts.origin, opts.attach, opts.proxyCB);","};","","var genObjectProxy = function(serviceName, origin, attach, proxyCB) {","  //generate proxy for function field","  var res = {};","  for (var field in origin) {","    if (typeof origin[field] === 'function') {","      res[field] = genFunctionProxy(serviceName, field, origin, attach, proxyCB);","    }","  }","","  return res;","};","","/**"," * Generate prxoy for function type field"," *"," * @param namespace {String} current namespace"," * @param serverType {String} server type string"," * @param serviceName {String} delegated service name"," * @param methodName {String} delegated method name"," * @param origin {Object} origin object"," * @param proxyCB {Functoin} proxy callback function"," * @returns function proxy"," */","var genFunctionProxy = function(serviceName, methodName, origin, attach, proxyCB) {","  return (function() {","    var proxy = function() {","      // var args = arguments;","      var len = arguments.length;","      var args = new Array(len);","      for (var i = 0; i < len; i++) {","        args[i] = arguments[i];","      }","      // var args = Array.prototype.slice.call(arguments, 0);","      proxyCB(serviceName, methodName, args, attach);","    };","","    proxy.toServer = function() {","      // var args = arguments;","      var len = arguments.length;","      var args = new Array(len);","      for (var i = 0; i < len; i++) {","        args[i] = arguments[i];","      }","      proxyCB(serviceName, methodName, args, attach, true);","    };","","    return proxy;","  })();","};"],"l":{"1":1,"2":1,"14":1,"15":0,"16":0,"17":0,"20":0,"21":0,"22":0,"25":0,"28":1,"30":0,"31":0,"32":0,"33":0,"37":0,"51":1,"52":0,"53":0,"55":0,"56":0,"57":0,"58":0,"61":0,"64":0,"66":0,"67":0,"68":0,"69":0,"71":0,"74":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/router.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-client/router.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":1,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":15},"end":{"line":13,"column":51}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":14},"end":{"line":32,"column":52}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":14},"end":{"line":50,"column":52}}},"4":{"name":"(anonymous_4)","line":80,"loc":{"start":{"line":80,"column":15},"end":{"line":80,"column":53}}},"5":{"name":"(anonymous_5)","line":97,"loc":{"start":{"line":97,"column":21},"end":{"line":97,"column":32}}},"6":{"name":"(anonymous_6)","line":139,"loc":{"start":{"line":139,"column":14},"end":{"line":139,"column":52}}},"7":{"name":"(anonymous_7)","line":188,"loc":{"start":{"line":188,"column":14},"end":{"line":188,"column":52}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":55}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"4":{"start":{"line":13,"column":0},"end":{"line":22,"column":2}},"5":{"start":{"line":14,"column":2},"end":{"line":14,"column":54}},"6":{"start":{"line":15,"column":2},"end":{"line":18,"column":3}},"7":{"start":{"line":16,"column":4},"end":{"line":16,"column":73}},"8":{"start":{"line":17,"column":4},"end":{"line":17,"column":11}},"9":{"start":{"line":19,"column":2},"end":{"line":19,"column":47}},"10":{"start":{"line":20,"column":2},"end":{"line":20,"column":64}},"11":{"start":{"line":21,"column":2},"end":{"line":21,"column":27}},"12":{"start":{"line":32,"column":0},"end":{"line":40,"column":2}},"13":{"start":{"line":33,"column":2},"end":{"line":33,"column":55}},"14":{"start":{"line":34,"column":2},"end":{"line":37,"column":3}},"15":{"start":{"line":35,"column":4},"end":{"line":35,"column":74}},"16":{"start":{"line":36,"column":4},"end":{"line":36,"column":11}},"17":{"start":{"line":38,"column":2},"end":{"line":38,"column":57}},"18":{"start":{"line":39,"column":2},"end":{"line":39,"column":27}},"19":{"start":{"line":50,"column":0},"end":{"line":70,"column":2}},"20":{"start":{"line":51,"column":2},"end":{"line":51,"column":55}},"21":{"start":{"line":52,"column":2},"end":{"line":55,"column":3}},"22":{"start":{"line":53,"column":4},"end":{"line":53,"column":74}},"23":{"start":{"line":54,"column":4},"end":{"line":54,"column":11}},"24":{"start":{"line":56,"column":2},"end":{"line":56,"column":12}},"25":{"start":{"line":57,"column":2},"end":{"line":59,"column":3}},"26":{"start":{"line":58,"column":4},"end":{"line":58,"column":24}},"27":{"start":{"line":60,"column":2},"end":{"line":64,"column":3}},"28":{"start":{"line":61,"column":4},"end":{"line":61,"column":39}},"29":{"start":{"line":63,"column":4},"end":{"line":63,"column":14}},"30":{"start":{"line":65,"column":2},"end":{"line":65,"column":44}},"31":{"start":{"line":66,"column":2},"end":{"line":68,"column":3}},"32":{"start":{"line":67,"column":4},"end":{"line":67,"column":14}},"33":{"start":{"line":69,"column":2},"end":{"line":69,"column":37}},"34":{"start":{"line":80,"column":0},"end":{"line":129,"column":2}},"35":{"start":{"line":81,"column":2},"end":{"line":81,"column":55}},"36":{"start":{"line":82,"column":2},"end":{"line":85,"column":3}},"37":{"start":{"line":83,"column":4},"end":{"line":83,"column":74}},"38":{"start":{"line":84,"column":4},"end":{"line":84,"column":11}},"39":{"start":{"line":86,"column":2},"end":{"line":86,"column":20}},"40":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"41":{"start":{"line":88,"column":4},"end":{"line":88,"column":25}},"42":{"start":{"line":90,"column":2},"end":{"line":96,"column":3}},"43":{"start":{"line":91,"column":4},"end":{"line":91,"column":46}},"44":{"start":{"line":92,"column":4},"end":{"line":92,"column":48}},"45":{"start":{"line":94,"column":4},"end":{"line":94,"column":15}},"46":{"start":{"line":95,"column":4},"end":{"line":95,"column":15}},"47":{"start":{"line":97,"column":2},"end":{"line":106,"column":4}},"48":{"start":{"line":98,"column":4},"end":{"line":98,"column":23}},"49":{"start":{"line":99,"column":4},"end":{"line":104,"column":5}},"50":{"start":{"line":100,"column":6},"end":{"line":100,"column":55}},"51":{"start":{"line":101,"column":6},"end":{"line":103,"column":7}},"52":{"start":{"line":102,"column":8},"end":{"line":102,"column":34}},"53":{"start":{"line":105,"column":4},"end":{"line":105,"column":21}},"54":{"start":{"line":107,"column":2},"end":{"line":128,"column":3}},"55":{"start":{"line":108,"column":4},"end":{"line":108,"column":41}},"56":{"start":{"line":109,"column":4},"end":{"line":118,"column":5}},"57":{"start":{"line":110,"column":6},"end":{"line":110,"column":26}},"58":{"start":{"line":111,"column":6},"end":{"line":117,"column":7}},"59":{"start":{"line":112,"column":8},"end":{"line":112,"column":32}},"60":{"start":{"line":113,"column":8},"end":{"line":116,"column":9}},"61":{"start":{"line":114,"column":10},"end":{"line":114,"column":61}},"62":{"start":{"line":115,"column":10},"end":{"line":115,"column":17}},"63":{"start":{"line":119,"column":4},"end":{"line":119,"column":57}},"64":{"start":{"line":120,"column":4},"end":{"line":127,"column":5}},"65":{"start":{"line":121,"column":6},"end":{"line":124,"column":8}},"66":{"start":{"line":125,"column":6},"end":{"line":125,"column":26}},"67":{"start":{"line":126,"column":6},"end":{"line":126,"column":13}},"68":{"start":{"line":139,"column":0},"end":{"line":178,"column":2}},"69":{"start":{"line":140,"column":2},"end":{"line":140,"column":55}},"70":{"start":{"line":141,"column":2},"end":{"line":143,"column":3}},"71":{"start":{"line":142,"column":4},"end":{"line":142,"column":81}},"72":{"start":{"line":144,"column":2},"end":{"line":144,"column":19}},"73":{"start":{"line":145,"column":2},"end":{"line":147,"column":3}},"74":{"start":{"line":146,"column":4},"end":{"line":146,"column":24}},"75":{"start":{"line":148,"column":2},"end":{"line":162,"column":3}},"76":{"start":{"line":149,"column":4},"end":{"line":155,"column":5}},"77":{"start":{"line":150,"column":6},"end":{"line":150,"column":57}},"78":{"start":{"line":151,"column":6},"end":{"line":153,"column":7}},"79":{"start":{"line":152,"column":8},"end":{"line":152,"column":47}},"80":{"start":{"line":154,"column":6},"end":{"line":154,"column":26}},"81":{"start":{"line":157,"column":4},"end":{"line":157,"column":36}},"82":{"start":{"line":158,"column":4},"end":{"line":161,"column":5}},"83":{"start":{"line":159,"column":6},"end":{"line":159,"column":49}},"84":{"start":{"line":160,"column":6},"end":{"line":160,"column":22}},"85":{"start":{"line":163,"column":2},"end":{"line":163,"column":14}},"86":{"start":{"line":164,"column":2},"end":{"line":164,"column":35}},"87":{"start":{"line":165,"column":2},"end":{"line":173,"column":3}},"88":{"start":{"line":166,"column":4},"end":{"line":172,"column":5}},"89":{"start":{"line":167,"column":6},"end":{"line":167,"column":29}},"90":{"start":{"line":168,"column":6},"end":{"line":168,"column":14}},"91":{"start":{"line":169,"column":6},"end":{"line":169,"column":26}},"92":{"start":{"line":170,"column":11},"end":{"line":172,"column":5}},"93":{"start":{"line":171,"column":6},"end":{"line":171,"column":26}},"94":{"start":{"line":174,"column":2},"end":{"line":174,"column":52}},"95":{"start":{"line":175,"column":2},"end":{"line":175,"column":27}},"96":{"start":{"line":176,"column":2},"end":{"line":176,"column":44}},"97":{"start":{"line":177,"column":2},"end":{"line":177,"column":21}},"98":{"start":{"line":188,"column":0},"end":{"line":210,"column":2}},"99":{"start":{"line":189,"column":2},"end":{"line":189,"column":55}},"100":{"start":{"line":190,"column":2},"end":{"line":192,"column":3}},"101":{"start":{"line":191,"column":4},"end":{"line":191,"column":81}},"102":{"start":{"line":194,"column":2},"end":{"line":194,"column":17}},"103":{"start":{"line":195,"column":2},"end":{"line":197,"column":3}},"104":{"start":{"line":196,"column":4},"end":{"line":196,"column":24}},"105":{"start":{"line":198,"column":2},"end":{"line":203,"column":3}},"106":{"start":{"line":199,"column":4},"end":{"line":199,"column":52}},"107":{"start":{"line":201,"column":4},"end":{"line":201,"column":42}},"108":{"start":{"line":202,"column":4},"end":{"line":202,"column":51}},"109":{"start":{"line":204,"column":2},"end":{"line":204,"column":50}},"110":{"start":{"line":205,"column":2},"end":{"line":205,"column":62}},"111":{"start":{"line":206,"column":2},"end":{"line":206,"column":31}},"112":{"start":{"line":207,"column":2},"end":{"line":209,"column":4}},"113":{"start":{"line":212,"column":0},"end":{"line":219,"column":2}}},"branchMap":{"1":{"line":15,"type":"if","locations":[{"start":{"line":15,"column":2},"end":{"line":15,"column":2}},{"start":{"line":15,"column":2},"end":{"line":15,"column":2}}]},"2":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":6},"end":{"line":15,"column":11}},{"start":{"line":15,"column":15},"end":{"line":15,"column":27}}]},"3":{"line":19,"type":"cond-expr","locations":[{"start":{"line":19,"column":23},"end":{"line":19,"column":40}},{"start":{"line":19,"column":44},"end":{"line":19,"column":46}}]},"4":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":23},"end":{"line":19,"column":34}},{"start":{"line":19,"column":38},"end":{"line":19,"column":40}}]},"5":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":2},"end":{"line":34,"column":2}},{"start":{"line":34,"column":2},"end":{"line":34,"column":2}}]},"6":{"line":34,"type":"binary-expr","locations":[{"start":{"line":34,"column":6},"end":{"line":34,"column":14}},{"start":{"line":34,"column":18},"end":{"line":34,"column":33}}]},"7":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":52,"column":2}},{"start":{"line":52,"column":2},"end":{"line":52,"column":2}}]},"8":{"line":52,"type":"binary-expr","locations":[{"start":{"line":52,"column":6},"end":{"line":52,"column":14}},{"start":{"line":52,"column":18},"end":{"line":52,"column":33}}]},"9":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":57,"column":2}},{"start":{"line":57,"column":2},"end":{"line":57,"column":2}}]},"10":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":60,"column":2}},{"start":{"line":60,"column":2},"end":{"line":60,"column":2}}]},"11":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":2},"end":{"line":66,"column":2}},{"start":{"line":66,"column":2},"end":{"line":66,"column":2}}]},"12":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":2},"end":{"line":82,"column":2}},{"start":{"line":82,"column":2},"end":{"line":82,"column":2}}]},"13":{"line":82,"type":"binary-expr","locations":[{"start":{"line":82,"column":6},"end":{"line":82,"column":14}},{"start":{"line":82,"column":18},"end":{"line":82,"column":33}}]},"14":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"15":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":2},"end":{"line":90,"column":2}},{"start":{"line":90,"column":2},"end":{"line":90,"column":2}}]},"16":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":6},"end":{"line":101,"column":6}},{"start":{"line":101,"column":6},"end":{"line":101,"column":6}}]},"17":{"line":101,"type":"binary-expr","locations":[{"start":{"line":101,"column":10},"end":{"line":101,"column":25}},{"start":{"line":101,"column":29},"end":{"line":101,"column":54}}]},"18":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":4},"end":{"line":109,"column":4}},{"start":{"line":109,"column":4},"end":{"line":109,"column":4}}]},"19":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":6},"end":{"line":111,"column":6}},{"start":{"line":111,"column":6},"end":{"line":111,"column":6}}]},"20":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":8},"end":{"line":113,"column":8}},{"start":{"line":113,"column":8},"end":{"line":113,"column":8}}]},"21":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":4},"end":{"line":120,"column":4}},{"start":{"line":120,"column":4},"end":{"line":120,"column":4}}]},"22":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":2},"end":{"line":141,"column":2}},{"start":{"line":141,"column":2},"end":{"line":141,"column":2}}]},"23":{"line":141,"type":"binary-expr","locations":[{"start":{"line":141,"column":6},"end":{"line":141,"column":14}},{"start":{"line":141,"column":18},"end":{"line":141,"column":33}}]},"24":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":2},"end":{"line":145,"column":2}},{"start":{"line":145,"column":2},"end":{"line":145,"column":2}}]},"25":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":2},"end":{"line":148,"column":2}},{"start":{"line":148,"column":2},"end":{"line":148,"column":2}}]},"26":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":6},"end":{"line":151,"column":6}},{"start":{"line":151,"column":6},"end":{"line":151,"column":6}}]},"27":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":166,"column":4}},{"start":{"line":166,"column":4},"end":{"line":166,"column":4}}]},"28":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":11},"end":{"line":170,"column":11}},{"start":{"line":170,"column":11},"end":{"line":170,"column":11}}]},"29":{"line":190,"type":"if","locations":[{"start":{"line":190,"column":2},"end":{"line":190,"column":2}},{"start":{"line":190,"column":2},"end":{"line":190,"column":2}}]},"30":{"line":190,"type":"binary-expr","locations":[{"start":{"line":190,"column":6},"end":{"line":190,"column":14}},{"start":{"line":190,"column":18},"end":{"line":190,"column":33}}]},"31":{"line":195,"type":"if","locations":[{"start":{"line":195,"column":2},"end":{"line":195,"column":2}},{"start":{"line":195,"column":2},"end":{"line":195,"column":2}}]},"32":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":2},"end":{"line":198,"column":2}},{"start":{"line":198,"column":2},"end":{"line":198,"column":2}}]},"33":{"line":205,"type":"binary-expr","locations":[{"start":{"line":205,"column":14},"end":{"line":205,"column":38}},{"start":{"line":205,"column":42},"end":{"line":205,"column":61}}]}},"code":["var ConsistentHash = require('../util/consistentHash');","var utils = require('../util/utils');","var crc = require('crc');","","/**"," * Calculate route info and return an appropriate server id."," *"," * @param session {Object} session object for current rpc request"," * @param msg {Object} rpc message. {serverType, service, method, args, opts}"," * @param context {Object} context of client"," * @param cb(err, serverId)"," */","var defRoute = function(session, msg, context, cb) {","  var list = context.getServersByType(msg.serverType);","  if (!list || !list.length) {","    cb(new Error('can not find server info for type:' + msg.serverType));","    return;","  }","  var uid = session ? (session.uid || '') : '';","  var index = Math.abs(crc.crc32(uid.toString())) % list.length;","  cb(null, list[index].id);","};","","/**"," * Random algorithm for calculating server id."," *"," * @param client {Object} rpc client."," * @param serverType {String} rpc target serverType."," * @param msg {Object} rpc message."," * @param cb {Function} cb(err, serverId)."," */","var rdRoute = function(client, serverType, msg, cb) {","  var servers = client._station.serversMap[serverType];","  if (!servers || !servers.length) {","    cb(new Error('rpc servers not exist with serverType: ' + serverType));","    return;","  }","  var index = Math.floor(Math.random() * servers.length);","  cb(null, servers[index]);","};","","/**"," * Round-Robin algorithm for calculating server id."," *"," * @param client {Object} rpc client."," * @param serverType {String} rpc target serverType."," * @param msg {Object} rpc message."," * @param cb {Function} cb(err, serverId)."," */","var rrRoute = function(client, serverType, msg, cb) {","  var servers = client._station.serversMap[serverType];","  if (!servers || !servers.length) {","    cb(new Error('rpc servers not exist with serverType: ' + serverType));","    return;","  }","  var index;","  if (!client.rrParam) {","    client.rrParam = {};","  }","  if (!!client.rrParam[serverType]) {","    index = client.rrParam[serverType];","  } else {","    index = 0;","  }","  cb(null, servers[index % servers.length]);","  if (index++ === Number.MAX_VALUE) {","    index = 0;","  }","  client.rrParam[serverType] = index;","};","","/**"," * Weight-Round-Robin algorithm for calculating server id."," *"," * @param client {Object} rpc client."," * @param serverType {String} rpc target serverType."," * @param msg {Object} rpc message."," * @param cb {Function} cb(err, serverId)."," */","var wrrRoute = function(client, serverType, msg, cb) {","  var servers = client._station.serversMap[serverType];","  if (!servers || !servers.length) {","    cb(new Error('rpc servers not exist with serverType: ' + serverType));","    return;","  }","  var index, weight;","  if (!client.wrrParam) {","    client.wrrParam = {};","  }","  if (!!client.wrrParam[serverType]) {","    index = client.wrrParam[serverType].index;","    weight = client.wrrParam[serverType].weight;","  } else {","    index = -1;","    weight = 0;","  }","  var getMaxWeight = function() {","    var maxWeight = -1;","    for (var i = 0; i < servers.length; i++) {","      var server = client._station.servers[servers[i]];","      if (!!server.weight && server.weight > maxWeight) {","        maxWeight = server.weight;","      }","    }","    return maxWeight;","  };","  while (true) {","    index = (index + 1) % servers.length;","    if (index === 0) {","      weight = weight - 1;","      if (weight <= 0) {","        weight = getMaxWeight();","        if (weight <= 0) {","          cb(new Error('rpc wrr route get invalid weight.'));","          return;","        }","      }","    }","    var server = client._station.servers[servers[index]];","    if (server.weight >= weight) {","      client.wrrParam[serverType] = {","        index: index,","        weight: weight","      };","      cb(null, server.id);","      return;","    }","  }","};","","/**"," * Least-Active algorithm for calculating server id."," *"," * @param client {Object} rpc client."," * @param serverType {String} rpc target serverType."," * @param msg {Object} rpc message."," * @param cb {Function} cb(err, serverId)."," */","var laRoute = function(client, serverType, msg, cb) {","  var servers = client._station.serversMap[serverType];","  if (!servers || !servers.length) {","    return cb(new Error('rpc servers not exist with serverType: ' + serverType));","  }","  var actives = [];","  if (!client.laParam) {","    client.laParam = {};","  }","  if (!!client.laParam[serverType]) {","    for (var j = 0; j < servers.length; j++) {","      var count = client.laParam[serverType][servers[j]];","      if (!count) {","        client.laParam[servers[j]] = count = 0;","      }","      actives.push(count);","    }","  } else {","    client.laParam[serverType] = {};","    for (var i = 0; i < servers.length; i++) {","      client.laParam[serverType][servers[i]] = 0;","      actives.push(0);","    }","  }","  var rs = [];","  var minInvoke = Number.MAX_VALUE;","  for (var k = 0; k < actives.length; k++) {","    if (actives[k] < minInvoke) {","      minInvoke = actives[k];","      rs = [];","      rs.push(servers[k]);","    } else if (actives[k] === minInvoke) {","      rs.push(servers[k]);","    }","  }","  var index = Math.floor(Math.random() * rs.length);","  var serverId = rs[index];","  client.laParam[serverType][serverId] += 1;","  cb(null, serverId);","};","","/**"," * Consistent-Hash algorithm for calculating server id."," *"," * @param client {Object} rpc client."," * @param serverType {String} rpc target serverType."," * @param msg {Object} rpc message."," * @param cb {Function} cb(err, serverId)."," */","var chRoute = function(client, serverType, msg, cb) {","  var servers = client._station.serversMap[serverType];","  if (!servers || !servers.length) {","    return cb(new Error('rpc servers not exist with serverType: ' + serverType));","  }","","  var index, con;","  if (!client.chParam) {","    client.chParam = {};","  }","  if (!!client.chParam[serverType]) {","    con = client.chParam[serverType].consistentHash;","  } else {","    client.opts.station = client._station;","    con = new ConsistentHash(servers, client.opts);","  }","  var hashFieldIndex = client.opts.hashFieldIndex;","  var field = msg.args[hashFieldIndex] || JSON.stringify(msg);","  cb(null, con.getNode(field));","  client.chParam[serverType] = {","    consistentHash: con","  };","};","","module.exports = {","  rr: rrRoute,","  wrr: wrrRoute,","  la: laRoute,","  ch: chRoute,","  rd: rdRoute,","  df: defRoute","};"],"l":{"1":1,"2":1,"3":1,"13":1,"14":0,"15":0,"16":0,"17":0,"19":0,"20":0,"21":0,"32":1,"33":0,"34":0,"35":0,"36":0,"38":0,"39":0,"50":1,"51":0,"52":0,"53":0,"54":0,"56":0,"57":0,"58":0,"60":0,"61":0,"63":0,"65":0,"66":0,"67":0,"69":0,"80":1,"81":0,"82":0,"83":0,"84":0,"86":0,"87":0,"88":0,"90":0,"91":0,"92":0,"94":0,"95":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"105":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"119":0,"120":0,"121":0,"125":0,"126":0,"139":1,"140":0,"141":0,"142":0,"144":0,"145":0,"146":0,"148":0,"149":0,"150":0,"151":0,"152":0,"154":0,"157":0,"158":0,"159":0,"160":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"174":0,"175":0,"176":0,"177":0,"188":1,"189":0,"190":0,"191":0,"194":0,"195":0,"196":0,"198":0,"199":0,"201":0,"202":0,"204":0,"205":0,"206":0,"207":0,"212":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/consistentHash.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/util/consistentHash.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":1,"61":0,"62":1,"63":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":43}}},"2":{"name":"(anonymous_2)","line":22,"loc":{"start":{"line":22,"column":35},"end":{"line":22,"column":50}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":38},"end":{"line":32,"column":53}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":35},"end":{"line":52,"column":49}}},"5":{"name":"(anonymous_5)","line":61,"loc":{"start":{"line":61,"column":43},"end":{"line":61,"column":60}}},"6":{"name":"(anonymous_6)","line":92,"loc":{"start":{"line":92,"column":20},"end":{"line":92,"column":34}}},"7":{"name":"(anonymous_7)","line":96,"loc":{"start":{"line":96,"column":11},"end":{"line":96,"column":36}}},"8":{"name":"(anonymous_8)","line":100,"loc":{"start":{"line":100,"column":14},"end":{"line":100,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":3,"column":0},"end":{"line":18,"column":2}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":25}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":44}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":48}},"6":{"start":{"line":7,"column":2},"end":{"line":7,"column":35}},"7":{"start":{"line":8,"column":2},"end":{"line":8,"column":17}},"8":{"start":{"line":9,"column":2},"end":{"line":9,"column":17}},"9":{"start":{"line":10,"column":2},"end":{"line":10,"column":18}},"10":{"start":{"line":12,"column":2},"end":{"line":14,"column":3}},"11":{"start":{"line":13,"column":4},"end":{"line":13,"column":27}},"12":{"start":{"line":16,"column":2},"end":{"line":16,"column":56}},"13":{"start":{"line":17,"column":2},"end":{"line":17,"column":62}},"14":{"start":{"line":20,"column":0},"end":{"line":20,"column":32}},"15":{"start":{"line":22,"column":0},"end":{"line":30,"column":2}},"16":{"start":{"line":23,"column":2},"end":{"line":23,"column":24}},"17":{"start":{"line":24,"column":2},"end":{"line":28,"column":3}},"18":{"start":{"line":25,"column":4},"end":{"line":25,"column":64}},"19":{"start":{"line":26,"column":4},"end":{"line":26,"column":24}},"20":{"start":{"line":27,"column":4},"end":{"line":27,"column":26}},"21":{"start":{"line":29,"column":2},"end":{"line":29,"column":19}},"22":{"start":{"line":32,"column":0},"end":{"line":50,"column":2}},"23":{"start":{"line":33,"column":2},"end":{"line":38,"column":3}},"24":{"start":{"line":34,"column":4},"end":{"line":37,"column":5}},"25":{"start":{"line":35,"column":6},"end":{"line":35,"column":30}},"26":{"start":{"line":36,"column":6},"end":{"line":36,"column":10}},"27":{"start":{"line":40,"column":2},"end":{"line":49,"column":3}},"28":{"start":{"line":41,"column":4},"end":{"line":41,"column":64}},"29":{"start":{"line":42,"column":4},"end":{"line":42,"column":26}},"30":{"start":{"line":43,"column":4},"end":{"line":48,"column":5}},"31":{"start":{"line":44,"column":6},"end":{"line":47,"column":7}},"32":{"start":{"line":45,"column":8},"end":{"line":45,"column":31}},"33":{"start":{"line":46,"column":8},"end":{"line":46,"column":12}},"34":{"start":{"line":52,"column":0},"end":{"line":59,"column":2}},"35":{"start":{"line":53,"column":2},"end":{"line":55,"column":3}},"36":{"start":{"line":54,"column":4},"end":{"line":54,"column":13}},"37":{"start":{"line":56,"column":2},"end":{"line":56,"column":41}},"38":{"start":{"line":57,"column":2},"end":{"line":57,"column":41}},"39":{"start":{"line":58,"column":2},"end":{"line":58,"column":35}},"40":{"start":{"line":61,"column":0},"end":{"line":90,"column":2}},"41":{"start":{"line":62,"column":2},"end":{"line":62,"column":43}},"42":{"start":{"line":63,"column":2},"end":{"line":63,"column":16}},"43":{"start":{"line":64,"column":2},"end":{"line":64,"column":14}},"44":{"start":{"line":65,"column":2},"end":{"line":65,"column":15}},"45":{"start":{"line":67,"column":2},"end":{"line":69,"column":3}},"46":{"start":{"line":68,"column":4},"end":{"line":68,"column":13}},"47":{"start":{"line":72,"column":2},"end":{"line":83,"column":3}},"48":{"start":{"line":73,"column":4},"end":{"line":73,"column":42}},"49":{"start":{"line":74,"column":4},"end":{"line":74,"column":43}},"50":{"start":{"line":76,"column":4},"end":{"line":82,"column":5}},"51":{"start":{"line":77,"column":6},"end":{"line":77,"column":17}},"52":{"start":{"line":78,"column":11},"end":{"line":82,"column":5}},"53":{"start":{"line":79,"column":6},"end":{"line":79,"column":22}},"54":{"start":{"line":81,"column":6},"end":{"line":81,"column":22}},"55":{"start":{"line":85,"column":2},"end":{"line":87,"column":3}},"56":{"start":{"line":86,"column":4},"end":{"line":86,"column":41}},"57":{"start":{"line":89,"column":2},"end":{"line":89,"column":15}},"58":{"start":{"line":92,"column":0},"end":{"line":94,"column":2}},"59":{"start":{"line":93,"column":2},"end":{"line":93,"column":33}},"60":{"start":{"line":96,"column":0},"end":{"line":98,"column":2}},"61":{"start":{"line":97,"column":2},"end":{"line":97,"column":64}},"62":{"start":{"line":100,"column":0},"end":{"line":102,"column":2}},"63":{"start":{"line":101,"column":2},"end":{"line":101,"column":40}}},"branchMap":{"1":{"line":4,"type":"binary-expr","locations":[{"start":{"line":4,"column":14},"end":{"line":4,"column":18}},{"start":{"line":4,"column":22},"end":{"line":4,"column":24}}]},"2":{"line":5,"type":"binary-expr","locations":[{"start":{"line":5,"column":18},"end":{"line":5,"column":36}},{"start":{"line":5,"column":40},"end":{"line":5,"column":43}}]},"3":{"line":6,"type":"binary-expr","locations":[{"start":{"line":6,"column":19},"end":{"line":6,"column":38}},{"start":{"line":6,"column":42},"end":{"line":6,"column":47}}]},"4":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":36},"end":{"line":25,"column":43}},{"start":{"line":25,"column":47},"end":{"line":25,"column":51}}]},"5":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":34,"column":4}},{"start":{"line":34,"column":4},"end":{"line":34,"column":4}}]},"6":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":36},"end":{"line":41,"column":43}},{"start":{"line":41,"column":47},"end":{"line":41,"column":51}}]},"7":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":6},"end":{"line":44,"column":6}},{"start":{"line":44,"column":6},"end":{"line":44,"column":6}}]},"8":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":53,"column":2}},{"start":{"line":53,"column":2},"end":{"line":53,"column":2}}]},"9":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":2},"end":{"line":67,"column":2}},{"start":{"line":67,"column":2},"end":{"line":67,"column":2}}]},"10":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":4},"end":{"line":76,"column":4}},{"start":{"line":76,"column":4},"end":{"line":76,"column":4}}]},"11":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":11},"end":{"line":78,"column":11}},{"start":{"line":78,"column":11},"end":{"line":78,"column":11}}]},"12":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":2},"end":{"line":85,"column":2}},{"start":{"line":85,"column":2},"end":{"line":85,"column":2}}]},"13":{"line":101,"type":"cond-expr","locations":[{"start":{"line":101,"column":19},"end":{"line":101,"column":20}},{"start":{"line":101,"column":23},"end":{"line":101,"column":39}}]},"14":{"line":101,"type":"cond-expr","locations":[{"start":{"line":101,"column":33},"end":{"line":101,"column":35}},{"start":{"line":101,"column":38},"end":{"line":101,"column":39}}]}},"code":["var crypto = require('crypto');","","var ConsistentHash = function(nodes, opts) {","  this.opts = opts || {};","  this.replicas = this.opts.replicas || 100;","  this.algorithm = this.opts.algorithm || 'md5';","  this.station = this.opts.station;","  this.ring = {};","  this.keys = [];","  this.nodes = [];","","  for (var i = 0; i < nodes.length; i++) {","    this.addNode(nodes[i]);","  }","","  this.station.on('addServer', this.addNode.bind(this));","  this.station.on('removeServer', this.removeNode.bind(this));","};","","module.exports = ConsistentHash;","","ConsistentHash.prototype.addNode = function(node) {","  this.nodes.push(node);","  for (var i = 0; i < this.replicas; i++) {","    var key = hash(this.algorithm, (node.id || node) + ':' + i);","    this.keys.push(key);","    this.ring[key] = node;","  }","  this.keys.sort();","};","","ConsistentHash.prototype.removeNode = function(node) {","  for (var i = 0; i < this.nodes.length; i++) {","    if (this.nodes[i] === node) {","      this.nodes.splice(i, 1);","      i--;","    }","  }","","  for (var j = 0; j < this.replicas; j++) {","    var key = hash(this.algorithm, (node.id || node) + ':' + j);","    delete this.ring[key];","    for (var k = 0; k < this.keys.length; k++) {","      if (this.keys[k] === key) {","        this.keys.splice(k, 1);","        k--;","      }","    }","  }","};","","ConsistentHash.prototype.getNode = function(key) {","  if (getKeysLength(this.ring) === 0) {","    return 0;","  }","  var result = hash(this.algorithm, key);","  var pos = this.getNodePosition(result);","  return this.ring[this.keys[pos]];","};","","ConsistentHash.prototype.getNodePosition = function(result) {","  var upper = getKeysLength(this.ring) - 1;","  var lower = 0;","  var idx = 0;","  var comp = 0;","","  if (upper === 0) {","    return 0;","  }","","  //binary search","  while (lower <= upper) {","    idx = Math.floor((lower + upper) / 2);","    comp = compare(this.keys[idx], result);","","    if (comp === 0) {","      return idx;","    } else if (comp > 0) {","      upper = idx - 1;","    } else {","      lower = idx + 1;","    }","  }","","  if (upper < 0) {","    upper = getKeysLength(this.ring) - 1;","  }","","  return upper;","};","","var getKeysLength = function(map) {","  return Object.keys(map).length;","};","","var hash = function(algorithm, str) {","  return crypto.createHash(algorithm).update(str).digest('hex');","};","","var compare = function(v1, v2) {","  return v1 > v2 ? 1 : v1 < v2 ? -1 : 0;","};"],"l":{"1":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"12":0,"13":0,"16":0,"17":0,"20":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"29":0,"32":1,"33":0,"34":0,"35":0,"36":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"52":1,"53":0,"54":0,"56":0,"57":0,"58":0,"61":1,"62":0,"63":0,"64":0,"65":0,"67":0,"68":0,"72":0,"73":0,"74":0,"76":0,"77":0,"78":0,"79":0,"81":0,"85":0,"86":0,"89":0,"92":1,"93":0,"96":1,"97":0,"100":1,"101":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/node_modules/async/lib/async.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/node_modules/async/lib/async.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":1,"31":0,"32":1,"33":0,"34":0,"35":1,"36":0,"37":1,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":1,"54":0,"55":0,"56":1,"57":0,"58":0,"59":0,"60":0,"61":1,"62":0,"63":0,"64":0,"65":0,"66":0,"67":1,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":1,"82":6,"83":6,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1,"92":0,"93":0,"94":1,"95":1,"96":0,"97":0,"98":1,"99":1,"100":0,"101":1,"102":1,"103":0,"104":1,"105":0,"106":1,"107":0,"108":1,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":1,"119":0,"120":0,"121":0,"122":0,"123":0,"124":1,"125":0,"126":0,"127":0,"128":0,"129":1,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":1,"145":0,"146":1,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":1,"174":4,"175":0,"176":1,"177":3,"178":0,"179":1,"180":4,"181":0,"182":1,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":1,"192":1,"193":1,"194":1,"195":0,"196":0,"197":0,"198":0,"199":0,"200":1,"201":0,"202":0,"203":1,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":1,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":1,"222":1,"223":1,"224":1,"225":0,"226":0,"227":0,"228":1,"229":1,"230":1,"231":1,"232":7,"233":1,"234":0,"235":0,"236":1,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":1,"250":1,"251":1,"252":1,"253":1,"254":0,"255":1,"256":1,"257":1,"258":1,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":1,"269":0,"270":0,"271":1,"272":0,"273":0,"274":0,"275":0,"276":0,"277":0,"278":0,"279":0,"280":0,"281":0,"282":0,"283":0,"284":0,"285":0,"286":1,"287":0,"288":1,"289":0,"290":0,"291":0,"292":1,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"308":0,"309":0,"310":0,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"321":0,"322":0,"323":0,"324":1,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"331":1,"332":0,"333":0,"334":0,"335":0,"336":1,"337":0,"338":0,"339":0,"340":0,"341":1,"342":0,"343":0,"344":0,"345":0,"346":0,"347":0,"348":0,"349":0,"350":0,"351":0,"352":0,"353":0,"354":0,"355":0,"356":0,"357":0,"358":1,"359":1,"360":0,"361":0,"362":0,"363":1,"364":0,"365":0,"366":0,"367":0,"368":0,"369":0,"370":0,"371":0,"372":0,"373":0,"374":0,"375":0,"376":1,"377":0,"378":0,"379":0,"380":0,"381":0,"382":0,"383":1,"384":0,"385":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0,"393":1,"394":0,"395":0,"396":0,"397":0,"398":0,"399":0,"400":0,"401":0,"402":0,"403":1,"404":0,"405":1,"406":0,"407":1,"408":0,"409":1,"410":1,"411":1,"412":0,"413":0,"414":0,"415":0,"416":0,"417":0,"418":0,"419":1,"420":0,"421":0,"422":1,"423":0,"424":0,"425":0,"426":0,"427":0,"428":0,"429":1,"430":1,"431":1,"432":0,"433":0,"434":0,"435":0,"436":0,"437":0,"438":0,"439":0,"440":0,"441":0,"442":1,"443":0,"444":0,"445":0,"446":1,"447":0,"448":0,"449":1,"450":0,"451":0,"452":1,"453":0,"454":0,"455":0,"456":0,"457":0,"458":0,"459":0,"460":0,"461":0,"462":0,"463":0,"464":0,"465":0,"466":1,"467":0,"468":0,"469":0,"470":0,"471":0,"472":1,"473":0,"474":0,"475":0,"476":0,"477":1,"478":0,"479":0,"480":0,"481":0,"482":0,"483":0,"484":0,"485":0,"486":0,"487":0,"488":0,"489":0,"490":0,"491":0,"492":0,"493":0,"494":1,"495":0,"496":0,"497":0,"498":0,"499":0,"500":0,"501":0,"502":0,"503":0,"504":0,"505":0,"506":0,"507":0,"508":0,"509":0,"510":0,"511":0,"512":0,"513":0,"514":0,"515":0,"516":0,"517":0,"518":0,"519":0,"520":0,"521":0,"522":0,"523":0,"524":0,"525":0,"526":0,"527":0,"528":0,"529":0,"530":0,"531":0,"532":0,"533":0,"534":0,"535":0,"536":0,"537":1,"538":0,"539":0,"540":0,"541":1,"542":1,"543":0,"544":1,"545":0,"546":0,"547":0,"548":0,"549":0,"550":0,"551":0,"552":1,"553":0,"554":0,"555":0,"556":0,"557":0,"558":0,"559":0,"560":0,"561":0,"562":0,"563":0,"564":0,"565":0,"566":0,"567":0,"568":0,"569":0,"570":0,"571":0,"572":1,"573":0,"574":1,"575":2,"576":0,"577":0,"578":0,"579":0,"580":0,"581":0,"582":0,"583":0,"584":1,"585":1,"586":1,"587":0,"588":0,"589":0,"590":0,"591":0,"592":0,"593":0,"594":0,"595":0,"596":0,"597":0,"598":0,"599":0,"600":0,"601":0,"602":0,"603":0,"604":0,"605":0,"606":0,"607":0,"608":0,"609":1,"610":0,"611":0,"612":1,"613":2,"614":0,"615":1,"616":1,"617":1,"618":0,"619":1,"620":0,"621":0,"622":0,"623":0,"624":0,"625":0,"626":0,"627":0,"628":0,"629":0,"630":0,"631":1,"632":0,"633":1,"634":2,"635":0,"636":0,"637":0,"638":0,"639":0,"640":0,"641":0,"642":0,"643":1,"644":1,"645":1,"646":0,"647":0,"648":1,"649":0,"650":0,"651":0,"652":0,"653":1,"654":0,"655":0,"656":0,"657":0,"658":0,"659":0,"660":0,"661":0,"662":0,"663":0,"664":0,"665":1,"666":1,"667":0,"668":0,"669":0,"670":1,"671":0,"672":0,"673":0,"674":0,"675":0,"676":0,"677":0,"678":0,"679":0,"680":0,"681":0,"682":1,"683":1,"684":0,"685":0,"686":0,"687":0},"b":{"1":[1,0,0,1,1,1,0],"2":[1,0],"3":[0,0],"4":[0,0],"5":[1,0],"6":[0,0,0],"7":[0,0,0,0],"8":[0,0],"9":[1,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[6,0],"15":[0,0],"16":[1,1],"17":[1,0],"18":[1,0],"19":[1,1],"20":[1,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0],"78":[0,0],"79":[0,0],"80":[0,0],"81":[0,0],"82":[0,0],"83":[0,0],"84":[0,0],"85":[0,0],"86":[0,0],"87":[0,0],"88":[0,0],"89":[0,0],"90":[0,0],"91":[0,0],"92":[0,0],"93":[0,0],"94":[0,0],"95":[0,0],"96":[0,0],"97":[0,0],"98":[0,0],"99":[0,0],"100":[0,0],"101":[0,0],"102":[0,0],"103":[0,0],"104":[0,0],"105":[0,0],"106":[0,0],"107":[0,0],"108":[0,0],"109":[0,0],"110":[0,0],"111":[0,0],"112":[0,0],"113":[0,0],"114":[0,0],"115":[0,0],"116":[0,0],"117":[0,0],"118":[0,0],"119":[0,0],"120":[0,0],"121":[0,0],"122":[0,0],"123":[0,0,0],"124":[0,0],"125":[0,0],"126":[0,0],"127":[0,0],"128":[0,0],"129":[0,0],"130":[0,0],"131":[0,0],"132":[0,0],"133":[0,0],"134":[0,0],"135":[0,0],"136":[0,0],"137":[0,0],"138":[0,0],"139":[0,0],"140":[0,0],"141":[0,0],"142":[0,0],"143":[0,0],"144":[0,0],"145":[0,0],"146":[0,0],"147":[0,0],"148":[0,0],"149":[0,0],"150":[1,0],"151":[1,1],"152":[0,0],"153":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":6,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":4,"47":0,"48":3,"49":0,"50":4,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":7,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":2,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":2,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":2,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":1},"end":{"line":8,"column":13}}},"2":{"name":"noop","line":11,"loc":{"start":{"line":11,"column":4},"end":{"line":11,"column":20}}},"3":{"name":"identity","line":12,"loc":{"start":{"line":12,"column":4},"end":{"line":12,"column":25}}},"4":{"name":"toBool","line":15,"loc":{"start":{"line":15,"column":4},"end":{"line":15,"column":23}}},"5":{"name":"notId","line":18,"loc":{"start":{"line":18,"column":4},"end":{"line":18,"column":22}}},"6":{"name":"(anonymous_6)","line":36,"loc":{"start":{"line":36,"column":23},"end":{"line":36,"column":35}}},"7":{"name":"only_once","line":41,"loc":{"start":{"line":41,"column":4},"end":{"line":41,"column":27}}},"8":{"name":"(anonymous_8)","line":42,"loc":{"start":{"line":42,"column":15},"end":{"line":42,"column":26}}},"9":{"name":"_once","line":49,"loc":{"start":{"line":49,"column":4},"end":{"line":49,"column":23}}},"10":{"name":"(anonymous_10)","line":50,"loc":{"start":{"line":50,"column":15},"end":{"line":50,"column":26}}},"11":{"name":"(anonymous_11)","line":61,"loc":{"start":{"line":61,"column":36},"end":{"line":61,"column":51}}},"12":{"name":"(anonymous_12)","line":66,"loc":{"start":{"line":66,"column":20},"end":{"line":66,"column":34}}},"13":{"name":"_isArrayLike","line":71,"loc":{"start":{"line":71,"column":4},"end":{"line":71,"column":31}}},"14":{"name":"_arrayEach","line":80,"loc":{"start":{"line":80,"column":4},"end":{"line":80,"column":39}}},"15":{"name":"_map","line":89,"loc":{"start":{"line":89,"column":4},"end":{"line":89,"column":33}}},"16":{"name":"_range","line":100,"loc":{"start":{"line":100,"column":4},"end":{"line":100,"column":27}}},"17":{"name":"(anonymous_17)","line":101,"loc":{"start":{"line":101,"column":34},"end":{"line":101,"column":50}}},"18":{"name":"_reduce","line":104,"loc":{"start":{"line":104,"column":4},"end":{"line":104,"column":42}}},"19":{"name":"(anonymous_19)","line":105,"loc":{"start":{"line":105,"column":24},"end":{"line":105,"column":43}}},"20":{"name":"_forEachOf","line":111,"loc":{"start":{"line":111,"column":4},"end":{"line":111,"column":42}}},"21":{"name":"(anonymous_21)","line":112,"loc":{"start":{"line":112,"column":34},"end":{"line":112,"column":49}}},"22":{"name":"_indexOf","line":117,"loc":{"start":{"line":117,"column":4},"end":{"line":117,"column":33}}},"23":{"name":"(anonymous_23)","line":124,"loc":{"start":{"line":124,"column":31},"end":{"line":124,"column":46}}},"24":{"name":"_keyIterator","line":134,"loc":{"start":{"line":134,"column":4},"end":{"line":134,"column":32}}},"25":{"name":"next","line":140,"loc":{"start":{"line":140,"column":19},"end":{"line":140,"column":35}}},"26":{"name":"next","line":147,"loc":{"start":{"line":147,"column":19},"end":{"line":147,"column":35}}},"27":{"name":"_restParam","line":157,"loc":{"start":{"line":157,"column":4},"end":{"line":157,"column":42}}},"28":{"name":"(anonymous_28)","line":159,"loc":{"start":{"line":159,"column":15},"end":{"line":159,"column":26}}},"29":{"name":"_withoutIndex","line":179,"loc":{"start":{"line":179,"column":4},"end":{"line":179,"column":37}}},"30":{"name":"(anonymous_30)","line":180,"loc":{"start":{"line":180,"column":15},"end":{"line":180,"column":49}}},"31":{"name":"(anonymous_31)","line":192,"loc":{"start":{"line":192,"column":33},"end":{"line":192,"column":46}}},"32":{"name":"(anonymous_32)","line":195,"loc":{"start":{"line":195,"column":8},"end":{"line":195,"column":21}}},"33":{"name":"(anonymous_33)","line":208,"loc":{"start":{"line":208,"column":17},"end":{"line":208,"column":52}}},"34":{"name":"(anonymous_34)","line":213,"loc":{"start":{"line":213,"column":23},"end":{"line":213,"column":58}}},"35":{"name":"(anonymous_35)","line":219,"loc":{"start":{"line":219,"column":22},"end":{"line":219,"column":64}}},"36":{"name":"(anonymous_36)","line":224,"loc":{"start":{"line":224,"column":19},"end":{"line":224,"column":57}}},"37":{"name":"done","line":238,"loc":{"start":{"line":238,"column":8},"end":{"line":238,"column":27}}},"38":{"name":"(anonymous_38)","line":252,"loc":{"start":{"line":252,"column":25},"end":{"line":252,"column":60}}},"39":{"name":"iterate","line":257,"loc":{"start":{"line":257,"column":8},"end":{"line":257,"column":27}}},"40":{"name":"(anonymous_40)","line":262,"loc":{"start":{"line":262,"column":46},"end":{"line":262,"column":61}}},"41":{"name":"(anonymous_41)","line":287,"loc":{"start":{"line":287,"column":24},"end":{"line":287,"column":66}}},"42":{"name":"_eachOfLimit","line":291,"loc":{"start":{"line":291,"column":4},"end":{"line":291,"column":33}}},"43":{"name":"(anonymous_43)","line":293,"loc":{"start":{"line":293,"column":15},"end":{"line":293,"column":50}}},"44":{"name":"replenish","line":304,"loc":{"start":{"line":304,"column":13},"end":{"line":304,"column":35}}},"45":{"name":"(anonymous_45)","line":319,"loc":{"start":{"line":319,"column":54},"end":{"line":319,"column":69}}},"46":{"name":"doParallel","line":335,"loc":{"start":{"line":335,"column":4},"end":{"line":335,"column":28}}},"47":{"name":"(anonymous_47)","line":336,"loc":{"start":{"line":336,"column":15},"end":{"line":336,"column":50}}},"48":{"name":"doParallelLimit","line":340,"loc":{"start":{"line":340,"column":4},"end":{"line":340,"column":33}}},"49":{"name":"(anonymous_49)","line":341,"loc":{"start":{"line":341,"column":15},"end":{"line":341,"column":57}}},"50":{"name":"doSeries","line":345,"loc":{"start":{"line":345,"column":4},"end":{"line":345,"column":26}}},"51":{"name":"(anonymous_51)","line":346,"loc":{"start":{"line":346,"column":15},"end":{"line":346,"column":50}}},"52":{"name":"_asyncMap","line":351,"loc":{"start":{"line":351,"column":4},"end":{"line":351,"column":56}}},"53":{"name":"(anonymous_53)","line":355,"loc":{"start":{"line":355,"column":20},"end":{"line":355,"column":54}}},"54":{"name":"(anonymous_54)","line":356,"loc":{"start":{"line":356,"column":28},"end":{"line":356,"column":46}}},"55":{"name":"(anonymous_55)","line":360,"loc":{"start":{"line":360,"column":11},"end":{"line":360,"column":26}}},"56":{"name":"(anonymous_56)","line":373,"loc":{"start":{"line":373,"column":19},"end":{"line":373,"column":60}}},"57":{"name":"(anonymous_57)","line":374,"loc":{"start":{"line":374,"column":32},"end":{"line":374,"column":58}}},"58":{"name":"(anonymous_58)","line":375,"loc":{"start":{"line":375,"column":30},"end":{"line":375,"column":48}}},"59":{"name":"(anonymous_59)","line":379,"loc":{"start":{"line":379,"column":11},"end":{"line":379,"column":26}}},"60":{"name":"(anonymous_60)","line":385,"loc":{"start":{"line":385,"column":24},"end":{"line":385,"column":65}}},"61":{"name":"(anonymous_61)","line":390,"loc":{"start":{"line":390,"column":22},"end":{"line":390,"column":63}}},"62":{"name":"(anonymous_62)","line":397,"loc":{"start":{"line":397,"column":26},"end":{"line":397,"column":45}}},"63":{"name":"(anonymous_63)","line":399,"loc":{"start":{"line":399,"column":11},"end":{"line":399,"column":25}}},"64":{"name":"_filter","line":404,"loc":{"start":{"line":404,"column":4},"end":{"line":404,"column":54}}},"65":{"name":"(anonymous_65)","line":406,"loc":{"start":{"line":406,"column":20},"end":{"line":406,"column":50}}},"66":{"name":"(anonymous_66)","line":407,"loc":{"start":{"line":407,"column":24},"end":{"line":407,"column":37}}},"67":{"name":"(anonymous_67)","line":413,"loc":{"start":{"line":413,"column":11},"end":{"line":413,"column":23}}},"68":{"name":"(anonymous_68)","line":414,"loc":{"start":{"line":414,"column":39},"end":{"line":414,"column":55}}},"69":{"name":"(anonymous_69)","line":416,"loc":{"start":{"line":416,"column":16},"end":{"line":416,"column":29}}},"70":{"name":"_reject","line":431,"loc":{"start":{"line":431,"column":4},"end":{"line":431,"column":54}}},"71":{"name":"(anonymous_71)","line":432,"loc":{"start":{"line":432,"column":29},"end":{"line":432,"column":49}}},"72":{"name":"(anonymous_72)","line":433,"loc":{"start":{"line":433,"column":28},"end":{"line":433,"column":40}}},"73":{"name":"_createTester","line":442,"loc":{"start":{"line":442,"column":4},"end":{"line":442,"column":53}}},"74":{"name":"(anonymous_74)","line":443,"loc":{"start":{"line":443,"column":15},"end":{"line":443,"column":50}}},"75":{"name":"done","line":444,"loc":{"start":{"line":444,"column":12},"end":{"line":444,"column":28}}},"76":{"name":"iteratee","line":447,"loc":{"start":{"line":447,"column":12},"end":{"line":447,"column":46}}},"77":{"name":"(anonymous_77)","line":449,"loc":{"start":{"line":449,"column":28},"end":{"line":449,"column":41}}},"78":{"name":"_findGetResult","line":477,"loc":{"start":{"line":477,"column":4},"end":{"line":477,"column":34}}},"79":{"name":"(anonymous_79)","line":484,"loc":{"start":{"line":484,"column":19},"end":{"line":484,"column":54}}},"80":{"name":"(anonymous_80)","line":485,"loc":{"start":{"line":485,"column":23},"end":{"line":485,"column":46}}},"81":{"name":"(anonymous_81)","line":486,"loc":{"start":{"line":486,"column":24},"end":{"line":486,"column":49}}},"82":{"name":"(anonymous_82)","line":494,"loc":{"start":{"line":494,"column":11},"end":{"line":494,"column":35}}},"83":{"name":"(anonymous_83)","line":499,"loc":{"start":{"line":499,"column":62},"end":{"line":499,"column":75}}},"84":{"name":"comparator","line":506,"loc":{"start":{"line":506,"column":8},"end":{"line":506,"column":41}}},"85":{"name":"(anonymous_85)","line":512,"loc":{"start":{"line":512,"column":17},"end":{"line":512,"column":57}}},"86":{"name":"addListener","line":534,"loc":{"start":{"line":534,"column":8},"end":{"line":534,"column":33}}},"87":{"name":"removeListener","line":537,"loc":{"start":{"line":537,"column":8},"end":{"line":537,"column":36}}},"88":{"name":"taskComplete","line":541,"loc":{"start":{"line":541,"column":8},"end":{"line":541,"column":32}}},"89":{"name":"(anonymous_89)","line":543,"loc":{"start":{"line":543,"column":43},"end":{"line":543,"column":57}}},"90":{"name":"(anonymous_90)","line":548,"loc":{"start":{"line":548,"column":20},"end":{"line":548,"column":32}}},"91":{"name":"(anonymous_91)","line":554,"loc":{"start":{"line":554,"column":25},"end":{"line":554,"column":38}}},"92":{"name":"(anonymous_92)","line":557,"loc":{"start":{"line":557,"column":42},"end":{"line":557,"column":62}}},"93":{"name":"(anonymous_93)","line":564,"loc":{"start":{"line":564,"column":40},"end":{"line":564,"column":60}}},"94":{"name":"ready","line":589,"loc":{"start":{"line":589,"column":12},"end":{"line":589,"column":29}}},"95":{"name":"(anonymous_95)","line":590,"loc":{"start":{"line":590,"column":71},"end":{"line":590,"column":87}}},"96":{"name":"listener","line":601,"loc":{"start":{"line":601,"column":12},"end":{"line":601,"column":32}}},"97":{"name":"(anonymous_97)","line":613,"loc":{"start":{"line":613,"column":18},"end":{"line":613,"column":50}}},"98":{"name":"parseTimes","line":624,"loc":{"start":{"line":624,"column":8},"end":{"line":624,"column":35}}},"99":{"name":"wrappedTask","line":648,"loc":{"start":{"line":648,"column":8},"end":{"line":648,"column":62}}},"100":{"name":"retryAttempt","line":649,"loc":{"start":{"line":649,"column":12},"end":{"line":649,"column":54}}},"101":{"name":"(anonymous_101)","line":650,"loc":{"start":{"line":650,"column":23},"end":{"line":650,"column":48}}},"102":{"name":"(anonymous_102)","line":651,"loc":{"start":{"line":651,"column":25},"end":{"line":651,"column":46}}},"103":{"name":"retryInterval","line":657,"loc":{"start":{"line":657,"column":12},"end":{"line":657,"column":44}}},"104":{"name":"(anonymous_104)","line":658,"loc":{"start":{"line":658,"column":23},"end":{"line":658,"column":47}}},"105":{"name":"(anonymous_105)","line":659,"loc":{"start":{"line":659,"column":31},"end":{"line":659,"column":41}}},"106":{"name":"(anonymous_106)","line":674,"loc":{"start":{"line":674,"column":35},"end":{"line":674,"column":55}}},"107":{"name":"(anonymous_107)","line":684,"loc":{"start":{"line":684,"column":22},"end":{"line":684,"column":49}}},"108":{"name":"wrapIterator","line":693,"loc":{"start":{"line":693,"column":8},"end":{"line":693,"column":40}}},"109":{"name":"(anonymous_109)","line":694,"loc":{"start":{"line":694,"column":30},"end":{"line":694,"column":51}}},"110":{"name":"_parallel","line":713,"loc":{"start":{"line":713,"column":4},"end":{"line":713,"column":48}}},"111":{"name":"(anonymous_111)","line":717,"loc":{"start":{"line":717,"column":22},"end":{"line":717,"column":53}}},"112":{"name":"(anonymous_112)","line":718,"loc":{"start":{"line":718,"column":28},"end":{"line":718,"column":49}}},"113":{"name":"(anonymous_113)","line":725,"loc":{"start":{"line":725,"column":11},"end":{"line":725,"column":26}}},"114":{"name":"(anonymous_114)","line":730,"loc":{"start":{"line":730,"column":21},"end":{"line":730,"column":48}}},"115":{"name":"(anonymous_115)","line":734,"loc":{"start":{"line":734,"column":26},"end":{"line":734,"column":59}}},"116":{"name":"(anonymous_116)","line":738,"loc":{"start":{"line":738,"column":19},"end":{"line":738,"column":45}}},"117":{"name":"(anonymous_117)","line":742,"loc":{"start":{"line":742,"column":21},"end":{"line":742,"column":38}}},"118":{"name":"makeCallback","line":743,"loc":{"start":{"line":743,"column":8},"end":{"line":743,"column":37}}},"119":{"name":"fn","line":744,"loc":{"start":{"line":744,"column":12},"end":{"line":744,"column":26}}},"120":{"name":"(anonymous_120)","line":750,"loc":{"start":{"line":750,"column":22},"end":{"line":750,"column":34}}},"121":{"name":"(anonymous_121)","line":758,"loc":{"start":{"line":758,"column":29},"end":{"line":758,"column":49}}},"122":{"name":"(anonymous_122)","line":759,"loc":{"start":{"line":759,"column":26},"end":{"line":759,"column":46}}},"123":{"name":"_concat","line":766,"loc":{"start":{"line":766,"column":4},"end":{"line":766,"column":48}}},"124":{"name":"(anonymous_124)","line":768,"loc":{"start":{"line":768,"column":20},"end":{"line":768,"column":44}}},"125":{"name":"(anonymous_125)","line":769,"loc":{"start":{"line":769,"column":18},"end":{"line":769,"column":36}}},"126":{"name":"(anonymous_126)","line":773,"loc":{"start":{"line":773,"column":11},"end":{"line":773,"column":26}}},"127":{"name":"(anonymous_127)","line":780,"loc":{"start":{"line":780,"column":19},"end":{"line":780,"column":55}}},"128":{"name":"(anonymous_128)","line":783,"loc":{"start":{"line":783,"column":34},"end":{"line":783,"column":54}}},"129":{"name":"(anonymous_129)","line":798,"loc":{"start":{"line":798,"column":21},"end":{"line":798,"column":57}}},"130":{"name":"(anonymous_130)","line":800,"loc":{"start":{"line":800,"column":28},"end":{"line":800,"column":39}}},"131":{"name":"(anonymous_131)","line":805,"loc":{"start":{"line":805,"column":18},"end":{"line":805,"column":54}}},"132":{"name":"(anonymous_132)","line":806,"loc":{"start":{"line":806,"column":28},"end":{"line":806,"column":39}}},"133":{"name":"(anonymous_133)","line":811,"loc":{"start":{"line":811,"column":20},"end":{"line":811,"column":56}}},"134":{"name":"(anonymous_134)","line":812,"loc":{"start":{"line":812,"column":40},"end":{"line":812,"column":51}}},"135":{"name":"(anonymous_135)","line":817,"loc":{"start":{"line":817,"column":19},"end":{"line":817,"column":55}}},"136":{"name":"(anonymous_136)","line":820,"loc":{"start":{"line":820,"column":30},"end":{"line":820,"column":50}}},"137":{"name":"(anonymous_137)","line":829,"loc":{"start":{"line":829,"column":20},"end":{"line":829,"column":41}}},"138":{"name":"(anonymous_138)","line":842,"loc":{"start":{"line":842,"column":21},"end":{"line":842,"column":57}}},"139":{"name":"(anonymous_139)","line":844,"loc":{"start":{"line":844,"column":21},"end":{"line":844,"column":36}}},"140":{"name":"_queue","line":853,"loc":{"start":{"line":853,"column":4},"end":{"line":853,"column":50}}},"141":{"name":"_insert","line":860,"loc":{"start":{"line":860,"column":8},"end":{"line":860,"column":49}}},"142":{"name":"(anonymous_142)","line":870,"loc":{"start":{"line":870,"column":42},"end":{"line":870,"column":53}}},"143":{"name":"(anonymous_143)","line":874,"loc":{"start":{"line":874,"column":29},"end":{"line":874,"column":44}}},"144":{"name":"_next","line":892,"loc":{"start":{"line":892,"column":8},"end":{"line":892,"column":33}}},"145":{"name":"(anonymous_145)","line":893,"loc":{"start":{"line":893,"column":19},"end":{"line":893,"column":29}}},"146":{"name":"(anonymous_146)","line":898,"loc":{"start":{"line":898,"column":34},"end":{"line":898,"column":50}}},"147":{"name":"(anonymous_147)","line":899,"loc":{"start":{"line":899,"column":44},"end":{"line":899,"column":69}}},"148":{"name":"(anonymous_148)","line":926,"loc":{"start":{"line":926,"column":18},"end":{"line":926,"column":44}}},"149":{"name":"(anonymous_149)","line":929,"loc":{"start":{"line":929,"column":18},"end":{"line":929,"column":30}}},"150":{"name":"(anonymous_150)","line":933,"loc":{"start":{"line":933,"column":21},"end":{"line":933,"column":47}}},"151":{"name":"(anonymous_151)","line":936,"loc":{"start":{"line":936,"column":21},"end":{"line":936,"column":33}}},"152":{"name":"(anonymous_152)","line":943,"loc":{"start":{"line":943,"column":43},"end":{"line":943,"column":59}}},"153":{"name":"(anonymous_153)","line":956,"loc":{"start":{"line":956,"column":20},"end":{"line":956,"column":32}}},"154":{"name":"(anonymous_154)","line":959,"loc":{"start":{"line":959,"column":21},"end":{"line":959,"column":33}}},"155":{"name":"(anonymous_155)","line":962,"loc":{"start":{"line":962,"column":25},"end":{"line":962,"column":37}}},"156":{"name":"(anonymous_156)","line":965,"loc":{"start":{"line":965,"column":18},"end":{"line":965,"column":29}}},"157":{"name":"(anonymous_157)","line":968,"loc":{"start":{"line":968,"column":19},"end":{"line":968,"column":31}}},"158":{"name":"(anonymous_158)","line":971,"loc":{"start":{"line":971,"column":20},"end":{"line":971,"column":32}}},"159":{"name":"(anonymous_159)","line":985,"loc":{"start":{"line":985,"column":18},"end":{"line":985,"column":49}}},"160":{"name":"(anonymous_160)","line":986,"loc":{"start":{"line":986,"column":23},"end":{"line":986,"column":44}}},"161":{"name":"(anonymous_161)","line":993,"loc":{"start":{"line":993,"column":26},"end":{"line":993,"column":57}}},"162":{"name":"_compareTasks","line":995,"loc":{"start":{"line":995,"column":8},"end":{"line":995,"column":36}}},"163":{"name":"_binarySearch","line":999,"loc":{"start":{"line":999,"column":8},"end":{"line":999,"column":56}}},"164":{"name":"_insert","line":1013,"loc":{"start":{"line":1013,"column":8},"end":{"line":1013,"column":54}}},"165":{"name":"(anonymous_165)","line":1023,"loc":{"start":{"line":1023,"column":42},"end":{"line":1023,"column":53}}},"166":{"name":"(anonymous_166)","line":1027,"loc":{"start":{"line":1027,"column":29},"end":{"line":1027,"column":44}}},"167":{"name":"(anonymous_167)","line":1047,"loc":{"start":{"line":1047,"column":17},"end":{"line":1047,"column":53}}},"168":{"name":"(anonymous_168)","line":1057,"loc":{"start":{"line":1057,"column":18},"end":{"line":1057,"column":45}}},"169":{"name":"_console_fn","line":1061,"loc":{"start":{"line":1061,"column":4},"end":{"line":1061,"column":31}}},"170":{"name":"(anonymous_170)","line":1062,"loc":{"start":{"line":1062,"column":26},"end":{"line":1062,"column":46}}},"171":{"name":"(anonymous_171)","line":1063,"loc":{"start":{"line":1063,"column":51},"end":{"line":1063,"column":72}}},"172":{"name":"(anonymous_172)","line":1071,"loc":{"start":{"line":1071,"column":41},"end":{"line":1071,"column":54}}},"173":{"name":"(anonymous_173)","line":1085,"loc":{"start":{"line":1085,"column":20},"end":{"line":1085,"column":42}}},"174":{"name":"memoized","line":1090,"loc":{"start":{"line":1090,"column":34},"end":{"line":1090,"column":58}}},"175":{"name":"(anonymous_175)","line":1094,"loc":{"start":{"line":1094,"column":35},"end":{"line":1094,"column":47}}},"176":{"name":"(anonymous_176)","line":1103,"loc":{"start":{"line":1103,"column":55},"end":{"line":1103,"column":71}}},"177":{"name":"(anonymous_177)","line":1118,"loc":{"start":{"line":1118,"column":22},"end":{"line":1118,"column":36}}},"178":{"name":"(anonymous_178)","line":1119,"loc":{"start":{"line":1119,"column":15},"end":{"line":1119,"column":27}}},"179":{"name":"_times","line":1124,"loc":{"start":{"line":1124,"column":4},"end":{"line":1124,"column":28}}},"180":{"name":"(anonymous_180)","line":1125,"loc":{"start":{"line":1125,"column":15},"end":{"line":1125,"column":52}}},"181":{"name":"(anonymous_181)","line":1132,"loc":{"start":{"line":1132,"column":23},"end":{"line":1132,"column":67}}},"182":{"name":"(anonymous_182)","line":1136,"loc":{"start":{"line":1136,"column":16},"end":{"line":1136,"column":46}}},"183":{"name":"(anonymous_183)","line":1138,"loc":{"start":{"line":1138,"column":26},"end":{"line":1138,"column":42}}},"184":{"name":"(anonymous_184)","line":1148,"loc":{"start":{"line":1148,"column":36},"end":{"line":1148,"column":63}}},"185":{"name":"(anonymous_185)","line":1149,"loc":{"start":{"line":1149,"column":58},"end":{"line":1149,"column":83}}},"186":{"name":"(anonymous_186)","line":1153,"loc":{"start":{"line":1153,"column":12},"end":{"line":1153,"column":36}}},"187":{"name":"(anonymous_187)","line":1159,"loc":{"start":{"line":1159,"column":20},"end":{"line":1159,"column":50}}},"188":{"name":"_applyEach","line":1164,"loc":{"start":{"line":1164,"column":4},"end":{"line":1164,"column":32}}},"189":{"name":"(anonymous_189)","line":1165,"loc":{"start":{"line":1165,"column":26},"end":{"line":1165,"column":46}}},"190":{"name":"(anonymous_190)","line":1166,"loc":{"start":{"line":1166,"column":32},"end":{"line":1166,"column":47}}},"191":{"name":"(anonymous_191)","line":1169,"loc":{"start":{"line":1169,"column":35},"end":{"line":1169,"column":56}}},"192":{"name":"(anonymous_192)","line":1187,"loc":{"start":{"line":1187,"column":20},"end":{"line":1187,"column":44}}},"193":{"name":"next","line":1190,"loc":{"start":{"line":1190,"column":8},"end":{"line":1190,"column":27}}},"194":{"name":"ensureAsync","line":1199,"loc":{"start":{"line":1199,"column":4},"end":{"line":1199,"column":29}}},"195":{"name":"(anonymous_195)","line":1200,"loc":{"start":{"line":1200,"column":26},"end":{"line":1200,"column":42}}},"196":{"name":"(anonymous_196)","line":1202,"loc":{"start":{"line":1202,"column":22},"end":{"line":1202,"column":34}}},"197":{"name":"(anonymous_197)","line":1205,"loc":{"start":{"line":1205,"column":39},"end":{"line":1205,"column":51}}},"198":{"name":"(anonymous_198)","line":1220,"loc":{"start":{"line":1220,"column":32},"end":{"line":1220,"column":49}}},"199":{"name":"(anonymous_199)","line":1222,"loc":{"start":{"line":1222,"column":15},"end":{"line":1222,"column":35}}},"200":{"name":"asyncify","line":1228,"loc":{"start":{"line":1228,"column":21},"end":{"line":1228,"column":45}}},"201":{"name":"(anonymous_201)","line":1229,"loc":{"start":{"line":1229,"column":26},"end":{"line":1229,"column":42}}},"202":{"name":"(anonymous_202)","line":1239,"loc":{"start":{"line":1239,"column":28},"end":{"line":1239,"column":44}}},"203":{"name":"(anonymous_203)","line":1241,"loc":{"start":{"line":1241,"column":28},"end":{"line":1241,"column":42}}},"204":{"name":"(anonymous_204)","line":1256,"loc":{"start":{"line":1256,"column":19},"end":{"line":1256,"column":31}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":1265,"column":5}},"2":{"start":{"line":10,"column":4},"end":{"line":10,"column":19}},"3":{"start":{"line":11,"column":4},"end":{"line":11,"column":22}},"4":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"5":{"start":{"line":13,"column":8},"end":{"line":13,"column":17}},"6":{"start":{"line":15,"column":4},"end":{"line":17,"column":5}},"7":{"start":{"line":16,"column":8},"end":{"line":16,"column":19}},"8":{"start":{"line":18,"column":4},"end":{"line":20,"column":5}},"9":{"start":{"line":19,"column":8},"end":{"line":19,"column":18}},"10":{"start":{"line":23,"column":4},"end":{"line":23,"column":23}},"11":{"start":{"line":28,"column":4},"end":{"line":30,"column":17}},"12":{"start":{"line":32,"column":4},"end":{"line":34,"column":5}},"13":{"start":{"line":33,"column":8},"end":{"line":33,"column":36}},"14":{"start":{"line":36,"column":4},"end":{"line":39,"column":6}},"15":{"start":{"line":37,"column":8},"end":{"line":37,"column":36}},"16":{"start":{"line":38,"column":8},"end":{"line":38,"column":21}},"17":{"start":{"line":41,"column":4},"end":{"line":47,"column":5}},"18":{"start":{"line":42,"column":8},"end":{"line":46,"column":10}},"19":{"start":{"line":43,"column":12},"end":{"line":43,"column":77}},"20":{"start":{"line":43,"column":29},"end":{"line":43,"column":77}},"21":{"start":{"line":44,"column":12},"end":{"line":44,"column":38}},"22":{"start":{"line":45,"column":12},"end":{"line":45,"column":22}},"23":{"start":{"line":49,"column":4},"end":{"line":55,"column":5}},"24":{"start":{"line":50,"column":8},"end":{"line":54,"column":10}},"25":{"start":{"line":51,"column":12},"end":{"line":51,"column":36}},"26":{"start":{"line":51,"column":29},"end":{"line":51,"column":36}},"27":{"start":{"line":52,"column":12},"end":{"line":52,"column":38}},"28":{"start":{"line":53,"column":12},"end":{"line":53,"column":22}},"29":{"start":{"line":59,"column":4},"end":{"line":59,"column":46}},"30":{"start":{"line":61,"column":4},"end":{"line":63,"column":6}},"31":{"start":{"line":62,"column":8},"end":{"line":62,"column":56}},"32":{"start":{"line":66,"column":4},"end":{"line":69,"column":6}},"33":{"start":{"line":67,"column":8},"end":{"line":67,"column":30}},"34":{"start":{"line":68,"column":8},"end":{"line":68,"column":65}},"35":{"start":{"line":71,"column":4},"end":{"line":78,"column":5}},"36":{"start":{"line":72,"column":8},"end":{"line":77,"column":10}},"37":{"start":{"line":80,"column":4},"end":{"line":87,"column":5}},"38":{"start":{"line":81,"column":8},"end":{"line":82,"column":32}},"39":{"start":{"line":84,"column":8},"end":{"line":86,"column":9}},"40":{"start":{"line":85,"column":12},"end":{"line":85,"column":45}},"41":{"start":{"line":89,"column":4},"end":{"line":98,"column":5}},"42":{"start":{"line":90,"column":8},"end":{"line":92,"column":35}},"43":{"start":{"line":94,"column":8},"end":{"line":96,"column":9}},"44":{"start":{"line":95,"column":12},"end":{"line":95,"column":61}},"45":{"start":{"line":97,"column":8},"end":{"line":97,"column":22}},"46":{"start":{"line":100,"column":4},"end":{"line":102,"column":5}},"47":{"start":{"line":101,"column":8},"end":{"line":101,"column":65}},"48":{"start":{"line":101,"column":52},"end":{"line":101,"column":61}},"49":{"start":{"line":104,"column":4},"end":{"line":109,"column":5}},"50":{"start":{"line":105,"column":8},"end":{"line":107,"column":11}},"51":{"start":{"line":106,"column":12},"end":{"line":106,"column":43}},"52":{"start":{"line":108,"column":8},"end":{"line":108,"column":20}},"53":{"start":{"line":111,"column":4},"end":{"line":115,"column":5}},"54":{"start":{"line":112,"column":8},"end":{"line":114,"column":11}},"55":{"start":{"line":113,"column":12},"end":{"line":113,"column":39}},"56":{"start":{"line":117,"column":4},"end":{"line":122,"column":5}},"57":{"start":{"line":118,"column":8},"end":{"line":120,"column":9}},"58":{"start":{"line":119,"column":12},"end":{"line":119,"column":42}},"59":{"start":{"line":119,"column":33},"end":{"line":119,"column":42}},"60":{"start":{"line":121,"column":8},"end":{"line":121,"column":18}},"61":{"start":{"line":124,"column":4},"end":{"line":132,"column":6}},"62":{"start":{"line":125,"column":8},"end":{"line":125,"column":22}},"63":{"start":{"line":126,"column":8},"end":{"line":130,"column":9}},"64":{"start":{"line":127,"column":12},"end":{"line":129,"column":13}},"65":{"start":{"line":128,"column":16},"end":{"line":128,"column":29}},"66":{"start":{"line":131,"column":8},"end":{"line":131,"column":20}},"67":{"start":{"line":134,"column":4},"end":{"line":152,"column":5}},"68":{"start":{"line":135,"column":8},"end":{"line":135,"column":19}},"69":{"start":{"line":136,"column":8},"end":{"line":136,"column":16}},"70":{"start":{"line":137,"column":8},"end":{"line":137,"column":17}},"71":{"start":{"line":138,"column":8},"end":{"line":151,"column":9}},"72":{"start":{"line":139,"column":12},"end":{"line":139,"column":30}},"73":{"start":{"line":140,"column":12},"end":{"line":143,"column":14}},"74":{"start":{"line":141,"column":16},"end":{"line":141,"column":20}},"75":{"start":{"line":142,"column":16},"end":{"line":142,"column":42}},"76":{"start":{"line":145,"column":12},"end":{"line":145,"column":31}},"77":{"start":{"line":146,"column":12},"end":{"line":146,"column":30}},"78":{"start":{"line":147,"column":12},"end":{"line":150,"column":14}},"79":{"start":{"line":148,"column":16},"end":{"line":148,"column":20}},"80":{"start":{"line":149,"column":16},"end":{"line":149,"column":48}},"81":{"start":{"line":157,"column":4},"end":{"line":177,"column":5}},"82":{"start":{"line":158,"column":8},"end":{"line":158,"column":72}},"83":{"start":{"line":159,"column":8},"end":{"line":176,"column":10}},"84":{"start":{"line":160,"column":12},"end":{"line":160,"column":68}},"85":{"start":{"line":161,"column":12},"end":{"line":161,"column":37}},"86":{"start":{"line":162,"column":12},"end":{"line":164,"column":13}},"87":{"start":{"line":163,"column":16},"end":{"line":163,"column":60}},"88":{"start":{"line":165,"column":12},"end":{"line":168,"column":13}},"89":{"start":{"line":166,"column":24},"end":{"line":166,"column":53}},"90":{"start":{"line":167,"column":24},"end":{"line":167,"column":67}},"91":{"start":{"line":179,"column":4},"end":{"line":183,"column":5}},"92":{"start":{"line":180,"column":8},"end":{"line":182,"column":10}},"93":{"start":{"line":181,"column":12},"end":{"line":181,"column":45}},"94":{"start":{"line":190,"column":4},"end":{"line":190,"column":75}},"95":{"start":{"line":192,"column":4},"end":{"line":197,"column":6}},"96":{"start":{"line":194,"column":8},"end":{"line":194,"column":26}},"97":{"start":{"line":196,"column":8},"end":{"line":196,"column":26}},"98":{"start":{"line":199,"column":4},"end":{"line":203,"column":5}},"99":{"start":{"line":200,"column":8},"end":{"line":200,"column":42}},"100":{"start":{"line":202,"column":8},"end":{"line":202,"column":32}},"101":{"start":{"line":204,"column":4},"end":{"line":204,"column":65}},"102":{"start":{"line":207,"column":4},"end":{"line":210,"column":6}},"103":{"start":{"line":209,"column":8},"end":{"line":209,"column":68}},"104":{"start":{"line":212,"column":4},"end":{"line":215,"column":6}},"105":{"start":{"line":214,"column":8},"end":{"line":214,"column":74}},"106":{"start":{"line":218,"column":4},"end":{"line":221,"column":6}},"107":{"start":{"line":220,"column":8},"end":{"line":220,"column":75}},"108":{"start":{"line":223,"column":4},"end":{"line":249,"column":6}},"109":{"start":{"line":225,"column":8},"end":{"line":225,"column":43}},"110":{"start":{"line":226,"column":8},"end":{"line":226,"column":30}},"111":{"start":{"line":228,"column":8},"end":{"line":228,"column":40}},"112":{"start":{"line":229,"column":8},"end":{"line":229,"column":31}},"113":{"start":{"line":231,"column":8},"end":{"line":234,"column":9}},"114":{"start":{"line":232,"column":12},"end":{"line":232,"column":27}},"115":{"start":{"line":233,"column":12},"end":{"line":233,"column":56}},"116":{"start":{"line":236,"column":8},"end":{"line":236,"column":44}},"117":{"start":{"line":236,"column":29},"end":{"line":236,"column":44}},"118":{"start":{"line":238,"column":8},"end":{"line":248,"column":9}},"119":{"start":{"line":239,"column":12},"end":{"line":239,"column":24}},"120":{"start":{"line":240,"column":12},"end":{"line":247,"column":13}},"121":{"start":{"line":241,"column":16},"end":{"line":241,"column":30}},"122":{"start":{"line":245,"column":17},"end":{"line":247,"column":13}},"123":{"start":{"line":246,"column":16},"end":{"line":246,"column":31}},"124":{"start":{"line":251,"column":4},"end":{"line":282,"column":6}},"125":{"start":{"line":253,"column":8},"end":{"line":253,"column":43}},"126":{"start":{"line":254,"column":8},"end":{"line":254,"column":24}},"127":{"start":{"line":255,"column":8},"end":{"line":255,"column":40}},"128":{"start":{"line":256,"column":8},"end":{"line":256,"column":28}},"129":{"start":{"line":257,"column":8},"end":{"line":280,"column":9}},"130":{"start":{"line":258,"column":12},"end":{"line":258,"column":28}},"131":{"start":{"line":259,"column":12},"end":{"line":261,"column":13}},"132":{"start":{"line":260,"column":16},"end":{"line":260,"column":38}},"133":{"start":{"line":262,"column":12},"end":{"line":278,"column":16}},"134":{"start":{"line":263,"column":16},"end":{"line":277,"column":17}},"135":{"start":{"line":264,"column":20},"end":{"line":264,"column":34}},"136":{"start":{"line":267,"column":20},"end":{"line":267,"column":36}},"137":{"start":{"line":268,"column":20},"end":{"line":276,"column":21}},"138":{"start":{"line":269,"column":24},"end":{"line":269,"column":46}},"139":{"start":{"line":271,"column":24},"end":{"line":275,"column":25}},"140":{"start":{"line":272,"column":28},"end":{"line":272,"column":56}},"141":{"start":{"line":274,"column":28},"end":{"line":274,"column":38}},"142":{"start":{"line":279,"column":12},"end":{"line":279,"column":25}},"143":{"start":{"line":281,"column":8},"end":{"line":281,"column":18}},"144":{"start":{"line":286,"column":4},"end":{"line":289,"column":6}},"145":{"start":{"line":288,"column":8},"end":{"line":288,"column":53}},"146":{"start":{"line":291,"column":4},"end":{"line":332,"column":5}},"147":{"start":{"line":293,"column":8},"end":{"line":331,"column":10}},"148":{"start":{"line":294,"column":12},"end":{"line":294,"column":47}},"149":{"start":{"line":295,"column":12},"end":{"line":295,"column":28}},"150":{"start":{"line":296,"column":12},"end":{"line":296,"column":44}},"151":{"start":{"line":297,"column":12},"end":{"line":299,"column":13}},"152":{"start":{"line":298,"column":16},"end":{"line":298,"column":38}},"153":{"start":{"line":300,"column":12},"end":{"line":300,"column":29}},"154":{"start":{"line":301,"column":12},"end":{"line":301,"column":28}},"155":{"start":{"line":302,"column":12},"end":{"line":302,"column":32}},"156":{"start":{"line":304,"column":12},"end":{"line":330,"column":17}},"157":{"start":{"line":305,"column":16},"end":{"line":307,"column":17}},"158":{"start":{"line":306,"column":20},"end":{"line":306,"column":42}},"159":{"start":{"line":309,"column":16},"end":{"line":329,"column":17}},"160":{"start":{"line":310,"column":20},"end":{"line":310,"column":40}},"161":{"start":{"line":311,"column":20},"end":{"line":317,"column":21}},"162":{"start":{"line":312,"column":24},"end":{"line":312,"column":36}},"163":{"start":{"line":313,"column":24},"end":{"line":315,"column":25}},"164":{"start":{"line":314,"column":28},"end":{"line":314,"column":43}},"165":{"start":{"line":316,"column":24},"end":{"line":316,"column":31}},"166":{"start":{"line":318,"column":20},"end":{"line":318,"column":33}},"167":{"start":{"line":319,"column":20},"end":{"line":328,"column":24}},"168":{"start":{"line":320,"column":24},"end":{"line":320,"column":37}},"169":{"start":{"line":321,"column":24},"end":{"line":327,"column":25}},"170":{"start":{"line":322,"column":28},"end":{"line":322,"column":42}},"171":{"start":{"line":323,"column":28},"end":{"line":323,"column":43}},"172":{"start":{"line":326,"column":28},"end":{"line":326,"column":40}},"173":{"start":{"line":335,"column":4},"end":{"line":339,"column":5}},"174":{"start":{"line":336,"column":8},"end":{"line":338,"column":10}},"175":{"start":{"line":337,"column":12},"end":{"line":337,"column":61}},"176":{"start":{"line":340,"column":4},"end":{"line":344,"column":5}},"177":{"start":{"line":341,"column":8},"end":{"line":343,"column":10}},"178":{"start":{"line":342,"column":12},"end":{"line":342,"column":68}},"179":{"start":{"line":345,"column":4},"end":{"line":349,"column":5}},"180":{"start":{"line":346,"column":8},"end":{"line":348,"column":10}},"181":{"start":{"line":347,"column":12},"end":{"line":347,"column":67}},"182":{"start":{"line":351,"column":4},"end":{"line":363,"column":5}},"183":{"start":{"line":352,"column":8},"end":{"line":352,"column":43}},"184":{"start":{"line":353,"column":8},"end":{"line":353,"column":24}},"185":{"start":{"line":354,"column":8},"end":{"line":354,"column":50}},"186":{"start":{"line":355,"column":8},"end":{"line":362,"column":11}},"187":{"start":{"line":356,"column":12},"end":{"line":359,"column":15}},"188":{"start":{"line":357,"column":16},"end":{"line":357,"column":35}},"189":{"start":{"line":358,"column":16},"end":{"line":358,"column":30}},"190":{"start":{"line":361,"column":12},"end":{"line":361,"column":35}},"191":{"start":{"line":365,"column":4},"end":{"line":365,"column":38}},"192":{"start":{"line":366,"column":4},"end":{"line":366,"column":42}},"193":{"start":{"line":367,"column":4},"end":{"line":367,"column":48}},"194":{"start":{"line":371,"column":4},"end":{"line":382,"column":6}},"195":{"start":{"line":374,"column":8},"end":{"line":381,"column":11}},"196":{"start":{"line":375,"column":12},"end":{"line":378,"column":15}},"197":{"start":{"line":376,"column":16},"end":{"line":376,"column":25}},"198":{"start":{"line":377,"column":16},"end":{"line":377,"column":30}},"199":{"start":{"line":380,"column":12},"end":{"line":380,"column":32}},"200":{"start":{"line":384,"column":4},"end":{"line":388,"column":6}},"201":{"start":{"line":386,"column":8},"end":{"line":386,"column":53}},"202":{"start":{"line":387,"column":8},"end":{"line":387,"column":57}},"203":{"start":{"line":390,"column":4},"end":{"line":402,"column":6}},"204":{"start":{"line":391,"column":8},"end":{"line":395,"column":9}},"205":{"start":{"line":392,"column":12},"end":{"line":392,"column":32}},"206":{"start":{"line":393,"column":12},"end":{"line":393,"column":28}},"207":{"start":{"line":394,"column":12},"end":{"line":394,"column":43}},"208":{"start":{"line":397,"column":8},"end":{"line":401,"column":11}},"209":{"start":{"line":398,"column":12},"end":{"line":398,"column":37}},"210":{"start":{"line":400,"column":12},"end":{"line":400,"column":32}},"211":{"start":{"line":404,"column":4},"end":{"line":420,"column":5}},"212":{"start":{"line":405,"column":8},"end":{"line":405,"column":25}},"213":{"start":{"line":406,"column":8},"end":{"line":419,"column":11}},"214":{"start":{"line":407,"column":12},"end":{"line":412,"column":15}},"215":{"start":{"line":408,"column":16},"end":{"line":410,"column":17}},"216":{"start":{"line":409,"column":20},"end":{"line":409,"column":59}},"217":{"start":{"line":411,"column":16},"end":{"line":411,"column":27}},"218":{"start":{"line":414,"column":12},"end":{"line":418,"column":16}},"219":{"start":{"line":415,"column":16},"end":{"line":415,"column":41}},"220":{"start":{"line":417,"column":16},"end":{"line":417,"column":31}},"221":{"start":{"line":422,"column":4},"end":{"line":423,"column":39}},"222":{"start":{"line":425,"column":4},"end":{"line":426,"column":49}},"223":{"start":{"line":428,"column":4},"end":{"line":429,"column":43}},"224":{"start":{"line":431,"column":4},"end":{"line":437,"column":5}},"225":{"start":{"line":432,"column":8},"end":{"line":436,"column":21}},"226":{"start":{"line":433,"column":12},"end":{"line":435,"column":15}},"227":{"start":{"line":434,"column":16},"end":{"line":434,"column":23}},"228":{"start":{"line":438,"column":4},"end":{"line":438,"column":39}},"229":{"start":{"line":439,"column":4},"end":{"line":439,"column":49}},"230":{"start":{"line":440,"column":4},"end":{"line":440,"column":43}},"231":{"start":{"line":442,"column":4},"end":{"line":465,"column":5}},"232":{"start":{"line":443,"column":8},"end":{"line":464,"column":10}},"233":{"start":{"line":444,"column":12},"end":{"line":446,"column":13}},"234":{"start":{"line":445,"column":16},"end":{"line":445,"column":53}},"235":{"start":{"line":445,"column":24},"end":{"line":445,"column":53}},"236":{"start":{"line":447,"column":12},"end":{"line":456,"column":13}},"237":{"start":{"line":448,"column":16},"end":{"line":448,"column":43}},"238":{"start":{"line":448,"column":25},"end":{"line":448,"column":43}},"239":{"start":{"line":449,"column":16},"end":{"line":455,"column":19}},"240":{"start":{"line":450,"column":20},"end":{"line":453,"column":21}},"241":{"start":{"line":451,"column":24},"end":{"line":451,"column":47}},"242":{"start":{"line":452,"column":24},"end":{"line":452,"column":46}},"243":{"start":{"line":454,"column":20},"end":{"line":454,"column":31}},"244":{"start":{"line":457,"column":12},"end":{"line":463,"column":13}},"245":{"start":{"line":458,"column":16},"end":{"line":458,"column":51}},"246":{"start":{"line":460,"column":16},"end":{"line":460,"column":30}},"247":{"start":{"line":461,"column":16},"end":{"line":461,"column":33}},"248":{"start":{"line":462,"column":16},"end":{"line":462,"column":44}},"249":{"start":{"line":467,"column":4},"end":{"line":468,"column":63}},"250":{"start":{"line":470,"column":4},"end":{"line":470,"column":73}},"251":{"start":{"line":472,"column":4},"end":{"line":473,"column":60}},"252":{"start":{"line":475,"column":4},"end":{"line":475,"column":70}},"253":{"start":{"line":477,"column":4},"end":{"line":479,"column":5}},"254":{"start":{"line":478,"column":8},"end":{"line":478,"column":17}},"255":{"start":{"line":480,"column":4},"end":{"line":480,"column":73}},"256":{"start":{"line":481,"column":4},"end":{"line":481,"column":85}},"257":{"start":{"line":482,"column":4},"end":{"line":482,"column":83}},"258":{"start":{"line":484,"column":4},"end":{"line":510,"column":6}},"259":{"start":{"line":485,"column":8},"end":{"line":504,"column":11}},"260":{"start":{"line":486,"column":12},"end":{"line":493,"column":15}},"261":{"start":{"line":487,"column":16},"end":{"line":492,"column":17}},"262":{"start":{"line":488,"column":20},"end":{"line":488,"column":34}},"263":{"start":{"line":491,"column":20},"end":{"line":491,"column":67}},"264":{"start":{"line":495,"column":12},"end":{"line":502,"column":13}},"265":{"start":{"line":496,"column":16},"end":{"line":496,"column":37}},"266":{"start":{"line":499,"column":16},"end":{"line":501,"column":20}},"267":{"start":{"line":500,"column":20},"end":{"line":500,"column":35}},"268":{"start":{"line":506,"column":8},"end":{"line":509,"column":9}},"269":{"start":{"line":507,"column":12},"end":{"line":507,"column":54}},"270":{"start":{"line":508,"column":12},"end":{"line":508,"column":46}},"271":{"start":{"line":512,"column":4},"end":{"line":609,"column":6}},"272":{"start":{"line":513,"column":8},"end":{"line":517,"column":9}},"273":{"start":{"line":515,"column":12},"end":{"line":515,"column":35}},"274":{"start":{"line":516,"column":12},"end":{"line":516,"column":31}},"275":{"start":{"line":518,"column":8},"end":{"line":518,"column":43}},"276":{"start":{"line":519,"column":8},"end":{"line":519,"column":32}},"277":{"start":{"line":520,"column":8},"end":{"line":520,"column":41}},"278":{"start":{"line":521,"column":8},"end":{"line":523,"column":9}},"279":{"start":{"line":522,"column":12},"end":{"line":522,"column":34}},"280":{"start":{"line":524,"column":8},"end":{"line":526,"column":9}},"281":{"start":{"line":525,"column":12},"end":{"line":525,"column":41}},"282":{"start":{"line":528,"column":8},"end":{"line":528,"column":25}},"283":{"start":{"line":529,"column":8},"end":{"line":529,"column":29}},"284":{"start":{"line":531,"column":8},"end":{"line":531,"column":29}},"285":{"start":{"line":533,"column":8},"end":{"line":533,"column":27}},"286":{"start":{"line":534,"column":8},"end":{"line":536,"column":9}},"287":{"start":{"line":535,"column":12},"end":{"line":535,"column":34}},"288":{"start":{"line":537,"column":8},"end":{"line":540,"column":9}},"289":{"start":{"line":538,"column":12},"end":{"line":538,"column":46}},"290":{"start":{"line":539,"column":12},"end":{"line":539,"column":51}},"291":{"start":{"line":539,"column":26},"end":{"line":539,"column":51}},"292":{"start":{"line":541,"column":8},"end":{"line":546,"column":9}},"293":{"start":{"line":542,"column":12},"end":{"line":542,"column":29}},"294":{"start":{"line":543,"column":12},"end":{"line":545,"column":15}},"295":{"start":{"line":544,"column":16},"end":{"line":544,"column":21}},"296":{"start":{"line":548,"column":8},"end":{"line":552,"column":11}},"297":{"start":{"line":549,"column":12},"end":{"line":551,"column":13}},"298":{"start":{"line":550,"column":16},"end":{"line":550,"column":40}},"299":{"start":{"line":554,"column":8},"end":{"line":608,"column":11}},"300":{"start":{"line":555,"column":12},"end":{"line":555,"column":33}},"301":{"start":{"line":555,"column":26},"end":{"line":555,"column":33}},"302":{"start":{"line":556,"column":12},"end":{"line":556,"column":65}},"303":{"start":{"line":557,"column":12},"end":{"line":576,"column":15}},"304":{"start":{"line":558,"column":16},"end":{"line":558,"column":31}},"305":{"start":{"line":559,"column":16},"end":{"line":561,"column":17}},"306":{"start":{"line":560,"column":20},"end":{"line":560,"column":35}},"307":{"start":{"line":562,"column":16},"end":{"line":575,"column":17}},"308":{"start":{"line":563,"column":20},"end":{"line":563,"column":41}},"309":{"start":{"line":564,"column":20},"end":{"line":566,"column":23}},"310":{"start":{"line":565,"column":24},"end":{"line":565,"column":48}},"311":{"start":{"line":567,"column":20},"end":{"line":567,"column":42}},"312":{"start":{"line":568,"column":20},"end":{"line":568,"column":36}},"313":{"start":{"line":570,"column":20},"end":{"line":570,"column":47}},"314":{"start":{"line":573,"column":20},"end":{"line":573,"column":38}},"315":{"start":{"line":574,"column":20},"end":{"line":574,"column":53}},"316":{"start":{"line":577,"column":12},"end":{"line":577,"column":58}},"317":{"start":{"line":579,"column":12},"end":{"line":579,"column":38}},"318":{"start":{"line":580,"column":12},"end":{"line":580,"column":20}},"319":{"start":{"line":581,"column":12},"end":{"line":588,"column":13}},"320":{"start":{"line":582,"column":16},"end":{"line":584,"column":17}},"321":{"start":{"line":583,"column":20},"end":{"line":583,"column":92}},"322":{"start":{"line":585,"column":16},"end":{"line":587,"column":17}},"323":{"start":{"line":586,"column":20},"end":{"line":586,"column":63}},"324":{"start":{"line":589,"column":12},"end":{"line":593,"column":13}},"325":{"start":{"line":590,"column":16},"end":{"line":592,"column":55}},"326":{"start":{"line":591,"column":20},"end":{"line":591,"column":60}},"327":{"start":{"line":594,"column":12},"end":{"line":600,"column":13}},"328":{"start":{"line":595,"column":16},"end":{"line":595,"column":31}},"329":{"start":{"line":596,"column":16},"end":{"line":596,"column":61}},"330":{"start":{"line":599,"column":16},"end":{"line":599,"column":38}},"331":{"start":{"line":601,"column":12},"end":{"line":607,"column":13}},"332":{"start":{"line":602,"column":16},"end":{"line":606,"column":17}},"333":{"start":{"line":603,"column":20},"end":{"line":603,"column":35}},"334":{"start":{"line":604,"column":20},"end":{"line":604,"column":45}},"335":{"start":{"line":605,"column":20},"end":{"line":605,"column":65}},"336":{"start":{"line":613,"column":4},"end":{"line":682,"column":6}},"337":{"start":{"line":614,"column":8},"end":{"line":614,"column":30}},"338":{"start":{"line":615,"column":8},"end":{"line":615,"column":33}},"339":{"start":{"line":617,"column":8},"end":{"line":617,"column":26}},"340":{"start":{"line":619,"column":8},"end":{"line":622,"column":10}},"341":{"start":{"line":624,"column":8},"end":{"line":633,"column":9}},"342":{"start":{"line":625,"column":12},"end":{"line":632,"column":13}},"343":{"start":{"line":626,"column":16},"end":{"line":626,"column":61}},"344":{"start":{"line":627,"column":19},"end":{"line":632,"column":13}},"345":{"start":{"line":628,"column":16},"end":{"line":628,"column":67}},"346":{"start":{"line":629,"column":16},"end":{"line":629,"column":76}},"347":{"start":{"line":631,"column":16},"end":{"line":631,"column":88}},"348":{"start":{"line":635,"column":8},"end":{"line":635,"column":38}},"349":{"start":{"line":636,"column":8},"end":{"line":641,"column":9}},"350":{"start":{"line":637,"column":12},"end":{"line":637,"column":133}},"351":{"start":{"line":638,"column":15},"end":{"line":641,"column":9}},"352":{"start":{"line":639,"column":12},"end":{"line":639,"column":28}},"353":{"start":{"line":640,"column":12},"end":{"line":640,"column":25}},"354":{"start":{"line":642,"column":8},"end":{"line":644,"column":9}},"355":{"start":{"line":643,"column":12},"end":{"line":643,"column":36}},"356":{"start":{"line":645,"column":8},"end":{"line":645,"column":33}},"357":{"start":{"line":646,"column":8},"end":{"line":646,"column":25}},"358":{"start":{"line":648,"column":8},"end":{"line":678,"column":9}},"359":{"start":{"line":649,"column":12},"end":{"line":655,"column":13}},"360":{"start":{"line":650,"column":16},"end":{"line":654,"column":18}},"361":{"start":{"line":651,"column":20},"end":{"line":653,"column":39}},"362":{"start":{"line":652,"column":24},"end":{"line":652,"column":89}},"363":{"start":{"line":657,"column":12},"end":{"line":663,"column":13}},"364":{"start":{"line":658,"column":16},"end":{"line":662,"column":18}},"365":{"start":{"line":659,"column":20},"end":{"line":661,"column":33}},"366":{"start":{"line":660,"column":24},"end":{"line":660,"column":45}},"367":{"start":{"line":665,"column":12},"end":{"line":672,"column":13}},"368":{"start":{"line":667,"column":16},"end":{"line":667,"column":52}},"369":{"start":{"line":668,"column":16},"end":{"line":668,"column":69}},"370":{"start":{"line":669,"column":16},"end":{"line":671,"column":17}},"371":{"start":{"line":670,"column":20},"end":{"line":670,"column":64}},"372":{"start":{"line":674,"column":12},"end":{"line":677,"column":15}},"373":{"start":{"line":675,"column":16},"end":{"line":675,"column":45}},"374":{"start":{"line":676,"column":16},"end":{"line":676,"column":74}},"375":{"start":{"line":681,"column":8},"end":{"line":681,"column":59}},"376":{"start":{"line":684,"column":4},"end":{"line":711,"column":6}},"377":{"start":{"line":685,"column":8},"end":{"line":685,"column":43}},"378":{"start":{"line":686,"column":8},"end":{"line":689,"column":9}},"379":{"start":{"line":687,"column":12},"end":{"line":687,"column":93}},"380":{"start":{"line":688,"column":12},"end":{"line":688,"column":33}},"381":{"start":{"line":690,"column":8},"end":{"line":692,"column":9}},"382":{"start":{"line":691,"column":12},"end":{"line":691,"column":30}},"383":{"start":{"line":693,"column":8},"end":{"line":709,"column":9}},"384":{"start":{"line":694,"column":12},"end":{"line":708,"column":15}},"385":{"start":{"line":695,"column":16},"end":{"line":707,"column":17}},"386":{"start":{"line":696,"column":20},"end":{"line":696,"column":61}},"387":{"start":{"line":699,"column":20},"end":{"line":699,"column":47}},"388":{"start":{"line":700,"column":20},"end":{"line":705,"column":21}},"389":{"start":{"line":701,"column":24},"end":{"line":701,"column":54}},"390":{"start":{"line":704,"column":24},"end":{"line":704,"column":44}},"391":{"start":{"line":706,"column":20},"end":{"line":706,"column":60}},"392":{"start":{"line":710,"column":8},"end":{"line":710,"column":46}},"393":{"start":{"line":713,"column":4},"end":{"line":728,"column":5}},"394":{"start":{"line":714,"column":8},"end":{"line":714,"column":36}},"395":{"start":{"line":715,"column":8},"end":{"line":715,"column":52}},"396":{"start":{"line":717,"column":8},"end":{"line":727,"column":11}},"397":{"start":{"line":718,"column":12},"end":{"line":724,"column":16}},"398":{"start":{"line":719,"column":16},"end":{"line":721,"column":17}},"399":{"start":{"line":720,"column":20},"end":{"line":720,"column":35}},"400":{"start":{"line":722,"column":16},"end":{"line":722,"column":36}},"401":{"start":{"line":723,"column":16},"end":{"line":723,"column":30}},"402":{"start":{"line":726,"column":12},"end":{"line":726,"column":35}},"403":{"start":{"line":730,"column":4},"end":{"line":732,"column":6}},"404":{"start":{"line":731,"column":8},"end":{"line":731,"column":49}},"405":{"start":{"line":734,"column":4},"end":{"line":736,"column":6}},"406":{"start":{"line":735,"column":8},"end":{"line":735,"column":56}},"407":{"start":{"line":738,"column":4},"end":{"line":740,"column":6}},"408":{"start":{"line":739,"column":8},"end":{"line":739,"column":55}},"409":{"start":{"line":742,"column":4},"end":{"line":756,"column":6}},"410":{"start":{"line":743,"column":8},"end":{"line":754,"column":9}},"411":{"start":{"line":744,"column":12},"end":{"line":749,"column":13}},"412":{"start":{"line":745,"column":16},"end":{"line":747,"column":17}},"413":{"start":{"line":746,"column":20},"end":{"line":746,"column":56}},"414":{"start":{"line":748,"column":16},"end":{"line":748,"column":33}},"415":{"start":{"line":750,"column":12},"end":{"line":752,"column":14}},"416":{"start":{"line":751,"column":16},"end":{"line":751,"column":82}},"417":{"start":{"line":753,"column":12},"end":{"line":753,"column":22}},"418":{"start":{"line":755,"column":8},"end":{"line":755,"column":31}},"419":{"start":{"line":758,"column":4},"end":{"line":764,"column":7}},"420":{"start":{"line":759,"column":8},"end":{"line":763,"column":11}},"421":{"start":{"line":760,"column":12},"end":{"line":762,"column":14}},"422":{"start":{"line":766,"column":4},"end":{"line":776,"column":5}},"423":{"start":{"line":767,"column":8},"end":{"line":767,"column":24}},"424":{"start":{"line":768,"column":8},"end":{"line":775,"column":11}},"425":{"start":{"line":769,"column":12},"end":{"line":772,"column":15}},"426":{"start":{"line":770,"column":16},"end":{"line":770,"column":48}},"427":{"start":{"line":771,"column":16},"end":{"line":771,"column":24}},"428":{"start":{"line":774,"column":12},"end":{"line":774,"column":34}},"429":{"start":{"line":777,"column":4},"end":{"line":777,"column":39}},"430":{"start":{"line":778,"column":4},"end":{"line":778,"column":43}},"431":{"start":{"line":780,"column":4},"end":{"line":796,"column":6}},"432":{"start":{"line":781,"column":8},"end":{"line":781,"column":36}},"433":{"start":{"line":782,"column":8},"end":{"line":795,"column":9}},"434":{"start":{"line":783,"column":12},"end":{"line":791,"column":15}},"435":{"start":{"line":784,"column":16},"end":{"line":790,"column":17}},"436":{"start":{"line":785,"column":20},"end":{"line":785,"column":34}},"437":{"start":{"line":786,"column":23},"end":{"line":790,"column":17}},"438":{"start":{"line":787,"column":20},"end":{"line":787,"column":35}},"439":{"start":{"line":789,"column":20},"end":{"line":789,"column":62}},"440":{"start":{"line":792,"column":12},"end":{"line":792,"column":27}},"441":{"start":{"line":794,"column":12},"end":{"line":794,"column":27}},"442":{"start":{"line":798,"column":4},"end":{"line":803,"column":6}},"443":{"start":{"line":799,"column":8},"end":{"line":799,"column":22}},"444":{"start":{"line":800,"column":8},"end":{"line":802,"column":31}},"445":{"start":{"line":801,"column":12},"end":{"line":801,"column":63}},"446":{"start":{"line":805,"column":4},"end":{"line":809,"column":6}},"447":{"start":{"line":806,"column":8},"end":{"line":808,"column":31}},"448":{"start":{"line":807,"column":12},"end":{"line":807,"column":48}},"449":{"start":{"line":811,"column":4},"end":{"line":815,"column":6}},"450":{"start":{"line":812,"column":8},"end":{"line":814,"column":21}},"451":{"start":{"line":813,"column":12},"end":{"line":813,"column":48}},"452":{"start":{"line":817,"column":4},"end":{"line":840,"column":6}},"453":{"start":{"line":818,"column":8},"end":{"line":818,"column":36}},"454":{"start":{"line":820,"column":8},"end":{"line":827,"column":11}},"455":{"start":{"line":821,"column":12},"end":{"line":826,"column":13}},"456":{"start":{"line":822,"column":16},"end":{"line":822,"column":30}},"457":{"start":{"line":824,"column":16},"end":{"line":824,"column":33}},"458":{"start":{"line":825,"column":16},"end":{"line":825,"column":39}},"459":{"start":{"line":829,"column":8},"end":{"line":837,"column":10}},"460":{"start":{"line":830,"column":12},"end":{"line":836,"column":13}},"461":{"start":{"line":831,"column":16},"end":{"line":831,"column":30}},"462":{"start":{"line":832,"column":19},"end":{"line":836,"column":13}},"463":{"start":{"line":833,"column":16},"end":{"line":833,"column":31}},"464":{"start":{"line":835,"column":16},"end":{"line":835,"column":31}},"465":{"start":{"line":839,"column":8},"end":{"line":839,"column":20}},"466":{"start":{"line":842,"column":4},"end":{"line":851,"column":6}},"467":{"start":{"line":843,"column":8},"end":{"line":843,"column":22}},"468":{"start":{"line":844,"column":8},"end":{"line":850,"column":31}},"469":{"start":{"line":845,"column":12},"end":{"line":849,"column":13}},"470":{"start":{"line":846,"column":16},"end":{"line":846,"column":33}},"471":{"start":{"line":848,"column":16},"end":{"line":848,"column":44}},"472":{"start":{"line":853,"column":4},"end":{"line":983,"column":5}},"473":{"start":{"line":854,"column":8},"end":{"line":859,"column":9}},"474":{"start":{"line":855,"column":12},"end":{"line":855,"column":28}},"475":{"start":{"line":857,"column":13},"end":{"line":859,"column":9}},"476":{"start":{"line":858,"column":12},"end":{"line":858,"column":60}},"477":{"start":{"line":860,"column":8},"end":{"line":891,"column":9}},"478":{"start":{"line":861,"column":12},"end":{"line":863,"column":13}},"479":{"start":{"line":862,"column":16},"end":{"line":862,"column":68}},"480":{"start":{"line":864,"column":12},"end":{"line":864,"column":29}},"481":{"start":{"line":865,"column":12},"end":{"line":867,"column":13}},"482":{"start":{"line":866,"column":16},"end":{"line":866,"column":30}},"483":{"start":{"line":868,"column":12},"end":{"line":873,"column":13}},"484":{"start":{"line":870,"column":16},"end":{"line":872,"column":19}},"485":{"start":{"line":871,"column":20},"end":{"line":871,"column":30}},"486":{"start":{"line":874,"column":12},"end":{"line":889,"column":15}},"487":{"start":{"line":875,"column":16},"end":{"line":878,"column":18}},"488":{"start":{"line":880,"column":16},"end":{"line":884,"column":17}},"489":{"start":{"line":881,"column":20},"end":{"line":881,"column":42}},"490":{"start":{"line":883,"column":20},"end":{"line":883,"column":39}},"491":{"start":{"line":886,"column":16},"end":{"line":888,"column":17}},"492":{"start":{"line":887,"column":20},"end":{"line":887,"column":34}},"493":{"start":{"line":890,"column":12},"end":{"line":890,"column":42}},"494":{"start":{"line":892,"column":8},"end":{"line":913,"column":9}},"495":{"start":{"line":893,"column":12},"end":{"line":912,"column":14}},"496":{"start":{"line":894,"column":16},"end":{"line":894,"column":29}},"497":{"start":{"line":896,"column":16},"end":{"line":896,"column":36}},"498":{"start":{"line":897,"column":16},"end":{"line":897,"column":37}},"499":{"start":{"line":898,"column":16},"end":{"line":907,"column":19}},"500":{"start":{"line":899,"column":20},"end":{"line":904,"column":23}},"501":{"start":{"line":900,"column":24},"end":{"line":903,"column":25}},"502":{"start":{"line":901,"column":28},"end":{"line":901,"column":57}},"503":{"start":{"line":902,"column":28},"end":{"line":902,"column":43}},"504":{"start":{"line":906,"column":20},"end":{"line":906,"column":52}},"505":{"start":{"line":908,"column":16},"end":{"line":910,"column":17}},"506":{"start":{"line":909,"column":20},"end":{"line":909,"column":30}},"507":{"start":{"line":911,"column":16},"end":{"line":911,"column":28}},"508":{"start":{"line":915,"column":8},"end":{"line":915,"column":24}},"509":{"start":{"line":916,"column":8},"end":{"line":916,"column":29}},"510":{"start":{"line":917,"column":8},"end":{"line":981,"column":10}},"511":{"start":{"line":927,"column":16},"end":{"line":927,"column":50}},"512":{"start":{"line":930,"column":16},"end":{"line":930,"column":31}},"513":{"start":{"line":931,"column":16},"end":{"line":931,"column":29}},"514":{"start":{"line":934,"column":16},"end":{"line":934,"column":49}},"515":{"start":{"line":937,"column":16},"end":{"line":954,"column":17}},"516":{"start":{"line":939,"column":20},"end":{"line":941,"column":58}},"517":{"start":{"line":943,"column":20},"end":{"line":945,"column":23}},"518":{"start":{"line":944,"column":24},"end":{"line":944,"column":41}},"519":{"start":{"line":947,"column":20},"end":{"line":949,"column":21}},"520":{"start":{"line":948,"column":24},"end":{"line":948,"column":34}},"521":{"start":{"line":950,"column":20},"end":{"line":950,"column":33}},"522":{"start":{"line":951,"column":20},"end":{"line":951,"column":47}},"523":{"start":{"line":952,"column":20},"end":{"line":952,"column":56}},"524":{"start":{"line":953,"column":20},"end":{"line":953,"column":37}},"525":{"start":{"line":957,"column":16},"end":{"line":957,"column":38}},"526":{"start":{"line":960,"column":16},"end":{"line":960,"column":31}},"527":{"start":{"line":963,"column":16},"end":{"line":963,"column":35}},"528":{"start":{"line":966,"column":16},"end":{"line":966,"column":54}},"529":{"start":{"line":969,"column":16},"end":{"line":969,"column":32}},"530":{"start":{"line":972,"column":16},"end":{"line":972,"column":51}},"531":{"start":{"line":972,"column":42},"end":{"line":972,"column":49}},"532":{"start":{"line":973,"column":16},"end":{"line":973,"column":33}},"533":{"start":{"line":974,"column":16},"end":{"line":974,"column":74}},"534":{"start":{"line":977,"column":16},"end":{"line":979,"column":17}},"535":{"start":{"line":978,"column":20},"end":{"line":978,"column":50}},"536":{"start":{"line":982,"column":8},"end":{"line":982,"column":17}},"537":{"start":{"line":985,"column":4},"end":{"line":991,"column":6}},"538":{"start":{"line":986,"column":8},"end":{"line":988,"column":27}},"539":{"start":{"line":987,"column":12},"end":{"line":987,"column":33}},"540":{"start":{"line":990,"column":8},"end":{"line":990,"column":17}},"541":{"start":{"line":993,"column":4},"end":{"line":1055,"column":6}},"542":{"start":{"line":995,"column":8},"end":{"line":997,"column":9}},"543":{"start":{"line":996,"column":12},"end":{"line":996,"column":43}},"544":{"start":{"line":999,"column":8},"end":{"line":1011,"column":9}},"545":{"start":{"line":1000,"column":12},"end":{"line":1001,"column":42}},"546":{"start":{"line":1002,"column":12},"end":{"line":1009,"column":13}},"547":{"start":{"line":1003,"column":16},"end":{"line":1003,"column":56}},"548":{"start":{"line":1004,"column":16},"end":{"line":1008,"column":17}},"549":{"start":{"line":1005,"column":20},"end":{"line":1005,"column":30}},"550":{"start":{"line":1007,"column":20},"end":{"line":1007,"column":34}},"551":{"start":{"line":1010,"column":12},"end":{"line":1010,"column":23}},"552":{"start":{"line":1013,"column":8},"end":{"line":1041,"column":9}},"553":{"start":{"line":1014,"column":12},"end":{"line":1016,"column":13}},"554":{"start":{"line":1015,"column":16},"end":{"line":1015,"column":68}},"555":{"start":{"line":1017,"column":12},"end":{"line":1017,"column":29}},"556":{"start":{"line":1018,"column":12},"end":{"line":1020,"column":13}},"557":{"start":{"line":1019,"column":16},"end":{"line":1019,"column":30}},"558":{"start":{"line":1021,"column":12},"end":{"line":1026,"column":13}},"559":{"start":{"line":1023,"column":16},"end":{"line":1025,"column":19}},"560":{"start":{"line":1024,"column":20},"end":{"line":1024,"column":30}},"561":{"start":{"line":1027,"column":12},"end":{"line":1040,"column":15}},"562":{"start":{"line":1028,"column":16},"end":{"line":1032,"column":18}},"563":{"start":{"line":1034,"column":16},"end":{"line":1034,"column":89}},"564":{"start":{"line":1036,"column":16},"end":{"line":1038,"column":17}},"565":{"start":{"line":1037,"column":20},"end":{"line":1037,"column":34}},"566":{"start":{"line":1039,"column":16},"end":{"line":1039,"column":46}},"567":{"start":{"line":1044,"column":8},"end":{"line":1044,"column":49}},"568":{"start":{"line":1047,"column":8},"end":{"line":1049,"column":10}},"569":{"start":{"line":1048,"column":12},"end":{"line":1048,"column":49}},"570":{"start":{"line":1052,"column":8},"end":{"line":1052,"column":25}},"571":{"start":{"line":1054,"column":8},"end":{"line":1054,"column":17}},"572":{"start":{"line":1057,"column":4},"end":{"line":1059,"column":6}},"573":{"start":{"line":1058,"column":8},"end":{"line":1058,"column":42}},"574":{"start":{"line":1061,"column":4},"end":{"line":1078,"column":5}},"575":{"start":{"line":1062,"column":8},"end":{"line":1077,"column":11}},"576":{"start":{"line":1063,"column":12},"end":{"line":1076,"column":18}},"577":{"start":{"line":1064,"column":16},"end":{"line":1075,"column":17}},"578":{"start":{"line":1065,"column":20},"end":{"line":1074,"column":21}},"579":{"start":{"line":1066,"column":24},"end":{"line":1068,"column":25}},"580":{"start":{"line":1067,"column":28},"end":{"line":1067,"column":47}},"581":{"start":{"line":1070,"column":25},"end":{"line":1074,"column":21}},"582":{"start":{"line":1071,"column":24},"end":{"line":1073,"column":27}},"583":{"start":{"line":1072,"column":28},"end":{"line":1072,"column":45}},"584":{"start":{"line":1079,"column":4},"end":{"line":1079,"column":35}},"585":{"start":{"line":1080,"column":4},"end":{"line":1080,"column":35}},"586":{"start":{"line":1085,"column":4},"end":{"line":1116,"column":6}},"587":{"start":{"line":1086,"column":8},"end":{"line":1086,"column":22}},"588":{"start":{"line":1087,"column":8},"end":{"line":1087,"column":24}},"589":{"start":{"line":1088,"column":8},"end":{"line":1088,"column":50}},"590":{"start":{"line":1089,"column":8},"end":{"line":1089,"column":36}},"591":{"start":{"line":1090,"column":8},"end":{"line":1112,"column":11}},"592":{"start":{"line":1091,"column":12},"end":{"line":1091,"column":38}},"593":{"start":{"line":1092,"column":12},"end":{"line":1092,"column":47}},"594":{"start":{"line":1093,"column":12},"end":{"line":1111,"column":13}},"595":{"start":{"line":1094,"column":16},"end":{"line":1096,"column":19}},"596":{"start":{"line":1095,"column":20},"end":{"line":1095,"column":52}},"597":{"start":{"line":1098,"column":17},"end":{"line":1111,"column":13}},"598":{"start":{"line":1099,"column":16},"end":{"line":1099,"column":43}},"599":{"start":{"line":1102,"column":16},"end":{"line":1102,"column":41}},"600":{"start":{"line":1103,"column":16},"end":{"line":1110,"column":22}},"601":{"start":{"line":1104,"column":20},"end":{"line":1104,"column":37}},"602":{"start":{"line":1105,"column":20},"end":{"line":1105,"column":40}},"603":{"start":{"line":1106,"column":20},"end":{"line":1106,"column":39}},"604":{"start":{"line":1107,"column":20},"end":{"line":1109,"column":21}},"605":{"start":{"line":1108,"column":24},"end":{"line":1108,"column":47}},"606":{"start":{"line":1113,"column":8},"end":{"line":1113,"column":29}},"607":{"start":{"line":1114,"column":8},"end":{"line":1114,"column":33}},"608":{"start":{"line":1115,"column":8},"end":{"line":1115,"column":24}},"609":{"start":{"line":1118,"column":4},"end":{"line":1122,"column":6}},"610":{"start":{"line":1119,"column":8},"end":{"line":1121,"column":10}},"611":{"start":{"line":1120,"column":12},"end":{"line":1120,"column":64}},"612":{"start":{"line":1124,"column":4},"end":{"line":1128,"column":5}},"613":{"start":{"line":1125,"column":8},"end":{"line":1127,"column":10}},"614":{"start":{"line":1126,"column":12},"end":{"line":1126,"column":54}},"615":{"start":{"line":1130,"column":4},"end":{"line":1130,"column":36}},"616":{"start":{"line":1131,"column":4},"end":{"line":1131,"column":48}},"617":{"start":{"line":1132,"column":4},"end":{"line":1134,"column":6}},"618":{"start":{"line":1133,"column":8},"end":{"line":1133,"column":72}},"619":{"start":{"line":1136,"column":4},"end":{"line":1157,"column":6}},"620":{"start":{"line":1137,"column":8},"end":{"line":1137,"column":28}},"621":{"start":{"line":1138,"column":8},"end":{"line":1156,"column":11}},"622":{"start":{"line":1139,"column":12},"end":{"line":1139,"column":28}},"623":{"start":{"line":1141,"column":12},"end":{"line":1141,"column":49}},"624":{"start":{"line":1142,"column":12},"end":{"line":1146,"column":13}},"625":{"start":{"line":1143,"column":16},"end":{"line":1143,"column":27}},"626":{"start":{"line":1145,"column":16},"end":{"line":1145,"column":32}},"627":{"start":{"line":1148,"column":12},"end":{"line":1155,"column":15}},"628":{"start":{"line":1149,"column":16},"end":{"line":1151,"column":22}},"629":{"start":{"line":1150,"column":20},"end":{"line":1150,"column":38}},"630":{"start":{"line":1154,"column":16},"end":{"line":1154,"column":60}},"631":{"start":{"line":1159,"column":4},"end":{"line":1161,"column":6}},"632":{"start":{"line":1160,"column":8},"end":{"line":1160,"column":78}},"633":{"start":{"line":1164,"column":4},"end":{"line":1181,"column":5}},"634":{"start":{"line":1165,"column":8},"end":{"line":1180,"column":11}},"635":{"start":{"line":1166,"column":12},"end":{"line":1173,"column":15}},"636":{"start":{"line":1167,"column":16},"end":{"line":1167,"column":32}},"637":{"start":{"line":1168,"column":16},"end":{"line":1168,"column":42}},"638":{"start":{"line":1169,"column":16},"end":{"line":1172,"column":26}},"639":{"start":{"line":1170,"column":20},"end":{"line":1170,"column":54}},"640":{"start":{"line":1174,"column":12},"end":{"line":1179,"column":13}},"641":{"start":{"line":1175,"column":16},"end":{"line":1175,"column":44}},"642":{"start":{"line":1178,"column":16},"end":{"line":1178,"column":26}},"643":{"start":{"line":1183,"column":4},"end":{"line":1183,"column":47}},"644":{"start":{"line":1184,"column":4},"end":{"line":1184,"column":59}},"645":{"start":{"line":1187,"column":4},"end":{"line":1197,"column":6}},"646":{"start":{"line":1188,"column":8},"end":{"line":1188,"column":47}},"647":{"start":{"line":1189,"column":8},"end":{"line":1189,"column":35}},"648":{"start":{"line":1190,"column":8},"end":{"line":1195,"column":9}},"649":{"start":{"line":1191,"column":12},"end":{"line":1193,"column":13}},"650":{"start":{"line":1192,"column":16},"end":{"line":1192,"column":33}},"651":{"start":{"line":1194,"column":12},"end":{"line":1194,"column":23}},"652":{"start":{"line":1196,"column":8},"end":{"line":1196,"column":15}},"653":{"start":{"line":1199,"column":4},"end":{"line":1216,"column":5}},"654":{"start":{"line":1200,"column":8},"end":{"line":1215,"column":11}},"655":{"start":{"line":1201,"column":12},"end":{"line":1201,"column":38}},"656":{"start":{"line":1202,"column":12},"end":{"line":1211,"column":15}},"657":{"start":{"line":1203,"column":16},"end":{"line":1203,"column":42}},"658":{"start":{"line":1204,"column":16},"end":{"line":1210,"column":17}},"659":{"start":{"line":1205,"column":20},"end":{"line":1207,"column":23}},"660":{"start":{"line":1206,"column":24},"end":{"line":1206,"column":56}},"661":{"start":{"line":1209,"column":20},"end":{"line":1209,"column":52}},"662":{"start":{"line":1212,"column":12},"end":{"line":1212,"column":28}},"663":{"start":{"line":1213,"column":12},"end":{"line":1213,"column":33}},"664":{"start":{"line":1214,"column":12},"end":{"line":1214,"column":25}},"665":{"start":{"line":1218,"column":4},"end":{"line":1218,"column":36}},"666":{"start":{"line":1220,"column":4},"end":{"line":1225,"column":7}},"667":{"start":{"line":1221,"column":8},"end":{"line":1221,"column":41}},"668":{"start":{"line":1222,"column":8},"end":{"line":1224,"column":10}},"669":{"start":{"line":1223,"column":12},"end":{"line":1223,"column":46}},"670":{"start":{"line":1227,"column":4},"end":{"line":1248,"column":6}},"671":{"start":{"line":1229,"column":8},"end":{"line":1247,"column":11}},"672":{"start":{"line":1230,"column":12},"end":{"line":1230,"column":38}},"673":{"start":{"line":1231,"column":12},"end":{"line":1231,"column":23}},"674":{"start":{"line":1232,"column":12},"end":{"line":1236,"column":13}},"675":{"start":{"line":1233,"column":16},"end":{"line":1233,"column":48}},"676":{"start":{"line":1235,"column":16},"end":{"line":1235,"column":35}},"677":{"start":{"line":1238,"column":12},"end":{"line":1246,"column":13}},"678":{"start":{"line":1239,"column":16},"end":{"line":1243,"column":19}},"679":{"start":{"line":1240,"column":20},"end":{"line":1240,"column":42}},"680":{"start":{"line":1242,"column":20},"end":{"line":1242,"column":65}},"681":{"start":{"line":1245,"column":16},"end":{"line":1245,"column":39}},"682":{"start":{"line":1251,"column":4},"end":{"line":1263,"column":5}},"683":{"start":{"line":1252,"column":8},"end":{"line":1252,"column":31}},"684":{"start":{"line":1255,"column":9},"end":{"line":1263,"column":5}},"685":{"start":{"line":1256,"column":8},"end":{"line":1258,"column":11}},"686":{"start":{"line":1257,"column":12},"end":{"line":1257,"column":25}},"687":{"start":{"line":1262,"column":8},"end":{"line":1262,"column":27}}},"branchMap":{"1":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":15},"end":{"line":28,"column":39}},{"start":{"line":28,"column":43},"end":{"line":28,"column":61}},{"start":{"line":28,"column":65},"end":{"line":28,"column":69}},{"start":{"line":29,"column":12},"end":{"line":29,"column":38}},{"start":{"line":29,"column":42},"end":{"line":29,"column":66}},{"start":{"line":29,"column":70},"end":{"line":29,"column":76}},{"start":{"line":30,"column":12},"end":{"line":30,"column":16}}]},"2":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":4},"end":{"line":32,"column":4}},{"start":{"line":32,"column":4},"end":{"line":32,"column":4}}]},"3":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":12},"end":{"line":43,"column":12}},{"start":{"line":43,"column":12},"end":{"line":43,"column":12}}]},"4":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":12},"end":{"line":51,"column":12}},{"start":{"line":51,"column":12},"end":{"line":51,"column":12}}]},"5":{"line":61,"type":"binary-expr","locations":[{"start":{"line":61,"column":19},"end":{"line":61,"column":32}},{"start":{"line":61,"column":36},"end":{"line":63,"column":5}}]},"6":{"line":68,"type":"binary-expr","locations":[{"start":{"line":68,"column":15},"end":{"line":68,"column":34}},{"start":{"line":68,"column":38},"end":{"line":68,"column":55}},{"start":{"line":68,"column":59},"end":{"line":68,"column":64}}]},"7":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":15},"end":{"line":72,"column":28}},{"start":{"line":74,"column":12},"end":{"line":74,"column":42}},{"start":{"line":75,"column":12},"end":{"line":75,"column":27}},{"start":{"line":76,"column":12},"end":{"line":76,"column":32}}]},"8":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":12},"end":{"line":119,"column":12}},{"start":{"line":119,"column":12},"end":{"line":119,"column":12}}]},"9":{"line":124,"type":"binary-expr","locations":[{"start":{"line":124,"column":16},"end":{"line":124,"column":27}},{"start":{"line":124,"column":31},"end":{"line":132,"column":5}}]},"10":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":12},"end":{"line":127,"column":12}},{"start":{"line":127,"column":12},"end":{"line":127,"column":12}}]},"11":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":8},"end":{"line":138,"column":8}},{"start":{"line":138,"column":8},"end":{"line":138,"column":8}}]},"12":{"line":142,"type":"cond-expr","locations":[{"start":{"line":142,"column":33},"end":{"line":142,"column":34}},{"start":{"line":142,"column":37},"end":{"line":142,"column":41}}]},"13":{"line":149,"type":"cond-expr","locations":[{"start":{"line":149,"column":33},"end":{"line":149,"column":40}},{"start":{"line":149,"column":43},"end":{"line":149,"column":47}}]},"14":{"line":158,"type":"cond-expr","locations":[{"start":{"line":158,"column":42},"end":{"line":158,"column":57}},{"start":{"line":158,"column":60},"end":{"line":158,"column":71}}]},"15":{"line":165,"type":"switch","locations":[{"start":{"line":166,"column":16},"end":{"line":166,"column":53}},{"start":{"line":167,"column":16},"end":{"line":167,"column":67}}]},"16":{"line":190,"type":"binary-expr","locations":[{"start":{"line":190,"column":24},"end":{"line":190,"column":58}},{"start":{"line":190,"column":62},"end":{"line":190,"column":74}}]},"17":{"line":192,"type":"cond-expr","locations":[{"start":{"line":192,"column":33},"end":{"line":195,"column":5}},{"start":{"line":195,"column":8},"end":{"line":197,"column":5}}]},"18":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":4},"end":{"line":199,"column":4}},{"start":{"line":199,"column":4},"end":{"line":199,"column":4}}]},"19":{"line":199,"type":"binary-expr","locations":[{"start":{"line":199,"column":8},"end":{"line":199,"column":35}},{"start":{"line":199,"column":39},"end":{"line":199,"column":77}}]},"20":{"line":204,"type":"cond-expr","locations":[{"start":{"line":204,"column":41},"end":{"line":204,"column":47}},{"start":{"line":204,"column":50},"end":{"line":204,"column":64}}]},"21":{"line":225,"type":"binary-expr","locations":[{"start":{"line":225,"column":25},"end":{"line":225,"column":33}},{"start":{"line":225,"column":37},"end":{"line":225,"column":41}}]},"22":{"line":226,"type":"binary-expr","locations":[{"start":{"line":226,"column":17},"end":{"line":226,"column":23}},{"start":{"line":226,"column":27},"end":{"line":226,"column":29}}]},"23":{"line":236,"type":"if","locations":[{"start":{"line":236,"column":8},"end":{"line":236,"column":8}},{"start":{"line":236,"column":8},"end":{"line":236,"column":8}}]},"24":{"line":240,"type":"if","locations":[{"start":{"line":240,"column":12},"end":{"line":240,"column":12}},{"start":{"line":240,"column":12},"end":{"line":240,"column":12}}]},"25":{"line":245,"type":"if","locations":[{"start":{"line":245,"column":17},"end":{"line":245,"column":17}},{"start":{"line":245,"column":17},"end":{"line":245,"column":17}}]},"26":{"line":245,"type":"binary-expr","locations":[{"start":{"line":245,"column":21},"end":{"line":245,"column":33}},{"start":{"line":245,"column":37},"end":{"line":245,"column":51}}]},"27":{"line":253,"type":"binary-expr","locations":[{"start":{"line":253,"column":25},"end":{"line":253,"column":33}},{"start":{"line":253,"column":37},"end":{"line":253,"column":41}}]},"28":{"line":254,"type":"binary-expr","locations":[{"start":{"line":254,"column":14},"end":{"line":254,"column":17}},{"start":{"line":254,"column":21},"end":{"line":254,"column":23}}]},"29":{"line":259,"type":"if","locations":[{"start":{"line":259,"column":12},"end":{"line":259,"column":12}},{"start":{"line":259,"column":12},"end":{"line":259,"column":12}}]},"30":{"line":263,"type":"if","locations":[{"start":{"line":263,"column":16},"end":{"line":263,"column":16}},{"start":{"line":263,"column":16},"end":{"line":263,"column":16}}]},"31":{"line":268,"type":"if","locations":[{"start":{"line":268,"column":20},"end":{"line":268,"column":20}},{"start":{"line":268,"column":20},"end":{"line":268,"column":20}}]},"32":{"line":271,"type":"if","locations":[{"start":{"line":271,"column":24},"end":{"line":271,"column":24}},{"start":{"line":271,"column":24},"end":{"line":271,"column":24}}]},"33":{"line":294,"type":"binary-expr","locations":[{"start":{"line":294,"column":29},"end":{"line":294,"column":37}},{"start":{"line":294,"column":41},"end":{"line":294,"column":45}}]},"34":{"line":295,"type":"binary-expr","locations":[{"start":{"line":295,"column":18},"end":{"line":295,"column":21}},{"start":{"line":295,"column":25},"end":{"line":295,"column":27}}]},"35":{"line":297,"type":"if","locations":[{"start":{"line":297,"column":12},"end":{"line":297,"column":12}},{"start":{"line":297,"column":12},"end":{"line":297,"column":12}}]},"36":{"line":305,"type":"if","locations":[{"start":{"line":305,"column":16},"end":{"line":305,"column":16}},{"start":{"line":305,"column":16},"end":{"line":305,"column":16}}]},"37":{"line":305,"type":"binary-expr","locations":[{"start":{"line":305,"column":20},"end":{"line":305,"column":24}},{"start":{"line":305,"column":28},"end":{"line":305,"column":40}}]},"38":{"line":309,"type":"binary-expr","locations":[{"start":{"line":309,"column":23},"end":{"line":309,"column":38}},{"start":{"line":309,"column":42},"end":{"line":309,"column":50}}]},"39":{"line":311,"type":"if","locations":[{"start":{"line":311,"column":20},"end":{"line":311,"column":20}},{"start":{"line":311,"column":20},"end":{"line":311,"column":20}}]},"40":{"line":313,"type":"if","locations":[{"start":{"line":313,"column":24},"end":{"line":313,"column":24}},{"start":{"line":313,"column":24},"end":{"line":313,"column":24}}]},"41":{"line":321,"type":"if","locations":[{"start":{"line":321,"column":24},"end":{"line":321,"column":24}},{"start":{"line":321,"column":24},"end":{"line":321,"column":24}}]},"42":{"line":352,"type":"binary-expr","locations":[{"start":{"line":352,"column":25},"end":{"line":352,"column":33}},{"start":{"line":352,"column":37},"end":{"line":352,"column":41}}]},"43":{"line":353,"type":"binary-expr","locations":[{"start":{"line":353,"column":14},"end":{"line":353,"column":17}},{"start":{"line":353,"column":21},"end":{"line":353,"column":23}}]},"44":{"line":354,"type":"cond-expr","locations":[{"start":{"line":354,"column":42},"end":{"line":354,"column":44}},{"start":{"line":354,"column":47},"end":{"line":354,"column":49}}]},"45":{"line":391,"type":"if","locations":[{"start":{"line":391,"column":8},"end":{"line":391,"column":8}},{"start":{"line":391,"column":8},"end":{"line":391,"column":8}}]},"46":{"line":394,"type":"cond-expr","locations":[{"start":{"line":394,"column":35},"end":{"line":394,"column":37}},{"start":{"line":394,"column":40},"end":{"line":394,"column":42}}]},"47":{"line":408,"type":"if","locations":[{"start":{"line":408,"column":16},"end":{"line":408,"column":16}},{"start":{"line":408,"column":16},"end":{"line":408,"column":16}}]},"48":{"line":445,"type":"if","locations":[{"start":{"line":445,"column":16},"end":{"line":445,"column":16}},{"start":{"line":445,"column":16},"end":{"line":445,"column":16}}]},"49":{"line":448,"type":"if","locations":[{"start":{"line":448,"column":16},"end":{"line":448,"column":16}},{"start":{"line":448,"column":16},"end":{"line":448,"column":16}}]},"50":{"line":450,"type":"if","locations":[{"start":{"line":450,"column":20},"end":{"line":450,"column":20}},{"start":{"line":450,"column":20},"end":{"line":450,"column":20}}]},"51":{"line":450,"type":"binary-expr","locations":[{"start":{"line":450,"column":24},"end":{"line":450,"column":26}},{"start":{"line":450,"column":30},"end":{"line":450,"column":38}}]},"52":{"line":457,"type":"if","locations":[{"start":{"line":457,"column":12},"end":{"line":457,"column":12}},{"start":{"line":457,"column":12},"end":{"line":457,"column":12}}]},"53":{"line":487,"type":"if","locations":[{"start":{"line":487,"column":16},"end":{"line":487,"column":16}},{"start":{"line":487,"column":16},"end":{"line":487,"column":16}}]},"54":{"line":495,"type":"if","locations":[{"start":{"line":495,"column":12},"end":{"line":495,"column":12}},{"start":{"line":495,"column":12},"end":{"line":495,"column":12}}]},"55":{"line":508,"type":"cond-expr","locations":[{"start":{"line":508,"column":27},"end":{"line":508,"column":29}},{"start":{"line":508,"column":32},"end":{"line":508,"column":45}}]},"56":{"line":508,"type":"cond-expr","locations":[{"start":{"line":508,"column":40},"end":{"line":508,"column":41}},{"start":{"line":508,"column":44},"end":{"line":508,"column":45}}]},"57":{"line":513,"type":"if","locations":[{"start":{"line":513,"column":8},"end":{"line":513,"column":8}},{"start":{"line":513,"column":8},"end":{"line":513,"column":8}}]},"58":{"line":518,"type":"binary-expr","locations":[{"start":{"line":518,"column":25},"end":{"line":518,"column":33}},{"start":{"line":518,"column":37},"end":{"line":518,"column":41}}]},"59":{"line":521,"type":"if","locations":[{"start":{"line":521,"column":8},"end":{"line":521,"column":8}},{"start":{"line":521,"column":8},"end":{"line":521,"column":8}}]},"60":{"line":524,"type":"if","locations":[{"start":{"line":524,"column":8},"end":{"line":524,"column":8}},{"start":{"line":524,"column":8},"end":{"line":524,"column":8}}]},"61":{"line":539,"type":"if","locations":[{"start":{"line":539,"column":12},"end":{"line":539,"column":12}},{"start":{"line":539,"column":12},"end":{"line":539,"column":12}}]},"62":{"line":549,"type":"if","locations":[{"start":{"line":549,"column":12},"end":{"line":549,"column":12}},{"start":{"line":549,"column":12},"end":{"line":549,"column":12}}]},"63":{"line":555,"type":"if","locations":[{"start":{"line":555,"column":12},"end":{"line":555,"column":12}},{"start":{"line":555,"column":12},"end":{"line":555,"column":12}}]},"64":{"line":556,"type":"cond-expr","locations":[{"start":{"line":556,"column":44},"end":{"line":556,"column":52}},{"start":{"line":556,"column":54},"end":{"line":556,"column":64}}]},"65":{"line":559,"type":"if","locations":[{"start":{"line":559,"column":16},"end":{"line":559,"column":16}},{"start":{"line":559,"column":16},"end":{"line":559,"column":16}}]},"66":{"line":562,"type":"if","locations":[{"start":{"line":562,"column":16},"end":{"line":562,"column":16}},{"start":{"line":562,"column":16},"end":{"line":562,"column":16}}]},"67":{"line":582,"type":"if","locations":[{"start":{"line":582,"column":16},"end":{"line":582,"column":16}},{"start":{"line":582,"column":16},"end":{"line":582,"column":16}}]},"68":{"line":585,"type":"if","locations":[{"start":{"line":585,"column":16},"end":{"line":585,"column":16}},{"start":{"line":585,"column":16},"end":{"line":585,"column":16}}]},"69":{"line":585,"type":"binary-expr","locations":[{"start":{"line":585,"column":20},"end":{"line":585,"column":33}},{"start":{"line":585,"column":37},"end":{"line":585,"column":58}}]},"70":{"line":590,"type":"binary-expr","locations":[{"start":{"line":590,"column":23},"end":{"line":590,"column":49}},{"start":{"line":590,"column":53},"end":{"line":592,"column":24}},{"start":{"line":592,"column":28},"end":{"line":592,"column":54}}]},"71":{"line":591,"type":"binary-expr","locations":[{"start":{"line":591,"column":28},"end":{"line":591,"column":29}},{"start":{"line":591,"column":33},"end":{"line":591,"column":58}}]},"72":{"line":594,"type":"if","locations":[{"start":{"line":594,"column":12},"end":{"line":594,"column":12}},{"start":{"line":594,"column":12},"end":{"line":594,"column":12}}]},"73":{"line":602,"type":"if","locations":[{"start":{"line":602,"column":16},"end":{"line":602,"column":16}},{"start":{"line":602,"column":16},"end":{"line":602,"column":16}}]},"74":{"line":625,"type":"if","locations":[{"start":{"line":625,"column":12},"end":{"line":625,"column":12}},{"start":{"line":625,"column":12},"end":{"line":625,"column":12}}]},"75":{"line":626,"type":"binary-expr","locations":[{"start":{"line":626,"column":28},"end":{"line":626,"column":43}},{"start":{"line":626,"column":47},"end":{"line":626,"column":60}}]},"76":{"line":627,"type":"if","locations":[{"start":{"line":627,"column":19},"end":{"line":627,"column":19}},{"start":{"line":627,"column":19},"end":{"line":627,"column":19}}]},"77":{"line":628,"type":"binary-expr","locations":[{"start":{"line":628,"column":28},"end":{"line":628,"column":49}},{"start":{"line":628,"column":53},"end":{"line":628,"column":66}}]},"78":{"line":629,"type":"binary-expr","locations":[{"start":{"line":629,"column":31},"end":{"line":629,"column":55}},{"start":{"line":629,"column":59},"end":{"line":629,"column":75}}]},"79":{"line":636,"type":"if","locations":[{"start":{"line":636,"column":8},"end":{"line":636,"column":8}},{"start":{"line":636,"column":8},"end":{"line":636,"column":8}}]},"80":{"line":636,"type":"binary-expr","locations":[{"start":{"line":636,"column":12},"end":{"line":636,"column":22}},{"start":{"line":636,"column":26},"end":{"line":636,"column":36}}]},"81":{"line":638,"type":"if","locations":[{"start":{"line":638,"column":15},"end":{"line":638,"column":15}},{"start":{"line":638,"column":15},"end":{"line":638,"column":15}}]},"82":{"line":638,"type":"binary-expr","locations":[{"start":{"line":638,"column":19},"end":{"line":638,"column":30}},{"start":{"line":638,"column":34},"end":{"line":638,"column":61}}]},"83":{"line":642,"type":"if","locations":[{"start":{"line":642,"column":8},"end":{"line":642,"column":8}},{"start":{"line":642,"column":8},"end":{"line":642,"column":8}}]},"84":{"line":652,"type":"binary-expr","locations":[{"start":{"line":652,"column":39},"end":{"line":652,"column":43}},{"start":{"line":652,"column":47},"end":{"line":652,"column":59}}]},"85":{"line":669,"type":"if","locations":[{"start":{"line":669,"column":16},"end":{"line":669,"column":16}},{"start":{"line":669,"column":16},"end":{"line":669,"column":16}}]},"86":{"line":669,"type":"binary-expr","locations":[{"start":{"line":669,"column":19},"end":{"line":669,"column":32}},{"start":{"line":669,"column":36},"end":{"line":669,"column":53}}]},"87":{"line":676,"type":"binary-expr","locations":[{"start":{"line":676,"column":17},"end":{"line":676,"column":32}},{"start":{"line":676,"column":36},"end":{"line":676,"column":49}}]},"88":{"line":681,"type":"cond-expr","locations":[{"start":{"line":681,"column":31},"end":{"line":681,"column":44}},{"start":{"line":681,"column":47},"end":{"line":681,"column":58}}]},"89":{"line":685,"type":"binary-expr","locations":[{"start":{"line":685,"column":25},"end":{"line":685,"column":33}},{"start":{"line":685,"column":37},"end":{"line":685,"column":41}}]},"90":{"line":686,"type":"if","locations":[{"start":{"line":686,"column":8},"end":{"line":686,"column":8}},{"start":{"line":686,"column":8},"end":{"line":686,"column":8}}]},"91":{"line":690,"type":"if","locations":[{"start":{"line":690,"column":8},"end":{"line":690,"column":8}},{"start":{"line":690,"column":8},"end":{"line":690,"column":8}}]},"92":{"line":695,"type":"if","locations":[{"start":{"line":695,"column":16},"end":{"line":695,"column":16}},{"start":{"line":695,"column":16},"end":{"line":695,"column":16}}]},"93":{"line":700,"type":"if","locations":[{"start":{"line":700,"column":20},"end":{"line":700,"column":20}},{"start":{"line":700,"column":20},"end":{"line":700,"column":20}}]},"94":{"line":714,"type":"binary-expr","locations":[{"start":{"line":714,"column":19},"end":{"line":714,"column":27}},{"start":{"line":714,"column":31},"end":{"line":714,"column":35}}]},"95":{"line":715,"type":"cond-expr","locations":[{"start":{"line":715,"column":44},"end":{"line":715,"column":46}},{"start":{"line":715,"column":49},"end":{"line":715,"column":51}}]},"96":{"line":719,"type":"if","locations":[{"start":{"line":719,"column":16},"end":{"line":719,"column":16}},{"start":{"line":719,"column":16},"end":{"line":719,"column":16}}]},"97":{"line":745,"type":"if","locations":[{"start":{"line":745,"column":16},"end":{"line":745,"column":16}},{"start":{"line":745,"column":16},"end":{"line":745,"column":16}}]},"98":{"line":751,"type":"cond-expr","locations":[{"start":{"line":751,"column":52},"end":{"line":751,"column":75}},{"start":{"line":751,"column":77},"end":{"line":751,"column":81}}]},"99":{"line":770,"type":"binary-expr","locations":[{"start":{"line":770,"column":39},"end":{"line":770,"column":40}},{"start":{"line":770,"column":44},"end":{"line":770,"column":46}}]},"100":{"line":781,"type":"binary-expr","locations":[{"start":{"line":781,"column":19},"end":{"line":781,"column":27}},{"start":{"line":781,"column":31},"end":{"line":781,"column":35}}]},"101":{"line":782,"type":"if","locations":[{"start":{"line":782,"column":8},"end":{"line":782,"column":8}},{"start":{"line":782,"column":8},"end":{"line":782,"column":8}}]},"102":{"line":784,"type":"if","locations":[{"start":{"line":784,"column":16},"end":{"line":784,"column":16}},{"start":{"line":784,"column":16},"end":{"line":784,"column":16}}]},"103":{"line":786,"type":"if","locations":[{"start":{"line":786,"column":23},"end":{"line":786,"column":23}},{"start":{"line":786,"column":23},"end":{"line":786,"column":23}}]},"104":{"line":801,"type":"binary-expr","locations":[{"start":{"line":801,"column":19},"end":{"line":801,"column":31}},{"start":{"line":801,"column":35},"end":{"line":801,"column":62}}]},"105":{"line":818,"type":"binary-expr","locations":[{"start":{"line":818,"column":19},"end":{"line":818,"column":27}},{"start":{"line":818,"column":31},"end":{"line":818,"column":35}}]},"106":{"line":821,"type":"if","locations":[{"start":{"line":821,"column":12},"end":{"line":821,"column":12}},{"start":{"line":821,"column":12},"end":{"line":821,"column":12}}]},"107":{"line":830,"type":"if","locations":[{"start":{"line":830,"column":12},"end":{"line":830,"column":12}},{"start":{"line":830,"column":12},"end":{"line":830,"column":12}}]},"108":{"line":832,"type":"if","locations":[{"start":{"line":832,"column":19},"end":{"line":832,"column":19}},{"start":{"line":832,"column":19},"end":{"line":832,"column":19}}]},"109":{"line":845,"type":"if","locations":[{"start":{"line":845,"column":12},"end":{"line":845,"column":12}},{"start":{"line":845,"column":12},"end":{"line":845,"column":12}}]},"110":{"line":854,"type":"if","locations":[{"start":{"line":854,"column":8},"end":{"line":854,"column":8}},{"start":{"line":854,"column":8},"end":{"line":854,"column":8}}]},"111":{"line":857,"type":"if","locations":[{"start":{"line":857,"column":13},"end":{"line":857,"column":13}},{"start":{"line":857,"column":13},"end":{"line":857,"column":13}}]},"112":{"line":861,"type":"if","locations":[{"start":{"line":861,"column":12},"end":{"line":861,"column":12}},{"start":{"line":861,"column":12},"end":{"line":861,"column":12}}]},"113":{"line":861,"type":"binary-expr","locations":[{"start":{"line":861,"column":16},"end":{"line":861,"column":32}},{"start":{"line":861,"column":36},"end":{"line":861,"column":66}}]},"114":{"line":865,"type":"if","locations":[{"start":{"line":865,"column":12},"end":{"line":865,"column":12}},{"start":{"line":865,"column":12},"end":{"line":865,"column":12}}]},"115":{"line":868,"type":"if","locations":[{"start":{"line":868,"column":12},"end":{"line":868,"column":12}},{"start":{"line":868,"column":12},"end":{"line":868,"column":12}}]},"116":{"line":868,"type":"binary-expr","locations":[{"start":{"line":868,"column":15},"end":{"line":868,"column":32}},{"start":{"line":868,"column":36},"end":{"line":868,"column":44}}]},"117":{"line":877,"type":"binary-expr","locations":[{"start":{"line":877,"column":30},"end":{"line":877,"column":38}},{"start":{"line":877,"column":42},"end":{"line":877,"column":46}}]},"118":{"line":880,"type":"if","locations":[{"start":{"line":880,"column":16},"end":{"line":880,"column":16}},{"start":{"line":880,"column":16},"end":{"line":880,"column":16}}]},"119":{"line":886,"type":"if","locations":[{"start":{"line":886,"column":16},"end":{"line":886,"column":16}},{"start":{"line":886,"column":16},"end":{"line":886,"column":16}}]},"120":{"line":900,"type":"if","locations":[{"start":{"line":900,"column":24},"end":{"line":900,"column":24}},{"start":{"line":900,"column":24},"end":{"line":900,"column":24}}]},"121":{"line":900,"type":"binary-expr","locations":[{"start":{"line":900,"column":28},"end":{"line":900,"column":43}},{"start":{"line":900,"column":47},"end":{"line":900,"column":55}}]},"122":{"line":908,"type":"if","locations":[{"start":{"line":908,"column":16},"end":{"line":908,"column":16}},{"start":{"line":908,"column":16},"end":{"line":908,"column":16}}]},"123":{"line":937,"type":"binary-expr","locations":[{"start":{"line":937,"column":22},"end":{"line":937,"column":31}},{"start":{"line":937,"column":35},"end":{"line":937,"column":58}},{"start":{"line":937,"column":62},"end":{"line":937,"column":76}}]},"124":{"line":939,"type":"cond-expr","locations":[{"start":{"line":940,"column":24},"end":{"line":940,"column":52}},{"start":{"line":941,"column":24},"end":{"line":941,"column":57}}]},"125":{"line":947,"type":"if","locations":[{"start":{"line":947,"column":20},"end":{"line":947,"column":20}},{"start":{"line":947,"column":20},"end":{"line":947,"column":20}}]},"126":{"line":972,"type":"if","locations":[{"start":{"line":972,"column":16},"end":{"line":972,"column":16}},{"start":{"line":972,"column":16},"end":{"line":972,"column":16}}]},"127":{"line":1004,"type":"if","locations":[{"start":{"line":1004,"column":16},"end":{"line":1004,"column":16}},{"start":{"line":1004,"column":16},"end":{"line":1004,"column":16}}]},"128":{"line":1014,"type":"if","locations":[{"start":{"line":1014,"column":12},"end":{"line":1014,"column":12}},{"start":{"line":1014,"column":12},"end":{"line":1014,"column":12}}]},"129":{"line":1014,"type":"binary-expr","locations":[{"start":{"line":1014,"column":16},"end":{"line":1014,"column":32}},{"start":{"line":1014,"column":36},"end":{"line":1014,"column":66}}]},"130":{"line":1018,"type":"if","locations":[{"start":{"line":1018,"column":12},"end":{"line":1018,"column":12}},{"start":{"line":1018,"column":12},"end":{"line":1018,"column":12}}]},"131":{"line":1021,"type":"if","locations":[{"start":{"line":1021,"column":12},"end":{"line":1021,"column":12}},{"start":{"line":1021,"column":12},"end":{"line":1021,"column":12}}]},"132":{"line":1031,"type":"cond-expr","locations":[{"start":{"line":1031,"column":63},"end":{"line":1031,"column":71}},{"start":{"line":1031,"column":74},"end":{"line":1031,"column":78}}]},"133":{"line":1036,"type":"if","locations":[{"start":{"line":1036,"column":16},"end":{"line":1036,"column":16}},{"start":{"line":1036,"column":16},"end":{"line":1036,"column":16}}]},"134":{"line":1064,"type":"if","locations":[{"start":{"line":1064,"column":16},"end":{"line":1064,"column":16}},{"start":{"line":1064,"column":16},"end":{"line":1064,"column":16}}]},"135":{"line":1065,"type":"if","locations":[{"start":{"line":1065,"column":20},"end":{"line":1065,"column":20}},{"start":{"line":1065,"column":20},"end":{"line":1065,"column":20}}]},"136":{"line":1066,"type":"if","locations":[{"start":{"line":1066,"column":24},"end":{"line":1066,"column":24}},{"start":{"line":1066,"column":24},"end":{"line":1066,"column":24}}]},"137":{"line":1070,"type":"if","locations":[{"start":{"line":1070,"column":25},"end":{"line":1070,"column":25}},{"start":{"line":1070,"column":25},"end":{"line":1070,"column":25}}]},"138":{"line":1089,"type":"binary-expr","locations":[{"start":{"line":1089,"column":17},"end":{"line":1089,"column":23}},{"start":{"line":1089,"column":27},"end":{"line":1089,"column":35}}]},"139":{"line":1093,"type":"if","locations":[{"start":{"line":1093,"column":12},"end":{"line":1093,"column":12}},{"start":{"line":1093,"column":12},"end":{"line":1093,"column":12}}]},"140":{"line":1098,"type":"if","locations":[{"start":{"line":1098,"column":17},"end":{"line":1098,"column":17}},{"start":{"line":1098,"column":17},"end":{"line":1098,"column":17}}]},"141":{"line":1120,"type":"binary-expr","locations":[{"start":{"line":1120,"column":20},"end":{"line":1120,"column":33}},{"start":{"line":1120,"column":37},"end":{"line":1120,"column":39}}]},"142":{"line":1142,"type":"if","locations":[{"start":{"line":1142,"column":12},"end":{"line":1142,"column":12}},{"start":{"line":1142,"column":12},"end":{"line":1142,"column":12}}]},"143":{"line":1174,"type":"if","locations":[{"start":{"line":1174,"column":12},"end":{"line":1174,"column":12}},{"start":{"line":1174,"column":12},"end":{"line":1174,"column":12}}]},"144":{"line":1188,"type":"binary-expr","locations":[{"start":{"line":1188,"column":29},"end":{"line":1188,"column":37}},{"start":{"line":1188,"column":41},"end":{"line":1188,"column":45}}]},"145":{"line":1191,"type":"if","locations":[{"start":{"line":1191,"column":12},"end":{"line":1191,"column":12}},{"start":{"line":1191,"column":12},"end":{"line":1191,"column":12}}]},"146":{"line":1204,"type":"if","locations":[{"start":{"line":1204,"column":16},"end":{"line":1204,"column":16}},{"start":{"line":1204,"column":16},"end":{"line":1204,"column":16}}]},"147":{"line":1238,"type":"if","locations":[{"start":{"line":1238,"column":12},"end":{"line":1238,"column":12}},{"start":{"line":1238,"column":12},"end":{"line":1238,"column":12}}]},"148":{"line":1238,"type":"binary-expr","locations":[{"start":{"line":1238,"column":16},"end":{"line":1238,"column":33}},{"start":{"line":1238,"column":37},"end":{"line":1238,"column":70}}]},"149":{"line":1242,"type":"cond-expr","locations":[{"start":{"line":1242,"column":43},"end":{"line":1242,"column":46}},{"start":{"line":1242,"column":49},"end":{"line":1242,"column":63}}]},"150":{"line":1251,"type":"if","locations":[{"start":{"line":1251,"column":4},"end":{"line":1251,"column":4}},{"start":{"line":1251,"column":4},"end":{"line":1251,"column":4}}]},"151":{"line":1251,"type":"binary-expr","locations":[{"start":{"line":1251,"column":8},"end":{"line":1251,"column":34}},{"start":{"line":1251,"column":38},"end":{"line":1251,"column":52}}]},"152":{"line":1255,"type":"if","locations":[{"start":{"line":1255,"column":9},"end":{"line":1255,"column":9}},{"start":{"line":1255,"column":9},"end":{"line":1255,"column":9}}]},"153":{"line":1255,"type":"binary-expr","locations":[{"start":{"line":1255,"column":13},"end":{"line":1255,"column":41}},{"start":{"line":1255,"column":45},"end":{"line":1255,"column":55}}]}},"code":["/*!"," * async"," * https://github.com/caolan/async"," *"," * Copyright 2010-2014 Caolan McMahon"," * Released under the MIT license"," */","(function () {","","    var async = {};","    function noop() {}","    function identity(v) {","        return v;","    }","    function toBool(v) {","        return !!v;","    }","    function notId(v) {","        return !v;","    }","","    // global on the server, window in the browser","    var previous_async;","","    // Establish the root object, `window` (`self`) in the browser, `global`","    // on the server, or `this` in some virtual machines. We use `self`","    // instead of `window` for `WebWorker` support.","    var root = typeof self === 'object' && self.self === self && self ||","            typeof global === 'object' && global.global === global && global ||","            this;","","    if (root != null) {","        previous_async = root.async;","    }","","    async.noConflict = function () {","        root.async = previous_async;","        return async;","    };","","    function only_once(fn) {","        return function() {","            if (fn === null) throw new Error(\"Callback was already called.\");","            fn.apply(this, arguments);","            fn = null;","        };","    }","","    function _once(fn) {","        return function() {","            if (fn === null) return;","            fn.apply(this, arguments);","            fn = null;","        };","    }","","    //// cross-browser compatiblity functions ////","","    var _toString = Object.prototype.toString;","","    var _isArray = Array.isArray || function (obj) {","        return _toString.call(obj) === '[object Array]';","    };","","    // Ported from underscore.js isObject","    var _isObject = function(obj) {","        var type = typeof obj;","        return type === 'function' || type === 'object' && !!obj;","    };","","    function _isArrayLike(arr) {","        return _isArray(arr) || (","            // has a positive integer length property","            typeof arr.length === \"number\" &&","            arr.length >= 0 &&","            arr.length % 1 === 0","        );","    }","","    function _arrayEach(arr, iterator) {","        var index = -1,","            length = arr.length;","","        while (++index < length) {","            iterator(arr[index], index, arr);","        }","    }","","    function _map(arr, iterator) {","        var index = -1,","            length = arr.length,","            result = Array(length);","","        while (++index < length) {","            result[index] = iterator(arr[index], index, arr);","        }","        return result;","    }","","    function _range(count) {","        return _map(Array(count), function (v, i) { return i; });","    }","","    function _reduce(arr, iterator, memo) {","        _arrayEach(arr, function (x, i, a) {","            memo = iterator(memo, x, i, a);","        });","        return memo;","    }","","    function _forEachOf(object, iterator) {","        _arrayEach(_keys(object), function (key) {","            iterator(object[key], key);","        });","    }","","    function _indexOf(arr, item) {","        for (var i = 0; i < arr.length; i++) {","            if (arr[i] === item) return i;","        }","        return -1;","    }","","    var _keys = Object.keys || function (obj) {","        var keys = [];","        for (var k in obj) {","            if (obj.hasOwnProperty(k)) {","                keys.push(k);","            }","        }","        return keys;","    };","","    function _keyIterator(coll) {","        var i = -1;","        var len;","        var keys;","        if (_isArrayLike(coll)) {","            len = coll.length;","            return function next() {","                i++;","                return i < len ? i : null;","            };","        } else {","            keys = _keys(coll);","            len = keys.length;","            return function next() {","                i++;","                return i < len ? keys[i] : null;","            };","        }","    }","","    // Similar to ES6's rest param (http://ariya.ofilabs.com/2013/03/es6-and-rest-parameter.html)","    // This accumulates the arguments passed into an array, after a given index.","    // From underscore.js (https://github.com/jashkenas/underscore/pull/2140).","    function _restParam(func, startIndex) {","        startIndex = startIndex == null ? func.length - 1 : +startIndex;","        return function() {","            var length = Math.max(arguments.length - startIndex, 0);","            var rest = Array(length);","            for (var index = 0; index < length; index++) {","                rest[index] = arguments[index + startIndex];","            }","            switch (startIndex) {","                case 0: return func.call(this, rest);","                case 1: return func.call(this, arguments[0], rest);","            }","            // Currently unused but handle cases outside of the switch statement:","            // var args = Array(startIndex + 1);","            // for (index = 0; index < startIndex; index++) {","            //     args[index] = arguments[index];","            // }","            // args[startIndex] = rest;","            // return func.apply(this, args);","        };","    }","","    function _withoutIndex(iterator) {","        return function (value, index, callback) {","            return iterator(value, callback);","        };","    }","","    //// exported async module functions ////","","    //// nextTick implementation with browser-compatible fallback ////","","    // capture the global reference to guard against fakeTimer mocks","    var _setImmediate = typeof setImmediate === 'function' && setImmediate;","","    var _delay = _setImmediate ? function(fn) {","        // not a direct alias for IE10 compatibility","        _setImmediate(fn);","    } : function(fn) {","        setTimeout(fn, 0);","    };","","    if (typeof process === 'object' && typeof process.nextTick === 'function') {","        async.nextTick = process.nextTick;","    } else {","        async.nextTick = _delay;","    }","    async.setImmediate = _setImmediate ? _delay : async.nextTick;","","","    async.forEach =","    async.each = function (arr, iterator, callback) {","        return async.eachOf(arr, _withoutIndex(iterator), callback);","    };","","    async.forEachSeries =","    async.eachSeries = function (arr, iterator, callback) {","        return async.eachOfSeries(arr, _withoutIndex(iterator), callback);","    };","","","    async.forEachLimit =","    async.eachLimit = function (arr, limit, iterator, callback) {","        return _eachOfLimit(limit)(arr, _withoutIndex(iterator), callback);","    };","","    async.forEachOf =","    async.eachOf = function (object, iterator, callback) {","        callback = _once(callback || noop);","        object = object || [];","","        var iter = _keyIterator(object);","        var key, completed = 0;","","        while ((key = iter()) != null) {","            completed += 1;","            iterator(object[key], key, only_once(done));","        }","","        if (completed === 0) callback(null);","","        function done(err) {","            completed--;","            if (err) {","                callback(err);","            }","            // Check key is null in case iterator isn't exhausted","            // and done resolved synchronously.","            else if (key === null && completed <= 0) {","                callback(null);","            }","        }","    };","","    async.forEachOfSeries =","    async.eachOfSeries = function (obj, iterator, callback) {","        callback = _once(callback || noop);","        obj = obj || [];","        var nextKey = _keyIterator(obj);","        var key = nextKey();","        function iterate() {","            var sync = true;","            if (key === null) {","                return callback(null);","            }","            iterator(obj[key], key, only_once(function (err) {","                if (err) {","                    callback(err);","                }","                else {","                    key = nextKey();","                    if (key === null) {","                        return callback(null);","                    } else {","                        if (sync) {","                            async.setImmediate(iterate);","                        } else {","                            iterate();","                        }","                    }","                }","            }));","            sync = false;","        }","        iterate();","    };","","","","    async.forEachOfLimit =","    async.eachOfLimit = function (obj, limit, iterator, callback) {","        _eachOfLimit(limit)(obj, iterator, callback);","    };","","    function _eachOfLimit(limit) {","","        return function (obj, iterator, callback) {","            callback = _once(callback || noop);","            obj = obj || [];","            var nextKey = _keyIterator(obj);","            if (limit <= 0) {","                return callback(null);","            }","            var done = false;","            var running = 0;","            var errored = false;","","            (function replenish () {","                if (done && running <= 0) {","                    return callback(null);","                }","","                while (running < limit && !errored) {","                    var key = nextKey();","                    if (key === null) {","                        done = true;","                        if (running <= 0) {","                            callback(null);","                        }","                        return;","                    }","                    running += 1;","                    iterator(obj[key], key, only_once(function (err) {","                        running -= 1;","                        if (err) {","                            callback(err);","                            errored = true;","                        }","                        else {","                            replenish();","                        }","                    }));","                }","            })();","        };","    }","","","    function doParallel(fn) {","        return function (obj, iterator, callback) {","            return fn(async.eachOf, obj, iterator, callback);","        };","    }","    function doParallelLimit(fn) {","        return function (obj, limit, iterator, callback) {","            return fn(_eachOfLimit(limit), obj, iterator, callback);","        };","    }","    function doSeries(fn) {","        return function (obj, iterator, callback) {","            return fn(async.eachOfSeries, obj, iterator, callback);","        };","    }","","    function _asyncMap(eachfn, arr, iterator, callback) {","        callback = _once(callback || noop);","        arr = arr || [];","        var results = _isArrayLike(arr) ? [] : {};","        eachfn(arr, function (value, index, callback) {","            iterator(value, function (err, v) {","                results[index] = v;","                callback(err);","            });","        }, function (err) {","            callback(err, results);","        });","    }","","    async.map = doParallel(_asyncMap);","    async.mapSeries = doSeries(_asyncMap);","    async.mapLimit = doParallelLimit(_asyncMap);","","    // reduce only has a series version, as doing reduce in parallel won't","    // work in many situations.","    async.inject =","    async.foldl =","    async.reduce = function (arr, memo, iterator, callback) {","        async.eachOfSeries(arr, function (x, i, callback) {","            iterator(memo, x, function (err, v) {","                memo = v;","                callback(err);","            });","        }, function (err) {","            callback(err, memo);","        });","    };","","    async.foldr =","    async.reduceRight = function (arr, memo, iterator, callback) {","        var reversed = _map(arr, identity).reverse();","        async.reduce(reversed, memo, iterator, callback);","    };","","    async.transform = function (arr, memo, iterator, callback) {","        if (arguments.length === 3) {","            callback = iterator;","            iterator = memo;","            memo = _isArray(arr) ? [] : {};","        }","","        async.eachOf(arr, function(v, k, cb) {","            iterator(memo, v, k, cb);","        }, function(err) {","            callback(err, memo);","        });","    };","","    function _filter(eachfn, arr, iterator, callback) {","        var results = [];","        eachfn(arr, function (x, index, callback) {","            iterator(x, function (v) {","                if (v) {","                    results.push({index: index, value: x});","                }","                callback();","            });","        }, function () {","            callback(_map(results.sort(function (a, b) {","                return a.index - b.index;","            }), function (x) {","                return x.value;","            }));","        });","    }","","    async.select =","    async.filter = doParallel(_filter);","","    async.selectLimit =","    async.filterLimit = doParallelLimit(_filter);","","    async.selectSeries =","    async.filterSeries = doSeries(_filter);","","    function _reject(eachfn, arr, iterator, callback) {","        _filter(eachfn, arr, function(value, cb) {","            iterator(value, function(v) {","                cb(!v);","            });","        }, callback);","    }","    async.reject = doParallel(_reject);","    async.rejectLimit = doParallelLimit(_reject);","    async.rejectSeries = doSeries(_reject);","","    function _createTester(eachfn, check, getResult) {","        return function(arr, limit, iterator, cb) {","            function done() {","                if (cb) cb(getResult(false, void 0));","            }","            function iteratee(x, _, callback) {","                if (!cb) return callback();","                iterator(x, function (v) {","                    if (cb && check(v)) {","                        cb(getResult(true, x));","                        cb = iterator = false;","                    }","                    callback();","                });","            }","            if (arguments.length > 3) {","                eachfn(arr, limit, iteratee, done);","            } else {","                cb = iterator;","                iterator = limit;","                eachfn(arr, iteratee, done);","            }","        };","    }","","    async.any =","    async.some = _createTester(async.eachOf, toBool, identity);","","    async.someLimit = _createTester(async.eachOfLimit, toBool, identity);","","    async.all =","    async.every = _createTester(async.eachOf, notId, notId);","","    async.everyLimit = _createTester(async.eachOfLimit, notId, notId);","","    function _findGetResult(v, x) {","        return x;","    }","    async.detect = _createTester(async.eachOf, identity, _findGetResult);","    async.detectSeries = _createTester(async.eachOfSeries, identity, _findGetResult);","    async.detectLimit = _createTester(async.eachOfLimit, identity, _findGetResult);","","    async.sortBy = function (arr, iterator, callback) {","        async.map(arr, function (x, callback) {","            iterator(x, function (err, criteria) {","                if (err) {","                    callback(err);","                }","                else {","                    callback(null, {value: x, criteria: criteria});","                }","            });","        }, function (err, results) {","            if (err) {","                return callback(err);","            }","            else {","                callback(null, _map(results.sort(comparator), function (x) {","                    return x.value;","                }));","            }","","        });","","        function comparator(left, right) {","            var a = left.criteria, b = right.criteria;","            return a < b ? -1 : a > b ? 1 : 0;","        }","    };","","    async.auto = function (tasks, concurrency, callback) {","        if (typeof arguments[1] === 'function') {","            // concurrency is optional, shift the args.","            callback = concurrency;","            concurrency = null;","        }","        callback = _once(callback || noop);","        var keys = _keys(tasks);","        var remainingTasks = keys.length;","        if (!remainingTasks) {","            return callback(null);","        }","        if (!concurrency) {","            concurrency = remainingTasks;","        }","","        var results = {};","        var runningTasks = 0;","","        var hasError = false;","","        var listeners = [];","        function addListener(fn) {","            listeners.unshift(fn);","        }","        function removeListener(fn) {","            var idx = _indexOf(listeners, fn);","            if (idx >= 0) listeners.splice(idx, 1);","        }","        function taskComplete() {","            remainingTasks--;","            _arrayEach(listeners.slice(0), function (fn) {","                fn();","            });","        }","","        addListener(function () {","            if (!remainingTasks) {","                callback(null, results);","            }","        });","","        _arrayEach(keys, function (k) {","            if (hasError) return;","            var task = _isArray(tasks[k]) ? tasks[k]: [tasks[k]];","            var taskCallback = _restParam(function(err, args) {","                runningTasks--;","                if (args.length <= 1) {","                    args = args[0];","                }","                if (err) {","                    var safeResults = {};","                    _forEachOf(results, function(val, rkey) {","                        safeResults[rkey] = val;","                    });","                    safeResults[k] = args;","                    hasError = true;","","                    callback(err, safeResults);","                }","                else {","                    results[k] = args;","                    async.setImmediate(taskComplete);","                }","            });","            var requires = task.slice(0, task.length - 1);","            // prevent dead-locks","            var len = requires.length;","            var dep;","            while (len--) {","                if (!(dep = tasks[requires[len]])) {","                    throw new Error('Has nonexistent dependency in ' + requires.join(', '));","                }","                if (_isArray(dep) && _indexOf(dep, k) >= 0) {","                    throw new Error('Has cyclic dependencies');","                }","            }","            function ready() {","                return runningTasks < concurrency && _reduce(requires, function (a, x) {","                    return (a && results.hasOwnProperty(x));","                }, true) && !results.hasOwnProperty(k);","            }","            if (ready()) {","                runningTasks++;","                task[task.length - 1](taskCallback, results);","            }","            else {","                addListener(listener);","            }","            function listener() {","                if (ready()) {","                    runningTasks++;","                    removeListener(listener);","                    task[task.length - 1](taskCallback, results);","                }","            }","        });","    };","","","","    async.retry = function(times, task, callback) {","        var DEFAULT_TIMES = 5;","        var DEFAULT_INTERVAL = 0;","","        var attempts = [];","","        var opts = {","            times: DEFAULT_TIMES,","            interval: DEFAULT_INTERVAL","        };","","        function parseTimes(acc, t){","            if(typeof t === 'number'){","                acc.times = parseInt(t, 10) || DEFAULT_TIMES;","            } else if(typeof t === 'object'){","                acc.times = parseInt(t.times, 10) || DEFAULT_TIMES;","                acc.interval = parseInt(t.interval, 10) || DEFAULT_INTERVAL;","            } else {","                throw new Error('Unsupported argument type for \\'times\\': ' + typeof t);","            }","        }","","        var length = arguments.length;","        if (length < 1 || length > 3) {","            throw new Error('Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)');","        } else if (length <= 2 && typeof times === 'function') {","            callback = task;","            task = times;","        }","        if (typeof times !== 'function') {","            parseTimes(opts, times);","        }","        opts.callback = callback;","        opts.task = task;","","        function wrappedTask(wrappedCallback, wrappedResults) {","            function retryAttempt(task, finalAttempt) {","                return function(seriesCallback) {","                    task(function(err, result){","                        seriesCallback(!err || finalAttempt, {err: err, result: result});","                    }, wrappedResults);","                };","            }","","            function retryInterval(interval){","                return function(seriesCallback){","                    setTimeout(function(){","                        seriesCallback(null);","                    }, interval);","                };","            }","","            while (opts.times) {","","                var finalAttempt = !(opts.times-=1);","                attempts.push(retryAttempt(opts.task, finalAttempt));","                if(!finalAttempt && opts.interval > 0){","                    attempts.push(retryInterval(opts.interval));","                }","            }","","            async.series(attempts, function(done, data){","                data = data[data.length - 1];","                (wrappedCallback || opts.callback)(data.err, data.result);","            });","        }","","        // If a callback is passed, run this as a controll flow","        return opts.callback ? wrappedTask() : wrappedTask;","    };","","    async.waterfall = function (tasks, callback) {","        callback = _once(callback || noop);","        if (!_isArray(tasks)) {","            var err = new Error('First argument to waterfall must be an array of functions');","            return callback(err);","        }","        if (!tasks.length) {","            return callback();","        }","        function wrapIterator(iterator) {","            return _restParam(function (err, args) {","                if (err) {","                    callback.apply(null, [err].concat(args));","                }","                else {","                    var next = iterator.next();","                    if (next) {","                        args.push(wrapIterator(next));","                    }","                    else {","                        args.push(callback);","                    }","                    ensureAsync(iterator).apply(null, args);","                }","            });","        }","        wrapIterator(async.iterator(tasks))();","    };","","    function _parallel(eachfn, tasks, callback) {","        callback = callback || noop;","        var results = _isArrayLike(tasks) ? [] : {};","","        eachfn(tasks, function (task, key, callback) {","            task(_restParam(function (err, args) {","                if (args.length <= 1) {","                    args = args[0];","                }","                results[key] = args;","                callback(err);","            }));","        }, function (err) {","            callback(err, results);","        });","    }","","    async.parallel = function (tasks, callback) {","        _parallel(async.eachOf, tasks, callback);","    };","","    async.parallelLimit = function(tasks, limit, callback) {","        _parallel(_eachOfLimit(limit), tasks, callback);","    };","","    async.series = function(tasks, callback) {","        _parallel(async.eachOfSeries, tasks, callback);","    };","","    async.iterator = function (tasks) {","        function makeCallback(index) {","            function fn() {","                if (tasks.length) {","                    tasks[index].apply(null, arguments);","                }","                return fn.next();","            }","            fn.next = function () {","                return (index < tasks.length - 1) ? makeCallback(index + 1): null;","            };","            return fn;","        }","        return makeCallback(0);","    };","","    async.apply = _restParam(function (fn, args) {","        return _restParam(function (callArgs) {","            return fn.apply(","                null, args.concat(callArgs)","            );","        });","    });","","    function _concat(eachfn, arr, fn, callback) {","        var result = [];","        eachfn(arr, function (x, index, cb) {","            fn(x, function (err, y) {","                result = result.concat(y || []);","                cb(err);","            });","        }, function (err) {","            callback(err, result);","        });","    }","    async.concat = doParallel(_concat);","    async.concatSeries = doSeries(_concat);","","    async.whilst = function (test, iterator, callback) {","        callback = callback || noop;","        if (test()) {","            var next = _restParam(function(err, args) {","                if (err) {","                    callback(err);","                } else if (test.apply(this, args)) {","                    iterator(next);","                } else {","                    callback.apply(null, [null].concat(args));","                }","            });","            iterator(next);","        } else {","            callback(null);","        }","    };","","    async.doWhilst = function (iterator, test, callback) {","        var calls = 0;","        return async.whilst(function() {","            return ++calls <= 1 || test.apply(this, arguments);","        }, iterator, callback);","    };","","    async.until = function (test, iterator, callback) {","        return async.whilst(function() {","            return !test.apply(this, arguments);","        }, iterator, callback);","    };","","    async.doUntil = function (iterator, test, callback) {","        return async.doWhilst(iterator, function() {","            return !test.apply(this, arguments);","        }, callback);","    };","","    async.during = function (test, iterator, callback) {","        callback = callback || noop;","","        var next = _restParam(function(err, args) {","            if (err) {","                callback(err);","            } else {","                args.push(check);","                test.apply(this, args);","            }","        });","","        var check = function(err, truth) {","            if (err) {","                callback(err);","            } else if (truth) {","                iterator(next);","            } else {","                callback(null);","            }","        };","","        test(check);","    };","","    async.doDuring = function (iterator, test, callback) {","        var calls = 0;","        async.during(function(next) {","            if (calls++ < 1) {","                next(null, true);","            } else {","                test.apply(this, arguments);","            }","        }, iterator, callback);","    };","","    function _queue(worker, concurrency, payload) {","        if (concurrency == null) {","            concurrency = 1;","        }","        else if(concurrency === 0) {","            throw new Error('Concurrency must not be zero');","        }","        function _insert(q, data, pos, callback) {","            if (callback != null && typeof callback !== \"function\") {","                throw new Error(\"task callback must be a function\");","            }","            q.started = true;","            if (!_isArray(data)) {","                data = [data];","            }","            if(data.length === 0 && q.idle()) {","                // call drain immediately if there are no tasks","                return async.setImmediate(function() {","                    q.drain();","                });","            }","            _arrayEach(data, function(task) {","                var item = {","                    data: task,","                    callback: callback || noop","                };","","                if (pos) {","                    q.tasks.unshift(item);","                } else {","                    q.tasks.push(item);","                }","","                if (q.tasks.length === q.concurrency) {","                    q.saturated();","                }","            });","            async.setImmediate(q.process);","        }","        function _next(q, tasks) {","            return function(){","                workers -= 1;","","                var removed = false;","                var args = arguments;","                _arrayEach(tasks, function (task) {","                    _arrayEach(workersList, function (worker, index) {","                        if (worker === task && !removed) {","                            workersList.splice(index, 1);","                            removed = true;","                        }","                    });","","                    task.callback.apply(task, args);","                });","                if (q.tasks.length + workers === 0) {","                    q.drain();","                }","                q.process();","            };","        }","","        var workers = 0;","        var workersList = [];","        var q = {","            tasks: [],","            concurrency: concurrency,","            payload: payload,","            saturated: noop,","            empty: noop,","            drain: noop,","            started: false,","            paused: false,","            push: function (data, callback) {","                _insert(q, data, false, callback);","            },","            kill: function () {","                q.drain = noop;","                q.tasks = [];","            },","            unshift: function (data, callback) {","                _insert(q, data, true, callback);","            },","            process: function () {","                while(!q.paused && workers < q.concurrency && q.tasks.length){","","                    var tasks = q.payload ?","                        q.tasks.splice(0, q.payload) :","                        q.tasks.splice(0, q.tasks.length);","","                    var data = _map(tasks, function (task) {","                        return task.data;","                    });","","                    if (q.tasks.length === 0) {","                        q.empty();","                    }","                    workers += 1;","                    workersList.push(tasks[0]);","                    var cb = only_once(_next(q, tasks));","                    worker(data, cb);","                }","            },","            length: function () {","                return q.tasks.length;","            },","            running: function () {","                return workers;","            },","            workersList: function () {","                return workersList;","            },","            idle: function() {","                return q.tasks.length + workers === 0;","            },","            pause: function () {","                q.paused = true;","            },","            resume: function () {","                if (q.paused === false) { return; }","                q.paused = false;","                var resumeCount = Math.min(q.concurrency, q.tasks.length);","                // Need to call q.process once per concurrent","                // worker to preserve full concurrency after pause","                for (var w = 1; w <= resumeCount; w++) {","                    async.setImmediate(q.process);","                }","            }","        };","        return q;","    }","","    async.queue = function (worker, concurrency) {","        var q = _queue(function (items, cb) {","            worker(items[0], cb);","        }, concurrency, 1);","","        return q;","    };","","    async.priorityQueue = function (worker, concurrency) {","","        function _compareTasks(a, b){","            return a.priority - b.priority;","        }","","        function _binarySearch(sequence, item, compare) {","            var beg = -1,","                end = sequence.length - 1;","            while (beg < end) {","                var mid = beg + ((end - beg + 1) >>> 1);","                if (compare(item, sequence[mid]) >= 0) {","                    beg = mid;","                } else {","                    end = mid - 1;","                }","            }","            return beg;","        }","","        function _insert(q, data, priority, callback) {","            if (callback != null && typeof callback !== \"function\") {","                throw new Error(\"task callback must be a function\");","            }","            q.started = true;","            if (!_isArray(data)) {","                data = [data];","            }","            if(data.length === 0) {","                // call drain immediately if there are no tasks","                return async.setImmediate(function() {","                    q.drain();","                });","            }","            _arrayEach(data, function(task) {","                var item = {","                    data: task,","                    priority: priority,","                    callback: typeof callback === 'function' ? callback : noop","                };","","                q.tasks.splice(_binarySearch(q.tasks, item, _compareTasks) + 1, 0, item);","","                if (q.tasks.length === q.concurrency) {","                    q.saturated();","                }","                async.setImmediate(q.process);","            });","        }","","        // Start with a normal queue","        var q = async.queue(worker, concurrency);","","        // Override push to accept second parameter representing priority","        q.push = function (data, priority, callback) {","            _insert(q, data, priority, callback);","        };","","        // Remove unshift function","        delete q.unshift;","","        return q;","    };","","    async.cargo = function (worker, payload) {","        return _queue(worker, 1, payload);","    };","","    function _console_fn(name) {","        return _restParam(function (fn, args) {","            fn.apply(null, args.concat([_restParam(function (err, args) {","                if (typeof console === 'object') {","                    if (err) {","                        if (console.error) {","                            console.error(err);","                        }","                    }","                    else if (console[name]) {","                        _arrayEach(args, function (x) {","                            console[name](x);","                        });","                    }","                }","            })]));","        });","    }","    async.log = _console_fn('log');","    async.dir = _console_fn('dir');","    /*async.info = _console_fn('info');","    async.warn = _console_fn('warn');","    async.error = _console_fn('error');*/","","    async.memoize = function (fn, hasher) {","        var memo = {};","        var queues = {};","        var has = Object.prototype.hasOwnProperty;","        hasher = hasher || identity;","        var memoized = _restParam(function memoized(args) {","            var callback = args.pop();","            var key = hasher.apply(null, args);","            if (has.call(memo, key)) {   ","                async.setImmediate(function () {","                    callback.apply(null, memo[key]);","                });","            }","            else if (has.call(queues, key)) {","                queues[key].push(callback);","            }","            else {","                queues[key] = [callback];","                fn.apply(null, args.concat([_restParam(function (args) {","                    memo[key] = args;","                    var q = queues[key];","                    delete queues[key];","                    for (var i = 0, l = q.length; i < l; i++) {","                        q[i].apply(null, args);","                    }","                })]));","            }","        });","        memoized.memo = memo;","        memoized.unmemoized = fn;","        return memoized;","    };","","    async.unmemoize = function (fn) {","        return function () {","            return (fn.unmemoized || fn).apply(null, arguments);","        };","    };","","    function _times(mapper) {","        return function (count, iterator, callback) {","            mapper(_range(count), iterator, callback);","        };","    }","","    async.times = _times(async.map);","    async.timesSeries = _times(async.mapSeries);","    async.timesLimit = function (count, limit, iterator, callback) {","        return async.mapLimit(_range(count), limit, iterator, callback);","    };","","    async.seq = function (/* functions... */) {","        var fns = arguments;","        return _restParam(function (args) {","            var that = this;","","            var callback = args[args.length - 1];","            if (typeof callback == 'function') {","                args.pop();","            } else {","                callback = noop;","            }","","            async.reduce(fns, args, function (newargs, fn, cb) {","                fn.apply(that, newargs.concat([_restParam(function (err, nextargs) {","                    cb(err, nextargs);","                })]));","            },","            function (err, results) {","                callback.apply(that, [err].concat(results));","            });","        });","    };","","    async.compose = function (/* functions... */) {","        return async.seq.apply(null, Array.prototype.reverse.call(arguments));","    };","","","    function _applyEach(eachfn) {","        return _restParam(function(fns, args) {","            var go = _restParam(function(args) {","                var that = this;","                var callback = args.pop();","                return eachfn(fns, function (fn, _, cb) {","                    fn.apply(that, args.concat([cb]));","                },","                callback);","            });","            if (args.length) {","                return go.apply(this, args);","            }","            else {","                return go;","            }","        });","    }","","    async.applyEach = _applyEach(async.eachOf);","    async.applyEachSeries = _applyEach(async.eachOfSeries);","","","    async.forever = function (fn, callback) {","        var done = only_once(callback || noop);","        var task = ensureAsync(fn);","        function next(err) {","            if (err) {","                return done(err);","            }","            task(next);","        }","        next();","    };","","    function ensureAsync(fn) {","        return _restParam(function (args) {","            var callback = args.pop();","            args.push(function () {","                var innerArgs = arguments;","                if (sync) {","                    async.setImmediate(function () {","                        callback.apply(null, innerArgs);","                    });","                } else {","                    callback.apply(null, innerArgs);","                }","            });","            var sync = true;","            fn.apply(this, args);","            sync = false;","        });","    }","","    async.ensureAsync = ensureAsync;","","    async.constant = _restParam(function(values) {","        var args = [null].concat(values);","        return function (callback) {","            return callback.apply(this, args);","        };","    });","","    async.wrapSync =","    async.asyncify = function asyncify(func) {","        return _restParam(function (args) {","            var callback = args.pop();","            var result;","            try {","                result = func.apply(this, args);","            } catch (e) {","                return callback(e);","            }","            // if result is Promise object","            if (_isObject(result) && typeof result.then === \"function\") {","                result.then(function(value) {","                    callback(null, value);","                })[\"catch\"](function(err) {","                    callback(err.message ? err : new Error(err));","                });","            } else {","                callback(null, result);","            }","        });","    };","","    // Node.js","    if (typeof module === 'object' && module.exports) {","        module.exports = async;","    }","    // AMD / RequireJS","    else if (typeof define === 'function' && define.amd) {","        define([], function () {","            return async;","        });","    }","    // included directly via <script> tag","    else {","        root.async = async;","    }","","}());",""],"l":{"8":1,"10":1,"11":1,"12":1,"13":0,"15":1,"16":0,"18":1,"19":0,"23":1,"28":1,"32":1,"33":1,"36":1,"37":0,"38":0,"41":1,"42":0,"43":0,"44":0,"45":0,"49":1,"50":0,"51":0,"52":0,"53":0,"59":1,"61":1,"62":0,"66":1,"67":0,"68":0,"71":1,"72":0,"80":1,"81":0,"84":0,"85":0,"89":1,"90":0,"94":0,"95":0,"97":0,"100":1,"101":0,"104":1,"105":0,"106":0,"108":0,"111":1,"112":0,"113":0,"117":1,"118":0,"119":0,"121":0,"124":1,"125":0,"126":0,"127":0,"128":0,"131":0,"134":1,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"145":0,"146":0,"147":0,"148":0,"149":0,"157":1,"158":6,"159":6,"160":0,"161":0,"162":0,"163":0,"165":0,"166":0,"167":0,"179":1,"180":0,"181":0,"190":1,"192":1,"194":0,"196":0,"199":1,"200":1,"202":0,"204":1,"207":1,"209":0,"212":1,"214":0,"218":1,"220":0,"223":1,"225":0,"226":0,"228":0,"229":0,"231":0,"232":0,"233":0,"236":0,"238":1,"239":0,"240":0,"241":0,"245":0,"246":0,"251":1,"253":0,"254":0,"255":0,"256":0,"257":1,"258":0,"259":0,"260":0,"262":0,"263":0,"264":0,"267":0,"268":0,"269":0,"271":0,"272":0,"274":0,"279":0,"281":0,"286":1,"288":0,"291":1,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"300":0,"301":0,"302":0,"304":0,"305":0,"306":0,"309":0,"310":0,"311":0,"312":0,"313":0,"314":0,"316":0,"318":0,"319":0,"320":0,"321":0,"322":0,"323":0,"326":0,"335":1,"336":4,"337":0,"340":1,"341":3,"342":0,"345":1,"346":4,"347":0,"351":1,"352":0,"353":0,"354":0,"355":0,"356":0,"357":0,"358":0,"361":0,"365":1,"366":1,"367":1,"371":1,"374":0,"375":0,"376":0,"377":0,"380":0,"384":1,"386":0,"387":0,"390":1,"391":0,"392":0,"393":0,"394":0,"397":0,"398":0,"400":0,"404":1,"405":0,"406":0,"407":0,"408":0,"409":0,"411":0,"414":0,"415":0,"417":0,"422":1,"425":1,"428":1,"431":1,"432":0,"433":0,"434":0,"438":1,"439":1,"440":1,"442":1,"443":7,"444":1,"445":0,"447":1,"448":0,"449":0,"450":0,"451":0,"452":0,"454":0,"457":0,"458":0,"460":0,"461":0,"462":0,"467":1,"470":1,"472":1,"475":1,"477":1,"478":0,"480":1,"481":1,"482":1,"484":1,"485":0,"486":0,"487":0,"488":0,"491":0,"495":0,"496":0,"499":0,"500":0,"506":1,"507":0,"508":0,"512":1,"513":0,"515":0,"516":0,"518":0,"519":0,"520":0,"521":0,"522":0,"524":0,"525":0,"528":0,"529":0,"531":0,"533":0,"534":1,"535":0,"537":1,"538":0,"539":0,"541":1,"542":0,"543":0,"544":0,"548":0,"549":0,"550":0,"554":0,"555":0,"556":0,"557":0,"558":0,"559":0,"560":0,"562":0,"563":0,"564":0,"565":0,"567":0,"568":0,"570":0,"573":0,"574":0,"577":0,"579":0,"580":0,"581":0,"582":0,"583":0,"585":0,"586":0,"589":1,"590":0,"591":0,"594":0,"595":0,"596":0,"599":0,"601":1,"602":0,"603":0,"604":0,"605":0,"613":1,"614":0,"615":0,"617":0,"619":0,"624":1,"625":0,"626":0,"627":0,"628":0,"629":0,"631":0,"635":0,"636":0,"637":0,"638":0,"639":0,"640":0,"642":0,"643":0,"645":0,"646":0,"648":1,"649":1,"650":0,"651":0,"652":0,"657":1,"658":0,"659":0,"660":0,"665":0,"667":0,"668":0,"669":0,"670":0,"674":0,"675":0,"676":0,"681":0,"684":1,"685":0,"686":0,"687":0,"688":0,"690":0,"691":0,"693":1,"694":0,"695":0,"696":0,"699":0,"700":0,"701":0,"704":0,"706":0,"710":0,"713":1,"714":0,"715":0,"717":0,"718":0,"719":0,"720":0,"722":0,"723":0,"726":0,"730":1,"731":0,"734":1,"735":0,"738":1,"739":0,"742":1,"743":1,"744":1,"745":0,"746":0,"748":0,"750":0,"751":0,"753":0,"755":0,"758":1,"759":0,"760":0,"766":1,"767":0,"768":0,"769":0,"770":0,"771":0,"774":0,"777":1,"778":1,"780":1,"781":0,"782":0,"783":0,"784":0,"785":0,"786":0,"787":0,"789":0,"792":0,"794":0,"798":1,"799":0,"800":0,"801":0,"805":1,"806":0,"807":0,"811":1,"812":0,"813":0,"817":1,"818":0,"820":0,"821":0,"822":0,"824":0,"825":0,"829":0,"830":0,"831":0,"832":0,"833":0,"835":0,"839":0,"842":1,"843":0,"844":0,"845":0,"846":0,"848":0,"853":1,"854":0,"855":0,"857":0,"858":0,"860":1,"861":0,"862":0,"864":0,"865":0,"866":0,"868":0,"870":0,"871":0,"874":0,"875":0,"880":0,"881":0,"883":0,"886":0,"887":0,"890":0,"892":1,"893":0,"894":0,"896":0,"897":0,"898":0,"899":0,"900":0,"901":0,"902":0,"906":0,"908":0,"909":0,"911":0,"915":0,"916":0,"917":0,"927":0,"930":0,"931":0,"934":0,"937":0,"939":0,"943":0,"944":0,"947":0,"948":0,"950":0,"951":0,"952":0,"953":0,"957":0,"960":0,"963":0,"966":0,"969":0,"972":0,"973":0,"974":0,"977":0,"978":0,"982":0,"985":1,"986":0,"987":0,"990":0,"993":1,"995":1,"996":0,"999":1,"1000":0,"1002":0,"1003":0,"1004":0,"1005":0,"1007":0,"1010":0,"1013":1,"1014":0,"1015":0,"1017":0,"1018":0,"1019":0,"1021":0,"1023":0,"1024":0,"1027":0,"1028":0,"1034":0,"1036":0,"1037":0,"1039":0,"1044":0,"1047":0,"1048":0,"1052":0,"1054":0,"1057":1,"1058":0,"1061":1,"1062":2,"1063":0,"1064":0,"1065":0,"1066":0,"1067":0,"1070":0,"1071":0,"1072":0,"1079":1,"1080":1,"1085":1,"1086":0,"1087":0,"1088":0,"1089":0,"1090":0,"1091":0,"1092":0,"1093":0,"1094":0,"1095":0,"1098":0,"1099":0,"1102":0,"1103":0,"1104":0,"1105":0,"1106":0,"1107":0,"1108":0,"1113":0,"1114":0,"1115":0,"1118":1,"1119":0,"1120":0,"1124":1,"1125":2,"1126":0,"1130":1,"1131":1,"1132":1,"1133":0,"1136":1,"1137":0,"1138":0,"1139":0,"1141":0,"1142":0,"1143":0,"1145":0,"1148":0,"1149":0,"1150":0,"1154":0,"1159":1,"1160":0,"1164":1,"1165":2,"1166":0,"1167":0,"1168":0,"1169":0,"1170":0,"1174":0,"1175":0,"1178":0,"1183":1,"1184":1,"1187":1,"1188":0,"1189":0,"1190":1,"1191":0,"1192":0,"1194":0,"1196":0,"1199":1,"1200":0,"1201":0,"1202":0,"1203":0,"1204":0,"1205":0,"1206":0,"1209":0,"1212":0,"1213":0,"1214":0,"1218":1,"1220":1,"1221":0,"1222":0,"1223":0,"1227":1,"1229":0,"1230":0,"1231":0,"1232":0,"1233":0,"1235":0,"1238":0,"1239":0,"1240":0,"1242":0,"1245":0,"1251":1,"1252":1,"1255":0,"1256":0,"1257":0,"1262":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/server.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/server.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":4,"loc":{"start":{"line":4,"column":25},"end":{"line":4,"column":50}}},"2":{"name":"(anonymous_2)","line":22,"loc":{"start":{"line":22,"column":22},"end":{"line":22,"column":51}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":24},"end":{"line":36,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":38}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":4,"column":0},"end":{"line":20,"column":2}},"4":{"start":{"line":5,"column":2},"end":{"line":6,"column":12}},"5":{"start":{"line":7,"column":2},"end":{"line":17,"column":3}},"6":{"start":{"line":8,"column":4},"end":{"line":8,"column":20}},"7":{"start":{"line":9,"column":4},"end":{"line":9,"column":40}},"8":{"start":{"line":11,"column":4},"end":{"line":16,"column":5}},"9":{"start":{"line":12,"column":6},"end":{"line":12,"column":43}},"10":{"start":{"line":13,"column":6},"end":{"line":15,"column":7}},"11":{"start":{"line":14,"column":8},"end":{"line":14,"column":38}},"12":{"start":{"line":19,"column":2},"end":{"line":19,"column":13}},"13":{"start":{"line":22,"column":0},"end":{"line":24,"column":2}},"14":{"start":{"line":23,"column":2},"end":{"line":23,"column":48}},"15":{"start":{"line":36,"column":0},"end":{"line":44,"column":2}},"16":{"start":{"line":37,"column":2},"end":{"line":39,"column":3}},"17":{"start":{"line":38,"column":4},"end":{"line":38,"column":56}},"18":{"start":{"line":40,"column":2},"end":{"line":40,"column":62}},"19":{"start":{"line":41,"column":2},"end":{"line":41,"column":27}},"20":{"start":{"line":42,"column":2},"end":{"line":42,"column":37}},"21":{"start":{"line":43,"column":2},"end":{"line":43,"column":17}},"22":{"start":{"line":48,"column":0},"end":{"line":48,"column":67}}},"branchMap":{"1":{"line":11,"type":"if","locations":[{"start":{"line":11,"column":4},"end":{"line":11,"column":4}},{"start":{"line":11,"column":4},"end":{"line":11,"column":4}}]},"2":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":23},"end":{"line":23,"column":41}},{"start":{"line":23,"column":45},"end":{"line":23,"column":47}}]},"3":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":2}},{"start":{"line":37,"column":2},"end":{"line":37,"column":2}}]},"4":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":6},"end":{"line":37,"column":11}},{"start":{"line":37,"column":15},"end":{"line":37,"column":25}},{"start":{"line":37,"column":29},"end":{"line":37,"column":42}},{"start":{"line":37,"column":46},"end":{"line":37,"column":57}}]}},"code":["var Loader = require('pomelo-loader');","var Gateway = require('./gateway');","","var loadRemoteServices = function(paths, context) {","  var res = {},","    item, m;","  for (var i = 0, l = paths.length; i < l; i++) {","    item = paths[i];","    m = Loader.load(item.path, context);","","    if (m) {","      createNamespace(item.namespace, res);","      for (var s in m) {","        res[item.namespace][s] = m[s];","      }","    }","  }","","  return res;","};","","var createNamespace = function(namespace, proxies) {","  proxies[namespace] = proxies[namespace] || {};","};","","/**"," * Create rpc server."," *"," * @param  {Object}      opts construct parameters"," *                       opts.port {Number|String} rpc server listen port"," *                       opts.paths {Array} remote service code paths, [{namespace, path}, ...]"," *                       opts.context {Object} context for remote service"," *                       opts.acceptorFactory {Object} (optionals)acceptorFactory.create(opts, cb)"," * @return {Object}      rpc server instance"," */","module.exports.create = function(opts) {","  if (!opts || !opts.port || opts.port < 0 || !opts.paths) {","    throw new Error('opts.port or opts.paths invalid.');","  }","  var services = loadRemoteServices(opts.paths, opts.context);","  opts.services = services;","  var gateway = Gateway.create(opts);","  return gateway;","};","","// module.exports.WSAcceptor = require('./acceptors/ws-acceptor');","// module.exports.TcpAcceptor = require('./acceptors/tcp-acceptor');","module.exports.MqttAcceptor = require('./acceptors/mqtt-acceptor');"],"l":{"1":1,"2":1,"4":1,"5":0,"7":0,"8":0,"9":0,"11":0,"12":0,"13":0,"14":0,"19":0,"22":1,"23":0,"36":1,"37":0,"38":0,"40":0,"41":0,"42":0,"43":0,"48":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/gateway.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/gateway.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":1,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":1,"57":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":14},"end":{"line":9,"column":29}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":52},"end":{"line":21,"column":78}}},"3":{"name":"(anonymous_3)","line":30,"loc":{"start":{"line":30,"column":11},"end":{"line":30,"column":22}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":12},"end":{"line":40,"column":23}}},"5":{"name":"(anonymous_5)","line":57,"loc":{"start":{"line":57,"column":24},"end":{"line":57,"column":39}}},"6":{"name":"(anonymous_6)","line":65,"loc":{"start":{"line":65,"column":20},"end":{"line":65,"column":50}}},"7":{"name":"(anonymous_7)","line":69,"loc":{"start":{"line":69,"column":5},"end":{"line":69,"column":21}}},"8":{"name":"(anonymous_8)","line":70,"loc":{"start":{"line":70,"column":34},"end":{"line":70,"column":56}}},"9":{"name":"(anonymous_9)","line":88,"loc":{"start":{"line":88,"column":22},"end":{"line":88,"column":51}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":51}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":38}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":37}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":23}},"8":{"start":{"line":9,"column":0},"end":{"line":24,"column":2}},"9":{"start":{"line":10,"column":2},"end":{"line":10,"column":26}},"10":{"start":{"line":11,"column":2},"end":{"line":11,"column":25}},"11":{"start":{"line":12,"column":2},"end":{"line":12,"column":32}},"12":{"start":{"line":13,"column":2},"end":{"line":13,"column":23}},"13":{"start":{"line":14,"column":2},"end":{"line":14,"column":22}},"14":{"start":{"line":15,"column":2},"end":{"line":15,"column":72}},"15":{"start":{"line":16,"column":2},"end":{"line":16,"column":32}},"16":{"start":{"line":17,"column":2},"end":{"line":17,"column":49}},"17":{"start":{"line":18,"column":2},"end":{"line":20,"column":3}},"18":{"start":{"line":19,"column":4},"end":{"line":19,"column":36}},"19":{"start":{"line":21,"column":2},"end":{"line":23,"column":5}},"20":{"start":{"line":22,"column":4},"end":{"line":22,"column":38}},"21":{"start":{"line":26,"column":0},"end":{"line":26,"column":37}},"22":{"start":{"line":28,"column":0},"end":{"line":28,"column":28}},"23":{"start":{"line":30,"column":0},"end":{"line":38,"column":2}},"24":{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},"25":{"start":{"line":32,"column":4},"end":{"line":32,"column":11}},"26":{"start":{"line":34,"column":2},"end":{"line":34,"column":21}},"27":{"start":{"line":35,"column":2},"end":{"line":37,"column":18}},"28":{"start":{"line":36,"column":4},"end":{"line":36,"column":26}},"29":{"start":{"line":40,"column":0},"end":{"line":50,"column":2}},"30":{"start":{"line":41,"column":2},"end":{"line":43,"column":3}},"31":{"start":{"line":42,"column":4},"end":{"line":42,"column":46}},"32":{"start":{"line":44,"column":2},"end":{"line":44,"column":22}},"33":{"start":{"line":46,"column":2},"end":{"line":46,"column":18}},"34":{"start":{"line":47,"column":2},"end":{"line":47,"column":59}},"35":{"start":{"line":48,"column":2},"end":{"line":48,"column":61}},"36":{"start":{"line":49,"column":2},"end":{"line":49,"column":34}},"37":{"start":{"line":57,"column":0},"end":{"line":63,"column":2}},"38":{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},"39":{"start":{"line":59,"column":4},"end":{"line":59,"column":67}},"40":{"start":{"line":62,"column":2},"end":{"line":62,"column":27}},"41":{"start":{"line":65,"column":0},"end":{"line":86,"column":2}},"42":{"start":{"line":66,"column":2},"end":{"line":66,"column":33}},"43":{"start":{"line":67,"column":2},"end":{"line":67,"column":33}},"44":{"start":{"line":68,"column":2},"end":{"line":85,"column":3}},"45":{"start":{"line":69,"column":4},"end":{"line":84,"column":10}},"46":{"start":{"line":70,"column":6},"end":{"line":83,"column":9}},"47":{"start":{"line":71,"column":8},"end":{"line":82,"column":9}},"48":{"start":{"line":72,"column":10},"end":{"line":72,"column":23}},"49":{"start":{"line":73,"column":10},"end":{"line":73,"column":34}},"50":{"start":{"line":74,"column":10},"end":{"line":74,"column":46}},"51":{"start":{"line":75,"column":10},"end":{"line":80,"column":11}},"52":{"start":{"line":76,"column":12},"end":{"line":76,"column":49}},"53":{"start":{"line":77,"column":12},"end":{"line":79,"column":13}},"54":{"start":{"line":78,"column":14},"end":{"line":78,"column":44}},"55":{"start":{"line":81,"column":10},"end":{"line":81,"column":41}},"56":{"start":{"line":88,"column":0},"end":{"line":90,"column":2}},"57":{"start":{"line":89,"column":2},"end":{"line":89,"column":48}}},"branchMap":{"1":{"line":11,"type":"binary-expr","locations":[{"start":{"line":11,"column":14},"end":{"line":11,"column":18}},{"start":{"line":11,"column":22},"end":{"line":11,"column":24}}]},"2":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":14},"end":{"line":12,"column":23}},{"start":{"line":12,"column":27},"end":{"line":12,"column":31}}]},"3":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":25},"end":{"line":15,"column":45}},{"start":{"line":15,"column":49},"end":{"line":15,"column":71}}]},"4":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":2},"end":{"line":18,"column":2}},{"start":{"line":18,"column":2},"end":{"line":18,"column":2}}]},"5":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":31,"column":2}},{"start":{"line":31,"column":2},"end":{"line":31,"column":2}}]},"6":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":6},"end":{"line":31,"column":19}},{"start":{"line":31,"column":23},"end":{"line":31,"column":34}}]},"7":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":2},"end":{"line":41,"column":2}},{"start":{"line":41,"column":2},"end":{"line":41,"column":2}}]},"8":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":58,"column":2}},{"start":{"line":58,"column":2},"end":{"line":58,"column":2}}]},"9":{"line":58,"type":"binary-expr","locations":[{"start":{"line":58,"column":6},"end":{"line":58,"column":11}},{"start":{"line":58,"column":15},"end":{"line":58,"column":29}}]},"10":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":8},"end":{"line":71,"column":8}},{"start":{"line":71,"column":8},"end":{"line":71,"column":8}}]},"11":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":10},"end":{"line":75,"column":10}},{"start":{"line":75,"column":10},"end":{"line":75,"column":10}}]},"12":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":23},"end":{"line":89,"column":41}},{"start":{"line":89,"column":45},"end":{"line":89,"column":47}}]}},"code":["var defaultAcceptorFactory = require('./acceptor');","var EventEmitter = require('events').EventEmitter;","var Dispatcher = require('./dispatcher');","var Loader = require('pomelo-loader');","var utils = require('../util/utils');","var util = require('util');","var fs = require('fs');","","var Gateway = function(opts) {","  EventEmitter.call(this);","  this.opts = opts || {};","  this.port = opts.port || 3050;","  this.started = false;","  this.stoped = false;","  this.acceptorFactory = opts.acceptorFactory || defaultAcceptorFactory;","  this.services = opts.services;","  var dispatcher = new Dispatcher(this.services);","  if (!!this.opts.reloadRemotes) {","    watchServices(this, dispatcher);","  }","  this.acceptor = this.acceptorFactory.create(opts, function(tracer, msg, cb) {","    dispatcher.route(tracer, msg, cb);","  });","};","","util.inherits(Gateway, EventEmitter);","","var pro = Gateway.prototype;","","pro.stop = function() {","  if (!this.started || this.stoped) {","    return;","  }","  this.stoped = true;","  try {","    this.acceptor.close();","  } catch (err) {}","};","","pro.start = function() {","  if (this.started) {","    throw new Error('gateway already start.');","  }","  this.started = true;","","  var self = this;","  this.acceptor.on('error', self.emit.bind(self, 'error'));","  this.acceptor.on('closed', self.emit.bind(self, 'closed'));","  this.acceptor.listen(this.port);","};","","/**"," * create and init gateway"," *"," * @param opts {services: {rpcServices}, connector:conFactory(optional), router:routeFunction(optional)}"," */","module.exports.create = function(opts) {","  if (!opts || !opts.services) {","    throw new Error('opts and opts.services should not be empty.');","  }","","  return new Gateway(opts);","};","","var watchServices = function(gateway, dispatcher) {","  var paths = gateway.opts.paths;","  var app = gateway.opts.context;","  for (var i = 0; i < paths.length; i++) {","    (function(index) {","      fs.watch(paths[index].path, function(event, name) {","        if (event === 'change') {","          var res = {};","          var item = paths[index];","          var m = Loader.load(item.path, app);","          if (m) {","            createNamespace(item.namespace, res);","            for (var s in m) {","              res[item.namespace][s] = m[s];","            }","          }","          dispatcher.emit('reload', res);","        }","      });","    })(i);","  }","};","","var createNamespace = function(namespace, proxies) {","  proxies[namespace] = proxies[namespace] || {};","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"21":0,"22":0,"26":1,"28":1,"30":1,"31":0,"32":0,"34":0,"35":0,"36":0,"40":1,"41":0,"42":0,"44":0,"46":0,"47":0,"48":0,"49":0,"57":1,"58":0,"59":0,"62":0,"65":1,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"81":0,"88":1,"89":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/acceptor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/acceptor.js","s":{"1":1,"2":1,"3":0},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":4,"loc":{"start":{"line":4,"column":24},"end":{"line":4,"column":43}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":52}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":1},"end":{"line":5,"column":34}}},"branchMap":{},"code":["var acceptor = require('./acceptors/mqtt-acceptor');","// var acceptor = require('./acceptors/ws2-acceptor');","","module.exports.create = function(opts, cb) {","\treturn acceptor.create(opts, cb);","};"],"l":{"1":1,"4":1,"5":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/acceptors/mqtt-acceptor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/acceptors/mqtt-acceptor.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":1,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":1,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":1,"77":0,"78":0,"79":1,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":1,"100":0,"101":0,"102":1,"103":0,"104":0,"105":0,"106":0,"107":0,"108":1,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":1,"121":0,"122":1,"123":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":15},"end":{"line":11,"column":34}}},"2":{"name":"(anonymous_2)","line":27,"loc":{"start":{"line":27,"column":13},"end":{"line":27,"column":28}}},"3":{"name":"(anonymous_3)","line":40,"loc":{"start":{"line":40,"column":26},"end":{"line":40,"column":40}}},"4":{"name":"(anonymous_4)","line":45,"loc":{"start":{"line":45,"column":31},"end":{"line":45,"column":48}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":25},"end":{"line":49,"column":39}}},"6":{"name":"(anonymous_6)","line":53,"loc":{"start":{"line":53,"column":25},"end":{"line":53,"column":39}}},"7":{"name":"(anonymous_7)","line":75,"loc":{"start":{"line":75,"column":25},"end":{"line":75,"column":36}}},"8":{"name":"(anonymous_8)","line":79,"loc":{"start":{"line":79,"column":23},"end":{"line":79,"column":34}}},"9":{"name":"(anonymous_9)","line":83,"loc":{"start":{"line":83,"column":23},"end":{"line":83,"column":34}}},"10":{"name":"(anonymous_10)","line":89,"loc":{"start":{"line":89,"column":28},"end":{"line":89,"column":45}}},"11":{"name":"(anonymous_11)","line":95,"loc":{"start":{"line":95,"column":33},"end":{"line":95,"column":44}}},"12":{"name":"(anonymous_12)","line":101,"loc":{"start":{"line":101,"column":12},"end":{"line":101,"column":23}}},"13":{"name":"(anonymous_13)","line":114,"loc":{"start":{"line":114,"column":20},"end":{"line":114,"column":37}}},"14":{"name":"(anonymous_14)","line":123,"loc":{"start":{"line":123,"column":17},"end":{"line":123,"column":34}}},"15":{"name":"(anonymous_15)","line":132,"loc":{"start":{"line":132,"column":17},"end":{"line":132,"column":49}}},"16":{"name":"(anonymous_16)","line":138,"loc":{"start":{"line":138,"column":31},"end":{"line":138,"column":42}}},"17":{"name":"(anonymous_17)","line":174,"loc":{"start":{"line":174,"column":18},"end":{"line":174,"column":51}}},"18":{"name":"(anonymous_18)","line":180,"loc":{"start":{"line":180,"column":14},"end":{"line":180,"column":46}}},"19":{"name":"(anonymous_19)","line":189,"loc":{"start":{"line":189,"column":12},"end":{"line":189,"column":31}}},"20":{"name":"(anonymous_20)","line":209,"loc":{"start":{"line":209,"column":13},"end":{"line":209,"column":35}}},"21":{"name":"(anonymous_21)","line":222,"loc":{"start":{"line":222,"column":24},"end":{"line":222,"column":43}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":79}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":40}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":41}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":25}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":14}},"9":{"start":{"line":11,"column":0},"end":{"line":21,"column":2}},"10":{"start":{"line":12,"column":2},"end":{"line":12,"column":26}},"11":{"start":{"line":13,"column":2},"end":{"line":13,"column":32}},"12":{"start":{"line":14,"column":2},"end":{"line":14,"column":34}},"13":{"start":{"line":15,"column":2},"end":{"line":15,"column":34}},"14":{"start":{"line":16,"column":2},"end":{"line":16,"column":38}},"15":{"start":{"line":17,"column":2},"end":{"line":17,"column":24}},"16":{"start":{"line":18,"column":2},"end":{"line":18,"column":20}},"17":{"start":{"line":19,"column":2},"end":{"line":19,"column":22}},"18":{"start":{"line":20,"column":2},"end":{"line":20,"column":15}},"19":{"start":{"line":23,"column":0},"end":{"line":23,"column":38}},"20":{"start":{"line":25,"column":0},"end":{"line":25,"column":29}},"21":{"start":{"line":27,"column":0},"end":{"line":99,"column":2}},"22":{"start":{"line":29,"column":2},"end":{"line":32,"column":3}},"23":{"start":{"line":30,"column":4},"end":{"line":30,"column":42}},"24":{"start":{"line":31,"column":4},"end":{"line":31,"column":11}},"25":{"start":{"line":33,"column":2},"end":{"line":33,"column":21}},"26":{"start":{"line":35,"column":2},"end":{"line":35,"column":18}},"27":{"start":{"line":37,"column":2},"end":{"line":37,"column":33}},"28":{"start":{"line":38,"column":2},"end":{"line":38,"column":27}},"29":{"start":{"line":40,"column":2},"end":{"line":43,"column":5}},"30":{"start":{"line":41,"column":4},"end":{"line":41,"column":55}},"31":{"start":{"line":42,"column":4},"end":{"line":42,"column":28}},"32":{"start":{"line":45,"column":2},"end":{"line":92,"column":5}},"33":{"start":{"line":46,"column":4},"end":{"line":46,"column":33}},"34":{"start":{"line":47,"column":4},"end":{"line":47,"column":27}},"35":{"start":{"line":49,"column":4},"end":{"line":51,"column":7}},"36":{"start":{"line":50,"column":6},"end":{"line":50,"column":31}},"37":{"start":{"line":53,"column":4},"end":{"line":73,"column":7}},"38":{"start":{"line":54,"column":6},"end":{"line":54,"column":35}},"39":{"start":{"line":55,"column":6},"end":{"line":55,"column":26}},"40":{"start":{"line":56,"column":6},"end":{"line":72,"column":7}},"41":{"start":{"line":57,"column":8},"end":{"line":57,"column":30}},"42":{"start":{"line":58,"column":8},"end":{"line":63,"column":9}},"43":{"start":{"line":59,"column":10},"end":{"line":59,"column":41}},"44":{"start":{"line":60,"column":10},"end":{"line":60,"column":25}},"45":{"start":{"line":62,"column":10},"end":{"line":62,"column":40}},"46":{"start":{"line":65,"column":8},"end":{"line":70,"column":9}},"47":{"start":{"line":66,"column":10},"end":{"line":69,"column":13}},"48":{"start":{"line":71,"column":8},"end":{"line":71,"column":64}},"49":{"start":{"line":75,"column":4},"end":{"line":77,"column":7}},"50":{"start":{"line":76,"column":6},"end":{"line":76,"column":24}},"51":{"start":{"line":79,"column":4},"end":{"line":81,"column":7}},"52":{"start":{"line":80,"column":6},"end":{"line":80,"column":33}},"53":{"start":{"line":83,"column":4},"end":{"line":85,"column":7}},"54":{"start":{"line":84,"column":6},"end":{"line":84,"column":33}},"55":{"start":{"line":87,"column":4},"end":{"line":87,"column":37}},"56":{"start":{"line":89,"column":4},"end":{"line":91,"column":7}},"57":{"start":{"line":90,"column":6},"end":{"line":90,"column":33}},"58":{"start":{"line":94,"column":2},"end":{"line":98,"column":3}},"59":{"start":{"line":95,"column":4},"end":{"line":97,"column":22}},"60":{"start":{"line":96,"column":6},"end":{"line":96,"column":18}},"61":{"start":{"line":101,"column":0},"end":{"line":112,"column":2}},"62":{"start":{"line":102,"column":2},"end":{"line":104,"column":3}},"63":{"start":{"line":103,"column":4},"end":{"line":103,"column":11}},"64":{"start":{"line":105,"column":2},"end":{"line":105,"column":21}},"65":{"start":{"line":106,"column":2},"end":{"line":109,"column":3}},"66":{"start":{"line":107,"column":4},"end":{"line":107,"column":34}},"67":{"start":{"line":108,"column":4},"end":{"line":108,"column":26}},"68":{"start":{"line":110,"column":2},"end":{"line":110,"column":22}},"69":{"start":{"line":111,"column":2},"end":{"line":111,"column":22}},"70":{"start":{"line":114,"column":0},"end":{"line":121,"column":1}},"71":{"start":{"line":115,"column":2},"end":{"line":120,"column":3}},"72":{"start":{"line":116,"column":4},"end":{"line":116,"column":23}},"73":{"start":{"line":117,"column":4},"end":{"line":117,"column":28}},"74":{"start":{"line":118,"column":4},"end":{"line":118,"column":28}},"75":{"start":{"line":119,"column":4},"end":{"line":119,"column":30}},"76":{"start":{"line":123,"column":0},"end":{"line":130,"column":2}},"77":{"start":{"line":125,"column":2},"end":{"line":128,"column":4}},"78":{"start":{"line":129,"column":2},"end":{"line":129,"column":13}},"79":{"start":{"line":132,"column":0},"end":{"line":172,"column":2}},"80":{"start":{"line":133,"column":2},"end":{"line":133,"column":20}},"81":{"start":{"line":134,"column":2},"end":{"line":137,"column":3}},"82":{"start":{"line":135,"column":4},"end":{"line":135,"column":123}},"83":{"start":{"line":136,"column":4},"end":{"line":136,"column":112}},"84":{"start":{"line":138,"column":2},"end":{"line":171,"column":5}},"85":{"start":{"line":140,"column":4},"end":{"line":140,"column":31}},"86":{"start":{"line":141,"column":4},"end":{"line":141,"column":30}},"87":{"start":{"line":142,"column":4},"end":{"line":144,"column":5}},"88":{"start":{"line":143,"column":6},"end":{"line":143,"column":29}},"89":{"start":{"line":146,"column":4},"end":{"line":146,"column":27}},"90":{"start":{"line":147,"column":4},"end":{"line":149,"column":5}},"91":{"start":{"line":148,"column":6},"end":{"line":148,"column":37}},"92":{"start":{"line":151,"column":4},"end":{"line":151,"column":13}},"93":{"start":{"line":152,"column":4},"end":{"line":165,"column":5}},"94":{"start":{"line":153,"column":6},"end":{"line":159,"column":8}},"95":{"start":{"line":161,"column":6},"end":{"line":164,"column":8}},"96":{"start":{"line":166,"column":4},"end":{"line":170,"column":5}},"97":{"start":{"line":167,"column":6},"end":{"line":167,"column":38}},"98":{"start":{"line":169,"column":6},"end":{"line":169,"column":27}},"99":{"start":{"line":174,"column":0},"end":{"line":178,"column":2}},"100":{"start":{"line":175,"column":2},"end":{"line":177,"column":3}},"101":{"start":{"line":176,"column":4},"end":{"line":176,"column":42}},"102":{"start":{"line":180,"column":0},"end":{"line":187,"column":2}},"103":{"start":{"line":181,"column":2},"end":{"line":181,"column":21}},"104":{"start":{"line":182,"column":2},"end":{"line":182,"column":37}},"105":{"start":{"line":183,"column":2},"end":{"line":185,"column":3}},"106":{"start":{"line":184,"column":4},"end":{"line":184,"column":40}},"107":{"start":{"line":186,"column":2},"end":{"line":186,"column":18}},"108":{"start":{"line":189,"column":0},"end":{"line":207,"column":2}},"109":{"start":{"line":190,"column":2},"end":{"line":192,"column":18}},"110":{"start":{"line":193,"column":2},"end":{"line":206,"column":3}},"111":{"start":{"line":194,"column":4},"end":{"line":194,"column":31}},"112":{"start":{"line":195,"column":4},"end":{"line":199,"column":5}},"113":{"start":{"line":197,"column":6},"end":{"line":197,"column":30}},"114":{"start":{"line":198,"column":6},"end":{"line":198,"column":15}},"115":{"start":{"line":200,"column":4},"end":{"line":200,"column":29}},"116":{"start":{"line":201,"column":4},"end":{"line":203,"column":5}},"117":{"start":{"line":202,"column":6},"end":{"line":202,"column":15}},"118":{"start":{"line":204,"column":4},"end":{"line":204,"column":26}},"119":{"start":{"line":205,"column":4},"end":{"line":205,"column":26}},"120":{"start":{"line":209,"column":0},"end":{"line":214,"column":1}},"121":{"start":{"line":210,"column":2},"end":{"line":213,"column":5}},"122":{"start":{"line":222,"column":0},"end":{"line":224,"column":2}},"123":{"start":{"line":223,"column":2},"end":{"line":223,"column":38}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"2":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":8},"end":{"line":58,"column":8}},{"start":{"line":58,"column":8},"end":{"line":58,"column":8}}]},"3":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":65,"column":8}},{"start":{"line":65,"column":8},"end":{"line":65,"column":8}}]},"4":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":2},"end":{"line":94,"column":2}},{"start":{"line":94,"column":2},"end":{"line":94,"column":2}}]},"5":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":2},"end":{"line":102,"column":2}},{"start":{"line":102,"column":2},"end":{"line":102,"column":2}}]},"6":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":2},"end":{"line":106,"column":2}},{"start":{"line":106,"column":2},"end":{"line":106,"column":2}}]},"7":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":2},"end":{"line":115,"column":2}},{"start":{"line":115,"column":2},"end":{"line":115,"column":2}}]},"8":{"line":134,"type":"if","locations":[{"start":{"line":134,"column":2},"end":{"line":134,"column":2}},{"start":{"line":134,"column":2},"end":{"line":134,"column":2}}]},"9":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":4},"end":{"line":147,"column":4}},{"start":{"line":147,"column":4},"end":{"line":147,"column":4}}]},"10":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":8},"end":{"line":147,"column":16}},{"start":{"line":147,"column":20},"end":{"line":147,"column":45}}]},"11":{"line":152,"type":"if","locations":[{"start":{"line":152,"column":4},"end":{"line":152,"column":4}},{"start":{"line":152,"column":4},"end":{"line":152,"column":4}}]},"12":{"line":152,"type":"binary-expr","locations":[{"start":{"line":152,"column":8},"end":{"line":152,"column":14}},{"start":{"line":152,"column":18},"end":{"line":152,"column":34}}]},"13":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":166,"column":4}},{"start":{"line":166,"column":4},"end":{"line":166,"column":4}}]},"14":{"line":183,"type":"if","locations":[{"start":{"line":183,"column":2},"end":{"line":183,"column":2}},{"start":{"line":183,"column":2},"end":{"line":183,"column":2}}]},"15":{"line":195,"type":"if","locations":[{"start":{"line":195,"column":4},"end":{"line":195,"column":4}},{"start":{"line":195,"column":4},"end":{"line":195,"column":4}}]},"16":{"line":201,"type":"if","locations":[{"start":{"line":201,"column":4},"end":{"line":201,"column":4}},{"start":{"line":201,"column":4},"end":{"line":201,"column":4}}]},"17":{"line":223,"type":"binary-expr","locations":[{"start":{"line":223,"column":22},"end":{"line":223,"column":26}},{"start":{"line":223,"column":30},"end":{"line":223,"column":32}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo-rpc', 'mqtt-acceptor');","var EventEmitter = require('events').EventEmitter;","var Tracer = require('../../util/tracer');","var utils = require('../../util/utils');","var MqttCon = require('mqtt-connection');","var util = require('util');","var net = require('net');","","var curId = 1;","","var Acceptor = function(opts, cb) {","  EventEmitter.call(this);","  this.interval = opts.interval; // flush interval in ms","  this.bufferMsg = opts.bufferMsg;","  this.rpcLogger = opts.rpcLogger;","  this.rpcDebugLog = opts.rpcDebugLog;","  this._interval = null; // interval object","  this.sockets = {};","  this.msgQueues = {};","  this.cb = cb;","};","","util.inherits(Acceptor, EventEmitter);","","var pro = Acceptor.prototype;","","pro.listen = function(port) {","  //check status","  if (!!this.inited) {","    this.cb(new Error('already inited.'));","    return;","  }","  this.inited = true;","","  var self = this;","","  this.server = new net.Server();","  this.server.listen(port);","","  this.server.on('error', function(err) {","    logger.error('rpc server is error: %j', err.stack);","    self.emit('error', err);","  });","","  this.server.on('connection', function(stream) {","    var socket = MqttCon(stream);","    socket['id'] = curId++;","","    socket.on('connect', function(pkg) {","      console.log('connected');","    });","","    socket.on('publish', function(pkg) {","      pkg = pkg.payload.toString();","      var isArray = false;","      try {","        pkg = JSON.parse(pkg);","        if (pkg instanceof Array) {","          processMsgs(socket, self, pkg);","          isArray = true;","        } else {","          processMsg(socket, self, pkg);","        }","      } catch (err) {","        if (!isArray) {","          doSend(socket, {","            id: pkg.id,","            resp: [cloneError(err)]","          });","        }","        logger.error('process rpc message error %s', err.stack);","      }","    });","","    socket.on('pingreq', function() {","      socket.pingresp();","    });","","    socket.on('error', function() {","      self.onSocketClose(socket);","    });","","    socket.on('close', function() {","      self.onSocketClose(socket);","    });","","    self.sockets[socket.id] = socket;","","    socket.on('disconnect', function(reason) {","      self.onSocketClose(socket);","    });","  });","","  if (this.bufferMsg) {","    this._interval = setInterval(function() {","      flush(self);","    }, this.interval);","  }","};","","pro.close = function() {","  if (this.closed) {","    return;","  }","  this.closed = true;","  if (this._interval) {","    clearInterval(this._interval);","    this._interval = null;","  }","  this.server.close();","  this.emit('closed');","};","","pro.onSocketClose = function(socket) {","  if (!socket['closed']) {","    var id = socket.id;","    socket['closed'] = true;","    delete this.sockets[id];","    delete this.msgQueues[id];","  }","}","","var cloneError = function(origin) {","  // copy the stack infos for Error instance json result is empty","  var res = {","    msg: origin.msg,","    stack: origin.stack","  };","  return res;","};","","var processMsg = function(socket, acceptor, pkg) {","  var tracer = null;","  if (this.rpcDebugLog) {","    tracer = new Tracer(acceptor.rpcLogger, acceptor.rpcDebugLog, pkg.remote, pkg.source, pkg.msg, pkg.traceId, pkg.seqId);","    tracer.info('server', __filename, 'processMsg', 'mqtt-acceptor receive message and try to process message');","  }","  acceptor.cb(tracer, pkg.msg, function() {","    // var args = Array.prototype.slice.call(arguments, 0);","    var len = arguments.length;","    var args = new Array(len);","    for (var i = 0; i < len; i++) {","      args[i] = arguments[i];","    }","","    var errorArg = args[0]; // first callback argument can be error object, the others are message","    if (errorArg && errorArg instanceof Error) {","      args[0] = cloneError(errorArg);","    }","","    var resp;","    if (tracer && tracer.isEnabled) {","      resp = {","        traceId: tracer.id,","        seqId: tracer.seq,","        source: tracer.source,","        id: pkg.id,","        resp: args","      };","    } else {","      resp = {","        id: pkg.id,","        resp: args","      };","    }","    if (acceptor.bufferMsg) {","      enqueue(socket, acceptor, resp);","    } else {","      doSend(socket, resp);","    }","  });","};","","var processMsgs = function(socket, acceptor, pkgs) {","  for (var i = 0, l = pkgs.length; i < l; i++) {","    processMsg(socket, acceptor, pkgs[i]);","  }","};","","var enqueue = function(socket, acceptor, msg) {","  var id = socket.id;","  var queue = acceptor.msgQueues[id];","  if (!queue) {","    queue = acceptor.msgQueues[id] = [];","  }","  queue.push(msg);","};","","var flush = function(acceptor) {","  var sockets = acceptor.sockets,","    queues = acceptor.msgQueues,","    queue, socket;","  for (var socketId in queues) {","    socket = sockets[socketId];","    if (!socket) {","      // clear pending messages if the socket not exist any more","      delete queues[socketId];","      continue;","    }","    queue = queues[socketId];","    if (!queue.length) {","      continue;","    }","    doSend(socket, queue);","    queues[socketId] = [];","  }","};","","var doSend = function(socket, msg) {","  socket.publish({","    topic: 'rpc',","    payload: JSON.stringify(msg)","  });","}","","/**"," * create acceptor"," *"," * @param opts init params"," * @param cb(tracer, msg, cb) callback function that would be invoked when new message arrives"," */","module.exports.create = function(opts, cb) {","  return new Acceptor(opts || {}, cb);","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"9":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"23":1,"25":1,"27":1,"29":0,"30":0,"31":0,"33":0,"35":0,"37":0,"38":0,"40":0,"41":0,"42":0,"45":0,"46":0,"47":0,"49":0,"50":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"62":0,"65":0,"66":0,"71":0,"75":0,"76":0,"79":0,"80":0,"83":0,"84":0,"87":0,"89":0,"90":0,"94":0,"95":0,"96":0,"101":1,"102":0,"103":0,"105":0,"106":0,"107":0,"108":0,"110":0,"111":0,"114":1,"115":0,"116":0,"117":0,"118":0,"119":0,"123":1,"125":0,"129":0,"132":1,"133":0,"134":0,"135":0,"136":0,"138":0,"140":0,"141":0,"142":0,"143":0,"146":0,"147":0,"148":0,"151":0,"152":0,"153":0,"161":0,"166":0,"167":0,"169":0,"174":1,"175":0,"176":0,"180":1,"181":0,"182":0,"183":0,"184":0,"186":0,"189":1,"190":0,"193":0,"194":0,"195":0,"197":0,"198":0,"200":0,"201":0,"202":0,"204":0,"205":0,"209":1,"210":0,"222":1,"223":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/dispatcher.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-rpc/lib/rpc-server/dispatcher.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":17},"end":{"line":5,"column":36}}},"2":{"name":"(anonymous_2)","line":8,"loc":{"start":{"line":8,"column":20},"end":{"line":8,"column":39}}},"3":{"name":"(anonymous_3)","line":27,"loc":{"start":{"line":27,"column":12},"end":{"line":27,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":50}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"4":{"start":{"line":5,"column":0},"end":{"line":12,"column":2}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":26}},"6":{"start":{"line":7,"column":2},"end":{"line":7,"column":18}},"7":{"start":{"line":8,"column":2},"end":{"line":10,"column":5}},"8":{"start":{"line":9,"column":4},"end":{"line":9,"column":29}},"9":{"start":{"line":11,"column":2},"end":{"line":11,"column":27}},"10":{"start":{"line":14,"column":0},"end":{"line":14,"column":40}},"11":{"start":{"line":16,"column":0},"end":{"line":16,"column":28}},"12":{"start":{"line":18,"column":0},"end":{"line":18,"column":31}},"13":{"start":{"line":27,"column":0},"end":{"line":53,"column":2}},"14":{"start":{"line":28,"column":2},"end":{"line":28,"column":103}},"15":{"start":{"line":29,"column":2},"end":{"line":29,"column":47}},"16":{"start":{"line":30,"column":2},"end":{"line":34,"column":3}},"17":{"start":{"line":31,"column":4},"end":{"line":31,"column":96}},"18":{"start":{"line":32,"column":4},"end":{"line":32,"column":56}},"19":{"start":{"line":33,"column":4},"end":{"line":33,"column":11}},"20":{"start":{"line":36,"column":2},"end":{"line":36,"column":39}},"21":{"start":{"line":37,"column":2},"end":{"line":41,"column":3}},"22":{"start":{"line":38,"column":4},"end":{"line":38,"column":92}},"23":{"start":{"line":39,"column":4},"end":{"line":39,"column":52}},"24":{"start":{"line":40,"column":4},"end":{"line":40,"column":11}},"25":{"start":{"line":43,"column":2},"end":{"line":43,"column":35}},"26":{"start":{"line":44,"column":2},"end":{"line":48,"column":3}},"27":{"start":{"line":45,"column":4},"end":{"line":45,"column":90}},"28":{"start":{"line":46,"column":4},"end":{"line":46,"column":50}},"29":{"start":{"line":47,"column":4},"end":{"line":47,"column":11}},"30":{"start":{"line":50,"column":2},"end":{"line":50,"column":22}},"31":{"start":{"line":51,"column":2},"end":{"line":51,"column":16}},"32":{"start":{"line":52,"column":2},"end":{"line":52,"column":30}}},"branchMap":{"1":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":2},"end":{"line":28,"column":8}},{"start":{"line":28,"column":12},"end":{"line":28,"column":102}}]},"2":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":2},"end":{"line":30,"column":2}},{"start":{"line":30,"column":2},"end":{"line":30,"column":2}}]},"3":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":10}},{"start":{"line":31,"column":14},"end":{"line":31,"column":95}}]},"4":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":2}},{"start":{"line":37,"column":2},"end":{"line":37,"column":2}}]},"5":{"line":38,"type":"binary-expr","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":10}},{"start":{"line":38,"column":14},"end":{"line":38,"column":91}}]},"6":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":2},"end":{"line":44,"column":2}},{"start":{"line":44,"column":2},"end":{"line":44,"column":2}}]},"7":{"line":45,"type":"binary-expr","locations":[{"start":{"line":45,"column":4},"end":{"line":45,"column":10}},{"start":{"line":45,"column":14},"end":{"line":45,"column":89}}]}},"code":["var EventEmitter = require('events').EventEmitter;","var utils = require('../util/utils');","var util = require('util');","","var Dispatcher = function(services) {","  EventEmitter.call(this);","  var self = this;","  this.on('reload', function(services) {","    self.services = services;","  });","  this.services = services;","};","","util.inherits(Dispatcher, EventEmitter);","","module.exports = Dispatcher;","","var pro = Dispatcher.prototype;","","/**"," * route the msg to appropriate service object"," *"," * @param msg msg package {service:serviceString, method:methodString, args:[]}"," * @param services services object collection, such as {service1: serviceObj1, service2: serviceObj2}"," * @param cb(...) callback function that should be invoked as soon as the rpc finished"," */","pro.route = function(tracer, msg, cb) {","  tracer && tracer.info('server', __filename, 'route', 'route messsage to appropriate service object');","  var namespace = this.services[msg.namespace];","  if (!namespace) {","    tracer && tracer.error('server', __filename, 'route', 'no such namespace:' + msg.namespace);","    cb(new Error('no such namespace:' + msg.namespace));","    return;","  }","","  var service = namespace[msg.service];","  if (!service) {","    tracer && tracer.error('server', __filename, 'route', 'no such service:' + msg.service);","    cb(new Error('no such service:' + msg.service));","    return;","  }","","  var method = service[msg.method];","  if (!method) {","    tracer && tracer.error('server', __filename, 'route', 'no such method:' + msg.method);","    cb(new Error('no such method:' + msg.method));","    return;","  }","","  var args = msg.args;","  args.push(cb);","  method.apply(service, args);","};"],"l":{"1":1,"2":1,"3":1,"5":1,"6":0,"7":0,"8":0,"9":0,"11":0,"14":1,"16":1,"18":1,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"36":0,"37":0,"38":0,"39":0,"40":0,"43":0,"44":0,"45":0,"46":0,"47":0,"50":0,"51":0,"52":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/pushScheduler.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/pushScheduler.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":0,"7":0,"8":0,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":37}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":20},"end":{"line":12,"column":40}}},"3":{"name":"(anonymous_3)","line":26,"loc":{"start":{"line":26,"column":37},"end":{"line":26,"column":50}}},"4":{"name":"(anonymous_4)","line":48,"loc":{"start":{"line":48,"column":31},"end":{"line":48,"column":51}}},"5":{"name":"(anonymous_5)","line":75,"loc":{"start":{"line":75,"column":35},"end":{"line":75,"column":80}}},"6":{"name":"(anonymous_6)","line":79,"loc":{"start":{"line":79,"column":52},"end":{"line":79,"column":65}}},"7":{"name":"(anonymous_7)","line":98,"loc":{"start":{"line":98,"column":19},"end":{"line":98,"column":58}}},"8":{"name":"(anonymous_8)","line":106,"loc":{"start":{"line":106,"column":22},"end":{"line":106,"column":36}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":59}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":70}},"3":{"start":{"line":8,"column":0},"end":{"line":10,"column":2}},"4":{"start":{"line":9,"column":2},"end":{"line":9,"column":38}},"5":{"start":{"line":12,"column":0},"end":{"line":16,"column":2}},"6":{"start":{"line":13,"column":2},"end":{"line":13,"column":17}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":20}},"8":{"start":{"line":15,"column":2},"end":{"line":15,"column":49}},"9":{"start":{"line":18,"column":0},"end":{"line":18,"column":51}},"10":{"start":{"line":26,"column":0},"end":{"line":40,"column":2}},"11":{"start":{"line":27,"column":2},"end":{"line":39,"column":3}},"12":{"start":{"line":28,"column":4},"end":{"line":33,"column":5}},"13":{"start":{"line":29,"column":6},"end":{"line":29,"column":34}},"14":{"start":{"line":30,"column":6},"end":{"line":32,"column":7}},"15":{"start":{"line":31,"column":8},"end":{"line":31,"column":20}},"16":{"start":{"line":34,"column":4},"end":{"line":34,"column":25}},"17":{"start":{"line":35,"column":9},"end":{"line":39,"column":3}},"18":{"start":{"line":36,"column":4},"end":{"line":36,"column":29}},"19":{"start":{"line":38,"column":4},"end":{"line":38,"column":25}},"20":{"start":{"line":48,"column":0},"end":{"line":62,"column":2}},"21":{"start":{"line":49,"column":2},"end":{"line":61,"column":3}},"22":{"start":{"line":50,"column":4},"end":{"line":55,"column":5}},"23":{"start":{"line":51,"column":6},"end":{"line":51,"column":34}},"24":{"start":{"line":52,"column":6},"end":{"line":54,"column":7}},"25":{"start":{"line":53,"column":8},"end":{"line":53,"column":19}},"26":{"start":{"line":56,"column":4},"end":{"line":56,"column":25}},"27":{"start":{"line":57,"column":9},"end":{"line":61,"column":3}},"28":{"start":{"line":58,"column":4},"end":{"line":58,"column":28}},"29":{"start":{"line":60,"column":4},"end":{"line":60,"column":25}},"30":{"start":{"line":75,"column":0},"end":{"line":96,"column":2}},"31":{"start":{"line":76,"column":2},"end":{"line":76,"column":18}},"32":{"start":{"line":77,"column":2},"end":{"line":95,"column":3}},"33":{"start":{"line":78,"column":4},"end":{"line":88,"column":5}},"34":{"start":{"line":79,"column":6},"end":{"line":85,"column":9}},"35":{"start":{"line":80,"column":8},"end":{"line":84,"column":9}},"36":{"start":{"line":81,"column":10},"end":{"line":81,"column":74}},"37":{"start":{"line":83,"column":10},"end":{"line":83,"column":63}},"38":{"start":{"line":87,"column":6},"end":{"line":87,"column":100}},"39":{"start":{"line":90,"column":4},"end":{"line":94,"column":5}},"40":{"start":{"line":91,"column":6},"end":{"line":91,"column":66}},"41":{"start":{"line":93,"column":6},"end":{"line":93,"column":101}},"42":{"start":{"line":98,"column":0},"end":{"line":119,"column":2}},"43":{"start":{"line":99,"column":2},"end":{"line":99,"column":53}},"44":{"start":{"line":100,"column":2},"end":{"line":102,"column":3}},"45":{"start":{"line":101,"column":4},"end":{"line":101,"column":32}},"46":{"start":{"line":104,"column":2},"end":{"line":116,"column":3}},"47":{"start":{"line":105,"column":4},"end":{"line":105,"column":17}},"48":{"start":{"line":106,"column":4},"end":{"line":112,"column":7}},"49":{"start":{"line":107,"column":6},"end":{"line":111,"column":7}},"50":{"start":{"line":108,"column":8},"end":{"line":108,"column":54}},"51":{"start":{"line":110,"column":8},"end":{"line":110,"column":36}},"52":{"start":{"line":113,"column":4},"end":{"line":113,"column":42}},"53":{"start":{"line":114,"column":4},"end":{"line":114,"column":47}},"54":{"start":{"line":115,"column":4},"end":{"line":115,"column":15}},"55":{"start":{"line":118,"column":2},"end":{"line":118,"column":19}}},"branchMap":{"1":{"line":14,"type":"binary-expr","locations":[{"start":{"line":14,"column":9},"end":{"line":14,"column":13}},{"start":{"line":14,"column":17},"end":{"line":14,"column":19}}]},"2":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":2},"end":{"line":27,"column":2}},{"start":{"line":27,"column":2},"end":{"line":27,"column":2}}]},"3":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":6},"end":{"line":30,"column":6}},{"start":{"line":30,"column":6},"end":{"line":30,"column":6}}]},"4":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":9},"end":{"line":35,"column":9}},{"start":{"line":35,"column":9},"end":{"line":35,"column":9}}]},"5":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":2},"end":{"line":49,"column":2}},{"start":{"line":49,"column":2},"end":{"line":49,"column":2}}]},"6":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":6},"end":{"line":52,"column":6}},{"start":{"line":52,"column":6},"end":{"line":52,"column":6}}]},"7":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":9},"end":{"line":57,"column":9}},{"start":{"line":57,"column":9},"end":{"line":57,"column":9}}]},"8":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":2},"end":{"line":77,"column":2}},{"start":{"line":77,"column":2},"end":{"line":77,"column":2}}]},"9":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":78,"column":4}},{"start":{"line":78,"column":4},"end":{"line":78,"column":4}}]},"10":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":8},"end":{"line":80,"column":8}},{"start":{"line":80,"column":8},"end":{"line":80,"column":8}}]},"11":{"line":80,"type":"binary-expr","locations":[{"start":{"line":80,"column":11},"end":{"line":80,"column":29}},{"start":{"line":80,"column":33},"end":{"line":80,"column":82}}]},"12":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":4},"end":{"line":90,"column":4}},{"start":{"line":90,"column":4},"end":{"line":90,"column":4}}]},"13":{"line":99,"type":"binary-expr","locations":[{"start":{"line":99,"column":18},"end":{"line":99,"column":32}},{"start":{"line":99,"column":36},"end":{"line":99,"column":52}}]},"14":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":2},"end":{"line":100,"column":2}},{"start":{"line":100,"column":2},"end":{"line":100,"column":2}}]},"15":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":2},"end":{"line":104,"column":2}},{"start":{"line":104,"column":2},"end":{"line":104,"column":2}}]},"16":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":6},"end":{"line":107,"column":6}},{"start":{"line":107,"column":6},"end":{"line":107,"column":6}}]}},"code":["/**"," * Scheduler component to schedule message sending."," */","","var DefaultScheduler = require('../pushSchedulers/direct');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","module.exports = function(app, opts) {","  return new PushScheduler(app, opts);","};","","var PushScheduler = function(app, opts) {","  this.app = app;","  opts = opts || {};","  this.scheduler = getScheduler(this, app, opts);","};","","PushScheduler.prototype.name = '__pushScheduler__';","","/**"," * Component lifecycle callback"," *"," * @param {Function} cb"," * @return {Void}"," */","PushScheduler.prototype.afterStart = function(cb) {","  if(this.isSelectable) {","    for (var k in this.scheduler) {","      var sch = this.scheduler[k];","      if(typeof sch.start === 'function') {","        sch.start();","      }","    }","    process.nextTick(cb);","  } else if(typeof this.scheduler.start === 'function') {","    this.scheduler.start(cb);","  } else {","    process.nextTick(cb);","  }","};","","/**"," * Component lifecycle callback"," *"," * @param {Function} cb"," * @return {Void}"," */","PushScheduler.prototype.stop = function(force, cb) {","  if(this.isSelectable) {","    for (var k in this.scheduler) {","      var sch = this.scheduler[k];","      if(typeof sch.stop === 'function') {","        sch.stop();","      }","    }","    process.nextTick(cb);","  } else if(typeof this.scheduler.stop === 'function') {","    this.scheduler.stop(cb);","  } else {","    process.nextTick(cb);","  }","};","","/**"," * Schedule how the message to send."," *"," * @param  {Number}   reqId request id"," * @param  {String}   route route string of the message"," * @param  {Object}   msg   message content after encoded"," * @param  {Array}    recvs array of receiver's session id"," * @param  {Object}   opts  options"," * @param  {Function} cb"," */","","PushScheduler.prototype.schedule = function(reqId, route, msg, recvs, opts, cb) {","  var self = this;","  if(self.isSelectable) {","    if(typeof self.selector === 'function') {","      self.selector(reqId, route, msg, recvs, opts, function(id) {","        if(self.scheduler[id] && typeof self.scheduler[id].schedule === 'function') {","          self.scheduler[id].schedule(reqId, route, msg, recvs, opts, cb);","        } else {","          logger.error('invalid pushScheduler id, id: %j', id);","        }","      });","    } else {","      logger.error('the selector for pushScheduler is not a function, selector: %j', self.selector);","    }","  } else {","    if (typeof self.scheduler.schedule === 'function') {","      self.scheduler.schedule(reqId, route, msg, recvs, opts, cb);","    } else {","      logger.error('the scheduler does not have a schedule function, scheduler: %j', self.scheduler);","    }","  }","};","","var getScheduler = function(pushSchedulerComp, app, opts) {","  var scheduler = opts.scheduler || DefaultScheduler;","  if(typeof scheduler === 'function') {","    return scheduler(app, opts);","  }","","  if(Array.isArray(scheduler)) {","    var res = {};","    scheduler.forEach(function(sch) {","      if(typeof sch.scheduler === 'function') {","        res[sch.id] = sch.scheduler(app, sch.options);","      } else {","        res[sch.id] = sch.scheduler;","      }","    });","    pushSchedulerComp.isSelectable = true;","    pushSchedulerComp.selector = opts.selector;","    return res; ","  }","","  return scheduler;","};",""],"l":{"5":1,"6":1,"8":1,"9":0,"12":1,"13":0,"14":0,"15":0,"18":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"34":0,"35":0,"36":0,"38":0,"48":1,"49":0,"50":0,"51":0,"52":0,"53":0,"56":0,"57":0,"58":0,"60":0,"75":1,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"83":0,"87":0,"90":0,"91":0,"93":0,"98":1,"99":0,"100":0,"101":0,"104":0,"105":0,"106":0,"107":0,"108":0,"110":0,"113":0,"114":0,"115":0,"118":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/pushSchedulers/direct.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/pushSchedulers/direct.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":14},"end":{"line":3,"column":34}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":29},"end":{"line":14,"column":74}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":21},"end":{"line":23,"column":32}}},"4":{"name":"(anonymous_4)","line":29,"loc":{"start":{"line":29,"column":18},"end":{"line":29,"column":44}}},"5":{"name":"(anonymous_5)","line":34,"loc":{"start":{"line":34,"column":40},"end":{"line":34,"column":58}}},"6":{"name":"(anonymous_6)","line":43,"loc":{"start":{"line":43,"column":34},"end":{"line":43,"column":52}}},"7":{"name":"(anonymous_7)","line":54,"loc":{"start":{"line":54,"column":18},"end":{"line":54,"column":45}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":3,"column":0},"end":{"line":10,"column":2}},"3":{"start":{"line":4,"column":2},"end":{"line":6,"column":3}},"4":{"start":{"line":5,"column":4},"end":{"line":5,"column":34}},"5":{"start":{"line":8,"column":2},"end":{"line":8,"column":20}},"6":{"start":{"line":9,"column":2},"end":{"line":9,"column":17}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":25}},"8":{"start":{"line":14,"column":0},"end":{"line":27,"column":2}},"9":{"start":{"line":15,"column":2},"end":{"line":15,"column":20}},"10":{"start":{"line":16,"column":2},"end":{"line":20,"column":3}},"11":{"start":{"line":17,"column":4},"end":{"line":17,"column":45}},"12":{"start":{"line":19,"column":4},"end":{"line":19,"column":34}},"13":{"start":{"line":22,"column":2},"end":{"line":26,"column":3}},"14":{"start":{"line":23,"column":4},"end":{"line":25,"column":7}},"15":{"start":{"line":24,"column":6},"end":{"line":24,"column":31}},"16":{"start":{"line":29,"column":0},"end":{"line":52,"column":2}},"17":{"start":{"line":30,"column":2},"end":{"line":30,"column":54}},"18":{"start":{"line":31,"column":2},"end":{"line":31,"column":54}},"19":{"start":{"line":33,"column":2},"end":{"line":51,"column":3}},"20":{"start":{"line":34,"column":4},"end":{"line":41,"column":7}},"21":{"start":{"line":35,"column":6},"end":{"line":38,"column":7}},"22":{"start":{"line":37,"column":8},"end":{"line":37,"column":15}},"23":{"start":{"line":40,"column":6},"end":{"line":40,"column":56}},"24":{"start":{"line":43,"column":4},"end":{"line":50,"column":7}},"25":{"start":{"line":44,"column":6},"end":{"line":47,"column":7}},"26":{"start":{"line":46,"column":8},"end":{"line":46,"column":15}},"27":{"start":{"line":49,"column":6},"end":{"line":49,"column":50}},"28":{"start":{"line":54,"column":0},"end":{"line":59,"column":2}},"29":{"start":{"line":55,"column":2},"end":{"line":55,"column":54}},"30":{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},"31":{"start":{"line":57,"column":4},"end":{"line":57,"column":46}}},"branchMap":{"1":{"line":4,"type":"if","locations":[{"start":{"line":4,"column":2},"end":{"line":4,"column":2}},{"start":{"line":4,"column":2},"end":{"line":4,"column":2}}]},"2":{"line":8,"type":"binary-expr","locations":[{"start":{"line":8,"column":9},"end":{"line":8,"column":13}},{"start":{"line":8,"column":17},"end":{"line":8,"column":19}}]},"3":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":9},"end":{"line":15,"column":13}},{"start":{"line":15,"column":17},"end":{"line":15,"column":19}}]},"4":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":16,"column":2}},{"start":{"line":16,"column":2},"end":{"line":16,"column":2}}]},"5":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":2},"end":{"line":22,"column":2}},{"start":{"line":22,"column":2},"end":{"line":22,"column":2}}]},"6":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":2},"end":{"line":33,"column":2}},{"start":{"line":33,"column":2},"end":{"line":33,"column":2}}]},"7":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":6},"end":{"line":35,"column":6}},{"start":{"line":35,"column":6},"end":{"line":35,"column":6}}]},"8":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":9},"end":{"line":35,"column":39}},{"start":{"line":36,"column":9},"end":{"line":36,"column":72}}]},"9":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":6},"end":{"line":44,"column":6}},{"start":{"line":44,"column":6},"end":{"line":44,"column":6}}]},"10":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":9},"end":{"line":44,"column":39}},{"start":{"line":45,"column":9},"end":{"line":45,"column":72}}]}},"code":["var utils = require('../util/utils');","","var Service = function(app, opts) {","  if (!(this instanceof Service)) {","    return new Service(app, opts);","  }","","  opts = opts || {};","  this.app = app;","};","","module.exports = Service;","","Service.prototype.schedule = function(reqId, route, msg, recvs, opts, cb) {","  opts = opts || {};","  if(opts.type === 'broadcast') {","    doBroadcast(this, msg, opts.userOptions);","  } else {","    doBatchPush(this, msg, recvs);","  }","","  if(cb) {","    process.nextTick(function() {","      utils.invokeCallback(cb);","    });","  }","};","","var doBroadcast = function(self, msg, opts) {","  var channelService = self.app.get('channelService');","  var sessionService = self.app.get('sessionService');","","  if(opts.binded) {","    sessionService.forEachBindedSession(function(session) {","      if(channelService.broadcastFilter &&","         !channelService.broadcastFilter(session, msg, opts.filterParam)) {","        return;","      }","","      sessionService.sendMessageByUid(session.uid, msg);","    });","  } else {","    sessionService.forEachSession(function(session) {","      if(channelService.broadcastFilter &&","         !channelService.broadcastFilter(session, msg, opts.filterParam)) {","        return;","      }","","      sessionService.sendMessage(session.id, msg);","    });","  }","};","","var doBatchPush = function(self, msg, recvs) {","  var sessionService = self.app.get('sessionService');","  for(var i=0, l=recvs.length; i<l; i++) {","    sessionService.sendMessage(recvs[i], msg);","  }","};",""],"l":{"1":1,"3":1,"4":0,"5":0,"8":0,"9":0,"12":1,"14":1,"15":0,"16":0,"17":0,"19":0,"22":0,"23":0,"24":0,"29":1,"30":0,"31":0,"33":0,"34":0,"35":0,"37":0,"40":0,"43":0,"44":0,"46":0,"49":0,"54":1,"55":0,"56":0,"57":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/remote.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/remote.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":1,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":1,"39":0,"40":0,"41":0,"42":0,"43":0},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":17,"loc":{"start":{"line":17,"column":17},"end":{"line":17,"column":37}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":16},"end":{"line":36,"column":36}}},"3":{"name":"(anonymous_3)","line":51,"loc":{"start":{"line":51,"column":12},"end":{"line":51,"column":25}}},"4":{"name":"(anonymous_4)","line":65,"loc":{"start":{"line":65,"column":11},"end":{"line":65,"column":31}}},"5":{"name":"(anonymous_5)","line":77,"loc":{"start":{"line":77,"column":21},"end":{"line":77,"column":35}}},"6":{"name":"(anonymous_6)","line":107,"loc":{"start":{"line":107,"column":16},"end":{"line":107,"column":36}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":23}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":43}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":48}},"4":{"start":{"line":17,"column":0},"end":{"line":28,"column":2}},"5":{"start":{"line":18,"column":2},"end":{"line":18,"column":20}},"6":{"start":{"line":21,"column":2},"end":{"line":21,"column":60}},"7":{"start":{"line":22,"column":2},"end":{"line":22,"column":38}},"8":{"start":{"line":23,"column":2},"end":{"line":26,"column":3}},"9":{"start":{"line":24,"column":4},"end":{"line":24,"column":28}},"10":{"start":{"line":25,"column":4},"end":{"line":25,"column":81}},"11":{"start":{"line":27,"column":2},"end":{"line":27,"column":34}},"12":{"start":{"line":36,"column":0},"end":{"line":39,"column":2}},"13":{"start":{"line":37,"column":2},"end":{"line":37,"column":17}},"14":{"start":{"line":38,"column":2},"end":{"line":38,"column":19}},"15":{"start":{"line":41,"column":0},"end":{"line":41,"column":30}},"16":{"start":{"line":43,"column":0},"end":{"line":43,"column":24}},"17":{"start":{"line":51,"column":0},"end":{"line":56,"column":2}},"18":{"start":{"line":52,"column":2},"end":{"line":52,"column":48}},"19":{"start":{"line":53,"column":2},"end":{"line":53,"column":47}},"20":{"start":{"line":54,"column":2},"end":{"line":54,"column":22}},"21":{"start":{"line":55,"column":2},"end":{"line":55,"column":23}},"22":{"start":{"line":65,"column":0},"end":{"line":68,"column":2}},"23":{"start":{"line":66,"column":2},"end":{"line":66,"column":26}},"24":{"start":{"line":67,"column":2},"end":{"line":67,"column":23}},"25":{"start":{"line":77,"column":0},"end":{"line":98,"column":2}},"26":{"start":{"line":78,"column":2},"end":{"line":78,"column":17}},"27":{"start":{"line":80,"column":2},"end":{"line":80,"column":11}},"28":{"start":{"line":82,"column":2},"end":{"line":86,"column":3}},"29":{"start":{"line":83,"column":4},"end":{"line":83,"column":22}},"30":{"start":{"line":85,"column":4},"end":{"line":85,"column":21}},"31":{"start":{"line":88,"column":2},"end":{"line":88,"column":82}},"32":{"start":{"line":89,"column":2},"end":{"line":91,"column":3}},"33":{"start":{"line":90,"column":4},"end":{"line":90,"column":70}},"34":{"start":{"line":92,"column":2},"end":{"line":92,"column":71}},"35":{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},"36":{"start":{"line":94,"column":4},"end":{"line":94,"column":72}},"37":{"start":{"line":97,"column":2},"end":{"line":97,"column":15}},"38":{"start":{"line":107,"column":0},"end":{"line":115,"column":2}},"39":{"start":{"line":108,"column":2},"end":{"line":108,"column":35}},"40":{"start":{"line":109,"column":2},"end":{"line":109,"column":21}},"41":{"start":{"line":110,"column":2},"end":{"line":114,"column":3}},"42":{"start":{"line":111,"column":4},"end":{"line":111,"column":39}},"43":{"start":{"line":113,"column":4},"end":{"line":113,"column":37}}},"branchMap":{"1":{"line":18,"type":"binary-expr","locations":[{"start":{"line":18,"column":9},"end":{"line":18,"column":13}},{"start":{"line":18,"column":17},"end":{"line":18,"column":19}}]},"2":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":19},"end":{"line":21,"column":33}},{"start":{"line":21,"column":37},"end":{"line":21,"column":50}},{"start":{"line":21,"column":54},"end":{"line":21,"column":59}}]},"3":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":18},"end":{"line":22,"column":31}},{"start":{"line":22,"column":35},"end":{"line":22,"column":37}}]},"4":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":2},"end":{"line":23,"column":2}},{"start":{"line":23,"column":2},"end":{"line":23,"column":2}}]},"5":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":2},"end":{"line":82,"column":2}},{"start":{"line":82,"column":2},"end":{"line":82,"column":2}}]},"6":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":2},"end":{"line":89,"column":2}},{"start":{"line":89,"column":2},"end":{"line":89,"column":2}}]},"7":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":2},"end":{"line":93,"column":2}},{"start":{"line":93,"column":2},"end":{"line":93,"column":2}}]},"8":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":2},"end":{"line":110,"column":2}},{"start":{"line":110,"column":2},"end":{"line":110,"column":2}}]}},"code":["/**"," * Component for remote service."," * Load remote service and add to global context."," */","var fs = require('fs');","var pathUtil = require('../util/pathUtil');","var RemoteServer = require('pomelo-rpc').server;","","/**"," * Remote component factory function"," *"," * @param {Object} app  current application context"," * @param {Object} opts construct parameters"," *                       opts.acceptorFactory {Object}: acceptorFactory.create(opts, cb)"," * @return {Object}     remote component instances"," */","module.exports = function(app, opts) {","  opts = opts || {};","","  // cacheMsg is deprecated, just for compatibility here.","  opts.bufferMsg = opts.bufferMsg || opts.cacheMsg || false;","  opts.interval = opts.interval || 30;","  if(app.enabled('rpcDebugLog')) {","    opts.rpcDebugLog = true;","    opts.rpcLogger = require('pomelo-logger').getLogger('rpc-debug', __filename);","  }","  return new Component(app, opts);","};","","/**"," * Remote component class"," *"," * @param {Object} app  current application context"," * @param {Object} opts construct parameters"," */","var Component = function(app, opts) {","  this.app = app;","  this.opts = opts;","};","","var pro = Component.prototype;","","pro.name = '__remote__';","","/**"," * Remote component lifecycle function"," *"," * @param {Function} cb"," * @return {Void}"," */","pro.start = function(cb) {","  this.opts.port = this.app.getCurServer().port;","  this.remote = genRemote(this.app, this.opts);","  this.remote.start();","  process.nextTick(cb);","};","","/**"," * Remote component lifecycle function"," *"," * @param {Boolean}  force whether stop the component immediately"," * @param {Function}  cb"," * @return {Void}"," */","pro.stop = function(force, cb) {","  this.remote.stop(force);","  process.nextTick(cb);","};","","/**"," * Get remote paths from application"," *"," * @param {Object} app current application context"," * @return {Array} paths"," *"," */","var getRemotePaths = function(app) {","  var paths = [];","","  var role;","  // master server should not come here","  if(app.isFrontend()) {","    role = 'frontend';","  } else {","    role = 'backend';","  }","","  var sysPath = pathUtil.getSysRemotePath(role), serverType = app.getServerType();","  if(fs.existsSync(sysPath)) {","    paths.push(pathUtil.remotePathRecord('sys', serverType, sysPath));","  }","  var userPath = pathUtil.getUserRemotePath(app.getBase(), serverType);","  if(fs.existsSync(userPath)) {","    paths.push(pathUtil.remotePathRecord('user', serverType, userPath));","  }","","  return paths;","};","","/**"," * Generate remote server instance"," *"," * @param {Object} app current application context"," * @param {Object} opts contructor parameters for rpc Server"," * @return {Object} remote server instance"," */","var genRemote = function(app, opts) {","  opts.paths = getRemotePaths(app);","  opts.context = app;","  if(!!opts.rpcServer) {","    return opts.rpcServer.create(opts);","  } else {","    return RemoteServer.create(opts);","  }","};",""],"l":{"5":1,"6":1,"7":1,"17":1,"18":0,"21":0,"22":0,"23":0,"24":0,"25":0,"27":0,"36":1,"37":0,"38":0,"41":1,"43":1,"51":1,"52":0,"53":0,"54":0,"55":0,"65":1,"66":0,"67":0,"77":1,"78":0,"80":0,"82":0,"83":0,"85":0,"88":0,"89":0,"90":0,"92":0,"93":0,"94":0,"97":0,"107":1,"108":0,"109":0,"110":0,"111":0,"113":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/server.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/server.js","s":{"1":1,"2":1,"3":0,"4":1,"5":0,"6":1,"7":1,"8":1,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":0,"16":0,"17":1,"18":0,"19":1,"20":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":17},"end":{"line":12,"column":37}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":16},"end":{"line":21,"column":36}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":12},"end":{"line":35,"column":25}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":33},"end":{"line":46,"column":46}}},"5":{"name":"(anonymous_5)","line":58,"loc":{"start":{"line":58,"column":11},"end":{"line":58,"column":31}}},"6":{"name":"(anonymous_6)","line":66,"loc":{"start":{"line":66,"column":13},"end":{"line":66,"column":40}}},"7":{"name":"(anonymous_7)","line":73,"loc":{"start":{"line":73,"column":35},"end":{"line":73,"column":62}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":41}},"2":{"start":{"line":12,"column":0},"end":{"line":14,"column":2}},"3":{"start":{"line":13,"column":1},"end":{"line":13,"column":33}},"4":{"start":{"line":21,"column":0},"end":{"line":23,"column":2}},"5":{"start":{"line":22,"column":1},"end":{"line":22,"column":40}},"6":{"start":{"line":25,"column":0},"end":{"line":25,"column":30}},"7":{"start":{"line":27,"column":0},"end":{"line":27,"column":24}},"8":{"start":{"line":35,"column":0},"end":{"line":38,"column":2}},"9":{"start":{"line":36,"column":1},"end":{"line":36,"column":21}},"10":{"start":{"line":37,"column":1},"end":{"line":37,"column":22}},"11":{"start":{"line":46,"column":0},"end":{"line":49,"column":2}},"12":{"start":{"line":47,"column":1},"end":{"line":47,"column":26}},"13":{"start":{"line":48,"column":1},"end":{"line":48,"column":22}},"14":{"start":{"line":58,"column":0},"end":{"line":61,"column":2}},"15":{"start":{"line":59,"column":1},"end":{"line":59,"column":20}},"16":{"start":{"line":60,"column":1},"end":{"line":60,"column":22}},"17":{"start":{"line":66,"column":0},"end":{"line":68,"column":2}},"18":{"start":{"line":67,"column":1},"end":{"line":67,"column":38}},"19":{"start":{"line":73,"column":0},"end":{"line":75,"column":2}},"20":{"start":{"line":74,"column":1},"end":{"line":74,"column":44}}},"branchMap":{},"code":["/**"," * Component for server starup."," */","var Server = require('../server/server');","","/**"," * Component factory function"," *"," * @param {Object} app  current application context"," * @return {Object}     component instance"," */","module.exports = function(app, opts) {","\treturn new Component(app, opts);","};","","/**"," * Server component class"," *"," * @param {Object} app  current application context"," */","var Component = function(app, opts) {","\tthis.server = Server.create(app, opts);","};","","var pro = Component.prototype;","","pro.name = '__server__';","","/**"," * Component lifecycle callback"," *"," * @param {Function} cb"," * @return {Void}"," */","pro.start = function(cb) {","\tthis.server.start();","\tprocess.nextTick(cb);","};","","/**"," * Component lifecycle callback"," *"," * @param {Function} cb"," * @return {Void}"," */","Component.prototype.afterStart = function(cb) {","\tthis.server.afterStart();","\tprocess.nextTick(cb);","};","","/**"," * Component lifecycle function"," *"," * @param {Boolean}  force whether stop the component immediately"," * @param {Function}  cb"," * @return {Void}"," */","pro.stop = function(force, cb) {","\tthis.server.stop();","\tprocess.nextTick(cb);","};","","/**"," * Proxy server handle"," */","pro.handle = function(msg, session, cb) {","\tthis.server.handle(msg, session, cb);","};","","/**"," * Proxy server global handle"," */","Component.prototype.globalHandle = function(msg, session, cb) {","\tthis.server.globalHandle(msg, session, cb);","};"],"l":{"4":1,"12":1,"13":0,"21":1,"22":0,"25":1,"27":1,"35":1,"36":0,"37":0,"46":1,"47":0,"48":0,"58":1,"59":0,"60":0,"66":1,"67":0,"73":1,"74":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/server/server.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/server/server.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":1,"39":0,"40":1,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":1,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":1,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":1,"100":0,"101":0,"102":0,"103":1,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":1,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":1,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":1,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":1,"150":0,"151":0,"152":0,"153":0,"154":1,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":1,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":1,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":1,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":1,"214":0,"215":0,"216":0,"217":1,"218":0,"219":0,"220":0,"221":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0},"fnMap":{"1":{"name":"(anonymous_1)","line":27,"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":44}}},"2":{"name":"(anonymous_2)","line":31,"loc":{"start":{"line":31,"column":13},"end":{"line":31,"column":34}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":12},"end":{"line":50,"column":23}}},"4":{"name":"(anonymous_4)","line":63,"loc":{"start":{"line":63,"column":17},"end":{"line":63,"column":28}}},"5":{"name":"(anonymous_5)","line":70,"loc":{"start":{"line":70,"column":11},"end":{"line":70,"column":22}}},"6":{"name":"(anonymous_6)","line":81,"loc":{"start":{"line":81,"column":19},"end":{"line":81,"column":46}}},"7":{"name":"(anonymous_7)","line":94,"loc":{"start":{"line":94,"column":17},"end":{"line":94,"column":43}}},"8":{"name":"(anonymous_8)","line":96,"loc":{"start":{"line":96,"column":61},"end":{"line":96,"column":87}}},"9":{"name":"(anonymous_9)","line":103,"loc":{"start":{"line":103,"column":53},"end":{"line":103,"column":79}}},"10":{"name":"(anonymous_10)","line":107,"loc":{"start":{"line":107,"column":48},"end":{"line":107,"column":74}}},"11":{"name":"(anonymous_11)","line":118,"loc":{"start":{"line":118,"column":13},"end":{"line":118,"column":40}}},"12":{"name":"(anonymous_12)","line":133,"loc":{"start":{"line":133,"column":15},"end":{"line":133,"column":31}}},"13":{"name":"(anonymous_13)","line":147,"loc":{"start":{"line":147,"column":18},"end":{"line":147,"column":34}}},"14":{"name":"(anonymous_14)","line":159,"loc":{"start":{"line":159,"column":17},"end":{"line":159,"column":41}}},"15":{"name":"(anonymous_15)","line":187,"loc":{"start":{"line":187,"column":18},"end":{"line":187,"column":38}}},"16":{"name":"(anonymous_16)","line":194,"loc":{"start":{"line":194,"column":23},"end":{"line":194,"column":37}}},"17":{"name":"(anonymous_17)","line":204,"loc":{"start":{"line":204,"column":16},"end":{"line":204,"column":38}}},"18":{"name":"(anonymous_18)","line":234,"loc":{"start":{"line":234,"column":19},"end":{"line":234,"column":64}}},"19":{"name":"(anonymous_19)","line":251,"loc":{"start":{"line":251,"column":18},"end":{"line":251,"column":80}}},"20":{"name":"(anonymous_20)","line":260,"loc":{"start":{"line":260,"column":46},"end":{"line":260,"column":57}}},"21":{"name":"(anonymous_21)","line":264,"loc":{"start":{"line":264,"column":46},"end":{"line":264,"column":60}}},"22":{"name":"(anonymous_22)","line":274,"loc":{"start":{"line":274,"column":18},"end":{"line":274,"column":80}}},"23":{"name":"(anonymous_23)","line":297,"loc":{"start":{"line":297,"column":15},"end":{"line":297,"column":77}}},"24":{"name":"(anonymous_24)","line":313,"loc":{"start":{"line":313,"column":17},"end":{"line":313,"column":33}}},"25":{"name":"(anonymous_25)","line":330,"loc":{"start":{"line":330,"column":16},"end":{"line":330,"column":61}}},"26":{"name":"(anonymous_26)","line":343,"loc":{"start":{"line":343,"column":6},"end":{"line":343,"column":32}}},"27":{"name":"(anonymous_27)","line":359,"loc":{"start":{"line":359,"column":15},"end":{"line":359,"column":63}}},"28":{"name":"(anonymous_28)","line":366,"loc":{"start":{"line":366,"column":15},"end":{"line":366,"column":41}}},"29":{"name":"(anonymous_29)","line":369,"loc":{"start":{"line":369,"column":62},"end":{"line":369,"column":88}}},"30":{"name":"(anonymous_30)","line":375,"loc":{"start":{"line":375,"column":58},"end":{"line":375,"column":84}}},"31":{"name":"(anonymous_31)","line":378,"loc":{"start":{"line":378,"column":64},"end":{"line":378,"column":90}}},"32":{"name":"(anonymous_32)","line":394,"loc":{"start":{"line":394,"column":20},"end":{"line":394,"column":44}}},"33":{"name":"(anonymous_33)","line":434,"loc":{"start":{"line":434,"column":18},"end":{"line":434,"column":48}}},"34":{"name":"(anonymous_34)","line":445,"loc":{"start":{"line":445,"column":18},"end":{"line":445,"column":38}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":70}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":23}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":43}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":38}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":37}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":43}},"8":{"start":{"line":12,"column":0},"end":{"line":12,"column":39}},"9":{"start":{"line":13,"column":0},"end":{"line":13,"column":45}},"10":{"start":{"line":14,"column":0},"end":{"line":14,"column":63}},"11":{"start":{"line":15,"column":0},"end":{"line":15,"column":65}},"12":{"start":{"line":17,"column":0},"end":{"line":17,"column":18}},"13":{"start":{"line":18,"column":0},"end":{"line":18,"column":19}},"14":{"start":{"line":19,"column":0},"end":{"line":19,"column":18}},"15":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"16":{"start":{"line":28,"column":2},"end":{"line":28,"column":31}},"17":{"start":{"line":31,"column":0},"end":{"line":43,"column":2}},"18":{"start":{"line":32,"column":2},"end":{"line":32,"column":25}},"19":{"start":{"line":33,"column":2},"end":{"line":33,"column":17}},"20":{"start":{"line":34,"column":2},"end":{"line":34,"column":34}},"21":{"start":{"line":35,"column":2},"end":{"line":35,"column":28}},"22":{"start":{"line":36,"column":2},"end":{"line":36,"column":29}},"23":{"start":{"line":37,"column":2},"end":{"line":37,"column":18}},"24":{"start":{"line":38,"column":2},"end":{"line":38,"column":17}},"25":{"start":{"line":39,"column":2},"end":{"line":39,"column":25}},"26":{"start":{"line":41,"column":2},"end":{"line":41,"column":59}},"27":{"start":{"line":42,"column":2},"end":{"line":42,"column":65}},"28":{"start":{"line":45,"column":0},"end":{"line":45,"column":27}},"29":{"start":{"line":50,"column":0},"end":{"line":61,"column":2}},"30":{"start":{"line":51,"column":2},"end":{"line":53,"column":3}},"31":{"start":{"line":52,"column":4},"end":{"line":52,"column":11}},"32":{"start":{"line":55,"column":2},"end":{"line":55,"column":56}},"33":{"start":{"line":56,"column":2},"end":{"line":56,"column":51}},"34":{"start":{"line":57,"column":2},"end":{"line":57,"column":57}},"35":{"start":{"line":58,"column":2},"end":{"line":58,"column":49}},"36":{"start":{"line":59,"column":2},"end":{"line":59,"column":28}},"37":{"start":{"line":60,"column":2},"end":{"line":60,"column":26}},"38":{"start":{"line":63,"column":0},"end":{"line":65,"column":2}},"39":{"start":{"line":64,"column":2},"end":{"line":64,"column":34}},"40":{"start":{"line":70,"column":0},"end":{"line":72,"column":2}},"41":{"start":{"line":71,"column":2},"end":{"line":71,"column":25}},"42":{"start":{"line":81,"column":0},"end":{"line":113,"column":2}},"43":{"start":{"line":82,"column":2},"end":{"line":85,"column":3}},"44":{"start":{"line":83,"column":4},"end":{"line":83,"column":62}},"45":{"start":{"line":84,"column":4},"end":{"line":84,"column":11}},"46":{"start":{"line":87,"column":2},"end":{"line":87,"column":42}},"47":{"start":{"line":88,"column":2},"end":{"line":91,"column":3}},"48":{"start":{"line":89,"column":4},"end":{"line":89,"column":84}},"49":{"start":{"line":90,"column":4},"end":{"line":90,"column":11}},"50":{"start":{"line":93,"column":2},"end":{"line":93,"column":18}},"51":{"start":{"line":94,"column":2},"end":{"line":111,"column":4}},"52":{"start":{"line":95,"column":4},"end":{"line":100,"column":5}},"53":{"start":{"line":96,"column":6},"end":{"line":98,"column":9}},"54":{"start":{"line":97,"column":8},"end":{"line":97,"column":64}},"55":{"start":{"line":99,"column":6},"end":{"line":99,"column":13}},"56":{"start":{"line":102,"column":4},"end":{"line":110,"column":5}},"57":{"start":{"line":103,"column":6},"end":{"line":105,"column":9}},"58":{"start":{"line":104,"column":8},"end":{"line":104,"column":64}},"59":{"start":{"line":107,"column":6},"end":{"line":109,"column":9}},"60":{"start":{"line":108,"column":8},"end":{"line":108,"column":64}},"61":{"start":{"line":112,"column":2},"end":{"line":112,"column":51}},"62":{"start":{"line":118,"column":0},"end":{"line":126,"column":2}},"63":{"start":{"line":119,"column":3},"end":{"line":122,"column":3}},"64":{"start":{"line":120,"column":4},"end":{"line":120,"column":40}},"65":{"start":{"line":121,"column":4},"end":{"line":121,"column":11}},"66":{"start":{"line":124,"column":2},"end":{"line":124,"column":42}},"67":{"start":{"line":125,"column":2},"end":{"line":125,"column":48}},"68":{"start":{"line":133,"column":0},"end":{"line":140,"column":2}},"69":{"start":{"line":134,"column":2},"end":{"line":134,"column":49}},"70":{"start":{"line":135,"column":2},"end":{"line":138,"column":3}},"71":{"start":{"line":136,"column":4},"end":{"line":136,"column":24}},"72":{"start":{"line":137,"column":4},"end":{"line":137,"column":40}},"73":{"start":{"line":139,"column":2},"end":{"line":139,"column":29}},"74":{"start":{"line":147,"column":0},"end":{"line":157,"column":2}},"75":{"start":{"line":148,"column":2},"end":{"line":156,"column":3}},"76":{"start":{"line":149,"column":4},"end":{"line":149,"column":24}},"77":{"start":{"line":150,"column":4},"end":{"line":150,"column":31}},"78":{"start":{"line":151,"column":4},"end":{"line":155,"column":5}},"79":{"start":{"line":152,"column":6},"end":{"line":152,"column":40}},"80":{"start":{"line":154,"column":6},"end":{"line":154,"column":58}},"81":{"start":{"line":159,"column":0},"end":{"line":185,"column":2}},"82":{"start":{"line":160,"column":2},"end":{"line":160,"column":36}},"83":{"start":{"line":161,"column":2},"end":{"line":161,"column":22}},"84":{"start":{"line":163,"column":2},"end":{"line":169,"column":3}},"85":{"start":{"line":164,"column":4},"end":{"line":164,"column":63}},"86":{"start":{"line":165,"column":4},"end":{"line":165,"column":61}},"87":{"start":{"line":167,"column":4},"end":{"line":167,"column":56}},"88":{"start":{"line":168,"column":4},"end":{"line":168,"column":54}},"89":{"start":{"line":171,"column":2},"end":{"line":171,"column":11}},"90":{"start":{"line":172,"column":2},"end":{"line":176,"column":3}},"91":{"start":{"line":173,"column":4},"end":{"line":175,"column":5}},"92":{"start":{"line":174,"column":6},"end":{"line":174,"column":33}},"93":{"start":{"line":178,"column":2},"end":{"line":182,"column":3}},"94":{"start":{"line":179,"column":4},"end":{"line":181,"column":5}},"95":{"start":{"line":180,"column":6},"end":{"line":180,"column":31}},"96":{"start":{"line":184,"column":2},"end":{"line":184,"column":17}},"97":{"start":{"line":187,"column":0},"end":{"line":189,"column":2}},"98":{"start":{"line":188,"column":2},"end":{"line":188,"column":39}},"99":{"start":{"line":194,"column":0},"end":{"line":199,"column":2}},"100":{"start":{"line":195,"column":2},"end":{"line":195,"column":67}},"101":{"start":{"line":196,"column":2},"end":{"line":198,"column":3}},"102":{"start":{"line":197,"column":4},"end":{"line":197,"column":31}},"103":{"start":{"line":204,"column":0},"end":{"line":229,"column":2}},"104":{"start":{"line":205,"column":2},"end":{"line":205,"column":44}},"105":{"start":{"line":206,"column":2},"end":{"line":206,"column":60}},"106":{"start":{"line":207,"column":2},"end":{"line":212,"column":3}},"107":{"start":{"line":208,"column":4},"end":{"line":208,"column":109}},"108":{"start":{"line":209,"column":4},"end":{"line":211,"column":5}},"109":{"start":{"line":210,"column":6},"end":{"line":210,"column":13}},"110":{"start":{"line":213,"column":2},"end":{"line":213,"column":75}},"111":{"start":{"line":214,"column":2},"end":{"line":214,"column":48}},"112":{"start":{"line":215,"column":2},"end":{"line":228,"column":3}},"113":{"start":{"line":216,"column":4},"end":{"line":227,"column":5}},"114":{"start":{"line":217,"column":6},"end":{"line":217,"column":35}},"115":{"start":{"line":218,"column":6},"end":{"line":226,"column":7}},"116":{"start":{"line":219,"column":8},"end":{"line":225,"column":9}},"117":{"start":{"line":220,"column":10},"end":{"line":220,"column":53}},"118":{"start":{"line":222,"column":10},"end":{"line":224,"column":11}},"119":{"start":{"line":223,"column":12},"end":{"line":223,"column":55}},"120":{"start":{"line":234,"column":0},"end":{"line":246,"column":2}},"121":{"start":{"line":235,"column":2},"end":{"line":235,"column":9}},"122":{"start":{"line":236,"column":2},"end":{"line":240,"column":3}},"123":{"start":{"line":237,"column":4},"end":{"line":237,"column":36}},"124":{"start":{"line":239,"column":4},"end":{"line":239,"column":30}},"125":{"start":{"line":241,"column":2},"end":{"line":245,"column":3}},"126":{"start":{"line":242,"column":4},"end":{"line":242,"column":38}},"127":{"start":{"line":244,"column":4},"end":{"line":244,"column":29}},"128":{"start":{"line":251,"column":0},"end":{"line":269,"column":2}},"129":{"start":{"line":252,"column":2},"end":{"line":252,"column":9}},"130":{"start":{"line":253,"column":2},"end":{"line":257,"column":3}},"131":{"start":{"line":254,"column":4},"end":{"line":254,"column":36}},"132":{"start":{"line":256,"column":4},"end":{"line":256,"column":30}},"133":{"start":{"line":258,"column":2},"end":{"line":268,"column":3}},"134":{"start":{"line":259,"column":4},"end":{"line":267,"column":5}},"135":{"start":{"line":260,"column":6},"end":{"line":262,"column":9}},"136":{"start":{"line":264,"column":6},"end":{"line":266,"column":9}},"137":{"start":{"line":265,"column":8},"end":{"line":265,"column":28}},"138":{"start":{"line":274,"column":0},"end":{"line":291,"column":2}},"139":{"start":{"line":275,"column":2},"end":{"line":275,"column":14}},"140":{"start":{"line":276,"column":2},"end":{"line":280,"column":3}},"141":{"start":{"line":277,"column":4},"end":{"line":277,"column":70}},"142":{"start":{"line":279,"column":4},"end":{"line":279,"column":63}},"143":{"start":{"line":281,"column":2},"end":{"line":290,"column":3}},"144":{"start":{"line":282,"column":4},"end":{"line":282,"column":88}},"145":{"start":{"line":283,"column":4},"end":{"line":283,"column":46}},"146":{"start":{"line":285,"column":4},"end":{"line":289,"column":5}},"147":{"start":{"line":286,"column":6},"end":{"line":286,"column":43}},"148":{"start":{"line":288,"column":7},"end":{"line":288,"column":50}},"149":{"start":{"line":297,"column":0},"end":{"line":305,"column":2}},"150":{"start":{"line":298,"column":2},"end":{"line":304,"column":3}},"151":{"start":{"line":299,"column":4},"end":{"line":299,"column":24}},"152":{"start":{"line":301,"column":4},"end":{"line":301,"column":69}},"153":{"start":{"line":303,"column":4},"end":{"line":303,"column":69}},"154":{"start":{"line":313,"column":0},"end":{"line":328,"column":2}},"155":{"start":{"line":314,"column":2},"end":{"line":316,"column":3}},"156":{"start":{"line":315,"column":4},"end":{"line":315,"column":16}},"157":{"start":{"line":317,"column":2},"end":{"line":317,"column":28}},"158":{"start":{"line":318,"column":2},"end":{"line":320,"column":3}},"159":{"start":{"line":319,"column":4},"end":{"line":319,"column":16}},"160":{"start":{"line":322,"column":2},"end":{"line":327,"column":4}},"161":{"start":{"line":330,"column":0},"end":{"line":357,"column":2}},"162":{"start":{"line":331,"column":2},"end":{"line":331,"column":23}},"163":{"start":{"line":333,"column":2},"end":{"line":356,"column":3}},"164":{"start":{"line":334,"column":4},"end":{"line":350,"column":6}},"165":{"start":{"line":344,"column":8},"end":{"line":346,"column":9}},"166":{"start":{"line":345,"column":10},"end":{"line":345,"column":70}},"167":{"start":{"line":347,"column":8},"end":{"line":347,"column":24}},"168":{"start":{"line":348,"column":8},"end":{"line":348,"column":50}},"169":{"start":{"line":352,"column":4},"end":{"line":355,"column":5}},"170":{"start":{"line":353,"column":6},"end":{"line":353,"column":59}},"171":{"start":{"line":354,"column":6},"end":{"line":354,"column":36}},"172":{"start":{"line":359,"column":0},"end":{"line":389,"column":2}},"173":{"start":{"line":360,"column":2},"end":{"line":360,"column":22}},"174":{"start":{"line":361,"column":2},"end":{"line":361,"column":23}},"175":{"start":{"line":362,"column":2},"end":{"line":362,"column":34}},"176":{"start":{"line":364,"column":2},"end":{"line":364,"column":20}},"177":{"start":{"line":366,"column":2},"end":{"line":386,"column":4}},"178":{"start":{"line":367,"column":4},"end":{"line":373,"column":5}},"179":{"start":{"line":369,"column":6},"end":{"line":371,"column":9}},"180":{"start":{"line":370,"column":8},"end":{"line":370,"column":65}},"181":{"start":{"line":372,"column":6},"end":{"line":372,"column":13}},"182":{"start":{"line":375,"column":4},"end":{"line":385,"column":7}},"183":{"start":{"line":376,"column":6},"end":{"line":382,"column":7}},"184":{"start":{"line":378,"column":8},"end":{"line":380,"column":11}},"185":{"start":{"line":379,"column":10},"end":{"line":379,"column":67}},"186":{"start":{"line":381,"column":8},"end":{"line":381,"column":15}},"187":{"start":{"line":384,"column":6},"end":{"line":384,"column":63}},"188":{"start":{"line":388,"column":2},"end":{"line":388,"column":52}},"189":{"start":{"line":394,"column":0},"end":{"line":429,"column":2}},"190":{"start":{"line":395,"column":2},"end":{"line":395,"column":37}},"191":{"start":{"line":396,"column":2},"end":{"line":428,"column":3}},"192":{"start":{"line":397,"column":4},"end":{"line":397,"column":28}},"193":{"start":{"line":398,"column":4},"end":{"line":398,"column":29}},"194":{"start":{"line":399,"column":4},"end":{"line":399,"column":33}},"195":{"start":{"line":400,"column":4},"end":{"line":400,"column":28}},"196":{"start":{"line":402,"column":4},"end":{"line":405,"column":5}},"197":{"start":{"line":403,"column":6},"end":{"line":403,"column":67}},"198":{"start":{"line":404,"column":6},"end":{"line":404,"column":15}},"199":{"start":{"line":407,"column":4},"end":{"line":410,"column":5}},"200":{"start":{"line":408,"column":6},"end":{"line":408,"column":64}},"201":{"start":{"line":409,"column":6},"end":{"line":409,"column":15}},"202":{"start":{"line":412,"column":4},"end":{"line":412,"column":36}},"203":{"start":{"line":413,"column":4},"end":{"line":413,"column":35}},"204":{"start":{"line":414,"column":4},"end":{"line":414,"column":33}},"205":{"start":{"line":416,"column":4},"end":{"line":419,"column":5}},"206":{"start":{"line":417,"column":6},"end":{"line":417,"column":56}},"207":{"start":{"line":418,"column":6},"end":{"line":418,"column":15}},"208":{"start":{"line":421,"column":4},"end":{"line":424,"column":5}},"209":{"start":{"line":422,"column":6},"end":{"line":422,"column":69}},"210":{"start":{"line":423,"column":6},"end":{"line":423,"column":15}},"211":{"start":{"line":426,"column":4},"end":{"line":426,"column":68}},"212":{"start":{"line":427,"column":4},"end":{"line":427,"column":28}},"213":{"start":{"line":434,"column":0},"end":{"line":440,"column":2}},"214":{"start":{"line":435,"column":2},"end":{"line":439,"column":3}},"215":{"start":{"line":436,"column":4},"end":{"line":436,"column":28}},"216":{"start":{"line":438,"column":4},"end":{"line":438,"column":48}},"217":{"start":{"line":445,"column":0},"end":{"line":452,"column":2}},"218":{"start":{"line":446,"column":2},"end":{"line":450,"column":3}},"219":{"start":{"line":447,"column":4},"end":{"line":449,"column":5}},"220":{"start":{"line":448,"column":6},"end":{"line":448,"column":18}},"221":{"start":{"line":451,"column":2},"end":{"line":451,"column":15}}},"branchMap":{"1":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":14},"end":{"line":32,"column":18}},{"start":{"line":32,"column":22},"end":{"line":32,"column":24}}]},"2":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":2},"end":{"line":51,"column":2}},{"start":{"line":51,"column":2},"end":{"line":51,"column":2}}]},"3":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":2},"end":{"line":82,"column":2}},{"start":{"line":82,"column":2},"end":{"line":82,"column":2}}]},"4":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":2},"end":{"line":88,"column":2}},{"start":{"line":88,"column":2},"end":{"line":88,"column":2}}]},"5":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":4},"end":{"line":95,"column":4}},{"start":{"line":95,"column":4},"end":{"line":95,"column":4}}]},"6":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":4},"end":{"line":102,"column":4}},{"start":{"line":102,"column":4},"end":{"line":102,"column":4}}]},"7":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":3},"end":{"line":119,"column":3}},{"start":{"line":119,"column":3},"end":{"line":119,"column":3}}]},"8":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":4},"end":{"line":151,"column":4}},{"start":{"line":151,"column":4},"end":{"line":151,"column":4}}]},"9":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":2},"end":{"line":163,"column":2}},{"start":{"line":163,"column":2},"end":{"line":163,"column":2}}]},"10":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":2},"end":{"line":172,"column":2}},{"start":{"line":172,"column":2},"end":{"line":172,"column":2}}]},"11":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":2},"end":{"line":178,"column":2}},{"start":{"line":178,"column":2},"end":{"line":178,"column":2}}]},"12":{"line":196,"type":"if","locations":[{"start":{"line":196,"column":2},"end":{"line":196,"column":2}},{"start":{"line":196,"column":2},"end":{"line":196,"column":2}}]},"13":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":2},"end":{"line":207,"column":2}},{"start":{"line":207,"column":2},"end":{"line":207,"column":2}}]},"14":{"line":209,"type":"if","locations":[{"start":{"line":209,"column":4},"end":{"line":209,"column":4}},{"start":{"line":209,"column":4},"end":{"line":209,"column":4}}]},"15":{"line":216,"type":"if","locations":[{"start":{"line":216,"column":4},"end":{"line":216,"column":4}},{"start":{"line":216,"column":4},"end":{"line":216,"column":4}}]},"16":{"line":219,"type":"if","locations":[{"start":{"line":219,"column":8},"end":{"line":219,"column":8}},{"start":{"line":219,"column":8},"end":{"line":219,"column":8}}]},"17":{"line":222,"type":"if","locations":[{"start":{"line":222,"column":10},"end":{"line":222,"column":10}},{"start":{"line":222,"column":10},"end":{"line":222,"column":10}}]},"18":{"line":236,"type":"if","locations":[{"start":{"line":236,"column":2},"end":{"line":236,"column":2}},{"start":{"line":236,"column":2},"end":{"line":236,"column":2}}]},"19":{"line":241,"type":"if","locations":[{"start":{"line":241,"column":2},"end":{"line":241,"column":2}},{"start":{"line":241,"column":2},"end":{"line":241,"column":2}}]},"20":{"line":253,"type":"if","locations":[{"start":{"line":253,"column":2},"end":{"line":253,"column":2}},{"start":{"line":253,"column":2},"end":{"line":253,"column":2}}]},"21":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":2},"end":{"line":258,"column":2}},{"start":{"line":258,"column":2},"end":{"line":258,"column":2}}]},"22":{"line":259,"type":"if","locations":[{"start":{"line":259,"column":4},"end":{"line":259,"column":4}},{"start":{"line":259,"column":4},"end":{"line":259,"column":4}}]},"23":{"line":276,"type":"if","locations":[{"start":{"line":276,"column":2},"end":{"line":276,"column":2}},{"start":{"line":276,"column":2},"end":{"line":276,"column":2}}]},"24":{"line":281,"type":"if","locations":[{"start":{"line":281,"column":2},"end":{"line":281,"column":2}},{"start":{"line":281,"column":2},"end":{"line":281,"column":2}}]},"25":{"line":285,"type":"if","locations":[{"start":{"line":285,"column":4},"end":{"line":285,"column":4}},{"start":{"line":285,"column":4},"end":{"line":285,"column":4}}]},"26":{"line":298,"type":"if","locations":[{"start":{"line":298,"column":2},"end":{"line":298,"column":2}},{"start":{"line":298,"column":2},"end":{"line":298,"column":2}}]},"27":{"line":314,"type":"if","locations":[{"start":{"line":314,"column":2},"end":{"line":314,"column":2}},{"start":{"line":314,"column":2},"end":{"line":314,"column":2}}]},"28":{"line":318,"type":"if","locations":[{"start":{"line":318,"column":2},"end":{"line":318,"column":2}},{"start":{"line":318,"column":2},"end":{"line":318,"column":2}}]},"29":{"line":344,"type":"if","locations":[{"start":{"line":344,"column":8},"end":{"line":344,"column":8}},{"start":{"line":344,"column":8},"end":{"line":344,"column":8}}]},"30":{"line":352,"type":"if","locations":[{"start":{"line":352,"column":4},"end":{"line":352,"column":4}},{"start":{"line":352,"column":4},"end":{"line":352,"column":4}}]},"31":{"line":361,"type":"binary-expr","locations":[{"start":{"line":361,"column":8},"end":{"line":361,"column":16}},{"start":{"line":361,"column":20},"end":{"line":361,"column":22}}]},"32":{"line":367,"type":"if","locations":[{"start":{"line":367,"column":4},"end":{"line":367,"column":4}},{"start":{"line":367,"column":4},"end":{"line":367,"column":4}}]},"33":{"line":376,"type":"if","locations":[{"start":{"line":376,"column":6},"end":{"line":376,"column":6}},{"start":{"line":376,"column":6},"end":{"line":376,"column":6}}]},"34":{"line":402,"type":"if","locations":[{"start":{"line":402,"column":4},"end":{"line":402,"column":4}},{"start":{"line":402,"column":4},"end":{"line":402,"column":4}}]},"35":{"line":402,"type":"binary-expr","locations":[{"start":{"line":402,"column":7},"end":{"line":402,"column":12}},{"start":{"line":402,"column":16},"end":{"line":402,"column":23}},{"start":{"line":402,"column":27},"end":{"line":402,"column":33}}]},"36":{"line":407,"type":"if","locations":[{"start":{"line":407,"column":4},"end":{"line":407,"column":4}},{"start":{"line":407,"column":4},"end":{"line":407,"column":4}}]},"37":{"line":416,"type":"if","locations":[{"start":{"line":416,"column":4},"end":{"line":416,"column":4}},{"start":{"line":416,"column":4},"end":{"line":416,"column":4}}]},"38":{"line":421,"type":"if","locations":[{"start":{"line":421,"column":4},"end":{"line":421,"column":4}},{"start":{"line":421,"column":4},"end":{"line":421,"column":4}}]},"39":{"line":435,"type":"if","locations":[{"start":{"line":435,"column":2},"end":{"line":435,"column":2}},{"start":{"line":435,"column":2},"end":{"line":435,"column":2}}]},"40":{"line":447,"type":"if","locations":[{"start":{"line":447,"column":4},"end":{"line":447,"column":4}},{"start":{"line":447,"column":4},"end":{"line":447,"column":4}}]}},"code":["/**"," * Implementation of server component."," * Init and start server instance."," */","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var fs = require('fs');","var path = require('path');","var pathUtil = require('../util/pathUtil');","var Loader = require('pomelo-loader');","var utils = require('../util/utils');","var schedule = require('pomelo-scheduler');","var events = require('../util/events');","var Constants = require('../util/constants');","var FilterService = require('../common/service/filterService');","var HandlerService = require('../common/service/handlerService');","","var ST_INITED = 0;    // server inited","var ST_STARTED = 1;   // server started","var ST_STOPED = 2;    // server stoped","","/**"," * Server factory function."," *"," * @param {Object} app  current application context"," * @return {Object} erver instance"," */","module.exports.create = function(app, opts) {","  return new Server(app, opts);","};","","var Server = function (app, opts) {","  this.opts = opts || {};","  this.app = app;","  this.globalFilterService = null;","  this.filterService = null;","  this.handlerService = null;","  this.crons = [];","  this.jobs = {};","  this.state = ST_INITED;","","  app.event.on(events.ADD_CRONS, this.addCrons.bind(this));","  app.event.on(events.REMOVE_CRONS, this.removeCrons.bind(this));","};","","var pro = Server.prototype;","","/**"," * Server lifecycle callback"," */","pro.start = function() {","  if(this.state > ST_INITED) {","    return;","  }","","  this.globalFilterService = initFilter(true, this.app);","  this.filterService = initFilter(false, this.app);","  this.handlerService = initHandler(this.app, this.opts);","  this.cronHandlers = loadCronHandlers(this.app);","  loadCrons(this, this.app);","  this.state = ST_STARTED;","};","","pro.afterStart = function() {","  scheduleCrons(this, this.crons);","};","","/**"," * Stop server"," */","pro.stop = function() {","  this.state = ST_STOPED;","};","","/**"," * Global handler."," *"," * @param  {Object} msg request message"," * @param  {Object} session session object"," * @param  {Callback} callback function "," */","pro.globalHandle = function(msg, session, cb) {","  if(this.state !== ST_STARTED) {","    utils.invokeCallback(cb, new Error('server not started'));","    return;","  }","","  var routeRecord = parseRoute(msg.route);","  if(!routeRecord) {","    utils.invokeCallback(cb, new Error('meet unknown route message %j', msg.route));","    return;","  }","","  var self = this;","  var dispatch = function(err, resp, opts) {","    if(err) {","      handleError(true, self, err, msg, session, resp, opts, function(err, resp, opts) {","        response(true, self, err, msg, session, resp, opts, cb);","      });","      return;","    }","","    if(self.app.getServerType() !== routeRecord.serverType) {","      doForward(self.app, msg, session, routeRecord, function(err, resp, opts) {","        response(true, self, err, msg, session, resp, opts, cb);","      });","    } else {","      doHandle(self, msg, session, routeRecord, function(err, resp, opts) {","        response(true, self, err, msg, session, resp, opts, cb);","      });","    }","  };","  beforeFilter(true, self, msg, session, dispatch);","};","","/**"," * Handle request"," */","pro.handle = function(msg, session, cb) {","   if(this.state !== ST_STARTED) {","    cb(new Error('server not started'));","    return;","  }","","  var routeRecord = parseRoute(msg.route);","  doHandle(this, msg, session, routeRecord, cb);","};","","/**"," * Add crons at runtime."," *"," * @param {Array} crons would be added in application"," */","pro.addCrons = function(crons) {","  this.cronHandlers = loadCronHandlers(this.app);","  for(var i=0, l=crons.length; i<l; i++) {","    var cron = crons[i];","    checkAndAdd(cron, this.crons, this);","  }","  scheduleCrons(this, crons);","};","","/**"," * Remove crons at runtime."," *"," * @param {Array} crons would be removed in application"," */","pro.removeCrons = function(crons) {","  for(var i=0, l=crons.length; i<l; i++) {","    var cron = crons[i];","    var id = parseInt(cron.id);","    if(!!this.jobs[id]) {","      schedule.cancelJob(this.jobs[id]);","    } else {","      logger.warn('cron is not in application: %j', cron);","    }","  }","};","","var initFilter = function(isGlobal, app) {","  var service = new FilterService();","  var befores, afters;","","  if(isGlobal) {","    befores = app.get(Constants.KEYWORDS.GLOBAL_BEFORE_FILTER);","    afters = app.get(Constants.KEYWORDS.GLOBAL_AFTER_FILTER);","  } else {","    befores = app.get(Constants.KEYWORDS.BEFORE_FILTER);","    afters = app.get(Constants.KEYWORDS.AFTER_FILTER);","  }","","  var i, l;","  if(befores) {","    for(i=0, l=befores.length; i<l; i++) {","      service.before(befores[i]);","    }","  }","","  if(afters) {","    for(i=0, l=afters.length; i<l; i++) {","      service.after(afters[i]);","    }","  }","","  return service;","};","","var initHandler = function(app, opts) {","  return new HandlerService(app, opts);","};","","/**"," * Load cron handlers from current application"," */","var loadCronHandlers = function(app) {","  var p = pathUtil.getCronPath(app.getBase(), app.getServerType());","  if(p) {","    return Loader.load(p, app);","  }","};","","/**"," * Load crons from configure file"," */","var loadCrons = function(server, app) {","  var env = app.get(Constants.RESERVED.ENV);","  var p = path.join(app.getBase(), Constants.FILEPATH.CRON);","  if(!fs.existsSync(p)) {","    p = path.join(app.getBase(), Constants.FILEPATH.CONFIG_DIR, env, path.basename(Constants.FILEPATH.CRON));","    if (!fs.existsSync(p)) {","      return;","    }","  }","  app.loadConfigBaseApp(Constants.RESERVED.CRONS, Constants.FILEPATH.CRON);","  var crons = app.get(Constants.RESERVED.CRONS);","  for(var serverType in crons) {","    if(app.serverType === serverType) {","      var list = crons[serverType];","      for(var i = 0; i<list.length; i++) {","        if(!list[i].serverId) {","          checkAndAdd(list[i], server.crons, server);","        } else {","          if(app.serverId === list[i].serverId) {","            checkAndAdd(list[i], server.crons, server);","          }","        }","      }","    }","  }","};","","/**"," * Fire before filter chain if any"," */","var beforeFilter = function(isGlobal, server, msg, session, cb) {","  var fm;","  if(isGlobal) {","    fm = server.globalFilterService;","  } else {","    fm = server.filterService;","  }","  if(fm) {","    fm.beforeFilter(msg, session, cb);","  } else {","    utils.invokeCallback(cb);","  }","};","","/**"," * Fire after filter chain if have"," */","var afterFilter = function(isGlobal, server, err, msg, session, resp, opts, cb) {","  var fm;","  if(isGlobal) {","    fm = server.globalFilterService;","  } else {","    fm = server.filterService;","  }","  if(fm) {","    if(isGlobal) {","      fm.afterFilter(err, msg, session, resp, function() {","        // do nothing","      });","    } else {","      fm.afterFilter(err, msg, session, resp, function(err) {","        cb(err, resp, opts);","      });","    }","  }","};","","/**"," * pass err to the global error handler if specified"," */","var handleError = function(isGlobal, server, err, msg, session, resp, opts, cb) {","  var handler;","  if(isGlobal) {","    handler = server.app.get(Constants.RESERVED.GLOBAL_ERROR_HANDLER);","  } else {","    handler = server.app.get(Constants.RESERVED.ERROR_HANDLER);","  }","  if(!handler) {","    logger.debug('no default error handler to resolve unknown exception. ' + err.stack);","    utils.invokeCallback(cb, err, resp, opts);","  } else {","    if(handler.length === 5) {","      handler(err, msg, resp, session, cb);","    } else {","       handler(err, msg, resp, session, opts, cb);     ","    }","  }","};","","/**"," * Send response to client and fire after filter chain if any."," */","","var response = function(isGlobal, server, err, msg, session, resp, opts, cb) {","  if(isGlobal) {","    cb(err, resp, opts);","    // after filter should not interfere response","    afterFilter(isGlobal, server, err, msg, session, resp, opts, cb);","  } else {","    afterFilter(isGlobal, server, err, msg, session, resp, opts, cb);","  }","};","","/**"," * Parse route string."," *"," * @param  {String} route route string, such as: serverName.handlerName.methodName"," * @return {Object}       parse result object or null for illeagle route string"," */","var parseRoute = function(route) {","  if(!route) {","    return null;","  }","  var ts = route.split('.');","  if(ts.length !== 3) {","    return null;","  }","","  return {","    route: route,","    serverType: ts[0],","    handler: ts[1],","    method: ts[2]","  };","};","","var doForward = function(app, msg, session, routeRecord, cb) {","  var finished = false;","  //should route to other servers","  try {","    app.sysrpc[routeRecord.serverType].msgRemote.forwardMessage(","    // app.sysrpc[routeRecord.serverType].msgRemote.forwardMessage2(","      session,","      msg,","      // msg.oldRoute || msg.route,","      // msg.body,","      // msg.aesPassword,","      // msg.compressGzip,","      session.export(),","      function(err, resp, opts) {","        if(err) {","          logger.error('fail to process remote message:' + err.stack);","        }","        finished = true;","        utils.invokeCallback(cb, err, resp, opts);","      }","    );","  } catch(err) {","    if(!finished) {","      logger.error('fail to forward message:' + err.stack);","      utils.invokeCallback(cb, err);","    }","  }","};","","var doHandle = function(server, msg, session, routeRecord, cb) {","  var originMsg = msg;","  msg = msg.body || {};","  msg.__route__ = originMsg.route;","","  var self = server;","","  var handle = function(err, resp, opts) {","    if(err) {","      // error from before filter","      handleError(false, self, err, msg, session, resp, opts, function(err, resp, opts) {","        response(false, self, err, msg, session, resp, opts, cb);","      });","      return;","    }","","    self.handlerService.handle(routeRecord, msg, session, function(err, resp, opts) {","      if(err) {","        //error from handler","        handleError(false, self, err, msg, session, resp, opts, function(err, resp, opts) {","          response(false, self, err, msg, session, resp, opts, cb);","        });","        return;","      }","","      response(false, self, err, msg, session, resp, opts, cb);","    });","  };  //end of handle","","  beforeFilter(false, server, msg, session, handle);","};","","/**"," * Schedule crons"," */","var scheduleCrons = function(server, crons) {","  var handlers = server.cronHandlers;","  for(var i = 0; i<crons.length; i++) {","    var cronInfo = crons[i];","    var time = cronInfo.time;","    var action = cronInfo.action;","    var jobId = cronInfo.id;","","    if(!time || !action || !jobId) {","      logger.error('cron miss necessary parameters: %j', cronInfo);","      continue;","    }","","    if(action.indexOf('.') < 0) {","      logger.error('cron action is error format: %j', cronInfo);","      continue;","    }","    ","    var cron = action.split('.')[0];","    var job = action.split('.')[1];","    var handler = handlers[cron];","    ","    if(!handler) {","      logger.error('could not find cron: %j', cronInfo);","      continue;","    }","      ","    if(typeof handler[job] !== 'function') {","      logger.error('could not find cron job: %j, %s', cronInfo, job);","      continue;","    }","      ","    var id = schedule.scheduleJob(time, handler[job].bind(handler));","    server.jobs[jobId] = id;","  }","};","","/**"," * If cron is not in crons then put it in the array."," */","var checkAndAdd = function(cron, crons, server) {","  if(!containCron(cron.id, crons)) {","    server.crons.push(cron);","  } else {","    logger.warn('cron is duplicated: %j', cron);","  }","};","","/**"," * Check if cron is in crons."," */","var containCron = function(id, crons) {","  for(var i=0, l=crons.length; i<l; i++) {","    if(id === crons[i].id) {","      return true;","    }","  }","  return false;","};",""],"l":{"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"17":1,"18":1,"19":1,"27":1,"28":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"41":0,"42":0,"45":1,"50":1,"51":0,"52":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"63":1,"64":0,"70":1,"71":0,"81":1,"82":0,"83":0,"84":0,"87":0,"88":0,"89":0,"90":0,"93":0,"94":0,"95":0,"96":0,"97":0,"99":0,"102":0,"103":0,"104":0,"107":0,"108":0,"112":0,"118":1,"119":0,"120":0,"121":0,"124":0,"125":0,"133":1,"134":0,"135":0,"136":0,"137":0,"139":0,"147":1,"148":0,"149":0,"150":0,"151":0,"152":0,"154":0,"159":1,"160":0,"161":0,"163":0,"164":0,"165":0,"167":0,"168":0,"171":0,"172":0,"173":0,"174":0,"178":0,"179":0,"180":0,"184":0,"187":1,"188":0,"194":1,"195":0,"196":0,"197":0,"204":1,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"222":0,"223":0,"234":1,"235":0,"236":0,"237":0,"239":0,"241":0,"242":0,"244":0,"251":1,"252":0,"253":0,"254":0,"256":0,"258":0,"259":0,"260":0,"264":0,"265":0,"274":1,"275":0,"276":0,"277":0,"279":0,"281":0,"282":0,"283":0,"285":0,"286":0,"288":0,"297":1,"298":0,"299":0,"301":0,"303":0,"313":1,"314":0,"315":0,"317":0,"318":0,"319":0,"322":0,"330":1,"331":0,"333":0,"334":0,"344":0,"345":0,"347":0,"348":0,"352":0,"353":0,"354":0,"359":1,"360":0,"361":0,"362":0,"364":0,"366":0,"367":0,"369":0,"370":0,"372":0,"375":0,"376":0,"378":0,"379":0,"381":0,"384":0,"388":0,"394":1,"395":0,"396":0,"397":0,"398":0,"399":0,"400":0,"402":0,"403":0,"404":0,"407":0,"408":0,"409":0,"412":0,"413":0,"414":0,"416":0,"417":0,"418":0,"421":0,"422":0,"423":0,"426":0,"427":0,"434":1,"435":0,"436":0,"438":0,"445":1,"446":0,"447":0,"448":0,"451":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/schedule.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/schedule.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":1,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":1,"65":0,"66":1,"67":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"scheduleJob","line":23,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":47}}},"2":{"name":"cancelJob","line":49,"loc":{"start":{"line":49,"column":0},"end":{"line":49,"column":22}}},"3":{"name":"setTimer","line":68,"loc":{"start":{"line":68,"column":0},"end":{"line":68,"column":22}}},"4":{"name":"excuteJob","line":77,"loc":{"start":{"line":77,"column":0},"end":{"line":77,"column":20}}},"5":{"name":"peekNextJob","line":107,"loc":{"start":{"line":107,"column":0},"end":{"line":107,"column":22}}},"6":{"name":"getNextJob","line":125,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":21}}},"7":{"name":"comparator","line":136,"loc":{"start":{"line":136,"column":0},"end":{"line":136,"column":27}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":47}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":30}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":19}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":53}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":13}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":58}},"7":{"start":{"line":13,"column":0},"end":{"line":13,"column":14}},"8":{"start":{"line":14,"column":0},"end":{"line":14,"column":10}},"9":{"start":{"line":18,"column":0},"end":{"line":18,"column":18}},"10":{"start":{"line":23,"column":0},"end":{"line":44,"column":1}},"11":{"start":{"line":24,"column":2},"end":{"line":24,"column":53}},"12":{"start":{"line":25,"column":2},"end":{"line":25,"column":36}},"13":{"start":{"line":26,"column":2},"end":{"line":26,"column":18}},"14":{"start":{"line":28,"column":2},"end":{"line":28,"column":16}},"15":{"start":{"line":29,"column":2},"end":{"line":32,"column":4}},"16":{"start":{"line":34,"column":2},"end":{"line":34,"column":28}},"17":{"start":{"line":35,"column":2},"end":{"line":40,"column":3}},"18":{"start":{"line":36,"column":4},"end":{"line":36,"column":25}},"19":{"start":{"line":37,"column":4},"end":{"line":37,"column":18}},"20":{"start":{"line":39,"column":4},"end":{"line":39,"column":18}},"21":{"start":{"line":42,"column":2},"end":{"line":42,"column":23}},"22":{"start":{"line":43,"column":2},"end":{"line":43,"column":16}},"23":{"start":{"line":49,"column":0},"end":{"line":60,"column":1}},"24":{"start":{"line":50,"column":2},"end":{"line":50,"column":28}},"25":{"start":{"line":51,"column":2},"end":{"line":57,"column":3}},"26":{"start":{"line":52,"column":4},"end":{"line":52,"column":16}},"27":{"start":{"line":53,"column":4},"end":{"line":53,"column":19}},"28":{"start":{"line":55,"column":4},"end":{"line":55,"column":24}},"29":{"start":{"line":56,"column":4},"end":{"line":56,"column":16}},"30":{"start":{"line":58,"column":2},"end":{"line":58,"column":17}},"31":{"start":{"line":59,"column":2},"end":{"line":59,"column":14}},"32":{"start":{"line":68,"column":0},"end":{"line":72,"column":1}},"33":{"start":{"line":69,"column":2},"end":{"line":69,"column":22}},"34":{"start":{"line":71,"column":2},"end":{"line":71,"column":61}},"35":{"start":{"line":77,"column":0},"end":{"line":101,"column":1}},"36":{"start":{"line":78,"column":2},"end":{"line":78,"column":26}},"37":{"start":{"line":79,"column":2},"end":{"line":79,"column":14}},"38":{"start":{"line":81,"column":2},"end":{"line":93,"column":3}},"39":{"start":{"line":82,"column":4},"end":{"line":82,"column":14}},"40":{"start":{"line":83,"column":4},"end":{"line":83,"column":16}},"41":{"start":{"line":85,"column":4},"end":{"line":85,"column":34}},"42":{"start":{"line":87,"column":4},"end":{"line":91,"column":5}},"43":{"start":{"line":88,"column":6},"end":{"line":88,"column":25}},"44":{"start":{"line":90,"column":6},"end":{"line":90,"column":47}},"45":{"start":{"line":92,"column":4},"end":{"line":92,"column":24}},"46":{"start":{"line":96,"column":2},"end":{"line":97,"column":11}},"47":{"start":{"line":97,"column":4},"end":{"line":97,"column":11}},"48":{"start":{"line":100,"column":2},"end":{"line":100,"column":16}},"49":{"start":{"line":107,"column":0},"end":{"line":119,"column":1}},"50":{"start":{"line":108,"column":2},"end":{"line":109,"column":16}},"51":{"start":{"line":109,"column":4},"end":{"line":109,"column":16}},"52":{"start":{"line":111,"column":2},"end":{"line":111,"column":17}},"53":{"start":{"line":113,"column":2},"end":{"line":116,"column":35}},"54":{"start":{"line":114,"column":4},"end":{"line":114,"column":31}},"55":{"start":{"line":115,"column":4},"end":{"line":115,"column":25}},"56":{"start":{"line":115,"column":13},"end":{"line":115,"column":25}},"57":{"start":{"line":118,"column":2},"end":{"line":118,"column":26}},"58":{"start":{"line":125,"column":0},"end":{"line":134,"column":1}},"59":{"start":{"line":126,"column":2},"end":{"line":126,"column":17}},"60":{"start":{"line":128,"column":2},"end":{"line":131,"column":3}},"61":{"start":{"line":129,"column":4},"end":{"line":129,"column":28}},"62":{"start":{"line":130,"column":4},"end":{"line":130,"column":18}},"63":{"start":{"line":133,"column":2},"end":{"line":133,"column":26}},"64":{"start":{"line":136,"column":0},"end":{"line":138,"column":1}},"65":{"start":{"line":137,"column":2},"end":{"line":137,"column":27}},"66":{"start":{"line":140,"column":0},"end":{"line":140,"column":41}},"67":{"start":{"line":141,"column":0},"end":{"line":141,"column":37}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":35,"column":2}},{"start":{"line":35,"column":2},"end":{"line":35,"column":2}}]},"2":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":5},"end":{"line":35,"column":12}},{"start":{"line":35,"column":16},"end":{"line":35,"column":40}}]},"3":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":2},"end":{"line":51,"column":2}},{"start":{"line":51,"column":2},"end":{"line":51,"column":2}}]},"4":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":5},"end":{"line":51,"column":11}},{"start":{"line":51,"column":15},"end":{"line":51,"column":31}}]},"5":{"line":81,"type":"binary-expr","locations":[{"start":{"line":81,"column":8},"end":{"line":81,"column":13}},{"start":{"line":81,"column":17},"end":{"line":81,"column":55}}]},"6":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":4},"end":{"line":87,"column":4}},{"start":{"line":87,"column":4},"end":{"line":87,"column":4}}]},"7":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":2},"end":{"line":96,"column":2}},{"start":{"line":96,"column":2},"end":{"line":96,"column":2}}]},"8":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":108,"column":2}},{"start":{"line":108,"column":2},"end":{"line":108,"column":2}}]},"9":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":4},"end":{"line":115,"column":4}},{"start":{"line":115,"column":4},"end":{"line":115,"column":4}}]},"10":{"line":116,"type":"binary-expr","locations":[{"start":{"line":116,"column":9},"end":{"line":116,"column":13}},{"start":{"line":116,"column":17},"end":{"line":116,"column":33}}]},"11":{"line":118,"type":"cond-expr","locations":[{"start":{"line":118,"column":17},"end":{"line":118,"column":20}},{"start":{"line":118,"column":21},"end":{"line":118,"column":25}}]},"12":{"line":128,"type":"binary-expr","locations":[{"start":{"line":128,"column":8},"end":{"line":128,"column":12}},{"start":{"line":128,"column":16},"end":{"line":128,"column":32}}]},"13":{"line":133,"type":"cond-expr","locations":[{"start":{"line":133,"column":17},"end":{"line":133,"column":20}},{"start":{"line":133,"column":21},"end":{"line":133,"column":25}}]}},"code":["/**"," * The main class and interface of the schedule module"," */","var PriorityQueue = require('./priorityQueue');","var Job = require('./job.js');","var timerCount = 0;","","var logger = require('log4js').getLogger(__filename);","","var map = {};","var queue = PriorityQueue.createPriorityQueue(comparator);","","var jobId = 0;","var timer;","","//The accuracy of the scheduler, it will affect the performance when the schedule tasks are","//crowded together","var accuracy = 10;","","/**"," * Schedule a new Job"," */","function scheduleJob(trigger, jobFunc, jobData){","  var job = Job.createJob(trigger, jobFunc, jobData);","  var excuteTime = job.excuteTime();","  var id = job.id;","","  map[id] = job;","  var element = {","    id : id,","    time : excuteTime","  };","","  var curJob = queue.peek();","  if(!curJob || excuteTime < curJob.time){","    queue.offer(element);","    setTimer(job);","","    return job.id;","  }","","  queue.offer(element);","  return job.id;","}","","/**"," * Cancel Job"," */","function cancelJob(id){","  var curJob = queue.peek();","  if(curJob && id === curJob.id){ // to avoid queue.peek() is null","    queue.pop();","    delete map[id];","","    clearTimeout(timer);","    excuteJob();","  }","  delete map[id];","  return true;","}","","/**"," * Clear last timeout and schedule the next job, it will automaticly run the job that"," * need to run now"," * @param job The job need to schedule"," * @return void"," */","function setTimer(job){","  clearTimeout(timer);","","  timer = setTimeout(excuteJob, job.excuteTime()-Date.now());","}","","/**"," * The function used to ran the schedule job, and setTimeout for next running job"," */","function excuteJob(){","  var job = peekNextJob();","  var nextJob;","","  while(!!job && (job.excuteTime()-Date.now())<accuracy){","    job.run();","    queue.pop();","","    var nextTime = job.nextTime();","","    if(nextTime === null){","      delete map[job.id];","    }else{","      queue.offer({id:job.id, time: nextTime});","    }","    job = peekNextJob();","  }","","  //If all the job have been canceled","  if(!job)","    return;","","  //Run next schedule","  setTimer(job);","}","","/**"," * Return, but not remove the next valid job"," * @return Next valid job"," */","function peekNextJob(){","  if(queue.size() <= 0)","    return null;","","  var job = null;","","  do{","    job = map[queue.peek().id];","    if(!job) queue.pop();","  }while(!job && queue.size() > 0);","","  return (!!job)?job:null;","}","","/**"," * Return and remove the next valid job"," * @return Next valid job"," */","function getNextJob(){","  var job = null;","","  while(!job && queue.size() > 0){","    var id = queue.pop().id;","    job = map[id];","  }","","  return (!!job)?job:null;","}","","function comparator(e1, e2){","  return e1.time > e2.time;","}","","module.exports.scheduleJob = scheduleJob;","module.exports.cancelJob = cancelJob;",""],"l":{"4":1,"5":1,"6":1,"8":1,"10":1,"11":1,"13":1,"14":1,"18":1,"23":1,"24":0,"25":0,"26":0,"28":0,"29":0,"34":0,"35":0,"36":0,"37":0,"39":0,"42":0,"43":0,"49":1,"50":0,"51":0,"52":0,"53":0,"55":0,"56":0,"58":0,"59":0,"68":1,"69":0,"71":0,"77":1,"78":0,"79":0,"81":0,"82":0,"83":0,"85":0,"87":0,"88":0,"90":0,"92":0,"96":0,"97":0,"100":0,"107":1,"108":0,"109":0,"111":0,"113":0,"114":0,"115":0,"118":0,"125":1,"126":0,"128":0,"129":0,"130":0,"133":0,"136":1,"137":0,"140":1,"141":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/priorityQueue.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/priorityQueue.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1,"48":0,"49":0,"50":0,"51":1,"52":0,"53":1,"54":1},"b":{"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0],"7":[0,0],"8":[0,0]},"f":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"fnMap":{"1":{"name":"(anonymous_1)","line":4,"loc":{"start":{"line":4,"column":20},"end":{"line":4,"column":40}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":11},"end":{"line":10,"column":31}}},"3":{"name":"(anonymous_3)","line":21,"loc":{"start":{"line":21,"column":11},"end":{"line":21,"column":21}}},"4":{"name":"(anonymous_4)","line":29,"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":29}}},"5":{"name":"(anonymous_5)","line":54,"loc":{"start":{"line":54,"column":10},"end":{"line":54,"column":20}}},"6":{"name":"(anonymous_6)","line":98,"loc":{"start":{"line":98,"column":11},"end":{"line":98,"column":21}}},"7":{"name":"(anonymous_7)","line":104,"loc":{"start":{"line":104,"column":25},"end":{"line":104,"column":40}}},"8":{"name":"(anonymous_8)","line":108,"loc":{"start":{"line":108,"column":37},"end":{"line":108,"column":57}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":6,"column":1}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":24}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":34}},"4":{"start":{"line":10,"column":0},"end":{"line":15,"column":1}},"5":{"start":{"line":11,"column":2},"end":{"line":11,"column":87}},"6":{"start":{"line":13,"column":2},"end":{"line":13,"column":19}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":20}},"8":{"start":{"line":21,"column":0},"end":{"line":23,"column":2}},"9":{"start":{"line":22,"column":2},"end":{"line":22,"column":23}},"10":{"start":{"line":29,"column":0},"end":{"line":48,"column":2}},"11":{"start":{"line":30,"column":2},"end":{"line":30,"column":26}},"12":{"start":{"line":31,"column":2},"end":{"line":31,"column":33}},"13":{"start":{"line":33,"column":2},"end":{"line":33,"column":35}},"14":{"start":{"line":35,"column":2},"end":{"line":35,"column":28}},"15":{"start":{"line":37,"column":2},"end":{"line":47,"column":3}},"16":{"start":{"line":38,"column":4},"end":{"line":38,"column":51}},"17":{"start":{"line":39,"column":4},"end":{"line":46,"column":5}},"18":{"start":{"line":40,"column":6},"end":{"line":40,"column":36}},"19":{"start":{"line":41,"column":6},"end":{"line":41,"column":33}},"20":{"start":{"line":43,"column":6},"end":{"line":43,"column":22}},"21":{"start":{"line":45,"column":6},"end":{"line":45,"column":12}},"22":{"start":{"line":54,"column":0},"end":{"line":92,"column":2}},"23":{"start":{"line":55,"column":2},"end":{"line":55,"column":26}},"24":{"start":{"line":56,"column":2},"end":{"line":56,"column":33}},"25":{"start":{"line":58,"column":2},"end":{"line":59,"column":16}},"26":{"start":{"line":59,"column":4},"end":{"line":59,"column":16}},"27":{"start":{"line":62,"column":2},"end":{"line":62,"column":26}},"28":{"start":{"line":64,"column":2},"end":{"line":64,"column":38}},"29":{"start":{"line":66,"column":2},"end":{"line":66,"column":14}},"30":{"start":{"line":67,"column":2},"end":{"line":67,"column":23}},"31":{"start":{"line":68,"column":2},"end":{"line":68,"column":23}},"32":{"start":{"line":69,"column":2},"end":{"line":69,"column":20}},"33":{"start":{"line":70,"column":2},"end":{"line":70,"column":18}},"34":{"start":{"line":72,"column":2},"end":{"line":89,"column":3}},"35":{"start":{"line":73,"column":4},"end":{"line":85,"column":5}},"36":{"start":{"line":74,"column":6},"end":{"line":74,"column":32}},"37":{"start":{"line":75,"column":6},"end":{"line":75,"column":26}},"38":{"start":{"line":77,"column":6},"end":{"line":77,"column":18}},"39":{"start":{"line":78,"column":10},"end":{"line":85,"column":5}},"40":{"start":{"line":79,"column":6},"end":{"line":79,"column":31}},"41":{"start":{"line":80,"column":6},"end":{"line":80,"column":25}},"42":{"start":{"line":82,"column":6},"end":{"line":82,"column":17}},"43":{"start":{"line":84,"column":6},"end":{"line":84,"column":12}},"44":{"start":{"line":87,"column":4},"end":{"line":87,"column":21}},"45":{"start":{"line":88,"column":4},"end":{"line":88,"column":21}},"46":{"start":{"line":91,"column":2},"end":{"line":91,"column":18}},"47":{"start":{"line":98,"column":0},"end":{"line":102,"column":1}},"48":{"start":{"line":99,"column":2},"end":{"line":100,"column":16}},"49":{"start":{"line":100,"column":4},"end":{"line":100,"column":16}},"50":{"start":{"line":101,"column":2},"end":{"line":101,"column":24}},"51":{"start":{"line":104,"column":0},"end":{"line":106,"column":1}},"52":{"start":{"line":105,"column":2},"end":{"line":105,"column":15}},"53":{"start":{"line":108,"column":0},"end":{"line":110,"column":1}},"54":{"start":{"line":109,"column":2},"end":{"line":109,"column":39}}},"branchMap":{"1":{"line":11,"type":"cond-expr","locations":[{"start":{"line":11,"column":52},"end":{"line":11,"column":62}},{"start":{"line":11,"column":63},"end":{"line":11,"column":86}}]},"2":{"line":38,"type":"cond-expr","locations":[{"start":{"line":38,"column":32},"end":{"line":38,"column":39}},{"start":{"line":38,"column":41},"end":{"line":38,"column":50}}]},"3":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"4":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":58,"column":2}},{"start":{"line":58,"column":2},"end":{"line":58,"column":2}}]},"5":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":73,"column":4}},{"start":{"line":73,"column":4},"end":{"line":73,"column":4}}]},"6":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":7},"end":{"line":73,"column":26}},{"start":{"line":73,"column":30},"end":{"line":73,"column":64}},{"start":{"line":73,"column":68},"end":{"line":73,"column":101}}]},"7":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":10},"end":{"line":78,"column":10}},{"start":{"line":78,"column":10},"end":{"line":78,"column":10}}]},"8":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":2},"end":{"line":99,"column":2}},{"start":{"line":99,"column":2},"end":{"line":99,"column":2}}]}},"code":["/**"," * The PriorityQeueu class"," */","var PriorityQueue = function(comparator){","  this.init(comparator);","}","","var pro = PriorityQueue.prototype;","","pro.init = function(comparator){","  this._comparator = typeof(comparator)=='function'?comparator:this._defaultComparator;","  ","  this._queue = [];","  this._tailPos = 0;","}","","/**"," * Return the size of the pirority queue"," * @return PirorityQueue size"," */","pro.size = function(){","  return this._tailPos;","};","  ","/**"," * Insert an element to the queue"," * @param element The element to insert"," */","pro.offer = function(element){","  var queue = this._queue;","  var compare = this._comparator;","  ","  queue[this._tailPos++] = element;","  ","  var pos = this._tailPos-1;","  ","  while(pos > 0){","    var parentPos = (pos%2==0)?(pos/2-1):(pos-1)/2;","    if(compare(queue[parentPos], element)){","      queue[pos] = queue[parentPos];","      queue[parentPos] = element;","      ","      pos = parentPos;","    }else{","      break;","    }","  }","};","          ","/**"," * Get and remove the first element in the queue"," * @return The first element"," */        ","pro.pop = function(){","  var queue = this._queue;","  var compare = this._comparator;","  ","  if(this._tailPos == 0)","    return null;","  ","  ","  var headNode = queue[0];","  ","  var tail = queue[this._tailPos - 1];","","  var pos = 0;","  var left = pos*2 + 1;","  var right = left + 1;","  queue[pos] = tail;","  this._tailPos--;","  ","  while(left < this._tailPos){    ","    if(right<this._tailPos && compare(queue[left], queue[right]) && compare(queue[pos], queue[right])){","      queue[pos] = queue[right];","      queue[right] = tail;","      ","      pos = right;","    }else if(compare(queue[pos],queue[left])){","      queue[pos] = queue[left];","      queue[left] = tail;","      ","      pos = left;","    }else{","      break;","    }","    ","    left = pos*2 + 1;","    right = left + 1;","  }","  ","  return headNode;","};","","/**"," * Get but not remove the first element in the queue"," * @return The first element"," */","pro.peek = function(){","  if(this._tailPos == 0)","    return null;","  return this._queue[0];","}","","pro._defaultComparator = function(a , b){","  return a > b;","}","","module.exports.createPriorityQueue = function(comparator){","  return new PriorityQueue(comparator);","}"],"l":{"4":1,"5":1,"8":1,"10":1,"11":1,"13":1,"14":1,"21":1,"22":0,"29":1,"30":0,"31":0,"33":0,"35":0,"37":0,"38":0,"39":0,"40":0,"41":0,"43":0,"45":0,"54":1,"55":0,"56":0,"58":0,"59":0,"62":0,"64":0,"66":0,"67":0,"68":0,"69":0,"70":0,"72":0,"73":0,"74":0,"75":0,"77":0,"78":0,"79":0,"80":0,"82":0,"84":0,"87":0,"88":0,"91":0,"98":1,"99":0,"100":0,"101":0,"104":1,"105":0,"108":1,"109":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/job.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/job.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":1,"34":0,"35":1,"36":0,"37":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":21,"loc":{"start":{"line":21,"column":10},"end":{"line":21,"column":45}}},"2":{"name":"(anonymous_2)","line":42,"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":20}}},"3":{"name":"(anonymous_3)","line":58,"loc":{"start":{"line":58,"column":15},"end":{"line":58,"column":25}}},"4":{"name":"(anonymous_4)","line":62,"loc":{"start":{"line":62,"column":17},"end":{"line":62,"column":27}}},"5":{"name":"createJob","line":73,"loc":{"start":{"line":73,"column":0},"end":{"line":73,"column":45}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":47}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":14}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":19}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":18}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":17}},"7":{"start":{"line":13,"column":0},"end":{"line":13,"column":20}},"8":{"start":{"line":15,"column":0},"end":{"line":15,"column":53}},"9":{"start":{"line":19,"column":0},"end":{"line":19,"column":18}},"10":{"start":{"line":21,"column":0},"end":{"line":35,"column":2}},"11":{"start":{"line":22,"column":2},"end":{"line":22,"column":39}},"12":{"start":{"line":23,"column":2},"end":{"line":23,"column":22}},"13":{"start":{"line":25,"column":2},"end":{"line":31,"column":3}},"14":{"start":{"line":26,"column":4},"end":{"line":26,"column":25}},"15":{"start":{"line":27,"column":4},"end":{"line":27,"column":60}},"16":{"start":{"line":28,"column":8},"end":{"line":31,"column":3}},"17":{"start":{"line":29,"column":4},"end":{"line":29,"column":27}},"18":{"start":{"line":30,"column":4},"end":{"line":30,"column":62}},"19":{"start":{"line":33,"column":2},"end":{"line":33,"column":20}},"20":{"start":{"line":34,"column":2},"end":{"line":34,"column":19}},"21":{"start":{"line":37,"column":0},"end":{"line":37,"column":24}},"22":{"start":{"line":42,"column":0},"end":{"line":53,"column":2}},"23":{"start":{"line":43,"column":2},"end":{"line":52,"column":3}},"24":{"start":{"line":44,"column":4},"end":{"line":44,"column":15}},"25":{"start":{"line":45,"column":4},"end":{"line":45,"column":19}},"26":{"start":{"line":46,"column":4},"end":{"line":46,"column":46}},"27":{"start":{"line":47,"column":4},"end":{"line":48,"column":98}},"28":{"start":{"line":48,"column":6},"end":{"line":48,"column":98}},"29":{"start":{"line":49,"column":4},"end":{"line":49,"column":25}},"30":{"start":{"line":51,"column":4},"end":{"line":51,"column":61}},"31":{"start":{"line":58,"column":0},"end":{"line":60,"column":2}},"32":{"start":{"line":59,"column":2},"end":{"line":59,"column":39}},"33":{"start":{"line":62,"column":0},"end":{"line":64,"column":2}},"34":{"start":{"line":63,"column":4},"end":{"line":63,"column":37}},"35":{"start":{"line":73,"column":0},"end":{"line":75,"column":1}},"36":{"start":{"line":74,"column":2},"end":{"line":74,"column":44}},"37":{"start":{"line":77,"column":0},"end":{"line":77,"column":37}}},"branchMap":{"1":{"line":22,"type":"cond-expr","locations":[{"start":{"line":22,"column":26},"end":{"line":22,"column":33}},{"start":{"line":22,"column":34},"end":{"line":22,"column":38}}]},"2":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":2},"end":{"line":25,"column":2}},{"start":{"line":25,"column":2},"end":{"line":25,"column":2}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":8}},{"start":{"line":28,"column":8},"end":{"line":28,"column":8}}]},"4":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]}},"code":["/**"," * This is the class of the job used in schedule module"," */","var cronTrigger = require('./cronTrigger');","var simpleTrigger = require('./simpleTrigger');","","var jobId = 1;","","var SIMPLE_JOB = 1;","var CRON_JOB  = 2;","var jobCount = 0;","","var warnLimit = 500;","","var logger = require('log4js').getLogger(__filename);","","","//For test","var lateCount = 0;","","var Job = function(trigger, jobFunc, jobData){","  this.data = (!!jobData)?jobData:null;","  this.func = jobFunc;","","  if(typeof(trigger) == 'string'){","    this.type = CRON_JOB;","    this.trigger = cronTrigger.createTrigger(trigger, this);","  }else if(typeof(trigger) == 'object'){","    this.type = SIMPLE_JOB;","    this.trigger = simpleTrigger.createTrigger(trigger, this);","  }","","  this.id = jobId++;","  this.runTime = 0;","};","","var pro = Job.prototype;","","/**"," * Run the job code"," */","pro.run = function(){","  try{","    jobCount++;","    this.runTime++;","    var late = Date.now() - this.excuteTime();","    if(late>warnLimit)","      logger.warn('run Job count ' + jobCount + ' late :' + late + ' lateCount ' + (++lateCount));","    this.func(this.data);","  }catch(e){","    logger.error(\"Job run error for exception ! \" + e.stack);","  }","};","","/**"," * Compute the next excution time"," */","pro.nextTime = function(){","  return this.trigger.nextExcuteTime();","};","","pro.excuteTime = function(){","    return this.trigger.excuteTime();","};","","/**"," * The Interface to create Job"," * @param trigger The trigger to use"," * @param jobFunc The function the job to run"," * @param jobDate The date the job use"," * @return The new instance of the give job or null if fail"," */","function createJob(trigger, jobFunc, jobData){","  return new Job(trigger, jobFunc, jobData);","}","","module.exports.createJob = createJob;"],"l":{"4":1,"5":1,"7":1,"9":1,"10":1,"11":1,"13":1,"15":1,"19":1,"21":1,"22":0,"23":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"33":0,"34":0,"37":1,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"51":0,"58":1,"59":0,"62":1,"63":0,"73":1,"74":0,"77":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/cronTrigger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/cronTrigger.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":1,"14":1,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":1,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":1,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":1,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":1,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":1,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":1,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":1,"191":0,"192":0,"193":1,"194":0,"195":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":19,"loc":{"start":{"line":19,"column":18},"end":{"line":19,"column":40}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":17},"end":{"line":32,"column":27}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":21},"end":{"line":41,"column":35}}},"4":{"name":"nextCronTime","line":159,"loc":{"start":{"line":159,"column":0},"end":{"line":159,"column":38}}},"5":{"name":"timeMatch","line":186,"loc":{"start":{"line":186,"column":0},"end":{"line":186,"column":35}}},"6":{"name":"(anonymous_6)","line":212,"loc":{"start":{"line":212,"column":20},"end":{"line":212,"column":41}}},"7":{"name":"(anonymous_7)","line":238,"loc":{"start":{"line":238,"column":20},"end":{"line":238,"column":43}}},"8":{"name":"(anonymous_8)","line":273,"loc":{"start":{"line":273,"column":11},"end":{"line":273,"column":25}}},"9":{"name":"decodeRangeTime","line":285,"loc":{"start":{"line":285,"column":0},"end":{"line":285,"column":38}}},"10":{"name":"decodePeriodTime","line":303,"loc":{"start":{"line":303,"column":0},"end":{"line":303,"column":45}}},"11":{"name":"checkNum","line":327,"loc":{"start":{"line":327,"column":0},"end":{"line":327,"column":33}}},"12":{"name":"getDomLimit","line":348,"loc":{"start":{"line":348,"column":0},"end":{"line":348,"column":33}}},"13":{"name":"createTrigger","line":359,"loc":{"start":{"line":359,"column":0},"end":{"line":359,"column":36}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":53}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":15}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":12}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":13}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":12}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":14}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":12}},"8":{"start":{"line":13,"column":0},"end":{"line":13,"column":55}},"9":{"start":{"line":19,"column":0},"end":{"line":25,"column":2}},"10":{"start":{"line":20,"column":2},"end":{"line":20,"column":45}},"11":{"start":{"line":22,"column":2},"end":{"line":22,"column":50}},"12":{"start":{"line":24,"column":2},"end":{"line":24,"column":17}},"13":{"start":{"line":27,"column":0},"end":{"line":27,"column":32}},"14":{"start":{"line":32,"column":0},"end":{"line":34,"column":2}},"15":{"start":{"line":33,"column":2},"end":{"line":33,"column":23}},"16":{"start":{"line":41,"column":0},"end":{"line":151,"column":2}},"17":{"start":{"line":43,"column":2},"end":{"line":43,"column":35}},"18":{"start":{"line":44,"column":2},"end":{"line":44,"column":15}},"19":{"start":{"line":46,"column":2},"end":{"line":46,"column":33}},"20":{"start":{"line":47,"column":2},"end":{"line":47,"column":28}},"21":{"start":{"line":48,"column":2},"end":{"line":48,"column":26}},"22":{"start":{"line":50,"column":2},"end":{"line":147,"column":3}},"23":{"start":{"line":51,"column":2},"end":{"line":147,"column":3}},"24":{"start":{"line":52,"column":4},"end":{"line":55,"column":5}},"25":{"start":{"line":53,"column":6},"end":{"line":53,"column":68}},"26":{"start":{"line":54,"column":6},"end":{"line":54,"column":18}},"27":{"start":{"line":56,"column":4},"end":{"line":77,"column":5}},"28":{"start":{"line":57,"column":6},"end":{"line":57,"column":72}},"29":{"start":{"line":59,"column":6},"end":{"line":60,"column":20}},"30":{"start":{"line":60,"column":8},"end":{"line":60,"column":20}},"31":{"start":{"line":62,"column":6},"end":{"line":70,"column":7}},"32":{"start":{"line":63,"column":8},"end":{"line":63,"column":45}},"33":{"start":{"line":64,"column":8},"end":{"line":64,"column":25}},"34":{"start":{"line":65,"column":8},"end":{"line":65,"column":24}},"35":{"start":{"line":66,"column":8},"end":{"line":66,"column":25}},"36":{"start":{"line":67,"column":8},"end":{"line":67,"column":27}},"37":{"start":{"line":68,"column":8},"end":{"line":68,"column":27}},"38":{"start":{"line":69,"column":8},"end":{"line":69,"column":17}},"39":{"start":{"line":72,"column":6},"end":{"line":72,"column":22}},"40":{"start":{"line":73,"column":6},"end":{"line":73,"column":31}},"41":{"start":{"line":74,"column":6},"end":{"line":74,"column":23}},"42":{"start":{"line":75,"column":6},"end":{"line":75,"column":25}},"43":{"start":{"line":76,"column":6},"end":{"line":76,"column":25}},"44":{"start":{"line":79,"column":4},"end":{"line":103,"column":5}},"45":{"start":{"line":80,"column":6},"end":{"line":80,"column":70}},"46":{"start":{"line":82,"column":6},"end":{"line":98,"column":58}},"47":{"start":{"line":83,"column":8},"end":{"line":83,"column":69}},"48":{"start":{"line":84,"column":8},"end":{"line":85,"column":22}},"49":{"start":{"line":85,"column":10},"end":{"line":85,"column":22}},"50":{"start":{"line":88,"column":8},"end":{"line":95,"column":9}},"51":{"start":{"line":89,"column":10},"end":{"line":89,"column":26}},"52":{"start":{"line":90,"column":10},"end":{"line":90,"column":45}},"53":{"start":{"line":91,"column":10},"end":{"line":91,"column":27}},"54":{"start":{"line":92,"column":10},"end":{"line":92,"column":29}},"55":{"start":{"line":93,"column":10},"end":{"line":93,"column":29}},"56":{"start":{"line":94,"column":10},"end":{"line":94,"column":27}},"57":{"start":{"line":97,"column":9},"end":{"line":97,"column":31}},"58":{"start":{"line":100,"column":6},"end":{"line":100,"column":23}},"59":{"start":{"line":101,"column":6},"end":{"line":101,"column":25}},"60":{"start":{"line":102,"column":6},"end":{"line":102,"column":25}},"61":{"start":{"line":105,"column":4},"end":{"line":119,"column":5}},"62":{"start":{"line":106,"column":6},"end":{"line":106,"column":70}},"63":{"start":{"line":108,"column":6},"end":{"line":114,"column":7}},"64":{"start":{"line":109,"column":9},"end":{"line":109,"column":42}},"65":{"start":{"line":110,"column":9},"end":{"line":110,"column":33}},"66":{"start":{"line":111,"column":9},"end":{"line":111,"column":28}},"67":{"start":{"line":112,"column":9},"end":{"line":112,"column":28}},"68":{"start":{"line":113,"column":9},"end":{"line":113,"column":18}},"69":{"start":{"line":116,"column":6},"end":{"line":116,"column":30}},"70":{"start":{"line":117,"column":6},"end":{"line":117,"column":25}},"71":{"start":{"line":118,"column":6},"end":{"line":118,"column":25}},"72":{"start":{"line":121,"column":4},"end":{"line":133,"column":5}},"73":{"start":{"line":122,"column":6},"end":{"line":122,"column":73}},"74":{"start":{"line":124,"column":6},"end":{"line":129,"column":7}},"75":{"start":{"line":125,"column":9},"end":{"line":125,"column":44}},"76":{"start":{"line":126,"column":9},"end":{"line":126,"column":37}},"77":{"start":{"line":127,"column":9},"end":{"line":127,"column":28}},"78":{"start":{"line":128,"column":9},"end":{"line":128,"column":18}},"79":{"start":{"line":131,"column":6},"end":{"line":131,"column":34}},"80":{"start":{"line":132,"column":6},"end":{"line":132,"column":25}},"81":{"start":{"line":135,"column":4},"end":{"line":145,"column":5}},"82":{"start":{"line":136,"column":6},"end":{"line":136,"column":76}},"83":{"start":{"line":138,"column":6},"end":{"line":142,"column":7}},"84":{"start":{"line":139,"column":9},"end":{"line":139,"column":48}},"85":{"start":{"line":140,"column":9},"end":{"line":140,"column":37}},"86":{"start":{"line":141,"column":9},"end":{"line":141,"column":18}},"87":{"start":{"line":144,"column":6},"end":{"line":144,"column":34}},"88":{"start":{"line":146,"column":4},"end":{"line":146,"column":10}},"89":{"start":{"line":149,"column":2},"end":{"line":149,"column":33}},"90":{"start":{"line":150,"column":2},"end":{"line":150,"column":23}},"91":{"start":{"line":159,"column":0},"end":{"line":178,"column":1}},"92":{"start":{"line":160,"column":2},"end":{"line":160,"column":13}},"93":{"start":{"line":162,"column":2},"end":{"line":174,"column":3}},"94":{"start":{"line":163,"column":4},"end":{"line":166,"column":22}},"95":{"start":{"line":164,"column":6},"end":{"line":164,"column":19}},"96":{"start":{"line":166,"column":6},"end":{"line":166,"column":22}},"97":{"start":{"line":167,"column":8},"end":{"line":174,"column":3}},"98":{"start":{"line":168,"column":4},"end":{"line":169,"column":25}},"99":{"start":{"line":169,"column":6},"end":{"line":169,"column":25}},"100":{"start":{"line":171,"column":4},"end":{"line":173,"column":27}},"101":{"start":{"line":172,"column":6},"end":{"line":173,"column":27}},"102":{"start":{"line":173,"column":8},"end":{"line":173,"column":27}},"103":{"start":{"line":176,"column":2},"end":{"line":176,"column":86}},"104":{"start":{"line":177,"column":2},"end":{"line":177,"column":14}},"105":{"start":{"line":186,"column":0},"end":{"line":205,"column":1}},"106":{"start":{"line":187,"column":2},"end":{"line":202,"column":3}},"107":{"start":{"line":188,"column":4},"end":{"line":189,"column":18}},"108":{"start":{"line":189,"column":6},"end":{"line":189,"column":18}},"109":{"start":{"line":190,"column":4},"end":{"line":191,"column":18}},"110":{"start":{"line":191,"column":6},"end":{"line":191,"column":18}},"111":{"start":{"line":192,"column":4},"end":{"line":192,"column":17}},"112":{"start":{"line":193,"column":8},"end":{"line":202,"column":3}},"113":{"start":{"line":194,"column":4},"end":{"line":195,"column":19}},"114":{"start":{"line":195,"column":6},"end":{"line":195,"column":19}},"115":{"start":{"line":197,"column":4},"end":{"line":199,"column":20}},"116":{"start":{"line":198,"column":6},"end":{"line":199,"column":20}},"117":{"start":{"line":199,"column":8},"end":{"line":199,"column":20}},"118":{"start":{"line":201,"column":4},"end":{"line":201,"column":17}},"119":{"start":{"line":204,"column":2},"end":{"line":204,"column":14}},"120":{"start":{"line":212,"column":0},"end":{"line":231,"column":1}},"121":{"start":{"line":213,"column":2},"end":{"line":213,"column":43}},"122":{"start":{"line":215,"column":2},"end":{"line":218,"column":3}},"123":{"start":{"line":216,"column":4},"end":{"line":216,"column":25}},"124":{"start":{"line":217,"column":4},"end":{"line":217,"column":16}},"125":{"start":{"line":220,"column":2},"end":{"line":228,"column":3}},"126":{"start":{"line":221,"column":4},"end":{"line":221,"column":57}},"127":{"start":{"line":223,"column":4},"end":{"line":227,"column":5}},"128":{"start":{"line":224,"column":6},"end":{"line":225,"column":66}},"129":{"start":{"line":226,"column":6},"end":{"line":226,"column":18}},"130":{"start":{"line":230,"column":2},"end":{"line":230,"column":19}},"131":{"start":{"line":238,"column":0},"end":{"line":278,"column":1}},"132":{"start":{"line":239,"column":2},"end":{"line":239,"column":18}},"133":{"start":{"line":240,"column":2},"end":{"line":240,"column":15}},"134":{"start":{"line":242,"column":2},"end":{"line":267,"column":3}},"135":{"start":{"line":243,"column":4},"end":{"line":243,"column":14}},"136":{"start":{"line":244,"column":8},"end":{"line":267,"column":3}},"137":{"start":{"line":245,"column":4},"end":{"line":245,"column":37}},"138":{"start":{"line":246,"column":4},"end":{"line":257,"column":5}},"139":{"start":{"line":247,"column":6},"end":{"line":247,"column":28}},"140":{"start":{"line":248,"column":6},"end":{"line":256,"column":20}},"141":{"start":{"line":249,"column":8},"end":{"line":249,"column":38}},"142":{"start":{"line":250,"column":12},"end":{"line":256,"column":20}},"143":{"start":{"line":251,"column":8},"end":{"line":251,"column":45}},"144":{"start":{"line":252,"column":12},"end":{"line":256,"column":20}},"145":{"start":{"line":253,"column":8},"end":{"line":253,"column":31}},"146":{"start":{"line":254,"column":8},"end":{"line":254,"column":26}},"147":{"start":{"line":256,"column":8},"end":{"line":256,"column":20}},"148":{"start":{"line":258,"column":8},"end":{"line":267,"column":3}},"149":{"start":{"line":259,"column":4},"end":{"line":259,"column":37}},"150":{"start":{"line":260,"column":8},"end":{"line":267,"column":3}},"151":{"start":{"line":261,"column":4},"end":{"line":261,"column":44}},"152":{"start":{"line":262,"column":8},"end":{"line":267,"column":3}},"153":{"start":{"line":263,"column":4},"end":{"line":263,"column":30}},"154":{"start":{"line":264,"column":4},"end":{"line":264,"column":22}},"155":{"start":{"line":266,"column":4},"end":{"line":266,"column":16}},"156":{"start":{"line":269,"column":2},"end":{"line":271,"column":3}},"157":{"start":{"line":270,"column":4},"end":{"line":270,"column":26}},"158":{"start":{"line":273,"column":2},"end":{"line":275,"column":5}},"159":{"start":{"line":274,"column":4},"end":{"line":274,"column":17}},"160":{"start":{"line":277,"column":2},"end":{"line":277,"column":13}},"161":{"start":{"line":285,"column":0},"end":{"line":298,"column":1}},"162":{"start":{"line":286,"column":2},"end":{"line":286,"column":33}},"163":{"start":{"line":288,"column":2},"end":{"line":288,"column":30}},"164":{"start":{"line":289,"column":2},"end":{"line":289,"column":30}},"165":{"start":{"line":290,"column":2},"end":{"line":293,"column":3}},"166":{"start":{"line":291,"column":4},"end":{"line":291,"column":36}},"167":{"start":{"line":292,"column":4},"end":{"line":292,"column":16}},"168":{"start":{"line":295,"column":2},"end":{"line":297,"column":3}},"169":{"start":{"line":296,"column":4},"end":{"line":296,"column":15}},"170":{"start":{"line":303,"column":0},"end":{"line":318,"column":1}},"171":{"start":{"line":304,"column":2},"end":{"line":304,"column":33}},"172":{"start":{"line":305,"column":2},"end":{"line":305,"column":27}},"173":{"start":{"line":306,"column":2},"end":{"line":306,"column":27}},"174":{"start":{"line":308,"column":2},"end":{"line":308,"column":32}},"175":{"start":{"line":309,"column":2},"end":{"line":309,"column":32}},"176":{"start":{"line":311,"column":2},"end":{"line":312,"column":11}},"177":{"start":{"line":312,"column":4},"end":{"line":312,"column":11}},"178":{"start":{"line":314,"column":2},"end":{"line":317,"column":3}},"179":{"start":{"line":315,"column":4},"end":{"line":316,"column":17}},"180":{"start":{"line":316,"column":6},"end":{"line":316,"column":17}},"181":{"start":{"line":327,"column":0},"end":{"line":340,"column":1}},"182":{"start":{"line":328,"column":2},"end":{"line":329,"column":17}},"183":{"start":{"line":329,"column":4},"end":{"line":329,"column":17}},"184":{"start":{"line":331,"column":2},"end":{"line":332,"column":16}},"185":{"start":{"line":332,"column":4},"end":{"line":332,"column":16}},"186":{"start":{"line":334,"column":2},"end":{"line":337,"column":3}},"187":{"start":{"line":335,"column":4},"end":{"line":336,"column":19}},"188":{"start":{"line":336,"column":6},"end":{"line":336,"column":19}},"189":{"start":{"line":339,"column":2},"end":{"line":339,"column":14}},"190":{"start":{"line":348,"column":0},"end":{"line":352,"column":1}},"191":{"start":{"line":349,"column":2},"end":{"line":349,"column":40}},"192":{"start":{"line":351,"column":2},"end":{"line":351,"column":24}},"193":{"start":{"line":359,"column":0},"end":{"line":361,"column":1}},"194":{"start":{"line":360,"column":2},"end":{"line":360,"column":39}},"195":{"start":{"line":363,"column":0},"end":{"line":363,"column":45}}},"branchMap":{"1":{"line":43,"type":"cond-expr","locations":[{"start":{"line":43,"column":16},"end":{"line":43,"column":20}},{"start":{"line":43,"column":21},"end":{"line":43,"column":34}}]},"2":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"3":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":4}},{"start":{"line":56,"column":4},"end":{"line":56,"column":4}}]},"4":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":6},"end":{"line":59,"column":6}},{"start":{"line":59,"column":6},"end":{"line":59,"column":6}}]},"5":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":6},"end":{"line":62,"column":6}},{"start":{"line":62,"column":6},"end":{"line":62,"column":6}}]},"6":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"7":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":7},"end":{"line":79,"column":51}},{"start":{"line":79,"column":55},"end":{"line":79,"column":98}}]},"8":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":8},"end":{"line":84,"column":8}},{"start":{"line":84,"column":8},"end":{"line":84,"column":8}}]},"9":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":8},"end":{"line":88,"column":8}},{"start":{"line":88,"column":8},"end":{"line":88,"column":8}}]},"10":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":11},"end":{"line":88,"column":36}},{"start":{"line":88,"column":40},"end":{"line":88,"column":58}}]},"11":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":4},"end":{"line":105,"column":4}},{"start":{"line":105,"column":4},"end":{"line":105,"column":4}}]},"12":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":6},"end":{"line":108,"column":6}},{"start":{"line":108,"column":6},"end":{"line":108,"column":6}}]},"13":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":4},"end":{"line":121,"column":4}},{"start":{"line":121,"column":4},"end":{"line":121,"column":4}}]},"14":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":6},"end":{"line":124,"column":6}},{"start":{"line":124,"column":6},"end":{"line":124,"column":6}}]},"15":{"line":135,"type":"if","locations":[{"start":{"line":135,"column":4},"end":{"line":135,"column":4}},{"start":{"line":135,"column":4},"end":{"line":135,"column":4}}]},"16":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":6},"end":{"line":138,"column":6}},{"start":{"line":138,"column":6},"end":{"line":138,"column":6}}]},"17":{"line":162,"type":"if","locations":[{"start":{"line":162,"column":2},"end":{"line":162,"column":2}},{"start":{"line":162,"column":2},"end":{"line":162,"column":2}}]},"18":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":4},"end":{"line":163,"column":4}},{"start":{"line":163,"column":4},"end":{"line":163,"column":4}}]},"19":{"line":167,"type":"if","locations":[{"start":{"line":167,"column":8},"end":{"line":167,"column":8}},{"start":{"line":167,"column":8},"end":{"line":167,"column":8}}]},"20":{"line":167,"type":"binary-expr","locations":[{"start":{"line":167,"column":11},"end":{"line":167,"column":39}},{"start":{"line":167,"column":43},"end":{"line":167,"column":68}}]},"21":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":4},"end":{"line":168,"column":4}},{"start":{"line":168,"column":4},"end":{"line":168,"column":4}}]},"22":{"line":168,"type":"binary-expr","locations":[{"start":{"line":168,"column":7},"end":{"line":168,"column":27}},{"start":{"line":168,"column":31},"end":{"line":168,"column":67}}]},"23":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":6},"end":{"line":172,"column":6}},{"start":{"line":172,"column":6},"end":{"line":172,"column":6}}]},"24":{"line":187,"type":"if","locations":[{"start":{"line":187,"column":2},"end":{"line":187,"column":2}},{"start":{"line":187,"column":2},"end":{"line":187,"column":2}}]},"25":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":4},"end":{"line":188,"column":4}},{"start":{"line":188,"column":4},"end":{"line":188,"column":4}}]},"26":{"line":190,"type":"if","locations":[{"start":{"line":190,"column":4},"end":{"line":190,"column":4}},{"start":{"line":190,"column":4},"end":{"line":190,"column":4}}]},"27":{"line":193,"type":"if","locations":[{"start":{"line":193,"column":8},"end":{"line":193,"column":8}},{"start":{"line":193,"column":8},"end":{"line":193,"column":8}}]},"28":{"line":193,"type":"binary-expr","locations":[{"start":{"line":193,"column":11},"end":{"line":193,"column":39}},{"start":{"line":193,"column":43},"end":{"line":193,"column":68}}]},"29":{"line":194,"type":"if","locations":[{"start":{"line":194,"column":4},"end":{"line":194,"column":4}},{"start":{"line":194,"column":4},"end":{"line":194,"column":4}}]},"30":{"line":194,"type":"binary-expr","locations":[{"start":{"line":194,"column":7},"end":{"line":194,"column":26}},{"start":{"line":194,"column":30},"end":{"line":194,"column":66}}]},"31":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":6},"end":{"line":198,"column":6}},{"start":{"line":198,"column":6},"end":{"line":198,"column":6}}]},"32":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":2},"end":{"line":215,"column":2}},{"start":{"line":215,"column":2},"end":{"line":215,"column":2}}]},"33":{"line":223,"type":"if","locations":[{"start":{"line":223,"column":4},"end":{"line":223,"column":4}},{"start":{"line":223,"column":4},"end":{"line":223,"column":4}}]},"34":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":2},"end":{"line":242,"column":2}},{"start":{"line":242,"column":2},"end":{"line":242,"column":2}}]},"35":{"line":244,"type":"if","locations":[{"start":{"line":244,"column":8},"end":{"line":244,"column":8}},{"start":{"line":244,"column":8},"end":{"line":244,"column":8}}]},"36":{"line":248,"type":"if","locations":[{"start":{"line":248,"column":6},"end":{"line":248,"column":6}},{"start":{"line":248,"column":6},"end":{"line":248,"column":6}}]},"37":{"line":250,"type":"if","locations":[{"start":{"line":250,"column":12},"end":{"line":250,"column":12}},{"start":{"line":250,"column":12},"end":{"line":250,"column":12}}]},"38":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":12},"end":{"line":252,"column":12}},{"start":{"line":252,"column":12},"end":{"line":252,"column":12}}]},"39":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8}},{"start":{"line":258,"column":8},"end":{"line":258,"column":8}}]},"40":{"line":260,"type":"if","locations":[{"start":{"line":260,"column":8},"end":{"line":260,"column":8}},{"start":{"line":260,"column":8},"end":{"line":260,"column":8}}]},"41":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":8},"end":{"line":262,"column":8}},{"start":{"line":262,"column":8},"end":{"line":262,"column":8}}]},"42":{"line":290,"type":"if","locations":[{"start":{"line":290,"column":2},"end":{"line":290,"column":2}},{"start":{"line":290,"column":2},"end":{"line":290,"column":2}}]},"43":{"line":311,"type":"if","locations":[{"start":{"line":311,"column":2},"end":{"line":311,"column":2}},{"start":{"line":311,"column":2},"end":{"line":311,"column":2}}]},"44":{"line":315,"type":"if","locations":[{"start":{"line":315,"column":4},"end":{"line":315,"column":4}},{"start":{"line":315,"column":4},"end":{"line":315,"column":4}}]},"45":{"line":328,"type":"if","locations":[{"start":{"line":328,"column":2},"end":{"line":328,"column":2}},{"start":{"line":328,"column":2},"end":{"line":328,"column":2}}]},"46":{"line":331,"type":"if","locations":[{"start":{"line":331,"column":2},"end":{"line":331,"column":2}},{"start":{"line":331,"column":2},"end":{"line":331,"column":2}}]},"47":{"line":335,"type":"if","locations":[{"start":{"line":335,"column":4},"end":{"line":335,"column":4}},{"start":{"line":335,"column":4},"end":{"line":335,"column":4}}]},"48":{"line":335,"type":"binary-expr","locations":[{"start":{"line":335,"column":7},"end":{"line":335,"column":18}},{"start":{"line":335,"column":22},"end":{"line":335,"column":33}}]}},"code":["/**"," * This is the trigger used to decode the cronTimer and calculate the next excution time of the cron Trigger."," */","var logger = require('log4js').getLogger(__filename);","","var SECOND = 0;","var MIN = 1;","var HOUR = 2;","var DOM = 3;","var MONTH = 4;","var DOW = 5;","","var Limit = [[0,59],[0,59],[0,24],[1,31],[0,11],[0,6]];","","/**"," * The constructor of the CronTrigger"," * @param trigger The trigger str used to build the cronTrigger instance"," */","var CronTrigger = function(trigger, job){","  this.trigger = this.decodeTrigger(trigger);","","  this.nextTime = this.nextExcuteTime(Date.now());","","  this.job = job;","};","","var pro = CronTrigger.prototype;","","/**"," * Get the current excuteTime of trigger"," */","pro.excuteTime = function(){","  return this.nextTime;","};","","/**"," * Caculate the next valid cronTime after the given time"," * @param The given time point"," * @return The nearest valid time after the given time point"," */","pro.nextExcuteTime = function(time){","  //add 1s to the time so it must be the next time","  time = !!time?time:this.nextTime;","  time += 1000;","","  var cronTrigger = this.trigger;","  var date = new Date(time);","  date.setMilliseconds(0);","","  outmost:","  while(true){","    if(date.getFullYear() > 2999){","      logger.error(\"Can't compute the next time, exceed the limit\");","      return null;","    }","    if(!timeMatch(date.getMonth(), cronTrigger[MONTH])){","      var nextMonth = nextCronTime(date.getMonth(), cronTrigger[MONTH]);","","      if(nextMonth == null)","        return null;","","      if(nextMonth <= date.getMonth()){","        date.setYear(date.getFullYear() + 1);","        date.setMonth(0);","        date.setDate(1);","        date.setHours(0);","        date.setMinutes(0);","        date.setSeconds(0);","        continue;","      }","      ","      date.setDate(1);","      date.setMonth(nextMonth);","      date.setHours(0);","      date.setMinutes(0);","      date.setSeconds(0);","    }","","    if(!timeMatch(date.getDate(), cronTrigger[DOM]) || !timeMatch(date.getDay(), cronTrigger[DOW])){","      var domLimit = getDomLimit(date.getFullYear(), date.getMonth());","","      do{","        var nextDom = nextCronTime(date.getDate(), cronTrigger[DOM]);","        if(nextDom == null)","          return null;","","        //If the date is in the next month, add month","        if(nextDom <= date.getDate() || nextDom > domLimit){","          date.setDate(1);","          date.setMonth(date.getMonth() + 1);","          date.setHours(0);","          date.setMinutes(0);","          date.setSeconds(0);","          continue outmost;","        }","","         date.setDate(nextDom);","      }while(!timeMatch(date.getDay(), cronTrigger[DOW]));","","      date.setHours(0);","      date.setMinutes(0);","      date.setSeconds(0);","    }","","    if(!timeMatch(date.getHours(), cronTrigger[HOUR])){","      var nextHour = nextCronTime(date.getHours(), cronTrigger[HOUR]);","","      if(nextHour <= date.getHours()){","         date.setDate(date.getDate() + 1);","         date.setHours(nextHour);","         date.setMinutes(0);","         date.setSeconds(0);","         continue;","      }","","      date.setHours(nextHour);","      date.setMinutes(0);","      date.setSeconds(0);","    }","","    if(!timeMatch(date.getMinutes(), cronTrigger[MIN])){","      var nextMinute = nextCronTime(date.getMinutes(), cronTrigger[MIN]);","","      if(nextMinute <= date.getMinutes()){","         date.setHours(date.getHours() + 1);","         date.setMinutes(nextMinute);","         date.setSeconds(0);","         continue;","      }","","      date.setMinutes(nextMinute);","      date.setSeconds(0);","    }","","    if(!timeMatch(date.getSeconds(), cronTrigger[SECOND])){","      var nextSecond = nextCronTime(date.getSeconds(), cronTrigger[SECOND]);","","      if(nextSecond <= date.getSeconds()){","         date.setMinutes(date.getMinutes() + 1);","         date.setSeconds(nextSecond);","         continue;","      }","","      date.setSeconds(nextSecond);","    }","    break;","  }","","  this.nextTime = date.getTime();","  return this.nextTime;","};","","/**"," * return the next match time of the given value"," * @param value The time value"," * @param cronTime The cronTime need to match"," * @return The match value or null if unmatch(it offten means an error occur)."," */","function nextCronTime(value, cronTime){","  value += 1;","","  if(typeof(cronTime) == 'number'){","    if(cronTime == -1)","      return value;","    else","      return cronTime;","  }else if(typeof(cronTime) == 'object' && cronTime instanceof Array){","    if(value <= cronTime[0] || value > cronTime[cronTime.length -1])","      return cronTime[0];","","    for(var i = 0; i < cronTime.length; i++)","      if(value <= cronTime[i])","        return cronTime[i];","  }","","  logger.warn('Compute next Time error! value :' + value + ' cronTime : ' + cronTime);","  return null;","}","","/**"," * Match the given value to the cronTime"," * @param value The given value"," * @param cronTime The cronTime"," * @return The match result"," */","function timeMatch(value, cronTime){","  if(typeof(cronTime) == 'number'){","    if(cronTime == -1)","      return true;","    if(value == cronTime)","      return true;","    return false;","  }else if(typeof(cronTime) == 'object' && cronTime instanceof Array){","    if(value < cronTime[0] || value > cronTime[cronTime.length -1])","      return false;","","    for(var i = 0; i < cronTime.length; i++)","      if(value == cronTime[i])","        return true;","","    return false;","  }","","  return null;","}","","/**"," * Decude the cronTrigger string to arrays"," * @param cronTimeStr The cronTimeStr need to decode, like \"0 12 * * * 3\""," * @return The array to represent the cronTimer"," */","pro.decodeTrigger = function(cronTimeStr){","  var cronTimes = cronTimeStr.split(/\\s+/);","","  if(cronTimes.length != 6){","    console.log('error');","    return null;","  }","","  for(var i = 0; i < cronTimes.length; i++){","    cronTimes[i] = (this.decodeTimeStr(cronTimes[i], i));","","    if(!checkNum(cronTimes[i], Limit[i][0], Limit[i][1])){","      logger.error('Decode crontime error, value exceed limit!' +","        JSON.stringify({cronTime: cronTimes[i], limit:Limit[i]}));","      return null;","    }","  }","","  return cronTimes;","}","","/**"," * Decode the cron Time string"," * @param timeStr The cron time string, like: 1,2 or 1-3"," * @return A sorted array, like [1,2,3]"," */","pro.decodeTimeStr = function(timeStr, type){","  var result = {};","  var arr = [];","","  if(timeStr=='*'){","    return -1;","  }else if(timeStr.search(',')>0){","    var timeArr = timeStr.split(',');","    for(var i = 0; i < timeArr.length; i++){","      var time = timeArr[i];","      if(time.match(/^\\d+-\\d+$/)){","        decodeRangeTime(result, time);","      }else if(time.match(/^\\d+\\/\\d+/)){","        decodePeriodTime(result, time, type);","      }else if(!isNaN(time)){","        var num = Number(time);","        result[num] = num;","      }else","        return null;","    }","  }else if(timeStr.match(/^\\d+-\\d+$/)){","    decodeRangeTime(result, timeStr);","  }else if(timeStr.match(/^\\d+\\/\\d+/)){","    decodePeriodTime(result, timeStr, type);","  }else if(!isNaN(timeStr)){","    var num = Number(timeStr);","    result[num] = num;","  }else{","    return null;","  }","","  for(var key in result){","    arr.push(result[key]);","  }","","  arr.sort(function(a, b){","    return a - b;","  });","","  return arr;","}","","/**"," * Decode time range"," * @param map The decode map"," * @param timeStr The range string, like 2-5"," */","function decodeRangeTime(map, timeStr){","  var times = timeStr.split('-');","","  times[0] = Number(times[0]);","  times[1] = Number(times[1]);","  if(times[0] > times[1]){","    console.log(\"Error time range\");","    return null;","  }","","  for(var i = times[0]; i <= times[1]; i++){","    map[i] = i;","  }","}","","/**"," * Compute the period timer"," */","function decodePeriodTime(map, timeStr, type){","  var times = timeStr.split('/');","  var min = Limit[type][0];","  var max = Limit[type][1];","","  var remind = Number(times[0]);","  var period = Number(times[1]);","","  if(period==0)","    return;","","  for(var i = min; i <= max; i++){","    if(i%period == remind)","      map[i] = i;","  }","}","","/**"," * Check if the numbers are valid"," * @param nums The numbers array need to check"," * @param min Minimus value"," * @param max Maximam value"," * @return If all the numbers are in the data range"," */","function checkNum(nums, min, max){","  if(nums == null)","    return false;","","  if(nums == -1)","    return true;","","  for(var i = 0; i < nums.length; i++){","    if(nums[i]<min || nums[i]>max)","      return false;","  }","","  return true;","}","","/**"," * Get the date limit of given month"," * @param The given year"," * @month The given month"," * @return The date count of given month"," */","function getDomLimit(year, month){","  var date = new Date(year, month+1, 0);","","  return date.getDate();","}","","/**"," * Create cronTrigger"," * @param trigger The Cron Trigger string"," * @return The Cron trigger"," */","function createTrigger(trigger, job){","  return new CronTrigger(trigger, job);","}","","module.exports.createTrigger = createTrigger;",""],"l":{"4":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"13":1,"19":1,"20":0,"22":0,"24":0,"27":1,"32":1,"33":0,"41":1,"43":0,"44":0,"46":0,"47":0,"48":0,"50":0,"51":0,"52":0,"53":0,"54":0,"56":0,"57":0,"59":0,"60":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"72":0,"73":0,"74":0,"75":0,"76":0,"79":0,"80":0,"82":0,"83":0,"84":0,"85":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"97":0,"100":0,"101":0,"102":0,"105":0,"106":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"116":0,"117":0,"118":0,"121":0,"122":0,"124":0,"125":0,"126":0,"127":0,"128":0,"131":0,"132":0,"135":0,"136":0,"138":0,"139":0,"140":0,"141":0,"144":0,"146":0,"149":0,"150":0,"159":1,"160":0,"162":0,"163":0,"164":0,"166":0,"167":0,"168":0,"169":0,"171":0,"172":0,"173":0,"176":0,"177":0,"186":1,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"197":0,"198":0,"199":0,"201":0,"204":0,"212":1,"213":0,"215":0,"216":0,"217":0,"220":0,"221":0,"223":0,"224":0,"226":0,"230":0,"238":1,"239":0,"240":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"256":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"266":0,"269":0,"270":0,"273":0,"274":0,"277":0,"285":1,"286":0,"288":0,"289":0,"290":0,"291":0,"292":0,"295":0,"296":0,"303":1,"304":0,"305":0,"306":0,"308":0,"309":0,"311":0,"312":0,"314":0,"315":0,"316":0,"327":1,"328":0,"329":0,"331":0,"332":0,"334":0,"335":0,"336":0,"339":0,"348":1,"349":0,"351":0,"359":1,"360":0,"363":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/log4js.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/log4js.js","s":{"1":1,"2":1,"3":3,"4":0,"5":3,"6":3,"7":3,"8":3,"9":0,"10":0,"11":0,"12":3,"13":3,"14":3,"15":3,"16":3,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":0,"24":1,"25":1,"26":1,"27":1,"28":0,"29":0,"30":1,"31":1,"32":0,"33":0,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":0,"42":0,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":0,"54":1,"55":1,"56":0,"57":0,"58":0,"59":1,"60":0,"61":1,"62":0,"63":1,"64":1,"65":1,"66":0,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":0,"75":1,"76":0,"77":1,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":1,"85":0,"86":0,"87":0,"88":0,"89":0,"90":1,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":1,"99":1,"100":1,"101":1,"102":1,"103":0,"104":1,"105":0,"106":0,"107":1,"108":1,"109":1,"110":1,"111":0,"112":0,"113":0,"114":0,"115":0,"116":1,"117":1,"118":5,"119":1,"120":1,"121":1,"122":1,"123":0,"124":1,"125":1,"126":1,"127":1},"b":{"1":[0,3],"2":[3,0],"3":[0,3],"4":[3,0],"5":[1,0],"6":[1,1],"7":[0,1],"8":[1,0],"9":[0,0],"10":[0,0],"11":[1,0],"12":[0,0],"13":[1,0],"14":[0,1],"15":[0,0],"16":[0,1],"17":[1,0],"18":[0,1],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[1,1],"24":[1,1],"25":[1,0],"26":[1,0,0],"27":[0,1],"28":[1,1],"29":[0,0],"30":[0,0],"31":[0,0]},"f":{"1":3,"2":0,"3":3,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":1,"15":1,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":1,"25":5,"26":1},"fnMap":{"1":{"name":"getLogger","line":71,"loc":{"start":{"line":71,"column":0},"end":{"line":71,"column":34}}},"2":{"name":"(anonymous_2)","line":84,"loc":{"start":{"line":84,"column":27},"end":{"line":84,"column":46}}},"3":{"name":"(anonymous_3)","line":90,"loc":{"start":{"line":90,"column":27},"end":{"line":90,"column":46}}},"4":{"name":"addAppender","line":102,"loc":{"start":{"line":102,"column":0},"end":{"line":102,"column":24}}},"5":{"name":"(anonymous_5)","line":113,"loc":{"start":{"line":113,"column":15},"end":{"line":113,"column":34}}},"6":{"name":"addAppenderToAllLoggers","line":124,"loc":{"start":{"line":124,"column":0},"end":{"line":124,"column":43}}},"7":{"name":"addAppenderToCategory","line":132,"loc":{"start":{"line":132,"column":0},"end":{"line":132,"column":51}}},"8":{"name":"clearAppenders","line":139,"loc":{"start":{"line":139,"column":0},"end":{"line":139,"column":27}}},"9":{"name":"configureAppenders","line":148,"loc":{"start":{"line":148,"column":0},"end":{"line":148,"column":51}}},"10":{"name":"(anonymous_10)","line":151,"loc":{"start":{"line":151,"column":25},"end":{"line":151,"column":50}}},"11":{"name":"configureLevels","line":165,"loc":{"start":{"line":165,"column":0},"end":{"line":165,"column":33}}},"12":{"name":"setGlobalLogLevel","line":175,"loc":{"start":{"line":175,"column":0},"end":{"line":175,"column":34}}},"13":{"name":"getDefaultLogger","line":184,"loc":{"start":{"line":184,"column":0},"end":{"line":184,"column":29}}},"14":{"name":"loadConfigurationFile","line":190,"loc":{"start":{"line":190,"column":0},"end":{"line":190,"column":41}}},"15":{"name":"configureOnceOff","line":197,"loc":{"start":{"line":197,"column":0},"end":{"line":197,"column":43}}},"16":{"name":"reloadConfiguration","line":217,"loc":{"start":{"line":217,"column":0},"end":{"line":217,"column":31}}},"17":{"name":"getMTime","line":227,"loc":{"start":{"line":227,"column":0},"end":{"line":227,"column":28}}},"18":{"name":"initReloadConfiguration","line":237,"loc":{"start":{"line":237,"column":0},"end":{"line":237,"column":52}}},"19":{"name":"configure","line":247,"loc":{"start":{"line":247,"column":0},"end":{"line":247,"column":55}}},"20":{"name":"replaceConsole","line":275,"loc":{"start":{"line":275,"column":0},"end":{"line":275,"column":32}}},"21":{"name":"replaceWith","line":276,"loc":{"start":{"line":276,"column":2},"end":{"line":276,"column":27}}},"22":{"name":"(anonymous_22)","line":277,"loc":{"start":{"line":277,"column":11},"end":{"line":277,"column":22}}},"23":{"name":"(anonymous_23)","line":282,"loc":{"start":{"line":282,"column":48},"end":{"line":282,"column":64}}},"24":{"name":"restoreConsole","line":287,"loc":{"start":{"line":287,"column":0},"end":{"line":287,"column":26}}},"25":{"name":"(anonymous_25)","line":288,"loc":{"start":{"line":288,"column":52},"end":{"line":288,"column":68}}},"26":{"name":"loadAppender","line":293,"loc":{"start":{"line":293,"column":0},"end":{"line":293,"column":32}}}},"statementMap":{"1":{"start":{"line":46,"column":0},"end":{"line":63,"column":2}},"2":{"start":{"line":71,"column":0},"end":{"line":97,"column":1}},"3":{"start":{"line":74,"column":2},"end":{"line":76,"column":3}},"4":{"start":{"line":75,"column":4},"end":{"line":75,"column":43}},"5":{"start":{"line":78,"column":2},"end":{"line":78,"column":19}},"6":{"start":{"line":79,"column":2},"end":{"line":94,"column":3}},"7":{"start":{"line":81,"column":4},"end":{"line":81,"column":53}},"8":{"start":{"line":82,"column":4},"end":{"line":87,"column":5}},"9":{"start":{"line":83,"column":6},"end":{"line":83,"column":45}},"10":{"start":{"line":84,"column":6},"end":{"line":86,"column":9}},"11":{"start":{"line":85,"column":8},"end":{"line":85,"column":59}},"12":{"start":{"line":88,"column":4},"end":{"line":93,"column":5}},"13":{"start":{"line":89,"column":6},"end":{"line":89,"column":47}},"14":{"start":{"line":90,"column":6},"end":{"line":92,"column":9}},"15":{"start":{"line":91,"column":8},"end":{"line":91,"column":59}},"16":{"start":{"line":96,"column":2},"end":{"line":96,"column":31}},"17":{"start":{"line":102,"column":0},"end":{"line":122,"column":1}},"18":{"start":{"line":103,"column":2},"end":{"line":103,"column":51}},"19":{"start":{"line":104,"column":2},"end":{"line":104,"column":30}},"20":{"start":{"line":105,"column":2},"end":{"line":107,"column":3}},"21":{"start":{"line":106,"column":4},"end":{"line":106,"column":30}},"22":{"start":{"line":109,"column":2},"end":{"line":111,"column":3}},"23":{"start":{"line":110,"column":4},"end":{"line":110,"column":19}},"24":{"start":{"line":113,"column":2},"end":{"line":121,"column":5}},"25":{"start":{"line":114,"column":4},"end":{"line":114,"column":46}},"26":{"start":{"line":116,"column":4},"end":{"line":120,"column":5}},"27":{"start":{"line":117,"column":6},"end":{"line":117,"column":40}},"28":{"start":{"line":118,"column":11},"end":{"line":120,"column":5}},"29":{"start":{"line":119,"column":6},"end":{"line":119,"column":53}},"30":{"start":{"line":124,"column":0},"end":{"line":130,"column":1}},"31":{"start":{"line":125,"column":2},"end":{"line":129,"column":3}},"32":{"start":{"line":126,"column":4},"end":{"line":128,"column":5}},"33":{"start":{"line":127,"column":6},"end":{"line":127,"column":51}},"34":{"start":{"line":132,"column":0},"end":{"line":137,"column":1}},"35":{"start":{"line":133,"column":2},"end":{"line":135,"column":3}},"36":{"start":{"line":134,"column":4},"end":{"line":134,"column":29}},"37":{"start":{"line":136,"column":2},"end":{"line":136,"column":37}},"38":{"start":{"line":139,"column":0},"end":{"line":146,"column":1}},"39":{"start":{"line":140,"column":2},"end":{"line":140,"column":17}},"40":{"start":{"line":141,"column":2},"end":{"line":145,"column":3}},"41":{"start":{"line":142,"column":4},"end":{"line":144,"column":5}},"42":{"start":{"line":143,"column":6},"end":{"line":143,"column":48}},"43":{"start":{"line":148,"column":0},"end":{"line":163,"column":1}},"44":{"start":{"line":149,"column":2},"end":{"line":149,"column":19}},"45":{"start":{"line":150,"column":2},"end":{"line":162,"column":3}},"46":{"start":{"line":151,"column":4},"end":{"line":161,"column":7}},"47":{"start":{"line":152,"column":6},"end":{"line":152,"column":40}},"48":{"start":{"line":153,"column":6},"end":{"line":153,"column":19}},"49":{"start":{"line":154,"column":6},"end":{"line":154,"column":45}},"50":{"start":{"line":155,"column":6},"end":{"line":160,"column":7}},"51":{"start":{"line":156,"column":8},"end":{"line":156,"column":80}},"52":{"start":{"line":157,"column":8},"end":{"line":157,"column":55}},"53":{"start":{"line":159,"column":8},"end":{"line":159,"column":95}},"54":{"start":{"line":165,"column":0},"end":{"line":173,"column":1}},"55":{"start":{"line":166,"column":2},"end":{"line":172,"column":3}},"56":{"start":{"line":167,"column":4},"end":{"line":171,"column":5}},"57":{"start":{"line":168,"column":6},"end":{"line":170,"column":7}},"58":{"start":{"line":169,"column":8},"end":{"line":169,"column":55}},"59":{"start":{"line":175,"column":0},"end":{"line":177,"column":1}},"60":{"start":{"line":176,"column":2},"end":{"line":176,"column":63}},"61":{"start":{"line":184,"column":0},"end":{"line":186,"column":1}},"62":{"start":{"line":185,"column":2},"end":{"line":185,"column":44}},"63":{"start":{"line":188,"column":0},"end":{"line":188,"column":21}},"64":{"start":{"line":190,"column":0},"end":{"line":195,"column":1}},"65":{"start":{"line":191,"column":2},"end":{"line":193,"column":3}},"66":{"start":{"line":192,"column":4},"end":{"line":192,"column":57}},"67":{"start":{"line":194,"column":2},"end":{"line":194,"column":19}},"68":{"start":{"line":197,"column":0},"end":{"line":215,"column":1}},"69":{"start":{"line":198,"column":2},"end":{"line":214,"column":3}},"70":{"start":{"line":199,"column":4},"end":{"line":213,"column":5}},"71":{"start":{"line":200,"column":6},"end":{"line":200,"column":52}},"72":{"start":{"line":201,"column":6},"end":{"line":201,"column":37}},"73":{"start":{"line":203,"column":6},"end":{"line":207,"column":7}},"74":{"start":{"line":204,"column":8},"end":{"line":204,"column":25}},"75":{"start":{"line":206,"column":8},"end":{"line":206,"column":25}},"76":{"start":{"line":209,"column":6},"end":{"line":212,"column":8}},"77":{"start":{"line":217,"column":0},"end":{"line":225,"column":1}},"78":{"start":{"line":218,"column":2},"end":{"line":218,"column":45}},"79":{"start":{"line":219,"column":2},"end":{"line":219,"column":21}},"80":{"start":{"line":219,"column":14},"end":{"line":219,"column":21}},"81":{"start":{"line":221,"column":2},"end":{"line":223,"column":3}},"82":{"start":{"line":222,"column":4},"end":{"line":222,"column":66}},"83":{"start":{"line":224,"column":2},"end":{"line":224,"column":32}},"84":{"start":{"line":227,"column":0},"end":{"line":235,"column":1}},"85":{"start":{"line":228,"column":2},"end":{"line":228,"column":12}},"86":{"start":{"line":229,"column":2},"end":{"line":233,"column":3}},"87":{"start":{"line":230,"column":4},"end":{"line":230,"column":52}},"88":{"start":{"line":232,"column":4},"end":{"line":232,"column":78}},"89":{"start":{"line":234,"column":2},"end":{"line":234,"column":15}},"90":{"start":{"line":237,"column":0},"end":{"line":245,"column":1}},"91":{"start":{"line":238,"column":2},"end":{"line":241,"column":3}},"92":{"start":{"line":239,"column":4},"end":{"line":239,"column":39}},"93":{"start":{"line":240,"column":4},"end":{"line":240,"column":31}},"94":{"start":{"line":242,"column":2},"end":{"line":242,"column":34}},"95":{"start":{"line":243,"column":2},"end":{"line":243,"column":45}},"96":{"start":{"line":244,"column":2},"end":{"line":244,"column":82}},"97":{"start":{"line":247,"column":0},"end":{"line":265,"column":1}},"98":{"start":{"line":248,"column":2},"end":{"line":248,"column":41}},"99":{"start":{"line":249,"column":2},"end":{"line":249,"column":47}},"100":{"start":{"line":250,"column":2},"end":{"line":250,"column":26}},"101":{"start":{"line":252,"column":2},"end":{"line":263,"column":3}},"102":{"start":{"line":253,"column":4},"end":{"line":255,"column":5}},"103":{"start":{"line":254,"column":6},"end":{"line":254,"column":47}},"104":{"start":{"line":256,"column":4},"end":{"line":256,"column":60}},"105":{"start":{"line":258,"column":4},"end":{"line":262,"column":5}},"106":{"start":{"line":259,"column":6},"end":{"line":261,"column":8}},"107":{"start":{"line":264,"column":2},"end":{"line":264,"column":36}},"108":{"start":{"line":267,"column":0},"end":{"line":273,"column":2}},"109":{"start":{"line":275,"column":0},"end":{"line":285,"column":1}},"110":{"start":{"line":276,"column":2},"end":{"line":280,"column":3}},"111":{"start":{"line":277,"column":4},"end":{"line":279,"column":6}},"112":{"start":{"line":278,"column":6},"end":{"line":278,"column":34}},"113":{"start":{"line":281,"column":2},"end":{"line":281,"column":42}},"114":{"start":{"line":282,"column":2},"end":{"line":284,"column":5}},"115":{"start":{"line":283,"column":4},"end":{"line":283,"column":77}},"116":{"start":{"line":287,"column":0},"end":{"line":291,"column":1}},"117":{"start":{"line":288,"column":2},"end":{"line":290,"column":5}},"118":{"start":{"line":289,"column":4},"end":{"line":289,"column":51}},"119":{"start":{"line":293,"column":0},"end":{"line":302,"column":1}},"120":{"start":{"line":294,"column":2},"end":{"line":294,"column":21}},"121":{"start":{"line":295,"column":2},"end":{"line":299,"column":3}},"122":{"start":{"line":296,"column":4},"end":{"line":296,"column":56}},"123":{"start":{"line":298,"column":4},"end":{"line":298,"column":39}},"124":{"start":{"line":300,"column":2},"end":{"line":300,"column":84}},"125":{"start":{"line":301,"column":2},"end":{"line":301,"column":75}},"126":{"start":{"line":304,"column":0},"end":{"line":323,"column":2}},"127":{"start":{"line":326,"column":0},"end":{"line":326,"column":12}}},"branchMap":{"1":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":2},"end":{"line":74,"column":2}},{"start":{"line":74,"column":2},"end":{"line":74,"column":2}}]},"2":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":2},"end":{"line":79,"column":2}},{"start":{"line":79,"column":2},"end":{"line":79,"column":2}}]},"3":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":4},"end":{"line":82,"column":4}},{"start":{"line":82,"column":4},"end":{"line":82,"column":4}}]},"4":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"5":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"6":{"line":105,"type":"binary-expr","locations":[{"start":{"line":105,"column":6},"end":{"line":105,"column":23}},{"start":{"line":105,"column":27},"end":{"line":105,"column":48}}]},"7":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":2},"end":{"line":109,"column":2}},{"start":{"line":109,"column":2},"end":{"line":109,"column":2}}]},"8":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":4},"end":{"line":116,"column":4}},{"start":{"line":116,"column":4},"end":{"line":116,"column":4}}]},"9":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":11},"end":{"line":118,"column":11}},{"start":{"line":118,"column":11},"end":{"line":118,"column":11}}]},"10":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":4},"end":{"line":126,"column":4}},{"start":{"line":126,"column":4},"end":{"line":126,"column":4}}]},"11":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":2},"end":{"line":133,"column":2}},{"start":{"line":133,"column":2},"end":{"line":133,"column":2}}]},"12":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":4},"end":{"line":142,"column":4}},{"start":{"line":142,"column":4},"end":{"line":142,"column":4}}]},"13":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":2},"end":{"line":150,"column":2}},{"start":{"line":150,"column":2},"end":{"line":150,"column":2}}]},"14":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":2},"end":{"line":166,"column":2}},{"start":{"line":166,"column":2},"end":{"line":166,"column":2}}]},"15":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":6},"end":{"line":168,"column":6}},{"start":{"line":168,"column":6},"end":{"line":168,"column":6}}]},"16":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":2},"end":{"line":191,"column":2}},{"start":{"line":191,"column":2},"end":{"line":191,"column":2}}]},"17":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":2},"end":{"line":198,"column":2}},{"start":{"line":198,"column":2},"end":{"line":198,"column":2}}]},"18":{"line":203,"type":"if","locations":[{"start":{"line":203,"column":6},"end":{"line":203,"column":6}},{"start":{"line":203,"column":6},"end":{"line":203,"column":6}}]},"19":{"line":219,"type":"if","locations":[{"start":{"line":219,"column":2},"end":{"line":219,"column":2}},{"start":{"line":219,"column":2},"end":{"line":219,"column":2}}]},"20":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":2},"end":{"line":221,"column":2}},{"start":{"line":221,"column":2},"end":{"line":221,"column":2}}]},"21":{"line":221,"type":"binary-expr","locations":[{"start":{"line":221,"column":6},"end":{"line":221,"column":27}},{"start":{"line":221,"column":32},"end":{"line":221,"column":81}}]},"22":{"line":238,"type":"if","locations":[{"start":{"line":238,"column":2},"end":{"line":238,"column":2}},{"start":{"line":238,"column":2},"end":{"line":238,"column":2}}]},"23":{"line":249,"type":"binary-expr","locations":[{"start":{"line":249,"column":11},"end":{"line":249,"column":17}},{"start":{"line":249,"column":21},"end":{"line":249,"column":46}}]},"24":{"line":250,"type":"binary-expr","locations":[{"start":{"line":250,"column":12},"end":{"line":250,"column":19}},{"start":{"line":250,"column":23},"end":{"line":250,"column":25}}]},"25":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":2},"end":{"line":252,"column":2}},{"start":{"line":252,"column":2},"end":{"line":252,"column":2}}]},"26":{"line":252,"type":"binary-expr","locations":[{"start":{"line":252,"column":6},"end":{"line":252,"column":26}},{"start":{"line":252,"column":30},"end":{"line":252,"column":45}},{"start":{"line":252,"column":49},"end":{"line":252,"column":76}}]},"27":{"line":253,"type":"if","locations":[{"start":{"line":253,"column":4},"end":{"line":253,"column":4}},{"start":{"line":253,"column":4},"end":{"line":253,"column":4}}]},"28":{"line":256,"type":"binary-expr","locations":[{"start":{"line":256,"column":13},"end":{"line":256,"column":42}},{"start":{"line":256,"column":46},"end":{"line":256,"column":59}}]},"29":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":4},"end":{"line":258,"column":4}},{"start":{"line":258,"column":4},"end":{"line":258,"column":4}}]},"30":{"line":281,"type":"binary-expr","locations":[{"start":{"line":281,"column":11},"end":{"line":281,"column":17}},{"start":{"line":281,"column":21},"end":{"line":281,"column":41}}]},"31":{"line":283,"type":"cond-expr","locations":[{"start":{"line":283,"column":49},"end":{"line":283,"column":60}},{"start":{"line":283,"column":63},"end":{"line":283,"column":75}}]}},"code":["\"use strict\";","/*"," * Licensed under the Apache License, Version 2.0 (the \"License\");"," * you may not use this file except in compliance with the License."," * You may obtain a copy of the License at"," *"," *      http://www.apache.org/licenses/LICENSE-2.0"," *"," * Unless required by applicable law or agreed to in writing, software"," * distributed under the License is distributed on an \"AS IS\" BASIS,"," * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."," * See the License for the specific language governing permissions and"," * limitations under the License."," */","","/**"," * @fileoverview log4js is a library to log in JavaScript in similar manner"," * than in log4j for Java. The API should be nearly the same."," *"," * <h3>Example:</h3>"," * <pre>"," *  var logging = require('log4js');"," *  //add an appender that logs all messages to stdout."," *  logging.addAppender(logging.consoleAppender());"," *  //add an appender that logs \"some-category\" to a file"," *  logging.addAppender(logging.fileAppender(\"file.log\"), \"some-category\");"," *  //get a logger"," *  var log = logging.getLogger(\"some-category\");"," *  log.setLevel(logging.levels.TRACE); //set the Level"," *"," *  ..."," *"," *  //call the log"," *  log.trace(\"trace me\" );"," * </pre>"," *"," * NOTE: the authors below are the original browser-based log4js authors"," * don't try to contact them about bugs in this version :)"," * @version 1.0"," * @author Stephan Strittmatter - http://jroller.com/page/stritti"," * @author Seth Chisamore - http://www.chisamore.com"," * @since 2005-05-20"," * @static"," * Website: http://log4js.berlios.de"," */","var events = require('events')",", fs = require('fs')",", path = require('path')",", util = require('util')",", layouts = require('./layouts')",", levels = require('./levels')",", LoggingEvent = require('./logger').LoggingEvent",", Logger = require('./logger').Logger",", ALL_CATEGORIES = '[all]'",", appenders = {}",", loggers = {}",", appenderMakers = {}",", defaultConfig =   {","  appenders: [","    { type: \"console\" }","  ],","  replaceConsole: false","};","","/**"," * Get a logger instance. Instance is cached on categoryName level."," * @param  {String} categoryName name of category to log to."," * @return {Logger} instance of logger for the category"," * @static"," */","function getLogger (categoryName) {","","  // Use default logger if categoryName is not specified or invalid","  if (typeof categoryName !== \"string\") {","    categoryName = Logger.DEFAULT_CATEGORY;","  }","","  var appenderList;","  if (!loggers[categoryName]) {","    // Create the logger for this name if it doesn't already exist","    loggers[categoryName] = new Logger(categoryName);","    if (appenders[categoryName]) {","      appenderList = appenders[categoryName];","      appenderList.forEach(function(appender) {","        loggers[categoryName].addListener(\"log\", appender);","      });","    }","    if (appenders[ALL_CATEGORIES]) {","      appenderList = appenders[ALL_CATEGORIES];","      appenderList.forEach(function(appender) {","        loggers[categoryName].addListener(\"log\", appender);","      });","    }","  }","  ","  return loggers[categoryName];","}","","/**"," * args are appender, then zero or more categories"," */","function addAppender () {","  var args = Array.prototype.slice.call(arguments);","  var appender = args.shift();","  if (args.length === 0 || args[0] === undefined) {","    args = [ ALL_CATEGORIES ];","  }","  //argument may already be an array","  if (Array.isArray(args[0])) {","    args = args[0];","  }","  ","  args.forEach(function(category) {","    addAppenderToCategory(appender, category);","    ","    if (category === ALL_CATEGORIES) {","      addAppenderToAllLoggers(appender);","    } else if (loggers[category]) {","      loggers[category].addListener(\"log\", appender);","    }","  });","}","","function addAppenderToAllLoggers(appender) {","  for (var logger in loggers) {","    if (loggers.hasOwnProperty(logger)) {","      loggers[logger].addListener(\"log\", appender);","    }","  }","}","","function addAppenderToCategory(appender, category) {","  if (!appenders[category]) {","    appenders[category] = [];","  }","  appenders[category].push(appender);","}","","function clearAppenders () {","  appenders = {};","  for (var logger in loggers) {","    if (loggers.hasOwnProperty(logger)) {","      loggers[logger].removeAllListeners(\"log\");","    }","  }","}","","function configureAppenders(appenderList, options) {","  clearAppenders();","  if (appenderList) {","    appenderList.forEach(function(appenderConfig) {","      loadAppender(appenderConfig.type);","      var appender;","      appenderConfig.makers = appenderMakers;","      try {","        appender = appenderMakers[appenderConfig.type](appenderConfig, options);","        addAppender(appender, appenderConfig.category);","      } catch(e) {","        throw new Error(\"log4js configuration problem for \" + util.inspect(appenderConfig), e);","      }","    });","  }","}","","function configureLevels(levels) {","  if (levels) {","    for (var category in levels) {","      if (levels.hasOwnProperty(category)) {","        getLogger(category).setLevel(levels[category]);","      }","    }","  }","}","","function setGlobalLogLevel(level) {","  Logger.prototype.level = levels.toLevel(level, levels.TRACE);","}","","/**"," * Get the default logger instance."," * @return {Logger} instance of default logger"," * @static"," */","function getDefaultLogger () {","  return getLogger(Logger.DEFAULT_CATEGORY);","}","","var configState = {};","","function loadConfigurationFile(filename) {","  if (filename) {","    return JSON.parse(fs.readFileSync(filename, \"utf8\"));","  }","  return undefined;","}","","function configureOnceOff(config, options) {","  if (config) {","    try {","      configureAppenders(config.appenders, options);","      configureLevels(config.levels);","      ","      if (config.replaceConsole) {","        replaceConsole();","      } else {","        restoreConsole();","      }","    } catch (e) {","      throw new Error(","        \"Problem reading log4js config \" + util.inspect(config) + ","          \". Error was \\\"\" + e.message + \"\\\" (\" + e.stack + \")\"","      );","    }","  }","}","","function reloadConfiguration() {","  var mtime = getMTime(configState.filename);","  if (!mtime) return;","","  if (configState.lastMTime && (mtime.getTime() > configState.lastMTime.getTime())) {","    configureOnceOff(loadConfigurationFile(configState.filename));","  }","  configState.lastMTime = mtime;","}","","function getMTime(filename) {","  var mtime;","  try {","    mtime = fs.statSync(configState.filename).mtime;","  } catch (e) {","    getLogger('log4js').warn('Failed to load configuration file ' + filename);","  }","  return mtime;","}","","function initReloadConfiguration(filename, options) {","  if (configState.timerId) {","    clearInterval(configState.timerId);","    delete configState.timerId;","  }","  configState.filename = filename;","  configState.lastMTime = getMTime(filename);","  configState.timerId = setInterval(reloadConfiguration, options.reloadSecs*1000);","}","","function configure(configurationFileOrObject, options) {","  var config = configurationFileOrObject;","  config = config || process.env.LOG4JS_CONFIG;","  options = options || {};","  ","  if (config === undefined || config === null || typeof(config) === 'string') {","    if (options.reloadSecs) {","      initReloadConfiguration(config, options);","    }","    config = loadConfigurationFile(config) || defaultConfig;","  } else {","    if (options.reloadSecs) {","      getLogger('log4js').warn(","        'Ignoring configuration reload parameter for \"object\" configuration.'","      );","    }","  }","  configureOnceOff(config, options);","}","","var originalConsoleFunctions = {","  log: console.log,","  debug: console.debug,","  info: console.info,","  warn: console.warn,","  error: console.error","};","","function replaceConsole(logger) {","  function replaceWith(fn) {","    return function() {","      fn.apply(logger, arguments);","    };","  }","  logger = logger || getLogger(\"console\");","  ['log','debug','info','warn','error'].forEach(function (item) {","    console[item] = replaceWith(item === 'log' ? logger.info : logger[item]);","  });","}","","function restoreConsole() {","  ['log', 'debug', 'info', 'warn', 'error'].forEach(function (item) {","    console[item] = originalConsoleFunctions[item];","  });","}","","function loadAppender(appender) {","  var appenderModule;","  try {","    appenderModule = require('./appenders/' + appender);","  } catch (e) {","    appenderModule = require(appender);","  }","  module.exports.appenders[appender] = appenderModule.appender.bind(appenderModule);","  appenderMakers[appender] = appenderModule.configure.bind(appenderModule);","}","","module.exports = {","  getLogger: getLogger,","  getDefaultLogger: getDefaultLogger,","  ","  addAppender: addAppender,","  loadAppender: loadAppender,","  clearAppenders: clearAppenders,","  configure: configure,","  ","  replaceConsole: replaceConsole,","  restoreConsole: restoreConsole,","  ","  levels: levels,","  setGlobalLogLevel: setGlobalLogLevel,","  ","  layouts: layouts,","  appenders: {},","  appenderMakers: appenderMakers,","  connectLogger: require('./connect-logger').connectLogger","};","","//set ourselves up","configure();","",""],"l":{"46":1,"71":1,"74":3,"75":0,"78":3,"79":3,"81":3,"82":3,"83":0,"84":0,"85":0,"88":3,"89":3,"90":3,"91":3,"96":3,"102":1,"103":1,"104":1,"105":1,"106":1,"109":1,"110":0,"113":1,"114":1,"116":1,"117":1,"118":0,"119":0,"124":1,"125":1,"126":0,"127":0,"132":1,"133":1,"134":1,"136":1,"139":1,"140":1,"141":1,"142":0,"143":0,"148":1,"149":1,"150":1,"151":1,"152":1,"153":1,"154":1,"155":1,"156":1,"157":1,"159":0,"165":1,"166":1,"167":0,"168":0,"169":0,"175":1,"176":0,"184":1,"185":0,"188":1,"190":1,"191":1,"192":0,"194":1,"197":1,"198":1,"199":1,"200":1,"201":1,"203":1,"204":0,"206":1,"209":0,"217":1,"218":0,"219":0,"221":0,"222":0,"224":0,"227":1,"228":0,"229":0,"230":0,"232":0,"234":0,"237":1,"238":0,"239":0,"240":0,"242":0,"243":0,"244":0,"247":1,"248":1,"249":1,"250":1,"252":1,"253":1,"254":0,"256":1,"258":0,"259":0,"264":1,"267":1,"275":1,"276":1,"277":0,"278":0,"281":0,"282":0,"283":0,"287":1,"288":1,"289":5,"293":1,"294":1,"295":1,"296":1,"298":0,"300":1,"301":1,"304":1,"326":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/layouts.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/layouts.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":1,"17":1,"18":0,"19":1,"20":0,"21":1,"22":0,"23":1,"24":0,"25":0,"26":1,"27":0,"28":1,"29":0,"30":1,"31":0,"32":1,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":1,"56":0,"57":1,"58":0,"59":1,"60":0,"61":1,"62":0,"63":1,"64":0,"65":1,"66":0,"67":1,"68":0,"69":1,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":1,"77":0,"78":1,"79":0,"80":0,"81":0,"82":0,"83":0,"84":1,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":1,"115":0},"b":{"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":24},"end":{"line":8,"column":35}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":11},"end":{"line":9,"column":22}}},"3":{"name":"(anonymous_3)","line":10,"loc":{"start":{"line":10,"column":13},"end":{"line":10,"column":24}}},"4":{"name":"(anonymous_4)","line":11,"loc":{"start":{"line":11,"column":14},"end":{"line":11,"column":25}}},"5":{"name":"(anonymous_5)","line":12,"loc":{"start":{"line":12,"column":13},"end":{"line":12,"column":31}}},"6":{"name":"wrapErrorsWithInspect","line":27,"loc":{"start":{"line":27,"column":0},"end":{"line":27,"column":38}}},"7":{"name":"(anonymous_7)","line":28,"loc":{"start":{"line":28,"column":19},"end":{"line":28,"column":34}}},"8":{"name":"(anonymous_8)","line":30,"loc":{"start":{"line":30,"column":24},"end":{"line":30,"column":35}}},"9":{"name":"formatLogData","line":37,"loc":{"start":{"line":37,"column":0},"end":{"line":37,"column":32}}},"10":{"name":"colorizeStart","line":61,"loc":{"start":{"line":61,"column":0},"end":{"line":61,"column":30}}},"11":{"name":"colorizeEnd","line":64,"loc":{"start":{"line":64,"column":0},"end":{"line":64,"column":28}}},"12":{"name":"colorize","line":70,"loc":{"start":{"line":70,"column":0},"end":{"line":70,"column":31}}},"13":{"name":"timestampLevelAndCategory","line":74,"loc":{"start":{"line":74,"column":0},"end":{"line":74,"column":57}}},"14":{"name":"basicLayout","line":96,"loc":{"start":{"line":96,"column":0},"end":{"line":96,"column":36}}},"15":{"name":"colouredLayout","line":104,"loc":{"start":{"line":104,"column":0},"end":{"line":104,"column":39}}},"16":{"name":"messagePassThroughLayout","line":111,"loc":{"start":{"line":111,"column":0},"end":{"line":111,"column":49}}},"17":{"name":"patternLayout","line":144,"loc":{"start":{"line":144,"column":0},"end":{"line":144,"column":41}}},"18":{"name":"categoryName","line":150,"loc":{"start":{"line":150,"column":2},"end":{"line":150,"column":49}}},"19":{"name":"formatAsDate","line":162,"loc":{"start":{"line":162,"column":2},"end":{"line":162,"column":49}}},"20":{"name":"formatMessage","line":179,"loc":{"start":{"line":179,"column":2},"end":{"line":179,"column":39}}},"21":{"name":"endOfLine","line":183,"loc":{"start":{"line":183,"column":2},"end":{"line":183,"column":23}}},"22":{"name":"logLevel","line":187,"loc":{"start":{"line":187,"column":2},"end":{"line":187,"column":34}}},"23":{"name":"startTime","line":191,"loc":{"start":{"line":191,"column":2},"end":{"line":191,"column":35}}},"24":{"name":"startColour","line":195,"loc":{"start":{"line":195,"column":2},"end":{"line":195,"column":37}}},"25":{"name":"endColour","line":199,"loc":{"start":{"line":199,"column":2},"end":{"line":199,"column":35}}},"26":{"name":"percent","line":203,"loc":{"start":{"line":203,"column":2},"end":{"line":203,"column":21}}},"27":{"name":"userDefined","line":207,"loc":{"start":{"line":207,"column":2},"end":{"line":207,"column":48}}},"28":{"name":"replaceToken","line":231,"loc":{"start":{"line":231,"column":2},"end":{"line":231,"column":70}}},"29":{"name":"truncate","line":235,"loc":{"start":{"line":235,"column":2},"end":{"line":235,"column":44}}},"30":{"name":"pad","line":245,"loc":{"start":{"line":245,"column":2},"end":{"line":245,"column":31}}},"31":{"name":"(anonymous_31)","line":265,"loc":{"start":{"line":265,"column":9},"end":{"line":265,"column":32}}},"32":{"name":"(anonymous_32)","line":307,"loc":{"start":{"line":307,"column":10},"end":{"line":307,"column":33}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":25,"column":2}},"2":{"start":{"line":8,"column":37},"end":{"line":8,"column":69}},"3":{"start":{"line":9,"column":24},"end":{"line":9,"column":43}},"4":{"start":{"line":10,"column":26},"end":{"line":10,"column":48}},"5":{"start":{"line":11,"column":27},"end":{"line":11,"column":49}},"6":{"start":{"line":13,"column":4},"end":{"line":13,"column":76}},"7":{"start":{"line":27,"column":0},"end":{"line":35,"column":1}},"8":{"start":{"line":28,"column":2},"end":{"line":34,"column":5}},"9":{"start":{"line":29,"column":4},"end":{"line":33,"column":5}},"10":{"start":{"line":30,"column":6},"end":{"line":30,"column":87}},"11":{"start":{"line":30,"column":37},"end":{"line":30,"column":82}},"12":{"start":{"line":32,"column":6},"end":{"line":32,"column":18}},"13":{"start":{"line":37,"column":0},"end":{"line":40,"column":1}},"14":{"start":{"line":38,"column":2},"end":{"line":38,"column":86}},"15":{"start":{"line":39,"column":2},"end":{"line":39,"column":62}},"16":{"start":{"line":42,"column":0},"end":{"line":59,"column":2}},"17":{"start":{"line":61,"column":0},"end":{"line":63,"column":1}},"18":{"start":{"line":62,"column":2},"end":{"line":62,"column":55}},"19":{"start":{"line":64,"column":0},"end":{"line":66,"column":1}},"20":{"start":{"line":65,"column":2},"end":{"line":65,"column":55}},"21":{"start":{"line":70,"column":0},"end":{"line":72,"column":1}},"22":{"start":{"line":71,"column":2},"end":{"line":71,"column":57}},"23":{"start":{"line":74,"column":0},"end":{"line":85,"column":1}},"24":{"start":{"line":75,"column":2},"end":{"line":83,"column":4}},"25":{"start":{"line":84,"column":2},"end":{"line":84,"column":16}},"26":{"start":{"line":96,"column":0},"end":{"line":98,"column":1}},"27":{"start":{"line":97,"column":2},"end":{"line":97,"column":84}},"28":{"start":{"line":104,"column":0},"end":{"line":109,"column":1}},"29":{"start":{"line":105,"column":2},"end":{"line":108,"column":39}},"30":{"start":{"line":111,"column":0},"end":{"line":113,"column":1}},"31":{"start":{"line":112,"column":2},"end":{"line":112,"column":42}},"32":{"start":{"line":144,"column":0},"end":{"line":299,"column":1}},"33":{"start":{"line":145,"column":2},"end":{"line":145,"column":51}},"34":{"start":{"line":146,"column":2},"end":{"line":146,"column":80}},"35":{"start":{"line":148,"column":2},"end":{"line":148,"column":47}},"36":{"start":{"line":150,"column":2},"end":{"line":160,"column":3}},"37":{"start":{"line":151,"column":4},"end":{"line":151,"column":47}},"38":{"start":{"line":152,"column":4},"end":{"line":158,"column":5}},"39":{"start":{"line":153,"column":6},"end":{"line":153,"column":46}},"40":{"start":{"line":154,"column":6},"end":{"line":154,"column":49}},"41":{"start":{"line":155,"column":6},"end":{"line":157,"column":7}},"42":{"start":{"line":156,"column":8},"end":{"line":156,"column":87}},"43":{"start":{"line":159,"column":4},"end":{"line":159,"column":22}},"44":{"start":{"line":162,"column":2},"end":{"line":177,"column":3}},"45":{"start":{"line":163,"column":4},"end":{"line":163,"column":43}},"46":{"start":{"line":164,"column":4},"end":{"line":174,"column":5}},"47":{"start":{"line":165,"column":6},"end":{"line":165,"column":25}},"48":{"start":{"line":167,"column":6},"end":{"line":173,"column":7}},"49":{"start":{"line":168,"column":8},"end":{"line":168,"column":43}},"50":{"start":{"line":169,"column":13},"end":{"line":173,"column":7}},"51":{"start":{"line":170,"column":8},"end":{"line":170,"column":48}},"52":{"start":{"line":171,"column":13},"end":{"line":173,"column":7}},"53":{"start":{"line":172,"column":8},"end":{"line":172,"column":44}},"54":{"start":{"line":176,"column":4},"end":{"line":176,"column":63}},"55":{"start":{"line":179,"column":2},"end":{"line":181,"column":3}},"56":{"start":{"line":180,"column":4},"end":{"line":180,"column":44}},"57":{"start":{"line":183,"column":2},"end":{"line":185,"column":3}},"58":{"start":{"line":184,"column":4},"end":{"line":184,"column":15}},"59":{"start":{"line":187,"column":2},"end":{"line":189,"column":3}},"60":{"start":{"line":188,"column":4},"end":{"line":188,"column":41}},"61":{"start":{"line":191,"column":2},"end":{"line":193,"column":3}},"62":{"start":{"line":192,"column":4},"end":{"line":192,"column":60}},"63":{"start":{"line":195,"column":2},"end":{"line":197,"column":3}},"64":{"start":{"line":196,"column":4},"end":{"line":196,"column":65}},"65":{"start":{"line":199,"column":2},"end":{"line":201,"column":3}},"66":{"start":{"line":200,"column":4},"end":{"line":200,"column":63}},"67":{"start":{"line":203,"column":2},"end":{"line":205,"column":3}},"68":{"start":{"line":204,"column":4},"end":{"line":204,"column":15}},"69":{"start":{"line":207,"column":2},"end":{"line":216,"column":3}},"70":{"start":{"line":208,"column":4},"end":{"line":214,"column":5}},"71":{"start":{"line":209,"column":6},"end":{"line":213,"column":7}},"72":{"start":{"line":210,"column":8},"end":{"line":210,"column":47}},"73":{"start":{"line":212,"column":8},"end":{"line":212,"column":33}},"74":{"start":{"line":215,"column":4},"end":{"line":215,"column":16}},"75":{"start":{"line":218,"column":2},"end":{"line":229,"column":4}},"76":{"start":{"line":231,"column":2},"end":{"line":233,"column":3}},"77":{"start":{"line":232,"column":4},"end":{"line":232,"column":67}},"78":{"start":{"line":235,"column":2},"end":{"line":243,"column":3}},"79":{"start":{"line":236,"column":4},"end":{"line":236,"column":12}},"80":{"start":{"line":237,"column":4},"end":{"line":240,"column":5}},"81":{"start":{"line":238,"column":6},"end":{"line":238,"column":47}},"82":{"start":{"line":239,"column":6},"end":{"line":239,"column":42}},"83":{"start":{"line":242,"column":4},"end":{"line":242,"column":22}},"84":{"start":{"line":245,"column":2},"end":{"line":263,"column":3}},"85":{"start":{"line":246,"column":4},"end":{"line":246,"column":12}},"86":{"start":{"line":247,"column":4},"end":{"line":261,"column":5}},"87":{"start":{"line":248,"column":6},"end":{"line":260,"column":7}},"88":{"start":{"line":249,"column":8},"end":{"line":249,"column":46}},"89":{"start":{"line":251,"column":8},"end":{"line":253,"column":9}},"90":{"start":{"line":252,"column":10},"end":{"line":252,"column":23}},"91":{"start":{"line":255,"column":8},"end":{"line":255,"column":36}},"92":{"start":{"line":257,"column":8},"end":{"line":259,"column":9}},"93":{"start":{"line":258,"column":10},"end":{"line":258,"column":30}},"94":{"start":{"line":262,"column":4},"end":{"line":262,"column":17}},"95":{"start":{"line":265,"column":2},"end":{"line":297,"column":4}},"96":{"start":{"line":266,"column":4},"end":{"line":266,"column":29}},"97":{"start":{"line":267,"column":4},"end":{"line":267,"column":15}},"98":{"start":{"line":268,"column":4},"end":{"line":268,"column":31}},"99":{"start":{"line":270,"column":4},"end":{"line":295,"column":5}},"100":{"start":{"line":271,"column":6},"end":{"line":271,"column":36}},"101":{"start":{"line":272,"column":6},"end":{"line":272,"column":30}},"102":{"start":{"line":273,"column":6},"end":{"line":273,"column":33}},"103":{"start":{"line":274,"column":6},"end":{"line":274,"column":42}},"104":{"start":{"line":275,"column":6},"end":{"line":275,"column":32}},"105":{"start":{"line":276,"column":6},"end":{"line":276,"column":27}},"106":{"start":{"line":279,"column":6},"end":{"line":293,"column":7}},"107":{"start":{"line":280,"column":8},"end":{"line":280,"column":37}},"108":{"start":{"line":284,"column":8},"end":{"line":286,"column":24}},"109":{"start":{"line":290,"column":8},"end":{"line":290,"column":56}},"110":{"start":{"line":291,"column":8},"end":{"line":291,"column":48}},"111":{"start":{"line":292,"column":8},"end":{"line":292,"column":39}},"112":{"start":{"line":294,"column":6},"end":{"line":294,"column":74}},"113":{"start":{"line":296,"column":4},"end":{"line":296,"column":27}},"114":{"start":{"line":301,"column":0},"end":{"line":310,"column":2}},"115":{"start":{"line":308,"column":4},"end":{"line":308,"column":60}}},"branchMap":{"1":{"line":4,"type":"binary-expr","locations":[{"start":{"line":4,"column":8},"end":{"line":4,"column":14}},{"start":{"line":4,"column":18},"end":{"line":4,"column":22}}]},"2":{"line":13,"type":"binary-expr","locations":[{"start":{"line":13,"column":25},"end":{"line":13,"column":31}},{"start":{"line":13,"column":35},"end":{"line":13,"column":49}}]},"3":{"line":13,"type":"binary-expr","locations":[{"start":{"line":13,"column":51},"end":{"line":13,"column":57}},{"start":{"line":13,"column":61},"end":{"line":13,"column":74}}]},"4":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":4}},{"start":{"line":29,"column":4},"end":{"line":29,"column":4}}]},"5":{"line":29,"type":"binary-expr","locations":[{"start":{"line":29,"column":9},"end":{"line":29,"column":30}},{"start":{"line":29,"column":35},"end":{"line":29,"column":45}}]},"6":{"line":38,"type":"cond-expr","locations":[{"start":{"line":38,"column":38},"end":{"line":38,"column":45}},{"start":{"line":38,"column":48},"end":{"line":38,"column":85}}]},"7":{"line":62,"type":"cond-expr","locations":[{"start":{"line":62,"column":17},"end":{"line":62,"column":49}},{"start":{"line":62,"column":52},"end":{"line":62,"column":54}}]},"8":{"line":65,"type":"cond-expr","locations":[{"start":{"line":65,"column":17},"end":{"line":65,"column":49}},{"start":{"line":65,"column":52},"end":{"line":65,"column":54}}]},"9":{"line":148,"type":"binary-expr","locations":[{"start":{"line":148,"column":12},"end":{"line":148,"column":19}},{"start":{"line":148,"column":23},"end":{"line":148,"column":46}}]},"10":{"line":152,"type":"if","locations":[{"start":{"line":152,"column":4},"end":{"line":152,"column":4}},{"start":{"line":152,"column":4},"end":{"line":152,"column":4}}]},"11":{"line":155,"type":"if","locations":[{"start":{"line":155,"column":6},"end":{"line":155,"column":6}},{"start":{"line":155,"column":6},"end":{"line":155,"column":6}}]},"12":{"line":164,"type":"if","locations":[{"start":{"line":164,"column":4},"end":{"line":164,"column":4}},{"start":{"line":164,"column":4},"end":{"line":164,"column":4}}]},"13":{"line":167,"type":"if","locations":[{"start":{"line":167,"column":6},"end":{"line":167,"column":6}},{"start":{"line":167,"column":6},"end":{"line":167,"column":6}}]},"14":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":13},"end":{"line":169,"column":13}},{"start":{"line":169,"column":13},"end":{"line":169,"column":13}}]},"15":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":13},"end":{"line":171,"column":13}},{"start":{"line":171,"column":13},"end":{"line":171,"column":13}}]},"16":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":4},"end":{"line":208,"column":4}},{"start":{"line":208,"column":4},"end":{"line":208,"column":4}}]},"17":{"line":209,"type":"if","locations":[{"start":{"line":209,"column":6},"end":{"line":209,"column":6}},{"start":{"line":209,"column":6},"end":{"line":209,"column":6}}]},"18":{"line":237,"type":"if","locations":[{"start":{"line":237,"column":4},"end":{"line":237,"column":4}},{"start":{"line":237,"column":4},"end":{"line":237,"column":4}}]},"19":{"line":247,"type":"if","locations":[{"start":{"line":247,"column":4},"end":{"line":247,"column":4}},{"start":{"line":247,"column":4},"end":{"line":247,"column":4}}]},"20":{"line":248,"type":"if","locations":[{"start":{"line":248,"column":6},"end":{"line":248,"column":6}},{"start":{"line":248,"column":6},"end":{"line":248,"column":6}}]},"21":{"line":279,"type":"if","locations":[{"start":{"line":279,"column":6},"end":{"line":279,"column":6}},{"start":{"line":279,"column":6},"end":{"line":279,"column":6}}]},"22":{"line":285,"type":"binary-expr","locations":[{"start":{"line":285,"column":10},"end":{"line":285,"column":68}},{"start":{"line":286,"column":10},"end":{"line":286,"column":23}}]},"23":{"line":308,"type":"binary-expr","locations":[{"start":{"line":308,"column":11},"end":{"line":308,"column":29}},{"start":{"line":308,"column":33},"end":{"line":308,"column":59}}]}},"code":["\"use strict\";","var dateFormat = require('./date_format')",", os = require('os')",", eol = os.EOL || '\\n'",", util = require('util')",", replacementRegExp = /%[sdj]/g",", layoutMakers = {","  \"messagePassThrough\": function() { return messagePassThroughLayout; }, ","  \"basic\": function() { return basicLayout; }, ","  \"colored\": function() { return colouredLayout; }, ","  \"coloured\": function() { return colouredLayout; }, ","  \"pattern\": function (config) {","    return patternLayout(config && config.pattern, config && config.tokens);","\t}","}",", colours = {","  ALL: \"grey\", ","  TRACE: \"blue\", ","  DEBUG: \"cyan\", ","  INFO: \"green\", ","  WARN: \"yellow\", ","  ERROR: \"red\", ","  FATAL: \"magenta\", ","  OFF: \"grey\"","};","","function wrapErrorsWithInspect(items) {","  return items.map(function(item) {","    if ((item instanceof Error) && item.stack) {","      return { inspect: function() { return util.format(item) + '\\n' + item.stack; } };","    } else {","      return item;","    }","  });","}","","function formatLogData(logData) {","  var data = Array.isArray(logData) ? logData : Array.prototype.slice.call(arguments);","  return util.format.apply(util, wrapErrorsWithInspect(data));","}","","var styles = {","    //styles","  'bold'      : [1,  22],","  'italic'    : [3,  23],","  'underline' : [4,  24],","  'inverse'   : [7,  27],","  //grayscale","  'white'     : [37, 39],","  'grey'      : [90, 39],","  'black'     : [90, 39],","  //colors","  'blue'      : [34, 39],","  'cyan'      : [36, 39],","  'green'     : [32, 39],","  'magenta'   : [35, 39],","  'red'       : [31, 39],","  'yellow'    : [33, 39]","};","","function colorizeStart(style) {","  return style ? '\\x1B[' + styles[style][0] + 'm' : '';","}","function colorizeEnd(style) {","  return style ? '\\x1B[' + styles[style][1] + 'm' : '';","}","/**"," * Taken from masylum's fork (https://github.com/masylum/log4js-node)"," */","function colorize (str, style) {","  return colorizeStart(style) + str + colorizeEnd(style);","}","","function timestampLevelAndCategory(loggingEvent, colour) {","  var output = colorize(","    formatLogData(","      '[%s] [%s] %s - '","      , dateFormat.asString(loggingEvent.startTime)","      , loggingEvent.level","      , loggingEvent.categoryName","    )","    , colour","  );","  return output;","}","","/**"," * BasicLayout is a simple layout for storing the logs. The logs are stored"," * in following format:"," * <pre>"," * [startTime] [logLevel] categoryName - message\\n"," * </pre>"," *"," * @author Stephan Strittmatter"," */","function basicLayout (loggingEvent) {","  return timestampLevelAndCategory(loggingEvent) + formatLogData(loggingEvent.data);","}","","/**"," * colouredLayout - taken from masylum's fork."," * same as basicLayout, but with colours."," */","function colouredLayout (loggingEvent) {","  return timestampLevelAndCategory(","    loggingEvent,","    colours[loggingEvent.level.toString()]","  ) + formatLogData(loggingEvent.data);","}","","function messagePassThroughLayout (loggingEvent) {","  return formatLogData(loggingEvent.data);","}","","/**"," * PatternLayout"," * Format for specifiers is %[padding].[truncation][field]{[format]}"," * e.g. %5.10p - left pad the log level by 5 characters, up to a max of 10"," * Fields can be any of:"," *  - %r time in toLocaleTimeString format"," *  - %p log level"," *  - %c log category"," *  - %m log data"," *  - %d date in various formats"," *  - %% %"," *  - %n newline"," *  - %x{<tokenname>} add dynamic tokens to your log. Tokens are specified in the tokens parameter"," * You can use %[ and %] to define a colored block."," *"," * Tokens are specified as simple key:value objects. "," * The key represents the token name whereas the value can be a string or function"," * which is called to extract the value to put in the log message. If token is not"," * found, it doesn't replace the field."," *"," * A sample token would be: { \"pid\" : function() { return process.pid; } }"," *"," * Takes a pattern string, array of tokens and returns a layout function."," * @param {String} Log format pattern String"," * @param {object} map object of different tokens"," * @return {Function}"," * @author Stephan Strittmatter"," * @author Jan Schmidle"," */","function patternLayout (pattern, tokens) {","  var TTCC_CONVERSION_PATTERN  = \"%r %p %c - %m%n\";","  var regex = /%(-?[0-9]+)?(\\.?[0-9]+)?([\\[\\]cdmnprx%])(\\{([^\\}]+)\\})?|([^%]+)/;","  ","  pattern = pattern || TTCC_CONVERSION_PATTERN;","","  function categoryName(loggingEvent, specifier) {","    var loggerName = loggingEvent.categoryName;","    if (specifier) {","      var precision = parseInt(specifier, 10);","      var loggerNameBits = loggerName.split(\".\");","      if (precision < loggerNameBits.length) {","        loggerName = loggerNameBits.slice(loggerNameBits.length - precision).join(\".\");","      }","    }","    return loggerName;","  }","","  function formatAsDate(loggingEvent, specifier) {","    var format = dateFormat.ISO8601_FORMAT;","    if (specifier) {","      format = specifier;","      // Pick up special cases","      if (format == \"ISO8601\") {","        format = dateFormat.ISO8601_FORMAT;","      } else if (format == \"ABSOLUTE\") {","        format = dateFormat.ABSOLUTETIME_FORMAT;","      } else if (format == \"DATE\") {","        format = dateFormat.DATETIME_FORMAT;","      }","    }","    // Format the date","    return dateFormat.asString(format, loggingEvent.startTime);","  }","","  function formatMessage(loggingEvent) {","    return formatLogData(loggingEvent.data);","  }","  ","  function endOfLine() {","    return eol;","  }","","  function logLevel(loggingEvent) {","    return loggingEvent.level.toString();","  }","","  function startTime(loggingEvent) {","    return \"\" + loggingEvent.startTime.toLocaleTimeString();","  }","","  function startColour(loggingEvent) {","    return colorizeStart(colours[loggingEvent.level.toString()]);","  }","","  function endColour(loggingEvent) {","    return colorizeEnd(colours[loggingEvent.level.toString()]);","  }","","  function percent() {","    return '%';","  }","","  function userDefined(loggingEvent, specifier) {","    if (typeof(tokens[specifier]) !== 'undefined') {","      if (typeof(tokens[specifier]) === 'function') {","        return tokens[specifier](loggingEvent);","      } else {","        return tokens[specifier];","      }","    }","    return null;","  }","","  var replacers = {","    'c': categoryName,","    'd': formatAsDate,","    'm': formatMessage,","    'n': endOfLine,","    'p': logLevel,","    'r': startTime,","    '[': startColour,","    ']': endColour,","    '%': percent,","    'x': userDefined","  };","","  function replaceToken(conversionCharacter, loggingEvent, specifier) {","    return replacers[conversionCharacter](loggingEvent, specifier);","  }","","  function truncate(truncation, toTruncate) {","    var len;","    if (truncation) {","      len = parseInt(truncation.substr(1), 10);","      return toTruncate.substring(0, len);","    }","","    return toTruncate;","  }","","  function pad(padding, toPad) {","    var len;","    if (padding) {","      if (padding.charAt(0) == \"-\") {","        len = parseInt(padding.substr(1), 10);","        // Right pad with spaces","        while (toPad.length < len) {","          toPad += \" \";","        }","      } else {","        len = parseInt(padding, 10);","        // Left pad with spaces","        while (toPad.length < len) {","          toPad = \" \" + toPad;","        }","      }","    }","    return toPad;","  }","  ","  return function(loggingEvent) {","    var formattedString = \"\";","    var result;","    var searchString = pattern;","    ","    while ((result = regex.exec(searchString))) {","      var matchedString = result[0];","      var padding = result[1];","      var truncation = result[2];","      var conversionCharacter = result[3];","      var specifier = result[5];","      var text = result[6];","      ","      // Check if the pattern matched was just normal text","      if (text) {","        formattedString += \"\" + text;","      } else {","        // Create a raw replacement string based on the conversion","        // character and specifier","        var replacement = ","          replaceToken(conversionCharacter, loggingEvent, specifier) || ","          matchedString;","","        // Format the replacement according to any padding or","        // truncation specified","        replacement = truncate(truncation, replacement);","        replacement = pad(padding, replacement);","        formattedString += replacement;","      }","      searchString = searchString.substr(result.index + result[0].length);","    }","    return formattedString;","  };","","}","","module.exports = {","  basicLayout: basicLayout, ","  messagePassThroughLayout: messagePassThroughLayout, ","  patternLayout: patternLayout, ","  colouredLayout: colouredLayout, ","  coloredLayout: colouredLayout, ","  layout: function(name, config) {","    return layoutMakers[name] && layoutMakers[name](config);","  }","};",""],"l":{"2":1,"8":0,"9":0,"10":0,"11":0,"13":0,"27":1,"28":0,"29":0,"30":0,"32":0,"37":1,"38":0,"39":0,"42":1,"61":1,"62":0,"64":1,"65":0,"70":1,"71":0,"74":1,"75":0,"84":0,"96":1,"97":0,"104":1,"105":0,"111":1,"112":0,"144":1,"145":0,"146":0,"148":0,"150":1,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"159":0,"162":1,"163":0,"164":0,"165":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"176":0,"179":1,"180":0,"183":1,"184":0,"187":1,"188":0,"191":1,"192":0,"195":1,"196":0,"199":1,"200":0,"203":1,"204":0,"207":1,"208":0,"209":0,"210":0,"212":0,"215":0,"218":0,"231":1,"232":0,"235":1,"236":0,"237":0,"238":0,"239":0,"242":0,"245":1,"246":0,"247":0,"248":0,"249":0,"251":0,"252":0,"255":0,"257":0,"258":0,"262":0,"265":0,"266":0,"267":0,"268":0,"270":0,"271":0,"272":0,"273":0,"274":0,"275":0,"276":0,"279":0,"280":0,"284":0,"290":0,"291":0,"292":0,"294":0,"296":0,"301":1,"308":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/date_format.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/date_format.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":1,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"padWithZeros","line":7,"loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":38}}},"2":{"name":"addZero","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":26}}},"3":{"name":"offset","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":22}}},"4":{"name":"(anonymous_4)","line":38,"loc":{"start":{"line":38,"column":19},"end":{"line":38,"column":46}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":2,"column":51}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":63}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":45}},"5":{"start":{"line":7,"column":0},"end":{"line":13,"column":1}},"6":{"start":{"line":8,"column":2},"end":{"line":8,"column":33}},"7":{"start":{"line":9,"column":2},"end":{"line":11,"column":3}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":36}},"9":{"start":{"line":12,"column":2},"end":{"line":12,"column":21}},"10":{"start":{"line":15,"column":0},"end":{"line":17,"column":1}},"11":{"start":{"line":16,"column":2},"end":{"line":16,"column":34}},"12":{"start":{"line":24,"column":0},"end":{"line":36,"column":1}},"13":{"start":{"line":26,"column":2},"end":{"line":26,"column":46}},"14":{"start":{"line":27,"column":2},"end":{"line":27,"column":36}},"15":{"start":{"line":28,"column":2},"end":{"line":28,"column":24}},"16":{"start":{"line":29,"column":2},"end":{"line":31,"column":3}},"17":{"start":{"line":30,"column":4},"end":{"line":30,"column":16}},"18":{"start":{"line":32,"column":2},"end":{"line":34,"column":3}},"19":{"start":{"line":33,"column":4},"end":{"line":33,"column":16}},"20":{"start":{"line":35,"column":2},"end":{"line":35,"column":58}},"21":{"start":{"line":38,"column":0},"end":{"line":66,"column":2}},"22":{"start":{"line":39,"column":2},"end":{"line":39,"column":38}},"23":{"start":{"line":40,"column":2},"end":{"line":43,"column":3}},"24":{"start":{"line":41,"column":4},"end":{"line":41,"column":26}},"25":{"start":{"line":42,"column":4},"end":{"line":42,"column":24}},"26":{"start":{"line":45,"column":2},"end":{"line":45,"column":37}},"27":{"start":{"line":46,"column":2},"end":{"line":46,"column":42}},"28":{"start":{"line":47,"column":2},"end":{"line":47,"column":46}},"29":{"start":{"line":48,"column":2},"end":{"line":48,"column":73}},"30":{"start":{"line":49,"column":2},"end":{"line":49,"column":69}},"31":{"start":{"line":50,"column":2},"end":{"line":50,"column":40}},"32":{"start":{"line":51,"column":2},"end":{"line":51,"column":43}},"33":{"start":{"line":52,"column":2},"end":{"line":52,"column":43}},"34":{"start":{"line":53,"column":2},"end":{"line":53,"column":61}},"35":{"start":{"line":54,"column":2},"end":{"line":54,"column":31}},"36":{"start":{"line":55,"column":2},"end":{"line":63,"column":30}},"37":{"start":{"line":64,"column":2},"end":{"line":64,"column":19}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"2":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":32,"column":2}},{"start":{"line":32,"column":2},"end":{"line":32,"column":2}}]},"3":{"line":35,"type":"cond-expr","locations":[{"start":{"line":35,"column":40},"end":{"line":35,"column":47}},{"start":{"line":35,"column":50},"end":{"line":35,"column":57}}]},"4":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":40,"column":2}},{"start":{"line":40,"column":2},"end":{"line":40,"column":2}}]},"5":{"line":49,"type":"cond-expr","locations":[{"start":{"line":49,"column":45},"end":{"line":49,"column":54}},{"start":{"line":49,"column":57},"end":{"line":49,"column":67}}]}},"code":["\"use strict\";","exports.ISO8601_FORMAT = \"yyyy-MM-dd hh:mm:ss.SSS\";","exports.ISO8601_WITH_TZ_OFFSET_FORMAT = \"yyyy-MM-ddThh:mm:ssO\";","exports.DATETIME_FORMAT = \"dd MM yyyy hh:mm:ss.SSS\";","exports.ABSOLUTETIME_FORMAT = \"hh:mm:ss.SSS\";","","function padWithZeros(vNumber, width) {","  var numAsString = vNumber + \"\";","  while (numAsString.length < width) {","    numAsString = \"0\" + numAsString;","  }","  return numAsString;","}","  ","function addZero(vNumber) {","  return padWithZeros(vNumber, 2);","}","","/**"," * Formats the TimeOffest"," * Thanks to http://www.svendtofte.com/code/date_format/"," * @private"," */","function offset(date) {","  // Difference to Greenwich time (GMT) in hours","  var os = Math.abs(date.getTimezoneOffset());","  var h = String(Math.floor(os/60));","  var m = String(os%60);","  if (h.length == 1) {","    h = \"0\" + h;","  }","  if (m.length == 1) {","    m = \"0\" + m;","  }","  return date.getTimezoneOffset() < 0 ? \"+\"+h+m : \"-\"+h+m;","}","","exports.asString = function(/*format,*/ date) {","  var format = exports.ISO8601_FORMAT;","  if (typeof(date) === \"string\") {","    format = arguments[0];","    date = arguments[1];","  }","","  var vDay = addZero(date.getDate());","  var vMonth = addZero(date.getMonth()+1);","  var vYearLong = addZero(date.getFullYear());","  var vYearShort = addZero(date.getFullYear().toString().substring(3,4));","  var vYear = (format.indexOf(\"yyyy\") > -1 ? vYearLong : vYearShort);","  var vHour  = addZero(date.getHours());","  var vMinute = addZero(date.getMinutes());","  var vSecond = addZero(date.getSeconds());","  var vMillisecond = padWithZeros(date.getMilliseconds(), 3);","  var vTimeZone = offset(date);","  var formatted = format","    .replace(/dd/g, vDay)","    .replace(/MM/g, vMonth)","    .replace(/y{1,4}/g, vYear)","    .replace(/hh/g, vHour)","    .replace(/mm/g, vMinute)","    .replace(/ss/g, vSecond)","    .replace(/SSS/g, vMillisecond)","    .replace(/O/g, vTimeZone);","  return formatted;","","};",""],"l":{"2":1,"3":1,"4":1,"5":1,"7":1,"8":0,"9":0,"10":0,"12":0,"15":1,"16":0,"24":1,"26":0,"27":0,"28":0,"29":0,"30":0,"32":0,"33":0,"35":0,"38":1,"39":0,"40":0,"41":0,"42":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"64":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/levels.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/levels.js","s":{"1":1,"2":8,"3":8,"4":1,"5":6,"6":0,"7":6,"8":6,"9":6,"10":6,"11":0,"12":0,"13":1,"14":0,"15":1,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":1},"b":{"1":[0,6],"2":[6,0],"3":[6,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":8,"2":6,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"Level","line":3,"loc":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}}},"2":{"name":"toLevel","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":37}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":27},"end":{"line":33,"column":38}}},"4":{"name":"(anonymous_4)","line":37,"loc":{"start":{"line":37,"column":38},"end":{"line":37,"column":59}}},"5":{"name":"(anonymous_5)","line":44,"loc":{"start":{"line":44,"column":41},"end":{"line":44,"column":62}}},"6":{"name":"(anonymous_6)","line":51,"loc":{"start":{"line":51,"column":28},"end":{"line":51,"column":49}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":6,"column":1}},"2":{"start":{"line":4,"column":2},"end":{"line":4,"column":21}},"3":{"start":{"line":5,"column":2},"end":{"line":5,"column":27}},"4":{"start":{"line":15,"column":0},"end":{"line":31,"column":1}},"5":{"start":{"line":17,"column":2},"end":{"line":19,"column":3}},"6":{"start":{"line":18,"column":4},"end":{"line":18,"column":24}},"7":{"start":{"line":21,"column":2},"end":{"line":28,"column":3}},"8":{"start":{"line":22,"column":4},"end":{"line":22,"column":31}},"9":{"start":{"line":23,"column":4},"end":{"line":27,"column":5}},"10":{"start":{"line":24,"column":6},"end":{"line":24,"column":31}},"11":{"start":{"line":26,"column":6},"end":{"line":26,"column":26}},"12":{"start":{"line":30,"column":2},"end":{"line":30,"column":34}},"13":{"start":{"line":33,"column":0},"end":{"line":35,"column":2}},"14":{"start":{"line":34,"column":2},"end":{"line":34,"column":23}},"15":{"start":{"line":37,"column":0},"end":{"line":42,"column":2}},"16":{"start":{"line":38,"column":2},"end":{"line":40,"column":3}},"17":{"start":{"line":39,"column":4},"end":{"line":39,"column":37}},"18":{"start":{"line":41,"column":2},"end":{"line":41,"column":40}},"19":{"start":{"line":44,"column":0},"end":{"line":49,"column":2}},"20":{"start":{"line":45,"column":2},"end":{"line":47,"column":3}},"21":{"start":{"line":46,"column":4},"end":{"line":46,"column":37}},"22":{"start":{"line":48,"column":2},"end":{"line":48,"column":40}},"23":{"start":{"line":51,"column":0},"end":{"line":56,"column":2}},"24":{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},"25":{"start":{"line":53,"column":4},"end":{"line":53,"column":37}},"26":{"start":{"line":55,"column":2},"end":{"line":55,"column":41}},"27":{"start":{"line":58,"column":0},"end":{"line":68,"column":2}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":2},"end":{"line":17,"column":2}},{"start":{"line":17,"column":2},"end":{"line":17,"column":2}}]},"2":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":2},"end":{"line":21,"column":2}},{"start":{"line":21,"column":2},"end":{"line":21,"column":2}}]},"3":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":23,"column":4}},{"start":{"line":23,"column":4},"end":{"line":23,"column":4}}]},"4":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":2},"end":{"line":38,"column":2}},{"start":{"line":38,"column":2},"end":{"line":38,"column":2}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":2},"end":{"line":45,"column":2}},{"start":{"line":45,"column":2},"end":{"line":45,"column":2}}]},"6":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":52,"column":2}},{"start":{"line":52,"column":2},"end":{"line":52,"column":2}}]}},"code":["\"use strict\";","","function Level(level, levelStr) {","  this.level = level;","  this.levelStr = levelStr;","}","","/**"," * converts given String to corresponding Level"," * @param {String} sArg String value of Level OR Log4js.Level"," * @param {Log4js.Level} defaultLevel default Level, if no String representation"," * @return Level object"," * @type Log4js.Level"," */","function toLevel(sArg, defaultLevel) {","","  if (!sArg) {","    return defaultLevel;","  }","","  if (typeof sArg == \"string\") {","    var s = sArg.toUpperCase();","    if (module.exports[s]) {","      return module.exports[s];","    } else {","      return defaultLevel;","    }","  }","","  return toLevel(sArg.toString());","}","","Level.prototype.toString = function() {","  return this.levelStr;","};","","Level.prototype.isLessThanOrEqualTo = function(otherLevel) {","  if (typeof otherLevel === \"string\") {","    otherLevel = toLevel(otherLevel);","  }","  return this.level <= otherLevel.level;","};","","Level.prototype.isGreaterThanOrEqualTo = function(otherLevel) {","  if (typeof otherLevel === \"string\") {","    otherLevel = toLevel(otherLevel);","  }","  return this.level >= otherLevel.level;","};","","Level.prototype.isEqualTo = function(otherLevel) {","  if (typeof otherLevel == \"string\") {","    otherLevel = toLevel(otherLevel);","  }","  return this.level === otherLevel.level;","};","","module.exports = {","  ALL: new Level(Number.MIN_VALUE, \"ALL\"), ","  TRACE: new Level(5000, \"TRACE\"), ","  DEBUG: new Level(10000, \"DEBUG\"), ","  INFO: new Level(20000, \"INFO\"), ","  WARN: new Level(30000, \"WARN\"), ","  ERROR: new Level(40000, \"ERROR\"), ","  FATAL: new Level(50000, \"FATAL\"), ","  OFF: new Level(Number.MAX_VALUE, \"OFF\"), ","  toLevel: toLevel","};",""],"l":{"3":1,"4":8,"5":8,"15":1,"17":6,"18":0,"21":6,"22":6,"23":6,"24":6,"26":0,"30":0,"33":1,"34":0,"37":1,"38":0,"39":0,"41":0,"44":1,"45":0,"46":0,"48":0,"51":1,"52":0,"53":0,"55":0,"58":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/logger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/logger.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1,"9":3,"10":3,"11":0,"12":1,"13":1,"14":1,"15":1,"16":0,"17":1,"18":0,"19":1,"20":0,"21":0,"22":1,"23":0,"24":1,"25":6,"26":6,"27":0,"28":6,"29":0,"30":0,"31":0,"32":0,"33":1,"34":1},"b":{"1":[3,0],"2":[0,3],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":3,"3":0,"4":0,"5":0,"6":0,"7":6,"8":0,"9":0},"fnMap":{"1":{"name":"LoggingEvent","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":58}}},"2":{"name":"Logger","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":30}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":28},"end":{"line":42,"column":44}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":31},"end":{"line":46,"column":42}}},"5":{"name":"(anonymous_5)","line":50,"loc":{"start":{"line":50,"column":23},"end":{"line":50,"column":34}}},"6":{"name":"(anonymous_6)","line":57,"loc":{"start":{"line":57,"column":34},"end":{"line":57,"column":55}}},"7":{"name":"(anonymous_7)","line":62,"loc":{"start":{"line":62,"column":2},"end":{"line":62,"column":24}}},"8":{"name":"(anonymous_8)","line":64,"loc":{"start":{"line":64,"column":51},"end":{"line":64,"column":62}}},"9":{"name":"(anonymous_9)","line":68,"loc":{"start":{"line":68,"column":50},"end":{"line":68,"column":62}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":5,"column":33}},"2":{"start":{"line":16,"column":0},"end":{"line":22,"column":1}},"3":{"start":{"line":17,"column":2},"end":{"line":17,"column":30}},"4":{"start":{"line":18,"column":2},"end":{"line":18,"column":35}},"5":{"start":{"line":19,"column":2},"end":{"line":19,"column":19}},"6":{"start":{"line":20,"column":2},"end":{"line":20,"column":21}},"7":{"start":{"line":21,"column":2},"end":{"line":21,"column":23}},"8":{"start":{"line":31,"column":0},"end":{"line":37,"column":1}},"9":{"start":{"line":32,"column":2},"end":{"line":32,"column":43}},"10":{"start":{"line":34,"column":2},"end":{"line":36,"column":3}},"11":{"start":{"line":35,"column":4},"end":{"line":35,"column":25}},"12":{"start":{"line":38,"column":0},"end":{"line":38,"column":43}},"13":{"start":{"line":39,"column":0},"end":{"line":39,"column":43}},"14":{"start":{"line":40,"column":0},"end":{"line":40,"column":38}},"15":{"start":{"line":42,"column":0},"end":{"line":44,"column":2}},"16":{"start":{"line":43,"column":2},"end":{"line":43,"column":65}},"17":{"start":{"line":46,"column":0},"end":{"line":48,"column":2}},"18":{"start":{"line":47,"column":2},"end":{"line":47,"column":20}},"19":{"start":{"line":50,"column":0},"end":{"line":55,"column":2}},"20":{"start":{"line":51,"column":2},"end":{"line":53,"column":73}},"21":{"start":{"line":54,"column":2},"end":{"line":54,"column":33}},"22":{"start":{"line":57,"column":0},"end":{"line":59,"column":2}},"23":{"start":{"line":58,"column":2},"end":{"line":58,"column":52}},"24":{"start":{"line":61,"column":0},"end":{"line":76,"column":2}},"25":{"start":{"line":63,"column":4},"end":{"line":63,"column":44}},"26":{"start":{"line":64,"column":4},"end":{"line":66,"column":6}},"27":{"start":{"line":65,"column":6},"end":{"line":65,"column":40}},"28":{"start":{"line":68,"column":4},"end":{"line":74,"column":6}},"29":{"start":{"line":69,"column":6},"end":{"line":73,"column":7}},"30":{"start":{"line":70,"column":8},"end":{"line":70,"column":57}},"31":{"start":{"line":71,"column":8},"end":{"line":71,"column":28}},"32":{"start":{"line":72,"column":8},"end":{"line":72,"column":47}},"33":{"start":{"line":79,"column":0},"end":{"line":79,"column":36}},"34":{"start":{"line":80,"column":0},"end":{"line":80,"column":24}}},"branchMap":{"1":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":18},"end":{"line":32,"column":22}},{"start":{"line":32,"column":26},"end":{"line":32,"column":42}}]},"2":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":2},"end":{"line":34,"column":2}},{"start":{"line":34,"column":2},"end":{"line":34,"column":2}}]},"3":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":37},"end":{"line":43,"column":47}},{"start":{"line":43,"column":51},"end":{"line":43,"column":63}}]},"4":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":6},"end":{"line":69,"column":6}},{"start":{"line":69,"column":6},"end":{"line":69,"column":6}}]}},"code":["\"use strict\";","var levels = require('./levels')",", util = require('util')",", events = require('events')",", DEFAULT_CATEGORY = '[default]';","","/**"," * Models a logging event."," * @constructor"," * @param {String} categoryName name of category"," * @param {Log4js.Level} level level of message"," * @param {Array} data objects to log"," * @param {Log4js.Logger} logger the associated logger"," * @author Seth Chisamore"," */","function LoggingEvent (categoryName, level, data, logger) {","  this.startTime = new Date();","  this.categoryName = categoryName;","  this.data = data;","  this.level = level;","  this.logger = logger;","}","","/**"," * Logger to log messages."," * use {@see Log4js#getLogger(String)} to get an instance."," * @constructor"," * @param name name of category to log to"," * @author Stephan Strittmatter"," */","function Logger (name, level) {","  this.category = name || DEFAULT_CATEGORY;","  ","  if (level) {","    this.setLevel(level);","  }","}","util.inherits(Logger, events.EventEmitter);","Logger.DEFAULT_CATEGORY = DEFAULT_CATEGORY;","Logger.prototype.level = levels.TRACE;","","Logger.prototype.setLevel = function(level) {","  this.level = levels.toLevel(level, this.level || levels.TRACE);","};","","Logger.prototype.removeLevel = function() {","  delete this.level;","};","","Logger.prototype.log = function() {","  var args = Array.prototype.slice.call(arguments)","  , logLevel = args.shift()","  , loggingEvent = new LoggingEvent(this.category, logLevel, args, this);","  this.emit(\"log\", loggingEvent);","};","","Logger.prototype.isLevelEnabled = function(otherLevel) {","  return this.level.isLessThanOrEqualTo(otherLevel);","};","","['Trace','Debug','Info','Warn','Error','Fatal'].forEach(","  function(levelString) {","    var level = levels.toLevel(levelString);","    Logger.prototype['is'+levelString+'Enabled'] = function() {","      return this.isLevelEnabled(level);","    };","    ","    Logger.prototype[levelString.toLowerCase()] = function () {","      if (this.isLevelEnabled(level)) {","        var args = Array.prototype.slice.call(arguments);","        args.unshift(level);","        Logger.prototype.log.apply(this, args);","      }","    };","  }",");","","","exports.LoggingEvent = LoggingEvent;","exports.Logger = Logger;",""],"l":{"2":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"31":1,"32":3,"34":3,"35":0,"38":1,"39":1,"40":1,"42":1,"43":0,"46":1,"47":0,"50":1,"51":0,"54":0,"57":1,"58":0,"61":1,"63":6,"64":6,"65":0,"68":6,"69":0,"70":0,"71":0,"72":0,"79":1,"80":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/connect-logger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/connect-logger.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0],"20":[0,0,0,0],"21":[0,0],"22":[0,0,0,0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"getLogger","line":34,"loc":{"start":{"line":34,"column":0},"end":{"line":34,"column":39}}},"2":{"name":"(anonymous_2)","line":48,"loc":{"start":{"line":48,"column":9},"end":{"line":48,"column":35}}},"3":{"name":"(anonymous_3)","line":66,"loc":{"start":{"line":66,"column":19},"end":{"line":66,"column":42}}},"4":{"name":"(anonymous_4)","line":83,"loc":{"start":{"line":83,"column":13},"end":{"line":83,"column":39}}},"5":{"name":"(anonymous_5)","line":89,"loc":{"start":{"line":89,"column":31},"end":{"line":89,"column":44}}},"6":{"name":"format","line":113,"loc":{"start":{"line":113,"column":0},"end":{"line":113,"column":31}}},"7":{"name":"(anonymous_7)","line":134,"loc":{"start":{"line":134,"column":34},"end":{"line":134,"column":52}}},"8":{"name":"(anonymous_8)","line":135,"loc":{"start":{"line":135,"column":34},"end":{"line":135,"column":52}}},"9":{"name":"createNoLogCondition","line":169,"loc":{"start":{"line":169,"column":0},"end":{"line":169,"column":37}}},"10":{"name":"convertToStrings","line":183,"loc":{"start":{"line":183,"column":8},"end":{"line":183,"column":37}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"2":{"start":{"line":3,"column":0},"end":{"line":6,"column":19}},"3":{"start":{"line":34,"column":0},"end":{"line":101,"column":1}},"4":{"start":{"line":35,"column":1},"end":{"line":41,"column":2}},"5":{"start":{"line":36,"column":2},"end":{"line":36,"column":26}},"6":{"start":{"line":37,"column":8},"end":{"line":41,"column":2}},"7":{"start":{"line":38,"column":2},"end":{"line":38,"column":32}},"8":{"start":{"line":40,"column":2},"end":{"line":40,"column":15}},"9":{"start":{"line":43,"column":1},"end":{"line":46,"column":71}},"10":{"start":{"line":48,"column":2},"end":{"line":100,"column":4}},"11":{"start":{"line":50,"column":4},"end":{"line":50,"column":36}},"12":{"start":{"line":50,"column":22},"end":{"line":50,"column":36}},"13":{"start":{"line":53,"column":2},"end":{"line":53,"column":58}},"14":{"start":{"line":53,"column":44},"end":{"line":53,"column":58}},"15":{"start":{"line":54,"column":2},"end":{"line":96,"column":3}},"16":{"start":{"line":56,"column":3},"end":{"line":60,"column":27}},"17":{"start":{"line":63,"column":3},"end":{"line":63,"column":23}},"18":{"start":{"line":66,"column":3},"end":{"line":80,"column":5}},"19":{"start":{"line":67,"column":4},"end":{"line":67,"column":30}},"20":{"start":{"line":68,"column":4},"end":{"line":68,"column":33}},"21":{"start":{"line":69,"column":4},"end":{"line":69,"column":41}},"22":{"start":{"line":70,"column":4},"end":{"line":70,"column":34}},"23":{"start":{"line":73,"column":4},"end":{"line":79,"column":5}},"24":{"start":{"line":74,"column":5},"end":{"line":74,"column":25}},"25":{"start":{"line":75,"column":5},"end":{"line":75,"column":41}},"26":{"start":{"line":75,"column":21},"end":{"line":75,"column":41}},"27":{"start":{"line":76,"column":5},"end":{"line":76,"column":42}},"28":{"start":{"line":76,"column":21},"end":{"line":76,"column":42}},"29":{"start":{"line":78,"column":5},"end":{"line":78,"column":56}},"30":{"start":{"line":83,"column":3},"end":{"line":95,"column":5}},"31":{"start":{"line":84,"column":4},"end":{"line":84,"column":18}},"32":{"start":{"line":85,"column":4},"end":{"line":85,"column":29}},"33":{"start":{"line":86,"column":4},"end":{"line":86,"column":42}},"34":{"start":{"line":87,"column":4},"end":{"line":94,"column":5}},"35":{"start":{"line":88,"column":5},"end":{"line":93,"column":6}},"36":{"start":{"line":89,"column":6},"end":{"line":89,"column":79}},"37":{"start":{"line":89,"column":46},"end":{"line":89,"column":75}},"38":{"start":{"line":90,"column":6},"end":{"line":90,"column":44}},"39":{"start":{"line":90,"column":16},"end":{"line":90,"column":44}},"40":{"start":{"line":92,"column":6},"end":{"line":92,"column":51}},"41":{"start":{"line":99,"column":4},"end":{"line":99,"column":11}},"42":{"start":{"line":113,"column":0},"end":{"line":140,"column":1}},"43":{"start":{"line":114,"column":1},"end":{"line":139,"column":7}},"44":{"start":{"line":134,"column":54},"end":{"line":134,"column":94}},"45":{"start":{"line":136,"column":6},"end":{"line":138,"column":50}},"46":{"start":{"line":169,"column":0},"end":{"line":192,"column":1}},"47":{"start":{"line":170,"column":2},"end":{"line":170,"column":20}},"48":{"start":{"line":172,"column":1},"end":{"line":189,"column":3}},"49":{"start":{"line":173,"column":4},"end":{"line":175,"column":5}},"50":{"start":{"line":174,"column":6},"end":{"line":174,"column":21}},"51":{"start":{"line":177,"column":4},"end":{"line":179,"column":5}},"52":{"start":{"line":178,"column":6},"end":{"line":178,"column":33}},"53":{"start":{"line":181,"column":4},"end":{"line":188,"column":5}},"54":{"start":{"line":182,"column":6},"end":{"line":186,"column":8}},"55":{"start":{"line":184,"column":10},"end":{"line":184,"column":41}},"56":{"start":{"line":187,"column":6},"end":{"line":187,"column":54}},"57":{"start":{"line":191,"column":2},"end":{"line":191,"column":16}},"58":{"start":{"line":194,"column":0},"end":{"line":194,"column":34}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},{"start":{"line":35,"column":1},"end":{"line":35,"column":1}}]},"2":{"line":36,"type":"binary-expr","locations":[{"start":{"line":36,"column":12},"end":{"line":36,"column":19}},{"start":{"line":36,"column":23},"end":{"line":36,"column":25}}]},"3":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":37,"column":8}},{"start":{"line":37,"column":8},"end":{"line":37,"column":8}}]},"4":{"line":45,"type":"binary-expr","locations":[{"start":{"line":45,"column":10},"end":{"line":45,"column":24}},{"start":{"line":45,"column":28},"end":{"line":45,"column":42}}]},"5":{"line":46,"type":"cond-expr","locations":[{"start":{"line":46,"column":28},"end":{"line":46,"column":63}},{"start":{"line":46,"column":66},"end":{"line":46,"column":70}}]},"6":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":4},"end":{"line":50,"column":4}},{"start":{"line":50,"column":4},"end":{"line":50,"column":4}}]},"7":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":2},"end":{"line":53,"column":2}},{"start":{"line":53,"column":2},"end":{"line":53,"column":2}}]},"8":{"line":53,"type":"binary-expr","locations":[{"start":{"line":53,"column":6},"end":{"line":53,"column":11}},{"start":{"line":53,"column":15},"end":{"line":53,"column":42}}]},"9":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":2},"end":{"line":54,"column":2}},{"start":{"line":54,"column":2},"end":{"line":54,"column":2}}]},"10":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":6},"end":{"line":54,"column":38}},{"start":{"line":54,"column":42},"end":{"line":54,"column":66}}]},"11":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":20},"end":{"line":70,"column":27}},{"start":{"line":70,"column":31},"end":{"line":70,"column":33}}]},"12":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":73,"column":4}},{"start":{"line":73,"column":4},"end":{"line":73,"column":4}}]},"13":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":5},"end":{"line":75,"column":5}},{"start":{"line":75,"column":5},"end":{"line":75,"column":5}}]},"14":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":5},"end":{"line":76,"column":5}},{"start":{"line":76,"column":5},"end":{"line":76,"column":5}}]},"15":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":4},"end":{"line":87,"column":4}},{"start":{"line":87,"column":4},"end":{"line":87,"column":4}}]},"16":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":5},"end":{"line":88,"column":5}},{"start":{"line":88,"column":5},"end":{"line":88,"column":5}}]},"17":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":6},"end":{"line":90,"column":6}},{"start":{"line":90,"column":6},"end":{"line":90,"column":6}}]},"18":{"line":117,"type":"binary-expr","locations":[{"start":{"line":117,"column":24},"end":{"line":117,"column":40}},{"start":{"line":117,"column":44},"end":{"line":117,"column":58}}]},"19":{"line":120,"type":"binary-expr","locations":[{"start":{"line":120,"column":26},"end":{"line":120,"column":45}},{"start":{"line":120,"column":49},"end":{"line":120,"column":69}},{"start":{"line":120,"column":73},"end":{"line":120,"column":75}}]},"20":{"line":124,"type":"binary-expr","locations":[{"start":{"line":124,"column":6},"end":{"line":124,"column":16}},{"start":{"line":125,"column":9},"end":{"line":125,"column":33}},{"start":{"line":125,"column":38},"end":{"line":125,"column":55}},{"start":{"line":125,"column":59},"end":{"line":125,"column":90}}]},"21":{"line":127,"type":"binary-expr","locations":[{"start":{"line":127,"column":28},"end":{"line":127,"column":53}},{"start":{"line":127,"column":57},"end":{"line":127,"column":59}}]},"22":{"line":130,"type":"binary-expr","locations":[{"start":{"line":130,"column":7},"end":{"line":130,"column":19}},{"start":{"line":130,"column":23},"end":{"line":130,"column":53}},{"start":{"line":131,"column":9},"end":{"line":131,"column":22}},{"start":{"line":131,"column":26},"end":{"line":131,"column":57}},{"start":{"line":132,"column":8},"end":{"line":132,"column":11}}]},"23":{"line":136,"type":"cond-expr","locations":[{"start":{"line":137,"column":9},"end":{"line":137,"column":66}},{"start":{"line":138,"column":11},"end":{"line":138,"column":48}}]},"24":{"line":137,"type":"binary-expr","locations":[{"start":{"line":137,"column":9},"end":{"line":137,"column":42}},{"start":{"line":137,"column":46},"end":{"line":137,"column":66}}]},"25":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":11},"end":{"line":138,"column":24}},{"start":{"line":138,"column":28},"end":{"line":138,"column":48}}]},"26":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},{"start":{"line":172,"column":1},"end":{"line":172,"column":1}}]},"27":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":4},"end":{"line":173,"column":4}},{"start":{"line":173,"column":4},"end":{"line":173,"column":4}}]},"28":{"line":177,"type":"if","locations":[{"start":{"line":177,"column":4},"end":{"line":177,"column":4}},{"start":{"line":177,"column":4},"end":{"line":177,"column":4}}]},"29":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":4},"end":{"line":181,"column":4}},{"start":{"line":181,"column":4},"end":{"line":181,"column":4}}]},"30":{"line":184,"type":"cond-expr","locations":[{"start":{"line":184,"column":28},"end":{"line":184,"column":36}},{"start":{"line":184,"column":39},"end":{"line":184,"column":40}}]}},"code":["\"use strict\";","var levels = require(\"./levels\");","var DEFAULT_FORMAT = ':remote-addr - -' + ","  ' \":method :url HTTP/:http-version\"' + ","  ' :status :content-length \":referrer\"' + ","  ' \":user-agent\"';","/**"," * Log requests with the given `options` or a `format` string."," *"," * Options:"," *"," *   - `format`        Format string, see below for tokens"," *   - `level`         A log4js levels instance. Supports also 'auto'"," *"," * Tokens:"," *"," *   - `:req[header]` ex: `:req[Accept]`"," *   - `:res[header]` ex: `:res[Content-Length]`"," *   - `:http-version`"," *   - `:response-time`"," *   - `:remote-addr`"," *   - `:date`"," *   - `:method`"," *   - `:url`"," *   - `:referrer`"," *   - `:user-agent`"," *   - `:status`"," *"," * @param {String|Function|Object} format or options"," * @return {Function}"," * @api public"," */","","function getLogger(logger4js, options) {","\tif ('object' == typeof options) {","\t\toptions = options || {};","\t} else if (options) {","\t\toptions = { format: options };","\t} else {","\t\toptions = {};","\t}","","\tvar thislogger = logger4js","  , level = levels.toLevel(options.level, levels.INFO)","  , fmt = options.format || DEFAULT_FORMAT","  , nolog = options.nolog ? createNoLogCondition(options.nolog) : null;","","  return function (req, res, next) {","    // mount safety","    if (req._logging) return next();","","\t\t// nologs","\t\tif (nolog && nolog.test(req.originalUrl)) return next();","\t\tif (thislogger.isLevelEnabled(level) || options.level === 'auto') {","      ","\t\t\tvar start = new Date()","\t\t\t, statusCode","\t\t\t, writeHead = res.writeHead","\t\t\t, end = res.end","\t\t\t, url = req.originalUrl;","","\t\t\t// flag as logging","\t\t\treq._logging = true;","      ","\t\t\t// proxy for statusCode.","\t\t\tres.writeHead = function(code, headers){","\t\t\t\tres.writeHead = writeHead;","\t\t\t\tres.writeHead(code, headers);","\t\t\t\tres.__statusCode = statusCode = code;","\t\t\t\tres.__headers = headers || {};","","\t\t\t\t//status code response level handling","\t\t\t\tif(options.level === 'auto'){","\t\t\t\t\tlevel = levels.INFO;","\t\t\t\t\tif(code >= 300) level = levels.WARN;","\t\t\t\t\tif(code >= 400) level = levels.ERROR;","\t\t\t\t} else {","\t\t\t\t\tlevel = levels.toLevel(options.level, levels.INFO);","\t\t\t\t}","\t\t\t};","      ","\t\t\t// proxy end to output a line to the provided logger.","\t\t\tres.end = function(chunk, encoding) {","\t\t\t\tres.end = end;","\t\t\t\tres.end(chunk, encoding);","\t\t\t\tres.responseTime = new Date() - start;","\t\t\t\tif (thislogger.isLevelEnabled(level)) {","\t\t\t\t\tif (typeof fmt === 'function') {","\t\t\t\t\t\tvar line = fmt(req, res, function(str){ return format(str, req, res); });","\t\t\t\t\t\tif (line) thislogger.log(level, line);","\t\t\t\t\t} else {","\t\t\t\t\t\tthislogger.log(level, format(fmt, req, res));","\t\t\t\t\t}","\t\t\t\t}","\t\t\t};","\t\t}","    ","    //ensure next gets always called","    next();","  };","}","","/**"," * Return formatted log line."," *"," * @param  {String} str"," * @param  {IncomingMessage} req"," * @param  {ServerResponse} res"," * @return {String}"," * @api private"," */","","function format(str, req, res) {","\treturn str","    .replace(':url', req.originalUrl)","    .replace(':method', req.method)","    .replace(':status', res.__statusCode || res.statusCode)","    .replace(':response-time', res.responseTime)","    .replace(':date', new Date().toUTCString())","    .replace(':referrer', req.headers.referer || req.headers.referrer || '')","    .replace(':http-version', req.httpVersionMajor + '.' + req.httpVersionMinor)","    .replace(","      ':remote-addr', ","      req.socket && ","        (req.socket.remoteAddress || (req.socket.socket && req.socket.socket.remoteAddress))","    )","    .replace(':user-agent', req.headers['user-agent'] || '')","    .replace(","      ':content-length', ","      (res._headers && res._headers['content-length']) || ","        (res.__headers && res.__headers['Content-Length']) || ","        '-'","    )","    .replace(/:req\\[([^\\]]+)\\]/g, function(_, field){ return req.headers[field.toLowerCase()]; })","    .replace(/:res\\[([^\\]]+)\\]/g, function(_, field){","      return res._headers ? ","        (res._headers[field.toLowerCase()] || res.__headers[field])","        : (res.__headers && res.__headers[field]);","    });","}","","/**"," * Return RegExp Object about nolog"," *"," * @param  {String} nolog"," * @return {RegExp}"," * @api private"," *"," * syntax"," *  1. String"," *   1.1 \"\\\\.gif\""," *         NOT LOGGING http://example.com/hoge.gif and http://example.com/hoge.gif?fuga"," *         LOGGING http://example.com/hoge.agif"," *   1.2 in \"\\\\.gif|\\\\.jpg$\""," *         NOT LOGGING http://example.com/hoge.gif and "," *           http://example.com/hoge.gif?fuga and http://example.com/hoge.jpg?fuga"," *         LOGGING http://example.com/hoge.agif, "," *           http://example.com/hoge.ajpg and http://example.com/hoge.jpg?hoge"," *   1.3 in \"\\\\.(gif|jpe?g|png)$\""," *         NOT LOGGING http://example.com/hoge.gif and http://example.com/hoge.jpeg"," *         LOGGING http://example.com/hoge.gif?uid=2 and http://example.com/hoge.jpg?pid=3"," *  2. RegExp"," *   2.1 in /\\.(gif|jpe?g|png)$/"," *         SAME AS 1.3"," *  3. Array"," *   3.1 [\"\\\\.jpg$\", \"\\\\.png\", \"\\\\.gif\"]"," *         SAME AS \"\\\\.jpg|\\\\.png|\\\\.gif\""," */","function createNoLogCondition(nolog) {","  var regexp = null;","","\tif (nolog) {","    if (nolog instanceof RegExp) {","      regexp = nolog;","    } ","    ","    if (typeof nolog === 'string') {","      regexp = new RegExp(nolog);","    }","    ","    if (Array.isArray(nolog)) {","      var regexpsAsStrings = nolog.map(","        function convertToStrings(o) { ","          return o.source ? o.source : o;","        }","      );","      regexp = new RegExp(regexpsAsStrings.join('|'));","    }","  }","","  return regexp;","}","","exports.connectLogger = getLogger;",""],"l":{"2":1,"3":1,"34":1,"35":0,"36":0,"37":0,"38":0,"40":0,"43":0,"48":0,"50":0,"53":0,"54":0,"56":0,"63":0,"66":0,"67":0,"68":0,"69":0,"70":0,"73":0,"74":0,"75":0,"76":0,"78":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"92":0,"99":0,"113":1,"114":0,"134":0,"136":0,"169":1,"170":0,"172":0,"173":0,"174":0,"177":0,"178":0,"181":0,"182":0,"184":0,"187":0,"191":0,"194":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/appenders/console.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/node_modules/log4js/lib/appenders/console.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1},"b":{"1":[1,1],"2":[0,1]},"f":{"1":1,"2":0,"3":1},"fnMap":{"1":{"name":"consoleAppender","line":5,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":34}}},"2":{"name":"(anonymous_2)","line":7,"loc":{"start":{"line":7,"column":9},"end":{"line":7,"column":32}}},"3":{"name":"configure","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":27}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":3,"column":41}},"2":{"start":{"line":5,"column":0},"end":{"line":10,"column":1}},"3":{"start":{"line":6,"column":2},"end":{"line":6,"column":44}},"4":{"start":{"line":7,"column":2},"end":{"line":9,"column":4}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":37}},"6":{"start":{"line":12,"column":0},"end":{"line":18,"column":1}},"7":{"start":{"line":13,"column":2},"end":{"line":13,"column":13}},"8":{"start":{"line":14,"column":2},"end":{"line":16,"column":3}},"9":{"start":{"line":15,"column":4},"end":{"line":15,"column":63}},"10":{"start":{"line":17,"column":2},"end":{"line":17,"column":33}},"11":{"start":{"line":20,"column":0},"end":{"line":20,"column":35}},"12":{"start":{"line":21,"column":0},"end":{"line":21,"column":30}}},"branchMap":{"1":{"line":6,"type":"binary-expr","locations":[{"start":{"line":6,"column":11},"end":{"line":6,"column":17}},{"start":{"line":6,"column":21},"end":{"line":6,"column":43}}]},"2":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":2},"end":{"line":14,"column":2}},{"start":{"line":14,"column":2},"end":{"line":14,"column":2}}]}},"code":["\"use strict\";","var layouts = require('../layouts')",", consoleLog = console.log.bind(console);","","function consoleAppender (layout) {","  layout = layout || layouts.colouredLayout;","  return function(loggingEvent) {","    consoleLog(layout(loggingEvent));","  };","}","","function configure(config) {","  var layout;","  if (config.layout) {","    layout = layouts.layout(config.layout.type, config.layout);","  }","  return consoleAppender(layout);","}","","exports.appender = consoleAppender;","exports.configure = configure;",""],"l":{"2":1,"5":1,"6":1,"7":1,"8":0,"12":1,"13":1,"14":1,"15":0,"17":1,"20":1,"21":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/simpleTrigger.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-scheduler/lib/simpleTrigger.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1,"8":1,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":20},"end":{"line":9,"column":42}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":17},"end":{"line":26,"column":27}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":21},"end":{"line":34,"column":31}}},"4":{"name":"createTrigger","line":52,"loc":{"start":{"line":52,"column":0},"end":{"line":52,"column":36}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":25}},"2":{"start":{"line":9,"column":0},"end":{"line":19,"column":2}},"3":{"start":{"line":10,"column":2},"end":{"line":10,"column":61}},"4":{"start":{"line":13,"column":2},"end":{"line":13,"column":53}},"5":{"start":{"line":16,"column":2},"end":{"line":16,"column":50}},"6":{"start":{"line":18,"column":2},"end":{"line":18,"column":17}},"7":{"start":{"line":21,"column":0},"end":{"line":21,"column":34}},"8":{"start":{"line":26,"column":0},"end":{"line":28,"column":2}},"9":{"start":{"line":27,"column":2},"end":{"line":27,"column":23}},"10":{"start":{"line":34,"column":0},"end":{"line":47,"column":2}},"11":{"start":{"line":35,"column":2},"end":{"line":35,"column":27}},"12":{"start":{"line":37,"column":2},"end":{"line":38,"column":16}},"13":{"start":{"line":38,"column":4},"end":{"line":38,"column":16}},"14":{"start":{"line":40,"column":2},"end":{"line":40,"column":26}},"15":{"start":{"line":42,"column":2},"end":{"line":44,"column":3}},"16":{"start":{"line":43,"column":4},"end":{"line":43,"column":76}},"17":{"start":{"line":46,"column":2},"end":{"line":46,"column":23}},"18":{"start":{"line":52,"column":0},"end":{"line":54,"column":1}},"19":{"start":{"line":53,"column":2},"end":{"line":53,"column":41}},"20":{"start":{"line":56,"column":0},"end":{"line":56,"column":45}}},"branchMap":{"1":{"line":10,"type":"cond-expr","locations":[{"start":{"line":10,"column":36},"end":{"line":10,"column":49}},{"start":{"line":10,"column":50},"end":{"line":10,"column":60}}]},"2":{"line":13,"type":"cond-expr","locations":[{"start":{"line":13,"column":35},"end":{"line":13,"column":49}},{"start":{"line":13,"column":50},"end":{"line":13,"column":52}}]},"3":{"line":16,"type":"cond-expr","locations":[{"start":{"line":16,"column":33},"end":{"line":16,"column":46}},{"start":{"line":16,"column":47},"end":{"line":16,"column":49}}]},"4":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":2}},{"start":{"line":37,"column":2},"end":{"line":37,"column":2}}]},"5":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":6},"end":{"line":37,"column":20}},{"start":{"line":37,"column":24},"end":{"line":37,"column":54}},{"start":{"line":37,"column":59},"end":{"line":37,"column":70}}]},"6":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":2},"end":{"line":42,"column":2}},{"start":{"line":42,"column":2},"end":{"line":42,"column":2}}]},"7":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":5},"end":{"line":42,"column":17}},{"start":{"line":42,"column":21},"end":{"line":42,"column":47}}]}},"code":["/**"," * This is the tirgger that use an object as trigger."," */","var SKIP_OLD_JOB = false;","","/**"," * The constructor of simple trigger"," */","var SimpleTrigger = function(trigger, job){","  this.nextTime = (!!trigger.start)?trigger.start:Date.now();","","  //The rec","  this.period = (!!trigger.period)?trigger.period:-1;","","  //The running count of the job, -1 means no limit","  this.count = (!!trigger.count)?trigger.count:-1;","","  this.job = job;","};","","var pro = SimpleTrigger.prototype;","","/**"," * Get the current excuteTime of rigger"," */","pro.excuteTime = function(){","  return this.nextTime;","};","","/**"," * Get the next excuteTime of the trigger, and set the trigger's excuteTime"," * @return Next excute time"," */","pro.nextExcuteTime = function(){","  var period = this.period;","","  if((this.count > 0 && this.count <= this.job.runTime) || period <= 0)","    return null;","","  this.nextTime += period;","","  if(SKIP_OLD_JOB && this.nextTime < Date.now()){","    this.nextTime += Math.floor((Date.now()-this.nextTime)/period) * period;","  }","","  return this.nextTime;","};","","/**"," * Create Simple trigger"," */","function createTrigger(trigger, job){","  return new SimpleTrigger(trigger, job);","}","","module.exports.createTrigger = createTrigger;"],"l":{"4":1,"9":1,"10":0,"13":0,"16":0,"18":0,"21":1,"26":1,"27":0,"34":1,"35":0,"37":0,"38":0,"40":0,"42":0,"43":0,"46":0,"52":1,"53":0,"56":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/filterService.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/filterService.js","s":{"1":1,"2":1,"3":0,"4":0,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":14},"end":{"line":7,"column":25}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":27},"end":{"line":21,"column":43}}},"3":{"name":"(anonymous_3)","line":30,"loc":{"start":{"line":30,"column":26},"end":{"line":30,"column":42}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":33},"end":{"line":46,"column":60}}},"5":{"name":"(anonymous_5)","line":48,"loc":{"start":{"line":48,"column":13},"end":{"line":48,"column":39}}},"6":{"name":"(anonymous_6)","line":79,"loc":{"start":{"line":79,"column":32},"end":{"line":79,"column":70}}},"7":{"name":"next","line":81,"loc":{"start":{"line":81,"column":2},"end":{"line":81,"column":21}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":70}},"2":{"start":{"line":7,"column":0},"end":{"line":10,"column":2}},"3":{"start":{"line":8,"column":2},"end":{"line":8,"column":20}},"4":{"start":{"line":9,"column":2},"end":{"line":9,"column":19}},"5":{"start":{"line":12,"column":0},"end":{"line":12,"column":25}},"6":{"start":{"line":14,"column":0},"end":{"line":14,"column":34}},"7":{"start":{"line":21,"column":0},"end":{"line":23,"column":2}},"8":{"start":{"line":22,"column":2},"end":{"line":22,"column":28}},"9":{"start":{"line":30,"column":0},"end":{"line":32,"column":2}},"10":{"start":{"line":31,"column":2},"end":{"line":31,"column":30}},"11":{"start":{"line":46,"column":0},"end":{"line":66,"column":2}},"12":{"start":{"line":47,"column":2},"end":{"line":47,"column":29}},"13":{"start":{"line":48,"column":2},"end":{"line":63,"column":4}},"14":{"start":{"line":49,"column":4},"end":{"line":52,"column":5}},"15":{"start":{"line":50,"column":6},"end":{"line":50,"column":26}},"16":{"start":{"line":51,"column":6},"end":{"line":51,"column":13}},"17":{"start":{"line":54,"column":4},"end":{"line":54,"column":40}},"18":{"start":{"line":55,"column":4},"end":{"line":62,"column":5}},"19":{"start":{"line":56,"column":6},"end":{"line":56,"column":34}},"20":{"start":{"line":57,"column":11},"end":{"line":62,"column":5}},"21":{"start":{"line":58,"column":6},"end":{"line":58,"column":41}},"22":{"start":{"line":60,"column":6},"end":{"line":60,"column":96}},"23":{"start":{"line":61,"column":6},"end":{"line":61,"column":48}},"24":{"start":{"line":65,"column":2},"end":{"line":65,"column":9}},"25":{"start":{"line":79,"column":0},"end":{"line":100,"column":2}},"26":{"start":{"line":80,"column":2},"end":{"line":80,"column":29}},"27":{"start":{"line":81,"column":2},"end":{"line":97,"column":3}},"28":{"start":{"line":83,"column":4},"end":{"line":86,"column":5}},"29":{"start":{"line":84,"column":6},"end":{"line":84,"column":14}},"30":{"start":{"line":85,"column":6},"end":{"line":85,"column":13}},"31":{"start":{"line":88,"column":4},"end":{"line":88,"column":39}},"32":{"start":{"line":89,"column":4},"end":{"line":96,"column":5}},"33":{"start":{"line":90,"column":6},"end":{"line":90,"column":45}},"34":{"start":{"line":91,"column":11},"end":{"line":96,"column":5}},"35":{"start":{"line":92,"column":6},"end":{"line":92,"column":51}},"36":{"start":{"line":94,"column":6},"end":{"line":94,"column":94}},"37":{"start":{"line":95,"column":6},"end":{"line":95,"column":47}},"38":{"start":{"line":99,"column":2},"end":{"line":99,"column":12}}},"branchMap":{"1":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":49,"column":4}},{"start":{"line":49,"column":4},"end":{"line":49,"column":4}}]},"2":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":7},"end":{"line":49,"column":10}},{"start":{"line":49,"column":14},"end":{"line":49,"column":42}}]},"3":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":55,"column":4}},{"start":{"line":55,"column":4},"end":{"line":55,"column":4}}]},"4":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":11},"end":{"line":57,"column":11}},{"start":{"line":57,"column":11},"end":{"line":57,"column":11}}]},"5":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":4},"end":{"line":83,"column":4}},{"start":{"line":83,"column":4},"end":{"line":83,"column":4}}]},"6":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":4},"end":{"line":89,"column":4}},{"start":{"line":89,"column":4},"end":{"line":89,"column":4}}]},"7":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":11},"end":{"line":91,"column":11}},{"start":{"line":91,"column":11},"end":{"line":91,"column":11}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","/**"," * Filter service."," * Register and fire before and after filters."," */","var Service = function() {","  this.befores = [];    // before filters","  this.afters = [];     // after filters","};","","module.exports = Service;","","Service.prototype.name = 'filter';","","/**"," * Add before filter into the filter chain."," *"," * @param filter {Object|Function} filter instance or filter function."," */","Service.prototype.before = function(filter){","  this.befores.push(filter);","};","","/**"," * Add after filter into the filter chain."," *"," * @param filter {Object|Function} filter instance or filter function."," */","Service.prototype.after = function(filter){","  this.afters.unshift(filter);","};","","/**"," * TODO: other insert method for filter? such as unshift"," */","","/**"," * Do the before filter."," * Fail over if any filter pass err parameter to the next function."," *"," * @param msg {Object} clienet request msg"," * @param session {Object} a session object for current request"," * @param cb {Function} cb(err) callback function to invoke next chain node"," */","Service.prototype.beforeFilter = function(msg, session, cb) {","  var index = 0, self = this;","  var next = function(err, resp, opts) {","    if(err || index >= self.befores.length) {","      cb(err, resp, opts);","      return;","    }","","    var handler = self.befores[index++];","    if(typeof handler === 'function') {","      handler(msg, session, next);","    } else if(typeof handler.before === 'function') {","      handler.before(msg, session, next);","    } else {","      logger.error('meet invalid before filter, handler or handler.before should be function.');","      next(new Error('invalid before filter.'));","    }","  }; //end of next","","  next();","};","","/**"," * Do after filter chain."," * Give server a chance to do clean up jobs after request responsed."," * After filter can not change the request flow before."," * After filter should call the next callback to let the request pass to next after filter."," *"," * @param err {Object} error object"," * @param session {Object} session object for current request"," * @param {Object} resp response object send to client"," * @param cb {Function} cb(err) callback function to invoke next chain node"," */","Service.prototype.afterFilter = function(err, msg, session, resp, cb) {","  var index = 0, self = this;","  function next(err) {","    //if done","    if(index >= self.afters.length) {","      cb(err);","      return;","    }","","    var handler = self.afters[index++];","    if(typeof handler === 'function') {","      handler(err, msg, session, resp, next);","    } else if(typeof handler.after === 'function') {","      handler.after(err, msg, session, resp, next);","    } else {","      logger.error('meet invalid after filter, handler or handler.after should be function.');","      next(new Error('invalid after filter.'));","    }","  } //end of next","","  next(err);","};",""],"l":{"1":1,"7":1,"8":0,"9":0,"12":1,"14":1,"21":1,"22":0,"30":1,"31":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"54":0,"55":0,"56":0,"57":0,"58":0,"60":0,"61":0,"65":0,"79":1,"80":0,"81":1,"83":0,"84":0,"85":0,"88":0,"89":0,"90":0,"91":0,"92":0,"94":0,"95":0,"99":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/handlerService.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/handlerService.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":1,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":14},"end":{"line":13,"column":34}}},"2":{"name":"(anonymous_2)","line":30,"loc":{"start":{"line":30,"column":27},"end":{"line":30,"column":67}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":17},"end":{"line":41,"column":43}}},"4":{"name":"(anonymous_4)","line":75,"loc":{"start":{"line":75,"column":31},"end":{"line":75,"column":53}}},"5":{"name":"(anonymous_5)","line":96,"loc":{"start":{"line":96,"column":19},"end":{"line":96,"column":57}}},"6":{"name":"(anonymous_6)","line":103,"loc":{"start":{"line":103,"column":20},"end":{"line":103,"column":46}}},"7":{"name":"(anonymous_7)","line":106,"loc":{"start":{"line":106,"column":16},"end":{"line":106,"column":38}}},"8":{"name":"(anonymous_8)","line":114,"loc":{"start":{"line":114,"column":14},"end":{"line":114,"column":29}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":23}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":38}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":46}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":70}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":82}},"7":{"start":{"line":13,"column":0},"end":{"line":21,"column":2}},"8":{"start":{"line":14,"column":2},"end":{"line":14,"column":17}},"9":{"start":{"line":15,"column":2},"end":{"line":15,"column":23}},"10":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"11":{"start":{"line":17,"column":4},"end":{"line":17,"column":40}},"12":{"start":{"line":20,"column":2},"end":{"line":20,"column":57}},"13":{"start":{"line":23,"column":0},"end":{"line":23,"column":25}},"14":{"start":{"line":25,"column":0},"end":{"line":25,"column":35}},"15":{"start":{"line":30,"column":0},"end":{"line":66,"column":2}},"16":{"start":{"line":32,"column":2},"end":{"line":32,"column":45}},"17":{"start":{"line":33,"column":2},"end":{"line":37,"column":3}},"18":{"start":{"line":34,"column":4},"end":{"line":34,"column":80}},"19":{"start":{"line":35,"column":4},"end":{"line":35,"column":85}},"20":{"start":{"line":36,"column":4},"end":{"line":36,"column":11}},"21":{"start":{"line":38,"column":2},"end":{"line":38,"column":25}},"22":{"start":{"line":39,"column":2},"end":{"line":39,"column":18}},"23":{"start":{"line":41,"column":2},"end":{"line":54,"column":3}},"24":{"start":{"line":42,"column":4},"end":{"line":50,"column":5}},"25":{"start":{"line":43,"column":6},"end":{"line":48,"column":8}},"26":{"start":{"line":49,"column":6},"end":{"line":49,"column":46}},"27":{"start":{"line":53,"column":4},"end":{"line":53,"column":46}},"28":{"start":{"line":56,"column":2},"end":{"line":56,"column":34}},"29":{"start":{"line":58,"column":2},"end":{"line":64,"column":3}},"30":{"start":{"line":59,"column":4},"end":{"line":59,"column":44}},"31":{"start":{"line":61,"column":4},"end":{"line":61,"column":22}},"32":{"start":{"line":62,"column":4},"end":{"line":62,"column":23}},"33":{"start":{"line":63,"column":4},"end":{"line":63,"column":40}},"34":{"start":{"line":65,"column":2},"end":{"line":65,"column":9}},"35":{"start":{"line":75,"column":0},"end":{"line":91,"column":2}},"36":{"start":{"line":76,"column":2},"end":{"line":76,"column":42}},"37":{"start":{"line":77,"column":2},"end":{"line":79,"column":3}},"38":{"start":{"line":78,"column":4},"end":{"line":78,"column":56}},"39":{"start":{"line":80,"column":2},"end":{"line":80,"column":51}},"40":{"start":{"line":81,"column":2},"end":{"line":81,"column":46}},"41":{"start":{"line":82,"column":2},"end":{"line":85,"column":3}},"42":{"start":{"line":83,"column":4},"end":{"line":83,"column":75}},"43":{"start":{"line":84,"column":4},"end":{"line":84,"column":16}},"44":{"start":{"line":86,"column":2},"end":{"line":89,"column":3}},"45":{"start":{"line":87,"column":4},"end":{"line":87,"column":104}},"46":{"start":{"line":88,"column":4},"end":{"line":88,"column":16}},"47":{"start":{"line":90,"column":2},"end":{"line":90,"column":17}},"48":{"start":{"line":96,"column":0},"end":{"line":101,"column":2}},"49":{"start":{"line":97,"column":2},"end":{"line":97,"column":61}},"50":{"start":{"line":98,"column":2},"end":{"line":100,"column":3}},"51":{"start":{"line":99,"column":4},"end":{"line":99,"column":49}},"52":{"start":{"line":103,"column":0},"end":{"line":112,"column":2}},"53":{"start":{"line":104,"column":2},"end":{"line":104,"column":65}},"54":{"start":{"line":105,"column":2},"end":{"line":111,"column":3}},"55":{"start":{"line":106,"column":4},"end":{"line":110,"column":7}},"56":{"start":{"line":107,"column":6},"end":{"line":109,"column":7}},"57":{"start":{"line":108,"column":8},"end":{"line":108,"column":57}},"58":{"start":{"line":114,"column":0},"end":{"line":138,"column":1}},"59":{"start":{"line":115,"column":2},"end":{"line":115,"column":24}},"60":{"start":{"line":116,"column":2},"end":{"line":118,"column":3}},"61":{"start":{"line":117,"column":4},"end":{"line":117,"column":14}},"62":{"start":{"line":120,"column":2},"end":{"line":122,"column":3}},"63":{"start":{"line":121,"column":4},"end":{"line":121,"column":21}},"64":{"start":{"line":124,"column":2},"end":{"line":126,"column":3}},"65":{"start":{"line":125,"column":4},"end":{"line":125,"column":30}},"66":{"start":{"line":128,"column":2},"end":{"line":130,"column":3}},"67":{"start":{"line":129,"column":4},"end":{"line":129,"column":39}},"68":{"start":{"line":132,"column":2},"end":{"line":132,"column":25}},"69":{"start":{"line":133,"column":2},"end":{"line":135,"column":3}},"70":{"start":{"line":134,"column":4},"end":{"line":134,"column":19}},"71":{"start":{"line":137,"column":2},"end":{"line":137,"column":11}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":16,"column":2}},{"start":{"line":16,"column":2},"end":{"line":16,"column":2}}]},"2":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":26},"end":{"line":20,"column":47}},{"start":{"line":20,"column":51},"end":{"line":20,"column":56}}]},"3":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":2},"end":{"line":33,"column":2}},{"start":{"line":33,"column":2},"end":{"line":33,"column":2}}]},"4":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]},"5":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":58,"column":2}},{"start":{"line":58,"column":2},"end":{"line":58,"column":2}}]},"6":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":2},"end":{"line":77,"column":2}},{"start":{"line":77,"column":2},"end":{"line":77,"column":2}}]},"7":{"line":80,"type":"binary-expr","locations":[{"start":{"line":80,"column":17},"end":{"line":80,"column":44}},{"start":{"line":80,"column":48},"end":{"line":80,"column":50}}]},"8":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":2},"end":{"line":82,"column":2}},{"start":{"line":82,"column":2},"end":{"line":82,"column":2}}]},"9":{"line":86,"type":"if","locations":[{"start":{"line":86,"column":2},"end":{"line":86,"column":2}},{"start":{"line":86,"column":2},"end":{"line":86,"column":2}}]},"10":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":2},"end":{"line":98,"column":2}},{"start":{"line":98,"column":2},"end":{"line":98,"column":2}}]},"11":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"12":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":6},"end":{"line":107,"column":6}},{"start":{"line":107,"column":6},"end":{"line":107,"column":6}}]},"13":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":2},"end":{"line":116,"column":2}},{"start":{"line":116,"column":2},"end":{"line":116,"column":2}}]},"14":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":2},"end":{"line":120,"column":2}},{"start":{"line":120,"column":2},"end":{"line":120,"column":2}}]},"15":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":2},"end":{"line":124,"column":2}},{"start":{"line":124,"column":2},"end":{"line":124,"column":2}}]},"16":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":2},"end":{"line":128,"column":2}},{"start":{"line":128,"column":2},"end":{"line":128,"column":2}}]}},"code":["var fs = require('fs');","var utils = require('../../util/utils');","var Loader = require('pomelo-loader');","var pathUtil = require('../../util/pathUtil');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var forwardLogger = require('pomelo-logger').getLogger('forward-log', __filename);","/**"," * Handler service."," * Dispatch request to the relactive handler."," *"," * @param {Object} app      current application context"," */","var Service = function(app, opts) {","  this.app = app;","  this.handlerMap = {};","  if(!!opts.reloadHandlers) {","    watchHandlers(app, this.handlerMap);","  }","","  this.enableForwardLog = opts.enableForwardLog || false;","};","","module.exports = Service;","","Service.prototype.name = 'handler';","","/**"," * Handler the request."," */","Service.prototype.handle = function(routeRecord, msg, session, cb) {","  // the request should be processed by current server","  var handler = this.getHandler(routeRecord);","  if(!handler) {","    logger.error('[handleManager]: fail to find handler for %j', msg.__route__);","    utils.invokeCallback(cb, new Error('fail to find handler for ' + msg.__route__));","    return;","  }","  var start = Date.now();","  var self = this;","","  var callback = function(err, resp, opts) {","    if(self.enableForwardLog) {","      var log = {","        route : msg.__route__,","        args : msg,","        time : utils.format(new Date(start)),","        timeUsed : new Date() - start","      };","      forwardLogger.info(JSON.stringify(log));","    }","","    // resp = getResp(arguments);","    utils.invokeCallback(cb, err, resp, opts);","  }","","  var method = routeRecord.method;","","  if(!Array.isArray(msg)) {","    handler[method](msg, session, callback);","  } else {","    msg.push(session);","    msg.push(callback);","    handler[method].apply(handler, msg);","  }","  return;","};","","/**"," * Get handler instance by routeRecord."," *"," * @param  {Object} handlers    handler map"," * @param  {Object} routeRecord route record parsed from route string"," * @return {Object}             handler instance if any matchs or null for match fail"," */","Service.prototype.getHandler = function(routeRecord) {","  var serverType = routeRecord.serverType;","  if(!this.handlerMap[serverType]) {","    loadHandlers(this.app, serverType, this.handlerMap);","  }","  var handlers = this.handlerMap[serverType] || {};","  var handler = handlers[routeRecord.handler];","  if(!handler) {","    logger.warn('could not find handler for routeRecord: %j', routeRecord);","    return null;","  }","  if(typeof handler[routeRecord.method] !== 'function') {","    logger.warn('could not find the method %s in handler: %s', routeRecord.method, routeRecord.handler);","    return null;","  }","  return handler;","};","","/**"," * Load handlers from current application"," */","var loadHandlers = function(app, serverType, handlerMap) {","  var p = pathUtil.getHandlerPath(app.getBase(), serverType);","  if(p) {","    handlerMap[serverType] = Loader.load(p, app);","  }","};","","var watchHandlers = function(app, handlerMap) {","  var p = pathUtil.getHandlerPath(app.getBase(), app.serverType);","  if (!!p){","    fs.watch(p, function(event, name) {","      if(event === 'change') {","        handlerMap[app.serverType] = Loader.load(p, app);","      }","    });","  }","};","","var getResp = function(args) {","  var len = args.length;","  if(len == 1) {","    return [];","  }","","  if(len == 2) {","    return [args[1]];","  }","","  if(len == 3) {","    return [args[1], args[2]];","  }","","  if(len == 4) {","    return [args[1], args[2], args[3]];","  }","","  var r = new Array(len);","  for (var i = 1; i < len; i++) {","    r[i] = args[i];","  }","","  return r;","}"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"13":1,"14":0,"15":0,"16":0,"17":0,"20":0,"23":1,"25":1,"30":1,"32":0,"33":0,"34":0,"35":0,"36":0,"38":0,"39":0,"41":0,"42":0,"43":0,"49":0,"53":0,"56":0,"58":0,"59":0,"61":0,"62":0,"63":0,"65":0,"75":1,"76":0,"77":0,"78":0,"80":0,"81":0,"82":0,"83":0,"84":0,"86":0,"87":0,"88":0,"90":0,"96":1,"97":0,"98":0,"99":0,"103":1,"104":0,"105":0,"106":0,"107":0,"108":0,"114":1,"115":0,"116":0,"117":0,"120":0,"121":0,"124":0,"125":0,"128":0,"129":0,"132":0,"133":0,"134":0,"137":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/session.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/components/session.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":17},"end":{"line":3,"column":37}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":16},"end":{"line":15,"column":36}}},"3":{"name":"(anonymous_3)","line":20,"loc":{"start":{"line":20,"column":15},"end":{"line":20,"column":27}}},"4":{"name":"(anonymous_4)","line":21,"loc":{"start":{"line":21,"column":12},"end":{"line":21,"column":23}}},"5":{"name":"(anonymous_5)","line":22,"loc":{"start":{"line":22,"column":17},"end":{"line":22,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":65}},"2":{"start":{"line":3,"column":0},"end":{"line":7,"column":2}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":37}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":39}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":13}},"6":{"start":{"line":15,"column":0},"end":{"line":37,"column":2}},"7":{"start":{"line":16,"column":2},"end":{"line":16,"column":20}},"8":{"start":{"line":17,"column":2},"end":{"line":17,"column":17}},"9":{"start":{"line":18,"column":2},"end":{"line":18,"column":42}},"10":{"start":{"line":20,"column":2},"end":{"line":26,"column":4}},"11":{"start":{"line":21,"column":4},"end":{"line":25,"column":9}},"12":{"start":{"line":22,"column":10},"end":{"line":24,"column":12}},"13":{"start":{"line":23,"column":12},"end":{"line":23,"column":66}},"14":{"start":{"line":28,"column":2},"end":{"line":28,"column":26}},"15":{"start":{"line":29,"column":2},"end":{"line":36,"column":3}},"16":{"start":{"line":30,"column":4},"end":{"line":35,"column":5}},"17":{"start":{"line":31,"column":6},"end":{"line":31,"column":31}},"18":{"start":{"line":32,"column":6},"end":{"line":34,"column":7}},"19":{"start":{"line":33,"column":8},"end":{"line":33,"column":28}},"20":{"start":{"line":39,"column":0},"end":{"line":39,"column":41}}},"branchMap":{"1":{"line":16,"type":"binary-expr","locations":[{"start":{"line":16,"column":9},"end":{"line":16,"column":13}},{"start":{"line":16,"column":17},"end":{"line":16,"column":19}}]},"2":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":4},"end":{"line":30,"column":4}},{"start":{"line":30,"column":4},"end":{"line":30,"column":4}}]},"3":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":7},"end":{"line":30,"column":20}},{"start":{"line":30,"column":24},"end":{"line":30,"column":36}}]},"4":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":6},"end":{"line":32,"column":6}},{"start":{"line":32,"column":6},"end":{"line":32,"column":6}}]}},"code":["var SessionService = require('../common/service/sessionService');","","module.exports = function(app, opts) {","  var cmp = new Component(app, opts);","  app.set('sessionService', cmp, true);","  return cmp;","};","","/**"," * Session component. Manage sessions."," *"," * @param {Object} app  current application context"," * @param {Object} opts attach parameters"," */","var Component = function(app, opts) {","  opts = opts || {};","  this.app = app;","  this.service = new SessionService(opts);","","  var getFun = function(m) {","    return (function() {","          return function() {","            return self.service[m].apply(self.service, arguments);","          };","    })();","  };","  // proxy the service methods except the lifecycle interfaces of component","  var method, self = this;","  for(var m in this.service) {","    if(m !== 'start' && m !== 'stop') {","      method = this.service[m];","      if(typeof method === 'function') {","        this[m] = getFun(m);","      }","    }","  }","};","","Component.prototype.name = '__session__';",""],"l":{"1":1,"3":1,"4":0,"5":0,"6":0,"15":1,"16":0,"17":0,"18":0,"20":0,"21":0,"22":0,"23":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"39":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/sessionService.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/common/service/sessionService.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":1,"70":0,"71":1,"72":0,"73":1,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":1,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":1,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":1,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":1,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":1,"130":0,"131":0,"132":0,"133":0,"134":0,"135":1,"136":0,"137":0,"138":0,"139":0,"140":0,"141":1,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":1,"149":0,"150":0,"151":1,"152":0,"153":0,"154":0,"155":0,"156":0,"157":1,"158":0,"159":1,"160":0,"161":0,"162":1,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":1,"172":1,"173":0,"174":1,"175":0,"176":0,"177":1,"178":0,"179":0,"180":1,"181":0,"182":0,"183":0,"184":0,"185":1,"186":0,"187":1,"188":0,"189":1,"190":0,"191":1,"192":0,"193":1,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":1,"205":0,"206":0,"207":0,"208":0,"209":1,"210":1,"211":0,"212":0,"213":0,"214":0,"215":0,"216":1,"217":0,"218":0,"219":0,"220":0,"221":0,"222":1,"223":0,"224":1,"225":0,"226":1,"227":0,"228":1,"229":0,"230":1,"231":0,"232":0,"233":1,"234":0,"235":0,"236":0,"237":1,"238":0,"239":0,"240":0,"241":0,"242":1,"243":0,"244":0,"245":0,"246":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0},"fnMap":{"1":{"name":"(anonymous_1)","line":23,"loc":{"start":{"line":23,"column":21},"end":{"line":23,"column":36}}},"2":{"name":"(anonymous_2)","line":44,"loc":{"start":{"line":44,"column":34},"end":{"line":44,"column":68}}},"3":{"name":"(anonymous_3)","line":57,"loc":{"start":{"line":57,"column":32},"end":{"line":57,"column":55}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":21},"end":{"line":61,"column":32}}},"5":{"name":"(anonymous_5)","line":75,"loc":{"start":{"line":75,"column":21},"end":{"line":75,"column":32}}},"6":{"name":"(anonymous_6)","line":84,"loc":{"start":{"line":84,"column":21},"end":{"line":84,"column":32}}},"7":{"name":"(anonymous_7)","line":116,"loc":{"start":{"line":116,"column":34},"end":{"line":116,"column":57}}},"8":{"name":"(anonymous_8)","line":120,"loc":{"start":{"line":120,"column":21},"end":{"line":120,"column":32}}},"9":{"name":"(anonymous_9)","line":127,"loc":{"start":{"line":127,"column":21},"end":{"line":127,"column":32}}},"10":{"name":"(anonymous_10)","line":163,"loc":{"start":{"line":163,"column":31},"end":{"line":163,"column":45}}},"11":{"name":"(anonymous_11)","line":176,"loc":{"start":{"line":176,"column":36},"end":{"line":176,"column":50}}},"12":{"name":"(anonymous_12)","line":188,"loc":{"start":{"line":188,"column":34},"end":{"line":188,"column":48}}},"13":{"name":"(anonymous_13)","line":216,"loc":{"start":{"line":216,"column":34},"end":{"line":216,"column":64}}},"14":{"name":"(anonymous_14)","line":232,"loc":{"start":{"line":232,"column":37},"end":{"line":232,"column":65}}},"15":{"name":"(anonymous_15)","line":253,"loc":{"start":{"line":253,"column":32},"end":{"line":253,"column":58}}},"16":{"name":"(anonymous_16)","line":265,"loc":{"start":{"line":265,"column":21},"end":{"line":265,"column":39}}},"17":{"name":"(anonymous_17)","line":269,"loc":{"start":{"line":269,"column":17},"end":{"line":269,"column":31}}},"18":{"name":"(anonymous_18)","line":273,"loc":{"start":{"line":273,"column":21},"end":{"line":273,"column":32}}},"19":{"name":"(anonymous_19)","line":277,"loc":{"start":{"line":277,"column":21},"end":{"line":277,"column":32}}},"20":{"name":"(anonymous_20)","line":291,"loc":{"start":{"line":291,"column":43},"end":{"line":291,"column":69}}},"21":{"name":"(anonymous_21)","line":302,"loc":{"start":{"line":302,"column":21},"end":{"line":302,"column":32}}},"22":{"name":"(anonymous_22)","line":306,"loc":{"start":{"line":306,"column":21},"end":{"line":306,"column":32}}},"23":{"name":"(anonymous_23)","line":320,"loc":{"start":{"line":320,"column":56},"end":{"line":320,"column":70}}},"24":{"name":"(anonymous_24)","line":339,"loc":{"start":{"line":339,"column":39},"end":{"line":339,"column":58}}},"25":{"name":"(anonymous_25)","line":359,"loc":{"start":{"line":359,"column":44},"end":{"line":359,"column":63}}},"26":{"name":"(anonymous_26)","line":379,"loc":{"start":{"line":379,"column":42},"end":{"line":379,"column":55}}},"27":{"name":"(anonymous_27)","line":391,"loc":{"start":{"line":391,"column":48},"end":{"line":391,"column":61}}},"28":{"name":"(anonymous_28)","line":405,"loc":{"start":{"line":405,"column":44},"end":{"line":405,"column":55}}},"29":{"name":"(anonymous_29)","line":414,"loc":{"start":{"line":414,"column":11},"end":{"line":414,"column":43}}},"30":{"name":"(anonymous_30)","line":429,"loc":{"start":{"line":429,"column":14},"end":{"line":429,"column":57}}},"31":{"name":"(anonymous_31)","line":447,"loc":{"start":{"line":447,"column":38},"end":{"line":447,"column":49}}},"32":{"name":"(anonymous_32)","line":457,"loc":{"start":{"line":457,"column":25},"end":{"line":457,"column":39}}},"33":{"name":"(anonymous_33)","line":468,"loc":{"start":{"line":468,"column":27},"end":{"line":468,"column":41}}},"34":{"name":"(anonymous_34)","line":480,"loc":{"start":{"line":480,"column":24},"end":{"line":480,"column":45}}},"35":{"name":"(anonymous_35)","line":496,"loc":{"start":{"line":496,"column":28},"end":{"line":496,"column":42}}},"36":{"name":"(anonymous_36)","line":507,"loc":{"start":{"line":507,"column":24},"end":{"line":507,"column":38}}},"37":{"name":"(anonymous_37)","line":516,"loc":{"start":{"line":516,"column":25},"end":{"line":516,"column":39}}},"38":{"name":"(anonymous_38)","line":525,"loc":{"start":{"line":525,"column":30},"end":{"line":525,"column":45}}},"39":{"name":"(anonymous_39)","line":534,"loc":{"start":{"line":534,"column":27},"end":{"line":534,"column":44}}},"40":{"name":"(anonymous_40)","line":547,"loc":{"start":{"line":547,"column":19},"end":{"line":547,"column":30}}},"41":{"name":"(anonymous_41)","line":555,"loc":{"start":{"line":555,"column":22},"end":{"line":555,"column":40}}},"42":{"name":"(anonymous_42)","line":565,"loc":{"start":{"line":565,"column":33},"end":{"line":565,"column":51}}},"43":{"name":"(anonymous_43)","line":567,"loc":{"start":{"line":567,"column":45},"end":{"line":567,"column":59}}},"44":{"name":"(anonymous_44)","line":575,"loc":{"start":{"line":575,"column":35},"end":{"line":575,"column":53}}},"45":{"name":"(anonymous_45)","line":577,"loc":{"start":{"line":577,"column":47},"end":{"line":577,"column":61}}},"46":{"name":"(anonymous_46)","line":585,"loc":{"start":{"line":585,"column":32},"end":{"line":585,"column":53}}},"47":{"name":"(anonymous_47)","line":589,"loc":{"start":{"line":589,"column":32},"end":{"line":589,"column":46}}},"48":{"name":"(anonymous_48)","line":593,"loc":{"start":{"line":593,"column":33},"end":{"line":593,"column":51}}},"49":{"name":"(anonymous_49)","line":597,"loc":{"start":{"line":597,"column":36},"end":{"line":597,"column":49}}},"50":{"name":"(anonymous_50)","line":601,"loc":{"start":{"line":601,"column":31},"end":{"line":601,"column":57}}},"51":{"name":"(anonymous_51)","line":611,"loc":{"start":{"line":611,"column":35},"end":{"line":611,"column":46}}},"52":{"name":"(anonymous_52)","line":617,"loc":{"start":{"line":617,"column":12},"end":{"line":617,"column":42}}},"53":{"name":"(anonymous_53)","line":625,"loc":{"start":{"line":625,"column":13},"end":{"line":625,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":50}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":70}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":40}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":80}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":70}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":18}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":18}},"9":{"start":{"line":23,"column":0},"end":{"line":28,"column":2}},"10":{"start":{"line":24,"column":2},"end":{"line":24,"column":20}},"11":{"start":{"line":25,"column":2},"end":{"line":25,"column":42}},"12":{"start":{"line":26,"column":2},"end":{"line":26,"column":21}},"13":{"start":{"line":27,"column":2},"end":{"line":27,"column":19}},"14":{"start":{"line":30,"column":0},"end":{"line":30,"column":32}},"15":{"start":{"line":44,"column":0},"end":{"line":49,"column":2}},"16":{"start":{"line":45,"column":2},"end":{"line":45,"column":59}},"17":{"start":{"line":46,"column":2},"end":{"line":46,"column":38}},"18":{"start":{"line":48,"column":2},"end":{"line":48,"column":17}},"19":{"start":{"line":57,"column":0},"end":{"line":108,"column":2}},"20":{"start":{"line":58,"column":2},"end":{"line":58,"column":35}},"21":{"start":{"line":60,"column":2},"end":{"line":65,"column":3}},"22":{"start":{"line":61,"column":4},"end":{"line":63,"column":7}},"23":{"start":{"line":62,"column":6},"end":{"line":62,"column":59}},"24":{"start":{"line":64,"column":4},"end":{"line":64,"column":11}},"25":{"start":{"line":67,"column":2},"end":{"line":79,"column":3}},"26":{"start":{"line":68,"column":4},"end":{"line":72,"column":5}},"27":{"start":{"line":70,"column":6},"end":{"line":70,"column":11}},"28":{"start":{"line":71,"column":6},"end":{"line":71,"column":13}},"29":{"start":{"line":75,"column":4},"end":{"line":77,"column":7}},"30":{"start":{"line":76,"column":6},"end":{"line":76,"column":69}},"31":{"start":{"line":78,"column":4},"end":{"line":78,"column":11}},"32":{"start":{"line":81,"column":2},"end":{"line":81,"column":34}},"33":{"start":{"line":83,"column":2},"end":{"line":88,"column":3}},"34":{"start":{"line":84,"column":4},"end":{"line":86,"column":7}},"35":{"start":{"line":85,"column":6},"end":{"line":85,"column":96}},"36":{"start":{"line":87,"column":4},"end":{"line":87,"column":11}},"37":{"start":{"line":90,"column":2},"end":{"line":92,"column":3}},"38":{"start":{"line":91,"column":4},"end":{"line":91,"column":37}},"39":{"start":{"line":94,"column":2},"end":{"line":100,"column":3}},"40":{"start":{"line":96,"column":4},"end":{"line":99,"column":5}},"41":{"start":{"line":97,"column":6},"end":{"line":97,"column":27}},"42":{"start":{"line":98,"column":6},"end":{"line":98,"column":13}},"43":{"start":{"line":101,"column":2},"end":{"line":101,"column":25}},"44":{"start":{"line":103,"column":2},"end":{"line":103,"column":20}},"45":{"start":{"line":105,"column":2},"end":{"line":107,"column":3}},"46":{"start":{"line":106,"column":4},"end":{"line":106,"column":25}},"47":{"start":{"line":116,"column":0},"end":{"line":152,"column":2}},"48":{"start":{"line":117,"column":2},"end":{"line":117,"column":35}},"49":{"start":{"line":119,"column":2},"end":{"line":124,"column":3}},"50":{"start":{"line":120,"column":4},"end":{"line":122,"column":7}},"51":{"start":{"line":121,"column":6},"end":{"line":121,"column":59}},"52":{"start":{"line":123,"column":4},"end":{"line":123,"column":11}},"53":{"start":{"line":126,"column":2},"end":{"line":131,"column":3}},"54":{"start":{"line":127,"column":4},"end":{"line":129,"column":7}},"55":{"start":{"line":128,"column":6},"end":{"line":128,"column":64}},"56":{"start":{"line":130,"column":4},"end":{"line":130,"column":11}},"57":{"start":{"line":133,"column":2},"end":{"line":133,"column":40}},"58":{"start":{"line":134,"column":2},"end":{"line":146,"column":3}},"59":{"start":{"line":135,"column":4},"end":{"line":141,"column":5}},"60":{"start":{"line":136,"column":6},"end":{"line":136,"column":25}},"61":{"start":{"line":137,"column":6},"end":{"line":140,"column":7}},"62":{"start":{"line":138,"column":8},"end":{"line":138,"column":30}},"63":{"start":{"line":139,"column":8},"end":{"line":139,"column":14}},"64":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"65":{"start":{"line":144,"column":6},"end":{"line":144,"column":30}},"66":{"start":{"line":147,"column":2},"end":{"line":147,"column":22}},"67":{"start":{"line":149,"column":2},"end":{"line":151,"column":3}},"68":{"start":{"line":150,"column":4},"end":{"line":150,"column":25}},"69":{"start":{"line":163,"column":0},"end":{"line":165,"column":2}},"70":{"start":{"line":164,"column":2},"end":{"line":164,"column":28}},"71":{"start":{"line":176,"column":0},"end":{"line":178,"column":2}},"72":{"start":{"line":177,"column":2},"end":{"line":177,"column":26}},"73":{"start":{"line":188,"column":0},"end":{"line":209,"column":2}},"74":{"start":{"line":189,"column":2},"end":{"line":189,"column":35}},"75":{"start":{"line":190,"column":2},"end":{"line":208,"column":3}},"76":{"start":{"line":191,"column":4},"end":{"line":191,"column":26}},"77":{"start":{"line":192,"column":4},"end":{"line":192,"column":37}},"78":{"start":{"line":194,"column":4},"end":{"line":194,"column":36}},"79":{"start":{"line":195,"column":4},"end":{"line":197,"column":5}},"80":{"start":{"line":196,"column":6},"end":{"line":196,"column":13}},"81":{"start":{"line":199,"column":4},"end":{"line":207,"column":5}},"82":{"start":{"line":200,"column":6},"end":{"line":206,"column":7}},"83":{"start":{"line":201,"column":8},"end":{"line":201,"column":30}},"84":{"start":{"line":202,"column":8},"end":{"line":204,"column":9}},"85":{"start":{"line":203,"column":10},"end":{"line":203,"column":34}},"86":{"start":{"line":205,"column":8},"end":{"line":205,"column":14}},"87":{"start":{"line":216,"column":0},"end":{"line":224,"column":2}},"88":{"start":{"line":217,"column":2},"end":{"line":217,"column":35}},"89":{"start":{"line":218,"column":2},"end":{"line":221,"column":3}},"90":{"start":{"line":219,"column":4},"end":{"line":219,"column":79}},"91":{"start":{"line":220,"column":4},"end":{"line":220,"column":11}},"92":{"start":{"line":222,"column":2},"end":{"line":222,"column":26}},"93":{"start":{"line":223,"column":2},"end":{"line":223,"column":27}},"94":{"start":{"line":232,"column":0},"end":{"line":243,"column":2}},"95":{"start":{"line":233,"column":2},"end":{"line":233,"column":35}},"96":{"start":{"line":234,"column":2},"end":{"line":237,"column":3}},"97":{"start":{"line":235,"column":4},"end":{"line":235,"column":79}},"98":{"start":{"line":236,"column":4},"end":{"line":236,"column":11}},"99":{"start":{"line":239,"column":2},"end":{"line":241,"column":3}},"100":{"start":{"line":240,"column":4},"end":{"line":240,"column":32}},"101":{"start":{"line":242,"column":2},"end":{"line":242,"column":27}},"102":{"start":{"line":253,"column":0},"end":{"line":281,"column":2}},"103":{"start":{"line":255,"column":2},"end":{"line":258,"column":3}},"104":{"start":{"line":256,"column":4},"end":{"line":256,"column":16}},"105":{"start":{"line":257,"column":4},"end":{"line":257,"column":20}},"106":{"start":{"line":259,"column":2},"end":{"line":259,"column":36}},"107":{"start":{"line":261,"column":2},"end":{"line":280,"column":3}},"108":{"start":{"line":263,"column":4},"end":{"line":263,"column":18}},"109":{"start":{"line":264,"column":4},"end":{"line":264,"column":20}},"110":{"start":{"line":265,"column":4},"end":{"line":267,"column":7}},"111":{"start":{"line":266,"column":6},"end":{"line":266,"column":28}},"112":{"start":{"line":269,"column":4},"end":{"line":271,"column":7}},"113":{"start":{"line":270,"column":6},"end":{"line":270,"column":40}},"114":{"start":{"line":273,"column":4},"end":{"line":275,"column":7}},"115":{"start":{"line":274,"column":6},"end":{"line":274,"column":31}},"116":{"start":{"line":277,"column":4},"end":{"line":279,"column":7}},"117":{"start":{"line":278,"column":6},"end":{"line":278,"column":31}},"118":{"start":{"line":291,"column":0},"end":{"line":310,"column":2}},"119":{"start":{"line":292,"column":2},"end":{"line":295,"column":3}},"120":{"start":{"line":293,"column":4},"end":{"line":293,"column":16}},"121":{"start":{"line":294,"column":4},"end":{"line":294,"column":20}},"122":{"start":{"line":297,"column":2},"end":{"line":297,"column":30}},"123":{"start":{"line":299,"column":2},"end":{"line":309,"column":3}},"124":{"start":{"line":301,"column":4},"end":{"line":301,"column":27}},"125":{"start":{"line":302,"column":4},"end":{"line":304,"column":7}},"126":{"start":{"line":303,"column":6},"end":{"line":303,"column":31}},"127":{"start":{"line":306,"column":4},"end":{"line":308,"column":7}},"128":{"start":{"line":307,"column":6},"end":{"line":307,"column":31}},"129":{"start":{"line":320,"column":1},"end":{"line":328,"column":3}},"130":{"start":{"line":321,"column":3},"end":{"line":321,"column":31}},"131":{"start":{"line":322,"column":3},"end":{"line":327,"column":4}},"132":{"start":{"line":323,"column":6},"end":{"line":323,"column":38}},"133":{"start":{"line":324,"column":6},"end":{"line":324,"column":34}},"134":{"start":{"line":326,"column":6},"end":{"line":326,"column":18}},"135":{"start":{"line":339,"column":0},"end":{"line":348,"column":2}},"136":{"start":{"line":340,"column":2},"end":{"line":340,"column":35}},"137":{"start":{"line":342,"column":2},"end":{"line":345,"column":3}},"138":{"start":{"line":343,"column":4},"end":{"line":343,"column":96}},"139":{"start":{"line":344,"column":4},"end":{"line":344,"column":17}},"140":{"start":{"line":347,"column":2},"end":{"line":347,"column":34}},"141":{"start":{"line":359,"column":0},"end":{"line":371,"column":2}},"142":{"start":{"line":360,"column":2},"end":{"line":360,"column":34}},"143":{"start":{"line":362,"column":2},"end":{"line":366,"column":3}},"144":{"start":{"line":363,"column":4},"end":{"line":364,"column":13}},"145":{"start":{"line":365,"column":4},"end":{"line":365,"column":17}},"146":{"start":{"line":368,"column":2},"end":{"line":370,"column":3}},"147":{"start":{"line":369,"column":4},"end":{"line":369,"column":33}},"148":{"start":{"line":379,"column":0},"end":{"line":383,"column":2}},"149":{"start":{"line":380,"column":2},"end":{"line":382,"column":3}},"150":{"start":{"line":381,"column":4},"end":{"line":381,"column":27}},"151":{"start":{"line":391,"column":0},"end":{"line":399,"column":2}},"152":{"start":{"line":392,"column":2},"end":{"line":392,"column":21}},"153":{"start":{"line":393,"column":2},"end":{"line":398,"column":3}},"154":{"start":{"line":394,"column":4},"end":{"line":394,"column":32}},"155":{"start":{"line":395,"column":4},"end":{"line":397,"column":5}},"156":{"start":{"line":396,"column":6},"end":{"line":396,"column":22}},"157":{"start":{"line":405,"column":0},"end":{"line":407,"column":2}},"158":{"start":{"line":406,"column":2},"end":{"line":406,"column":35}},"159":{"start":{"line":414,"column":0},"end":{"line":418,"column":2}},"160":{"start":{"line":415,"column":2},"end":{"line":415,"column":20}},"161":{"start":{"line":417,"column":2},"end":{"line":417,"column":14}},"162":{"start":{"line":429,"column":0},"end":{"line":440,"column":2}},"163":{"start":{"line":430,"column":2},"end":{"line":430,"column":26}},"164":{"start":{"line":431,"column":2},"end":{"line":431,"column":16}},"165":{"start":{"line":432,"column":2},"end":{"line":432,"column":31}},"166":{"start":{"line":433,"column":2},"end":{"line":433,"column":18}},"167":{"start":{"line":434,"column":2},"end":{"line":434,"column":21}},"168":{"start":{"line":437,"column":2},"end":{"line":437,"column":27}},"169":{"start":{"line":438,"column":2},"end":{"line":438,"column":36}},"170":{"start":{"line":439,"column":2},"end":{"line":439,"column":29}},"171":{"start":{"line":442,"column":0},"end":{"line":442,"column":37}},"172":{"start":{"line":447,"column":0},"end":{"line":449,"column":2}},"173":{"start":{"line":448,"column":2},"end":{"line":448,"column":35}},"174":{"start":{"line":457,"column":0},"end":{"line":460,"column":2}},"175":{"start":{"line":458,"column":2},"end":{"line":458,"column":17}},"176":{"start":{"line":459,"column":2},"end":{"line":459,"column":25}},"177":{"start":{"line":468,"column":0},"end":{"line":471,"column":2}},"178":{"start":{"line":469,"column":2},"end":{"line":469,"column":18}},"179":{"start":{"line":470,"column":2},"end":{"line":470,"column":27}},"180":{"start":{"line":480,"column":0},"end":{"line":488,"column":2}},"181":{"start":{"line":481,"column":2},"end":{"line":487,"column":3}},"182":{"start":{"line":482,"column":4},"end":{"line":484,"column":5}},"183":{"start":{"line":483,"column":6},"end":{"line":483,"column":32}},"184":{"start":{"line":486,"column":4},"end":{"line":486,"column":31}},"185":{"start":{"line":496,"column":1},"end":{"line":498,"column":2}},"186":{"start":{"line":497,"column":2},"end":{"line":497,"column":19}},"187":{"start":{"line":507,"column":0},"end":{"line":509,"column":2}},"188":{"start":{"line":508,"column":2},"end":{"line":508,"column":28}},"189":{"start":{"line":516,"column":0},"end":{"line":518,"column":2}},"190":{"start":{"line":517,"column":2},"end":{"line":517,"column":28}},"191":{"start":{"line":525,"column":0},"end":{"line":527,"column":2}},"192":{"start":{"line":526,"column":2},"end":{"line":526,"column":34}},"193":{"start":{"line":534,"column":0},"end":{"line":550,"column":2}},"194":{"start":{"line":535,"column":2},"end":{"line":535,"column":90}},"195":{"start":{"line":536,"column":2},"end":{"line":538,"column":3}},"196":{"start":{"line":537,"column":4},"end":{"line":537,"column":11}},"197":{"start":{"line":539,"column":2},"end":{"line":539,"column":29}},"198":{"start":{"line":540,"column":2},"end":{"line":540,"column":42}},"199":{"start":{"line":541,"column":2},"end":{"line":541,"column":56}},"200":{"start":{"line":542,"column":2},"end":{"line":542,"column":42}},"201":{"start":{"line":544,"column":2},"end":{"line":544,"column":18}},"202":{"start":{"line":547,"column":2},"end":{"line":549,"column":5}},"203":{"start":{"line":548,"column":4},"end":{"line":548,"column":33}},"204":{"start":{"line":555,"column":0},"end":{"line":561,"column":2}},"205":{"start":{"line":556,"column":2},"end":{"line":556,"column":26}},"206":{"start":{"line":557,"column":2},"end":{"line":557,"column":48}},"207":{"start":{"line":559,"column":2},"end":{"line":559,"column":43}},"208":{"start":{"line":560,"column":2},"end":{"line":560,"column":29}},"209":{"start":{"line":563,"column":0},"end":{"line":563,"column":45}},"210":{"start":{"line":565,"column":0},"end":{"line":573,"column":2}},"211":{"start":{"line":566,"column":2},"end":{"line":566,"column":18}},"212":{"start":{"line":567,"column":2},"end":{"line":572,"column":5}},"213":{"start":{"line":568,"column":4},"end":{"line":570,"column":5}},"214":{"start":{"line":569,"column":6},"end":{"line":569,"column":21}},"215":{"start":{"line":571,"column":4},"end":{"line":571,"column":34}},"216":{"start":{"line":575,"column":0},"end":{"line":583,"column":2}},"217":{"start":{"line":576,"column":2},"end":{"line":576,"column":18}},"218":{"start":{"line":577,"column":2},"end":{"line":582,"column":5}},"219":{"start":{"line":578,"column":4},"end":{"line":580,"column":5}},"220":{"start":{"line":579,"column":6},"end":{"line":579,"column":22}},"221":{"start":{"line":581,"column":4},"end":{"line":581,"column":34}},"222":{"start":{"line":585,"column":0},"end":{"line":587,"column":2}},"223":{"start":{"line":586,"column":2},"end":{"line":586,"column":29}},"224":{"start":{"line":589,"column":0},"end":{"line":591,"column":2}},"225":{"start":{"line":590,"column":2},"end":{"line":590,"column":28}},"226":{"start":{"line":593,"column":0},"end":{"line":595,"column":2}},"227":{"start":{"line":594,"column":2},"end":{"line":594,"column":66}},"228":{"start":{"line":597,"column":0},"end":{"line":599,"column":2}},"229":{"start":{"line":598,"column":2},"end":{"line":598,"column":64}},"230":{"start":{"line":601,"column":0},"end":{"line":604,"column":2}},"231":{"start":{"line":602,"column":2},"end":{"line":602,"column":56}},"232":{"start":{"line":603,"column":2},"end":{"line":603,"column":39}},"233":{"start":{"line":611,"column":0},"end":{"line":615,"column":2}},"234":{"start":{"line":612,"column":2},"end":{"line":612,"column":15}},"235":{"start":{"line":613,"column":2},"end":{"line":613,"column":44}},"236":{"start":{"line":614,"column":2},"end":{"line":614,"column":13}},"237":{"start":{"line":617,"column":0},"end":{"line":623,"column":2}},"238":{"start":{"line":618,"column":2},"end":{"line":618,"column":8}},"239":{"start":{"line":619,"column":2},"end":{"line":622,"column":3}},"240":{"start":{"line":620,"column":4},"end":{"line":620,"column":20}},"241":{"start":{"line":621,"column":4},"end":{"line":621,"column":21}},"242":{"start":{"line":625,"column":0},"end":{"line":631,"column":2}},"243":{"start":{"line":626,"column":2},"end":{"line":626,"column":15}},"244":{"start":{"line":627,"column":2},"end":{"line":629,"column":3}},"245":{"start":{"line":628,"column":4},"end":{"line":628,"column":20}},"246":{"start":{"line":630,"column":2},"end":{"line":630,"column":13}}},"branchMap":{"1":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":9},"end":{"line":24,"column":13}},{"start":{"line":24,"column":17},"end":{"line":24,"column":19}}]},"2":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":60,"column":2}},{"start":{"line":60,"column":2},"end":{"line":60,"column":2}}]},"3":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":2},"end":{"line":67,"column":2}},{"start":{"line":67,"column":2},"end":{"line":67,"column":2}}]},"4":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":68,"column":4}},{"start":{"line":68,"column":4},"end":{"line":68,"column":4}}]},"5":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":2},"end":{"line":83,"column":2}},{"start":{"line":83,"column":2},"end":{"line":83,"column":2}}]},"6":{"line":83,"type":"binary-expr","locations":[{"start":{"line":83,"column":5},"end":{"line":83,"column":25}},{"start":{"line":83,"column":29},"end":{"line":83,"column":39}}]},"7":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":2},"end":{"line":90,"column":2}},{"start":{"line":90,"column":2},"end":{"line":90,"column":2}}]},"8":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":4},"end":{"line":96,"column":4}},{"start":{"line":96,"column":4},"end":{"line":96,"column":4}}]},"9":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"10":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":2},"end":{"line":119,"column":2}},{"start":{"line":119,"column":2},"end":{"line":119,"column":2}}]},"11":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":2},"end":{"line":126,"column":2}},{"start":{"line":126,"column":2},"end":{"line":126,"column":2}}]},"12":{"line":126,"type":"binary-expr","locations":[{"start":{"line":126,"column":5},"end":{"line":126,"column":17}},{"start":{"line":126,"column":21},"end":{"line":126,"column":40}}]},"13":{"line":134,"type":"if","locations":[{"start":{"line":134,"column":2},"end":{"line":134,"column":2}},{"start":{"line":134,"column":2},"end":{"line":134,"column":2}}]},"14":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":6},"end":{"line":137,"column":6}},{"start":{"line":137,"column":6},"end":{"line":137,"column":6}}]},"15":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":143,"column":4}},{"start":{"line":143,"column":4},"end":{"line":143,"column":4}}]},"16":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":2},"end":{"line":149,"column":2}},{"start":{"line":149,"column":2},"end":{"line":149,"column":2}}]},"17":{"line":190,"type":"if","locations":[{"start":{"line":190,"column":2},"end":{"line":190,"column":2}},{"start":{"line":190,"column":2},"end":{"line":190,"column":2}}]},"18":{"line":195,"type":"if","locations":[{"start":{"line":195,"column":4},"end":{"line":195,"column":4}},{"start":{"line":195,"column":4},"end":{"line":195,"column":4}}]},"19":{"line":200,"type":"if","locations":[{"start":{"line":200,"column":6},"end":{"line":200,"column":6}},{"start":{"line":200,"column":6},"end":{"line":200,"column":6}}]},"20":{"line":202,"type":"if","locations":[{"start":{"line":202,"column":8},"end":{"line":202,"column":8}},{"start":{"line":202,"column":8},"end":{"line":202,"column":8}}]},"21":{"line":218,"type":"if","locations":[{"start":{"line":218,"column":2},"end":{"line":218,"column":2}},{"start":{"line":218,"column":2},"end":{"line":218,"column":2}}]},"22":{"line":234,"type":"if","locations":[{"start":{"line":234,"column":2},"end":{"line":234,"column":2}},{"start":{"line":234,"column":2},"end":{"line":234,"column":2}}]},"23":{"line":255,"type":"if","locations":[{"start":{"line":255,"column":2},"end":{"line":255,"column":2}},{"start":{"line":255,"column":2},"end":{"line":255,"column":2}}]},"24":{"line":261,"type":"if","locations":[{"start":{"line":261,"column":2},"end":{"line":261,"column":2}},{"start":{"line":261,"column":2},"end":{"line":261,"column":2}}]},"25":{"line":292,"type":"if","locations":[{"start":{"line":292,"column":2},"end":{"line":292,"column":2}},{"start":{"line":292,"column":2},"end":{"line":292,"column":2}}]},"26":{"line":299,"type":"if","locations":[{"start":{"line":299,"column":2},"end":{"line":299,"column":2}},{"start":{"line":299,"column":2},"end":{"line":299,"column":2}}]},"27":{"line":322,"type":"if","locations":[{"start":{"line":322,"column":3},"end":{"line":322,"column":3}},{"start":{"line":322,"column":3},"end":{"line":322,"column":3}}]},"28":{"line":342,"type":"if","locations":[{"start":{"line":342,"column":2},"end":{"line":342,"column":2}},{"start":{"line":342,"column":2},"end":{"line":342,"column":2}}]},"29":{"line":362,"type":"if","locations":[{"start":{"line":362,"column":2},"end":{"line":362,"column":2}},{"start":{"line":362,"column":2},"end":{"line":362,"column":2}}]},"30":{"line":481,"type":"if","locations":[{"start":{"line":481,"column":2},"end":{"line":481,"column":2}},{"start":{"line":481,"column":2},"end":{"line":481,"column":2}}]},"31":{"line":536,"type":"if","locations":[{"start":{"line":536,"column":2},"end":{"line":536,"column":2}},{"start":{"line":536,"column":2},"end":{"line":536,"column":2}}]},"32":{"line":568,"type":"if","locations":[{"start":{"line":568,"column":4},"end":{"line":568,"column":4}},{"start":{"line":568,"column":4},"end":{"line":568,"column":4}}]},"33":{"line":578,"type":"if","locations":[{"start":{"line":578,"column":4},"end":{"line":578,"column":4}},{"start":{"line":578,"column":4},"end":{"line":578,"column":4}}]}},"code":["var EventEmitter = require('events').EventEmitter;","var util = require('util');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var utils = require('../../util/utils');","","var FRONTEND_SESSION_FIELDS = ['id', 'frontendId', 'uid', '__sessionService__'];","var EXPORTED_SESSION_FIELDS = ['id', 'frontendId', 'uid', 'settings'];","","var ST_INITED = 0;","var ST_CLOSED = 1;","","/**"," * Session service maintains the internal session for each client connection."," *"," * Session service is created by session component and is only"," * <b>available</b> in frontend servers. You can access the service by"," * `app.get('sessionService')` or `app.sessionService` in frontend servers."," *"," * @param {Object} opts constructor parameters"," * @class"," * @constructor"," */","var SessionService = function(opts) {","  opts = opts || {};","  this.singleSession = opts.singleSession;","  this.sessions = {};     // sid -> session","  this.uidMap = {};       // uid -> sessions","};","","module.exports = SessionService;","","/**"," * Create and return internal session."," *"," * @param {Integer} sid uniqe id for the internal session "," * @param {String} frontendId frontend server in which the internal session is created "," * @param {Object} socket the underlying socket would be held by the internal session  "," *"," * @return {Session}"," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.create = function(sid, frontendId, socket) {","  var session = new Session(sid, frontendId, socket, this);","  this.sessions[session.id] = session;","","  return session;","};","","/**"," * Bind the session with a user id."," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.bind = function(sid, uid, cb) {","  var session = this.sessions[sid];","","  if(!session) {","    process.nextTick(function() {","      cb(new Error('session does not exist, sid: ' + sid));","    });","    return;","  }","","  if(session.uid) {","    if(session.uid === uid) {","      // already bound with the same uid","      cb();","      return;","    }","","    // already bound with other uid","    process.nextTick(function() {","      cb(new Error('session has already bound with ' + session.uid));","    });","    return;","  }","","  var sessions = this.uidMap[uid];","","  if(!!this.singleSession && !!sessions) {","    process.nextTick(function() {","      cb(new Error('singleSession is enabled, and session has already bound with uid: ' + uid));","    });","    return;","  }","","  if(!sessions) {","    sessions = this.uidMap[uid] = [];","  }","","  for(var i=0, l=sessions.length; i<l; i++) {","    // session has binded with the uid","    if(sessions[i].id === session.id) {","      process.nextTick(cb);","      return;","    }","  }","  sessions.push(session);","","  session.bind(uid);","","  if(cb) {","    process.nextTick(cb);","  }","};","","/**"," * Unbind a session with the user id."," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.unbind = function(sid, uid, cb) {","  var session = this.sessions[sid];","","  if(!session) {","    process.nextTick(function() {","      cb(new Error('session does not exist, sid: ' + sid));","    });","    return;","  }","","  if(!session.uid || session.uid !== uid) {","    process.nextTick(function() {","      cb(new Error('session has not bind with ' + session.uid));","    });","    return;","  }","","  var sessions = this.uidMap[uid], sess;","  if(sessions) {","    for(var i=0, l=sessions.length; i<l; i++) {","      sess = sessions[i];","      if(sess.id === sid) {","        sessions.splice(i, 1);","        break;","      }","    }","","    if(sessions.length === 0) {","      delete this.uidMap[uid];","    }","  }","  session.unbind(uid);","","  if(cb) {","    process.nextTick(cb);","  }","};","","/**"," * Get session by id."," *"," * @param {Number} id The session id"," * @return {Session}"," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.get = function(sid) {","  return this.sessions[sid];","};","","/**"," * Get sessions by userId."," *"," * @param {Number} uid User id associated with the session"," * @return {Array} list of session binded with the uid"," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.getByUid = function(uid) {","  return this.uidMap[uid];","};","","/**"," * Remove session by key."," *"," * @param {Number} sid The session id"," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.remove = function(sid) {","  var session = this.sessions[sid];","  if(session) {","    var uid = session.uid;","    delete this.sessions[session.id];","","    var sessions = this.uidMap[uid];","    if(!sessions) {","      return;","    }","","    for(var i=0, l=sessions.length; i<l; i++) {","      if(sessions[i].id === sid) {","        sessions.splice(i, 1);","        if(sessions.length === 0) {","          delete this.uidMap[uid];","        }","        break;","      }","    }","  }","};","","/**"," * Import the key/value into session."," *"," * @api private"," */","SessionService.prototype.import = function(sid, key, value, cb) {","  var session = this.sessions[sid];","  if(!session) {","    utils.invokeCallback(cb, new Error('session does not exist, sid: ' + sid));","    return;","  }","  session.set(key, value);","  utils.invokeCallback(cb);","};","","/**"," * Import new value for the existed session."," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.importAll = function(sid, settings, cb) {","  var session = this.sessions[sid];","  if(!session) {","    utils.invokeCallback(cb, new Error('session does not exist, sid: ' + sid));","    return;","  }","","  for(var f in settings) {","    session.set(f, settings[f]);","  }","  utils.invokeCallback(cb);","};","","/**"," * Kick all the session offline under the user id."," *"," * @param {Number}   uid user id asscociated with the session"," * @param {Function} cb  callback function"," *"," * @memberOf SessionService"," */","SessionService.prototype.kick = function(uid, reason, cb) {","  // compatible for old kick(uid, cb);","  if(typeof reason === 'function') {","    cb = reason;","    reason = 'kick';","  }","  var sessions = this.getByUid(uid);","","  if(sessions) {","    // notify client","    var sids = [];","    var self = this;","    sessions.forEach(function(session) {","      sids.push(session.id);","    });","","    sids.forEach(function(sid) {","      self.sessions[sid].closed(reason);","    });","","    process.nextTick(function() {","      utils.invokeCallback(cb);","    });","  } else {","    process.nextTick(function() {","      utils.invokeCallback(cb);","    });","  }","};","","/**"," * Kick a user offline by session id."," *"," * @param {Number}   sid session id"," * @param {Function} cb  callback function"," *"," * @memberOf SessionService"," */","SessionService.prototype.kickBySessionId = function(sid, reason, cb) {","  if(typeof reason === 'function') {","    cb = reason;","    reason = 'kick';","  }","","  var session = this.get(sid);","","  if(session) {","    // notify client","    session.closed(reason);","    process.nextTick(function() {","      utils.invokeCallback(cb);","    });","  } else {","    process.nextTick(function() {","      utils.invokeCallback(cb);","    });","  }","};","","/**"," * Get client remote address by session id."," *"," * @param {Number}   sid session id"," * @return {Object} remote address of client"," *"," * @memberOf SessionService"," */"," SessionService.prototype.getClientAddressBySessionId = function(sid) {","   var session = this.get(sid);","   if(session) {","      var socket = session.__socket__;","      return socket.remoteAddress;","   } else {","      return null;","   }"," };","","/**"," * Send message to the client by session id."," *"," * @param {String} sid session id"," * @param {Object} msg message to send"," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.sendMessage = function(sid, msg) {","  var session = this.sessions[sid];","","  if(!session) {","    logger.debug('Fail to send message for non-existing session, sid: ' + sid + ' msg: ' + msg);","    return false;","  }","","  return send(this, session, msg);","};","","/**"," * Send message to the client by user id."," *"," * @param {String} uid userId"," * @param {Object} msg message to send"," *"," * @memberOf SessionService"," * @api private"," */","SessionService.prototype.sendMessageByUid = function(uid, msg) {","  var sessions = this.uidMap[uid];","","  if(!sessions) {","    logger.debug('fail to send message by uid for non-existing session. uid: %j',","        uid);","    return false;","  }","","  for(var i=0, l=sessions.length; i<l; i++) {","    send(this, sessions[i], msg);","  }","};","","/**"," * Iterate all the session in the session service."," *"," * @param  {Function} cb callback function to fetch session"," * @api private"," */","SessionService.prototype.forEachSession = function(cb) {","  for(var sid in this.sessions) {","    cb(this.sessions[sid]);","  }","};","","/**"," * Iterate all the binded session in the session service."," *"," * @param  {Function} cb callback function to fetch session"," * @api private"," */","SessionService.prototype.forEachBindedSession = function(cb) {","  var i, l, sessions;","  for(var uid in this.uidMap) {","    sessions = this.uidMap[uid];","    for(i=0, l=sessions.length; i<l; i++) {","      cb(sessions[i]);","    }","  }","};","","/**"," * Get sessions' quantity in specified server."," *"," */","SessionService.prototype.getSessionsCount = function() {","  return utils.size(this.sessions);","};","","/**"," * Send message to the client that associated with the session."," *"," * @api private"," */","var send = function(service, session, msg) {","  session.send(msg);","","  return true;","};","","/**"," * Session maintains the relationship between client connection and user information."," * There is a session associated with each client connection. And it should bind to a"," * user id after the client passes the identification."," *"," * Session is created in frontend server and should not be accessed in handler."," * There is a proxy class called BackendSession in backend servers and FrontendSession "," * in frontend servers."," */","var Session = function(sid, frontendId, socket, service) {","  EventEmitter.call(this);","  this.id = sid;          // r","  this.frontendId = frontendId; // r","  this.uid = null;        // r","  this.settings = {};","","  // private","  this.__socket__ = socket;","  this.__sessionService__ = service;","  this.__state__ = ST_INITED;","};","","util.inherits(Session, EventEmitter);","","/*"," * Export current session as frontend session."," */","Session.prototype.toFrontendSession = function() {","  return new FrontendSession(this);","};","","/**"," * Bind the session with the the uid."," *"," * @param {Number} uid User id"," * @api public"," */","Session.prototype.bind = function(uid) {","  this.uid = uid;","  this.emit('bind', uid);","};","","/**"," * Unbind the session with the the uid."," *"," * @param {Number} uid User id"," * @api private"," */","Session.prototype.unbind = function(uid) {","  this.uid = null;","  this.emit('unbind', uid);","};","","/**"," * Set values (one or many) for the session."," *"," * @param {String|Object} key session key"," * @param {Object} value session value"," * @api public"," */","Session.prototype.set = function(key, value) {","  if (utils.isObject(key)) {","    for (var i in key) {","      this.settings[i] = key[i];","    }","  } else {","    this.settings[key] = value;","  }","};","","/**"," * Remove value from the session."," *"," * @param {String} key session key"," * @api public"," */"," Session.prototype.remove = function(key) {","  delete this[key];","};","","/**"," * Get value from the session."," *"," * @param {String} key session key"," * @return {Object} value associated with session key"," * @api public"," */","Session.prototype.get = function(key) {","  return this.settings[key];","};","","/**"," * Send message to the session."," *"," * @param  {Object} msg final message sent to client"," */","Session.prototype.send = function(msg) {","  this.__socket__.send(msg);","};","","/**"," * Send message to the session in batch."," *"," * @param  {Array} msgs list of message"," */","Session.prototype.sendBatch = function(msgs) {","  this.__socket__.sendBatch(msgs);","};","","/**"," * Closed callback for the session which would disconnect client in next tick."," *"," * @api public"," */","Session.prototype.closed = function(reason) {","  logger.debug('session on [%s] is closed with session id: %s', this.frontendId, this.id);","  if(this.__state__ === ST_CLOSED) {","    return;","  }","  this.__state__ = ST_CLOSED;","  this.__sessionService__.remove(this.id);","  this.emit('closed', this.toFrontendSession(), reason);","  this.__socket__.emit('closing', reason);","","  var self = this;","  // give a chance to send disconnect message to client","","  process.nextTick(function() {","    self.__socket__.disconnect();","  });","};","","/**"," * Frontend session for frontend server."," */","var FrontendSession = function(session) {","  EventEmitter.call(this);","  clone(session, this, FRONTEND_SESSION_FIELDS);","  // deep copy for settings","  this.settings = dclone(session.settings);","  this.__session__ = session;","};","","util.inherits(FrontendSession, EventEmitter);","","FrontendSession.prototype.bind = function(uid, cb) {","  var self = this;","  this.__sessionService__.bind(this.id, uid, function(err) {","    if(!err) {","      self.uid = uid;","    }","    utils.invokeCallback(cb, err);","  });","};","","FrontendSession.prototype.unbind = function(uid, cb) {","  var self = this;","  this.__sessionService__.unbind(this.id, uid, function(err) {","    if(!err) {","      self.uid = null;","    }","    utils.invokeCallback(cb, err);","  });","};","","FrontendSession.prototype.set = function(key, value) {","  this.settings[key] = value;","};","","FrontendSession.prototype.get = function(key) {","  return this.settings[key];","};","","FrontendSession.prototype.push = function(key, cb) {","  this.__sessionService__.import(this.id, key, this.get(key), cb);","};","","FrontendSession.prototype.pushAll = function(cb) {","  this.__sessionService__.importAll(this.id, this.settings, cb);","};","","FrontendSession.prototype.on = function(event, listener) {","  EventEmitter.prototype.on.call(this, event, listener);","  this.__session__.on(event, listener);","};","","/**"," * Export the key/values for serialization."," *"," * @api private"," */","FrontendSession.prototype.export = function() {","  var res = {};","  clone(this, res, EXPORTED_SESSION_FIELDS);","  return res;","};","","var clone = function(src, dest, includes) {","  var f;","  for(var i=0, l=includes.length; i<l; i++) {","    f = includes[i];","    dest[f] = src[f];","  }","};","","var dclone = function(src) {","  var res = {};","  for(var f in src) {","    res[f] = src[f];","  }","  return res;","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"7":1,"9":1,"10":1,"23":1,"24":0,"25":0,"26":0,"27":0,"30":1,"44":1,"45":0,"46":0,"48":0,"57":1,"58":0,"60":0,"61":0,"62":0,"64":0,"67":0,"68":0,"70":0,"71":0,"75":0,"76":0,"78":0,"81":0,"83":0,"84":0,"85":0,"87":0,"90":0,"91":0,"94":0,"96":0,"97":0,"98":0,"101":0,"103":0,"105":0,"106":0,"116":1,"117":0,"119":0,"120":0,"121":0,"123":0,"126":0,"127":0,"128":0,"130":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"143":0,"144":0,"147":0,"149":0,"150":0,"163":1,"164":0,"176":1,"177":0,"188":1,"189":0,"190":0,"191":0,"192":0,"194":0,"195":0,"196":0,"199":0,"200":0,"201":0,"202":0,"203":0,"205":0,"216":1,"217":0,"218":0,"219":0,"220":0,"222":0,"223":0,"232":1,"233":0,"234":0,"235":0,"236":0,"239":0,"240":0,"242":0,"253":1,"255":0,"256":0,"257":0,"259":0,"261":0,"263":0,"264":0,"265":0,"266":0,"269":0,"270":0,"273":0,"274":0,"277":0,"278":0,"291":1,"292":0,"293":0,"294":0,"297":0,"299":0,"301":0,"302":0,"303":0,"306":0,"307":0,"320":1,"321":0,"322":0,"323":0,"324":0,"326":0,"339":1,"340":0,"342":0,"343":0,"344":0,"347":0,"359":1,"360":0,"362":0,"363":0,"365":0,"368":0,"369":0,"379":1,"380":0,"381":0,"391":1,"392":0,"393":0,"394":0,"395":0,"396":0,"405":1,"406":0,"414":1,"415":0,"417":0,"429":1,"430":0,"431":0,"432":0,"433":0,"434":0,"437":0,"438":0,"439":0,"442":1,"447":1,"448":0,"457":1,"458":0,"459":0,"468":1,"469":0,"470":0,"480":1,"481":0,"482":0,"483":0,"486":0,"496":1,"497":0,"507":1,"508":0,"516":1,"517":0,"525":1,"526":0,"534":1,"535":0,"536":0,"537":0,"539":0,"540":0,"541":0,"542":0,"544":0,"547":0,"548":0,"555":1,"556":0,"557":0,"559":0,"560":0,"563":1,"565":1,"566":0,"567":0,"568":0,"569":0,"571":0,"575":1,"576":0,"577":0,"578":0,"579":0,"581":0,"585":1,"586":0,"589":1,"590":0,"593":1,"594":0,"597":1,"598":0,"601":1,"602":0,"603":0,"611":1,"612":0,"613":0,"614":0,"617":1,"618":0,"619":0,"620":0,"621":0,"625":1,"626":0,"627":0,"628":0,"630":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/handler/serial.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/handler/serial.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":35}}},"2":{"name":"(anonymous_2)","line":11,"loc":{"start":{"line":11,"column":13},"end":{"line":11,"column":31}}},"3":{"name":"(anonymous_3)","line":18,"loc":{"start":{"line":18,"column":26},"end":{"line":18,"column":55}}},"4":{"name":"(anonymous_4)","line":19,"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":49}}},"5":{"name":"(anonymous_5)","line":22,"loc":{"start":{"line":22,"column":5},"end":{"line":22,"column":16}}},"6":{"name":"(anonymous_6)","line":30,"loc":{"start":{"line":30,"column":25},"end":{"line":30,"column":65}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":70}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":7,"column":0},"end":{"line":9,"column":2}},"4":{"start":{"line":8,"column":2},"end":{"line":8,"column":29}},"5":{"start":{"line":11,"column":0},"end":{"line":13,"column":2}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":25}},"7":{"start":{"line":18,"column":0},"end":{"line":25,"column":2}},"8":{"start":{"line":19,"column":2},"end":{"line":24,"column":19}},"9":{"start":{"line":20,"column":4},"end":{"line":20,"column":34}},"10":{"start":{"line":21,"column":4},"end":{"line":21,"column":11}},"11":{"start":{"line":23,"column":4},"end":{"line":23,"column":76}},"12":{"start":{"line":30,"column":0},"end":{"line":38,"column":2}},"13":{"start":{"line":31,"column":2},"end":{"line":31,"column":36}},"14":{"start":{"line":32,"column":2},"end":{"line":36,"column":3}},"15":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"16":{"start":{"line":34,"column":6},"end":{"line":34,"column":67}},"17":{"start":{"line":37,"column":2},"end":{"line":37,"column":12}}},"branchMap":{"1":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":32,"column":2}},{"start":{"line":32,"column":2},"end":{"line":32,"column":2}}]},"2":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"3":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":7},"end":{"line":33,"column":19}},{"start":{"line":33,"column":23},"end":{"line":33,"column":27}}]}},"code":["/**"," * Filter to keep request sequence."," */","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var taskManager = require('../../common/manager/taskManager');","","module.exports = function(timeout) {","  return new Filter(timeout);","};","","var Filter = function(timeout) {","  this.timeout = timeout;","};","","/**"," * request serialization after filter"," */","Filter.prototype.before = function(msg, session, next) {","  taskManager.addTask(session.id, function(task) {","    session.__serialTask__ = task;","    next();","  }, function() {","    logger.error('[serial filter] msg timeout, msg:' + JSON.stringify(msg));","  }, this.timeout);","};","","/**"," * request serialization after filter"," */","Filter.prototype.after = function(err, msg, session, resp, next) {","  var task = session.__serialTask__;","  if(task) {","    if(!task.done() && !err) {","      err = new Error('task time out. msg:' + JSON.stringify(msg));","    }","  }","  next(err);","};",""],"l":{"4":1,"5":1,"7":1,"8":0,"11":1,"12":0,"18":1,"19":0,"20":0,"21":0,"23":0,"30":1,"31":0,"32":0,"33":0,"34":0,"37":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/handler/time.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/handler/time.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":1,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":28}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":13},"end":{"line":12,"column":24}}},"3":{"name":"(anonymous_3)","line":15,"loc":{"start":{"line":15,"column":26},"end":{"line":15,"column":55}}},"4":{"name":"(anonymous_4)","line":20,"loc":{"start":{"line":20,"column":25},"end":{"line":20,"column":65}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":74}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"3":{"start":{"line":8,"column":0},"end":{"line":10,"column":2}},"4":{"start":{"line":9,"column":2},"end":{"line":9,"column":22}},"5":{"start":{"line":12,"column":0},"end":{"line":13,"column":2}},"6":{"start":{"line":15,"column":0},"end":{"line":18,"column":2}},"7":{"start":{"line":16,"column":2},"end":{"line":16,"column":37}},"8":{"start":{"line":17,"column":2},"end":{"line":17,"column":9}},"9":{"start":{"line":20,"column":0},"end":{"line":33,"column":2}},"10":{"start":{"line":21,"column":2},"end":{"line":21,"column":36}},"11":{"start":{"line":22,"column":2},"end":{"line":31,"column":3}},"12":{"start":{"line":23,"column":4},"end":{"line":23,"column":38}},"13":{"start":{"line":24,"column":4},"end":{"line":29,"column":6}},"14":{"start":{"line":30,"column":4},"end":{"line":30,"column":40}},"15":{"start":{"line":32,"column":2},"end":{"line":32,"column":12}}},"branchMap":{"1":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":2},"end":{"line":22,"column":2}},{"start":{"line":22,"column":2},"end":{"line":22,"column":2}}]}},"code":["/**"," * Filter for statistics."," * Record used time for each request."," */","var conLogger = require('pomelo-logger').getLogger('con-log', __filename);","var utils = require('../../util/utils');","","module.exports = function() {","  return new Filter();","};","","var Filter = function() {","};","","Filter.prototype.before = function(msg, session, next) {","  session.__startTime__ = Date.now();","  next();","};","","Filter.prototype.after = function(err, msg, session, resp, next) {","  var start = session.__startTime__;","  if(typeof start === 'number') {","    var timeUsed = Date.now() - start;","    var log = {","      route : msg.__route__,","      args : msg,","      time : utils.format(new Date(start)),","      timeUsed : timeUsed","    };","    conLogger.info(JSON.stringify(log));","  }","  next(err);","};",""],"l":{"5":1,"6":1,"8":1,"9":0,"12":1,"15":1,"16":0,"17":0,"20":1,"21":0,"22":0,"23":0,"24":0,"30":0,"32":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/handler/timeout.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/handler/timeout.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":17},"end":{"line":11,"column":44}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":13},"end":{"line":15,"column":40}}},"3":{"name":"(anonymous_3)","line":22,"loc":{"start":{"line":22,"column":26},"end":{"line":22,"column":55}}},"4":{"name":"(anonymous_4)","line":30,"loc":{"start":{"line":30,"column":41},"end":{"line":30,"column":52}}},"5":{"name":"(anonymous_5)","line":37,"loc":{"start":{"line":37,"column":25},"end":{"line":37,"column":65}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":70}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":27}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":23}},"5":{"start":{"line":11,"column":0},"end":{"line":13,"column":2}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":73}},"7":{"start":{"line":15,"column":0},"end":{"line":20,"column":2}},"8":{"start":{"line":16,"column":2},"end":{"line":16,"column":25}},"9":{"start":{"line":17,"column":2},"end":{"line":17,"column":25}},"10":{"start":{"line":18,"column":2},"end":{"line":18,"column":21}},"11":{"start":{"line":19,"column":2},"end":{"line":19,"column":17}},"12":{"start":{"line":22,"column":0},"end":{"line":35,"column":2}},"13":{"start":{"line":23,"column":2},"end":{"line":23,"column":40}},"14":{"start":{"line":24,"column":2},"end":{"line":28,"column":3}},"15":{"start":{"line":25,"column":4},"end":{"line":25,"column":107}},"16":{"start":{"line":26,"column":4},"end":{"line":26,"column":11}},"17":{"start":{"line":27,"column":4},"end":{"line":27,"column":11}},"18":{"start":{"line":29,"column":2},"end":{"line":29,"column":15}},"19":{"start":{"line":30,"column":2},"end":{"line":32,"column":19}},"20":{"start":{"line":31,"column":4},"end":{"line":31,"column":55}},"21":{"start":{"line":33,"column":2},"end":{"line":33,"column":35}},"22":{"start":{"line":34,"column":2},"end":{"line":34,"column":9}},"23":{"start":{"line":37,"column":0},"end":{"line":44,"column":2}},"24":{"start":{"line":38,"column":2},"end":{"line":38,"column":51}},"25":{"start":{"line":39,"column":2},"end":{"line":42,"column":3}},"26":{"start":{"line":40,"column":4},"end":{"line":40,"column":26}},"27":{"start":{"line":41,"column":4},"end":{"line":41,"column":46}},"28":{"start":{"line":43,"column":2},"end":{"line":43,"column":12}}},"branchMap":{"1":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":20},"end":{"line":12,"column":27}},{"start":{"line":12,"column":31},"end":{"line":12,"column":46}}]},"2":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":48},"end":{"line":12,"column":55}},{"start":{"line":12,"column":59},"end":{"line":12,"column":71}}]},"3":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":24,"column":2}},{"start":{"line":24,"column":2},"end":{"line":24,"column":2}}]},"4":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":2},"end":{"line":39,"column":2}},{"start":{"line":39,"column":2},"end":{"line":39,"column":2}}]}},"code":["/**"," * Filter for timeout."," * Print a warn information when request timeout."," */","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var utils = require('../../util/utils');","","var DEFAULT_TIMEOUT = 3000;","var DEFAULT_SIZE = 500;","","module.exports = function(timeout, maxSize) {","  return new Filter(timeout || DEFAULT_TIMEOUT, maxSize || DEFAULT_SIZE);","};","","var Filter = function(timeout, maxSize) {","  this.timeout = timeout;","  this.maxSize = maxSize;","  this.timeouts = {};","  this.curId = 0;","};","","Filter.prototype.before = function(msg, session, next) {","  var count = utils.size(this.timeouts);","  if(count > this.maxSize) {","    logger.warn('timeout filter is out of range, current size is %s, max size is %s', count, this.maxSize);","    next();","    return;","  }","  this.curId++;","  this.timeouts[this.curId] = setTimeout(function() {","    logger.error('request %j timeout.', msg.__route__);","  }, this.timeout);","  session.__timeout__ = this.curId;","  next();","};","","Filter.prototype.after = function(err, msg, session, resp, next) {","  var timeout = this.timeouts[session.__timeout__];","  if(timeout) {","    clearTimeout(timeout);","    delete this.timeouts[session.__timeout__];","  }","  next(err);","};",""],"l":{"5":1,"6":1,"8":1,"9":1,"11":1,"12":0,"15":1,"16":0,"17":0,"18":0,"19":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"29":0,"30":0,"31":0,"33":0,"34":0,"37":1,"38":0,"39":0,"40":0,"41":0,"43":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/handler/toobusy.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/handler/toobusy.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":17},"end":{"line":10,"column":34}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":13},"end":{"line":14,"column":30}}},"3":{"name":"(anonymous_3)","line":24,"loc":{"start":{"line":24,"column":26},"end":{"line":24,"column":55}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":74}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":19}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":24}},"4":{"start":{"line":10,"column":0},"end":{"line":12,"column":2}},"5":{"start":{"line":11,"column":2},"end":{"line":11,"column":46}},"6":{"start":{"line":14,"column":0},"end":{"line":22,"column":2}},"7":{"start":{"line":15,"column":2},"end":{"line":18,"column":3}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":33}},"9":{"start":{"line":19,"column":2},"end":{"line":21,"column":3}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":27}},"11":{"start":{"line":24,"column":0},"end":{"line":33,"column":2}},"12":{"start":{"line":25,"column":2},"end":{"line":32,"column":3}},"13":{"start":{"line":26,"column":4},"end":{"line":26,"column":59}},"14":{"start":{"line":27,"column":4},"end":{"line":27,"column":43}},"15":{"start":{"line":28,"column":4},"end":{"line":28,"column":19}},"16":{"start":{"line":29,"column":4},"end":{"line":29,"column":14}},"17":{"start":{"line":31,"column":4},"end":{"line":31,"column":11}}},"branchMap":{"1":{"line":11,"type":"binary-expr","locations":[{"start":{"line":11,"column":20},"end":{"line":11,"column":26}},{"start":{"line":11,"column":30},"end":{"line":11,"column":44}}]},"2":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":2},"end":{"line":19,"column":2}},{"start":{"line":19,"column":2},"end":{"line":19,"column":2}}]},"3":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":2},"end":{"line":25,"column":2}},{"start":{"line":25,"column":2},"end":{"line":25,"column":2}}]},"4":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":6},"end":{"line":25,"column":15}},{"start":{"line":25,"column":19},"end":{"line":25,"column":28}}]}},"code":["/**"," * Filter for toobusy."," * if the process is toobusy, just skip the new request"," */","var conLogger = require('pomelo-logger').getLogger('con-log', __filename);","var toobusy = null;","var DEFAULT_MAXLAG = 70;","","","module.exports = function(maxLag) {","  return new Filter(maxLag || DEFAULT_MAXLAG);","};","","var Filter = function(maxLag) {","  try {","    toobusy = require('toobusy');","  } catch(e) {","  }","  if(!!toobusy) {","    toobusy.maxLag(maxLag);","  }","};","","Filter.prototype.before = function(msg, session, next) {","  if (!!toobusy && toobusy()) {","    conLogger.warn('[toobusy] reject request msg: ' + msg);","    var err = new Error('Server toobusy!');","    err.code = 500;","    next(err);","  } else {","    next();","  }","};"],"l":{"5":1,"6":1,"7":1,"10":1,"11":0,"14":1,"15":0,"16":0,"19":0,"20":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"31":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/rpc/rpcLog.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/rpc/rpcLog.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":17},"end":{"line":8,"column":28}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":13},"end":{"line":12,"column":25}}},"3":{"name":"(anonymous_3)","line":21,"loc":{"start":{"line":21,"column":26},"end":{"line":21,"column":62}}},"4":{"name":"(anonymous_4)","line":30,"loc":{"start":{"line":30,"column":25},"end":{"line":30,"column":61}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":74}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"3":{"start":{"line":8,"column":0},"end":{"line":10,"column":2}},"4":{"start":{"line":9,"column":2},"end":{"line":9,"column":22}},"5":{"start":{"line":12,"column":0},"end":{"line":13,"column":2}},"6":{"start":{"line":15,"column":0},"end":{"line":15,"column":33}},"7":{"start":{"line":21,"column":0},"end":{"line":25,"column":2}},"8":{"start":{"line":22,"column":2},"end":{"line":22,"column":18}},"9":{"start":{"line":23,"column":2},"end":{"line":23,"column":35}},"10":{"start":{"line":24,"column":2},"end":{"line":24,"column":9}},"11":{"start":{"line":30,"column":0},"end":{"line":44,"column":2}},"12":{"start":{"line":31,"column":2},"end":{"line":42,"column":3}},"13":{"start":{"line":32,"column":4},"end":{"line":32,"column":36}},"14":{"start":{"line":33,"column":4},"end":{"line":33,"column":25}},"15":{"start":{"line":34,"column":4},"end":{"line":34,"column":31}},"16":{"start":{"line":35,"column":4},"end":{"line":40,"column":6}},"17":{"start":{"line":41,"column":4},"end":{"line":41,"column":40}},"18":{"start":{"line":43,"column":2},"end":{"line":43,"column":9}}},"branchMap":{"1":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":9},"end":{"line":22,"column":13}},{"start":{"line":22,"column":15},"end":{"line":22,"column":17}}]},"2":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":31,"column":2}},{"start":{"line":31,"column":2},"end":{"line":31,"column":2}}]},"3":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":5},"end":{"line":31,"column":11}},{"start":{"line":31,"column":15},"end":{"line":31,"column":36}}]}},"code":["/**"," * Filter for rpc log."," * Record used time for remote process call."," */","var rpcLogger = require('pomelo-logger').getLogger('rpc-log', __filename);","var utils = require('../../util/utils');","","module.exports = function() {","  return new Filter();","};","","var Filter = function () {","}; ","","Filter.prototype.name = 'rpcLog';","","/**"," * Before filter for rpc"," */","","Filter.prototype.before = function(serverId, msg, opts, next) {","  opts = opts||{};","  opts.__start_time__ = Date.now();","  next();","};","","/**"," * After filter for rpc"," */","Filter.prototype.after = function(serverId, msg, opts, next) {","  if(!!opts && !!opts.__start_time__) {","    var start = opts.__start_time__;","    var end = Date.now();","    var timeUsed = end - start;","    var log = {","      route: msg.service,","      args: msg.args,","      time: utils.format(new Date(start)),","      timeUsed: timeUsed","    };","    rpcLogger.info(JSON.stringify(log));","  }","  next();","};",""],"l":{"5":1,"6":1,"8":1,"9":0,"12":1,"15":1,"21":1,"22":0,"23":0,"24":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"41":0,"43":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/sioconnector.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/sioconnector.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1,"46":0,"47":0,"48":1,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1,"61":0,"62":1,"63":0,"64":1,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":16},"end":{"line":16,"column":43}}},"2":{"name":"(anonymous_2)","line":38,"loc":{"start":{"line":38,"column":28},"end":{"line":38,"column":41}}},"3":{"name":"(anonymous_3)","line":56,"loc":{"start":{"line":56,"column":26},"end":{"line":56,"column":38}}},"4":{"name":"(anonymous_4)","line":67,"loc":{"start":{"line":67,"column":23},"end":{"line":67,"column":41}}},"5":{"name":"(anonymous_5)","line":71,"loc":{"start":{"line":71,"column":28},"end":{"line":71,"column":45}}},"6":{"name":"(anonymous_6)","line":82,"loc":{"start":{"line":82,"column":27},"end":{"line":82,"column":47}}},"7":{"name":"(anonymous_7)","line":87,"loc":{"start":{"line":87,"column":48},"end":{"line":87,"column":76}}},"8":{"name":"(anonymous_8)","line":107,"loc":{"start":{"line":107,"column":48},"end":{"line":107,"column":62}}},"9":{"name":"(anonymous_9)","line":125,"loc":{"start":{"line":125,"column":22},"end":{"line":125,"column":54}}},"10":{"name":"(anonymous_10)","line":132,"loc":{"start":{"line":132,"column":18},"end":{"line":132,"column":43}}},"11":{"name":"(anonymous_11)","line":136,"loc":{"start":{"line":136,"column":20},"end":{"line":136,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":48}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":39}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":21}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":31}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":59}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":14}},"9":{"start":{"line":16,"column":0},"end":{"line":29,"column":2}},"10":{"start":{"line":17,"column":2},"end":{"line":19,"column":3}},"11":{"start":{"line":18,"column":4},"end":{"line":18,"column":43}},"12":{"start":{"line":21,"column":2},"end":{"line":21,"column":26}},"13":{"start":{"line":22,"column":2},"end":{"line":22,"column":19}},"14":{"start":{"line":23,"column":2},"end":{"line":23,"column":19}},"15":{"start":{"line":24,"column":2},"end":{"line":24,"column":19}},"16":{"start":{"line":25,"column":2},"end":{"line":25,"column":44}},"17":{"start":{"line":26,"column":2},"end":{"line":26,"column":46}},"18":{"start":{"line":27,"column":2},"end":{"line":27,"column":54}},"19":{"start":{"line":28,"column":2},"end":{"line":28,"column":56}},"20":{"start":{"line":31,"column":0},"end":{"line":31,"column":39}},"21":{"start":{"line":33,"column":0},"end":{"line":33,"column":27}},"22":{"start":{"line":38,"column":0},"end":{"line":77,"column":2}},"23":{"start":{"line":39,"column":2},"end":{"line":39,"column":18}},"24":{"start":{"line":41,"column":2},"end":{"line":41,"column":15}},"25":{"start":{"line":42,"column":2},"end":{"line":51,"column":3}},"26":{"start":{"line":43,"column":4},"end":{"line":43,"column":21}},"27":{"start":{"line":46,"column":4},"end":{"line":50,"column":6}},"28":{"start":{"line":53,"column":2},"end":{"line":53,"column":51}},"29":{"start":{"line":55,"column":2},"end":{"line":55,"column":23}},"30":{"start":{"line":56,"column":2},"end":{"line":58,"column":5}},"31":{"start":{"line":57,"column":4},"end":{"line":57,"column":57}},"32":{"start":{"line":59,"column":2},"end":{"line":59,"column":32}},"33":{"start":{"line":60,"column":2},"end":{"line":60,"column":46}},"34":{"start":{"line":61,"column":2},"end":{"line":61,"column":46}},"35":{"start":{"line":62,"column":2},"end":{"line":62,"column":54}},"36":{"start":{"line":63,"column":2},"end":{"line":63,"column":56}},"37":{"start":{"line":64,"column":2},"end":{"line":64,"column":41}},"38":{"start":{"line":65,"column":2},"end":{"line":65,"column":26}},"39":{"start":{"line":67,"column":2},"end":{"line":74,"column":5}},"40":{"start":{"line":69,"column":4},"end":{"line":69,"column":51}},"41":{"start":{"line":70,"column":4},"end":{"line":70,"column":39}},"42":{"start":{"line":71,"column":4},"end":{"line":73,"column":7}},"43":{"start":{"line":72,"column":6},"end":{"line":72,"column":56}},"44":{"start":{"line":76,"column":2},"end":{"line":76,"column":23}},"45":{"start":{"line":82,"column":0},"end":{"line":85,"column":2}},"46":{"start":{"line":83,"column":2},"end":{"line":83,"column":30}},"47":{"start":{"line":84,"column":2},"end":{"line":84,"column":23}},"48":{"start":{"line":87,"column":0},"end":{"line":93,"column":2}},"49":{"start":{"line":88,"column":2},"end":{"line":92,"column":3}},"50":{"start":{"line":89,"column":4},"end":{"line":89,"column":46}},"51":{"start":{"line":91,"column":4},"end":{"line":91,"column":35}},"52":{"start":{"line":107,"column":0},"end":{"line":123,"column":2}},"53":{"start":{"line":108,"column":2},"end":{"line":108,"column":16}},"54":{"start":{"line":110,"column":2},"end":{"line":110,"column":51}},"55":{"start":{"line":111,"column":2},"end":{"line":111,"column":24}},"56":{"start":{"line":113,"column":2},"end":{"line":113,"column":67}},"57":{"start":{"line":115,"column":2},"end":{"line":115,"column":51}},"58":{"start":{"line":116,"column":2},"end":{"line":116,"column":51}},"59":{"start":{"line":118,"column":2},"end":{"line":122,"column":4}},"60":{"start":{"line":125,"column":0},"end":{"line":130,"column":2}},"61":{"start":{"line":126,"column":2},"end":{"line":129,"column":4}},"62":{"start":{"line":132,"column":0},"end":{"line":134,"column":2}},"63":{"start":{"line":133,"column":2},"end":{"line":133,"column":55}},"64":{"start":{"line":136,"column":0},"end":{"line":146,"column":2}},"65":{"start":{"line":137,"column":2},"end":{"line":137,"column":14}},"66":{"start":{"line":138,"column":2},"end":{"line":143,"column":3}},"67":{"start":{"line":139,"column":4},"end":{"line":141,"column":5}},"68":{"start":{"line":140,"column":6},"end":{"line":140,"column":16}},"69":{"start":{"line":142,"column":4},"end":{"line":142,"column":45}},"70":{"start":{"line":145,"column":2},"end":{"line":145,"column":13}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":2},"end":{"line":17,"column":2}},{"start":{"line":17,"column":2},"end":{"line":17,"column":2}}]},"2":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":20},"end":{"line":25,"column":35}},{"start":{"line":25,"column":39},"end":{"line":25,"column":43}}]},"3":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":22},"end":{"line":26,"column":39}},{"start":{"line":26,"column":43},"end":{"line":26,"column":45}}]},"4":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":26},"end":{"line":27,"column":47}},{"start":{"line":27,"column":51},"end":{"line":27,"column":53}}]},"5":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":27},"end":{"line":28,"column":49}},{"start":{"line":28,"column":53},"end":{"line":28,"column":55}}]},"6":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":2},"end":{"line":42,"column":2}},{"start":{"line":42,"column":2},"end":{"line":42,"column":2}}]},"7":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":2},"end":{"line":88,"column":2}},{"start":{"line":88,"column":2},"end":{"line":88,"column":2}}]},"8":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":4},"end":{"line":139,"column":4}},{"start":{"line":139,"column":4},"end":{"line":139,"column":4}}]}},"code":["var util = require('util');","var EventEmitter = require('events').EventEmitter;","var httpServer = require('http').createServer();","var SioSocket = require('./siosocket');","","var PKG_ID_BYTES = 4;","var PKG_ROUTE_LENGTH_BYTES = 1;","var PKG_HEAD_BYTES = PKG_ID_BYTES + PKG_ROUTE_LENGTH_BYTES;","","var curId = 1;","","/**"," * Connector that manager low level connection and protocol bewteen server and client."," * Develper can provide their own connector to switch the low level prototol, such as tcp or probuf."," */","var Connector = function(port, host, opts) {","  if (!(this instanceof Connector)) {","    return new Connector(port, host, opts);","  }","","  EventEmitter.call(this);","  this.port = port;","  this.host = host;","  this.opts = opts;","  this.heartbeats = opts.heartbeats || true;","  this.closeTimeout = opts.closeTimeout || 60;","  this.heartbeatTimeout = opts.heartbeatTimeout || 60;","  this.heartbeatInterval = opts.heartbeatInterval || 25;","};","","util.inherits(Connector, EventEmitter);","","module.exports = Connector;","","/**"," * Start connector to listen the specified port"," */","Connector.prototype.start = function(cb) {","  var self = this;","  // issue https://github.com/NetEase/pomelo-cn/issues/174","  var opts = {}","  if(!!this.opts) {","    opts = this.opts;","  }","  else {","    opts = {","      transports: [","      'websocket', 'polling-xhr', 'polling-jsonp', 'polling'","      ]","    };","  }","","  var sio = require('socket.io')(httpServer, opts);","","  var port = this.port;","  httpServer.listen(port, function () {","    console.log('sio Server listening at port %d', port);","  });","  sio.set('path', '/socket.io');","  sio.set('transports', this.opts.transports);","  sio.set('close timeout', this.closeTimeout);","  sio.set('heartbeat timeout', this.heartbeatTimeout);","  sio.set('heartbeat interval', this.heartbeatInterval);","  sio.set('heartbeats', this.heartbeats);","  sio.set('log level', 1);","","  sio.on('connection', function (socket) {","  // this.wsocket.sockets.on('connection', function (socket) {","    var siosocket = new SioSocket(curId++, socket);","    self.emit('connection', siosocket);","    siosocket.on('closing', function(reason) {","      siosocket.send({route: 'onKick', reason: reason});","    });","  });","","  process.nextTick(cb);","};","","/**"," * Stop connector"," */","Connector.prototype.stop = function(force, cb) {","  this.wsocket.server.close();","  process.nextTick(cb);","};","","Connector.encode = Connector.prototype.encode = function(reqId, route, msg) {","  if(reqId) {","    return composeResponse(reqId, route, msg);","  } else {","    return composePush(route, msg);","  }","};","","/**"," * Decode client message package."," *"," * Package format:"," *   message id: 4bytes big-endian integer"," *   route length: 1byte"," *   route: route length bytes"," *   body: the rest bytes"," *"," * @param  {String} data socket.io package from client"," * @return {Object}      message object"," */","Connector.decode = Connector.prototype.decode = function(msg) {","  var index = 0;","","  var id = parseIntField(msg, index, PKG_ID_BYTES);","  index += PKG_ID_BYTES;","","  var routeLen = parseIntField(msg, index, PKG_ROUTE_LENGTH_BYTES);","","  var route = msg.substr(PKG_HEAD_BYTES, routeLen);","  var body = msg.substr(PKG_HEAD_BYTES + routeLen);","","  return {","    id: id,","    route: route,","    body: JSON.parse(body)","  };","};","","var composeResponse = function(msgId, route, msgBody) {","  return {","    id: msgId,","    body: msgBody","  };","};","","var composePush = function(route, msgBody) {","  return JSON.stringify({route: route, body: msgBody});","};","","var parseIntField = function(str, offset, len) {","  var res = 0;","  for(var i=0; i<len; i++) {","    if(i > 0) {","      res <<= 8;","    }","    res |= str.charCodeAt(offset + i) & 0xff;","  }","","  return res;","};"],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"7":1,"8":1,"10":1,"16":1,"17":0,"18":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"31":1,"33":1,"38":1,"39":0,"41":0,"42":0,"43":0,"46":0,"53":0,"55":0,"56":0,"57":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"67":0,"69":0,"70":0,"71":0,"72":0,"76":0,"82":1,"83":0,"84":0,"87":1,"88":0,"89":0,"91":0,"107":1,"108":0,"110":0,"111":0,"113":0,"115":0,"116":0,"118":0,"125":1,"126":0,"132":1,"133":0,"136":1,"137":0,"138":0,"139":0,"140":0,"142":0,"145":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/siosocket.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/siosocket.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":1,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":13},"end":{"line":10,"column":34}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":23},"end":{"line":25,"column":37}}},"3":{"name":"(anonymous_3)","line":38,"loc":{"start":{"line":38,"column":24},"end":{"line":38,"column":38}}},"4":{"name":"(anonymous_4)","line":48,"loc":{"start":{"line":48,"column":30},"end":{"line":48,"column":41}}},"5":{"name":"(anonymous_5)","line":57,"loc":{"start":{"line":57,"column":29},"end":{"line":57,"column":44}}},"6":{"name":"(anonymous_6)","line":64,"loc":{"start":{"line":64,"column":18},"end":{"line":64,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":18}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":18}},"5":{"start":{"line":10,"column":0},"end":{"line":32,"column":2}},"6":{"start":{"line":11,"column":2},"end":{"line":11,"column":26}},"7":{"start":{"line":12,"column":2},"end":{"line":12,"column":15}},"8":{"start":{"line":13,"column":2},"end":{"line":13,"column":23}},"9":{"start":{"line":14,"column":2},"end":{"line":17,"column":4}},"10":{"start":{"line":19,"column":2},"end":{"line":19,"column":18}},"11":{"start":{"line":21,"column":2},"end":{"line":21,"column":62}},"12":{"start":{"line":23,"column":2},"end":{"line":23,"column":52}},"13":{"start":{"line":25,"column":2},"end":{"line":27,"column":5}},"14":{"start":{"line":26,"column":4},"end":{"line":26,"column":30}},"15":{"start":{"line":29,"column":2},"end":{"line":29,"column":25}},"16":{"start":{"line":34,"column":0},"end":{"line":34,"column":36}},"17":{"start":{"line":36,"column":0},"end":{"line":36,"column":24}},"18":{"start":{"line":38,"column":0},"end":{"line":46,"column":2}},"19":{"start":{"line":39,"column":2},"end":{"line":41,"column":3}},"20":{"start":{"line":40,"column":4},"end":{"line":40,"column":11}},"21":{"start":{"line":42,"column":2},"end":{"line":44,"column":3}},"22":{"start":{"line":43,"column":4},"end":{"line":43,"column":30}},"23":{"start":{"line":45,"column":2},"end":{"line":45,"column":24}},"24":{"start":{"line":48,"column":0},"end":{"line":55,"column":2}},"25":{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},"26":{"start":{"line":50,"column":4},"end":{"line":50,"column":11}},"27":{"start":{"line":53,"column":2},"end":{"line":53,"column":25}},"28":{"start":{"line":54,"column":2},"end":{"line":54,"column":27}},"29":{"start":{"line":57,"column":0},"end":{"line":59,"column":2}},"30":{"start":{"line":58,"column":2},"end":{"line":58,"column":31}},"31":{"start":{"line":64,"column":0},"end":{"line":79,"column":2}},"32":{"start":{"line":65,"column":2},"end":{"line":65,"column":21}},"33":{"start":{"line":66,"column":2},"end":{"line":76,"column":3}},"34":{"start":{"line":67,"column":4},"end":{"line":69,"column":5}},"35":{"start":{"line":68,"column":6},"end":{"line":68,"column":17}},"36":{"start":{"line":70,"column":4},"end":{"line":70,"column":18}},"37":{"start":{"line":71,"column":4},"end":{"line":75,"column":5}},"38":{"start":{"line":72,"column":6},"end":{"line":72,"column":17}},"39":{"start":{"line":74,"column":6},"end":{"line":74,"column":33}},"40":{"start":{"line":77,"column":2},"end":{"line":77,"column":13}},"41":{"start":{"line":78,"column":2},"end":{"line":78,"column":13}}},"branchMap":{"1":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":2},"end":{"line":39,"column":2}},{"start":{"line":39,"column":2},"end":{"line":39,"column":2}}]},"2":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":2},"end":{"line":42,"column":2}},{"start":{"line":42,"column":2},"end":{"line":42,"column":2}}]},"3":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":2},"end":{"line":49,"column":2}},{"start":{"line":49,"column":2},"end":{"line":49,"column":2}}]},"4":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":67,"column":4}},{"start":{"line":67,"column":4},"end":{"line":67,"column":4}}]},"5":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":4},"end":{"line":71,"column":4}},{"start":{"line":71,"column":4},"end":{"line":71,"column":4}}]}},"code":["var util = require('util');","var EventEmitter = require('events').EventEmitter;","","var ST_INITED = 0;","var ST_CLOSED = 1;","","/**"," * Socket class that wraps socket.io socket to provide unified interface for up level."," */","var Socket = function(id, socket) {","  EventEmitter.call(this);","  this.id = id;","  this.socket = socket;","  this.remoteAddress = {","    ip: socket.handshake.address.address,","    port: socket.handshake.address.port","  };","","  var self = this;","","  socket.on('disconnect', this.emit.bind(this, 'disconnect'));","","  socket.on('error', this.emit.bind(this, 'error'));","","  socket.on('message', function(msg) {","    self.emit('message', msg);","  });","","  this.state = ST_INITED;","","  // TODO: any other events?","};","","util.inherits(Socket, EventEmitter);","","module.exports = Socket;","","Socket.prototype.send = function(msg) {","  if(this.state !== ST_INITED) {","    return;","  }","  if(typeof msg !== 'string') {","    msg = JSON.stringify(msg);","  }","  this.socket.send(msg);","};","","Socket.prototype.disconnect = function() {","  if(this.state === ST_CLOSED) {","    return;","  }","","  this.state = ST_CLOSED;","  this.socket.disconnect();","};","","Socket.prototype.sendBatch = function(msgs) {","  this.send(encodeBatch(msgs));","};","","/**"," * Encode batch msg to client"," */","var encodeBatch = function(msgs){","  var res = '[', msg;","  for(var i=0, l=msgs.length; i<l; i++) {","    if(i > 0) {","      res += ',';","    }","    msg = msgs[i];","    if(typeof msg === 'string') {","      res += msg;","    } else {","      res += JSON.stringify(msg);","    }","  }","  res += ']';","  return res;","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"10":1,"11":0,"12":0,"13":0,"14":0,"19":0,"21":0,"23":0,"25":0,"26":0,"29":0,"34":1,"36":1,"38":1,"39":0,"40":0,"42":0,"43":0,"45":0,"48":1,"49":0,"50":0,"53":0,"54":0,"57":1,"58":0,"64":1,"65":0,"66":0,"67":0,"68":0,"70":0,"71":0,"72":0,"74":0,"77":0,"78":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybridconnector.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybridconnector.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":1,"57":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":19,"loc":{"start":{"line":19,"column":16},"end":{"line":19,"column":43}}},"2":{"name":"(anonymous_2)","line":46,"loc":{"start":{"line":46,"column":28},"end":{"line":46,"column":41}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":18},"end":{"line":50,"column":35}}},"4":{"name":"(anonymous_4)","line":71,"loc":{"start":{"line":71,"column":33},"end":{"line":71,"column":50}}},"5":{"name":"(anonymous_5)","line":84,"loc":{"start":{"line":84,"column":27},"end":{"line":84,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":25}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":25}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":50}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":45}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":44}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":48}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":48}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":38}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":38}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":14}},"12":{"start":{"line":19,"column":0},"end":{"line":37,"column":2}},"13":{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},"14":{"start":{"line":21,"column":4},"end":{"line":21,"column":43}},"15":{"start":{"line":24,"column":2},"end":{"line":24,"column":26}},"16":{"start":{"line":26,"column":2},"end":{"line":26,"column":25}},"17":{"start":{"line":27,"column":2},"end":{"line":27,"column":19}},"18":{"start":{"line":28,"column":2},"end":{"line":28,"column":19}},"19":{"start":{"line":29,"column":2},"end":{"line":29,"column":30}},"20":{"start":{"line":30,"column":2},"end":{"line":30,"column":38}},"21":{"start":{"line":31,"column":2},"end":{"line":31,"column":39}},"22":{"start":{"line":32,"column":2},"end":{"line":32,"column":39}},"23":{"start":{"line":33,"column":2},"end":{"line":33,"column":40}},"24":{"start":{"line":34,"column":2},"end":{"line":34,"column":22}},"25":{"start":{"line":36,"column":2},"end":{"line":36,"column":23}},"26":{"start":{"line":39,"column":0},"end":{"line":39,"column":39}},"27":{"start":{"line":41,"column":0},"end":{"line":41,"column":27}},"28":{"start":{"line":46,"column":0},"end":{"line":82,"column":2}},"29":{"start":{"line":47,"column":2},"end":{"line":47,"column":37}},"30":{"start":{"line":48,"column":2},"end":{"line":48,"column":18}},"31":{"start":{"line":50,"column":2},"end":{"line":57,"column":4}},"32":{"start":{"line":51,"column":4},"end":{"line":51,"column":57}},"33":{"start":{"line":52,"column":4},"end":{"line":52,"column":91}},"34":{"start":{"line":53,"column":4},"end":{"line":53,"column":91}},"35":{"start":{"line":54,"column":4},"end":{"line":54,"column":94}},"36":{"start":{"line":55,"column":4},"end":{"line":55,"column":69}},"37":{"start":{"line":56,"column":4},"end":{"line":56,"column":42}},"38":{"start":{"line":59,"column":2},"end":{"line":59,"column":58}},"39":{"start":{"line":60,"column":2},"end":{"line":60,"column":50}},"40":{"start":{"line":61,"column":2},"end":{"line":61,"column":46}},"41":{"start":{"line":62,"column":2},"end":{"line":62,"column":65}},"42":{"start":{"line":64,"column":2},"end":{"line":68,"column":3}},"43":{"start":{"line":65,"column":4},"end":{"line":65,"column":46}},"44":{"start":{"line":67,"column":4},"end":{"line":67,"column":54}},"45":{"start":{"line":69,"column":2},"end":{"line":69,"column":64}},"46":{"start":{"line":71,"column":2},"end":{"line":73,"column":5}},"47":{"start":{"line":72,"column":4},"end":{"line":72,"column":22}},"48":{"start":{"line":75,"column":2},"end":{"line":79,"column":3}},"49":{"start":{"line":76,"column":4},"end":{"line":76,"column":54}},"50":{"start":{"line":78,"column":4},"end":{"line":78,"column":43}},"51":{"start":{"line":81,"column":2},"end":{"line":81,"column":23}},"52":{"start":{"line":84,"column":0},"end":{"line":89,"column":2}},"53":{"start":{"line":85,"column":2},"end":{"line":85,"column":24}},"54":{"start":{"line":86,"column":2},"end":{"line":86,"column":31}},"55":{"start":{"line":88,"column":2},"end":{"line":88,"column":23}},"56":{"start":{"line":91,"column":0},"end":{"line":91,"column":61}},"57":{"start":{"line":93,"column":0},"end":{"line":93,"column":61}}},"branchMap":{"1":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":20,"column":2}},{"start":{"line":20,"column":2},"end":{"line":20,"column":2}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":14},"end":{"line":26,"column":18}},{"start":{"line":26,"column":22},"end":{"line":26,"column":24}}]},"3":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":2},"end":{"line":64,"column":2}},{"start":{"line":64,"column":2},"end":{"line":64,"column":2}}]},"4":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":2},"end":{"line":75,"column":2}},{"start":{"line":75,"column":2},"end":{"line":75,"column":2}}]}},"code":["var net = require('net');","var tls = require('tls');","var util = require('util');","var EventEmitter = require('events').EventEmitter;","","var HybridSocket = require('./hybridsocket');","var Switcher = require('./hybrid/switcher');","var Handshake = require('./commands/handshake');","var Heartbeat = require('./commands/heartbeat');","var Kick = require('./commands/kick');","var coder = require('./common/coder');","","var curId = 1;","","/**"," * Connector that manager low level connection and protocol bewteen server and client."," * Develper can provide their own connector to switch the low level prototol, such as tcp or probuf."," */","var Connector = function(port, host, opts) {","  if (!(this instanceof Connector)) {","    return new Connector(port, host, opts);","  }","","  EventEmitter.call(this);","","  this.opts = opts || {};","  this.port = port;","  this.host = host;","  this.useDict = opts.useDict;","  this.useProtobuf = opts.useProtobuf;","  this.handshake = new Handshake(opts);","  this.heartbeat = new Heartbeat(opts);","  this.distinctHost = opts.distinctHost;","  this.ssl = opts.ssl;","","  this.switcher = null;","};","","util.inherits(Connector, EventEmitter);","","module.exports = Connector;","","/**"," * Start connector to listen the specified port"," */","Connector.prototype.start = function(cb) {","  var app = require('../pomelo').app;","  var self = this;","","  var gensocket = function(socket) {","    var hybridsocket = new HybridSocket(curId++, socket);","    hybridsocket.on('handshake', self.handshake.handle.bind(self.handshake, hybridsocket));","    hybridsocket.on('heartbeat', self.heartbeat.handle.bind(self.heartbeat, hybridsocket));","    hybridsocket.on('disconnect', self.heartbeat.clear.bind(self.heartbeat, hybridsocket.id));","    hybridsocket.on('closing', Kick.handle.bind(null, hybridsocket));","    self.emit('connection', hybridsocket);","  };","","  this.connector = app.components.__connector__.connector;","  this.dictionary = app.components.__dictionary__;","  this.protobuf = app.components.__protobuf__;","  this.decodeIO_protobuf = app.components.__decodeIO__protobuf__;","","  if(!this.ssl) {","    this.listeningServer = net.createServer();","  } else {","    this.listeningServer = tls.createServer(this.ssl);","  }","  this.switcher = new Switcher(this.listeningServer, self.opts);","","  this.switcher.on('connection', function(socket) {","    gensocket(socket);","  });","","  if(!!this.distinctHost) {","    this.listeningServer.listen(this.port, this.host);","  } else {","    this.listeningServer.listen(this.port);","  }","","  process.nextTick(cb);","};","","Connector.prototype.stop = function(force, cb) {","  this.switcher.close();","  this.listeningServer.close();","","  process.nextTick(cb);","};","","Connector.decode = Connector.prototype.decode = coder.decode;","","Connector.encode = Connector.prototype.encode = coder.encode;",""],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"13":1,"19":1,"20":0,"21":0,"24":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"36":0,"39":1,"41":1,"46":1,"47":0,"48":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"59":0,"60":0,"61":0,"62":0,"64":0,"65":0,"67":0,"69":0,"71":0,"72":0,"75":0,"76":0,"78":0,"81":0,"84":1,"85":0,"86":0,"88":0,"91":1,"93":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybridsocket.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybridsocket.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":1,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":1,"58":0,"59":0,"60":0,"61":0,"62":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":13},"end":{"line":16,"column":34}}},"2":{"name":"(anonymous_2)","line":38,"loc":{"start":{"line":38,"column":23},"end":{"line":38,"column":37}}},"3":{"name":"(anonymous_3)","line":59,"loc":{"start":{"line":59,"column":27},"end":{"line":59,"column":41}}},"4":{"name":"(anonymous_4)","line":65,"loc":{"start":{"line":65,"column":40},"end":{"line":65,"column":54}}},"5":{"name":"(anonymous_5)","line":78,"loc":{"start":{"line":78,"column":24},"end":{"line":78,"column":38}}},"6":{"name":"(anonymous_6)","line":92,"loc":{"start":{"line":92,"column":29},"end":{"line":92,"column":44}}},"7":{"name":"(anonymous_7)","line":106,"loc":{"start":{"line":106,"column":29},"end":{"line":106,"column":43}}},"8":{"name":"(anonymous_8)","line":118,"loc":{"start":{"line":118,"column":37},"end":{"line":118,"column":52}}},"9":{"name":"(anonymous_9)","line":132,"loc":{"start":{"line":132,"column":30},"end":{"line":132,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":42}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":70}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":31}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":18}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":20}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":19}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":18}},"11":{"start":{"line":16,"column":0},"end":{"line":48,"column":2}},"12":{"start":{"line":17,"column":2},"end":{"line":17,"column":26}},"13":{"start":{"line":18,"column":2},"end":{"line":18,"column":15}},"14":{"start":{"line":19,"column":2},"end":{"line":19,"column":23}},"15":{"start":{"line":21,"column":2},"end":{"line":31,"column":3}},"16":{"start":{"line":22,"column":4},"end":{"line":25,"column":6}},"17":{"start":{"line":27,"column":4},"end":{"line":30,"column":6}},"18":{"start":{"line":33,"column":2},"end":{"line":33,"column":18}},"19":{"start":{"line":35,"column":2},"end":{"line":35,"column":59}},"20":{"start":{"line":36,"column":2},"end":{"line":36,"column":52}},"21":{"start":{"line":38,"column":2},"end":{"line":43,"column":5}},"22":{"start":{"line":39,"column":4},"end":{"line":42,"column":5}},"23":{"start":{"line":40,"column":6},"end":{"line":40,"column":32}},"24":{"start":{"line":41,"column":6},"end":{"line":41,"column":25}},"25":{"start":{"line":45,"column":2},"end":{"line":45,"column":25}},"26":{"start":{"line":50,"column":0},"end":{"line":50,"column":36}},"27":{"start":{"line":52,"column":0},"end":{"line":52,"column":24}},"28":{"start":{"line":59,"column":0},"end":{"line":71,"column":2}},"29":{"start":{"line":60,"column":2},"end":{"line":62,"column":3}},"30":{"start":{"line":61,"column":4},"end":{"line":61,"column":11}},"31":{"start":{"line":63,"column":2},"end":{"line":63,"column":18}},"32":{"start":{"line":65,"column":2},"end":{"line":70,"column":5}},"33":{"start":{"line":66,"column":4},"end":{"line":69,"column":5}},"34":{"start":{"line":67,"column":6},"end":{"line":67,"column":71}},"35":{"start":{"line":68,"column":6},"end":{"line":68,"column":13}},"36":{"start":{"line":78,"column":0},"end":{"line":85,"column":2}},"37":{"start":{"line":79,"column":2},"end":{"line":83,"column":3}},"38":{"start":{"line":80,"column":4},"end":{"line":80,"column":26}},"39":{"start":{"line":81,"column":9},"end":{"line":83,"column":3}},"40":{"start":{"line":82,"column":4},"end":{"line":82,"column":42}},"41":{"start":{"line":84,"column":2},"end":{"line":84,"column":55}},"42":{"start":{"line":92,"column":0},"end":{"line":99,"column":2}},"43":{"start":{"line":93,"column":2},"end":{"line":93,"column":14}},"44":{"start":{"line":94,"column":2},"end":{"line":97,"column":3}},"45":{"start":{"line":95,"column":4},"end":{"line":95,"column":57}},"46":{"start":{"line":96,"column":4},"end":{"line":96,"column":17}},"47":{"start":{"line":98,"column":2},"end":{"line":98,"column":34}},"48":{"start":{"line":106,"column":0},"end":{"line":111,"column":2}},"49":{"start":{"line":107,"column":2},"end":{"line":109,"column":3}},"50":{"start":{"line":108,"column":4},"end":{"line":108,"column":11}},"51":{"start":{"line":110,"column":2},"end":{"line":110,"column":40}},"52":{"start":{"line":118,"column":0},"end":{"line":125,"column":2}},"53":{"start":{"line":119,"column":2},"end":{"line":121,"column":3}},"54":{"start":{"line":120,"column":4},"end":{"line":120,"column":11}},"55":{"start":{"line":123,"column":2},"end":{"line":123,"column":41}},"56":{"start":{"line":124,"column":2},"end":{"line":124,"column":27}},"57":{"start":{"line":132,"column":0},"end":{"line":140,"column":2}},"58":{"start":{"line":133,"column":2},"end":{"line":135,"column":3}},"59":{"start":{"line":134,"column":4},"end":{"line":134,"column":11}},"60":{"start":{"line":137,"column":2},"end":{"line":137,"column":25}},"61":{"start":{"line":138,"column":2},"end":{"line":138,"column":28}},"62":{"start":{"line":139,"column":2},"end":{"line":139,"column":22}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":2},"end":{"line":21,"column":2}},{"start":{"line":21,"column":2},"end":{"line":21,"column":2}}]},"2":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"3":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":60,"column":2}},{"start":{"line":60,"column":2},"end":{"line":60,"column":2}}]},"4":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":4}},{"start":{"line":66,"column":4},"end":{"line":66,"column":4}}]},"5":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":2},"end":{"line":79,"column":2}},{"start":{"line":79,"column":2},"end":{"line":79,"column":2}}]},"6":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":9},"end":{"line":81,"column":9}},{"start":{"line":81,"column":9},"end":{"line":81,"column":9}}]},"7":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":2},"end":{"line":107,"column":2}},{"start":{"line":107,"column":2},"end":{"line":107,"column":2}}]},"8":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":2},"end":{"line":119,"column":2}},{"start":{"line":119,"column":2},"end":{"line":119,"column":2}}]},"9":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":2},"end":{"line":133,"column":2}},{"start":{"line":133,"column":2},"end":{"line":133,"column":2}}]}},"code":["var util = require('util');","var EventEmitter = require('events').EventEmitter;","var handler = require('./common/handler');","var protocol = require('pomelo-protocol');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var Package = protocol.Package;","","var ST_INITED = 0;","var ST_WAIT_ACK = 1;","var ST_WORKING = 2;","var ST_CLOSED = 3;","","/**"," * Socket class that wraps socket and websocket to provide unified interface for up level."," */","var Socket = function(id, socket) {","  EventEmitter.call(this);","  this.id = id;","  this.socket = socket;","","  if(!socket._socket) {","    this.remoteAddress = {","      ip: socket.address().address,","      port: socket.address().port","    };","  } else {","    this.remoteAddress = {","      ip: socket._socket.remoteAddress,","      port: socket._socket.remotePort","    };","  }","","  var self = this;","","  socket.once('close', this.emit.bind(this, 'disconnect'));","  socket.on('error', this.emit.bind(this, 'error'));","","  socket.on('message', function(msg) {","    if(msg) {","      msg = Package.decode(msg);","      handler(self, msg);","    }","  });","","  this.state = ST_INITED;","","  // TODO: any other events?","};","","util.inherits(Socket, EventEmitter);","","module.exports = Socket;","","/**"," * Send raw byte data."," *"," * @api private"," */","Socket.prototype.sendRaw = function(msg) {","  if(this.state !== ST_WORKING) {","    return;","  }","  var self = this;","","  this.socket.send(msg, {binary: true}, function(err) {","    if(!!err) {","      logger.error('websocket send binary data failed: %j', err.stack);","      return;","    }","  });","};","","/**"," * Send byte data package to client."," *"," * @param  {Buffer} msg byte data"," */","Socket.prototype.send = function(msg) {","  if(msg instanceof String) {","    msg = new Buffer(msg);","  } else if(!(msg instanceof Buffer)) {","    msg = new Buffer(JSON.stringify(msg));","  }","  this.sendRaw(Package.encode(Package.TYPE_DATA, msg));","};","","/**"," * Send byte data packages to client in batch."," *"," * @param  {Buffer} msgs byte data"," */","Socket.prototype.sendBatch = function(msgs) {","  var rs = [];","  for(var i=0; i<msgs.length; i++) {","    var src = Package.encode(Package.TYPE_DATA, msgs[i]);","    rs.push(src);","  }","  this.sendRaw(Buffer.concat(rs));","};","","/**"," * Send message to client no matter whether handshake."," *"," * @api private"," */","Socket.prototype.sendForce = function(msg) {","  if(this.state === ST_CLOSED) {","    return;","  }","  this.socket.send(msg, {binary: true});","};","","/**"," * Response handshake request"," *"," * @api private"," */","Socket.prototype.handshakeResponse = function(resp) {","  if(this.state !== ST_INITED) {","    return;","  }","","  this.socket.send(resp, {binary: true});","  this.state = ST_WAIT_ACK;","};","","/**"," * Close the connection."," *"," * @api private"," */","Socket.prototype.disconnect = function() {","  if(this.state === ST_CLOSED) {","    return;","  }","","  this.state = ST_CLOSED;","  this.socket.emit('close');","  this.socket.close();","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"9":1,"10":1,"11":1,"16":1,"17":0,"18":0,"19":0,"21":0,"22":0,"27":0,"33":0,"35":0,"36":0,"38":0,"39":0,"40":0,"41":0,"45":0,"50":1,"52":1,"59":1,"60":0,"61":0,"63":0,"65":0,"66":0,"67":0,"68":0,"78":1,"79":0,"80":0,"81":0,"82":0,"84":0,"92":1,"93":0,"94":0,"95":0,"96":0,"98":0,"106":1,"107":0,"108":0,"110":0,"118":1,"119":0,"120":0,"123":0,"124":0,"132":1,"133":0,"134":0,"137":0,"138":0,"139":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/common/handler.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/common/handler.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":1,"29":1,"30":1,"31":1,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":22},"end":{"line":12,"column":44}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":25},"end":{"line":23,"column":47}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":22},"end":{"line":31,"column":44}}},"4":{"name":"(anonymous_4)","line":38,"loc":{"start":{"line":38,"column":17},"end":{"line":38,"column":39}}},"5":{"name":"(anonymous_5)","line":50,"loc":{"start":{"line":50,"column":13},"end":{"line":50,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":42}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":70}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":18}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":18}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":20}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":19}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":18}},"9":{"start":{"line":12,"column":0},"end":{"line":21,"column":2}},"10":{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},"11":{"start":{"line":14,"column":4},"end":{"line":14,"column":11}},"12":{"start":{"line":16,"column":2},"end":{"line":20,"column":3}},"13":{"start":{"line":17,"column":4},"end":{"line":17,"column":71}},"14":{"start":{"line":19,"column":4},"end":{"line":19,"column":33}},"15":{"start":{"line":23,"column":0},"end":{"line":29,"column":2}},"16":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"17":{"start":{"line":25,"column":4},"end":{"line":25,"column":11}},"18":{"start":{"line":27,"column":2},"end":{"line":27,"column":28}},"19":{"start":{"line":28,"column":2},"end":{"line":28,"column":27}},"20":{"start":{"line":31,"column":0},"end":{"line":36,"column":2}},"21":{"start":{"line":32,"column":2},"end":{"line":34,"column":3}},"22":{"start":{"line":33,"column":4},"end":{"line":33,"column":11}},"23":{"start":{"line":35,"column":2},"end":{"line":35,"column":27}},"24":{"start":{"line":38,"column":0},"end":{"line":43,"column":2}},"25":{"start":{"line":39,"column":2},"end":{"line":41,"column":3}},"26":{"start":{"line":40,"column":4},"end":{"line":40,"column":11}},"27":{"start":{"line":42,"column":2},"end":{"line":42,"column":30}},"28":{"start":{"line":45,"column":0},"end":{"line":45,"column":51}},"29":{"start":{"line":46,"column":0},"end":{"line":46,"column":58}},"30":{"start":{"line":47,"column":0},"end":{"line":47,"column":51}},"31":{"start":{"line":48,"column":0},"end":{"line":48,"column":41}},"32":{"start":{"line":50,"column":0},"end":{"line":58,"column":2}},"33":{"start":{"line":51,"column":2},"end":{"line":51,"column":35}},"34":{"start":{"line":52,"column":2},"end":{"line":57,"column":3}},"35":{"start":{"line":53,"column":4},"end":{"line":53,"column":25}},"36":{"start":{"line":55,"column":4},"end":{"line":55,"column":64}},"37":{"start":{"line":56,"column":4},"end":{"line":56,"column":24}},"38":{"start":{"line":60,"column":0},"end":{"line":60,"column":24}}},"branchMap":{"1":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":2},"end":{"line":13,"column":2}},{"start":{"line":13,"column":2},"end":{"line":13,"column":2}}]},"2":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":24,"column":2}},{"start":{"line":24,"column":2},"end":{"line":24,"column":2}}]},"3":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":32,"column":2}},{"start":{"line":32,"column":2},"end":{"line":32,"column":2}}]},"4":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":2},"end":{"line":39,"column":2}},{"start":{"line":39,"column":2},"end":{"line":39,"column":2}}]},"5":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":52,"column":2}},{"start":{"line":52,"column":2},"end":{"line":52,"column":2}}]}},"code":["var protocol = require('pomelo-protocol');","var Package = protocol.Package;","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","var handlers = {};","","var ST_INITED = 0;","var ST_WAIT_ACK = 1;","var ST_WORKING = 2;","var ST_CLOSED = 3;","","var handleHandshake = function(socket, pkg) {","  if(socket.state !== ST_INITED) {","    return;","  }","  try {","    socket.emit('handshake', JSON.parse(protocol.strdecode(pkg.body)));","  } catch (ex) {","    socket.emit('handshake', {});","  }","};","","var handleHandshakeAck = function(socket, pkg) {","  if(socket.state !== ST_WAIT_ACK) {","    return;","  }","  socket.state = ST_WORKING;","  socket.emit('heartbeat');","};","","var handleHeartbeat = function(socket, pkg) {","  if(socket.state !== ST_WORKING) {","    return;","  }","  socket.emit('heartbeat');","};","","var handleData = function(socket, pkg) {","  if(socket.state !== ST_WORKING) {","    return;","  }","  socket.emit('message', pkg);","};","","handlers[Package.TYPE_HANDSHAKE] = handleHandshake;","handlers[Package.TYPE_HANDSHAKE_ACK] = handleHandshakeAck;","handlers[Package.TYPE_HEARTBEAT] = handleHeartbeat;","handlers[Package.TYPE_DATA] = handleData;","","var handle = function(socket, pkg) {","  var handler = handlers[pkg.type];","  if(!!handler) {","    handler(socket, pkg);","  } else {","    logger.error('could not find handle invalid data package.');","    socket.disconnect();","  }","};","","module.exports = handle;",""],"l":{"1":1,"2":1,"3":1,"5":1,"7":1,"8":1,"9":1,"10":1,"12":1,"13":0,"14":0,"16":0,"17":0,"19":0,"23":1,"24":0,"25":0,"27":0,"28":0,"31":1,"32":0,"33":0,"35":0,"38":1,"39":0,"40":0,"42":0,"45":1,"46":1,"47":1,"48":1,"50":1,"51":0,"52":0,"53":0,"55":0,"56":0,"60":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protocol/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protocol/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":43}}},"branchMap":{},"code":["module.exports = require('./lib/protocol');"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protocol/lib/protocol.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo-protocol/lib/protocol.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":1,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":1,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":1,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":1,"146":0,"147":0,"148":0,"149":0,"150":1,"151":0,"152":1,"153":0,"154":1,"155":0,"156":0,"157":0,"158":0,"159":0,"160":1,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":1,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":1,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":1,"189":0,"190":0,"191":1,"192":1,"193":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0,0],"32":[0,0],"33":[0,0,0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,1],"41":[1,0],"42":[1,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":1},"end":{"line":1,"column":39}}},"2":{"name":"(anonymous_2)","line":38,"loc":{"start":{"line":38,"column":23},"end":{"line":38,"column":37}}},"3":{"name":"(anonymous_3)","line":71,"loc":{"start":{"line":71,"column":23},"end":{"line":71,"column":40}}},"4":{"name":"(anonymous_4)","line":120,"loc":{"start":{"line":120,"column":19},"end":{"line":120,"column":39}}},"5":{"name":"(anonymous_5)","line":141,"loc":{"start":{"line":141,"column":19},"end":{"line":141,"column":35}}},"6":{"name":"(anonymous_6)","line":169,"loc":{"start":{"line":169,"column":19},"end":{"line":169,"column":78}}},"7":{"name":"(anonymous_7)","line":226,"loc":{"start":{"line":226,"column":19},"end":{"line":226,"column":36}}},"8":{"name":"(anonymous_8)","line":278,"loc":{"start":{"line":278,"column":18},"end":{"line":278,"column":64}}},"9":{"name":"(anonymous_9)","line":290,"loc":{"start":{"line":290,"column":17},"end":{"line":290,"column":32}}},"10":{"name":"(anonymous_10)","line":294,"loc":{"start":{"line":294,"column":20},"end":{"line":294,"column":35}}},"11":{"name":"(anonymous_11)","line":299,"loc":{"start":{"line":299,"column":27},"end":{"line":299,"column":40}}},"12":{"name":"(anonymous_12)","line":308,"loc":{"start":{"line":308,"column":22},"end":{"line":308,"column":82}}},"13":{"name":"(anonymous_13)","line":323,"loc":{"start":{"line":323,"column":20},"end":{"line":323,"column":49}}},"14":{"name":"(anonymous_14)","line":339,"loc":{"start":{"line":339,"column":23},"end":{"line":339,"column":70}}},"15":{"name":"(anonymous_15)","line":360,"loc":{"start":{"line":360,"column":22},"end":{"line":360,"column":52}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":369,"column":129}},"2":{"start":{"line":2,"column":2},"end":{"line":2,"column":25}},"3":{"start":{"line":4,"column":2},"end":{"line":4,"column":25}},"4":{"start":{"line":5,"column":2},"end":{"line":5,"column":25}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":31}},"6":{"start":{"line":7,"column":2},"end":{"line":7,"column":27}},"7":{"start":{"line":8,"column":2},"end":{"line":8,"column":30}},"8":{"start":{"line":10,"column":2},"end":{"line":10,"column":34}},"9":{"start":{"line":12,"column":2},"end":{"line":12,"column":36}},"10":{"start":{"line":13,"column":2},"end":{"line":13,"column":35}},"11":{"start":{"line":14,"column":2},"end":{"line":14,"column":45}},"12":{"start":{"line":15,"column":2},"end":{"line":15,"column":26}},"13":{"start":{"line":17,"column":2},"end":{"line":17,"column":38}},"14":{"start":{"line":18,"column":2},"end":{"line":18,"column":38}},"15":{"start":{"line":20,"column":2},"end":{"line":20,"column":29}},"16":{"start":{"line":21,"column":2},"end":{"line":21,"column":33}},"17":{"start":{"line":22,"column":2},"end":{"line":22,"column":29}},"18":{"start":{"line":23,"column":2},"end":{"line":23,"column":24}},"19":{"start":{"line":24,"column":2},"end":{"line":24,"column":24}},"20":{"start":{"line":26,"column":2},"end":{"line":26,"column":27}},"21":{"start":{"line":27,"column":2},"end":{"line":27,"column":26}},"22":{"start":{"line":28,"column":2},"end":{"line":28,"column":28}},"23":{"start":{"line":29,"column":2},"end":{"line":29,"column":24}},"24":{"start":{"line":38,"column":2},"end":{"line":64,"column":4}},"25":{"start":{"line":39,"column":4},"end":{"line":63,"column":5}},"26":{"start":{"line":41,"column":6},"end":{"line":41,"column":31}},"27":{"start":{"line":43,"column":6},"end":{"line":43,"column":52}},"28":{"start":{"line":44,"column":6},"end":{"line":44,"column":21}},"29":{"start":{"line":45,"column":6},"end":{"line":59,"column":7}},"30":{"start":{"line":46,"column":8},"end":{"line":46,"column":41}},"31":{"start":{"line":47,"column":8},"end":{"line":47,"column":25}},"32":{"start":{"line":48,"column":8},"end":{"line":54,"column":9}},"33":{"start":{"line":49,"column":10},"end":{"line":49,"column":29}},"34":{"start":{"line":50,"column":14},"end":{"line":54,"column":9}},"35":{"start":{"line":51,"column":10},"end":{"line":51,"column":63}},"36":{"start":{"line":53,"column":10},"end":{"line":53,"column":94}},"37":{"start":{"line":55,"column":8},"end":{"line":58,"column":9}},"38":{"start":{"line":56,"column":10},"end":{"line":56,"column":39}},"39":{"start":{"line":57,"column":10},"end":{"line":57,"column":19}},"40":{"start":{"line":60,"column":6},"end":{"line":60,"column":42}},"41":{"start":{"line":61,"column":6},"end":{"line":61,"column":50}},"42":{"start":{"line":62,"column":6},"end":{"line":62,"column":21}},"43":{"start":{"line":71,"column":2},"end":{"line":96,"column":4}},"44":{"start":{"line":72,"column":4},"end":{"line":95,"column":5}},"45":{"start":{"line":74,"column":6},"end":{"line":74,"column":31}},"46":{"start":{"line":76,"column":6},"end":{"line":76,"column":40}},"47":{"start":{"line":77,"column":6},"end":{"line":77,"column":21}},"48":{"start":{"line":78,"column":6},"end":{"line":78,"column":21}},"49":{"start":{"line":79,"column":6},"end":{"line":79,"column":23}},"50":{"start":{"line":80,"column":6},"end":{"line":80,"column":29}},"51":{"start":{"line":81,"column":6},"end":{"line":93,"column":7}},"52":{"start":{"line":82,"column":8},"end":{"line":91,"column":9}},"53":{"start":{"line":83,"column":10},"end":{"line":83,"column":35}},"54":{"start":{"line":84,"column":10},"end":{"line":84,"column":22}},"55":{"start":{"line":85,"column":14},"end":{"line":91,"column":9}},"56":{"start":{"line":86,"column":10},"end":{"line":86,"column":76}},"57":{"start":{"line":87,"column":10},"end":{"line":87,"column":22}},"58":{"start":{"line":89,"column":10},"end":{"line":89,"column":109}},"59":{"start":{"line":90,"column":10},"end":{"line":90,"column":22}},"60":{"start":{"line":92,"column":8},"end":{"line":92,"column":29}},"61":{"start":{"line":94,"column":6},"end":{"line":94,"column":52}},"62":{"start":{"line":120,"column":2},"end":{"line":132,"column":4}},"63":{"start":{"line":121,"column":4},"end":{"line":121,"column":40}},"64":{"start":{"line":122,"column":4},"end":{"line":122,"column":56}},"65":{"start":{"line":123,"column":4},"end":{"line":123,"column":18}},"66":{"start":{"line":124,"column":4},"end":{"line":124,"column":34}},"67":{"start":{"line":125,"column":4},"end":{"line":125,"column":44}},"68":{"start":{"line":126,"column":4},"end":{"line":126,"column":43}},"69":{"start":{"line":127,"column":4},"end":{"line":127,"column":36}},"70":{"start":{"line":128,"column":4},"end":{"line":130,"column":5}},"71":{"start":{"line":129,"column":6},"end":{"line":129,"column":48}},"72":{"start":{"line":131,"column":4},"end":{"line":131,"column":18}},"73":{"start":{"line":141,"column":2},"end":{"line":157,"column":4}},"74":{"start":{"line":142,"column":4},"end":{"line":142,"column":19}},"75":{"start":{"line":143,"column":4},"end":{"line":143,"column":38}},"76":{"start":{"line":144,"column":4},"end":{"line":144,"column":19}},"77":{"start":{"line":145,"column":4},"end":{"line":145,"column":16}},"78":{"start":{"line":146,"column":4},"end":{"line":155,"column":5}},"79":{"start":{"line":147,"column":6},"end":{"line":147,"column":33}},"80":{"start":{"line":148,"column":6},"end":{"line":148,"column":90}},"81":{"start":{"line":149,"column":6},"end":{"line":149,"column":55}},"82":{"start":{"line":150,"column":6},"end":{"line":152,"column":7}},"83":{"start":{"line":151,"column":8},"end":{"line":151,"column":50}},"84":{"start":{"line":153,"column":6},"end":{"line":153,"column":23}},"85":{"start":{"line":154,"column":6},"end":{"line":154,"column":44}},"86":{"start":{"line":156,"column":4},"end":{"line":156,"column":39}},"87":{"start":{"line":169,"column":2},"end":{"line":218,"column":4}},"88":{"start":{"line":171,"column":4},"end":{"line":171,"column":62}},"89":{"start":{"line":172,"column":4},"end":{"line":172,"column":42}},"90":{"start":{"line":174,"column":4},"end":{"line":190,"column":5}},"91":{"start":{"line":175,"column":6},"end":{"line":189,"column":7}},"92":{"start":{"line":176,"column":8},"end":{"line":178,"column":9}},"93":{"start":{"line":177,"column":10},"end":{"line":177,"column":58}},"94":{"start":{"line":179,"column":8},"end":{"line":179,"column":39}},"95":{"start":{"line":181,"column":8},"end":{"line":181,"column":38}},"96":{"start":{"line":182,"column":8},"end":{"line":188,"column":9}},"97":{"start":{"line":183,"column":10},"end":{"line":183,"column":44}},"98":{"start":{"line":184,"column":10},"end":{"line":186,"column":11}},"99":{"start":{"line":185,"column":12},"end":{"line":185,"column":59}},"100":{"start":{"line":187,"column":10},"end":{"line":187,"column":33}},"101":{"start":{"line":192,"column":4},"end":{"line":194,"column":5}},"102":{"start":{"line":193,"column":6},"end":{"line":193,"column":27}},"103":{"start":{"line":196,"column":4},"end":{"line":196,"column":39}},"104":{"start":{"line":197,"column":4},"end":{"line":197,"column":19}},"105":{"start":{"line":200,"column":4},"end":{"line":200,"column":78}},"106":{"start":{"line":203,"column":4},"end":{"line":205,"column":5}},"107":{"start":{"line":204,"column":6},"end":{"line":204,"column":47}},"108":{"start":{"line":208,"column":4},"end":{"line":210,"column":5}},"109":{"start":{"line":209,"column":6},"end":{"line":209,"column":68}},"110":{"start":{"line":213,"column":4},"end":{"line":215,"column":5}},"111":{"start":{"line":214,"column":6},"end":{"line":214,"column":50}},"112":{"start":{"line":217,"column":4},"end":{"line":217,"column":18}},"113":{"start":{"line":226,"column":2},"end":{"line":276,"column":4}},"114":{"start":{"line":227,"column":4},"end":{"line":227,"column":39}},"115":{"start":{"line":228,"column":4},"end":{"line":228,"column":52}},"116":{"start":{"line":229,"column":4},"end":{"line":229,"column":19}},"117":{"start":{"line":230,"column":4},"end":{"line":230,"column":15}},"118":{"start":{"line":231,"column":4},"end":{"line":231,"column":21}},"119":{"start":{"line":234,"column":4},"end":{"line":234,"column":31}},"120":{"start":{"line":235,"column":4},"end":{"line":235,"column":55}},"121":{"start":{"line":236,"column":4},"end":{"line":236,"column":43}},"122":{"start":{"line":237,"column":4},"end":{"line":237,"column":60}},"123":{"start":{"line":240,"column":4},"end":{"line":249,"column":5}},"124":{"start":{"line":241,"column":6},"end":{"line":241,"column":16}},"125":{"start":{"line":242,"column":6},"end":{"line":242,"column":16}},"126":{"start":{"line":243,"column":6},"end":{"line":248,"column":23}},"127":{"start":{"line":244,"column":8},"end":{"line":244,"column":36}},"128":{"start":{"line":245,"column":8},"end":{"line":245,"column":36}},"129":{"start":{"line":246,"column":8},"end":{"line":246,"column":17}},"130":{"start":{"line":247,"column":8},"end":{"line":247,"column":12}},"131":{"start":{"line":252,"column":4},"end":{"line":266,"column":5}},"132":{"start":{"line":253,"column":6},"end":{"line":265,"column":7}},"133":{"start":{"line":254,"column":8},"end":{"line":254,"column":57}},"134":{"start":{"line":256,"column":8},"end":{"line":256,"column":39}},"135":{"start":{"line":257,"column":8},"end":{"line":263,"column":9}},"136":{"start":{"line":258,"column":10},"end":{"line":258,"column":42}},"137":{"start":{"line":259,"column":10},"end":{"line":259,"column":55}},"138":{"start":{"line":260,"column":10},"end":{"line":260,"column":44}},"139":{"start":{"line":262,"column":10},"end":{"line":262,"column":21}},"140":{"start":{"line":264,"column":8},"end":{"line":264,"column":27}},"141":{"start":{"line":269,"column":4},"end":{"line":269,"column":36}},"142":{"start":{"line":270,"column":4},"end":{"line":270,"column":38}},"143":{"start":{"line":272,"column":4},"end":{"line":272,"column":47}},"144":{"start":{"line":274,"column":4},"end":{"line":275,"column":72}},"145":{"start":{"line":278,"column":2},"end":{"line":288,"column":4}},"146":{"start":{"line":279,"column":4},"end":{"line":287,"column":5}},"147":{"start":{"line":281,"column":6},"end":{"line":281,"column":57}},"148":{"start":{"line":284,"column":6},"end":{"line":286,"column":7}},"149":{"start":{"line":285,"column":8},"end":{"line":285,"column":41}},"150":{"start":{"line":290,"column":2},"end":{"line":292,"column":4}},"151":{"start":{"line":291,"column":4},"end":{"line":291,"column":75}},"152":{"start":{"line":294,"column":2},"end":{"line":297,"column":4}},"153":{"start":{"line":295,"column":4},"end":{"line":296,"column":38}},"154":{"start":{"line":299,"column":2},"end":{"line":306,"column":4}},"155":{"start":{"line":300,"column":4},"end":{"line":300,"column":16}},"156":{"start":{"line":301,"column":4},"end":{"line":304,"column":20}},"157":{"start":{"line":302,"column":6},"end":{"line":302,"column":15}},"158":{"start":{"line":303,"column":6},"end":{"line":303,"column":15}},"159":{"start":{"line":305,"column":4},"end":{"line":305,"column":15}},"160":{"start":{"line":308,"column":2},"end":{"line":321,"column":4}},"161":{"start":{"line":309,"column":4},"end":{"line":312,"column":5}},"162":{"start":{"line":311,"column":6},"end":{"line":311,"column":54}},"163":{"start":{"line":314,"column":4},"end":{"line":314,"column":59}},"164":{"start":{"line":316,"column":4},"end":{"line":318,"column":5}},"165":{"start":{"line":317,"column":6},"end":{"line":317,"column":70}},"166":{"start":{"line":320,"column":4},"end":{"line":320,"column":35}},"167":{"start":{"line":323,"column":2},"end":{"line":337,"column":4}},"168":{"start":{"line":324,"column":4},"end":{"line":334,"column":22}},"169":{"start":{"line":325,"column":6},"end":{"line":325,"column":25}},"170":{"start":{"line":326,"column":6},"end":{"line":326,"column":36}},"171":{"start":{"line":328,"column":6},"end":{"line":330,"column":7}},"172":{"start":{"line":329,"column":8},"end":{"line":329,"column":24}},"173":{"start":{"line":331,"column":6},"end":{"line":331,"column":29}},"174":{"start":{"line":333,"column":6},"end":{"line":333,"column":16}},"175":{"start":{"line":336,"column":4},"end":{"line":336,"column":18}},"176":{"start":{"line":339,"column":2},"end":{"line":358,"column":4}},"177":{"start":{"line":340,"column":4},"end":{"line":355,"column":5}},"178":{"start":{"line":341,"column":6},"end":{"line":343,"column":7}},"179":{"start":{"line":342,"column":8},"end":{"line":342,"column":52}},"180":{"start":{"line":345,"column":6},"end":{"line":345,"column":45}},"181":{"start":{"line":346,"column":6},"end":{"line":346,"column":38}},"182":{"start":{"line":348,"column":6},"end":{"line":354,"column":7}},"183":{"start":{"line":349,"column":8},"end":{"line":349,"column":47}},"184":{"start":{"line":350,"column":8},"end":{"line":350,"column":58}},"185":{"start":{"line":351,"column":8},"end":{"line":351,"column":31}},"186":{"start":{"line":353,"column":8},"end":{"line":353,"column":29}},"187":{"start":{"line":357,"column":4},"end":{"line":357,"column":18}},"188":{"start":{"line":360,"column":2},"end":{"line":363,"column":4}},"189":{"start":{"line":361,"column":4},"end":{"line":361,"column":50}},"190":{"start":{"line":362,"column":4},"end":{"line":362,"column":31}},"191":{"start":{"line":365,"column":2},"end":{"line":365,"column":28}},"192":{"start":{"line":366,"column":2},"end":{"line":368,"column":3}},"193":{"start":{"line":367,"column":4},"end":{"line":367,"column":31}}},"branchMap":{"1":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"2":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":7},"end":{"line":39,"column":36}},{"start":{"line":39,"column":40},"end":{"line":39,"column":60}}]},"3":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":8},"end":{"line":48,"column":8}},{"start":{"line":48,"column":8},"end":{"line":48,"column":8}}]},"4":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":14},"end":{"line":50,"column":14}},{"start":{"line":50,"column":14},"end":{"line":50,"column":14}}]},"5":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":4},"end":{"line":72,"column":4}},{"start":{"line":72,"column":4},"end":{"line":72,"column":4}}]},"6":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":7},"end":{"line":72,"column":36}},{"start":{"line":72,"column":40},"end":{"line":72,"column":60}}]},"7":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":8},"end":{"line":82,"column":8}},{"start":{"line":82,"column":8},"end":{"line":82,"column":8}}]},"8":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":14},"end":{"line":85,"column":14}},{"start":{"line":85,"column":14},"end":{"line":85,"column":14}}]},"9":{"line":121,"type":"cond-expr","locations":[{"start":{"line":121,"column":24},"end":{"line":121,"column":35}},{"start":{"line":121,"column":38},"end":{"line":121,"column":39}}]},"10":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":4},"end":{"line":128,"column":4}},{"start":{"line":128,"column":4},"end":{"line":128,"column":4}}]},"11":{"line":149,"type":"cond-expr","locations":[{"start":{"line":149,"column":26},"end":{"line":149,"column":47}},{"start":{"line":149,"column":50},"end":{"line":149,"column":54}}]},"12":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":6},"end":{"line":150,"column":6}},{"start":{"line":150,"column":6},"end":{"line":150,"column":6}}]},"13":{"line":156,"type":"cond-expr","locations":[{"start":{"line":156,"column":29},"end":{"line":156,"column":34}},{"start":{"line":156,"column":36},"end":{"line":156,"column":38}}]},"14":{"line":171,"type":"cond-expr","locations":[{"start":{"line":171,"column":35},"end":{"line":171,"column":57}},{"start":{"line":171,"column":60},"end":{"line":171,"column":61}}]},"15":{"line":174,"type":"if","locations":[{"start":{"line":174,"column":4},"end":{"line":174,"column":4}},{"start":{"line":174,"column":4},"end":{"line":174,"column":4}}]},"16":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":6},"end":{"line":175,"column":6}},{"start":{"line":175,"column":6},"end":{"line":175,"column":6}}]},"17":{"line":176,"type":"if","locations":[{"start":{"line":176,"column":8},"end":{"line":176,"column":8}},{"start":{"line":176,"column":8},"end":{"line":176,"column":8}}]},"18":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":8},"end":{"line":182,"column":8}},{"start":{"line":182,"column":8},"end":{"line":182,"column":8}}]},"19":{"line":184,"type":"if","locations":[{"start":{"line":184,"column":10},"end":{"line":184,"column":10}},{"start":{"line":184,"column":10},"end":{"line":184,"column":10}}]},"20":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":4},"end":{"line":192,"column":4}},{"start":{"line":192,"column":4},"end":{"line":192,"column":4}}]},"21":{"line":203,"type":"if","locations":[{"start":{"line":203,"column":4},"end":{"line":203,"column":4}},{"start":{"line":203,"column":4},"end":{"line":203,"column":4}}]},"22":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":4},"end":{"line":208,"column":4}},{"start":{"line":208,"column":4},"end":{"line":208,"column":4}}]},"23":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":4},"end":{"line":213,"column":4}},{"start":{"line":213,"column":4},"end":{"line":213,"column":4}}]},"24":{"line":228,"type":"binary-expr","locations":[{"start":{"line":228,"column":19},"end":{"line":228,"column":31}},{"start":{"line":228,"column":35},"end":{"line":228,"column":51}}]},"25":{"line":240,"type":"if","locations":[{"start":{"line":240,"column":4},"end":{"line":240,"column":4}},{"start":{"line":240,"column":4},"end":{"line":240,"column":4}}]},"26":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":4},"end":{"line":252,"column":4}},{"start":{"line":252,"column":4},"end":{"line":252,"column":4}}]},"27":{"line":253,"type":"if","locations":[{"start":{"line":253,"column":6},"end":{"line":253,"column":6}},{"start":{"line":253,"column":6},"end":{"line":253,"column":6}}]},"28":{"line":257,"type":"if","locations":[{"start":{"line":257,"column":8},"end":{"line":257,"column":8}},{"start":{"line":257,"column":8},"end":{"line":257,"column":8}}]},"29":{"line":279,"type":"if","locations":[{"start":{"line":279,"column":4},"end":{"line":279,"column":4}},{"start":{"line":279,"column":4},"end":{"line":279,"column":4}}]},"30":{"line":291,"type":"binary-expr","locations":[{"start":{"line":291,"column":11},"end":{"line":291,"column":40}},{"start":{"line":291,"column":44},"end":{"line":291,"column":74}}]},"31":{"line":295,"type":"binary-expr","locations":[{"start":{"line":295,"column":11},"end":{"line":295,"column":40}},{"start":{"line":295,"column":44},"end":{"line":295,"column":72}},{"start":{"line":296,"column":11},"end":{"line":296,"column":37}}]},"32":{"line":309,"type":"if","locations":[{"start":{"line":309,"column":4},"end":{"line":309,"column":4}},{"start":{"line":309,"column":4},"end":{"line":309,"column":4}}]},"33":{"line":309,"type":"binary-expr","locations":[{"start":{"line":309,"column":7},"end":{"line":309,"column":36}},{"start":{"line":309,"column":40},"end":{"line":309,"column":68}},{"start":{"line":310,"column":7},"end":{"line":310,"column":37}},{"start":{"line":310,"column":41},"end":{"line":310,"column":67}}]},"34":{"line":314,"type":"cond-expr","locations":[{"start":{"line":314,"column":52},"end":{"line":314,"column":53}},{"start":{"line":314,"column":56},"end":{"line":314,"column":57}}]},"35":{"line":316,"type":"if","locations":[{"start":{"line":316,"column":4},"end":{"line":316,"column":4}},{"start":{"line":316,"column":4},"end":{"line":316,"column":4}}]},"36":{"line":328,"type":"if","locations":[{"start":{"line":328,"column":6},"end":{"line":328,"column":6}},{"start":{"line":328,"column":6},"end":{"line":328,"column":6}}]},"37":{"line":340,"type":"if","locations":[{"start":{"line":340,"column":4},"end":{"line":340,"column":4}},{"start":{"line":340,"column":4},"end":{"line":340,"column":4}}]},"38":{"line":341,"type":"if","locations":[{"start":{"line":341,"column":6},"end":{"line":341,"column":6}},{"start":{"line":341,"column":6},"end":{"line":341,"column":6}}]},"39":{"line":348,"type":"if","locations":[{"start":{"line":348,"column":6},"end":{"line":348,"column":6}},{"start":{"line":348,"column":6},"end":{"line":348,"column":6}}]},"40":{"line":366,"type":"if","locations":[{"start":{"line":366,"column":2},"end":{"line":366,"column":2}},{"start":{"line":366,"column":2},"end":{"line":366,"column":2}}]},"41":{"line":369,"type":"cond-expr","locations":[{"start":{"line":369,"column":33},"end":{"line":369,"column":47}},{"start":{"line":369,"column":51},"end":{"line":369,"column":69}}]},"42":{"line":369,"type":"cond-expr","locations":[{"start":{"line":369,"column":102},"end":{"line":369,"column":108}},{"start":{"line":369,"column":111},"end":{"line":369,"column":121}}]}},"code":["(function (exports, ByteArray, global) {","  var Protocol = exports;","","  var PKG_HEAD_BYTES = 4;","  var MSG_FLAG_BYTES = 1;","  var MSG_ROUTE_CODE_BYTES = 2;","  var MSG_ID_MAX_BYTES = 5;","  var MSG_ROUTE_LEN_BYTES = 1;","","  var MSG_ROUTE_CODE_MAX = 0xffff;","","  var MSG_COMPRESS_ROUTE_MASK = 0x1;","  var MSG_COMPRESS_GZIP_MASK = 0x1;","  var MSG_COMPRESS_GZIP_ENCODE_MASK = 1 << 4;","  var MSG_TYPE_MASK = 0x7;","","  var Package = Protocol.Package = {};","  var Message = Protocol.Message = {};","","  Package.TYPE_HANDSHAKE = 1;","  Package.TYPE_HANDSHAKE_ACK = 2;","  Package.TYPE_HEARTBEAT = 3;","  Package.TYPE_DATA = 4;","  Package.TYPE_KICK = 5;","","  Message.TYPE_REQUEST = 0;","  Message.TYPE_NOTIFY = 1;","  Message.TYPE_RESPONSE = 2;","  Message.TYPE_PUSH = 3;","","  /**","   * pomele client encode","   * id message id;","   * route message route","   * msg message body","   * socketio current support string","   */","  Protocol.strencode = function(str) {","    if(typeof Buffer !== \"undefined\" && ByteArray === Buffer) {","      // encoding defaults to 'utf8'","      return (new Buffer(str));","    } else {","      var byteArray = new ByteArray(str.length * 3);","      var offset = 0;","      for(var i = 0; i < str.length; i++){","        var charCode = str.charCodeAt(i);","        var codes = null;","        if(charCode <= 0x7f){","          codes = [charCode];","        }else if(charCode <= 0x7ff){","          codes = [0xc0|(charCode>>6), 0x80|(charCode & 0x3f)];","        }else{","          codes = [0xe0|(charCode>>12), 0x80|((charCode & 0xfc0)>>6), 0x80|(charCode & 0x3f)];","        }","        for(var j = 0; j < codes.length; j++){","          byteArray[offset] = codes[j];","          ++offset;","        }","      }","      var _buffer = new ByteArray(offset);","      copyArray(_buffer, 0, byteArray, 0, offset);","      return _buffer;","    }","  };","","  /**","   * client decode","   * msg String data","   * return Message Object","   */","  Protocol.strdecode = function(buffer) {","    if(typeof Buffer !== \"undefined\" && ByteArray === Buffer) {","      // encoding defaults to 'utf8'","      return buffer.toString();","    } else {","      var bytes = new ByteArray(buffer);","      var array = [];","      var offset = 0;","      var charCode = 0;","      var end = bytes.length;","      while(offset < end){","        if(bytes[offset] < 128){","          charCode = bytes[offset];","          offset += 1;","        }else if(bytes[offset] < 224){","          charCode = ((bytes[offset] & 0x1f)<<6) + (bytes[offset+1] & 0x3f);","          offset += 2;","        }else{","          charCode = ((bytes[offset] & 0x0f)<<12) + ((bytes[offset+1] & 0x3f)<<6) + (bytes[offset+2] & 0x3f);","          offset += 3;","        }","        array.push(charCode);","      }","      return String.fromCharCode.apply(null, array);","    }","  };","","  /**","   * Package protocol encode.","   *","   * Pomelo package format:","   * +------+-------------+------------------+","   * | type | body length |       body       |","   * +------+-------------+------------------+","   *","   * Head: 4bytes","   *   0: package type,","   *      1 - handshake,","   *      2 - handshake ack,","   *      3 - heartbeat,","   *      4 - data","   *      5 - kick","   *   1 - 3: big-endian body length","   * Body: body length bytes","   *","   * @param  {Number}    type   package type","   * @param  {ByteArray} body   body content in bytes","   * @return {ByteArray}        new byte array that contains encode result","   */","  Package.encode = function(type, body){","    var length = body ? body.length : 0;","    var buffer = new ByteArray(PKG_HEAD_BYTES + length);","    var index = 0;","    buffer[index++] = type & 0xff;","    buffer[index++] = (length >> 16) & 0xff;","    buffer[index++] = (length >> 8) & 0xff;","    buffer[index++] = length & 0xff;","    if(body) {","      copyArray(buffer, index, body, 0, length);","    }","    return buffer;","  };","","  /**","   * Package protocol decode.","   * See encode for package format.","   *","   * @param  {ByteArray} buffer byte array containing package content","   * @return {Object}           {type: package type, buffer: body byte array}","   */","  Package.decode = function(buffer){","    var offset = 0;","    var bytes = new ByteArray(buffer);","    var length = 0;","    var rs = [];","    while(offset < bytes.length) {","      var type = bytes[offset++];","      length = ((bytes[offset++]) << 16 | (bytes[offset++]) << 8 | bytes[offset++]) >>> 0;","      var body = length ? new ByteArray(length) : null;","      if(body) {","        copyArray(body, 0, bytes, offset, length);","      }","      offset += length;","      rs.push({'type': type, 'body': body});","    }","    return rs.length === 1 ? rs[0]: rs;","  };","","  /**","   * Message protocol encode.","   *","   * @param  {Number} id            message id","   * @param  {Number} type          message type","   * @param  {Number} compressRoute whether compress route","   * @param  {Number|String} route  route code or route string","   * @param  {Buffer} msg           message body bytes","   * @return {Buffer}               encode result","   */","  Message.encode = function(id, type, compressRoute, route, msg, compressGzip){","    // caculate message max length","    var idBytes = msgHasId(type) ? caculateMsgIdBytes(id) : 0;","    var msgLen = MSG_FLAG_BYTES + idBytes;","","    if(msgHasRoute(type)) {","      if(compressRoute) {","        if(typeof route !== 'number'){","          throw new Error('error flag for number route!');","        }","        msgLen += MSG_ROUTE_CODE_BYTES;","      } else {","        msgLen += MSG_ROUTE_LEN_BYTES;","        if(route) {","          route = Protocol.strencode(route);","          if(route.length>255) {","            throw new Error('route maxlength is overflow');","          }","          msgLen += route.length;","        }","      }","    }","","    if(msg) {","      msgLen += msg.length;","    }","","    var buffer = new ByteArray(msgLen);","    var offset = 0;","","    // add flag","    offset = encodeMsgFlag(type, compressRoute, buffer, offset, compressGzip);","","    // add message id","    if(msgHasId(type)) {","      offset = encodeMsgId(id, buffer, offset);","    }","","    // add route","    if(msgHasRoute(type)) {","      offset = encodeMsgRoute(compressRoute, route, buffer, offset);","    }","","    // add body","    if(msg) {","      offset = encodeMsgBody(msg, buffer, offset);","    }","","    return buffer;","  };","","  /**","   * Message protocol decode.","   *","   * @param  {Buffer|Uint8Array} buffer message bytes","   * @return {Object}            message object","   */","  Message.decode = function(buffer) {","    var bytes =  new ByteArray(buffer);","    var bytesLen = bytes.length || bytes.byteLength;","    var offset = 0;","    var id = 0;","    var route = null;","","    // parse flag","    var flag = bytes[offset++];","    var compressRoute = flag & MSG_COMPRESS_ROUTE_MASK;","    var type = (flag >> 1) & MSG_TYPE_MASK;","    var compressGzip = (flag >> 4) & MSG_COMPRESS_GZIP_MASK;","","    // parse id","    if(msgHasId(type)) {","      var m = 0;","      var i = 0;","      do{","        m = parseInt(bytes[offset]);","        id += (m & 0x7f) << (7 * i);","        offset++;","        i++;","      }while(m >= 128);","    }","","    // parse route","    if(msgHasRoute(type)) {","      if(compressRoute) {","        route = (bytes[offset++]) << 8 | bytes[offset++];","      } else {","        var routeLen = bytes[offset++];","        if(routeLen) {","          route = new ByteArray(routeLen);","          copyArray(route, 0, bytes, offset, routeLen);","          route = Protocol.strdecode(route);","        } else {","          route = '';","        }","        offset += routeLen;","      }","    }","","    // parse body","    var bodyLen = bytesLen - offset;","    var body = new ByteArray(bodyLen);","","    copyArray(body, 0, bytes, offset, bodyLen);","","    return {'id': id, 'type': type, 'compressRoute': compressRoute,","            'route': route, 'body': body, 'compressGzip': compressGzip};","  };","","  var copyArray = function(dest, doffset, src, soffset, length) {","    if('function' === typeof src.copy) {","      // Buffer","      src.copy(dest, doffset, soffset, soffset + length);","    } else {","      // Uint8Array","      for(var index=0; index<length; index++){","        dest[doffset++] = src[soffset++];","      }","    }","  };","","  var msgHasId = function(type) {","    return type === Message.TYPE_REQUEST || type === Message.TYPE_RESPONSE;","  };","","  var msgHasRoute = function(type) {","    return type === Message.TYPE_REQUEST || type === Message.TYPE_NOTIFY ||","           type === Message.TYPE_PUSH;","  };","","  var caculateMsgIdBytes = function(id) {","    var len = 0;","    do {","      len += 1;","      id >>= 7;","    } while(id > 0);","    return len;","  };","","  var encodeMsgFlag = function(type, compressRoute, buffer, offset, compressGzip) {","    if(type !== Message.TYPE_REQUEST && type !== Message.TYPE_NOTIFY &&","       type !== Message.TYPE_RESPONSE && type !== Message.TYPE_PUSH) {","      throw new Error('unkonw message type: ' + type);","    }","","    buffer[offset] = (type << 1) | (compressRoute ? 1 : 0);","","    if(compressGzip) {","      buffer[offset] = buffer[offset] | MSG_COMPRESS_GZIP_ENCODE_MASK;","    }","","    return offset + MSG_FLAG_BYTES;","  };","","  var encodeMsgId = function(id, buffer, offset) {","    do{","      var tmp = id % 128;","      var next = Math.floor(id/128);","","      if(next !== 0){","        tmp = tmp + 128;","      }","      buffer[offset++] = tmp;","","      id = next;","    } while(id !== 0);","","    return offset;","  };","","  var encodeMsgRoute = function(compressRoute, route, buffer, offset) {","    if (compressRoute) {","      if(route > MSG_ROUTE_CODE_MAX){","        throw new Error('route number is overflow');","      }","","      buffer[offset++] = (route >> 8) & 0xff;","      buffer[offset++] = route & 0xff;","    } else {","      if(route) {","        buffer[offset++] = route.length & 0xff;","        copyArray(buffer, offset, route, 0, route.length);","        offset += route.length;","      } else {","        buffer[offset++] = 0;","      }","    }","","    return offset;","  };","","  var encodeMsgBody = function(msg, buffer, offset) {","    copyArray(buffer, offset, msg, 0, msg.length);","    return offset + msg.length;","  };","","  module.exports = Protocol;","  if(typeof(window) != \"undefined\") {","    window.Protocol = Protocol;","  }","})(typeof(window)==\"undefined\" ? module.exports : (this.Protocol = {}),typeof(window)==\"undefined\"  ? Buffer : Uint8Array, this);",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"7":1,"8":1,"10":1,"12":1,"13":1,"14":1,"15":1,"17":1,"18":1,"20":1,"21":1,"22":1,"23":1,"24":1,"26":1,"27":1,"28":1,"29":1,"38":1,"39":0,"41":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"53":0,"55":0,"56":0,"57":0,"60":0,"61":0,"62":0,"71":1,"72":0,"74":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"89":0,"90":0,"92":0,"94":0,"120":1,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"131":0,"141":1,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"153":0,"154":0,"156":0,"169":1,"171":0,"172":0,"174":0,"175":0,"176":0,"177":0,"179":0,"181":0,"182":0,"183":0,"184":0,"185":0,"187":0,"192":0,"193":0,"196":0,"197":0,"200":0,"203":0,"204":0,"208":0,"209":0,"213":0,"214":0,"217":0,"226":1,"227":0,"228":0,"229":0,"230":0,"231":0,"234":0,"235":0,"236":0,"237":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"252":0,"253":0,"254":0,"256":0,"257":0,"258":0,"259":0,"260":0,"262":0,"264":0,"269":0,"270":0,"272":0,"274":0,"278":1,"279":0,"281":0,"284":0,"285":0,"290":1,"291":0,"294":1,"295":0,"299":1,"300":0,"301":0,"302":0,"303":0,"305":0,"308":1,"309":0,"311":0,"314":0,"316":0,"317":0,"320":0,"323":1,"324":0,"325":0,"326":0,"328":0,"329":0,"331":0,"333":0,"336":0,"339":1,"340":0,"341":0,"342":0,"345":0,"346":0,"348":0,"349":0,"350":0,"351":0,"353":0,"357":0,"360":1,"361":0,"362":0,"365":1,"366":1,"367":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybrid/switcher.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybrid/switcher.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":1,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":1,"49":0,"50":0,"51":0,"52":0,"53":0,"54":1,"55":0,"56":1,"57":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":21,"loc":{"start":{"line":21,"column":15},"end":{"line":21,"column":38}}},"2":{"name":"(anonymous_2)","line":34,"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":53}}},"3":{"name":"(anonymous_3)","line":49,"loc":{"start":{"line":49,"column":31},"end":{"line":49,"column":48}}},"4":{"name":"(anonymous_4)","line":54,"loc":{"start":{"line":54,"column":34},"end":{"line":54,"column":45}}},"5":{"name":"(anonymous_5)","line":62,"loc":{"start":{"line":62,"column":22},"end":{"line":62,"column":37}}},"6":{"name":"(anonymous_6)","line":75,"loc":{"start":{"line":75,"column":27},"end":{"line":75,"column":38}}},"7":{"name":"(anonymous_7)","line":85,"loc":{"start":{"line":85,"column":13},"end":{"line":85,"column":28}}},"8":{"name":"(anonymous_8)","line":97,"loc":{"start":{"line":97,"column":18},"end":{"line":97,"column":62}}},"9":{"name":"(anonymous_9)","line":101,"loc":{"start":{"line":101,"column":17},"end":{"line":101,"column":61}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":50}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":43}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":70}},"6":{"start":{"line":7,"column":0},"end":{"line":9,"column":2}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":19}},"8":{"start":{"line":12,"column":0},"end":{"line":12,"column":18}},"9":{"start":{"line":14,"column":0},"end":{"line":14,"column":25}},"10":{"start":{"line":21,"column":0},"end":{"line":44,"column":2}},"11":{"start":{"line":22,"column":2},"end":{"line":22,"column":26}},"12":{"start":{"line":23,"column":2},"end":{"line":23,"column":23}},"13":{"start":{"line":24,"column":2},"end":{"line":24,"column":39}},"14":{"start":{"line":25,"column":2},"end":{"line":25,"column":57}},"15":{"start":{"line":26,"column":2},"end":{"line":26,"column":14}},"16":{"start":{"line":27,"column":2},"end":{"line":27,"column":58}},"17":{"start":{"line":28,"column":2},"end":{"line":28,"column":36}},"18":{"start":{"line":30,"column":2},"end":{"line":38,"column":3}},"19":{"start":{"line":31,"column":4},"end":{"line":31,"column":60}},"20":{"start":{"line":33,"column":4},"end":{"line":33,"column":66}},"21":{"start":{"line":34,"column":4},"end":{"line":37,"column":7}},"22":{"start":{"line":35,"column":6},"end":{"line":35,"column":76}},"23":{"start":{"line":36,"column":6},"end":{"line":36,"column":22}},"24":{"start":{"line":40,"column":2},"end":{"line":40,"column":72}},"25":{"start":{"line":41,"column":2},"end":{"line":41,"column":73}},"26":{"start":{"line":43,"column":2},"end":{"line":43,"column":26}},"27":{"start":{"line":45,"column":0},"end":{"line":45,"column":38}},"28":{"start":{"line":47,"column":0},"end":{"line":47,"column":26}},"29":{"start":{"line":49,"column":0},"end":{"line":73,"column":2}},"30":{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},"31":{"start":{"line":51,"column":4},"end":{"line":51,"column":11}},"32":{"start":{"line":54,"column":2},"end":{"line":58,"column":5}},"33":{"start":{"line":55,"column":5},"end":{"line":56,"column":48}},"34":{"start":{"line":57,"column":5},"end":{"line":57,"column":22}},"35":{"start":{"line":60,"column":2},"end":{"line":60,"column":18}},"36":{"start":{"line":62,"column":2},"end":{"line":72,"column":5}},"37":{"start":{"line":64,"column":4},"end":{"line":71,"column":5}},"38":{"start":{"line":65,"column":6},"end":{"line":65,"column":56}},"39":{"start":{"line":67,"column":6},"end":{"line":69,"column":7}},"40":{"start":{"line":68,"column":8},"end":{"line":68,"column":32}},"41":{"start":{"line":70,"column":6},"end":{"line":70,"column":56}},"42":{"start":{"line":75,"column":0},"end":{"line":83,"column":2}},"43":{"start":{"line":76,"column":2},"end":{"line":78,"column":3}},"44":{"start":{"line":77,"column":4},"end":{"line":77,"column":11}},"45":{"start":{"line":80,"column":2},"end":{"line":80,"column":25}},"46":{"start":{"line":81,"column":2},"end":{"line":81,"column":27}},"47":{"start":{"line":82,"column":2},"end":{"line":82,"column":28}},"48":{"start":{"line":85,"column":0},"end":{"line":95,"column":2}},"49":{"start":{"line":86,"column":2},"end":{"line":86,"column":41}},"50":{"start":{"line":88,"column":2},"end":{"line":92,"column":3}},"51":{"start":{"line":89,"column":4},"end":{"line":91,"column":5}},"52":{"start":{"line":90,"column":6},"end":{"line":90,"column":18}},"53":{"start":{"line":94,"column":2},"end":{"line":94,"column":15}},"54":{"start":{"line":97,"column":0},"end":{"line":99,"column":2}},"55":{"start":{"line":98,"column":2},"end":{"line":98,"column":30}},"56":{"start":{"line":101,"column":0},"end":{"line":103,"column":2}},"57":{"start":{"line":102,"column":2},"end":{"line":102,"column":30}}},"branchMap":{"1":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":18},"end":{"line":27,"column":30}},{"start":{"line":27,"column":34},"end":{"line":27,"column":49}}]},"2":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":2},"end":{"line":30,"column":2}},{"start":{"line":30,"column":2},"end":{"line":30,"column":2}}]},"3":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":50,"column":2}},{"start":{"line":50,"column":2},"end":{"line":50,"column":2}}]},"4":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":64,"column":4}},{"start":{"line":64,"column":4},"end":{"line":64,"column":4}}]},"5":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":6},"end":{"line":67,"column":6}},{"start":{"line":67,"column":6},"end":{"line":67,"column":6}}]},"6":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":2},"end":{"line":76,"column":2}},{"start":{"line":76,"column":2},"end":{"line":76,"column":2}}]},"7":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":4},"end":{"line":89,"column":4}},{"start":{"line":89,"column":4},"end":{"line":89,"column":4}}]}},"code":["var EventEmitter = require('events').EventEmitter;","var util = require('util');","var WSProcessor = require('./wsprocessor');","var TCPProcessor = require('./tcpprocessor');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","var HTTP_METHODS = [","  'GET', 'POST', 'DELETE', 'PUT', 'HEAD'","];","","var ST_STARTED = 1;","var ST_CLOSED = 2;","","var DEFAULT_TIMEOUT = 90;","","/**"," * Switcher for tcp and websocket protocol"," *"," * @param {Object} server tcp server instance from node.js net module"," */","var Switcher = function(server, opts) {","  EventEmitter.call(this);","  this.server = server;","  this.wsprocessor = new WSProcessor();","  this.tcpprocessor = new TCPProcessor(opts.closeMethod);","  this.id = 1;","  this.timeout = (opts.timeout || DEFAULT_TIMEOUT) * 1000;","  this.setNoDelay = opts.setNoDelay;","","  if (!opts.ssl) {","    this.server.on('connection', this.newSocket.bind(this));","  } else {","    this.server.on('secureConnection', this.newSocket.bind(this));","    this.server.on('clientError', function(e, tlsSo) {","      logger.warn('an ssl error occured before handshake established: ', e);","      tlsSo.destroy();","    });","  }","","  this.wsprocessor.on('connection', this.emit.bind(this, 'connection'));","  this.tcpprocessor.on('connection', this.emit.bind(this, 'connection'));","","  this.state = ST_STARTED;","};","util.inherits(Switcher, EventEmitter);","","module.exports = Switcher;","","Switcher.prototype.newSocket = function(socket) {","  if(this.state !== ST_STARTED) {","    return;","  }","","  socket.setTimeout(this.timeout, function() {","     logger.warn('connection is timeout without communication, the remote ip is %s && port is %s',","       socket.remoteAddress, socket.remotePort);","     socket.destroy();","  });","","  var self = this;","","  socket.once('data', function(data) {","    // FIXME: handle incomplete HTTP method","    if(isHttp(data)) {","      processHttp(self, self.wsprocessor, socket, data);","    } else {","      if(!!self.setNoDelay) {","        socket.setNoDelay(true);","      }","      processTcp(self, self.tcpprocessor, socket, data);","    }","  });","};","","Switcher.prototype.close = function() {","  if(this.state !== ST_STARTED) {","    return;","  }","","  this.state = ST_CLOSED;","  this.wsprocessor.close();","  this.tcpprocessor.close();","};","","var isHttp = function(data) {","  var head = data.toString('utf8', 0, 4);","","  for(var i=0, l=HTTP_METHODS.length; i<l; i++) {","    if(head.indexOf(HTTP_METHODS[i]) === 0) {","      return true;","    }","  }","","  return false;","};","","var processHttp = function(switcher, processor, socket, data) {","  processor.add(socket, data);","};","","var processTcp = function(switcher, processor, socket, data) {","  processor.add(socket, data);","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"11":1,"12":1,"14":1,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"30":0,"31":0,"33":0,"34":0,"35":0,"36":0,"40":0,"41":0,"43":0,"45":1,"47":1,"49":1,"50":0,"51":0,"54":0,"55":0,"57":0,"60":0,"62":0,"64":0,"65":0,"67":0,"68":0,"70":0,"75":1,"76":0,"77":0,"80":0,"81":0,"82":0,"85":1,"86":0,"88":0,"89":0,"90":0,"94":0,"97":1,"98":0,"101":1,"102":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybrid/wsprocessor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybrid/wsprocessor.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":27}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":33},"end":{"line":19,"column":50}}},"3":{"name":"(anonymous_3)","line":30,"loc":{"start":{"line":30,"column":26},"end":{"line":30,"column":49}}},"4":{"name":"(anonymous_4)","line":44,"loc":{"start":{"line":44,"column":28},"end":{"line":44,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":40}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":19}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":18}},"7":{"start":{"line":12,"column":0},"end":{"line":25,"column":2}},"8":{"start":{"line":13,"column":2},"end":{"line":13,"column":26}},"9":{"start":{"line":14,"column":2},"end":{"line":14,"column":37}},"10":{"start":{"line":16,"column":2},"end":{"line":16,"column":18}},"11":{"start":{"line":17,"column":2},"end":{"line":17,"column":65}},"12":{"start":{"line":19,"column":2},"end":{"line":22,"column":5}},"13":{"start":{"line":21,"column":4},"end":{"line":21,"column":36}},"14":{"start":{"line":24,"column":2},"end":{"line":24,"column":26}},"15":{"start":{"line":26,"column":0},"end":{"line":26,"column":39}},"16":{"start":{"line":28,"column":0},"end":{"line":28,"column":27}},"17":{"start":{"line":30,"column":0},"end":{"line":42,"column":2}},"18":{"start":{"line":31,"column":2},"end":{"line":33,"column":3}},"19":{"start":{"line":32,"column":4},"end":{"line":32,"column":11}},"20":{"start":{"line":34,"column":2},"end":{"line":34,"column":45}},"21":{"start":{"line":35,"column":2},"end":{"line":41,"column":3}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":40}},"23":{"start":{"line":40,"column":4},"end":{"line":40,"column":30}},"24":{"start":{"line":44,"column":0},"end":{"line":52,"column":2}},"25":{"start":{"line":45,"column":2},"end":{"line":47,"column":3}},"26":{"start":{"line":46,"column":4},"end":{"line":46,"column":11}},"27":{"start":{"line":48,"column":2},"end":{"line":48,"column":25}},"28":{"start":{"line":49,"column":2},"end":{"line":49,"column":24}},"29":{"start":{"line":50,"column":2},"end":{"line":50,"column":23}},"30":{"start":{"line":51,"column":2},"end":{"line":51,"column":25}}},"branchMap":{"1":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":31,"column":2}},{"start":{"line":31,"column":2},"end":{"line":31,"column":2}}]},"2":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":35,"column":2}},{"start":{"line":35,"column":2},"end":{"line":35,"column":2}}]},"3":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":2},"end":{"line":45,"column":2}},{"start":{"line":45,"column":2},"end":{"line":45,"column":2}}]}},"code":["var HttpServer = require('http').Server;","var EventEmitter = require('events').EventEmitter;","var util = require('util');","var WebSocketServer = require('ws').Server;","","var ST_STARTED = 1;","var ST_CLOSED = 2;","","/**"," * websocket protocol processor"," */","var Processor = function() {","  EventEmitter.call(this);","  this.httpServer = new HttpServer();","","  var self = this;","  this.wsServer = new WebSocketServer({server: this.httpServer});","","  this.wsServer.on('connection', function(socket) {","    // emit socket to outside","    self.emit('connection', socket);","  });","","  this.state = ST_STARTED;","};","util.inherits(Processor, EventEmitter);","","module.exports = Processor;","","Processor.prototype.add = function(socket, data) {","  if(this.state !== ST_STARTED) {","    return;","  }","  this.httpServer.emit('connection', socket);","  if(typeof socket.ondata === 'function') {","    // compatible with stream2","    socket.ondata(data, 0, data.length);","  } else {","    // compatible with old stream","    socket.emit('data', data);","  }","};","","Processor.prototype.close = function() {","  if(this.state !== ST_STARTED) {","    return;","  }","  this.state = ST_CLOSED;","  this.wsServer.close();","  this.wsServer = null;","  this.httpServer = null;","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"7":1,"12":1,"13":0,"14":0,"16":0,"17":0,"19":0,"21":0,"24":0,"26":1,"28":1,"30":1,"31":0,"32":0,"34":0,"35":0,"37":0,"40":0,"44":1,"45":0,"46":0,"48":0,"49":0,"50":0,"51":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybrid/tcpprocessor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybrid/tcpprocessor.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":0,"23":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":15,"loc":{"start":{"line":15,"column":16},"end":{"line":15,"column":38}}},"2":{"name":"(anonymous_2)","line":24,"loc":{"start":{"line":24,"column":26},"end":{"line":24,"column":49}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":28},"end":{"line":35,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":50}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":39}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":19}},"6":{"start":{"line":7,"column":0},"end":{"line":7,"column":18}},"7":{"start":{"line":10,"column":0},"end":{"line":10,"column":18}},"8":{"start":{"line":15,"column":0},"end":{"line":19,"column":2}},"9":{"start":{"line":16,"column":2},"end":{"line":16,"column":26}},"10":{"start":{"line":17,"column":2},"end":{"line":17,"column":33}},"11":{"start":{"line":18,"column":2},"end":{"line":18,"column":26}},"12":{"start":{"line":20,"column":0},"end":{"line":20,"column":39}},"13":{"start":{"line":22,"column":0},"end":{"line":22,"column":27}},"14":{"start":{"line":24,"column":0},"end":{"line":33,"column":2}},"15":{"start":{"line":25,"column":2},"end":{"line":27,"column":3}},"16":{"start":{"line":26,"column":4},"end":{"line":26,"column":11}},"17":{"start":{"line":28,"column":2},"end":{"line":30,"column":73}},"18":{"start":{"line":31,"column":2},"end":{"line":31,"column":37}},"19":{"start":{"line":32,"column":2},"end":{"line":32,"column":28}},"20":{"start":{"line":35,"column":0},"end":{"line":40,"column":2}},"21":{"start":{"line":36,"column":2},"end":{"line":38,"column":3}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":11}},"23":{"start":{"line":39,"column":2},"end":{"line":39,"column":25}}},"branchMap":{"1":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":2},"end":{"line":25,"column":2}},{"start":{"line":25,"column":2},"end":{"line":25,"column":2}}]},"2":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":2}},{"start":{"line":36,"column":2},"end":{"line":36,"column":2}}]}},"code":["var EventEmitter = require('events').EventEmitter;","var util = require('util');","var utils = require('../../util/utils');","var TcpSocket = require('./tcpsocket');","","var ST_STARTED = 1;","var ST_CLOSED = 2;","","// private protocol, no need exports","var HEAD_SIZE = 4;","","/**"," * websocket protocol processor"," */","var Processor = function(closeMethod) {","  EventEmitter.call(this);","  this.closeMethod = closeMethod;","  this.state = ST_STARTED;","};","util.inherits(Processor, EventEmitter);","","module.exports = Processor;","","Processor.prototype.add = function(socket, data) {","  if(this.state !== ST_STARTED) {","    return;","  }","  var tcpsocket = new TcpSocket(socket, {headSize: HEAD_SIZE,","                                         headHandler: utils.headHandler,","                                         closeMethod: this.closeMethod});","  this.emit('connection', tcpsocket);","  socket.emit('data', data);","};","","Processor.prototype.close = function() {","  if(this.state !== ST_STARTED) {","    return;","  }","  this.state = ST_CLOSED;","};"],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"7":1,"10":1,"15":1,"16":0,"17":0,"18":0,"20":1,"22":1,"24":1,"25":0,"26":0,"28":0,"31":0,"32":0,"35":1,"36":0,"37":0,"39":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybrid/tcpsocket.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/hybrid/tcpsocket.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1,"34":1,"35":1,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":0,"59":0,"60":0,"61":0,"62":0,"63":1,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":1,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":1,"97":0,"98":0,"99":0,"100":0,"101":0,"102":1,"103":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0,0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":24,"loc":{"start":{"line":24,"column":13},"end":{"line":24,"column":36}}},"2":{"name":"(anonymous_2)","line":67,"loc":{"start":{"line":67,"column":24},"end":{"line":67,"column":50}}},"3":{"name":"(anonymous_3)","line":71,"loc":{"start":{"line":71,"column":25},"end":{"line":71,"column":36}}},"4":{"name":"(anonymous_4)","line":83,"loc":{"start":{"line":83,"column":13},"end":{"line":83,"column":37}}},"5":{"name":"(anonymous_5)","line":111,"loc":{"start":{"line":111,"column":12},"end":{"line":111,"column":36}}},"6":{"name":"(anonymous_6)","line":129,"loc":{"start":{"line":129,"column":15},"end":{"line":129,"column":46}}},"7":{"name":"(anonymous_7)","line":170,"loc":{"start":{"line":170,"column":15},"end":{"line":170,"column":46}}},"8":{"name":"(anonymous_8)","line":190,"loc":{"start":{"line":190,"column":12},"end":{"line":190,"column":29}}},"9":{"name":"(anonymous_9)","line":198,"loc":{"start":{"line":198,"column":20},"end":{"line":198,"column":35}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":31}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":70}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":16}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":16}},"8":{"start":{"line":12,"column":0},"end":{"line":12,"column":18}},"9":{"start":{"line":24,"column":0},"end":{"line":61,"column":2}},"10":{"start":{"line":25,"column":2},"end":{"line":27,"column":3}},"11":{"start":{"line":26,"column":4},"end":{"line":26,"column":36}},"12":{"start":{"line":29,"column":2},"end":{"line":31,"column":3}},"13":{"start":{"line":30,"column":4},"end":{"line":30,"column":46}},"14":{"start":{"line":33,"column":2},"end":{"line":35,"column":3}},"15":{"start":{"line":34,"column":4},"end":{"line":34,"column":65}},"16":{"start":{"line":39,"column":2},"end":{"line":39,"column":20}},"17":{"start":{"line":40,"column":2},"end":{"line":40,"column":23}},"18":{"start":{"line":41,"column":2},"end":{"line":41,"column":24}},"19":{"start":{"line":43,"column":2},"end":{"line":43,"column":24}},"20":{"start":{"line":44,"column":2},"end":{"line":44,"column":32}},"21":{"start":{"line":45,"column":2},"end":{"line":45,"column":38}},"22":{"start":{"line":46,"column":2},"end":{"line":46,"column":46}},"23":{"start":{"line":47,"column":2},"end":{"line":47,"column":38}},"24":{"start":{"line":49,"column":2},"end":{"line":49,"column":22}},"25":{"start":{"line":50,"column":2},"end":{"line":50,"column":25}},"26":{"start":{"line":51,"column":2},"end":{"line":51,"column":23}},"27":{"start":{"line":52,"column":2},"end":{"line":52,"column":28}},"28":{"start":{"line":55,"column":2},"end":{"line":55,"column":51}},"29":{"start":{"line":56,"column":2},"end":{"line":56,"column":49}},"30":{"start":{"line":57,"column":2},"end":{"line":57,"column":58}},"31":{"start":{"line":58,"column":2},"end":{"line":58,"column":58}},"32":{"start":{"line":60,"column":2},"end":{"line":60,"column":23}},"33":{"start":{"line":63,"column":0},"end":{"line":63,"column":30}},"34":{"start":{"line":65,"column":0},"end":{"line":65,"column":24}},"35":{"start":{"line":67,"column":0},"end":{"line":69,"column":2}},"36":{"start":{"line":68,"column":2},"end":{"line":68,"column":38}},"37":{"start":{"line":71,"column":0},"end":{"line":81,"column":2}},"38":{"start":{"line":72,"column":2},"end":{"line":80,"column":3}},"39":{"start":{"line":73,"column":4},"end":{"line":73,"column":23}},"40":{"start":{"line":75,"column":4},"end":{"line":79,"column":5}},"41":{"start":{"line":76,"column":6},"end":{"line":76,"column":29}},"42":{"start":{"line":78,"column":6},"end":{"line":78,"column":67}},"43":{"start":{"line":83,"column":0},"end":{"line":109,"column":2}},"44":{"start":{"line":84,"column":2},"end":{"line":86,"column":3}},"45":{"start":{"line":85,"column":4},"end":{"line":85,"column":41}},"46":{"start":{"line":88,"column":2},"end":{"line":90,"column":3}},"47":{"start":{"line":89,"column":4},"end":{"line":89,"column":36}},"48":{"start":{"line":92,"column":2},"end":{"line":94,"column":3}},"49":{"start":{"line":93,"column":4},"end":{"line":93,"column":38}},"50":{"start":{"line":96,"column":2},"end":{"line":96,"column":37}},"51":{"start":{"line":98,"column":2},"end":{"line":106,"column":3}},"52":{"start":{"line":99,"column":4},"end":{"line":101,"column":5}},"53":{"start":{"line":100,"column":6},"end":{"line":100,"column":47}},"54":{"start":{"line":103,"column":4},"end":{"line":105,"column":5}},"55":{"start":{"line":104,"column":6},"end":{"line":104,"column":47}},"56":{"start":{"line":108,"column":2},"end":{"line":108,"column":14}},"57":{"start":{"line":111,"column":0},"end":{"line":119,"column":2}},"58":{"start":{"line":112,"column":2},"end":{"line":114,"column":3}},"59":{"start":{"line":113,"column":4},"end":{"line":113,"column":32}},"60":{"start":{"line":116,"column":2},"end":{"line":116,"column":27}},"61":{"start":{"line":117,"column":2},"end":{"line":117,"column":16}},"62":{"start":{"line":118,"column":2},"end":{"line":118,"column":21}},"63":{"start":{"line":129,"column":0},"end":{"line":160,"column":2}},"64":{"start":{"line":130,"column":2},"end":{"line":130,"column":49}},"65":{"start":{"line":131,"column":2},"end":{"line":131,"column":34}},"66":{"start":{"line":132,"column":2},"end":{"line":132,"column":33}},"67":{"start":{"line":133,"column":2},"end":{"line":133,"column":26}},"68":{"start":{"line":135,"column":2},"end":{"line":135,"column":64}},"69":{"start":{"line":136,"column":2},"end":{"line":136,"column":27}},"70":{"start":{"line":138,"column":2},"end":{"line":157,"column":3}},"71":{"start":{"line":140,"column":4},"end":{"line":140,"column":53}},"72":{"start":{"line":141,"column":4},"end":{"line":143,"column":5}},"73":{"start":{"line":142,"column":6},"end":{"line":142,"column":52}},"74":{"start":{"line":145,"column":4},"end":{"line":155,"column":5}},"75":{"start":{"line":146,"column":6},"end":{"line":146,"column":50}},"76":{"start":{"line":147,"column":6},"end":{"line":147,"column":60}},"77":{"start":{"line":148,"column":6},"end":{"line":148,"column":74}},"78":{"start":{"line":149,"column":6},"end":{"line":149,"column":45}},"79":{"start":{"line":150,"column":6},"end":{"line":150,"column":29}},"80":{"start":{"line":152,"column":6},"end":{"line":152,"column":25}},"81":{"start":{"line":153,"column":6},"end":{"line":153,"column":184}},"82":{"start":{"line":154,"column":6},"end":{"line":154,"column":21}},"83":{"start":{"line":159,"column":2},"end":{"line":159,"column":14}},"84":{"start":{"line":170,"column":0},"end":{"line":188,"column":2}},"85":{"start":{"line":171,"column":2},"end":{"line":171,"column":55}},"86":{"start":{"line":172,"column":2},"end":{"line":172,"column":34}},"87":{"start":{"line":173,"column":2},"end":{"line":173,"column":33}},"88":{"start":{"line":174,"column":2},"end":{"line":174,"column":26}},"89":{"start":{"line":176,"column":2},"end":{"line":176,"column":70}},"90":{"start":{"line":178,"column":2},"end":{"line":178,"column":30}},"91":{"start":{"line":180,"column":2},"end":{"line":185,"column":3}},"92":{"start":{"line":182,"column":4},"end":{"line":182,"column":38}},"93":{"start":{"line":183,"column":4},"end":{"line":183,"column":35}},"94":{"start":{"line":184,"column":4},"end":{"line":184,"column":18}},"95":{"start":{"line":187,"column":2},"end":{"line":187,"column":14}},"96":{"start":{"line":190,"column":0},"end":{"line":196,"column":2}},"97":{"start":{"line":191,"column":2},"end":{"line":191,"column":24}},"98":{"start":{"line":192,"column":2},"end":{"line":192,"column":27}},"99":{"start":{"line":193,"column":2},"end":{"line":193,"column":25}},"100":{"start":{"line":194,"column":2},"end":{"line":194,"column":30}},"101":{"start":{"line":195,"column":2},"end":{"line":195,"column":25}},"102":{"start":{"line":198,"column":0},"end":{"line":200,"column":2}},"103":{"start":{"line":199,"column":2},"end":{"line":199,"column":175}}},"branchMap":{"1":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":2},"end":{"line":25,"column":2}},{"start":{"line":25,"column":2},"end":{"line":25,"column":2}}]},"2":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"3":{"line":29,"type":"binary-expr","locations":[{"start":{"line":29,"column":5},"end":{"line":29,"column":12}},{"start":{"line":29,"column":16},"end":{"line":29,"column":21}}]},"4":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":2},"end":{"line":33,"column":2}},{"start":{"line":33,"column":2},"end":{"line":33,"column":2}}]},"5":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":5},"end":{"line":33,"column":19}},{"start":{"line":33,"column":23},"end":{"line":33,"column":61}}]},"6":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":2},"end":{"line":72,"column":2}},{"start":{"line":72,"column":2},"end":{"line":72,"column":2}}]},"7":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":5},"end":{"line":72,"column":23}},{"start":{"line":72,"column":27},"end":{"line":72,"column":53}}]},"8":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":2},"end":{"line":84,"column":2}},{"start":{"line":84,"column":2},"end":{"line":84,"column":2}}]},"9":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":2},"end":{"line":88,"column":2}},{"start":{"line":88,"column":2},"end":{"line":88,"column":2}}]},"10":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":5},"end":{"line":88,"column":30}},{"start":{"line":88,"column":34},"end":{"line":88,"column":57}}]},"11":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":2},"end":{"line":92,"column":2}},{"start":{"line":92,"column":2},"end":{"line":92,"column":2}}]},"12":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":20}},{"start":{"line":98,"column":24},"end":{"line":98,"column":50}}]},"13":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":4},"end":{"line":99,"column":4}},{"start":{"line":99,"column":4},"end":{"line":99,"column":4}}]},"14":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":4},"end":{"line":103,"column":4}},{"start":{"line":103,"column":4},"end":{"line":103,"column":4}}]},"15":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":2},"end":{"line":112,"column":2}},{"start":{"line":112,"column":2},"end":{"line":112,"column":2}}]},"16":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":2},"end":{"line":138,"column":2}},{"start":{"line":138,"column":2},"end":{"line":138,"column":2}}]},"17":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":4},"end":{"line":141,"column":4}},{"start":{"line":141,"column":4},"end":{"line":141,"column":4}}]},"18":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"19":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":2},"end":{"line":180,"column":2}},{"start":{"line":180,"column":2},"end":{"line":180,"column":2}}]},"20":{"line":199,"type":"binary-expr","locations":[{"start":{"line":199,"column":9},"end":{"line":199,"column":40}},{"start":{"line":199,"column":44},"end":{"line":199,"column":79}},{"start":{"line":199,"column":83},"end":{"line":199,"column":114}},{"start":{"line":199,"column":118},"end":{"line":199,"column":144}},{"start":{"line":199,"column":148},"end":{"line":199,"column":174}}]}},"code":["var Stream = require('stream');","var util = require('util');","var protocol = require('pomelo-protocol');","var Package = protocol.Package;","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","/**"," * Work states"," */","var ST_HEAD = 1;      // wait for head","var ST_BODY = 2;      // wait for body","var ST_CLOSED = 3;    // closed","","/**"," * Tcp socket wrapper with package compositing."," * Collect the package from socket and emit a completed package with 'data' event."," * Uniform with ws.WebSocket interfaces."," *"," * @param {Object} socket origin socket from node.js net module"," * @param {Object} opts   options parameter."," *                        opts.headSize size of package head"," *                        opts.headHandler(headBuffer) handler for package head. caculate and return body size from head data."," */","var Socket = function(socket, opts) {","  if(!(this instanceof Socket)) {","    return new Socket(socket, opts);","  }","","  if(!socket || !opts) {","    throw new Error('invalid socket or opts');","  }","","  if(!opts.headSize || typeof opts.headHandler !== 'function') {","    throw new Error('invalid opts.headSize or opts.headHandler');","  }","","  // stream style interfaces.","  // TODO: need to port to stream2 after node 0.9","  Stream.call(this);","  this.readable = true;","  this.writeable = true;","","  this._socket = socket;","  this.headSize = opts.headSize;","  this.closeMethod = opts.closeMethod;","  this.headBuffer = new Buffer(opts.headSize);","  this.headHandler = opts.headHandler;","","  this.headOffset = 0;","  this.packageOffset = 0;","  this.packageSize = 0;","  this.packageBuffer = null;","","  // bind event form the origin socket","  this._socket.on('data', ondata.bind(null, this));","  this._socket.on('end', onend.bind(null, this));","  this._socket.on('error', this.emit.bind(this, 'error'));","  this._socket.on('close', this.emit.bind(this, 'close'));","","  this.state = ST_HEAD;","};","","util.inherits(Socket, Stream);","","module.exports = Socket;","","Socket.prototype.send = function(msg, encode, cb) {","  this._socket.write(msg, encode, cb);","};","","Socket.prototype.close = function() {","  if(!!this.closeMethod && this.closeMethod === 'end') {","    this._socket.end();","  } else {","    try { ","      this._socket.destroy(); ","    } catch (e) {","      logger.error('socket close with destroy error: %j', e.stack);","    }","  }","};","","var ondata = function(socket, chunk) {","  if(socket.state === ST_CLOSED) {","    throw new Error('socket has closed');","  }","","  if(typeof chunk !== 'string' && !Buffer.isBuffer(chunk)) {","    throw new Error('invalid data');","  }","","  if(typeof chunk === 'string') {","    chunk = new Buffer(chunk, 'utf8');","  }","","  var offset = 0, end = chunk.length;","","  while(offset < end && socket.state !== ST_CLOSED) {","    if(socket.state === ST_HEAD) {","      offset = readHead(socket, chunk, offset);","    }","","    if(socket.state === ST_BODY) {","      offset = readBody(socket, chunk, offset);","    }","  }","","  return true;","};","","var onend = function(socket, chunk) {","  if(chunk) {","    socket._socket.write(chunk);","  }","","  socket.state = ST_CLOSED;","  reset(socket);","  socket.emit('end');","};","","/**"," * Read head segment from data to socket.headBuffer."," *"," * @param  {Object} socket Socket instance"," * @param  {Object} data   Buffer instance"," * @param  {Number} offset offset read star from data"," * @return {Number}        new offset of data after read"," */","var readHead = function(socket, data, offset) {","  var hlen = socket.headSize - socket.headOffset;","  var dlen = data.length - offset;","  var len = Math.min(hlen, dlen);","  var dend = offset + len;","","  data.copy(socket.headBuffer, socket.headOffset, offset, dend);","  socket.headOffset += len;","","  if(socket.headOffset === socket.headSize) {","    // if head segment finished","    var size = socket.headHandler(socket.headBuffer);","    if(size < 0) {","      throw new Error('invalid body size: ' + size);","    }","    // check if header contains a valid type","    if(checkTypeData(socket.headBuffer[0])) {","      socket.packageSize = size + socket.headSize;","      socket.packageBuffer = new Buffer(socket.packageSize);","      socket.headBuffer.copy(socket.packageBuffer, 0, 0, socket.headSize);","      socket.packageOffset = socket.headSize;","      socket.state = ST_BODY;","    } else {","      dend = data.length;","      logger.error('close the connection with invalid head message, the remote ip is %s && port is %s && message is %j', socket._socket.remoteAddress, socket._socket.remotePort, data);","      socket.close();","    }","","  }","","  return dend;","};","","/**"," * Read body segment from data buffer to socket.packageBuffer;"," *"," * @param  {Object} socket Socket instance"," * @param  {Object} data   Buffer instance"," * @param  {Number} offset offset read star from data"," * @return {Number}        new offset of data after read"," */","var readBody = function(socket, data, offset) {","  var blen = socket.packageSize - socket.packageOffset;","  var dlen = data.length - offset;","  var len = Math.min(blen, dlen);","  var dend = offset + len;","","  data.copy(socket.packageBuffer, socket.packageOffset, offset, dend);","","  socket.packageOffset += len;","","  if(socket.packageOffset === socket.packageSize) {","    // if all the package finished","    var buffer = socket.packageBuffer;","    socket.emit('message', buffer);","    reset(socket);","  }","","  return dend;","};","","var reset = function(socket) {","  socket.headOffset = 0;","  socket.packageOffset = 0;","  socket.packageSize = 0;","  socket.packageBuffer = null;","  socket.state = ST_HEAD;","};","","var checkTypeData = function(data) {","  return data === Package.TYPE_HANDSHAKE || data === Package.TYPE_HANDSHAKE_ACK || data === Package.TYPE_HEARTBEAT || data === Package.TYPE_DATA || data === Package.TYPE_KICK;","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"10":1,"11":1,"12":1,"24":1,"25":0,"26":0,"29":0,"30":0,"33":0,"34":0,"39":0,"40":0,"41":0,"43":0,"44":0,"45":0,"46":0,"47":0,"49":0,"50":0,"51":0,"52":0,"55":0,"56":0,"57":0,"58":0,"60":0,"63":1,"65":1,"67":1,"68":0,"71":1,"72":0,"73":0,"75":0,"76":0,"78":0,"83":1,"84":0,"85":0,"88":0,"89":0,"92":0,"93":0,"96":0,"98":0,"99":0,"100":0,"103":0,"104":0,"108":0,"111":1,"112":0,"113":0,"116":0,"117":0,"118":0,"129":1,"130":0,"131":0,"132":0,"133":0,"135":0,"136":0,"138":0,"140":0,"141":0,"142":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"152":0,"153":0,"154":0,"159":0,"170":1,"171":0,"172":0,"173":0,"174":0,"176":0,"178":0,"180":0,"182":0,"183":0,"184":0,"187":0,"190":1,"191":0,"192":0,"193":0,"194":0,"195":0,"198":1,"199":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/commands/handshake.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/commands/handshake.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":1,"62":0,"63":0,"64":0,"65":0,"66":1,"67":0,"68":0,"69":0,"70":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":14},"end":{"line":16,"column":29}}},"2":{"name":"(anonymous_2)","line":34,"loc":{"start":{"line":34,"column":27},"end":{"line":34,"column":49}}},"3":{"name":"(anonymous_3)","line":89,"loc":{"start":{"line":89,"column":28},"end":{"line":89,"column":48}}},"4":{"name":"(anonymous_4)","line":91,"loc":{"start":{"line":91,"column":25},"end":{"line":91,"column":36}}},"5":{"name":"(anonymous_5)","line":96,"loc":{"start":{"line":96,"column":23},"end":{"line":96,"column":34}}},"6":{"name":"(anonymous_6)","line":103,"loc":{"start":{"line":103,"column":19},"end":{"line":103,"column":30}}},"7":{"name":"(anonymous_7)","line":108,"loc":{"start":{"line":108,"column":21},"end":{"line":108,"column":36}}},"8":{"name":"(anonymous_8)","line":112,"loc":{"start":{"line":112,"column":15},"end":{"line":112,"column":43}}},"9":{"name":"(anonymous_9)","line":123,"loc":{"start":{"line":123,"column":19},"end":{"line":123,"column":42}}},"10":{"name":"(anonymous_10)","line":128,"loc":{"start":{"line":128,"column":19},"end":{"line":128,"column":30}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":49}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":18}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":25}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":26}},"6":{"start":{"line":16,"column":0},"end":{"line":30,"column":2}},"7":{"start":{"line":17,"column":2},"end":{"line":17,"column":20}},"8":{"start":{"line":18,"column":2},"end":{"line":18,"column":38}},"9":{"start":{"line":20,"column":2},"end":{"line":23,"column":3}},"10":{"start":{"line":21,"column":4},"end":{"line":21,"column":39}},"11":{"start":{"line":22,"column":4},"end":{"line":22,"column":43}},"12":{"start":{"line":25,"column":2},"end":{"line":25,"column":38}},"13":{"start":{"line":27,"column":2},"end":{"line":27,"column":30}},"14":{"start":{"line":28,"column":2},"end":{"line":28,"column":38}},"15":{"start":{"line":29,"column":2},"end":{"line":29,"column":34}},"16":{"start":{"line":32,"column":0},"end":{"line":32,"column":25}},"17":{"start":{"line":34,"column":0},"end":{"line":106,"column":2}},"18":{"start":{"line":35,"column":2},"end":{"line":38,"column":3}},"19":{"start":{"line":36,"column":4},"end":{"line":36,"column":41}},"20":{"start":{"line":37,"column":4},"end":{"line":37,"column":11}},"21":{"start":{"line":40,"column":2},"end":{"line":45,"column":3}},"22":{"start":{"line":41,"column":4},"end":{"line":44,"column":5}},"23":{"start":{"line":42,"column":6},"end":{"line":42,"column":44}},"24":{"start":{"line":43,"column":6},"end":{"line":43,"column":13}},"25":{"start":{"line":47,"column":2},"end":{"line":49,"column":4}},"26":{"start":{"line":51,"column":2},"end":{"line":63,"column":3}},"27":{"start":{"line":52,"column":4},"end":{"line":52,"column":72}},"28":{"start":{"line":53,"column":4},"end":{"line":61,"column":5}},"29":{"start":{"line":56,"column":6},"end":{"line":56,"column":65}},"30":{"start":{"line":58,"column":6},"end":{"line":58,"column":72}},"31":{"start":{"line":59,"column":6},"end":{"line":59,"column":73}},"32":{"start":{"line":60,"column":6},"end":{"line":60,"column":37}},"33":{"start":{"line":62,"column":4},"end":{"line":62,"column":24}},"34":{"start":{"line":65,"column":2},"end":{"line":71,"column":3}},"35":{"start":{"line":66,"column":4},"end":{"line":66,"column":71}},"36":{"start":{"line":67,"column":4},"end":{"line":69,"column":5}},"37":{"start":{"line":68,"column":6},"end":{"line":68,"column":67}},"38":{"start":{"line":70,"column":4},"end":{"line":70,"column":25}},"39":{"start":{"line":73,"column":2},"end":{"line":82,"column":3}},"40":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"41":{"start":{"line":75,"column":6},"end":{"line":75,"column":76}},"42":{"start":{"line":77,"column":4},"end":{"line":77,"column":76}},"43":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"44":{"start":{"line":79,"column":6},"end":{"line":79,"column":77}},"45":{"start":{"line":81,"column":4},"end":{"line":81,"column":25}},"46":{"start":{"line":84,"column":2},"end":{"line":86,"column":3}},"47":{"start":{"line":85,"column":4},"end":{"line":85,"column":74}},"48":{"start":{"line":88,"column":2},"end":{"line":101,"column":3}},"49":{"start":{"line":89,"column":4},"end":{"line":99,"column":15}},"50":{"start":{"line":90,"column":6},"end":{"line":95,"column":7}},"51":{"start":{"line":91,"column":8},"end":{"line":93,"column":11}},"52":{"start":{"line":92,"column":10},"end":{"line":92,"column":47}},"53":{"start":{"line":94,"column":8},"end":{"line":94,"column":15}},"54":{"start":{"line":96,"column":6},"end":{"line":98,"column":9}},"55":{"start":{"line":97,"column":8},"end":{"line":97,"column":37}},"56":{"start":{"line":100,"column":4},"end":{"line":100,"column":11}},"57":{"start":{"line":103,"column":2},"end":{"line":105,"column":5}},"58":{"start":{"line":104,"column":4},"end":{"line":104,"column":27}},"59":{"start":{"line":108,"column":0},"end":{"line":110,"column":2}},"60":{"start":{"line":109,"column":2},"end":{"line":109,"column":27}},"61":{"start":{"line":112,"column":0},"end":{"line":121,"column":2}},"62":{"start":{"line":113,"column":2},"end":{"line":116,"column":4}},"63":{"start":{"line":117,"column":2},"end":{"line":119,"column":3}},"64":{"start":{"line":118,"column":4},"end":{"line":118,"column":20}},"65":{"start":{"line":120,"column":2},"end":{"line":120,"column":100}},"66":{"start":{"line":123,"column":0},"end":{"line":131,"column":2}},"67":{"start":{"line":124,"column":2},"end":{"line":126,"column":4}},"68":{"start":{"line":127,"column":2},"end":{"line":127,"column":92}},"69":{"start":{"line":128,"column":2},"end":{"line":130,"column":5}},"70":{"start":{"line":129,"column":4},"end":{"line":129,"column":24}}},"branchMap":{"1":{"line":17,"type":"binary-expr","locations":[{"start":{"line":17,"column":9},"end":{"line":17,"column":13}},{"start":{"line":17,"column":17},"end":{"line":17,"column":19}}]},"2":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":20,"column":2}},{"start":{"line":20,"column":2},"end":{"line":20,"column":2}}]},"3":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":35,"column":2}},{"start":{"line":35,"column":2},"end":{"line":35,"column":2}}]},"4":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":40,"column":2}},{"start":{"line":40,"column":2},"end":{"line":40,"column":2}}]},"5":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":41,"column":4}},{"start":{"line":41,"column":4},"end":{"line":41,"column":4}}]},"6":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":7},"end":{"line":41,"column":11}},{"start":{"line":41,"column":15},"end":{"line":41,"column":23}},{"start":{"line":41,"column":27},"end":{"line":41,"column":75}}]},"7":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":2},"end":{"line":51,"column":2}},{"start":{"line":51,"column":2},"end":{"line":51,"column":2}}]},"8":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":4},"end":{"line":53,"column":4}},{"start":{"line":53,"column":4},"end":{"line":53,"column":4}}]},"9":{"line":53,"type":"binary-expr","locations":[{"start":{"line":53,"column":7},"end":{"line":53,"column":27}},{"start":{"line":53,"column":31},"end":{"line":53,"column":66}}]},"10":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":2},"end":{"line":65,"column":2}},{"start":{"line":65,"column":2},"end":{"line":65,"column":2}}]},"11":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":67,"column":4}},{"start":{"line":67,"column":4},"end":{"line":67,"column":4}}]},"12":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":7},"end":{"line":67,"column":28}},{"start":{"line":67,"column":32},"end":{"line":67,"column":69}}]},"13":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":2},"end":{"line":73,"column":2}},{"start":{"line":73,"column":2},"end":{"line":73,"column":2}}]},"14":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":74,"column":4}},{"start":{"line":74,"column":4},"end":{"line":74,"column":4}}]},"15":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":78,"column":4}},{"start":{"line":78,"column":4},"end":{"line":78,"column":4}}]},"16":{"line":78,"type":"binary-expr","locations":[{"start":{"line":78,"column":7},"end":{"line":78,"column":28}},{"start":{"line":78,"column":32},"end":{"line":78,"column":62}}]},"17":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":2},"end":{"line":84,"column":2}},{"start":{"line":84,"column":2},"end":{"line":84,"column":2}}]},"18":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":2},"end":{"line":88,"column":2}},{"start":{"line":88,"column":2},"end":{"line":88,"column":2}}]},"19":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":6},"end":{"line":90,"column":6}},{"start":{"line":90,"column":6},"end":{"line":90,"column":6}}]},"20":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":2},"end":{"line":117,"column":2}},{"start":{"line":117,"column":2},"end":{"line":117,"column":2}}]}},"code":["var pomelo = require('../../pomelo');","var Package = require('pomelo-protocol').Package;","","var CODE_OK = 200;","var CODE_USE_ERROR = 500;","var CODE_OLD_CLIENT = 501;","","/**"," * Process the handshake request."," *"," * @param {Object} opts option parameters"," *                      opts.handshake(msg, cb(err, resp)) handshake callback. msg is the handshake message from client."," *                      opts.hearbeat heartbeat interval (level?)"," *                      opts.version required client level"," */","var Command = function(opts) {","  opts = opts || {};","  this.userHandshake = opts.handshake;","","  if(opts.heartbeat) {","    this.heartbeatSec = opts.heartbeat;","    this.heartbeat = opts.heartbeat * 1000;","  }","","  this.checkClient = opts.checkClient;","","  this.useDict = opts.useDict;","  this.useProtobuf = opts.useProtobuf;","  this.useCrypto = opts.useCrypto;","};","","module.exports = Command;","","Command.prototype.handle = function(socket, msg) {","  if(!msg.sys) {","    processError(socket, CODE_USE_ERROR);","    return;","  }","","  if(typeof this.checkClient === 'function') {","    if(!msg || !msg.sys || !this.checkClient(msg.sys.type, msg.sys.version)) {","      processError(socket, CODE_OLD_CLIENT);","      return;","    }","  }","","  var opts = {","    heartbeat : setupHeartbeat(this)","  };","","  if(this.useDict) {","    var dictVersion = pomelo.app.components.__dictionary__.getVersion();","    if(!msg.sys.dictVersion || msg.sys.dictVersion !== dictVersion){","","      // may be deprecated in future","      opts.dict = pomelo.app.components.__dictionary__.getDict();","","      opts.routeToCode = pomelo.app.components.__dictionary__.getDict();","      opts.codeToRoute = pomelo.app.components.__dictionary__.getAbbrs();","      opts.dictVersion = dictVersion; ","    }","    opts.useDict = true;","  }","","  if(this.useProtobuf) {","    var protoVersion = pomelo.app.components.__protobuf__.getVersion();","    if(!msg.sys.protoVersion || msg.sys.protoVersion !== protoVersion){","      opts.protos = pomelo.app.components.__protobuf__.getProtos();","    }","    opts.useProto = true;","  }","","  if(!!pomelo.app.components.__decodeIO__protobuf__) {","    if(!!this.useProtobuf) {","      throw new Error('protobuf can not be both used in the same project.');","    }","    var version = pomelo.app.components.__decodeIO__protobuf__.getVersion();","    if(!msg.sys.protoVersion || msg.sys.protoVersion < version) {","      opts.protos = pomelo.app.components.__decodeIO__protobuf__.getProtos();","    }","    opts.useProto = true;","  }","","  if(this.useCrypto) {","    pomelo.app.components.__connector__.setPubKey(socket.id, msg.sys.rsa);","  }","","  if(typeof this.userHandshake === 'function') {","    this.userHandshake(msg, function(err, resp) {","      if(err) {","        process.nextTick(function() {","          processError(socket, CODE_USE_ERROR);","        });","        return;","      }","      process.nextTick(function() {","        response(socket, opts, resp);","      });","    }, socket);","    return;","  }","","  process.nextTick(function() {","    response(socket, opts);","  });","};","","var setupHeartbeat = function(self) {","  return self.heartbeatSec;","};","","var response = function(socket, sys, resp) {","  var res = {","    code: CODE_OK,","    sys: sys","  };","  if(resp) {","    res.user = resp;","  }","  socket.handshakeResponse(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify(res))));","};","","var processError = function(socket, code) {","  var res = {","    code: code","  };","  socket.sendForce(Package.encode(Package.TYPE_HANDSHAKE, new Buffer(JSON.stringify(res))));","  process.nextTick(function() {","    socket.disconnect();","  });","};",""],"l":{"1":1,"2":1,"4":1,"5":1,"6":1,"16":1,"17":0,"18":0,"20":0,"21":0,"22":0,"25":0,"27":0,"28":0,"29":0,"32":1,"34":1,"35":0,"36":0,"37":0,"40":0,"41":0,"42":0,"43":0,"47":0,"51":0,"52":0,"53":0,"56":0,"58":0,"59":0,"60":0,"62":0,"65":0,"66":0,"67":0,"68":0,"70":0,"73":0,"74":0,"75":0,"77":0,"78":0,"79":0,"81":0,"84":0,"85":0,"88":0,"89":0,"90":0,"91":0,"92":0,"94":0,"96":0,"97":0,"100":0,"103":0,"104":0,"108":1,"109":0,"112":1,"113":0,"117":0,"118":0,"120":0,"123":1,"124":0,"127":0,"128":0,"129":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/commands/heartbeat.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/commands/heartbeat.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":14},"end":{"line":10,"column":29}}},"2":{"name":"(anonymous_2)","line":28,"loc":{"start":{"line":28,"column":27},"end":{"line":28,"column":44}}},"3":{"name":"(anonymous_3)","line":51,"loc":{"start":{"line":51,"column":42},"end":{"line":51,"column":53}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":26},"end":{"line":58,"column":39}}},"5":{"name":"(anonymous_5)","line":66,"loc":{"start":{"line":66,"column":18},"end":{"line":66,"column":37}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":49}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":70}},"3":{"start":{"line":10,"column":0},"end":{"line":24,"column":2}},"4":{"start":{"line":11,"column":2},"end":{"line":11,"column":20}},"5":{"start":{"line":12,"column":2},"end":{"line":12,"column":24}},"6":{"start":{"line":13,"column":2},"end":{"line":13,"column":22}},"7":{"start":{"line":14,"column":2},"end":{"line":14,"column":54}},"8":{"start":{"line":16,"column":2},"end":{"line":20,"column":3}},"9":{"start":{"line":17,"column":4},"end":{"line":17,"column":43}},"10":{"start":{"line":18,"column":4},"end":{"line":18,"column":61}},"11":{"start":{"line":19,"column":4},"end":{"line":19,"column":36}},"12":{"start":{"line":22,"column":2},"end":{"line":22,"column":21}},"13":{"start":{"line":23,"column":2},"end":{"line":23,"column":20}},"14":{"start":{"line":26,"column":0},"end":{"line":26,"column":25}},"15":{"start":{"line":28,"column":0},"end":{"line":56,"column":2}},"16":{"start":{"line":29,"column":2},"end":{"line":32,"column":3}},"17":{"start":{"line":31,"column":4},"end":{"line":31,"column":11}},"18":{"start":{"line":34,"column":2},"end":{"line":34,"column":18}},"19":{"start":{"line":36,"column":2},"end":{"line":41,"column":3}},"20":{"start":{"line":38,"column":4},"end":{"line":38,"column":32}},"21":{"start":{"line":39,"column":4},"end":{"line":39,"column":71}},"22":{"start":{"line":40,"column":4},"end":{"line":40,"column":66}},"23":{"start":{"line":44,"column":2},"end":{"line":46,"column":3}},"24":{"start":{"line":45,"column":4},"end":{"line":45,"column":26}},"25":{"start":{"line":48,"column":2},"end":{"line":48,"column":57}},"26":{"start":{"line":50,"column":2},"end":{"line":55,"column":3}},"27":{"start":{"line":51,"column":4},"end":{"line":54,"column":21}},"28":{"start":{"line":52,"column":6},"end":{"line":52,"column":61}},"29":{"start":{"line":53,"column":6},"end":{"line":53,"column":26}},"30":{"start":{"line":58,"column":0},"end":{"line":64,"column":2}},"31":{"start":{"line":59,"column":2},"end":{"line":59,"column":30}},"32":{"start":{"line":60,"column":2},"end":{"line":63,"column":3}},"33":{"start":{"line":61,"column":4},"end":{"line":61,"column":22}},"34":{"start":{"line":62,"column":4},"end":{"line":62,"column":29}},"35":{"start":{"line":66,"column":0},"end":{"line":73,"column":2}},"36":{"start":{"line":67,"column":2},"end":{"line":67,"column":26}},"37":{"start":{"line":68,"column":2},"end":{"line":68,"column":30}},"38":{"start":{"line":69,"column":2},"end":{"line":72,"column":3}},"39":{"start":{"line":70,"column":4},"end":{"line":70,"column":22}},"40":{"start":{"line":71,"column":4},"end":{"line":71,"column":29}}},"branchMap":{"1":{"line":11,"type":"binary-expr","locations":[{"start":{"line":11,"column":9},"end":{"line":11,"column":13}},{"start":{"line":11,"column":17},"end":{"line":11,"column":19}}]},"2":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":16,"column":2}},{"start":{"line":16,"column":2},"end":{"line":16,"column":2}}]},"3":{"line":18,"type":"binary-expr","locations":[{"start":{"line":18,"column":19},"end":{"line":18,"column":38}},{"start":{"line":18,"column":42},"end":{"line":18,"column":60}}]},"4":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"5":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":2}},{"start":{"line":36,"column":2},"end":{"line":36,"column":2}}]},"6":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":2},"end":{"line":44,"column":2}},{"start":{"line":44,"column":2},"end":{"line":44,"column":2}}]},"7":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":50,"column":2}},{"start":{"line":50,"column":2},"end":{"line":50,"column":2}}]},"8":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":60,"column":2}},{"start":{"line":60,"column":2},"end":{"line":60,"column":2}}]},"9":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":69,"column":2}},{"start":{"line":69,"column":2},"end":{"line":69,"column":2}}]}},"code":["var Package = require('pomelo-protocol').Package;","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","/**"," * Process heartbeat request."," *"," * @param {Object} opts option request"," *                      opts.heartbeat heartbeat interval"," */","var Command = function(opts) {","  opts = opts || {};","  this.heartbeat = null;","  this.timeout = null;","  this.disconnectOnTimeout = opts.disconnectOnTimeout;","","  if(opts.heartbeat) {","    this.heartbeat = opts.heartbeat * 1000; // heartbeat interval","    this.timeout = opts.timeout * 1000 || this.heartbeat * 2;      // max heartbeat message timeout","    this.disconnectOnTimeout = true;","  }","","  this.timeouts = {};","  this.clients = {};","};","","module.exports = Command;","","Command.prototype.handle = function(socket) {","  if(!this.heartbeat) {","    // no heartbeat setting","    return;","  }","","  var self = this;","","  if(!this.clients[socket.id]) {","    // clear timers when socket disconnect or error","    this.clients[socket.id] = 1;","    socket.once('disconnect', clearTimers.bind(null, this, socket.id));","    socket.once('error', clearTimers.bind(null, this, socket.id));","  }","","  // clear timeout timer","  if(self.disconnectOnTimeout) {","    this.clear(socket.id);","  }","","  socket.sendRaw(Package.encode(Package.TYPE_HEARTBEAT));","","  if(self.disconnectOnTimeout) {","    self.timeouts[socket.id] = setTimeout(function() {","      logger.info('client %j heartbeat timeout.', socket.id);","      socket.disconnect();","    }, self.timeout);","  }","};","","Command.prototype.clear = function(id) {","  var tid = this.timeouts[id];","  if(tid) {","    clearTimeout(tid);","    delete this.timeouts[id];","  }","};","","var clearTimers = function(self, id) {","  delete self.clients[id];","  var tid = self.timeouts[id];","  if(tid) {","    clearTimeout(tid);","    delete self.timeouts[id];","  }","};",""],"l":{"1":1,"2":1,"10":1,"11":0,"12":0,"13":0,"14":0,"16":0,"17":0,"18":0,"19":0,"22":0,"23":0,"26":1,"28":1,"29":0,"31":0,"34":0,"36":0,"38":0,"39":0,"40":0,"44":0,"45":0,"48":0,"50":0,"51":0,"52":0,"53":0,"58":1,"59":0,"60":0,"61":0,"62":0,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/commands/kick.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/commands/kick.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":24},"end":{"line":3,"column":49}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":49}},"2":{"start":{"line":3,"column":0},"end":{"line":11,"column":2}},"3":{"start":{"line":5,"column":2},"end":{"line":10,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":8,"column":6}},"5":{"start":{"line":9,"column":4},"end":{"line":9,"column":87}}},"branchMap":{"1":{"line":5,"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":5,"column":2}},{"start":{"line":5,"column":2},"end":{"line":5,"column":2}}]}},"code":["var Package = require('pomelo-protocol').Package;","","module.exports.handle = function(socket, reason) {","// websocket close code 1000 would emit when client close the connection","  if(typeof reason === 'string') {","    var res = {","      reason: reason","    };","    socket.sendRaw(Package.encode(Package.TYPE_KICK, new Buffer(JSON.stringify(res))));","  }","};",""],"l":{"1":1,"3":1,"5":0,"6":0,"9":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/common/coder.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/common/coder.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":0,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":13},"end":{"line":5,"column":41}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":13},"end":{"line":13,"column":27}}},"3":{"name":"(anonymous_3)","line":48,"loc":{"start":{"line":48,"column":22},"end":{"line":48,"column":62}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":18},"end":{"line":56,"column":51}}},"5":{"name":"(anonymous_5)","line":73,"loc":{"start":{"line":73,"column":17},"end":{"line":73,"column":50}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":49}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":48}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":70}},"4":{"start":{"line":5,"column":0},"end":{"line":11,"column":2}},"5":{"start":{"line":6,"column":2},"end":{"line":10,"column":3}},"6":{"start":{"line":7,"column":4},"end":{"line":7,"column":52}},"7":{"start":{"line":9,"column":4},"end":{"line":9,"column":41}},"8":{"start":{"line":13,"column":0},"end":{"line":46,"column":2}},"9":{"start":{"line":14,"column":2},"end":{"line":14,"column":33}},"10":{"start":{"line":15,"column":2},"end":{"line":15,"column":24}},"11":{"start":{"line":18,"column":2},"end":{"line":30,"column":3}},"12":{"start":{"line":19,"column":4},"end":{"line":29,"column":5}},"13":{"start":{"line":20,"column":6},"end":{"line":20,"column":45}},"14":{"start":{"line":21,"column":6},"end":{"line":24,"column":7}},"15":{"start":{"line":22,"column":8},"end":{"line":22,"column":73}},"16":{"start":{"line":23,"column":8},"end":{"line":23,"column":20}},"17":{"start":{"line":25,"column":6},"end":{"line":25,"column":39}},"18":{"start":{"line":27,"column":6},"end":{"line":27,"column":100}},"19":{"start":{"line":28,"column":6},"end":{"line":28,"column":18}},"20":{"start":{"line":33,"column":2},"end":{"line":43,"column":3}},"21":{"start":{"line":34,"column":4},"end":{"line":34,"column":53}},"22":{"start":{"line":35,"column":9},"end":{"line":43,"column":3}},"23":{"start":{"line":36,"column":4},"end":{"line":36,"column":62}},"24":{"start":{"line":38,"column":4},"end":{"line":42,"column":5}},"25":{"start":{"line":39,"column":6},"end":{"line":39,"column":55}},"26":{"start":{"line":41,"column":6},"end":{"line":41,"column":20}},"27":{"start":{"line":45,"column":2},"end":{"line":45,"column":13}},"28":{"start":{"line":48,"column":0},"end":{"line":54,"column":2}},"29":{"start":{"line":49,"column":2},"end":{"line":51,"column":3}},"30":{"start":{"line":50,"column":4},"end":{"line":50,"column":16}},"31":{"start":{"line":52,"column":2},"end":{"line":52,"column":47}},"32":{"start":{"line":53,"column":2},"end":{"line":53,"column":72}},"33":{"start":{"line":56,"column":0},"end":{"line":71,"column":2}},"34":{"start":{"line":57,"column":2},"end":{"line":59,"column":3}},"35":{"start":{"line":58,"column":4},"end":{"line":58,"column":16}},"36":{"start":{"line":60,"column":2},"end":{"line":60,"column":47}},"37":{"start":{"line":62,"column":2},"end":{"line":62,"column":24}},"38":{"start":{"line":63,"column":2},"end":{"line":69,"column":3}},"39":{"start":{"line":64,"column":4},"end":{"line":64,"column":43}},"40":{"start":{"line":65,"column":4},"end":{"line":68,"column":5}},"41":{"start":{"line":66,"column":6},"end":{"line":66,"column":26}},"42":{"start":{"line":67,"column":6},"end":{"line":67,"column":24}},"43":{"start":{"line":70,"column":2},"end":{"line":70,"column":77}},"44":{"start":{"line":73,"column":0},"end":{"line":83,"column":2}},"45":{"start":{"line":75,"column":2},"end":{"line":81,"column":3}},"46":{"start":{"line":76,"column":4},"end":{"line":76,"column":53}},"47":{"start":{"line":77,"column":9},"end":{"line":81,"column":3}},"48":{"start":{"line":78,"column":5},"end":{"line":78,"column":63}},"49":{"start":{"line":80,"column":4},"end":{"line":80,"column":58}},"50":{"start":{"line":82,"column":2},"end":{"line":82,"column":17}},"51":{"start":{"line":85,"column":0},"end":{"line":88,"column":2}}},"branchMap":{"1":{"line":6,"type":"if","locations":[{"start":{"line":6,"column":2},"end":{"line":6,"column":2}},{"start":{"line":6,"column":2},"end":{"line":6,"column":2}}]},"2":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":2},"end":{"line":18,"column":2}},{"start":{"line":18,"column":2},"end":{"line":18,"column":2}}]},"3":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":4}},{"start":{"line":19,"column":4},"end":{"line":19,"column":4}}]},"4":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":6},"end":{"line":21,"column":6}},{"start":{"line":21,"column":6},"end":{"line":21,"column":6}}]},"5":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":2},"end":{"line":33,"column":2}},{"start":{"line":33,"column":2},"end":{"line":33,"column":2}}]},"6":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":5},"end":{"line":33,"column":20}},{"start":{"line":33,"column":24},"end":{"line":33,"column":65}}]},"7":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":9},"end":{"line":35,"column":9}},{"start":{"line":35,"column":9},"end":{"line":35,"column":9}}]},"8":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":12},"end":{"line":35,"column":36}},{"start":{"line":35,"column":40},"end":{"line":35,"column":104}}]},"9":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":2},"end":{"line":49,"column":2}},{"start":{"line":49,"column":2},"end":{"line":49,"column":2}}]},"10":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":5},"end":{"line":49,"column":11}},{"start":{"line":49,"column":15},"end":{"line":49,"column":21}},{"start":{"line":49,"column":25},"end":{"line":49,"column":33}}]},"11":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":57,"column":2}},{"start":{"line":57,"column":2},"end":{"line":57,"column":2}}]},"12":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":5},"end":{"line":57,"column":11}},{"start":{"line":57,"column":15},"end":{"line":57,"column":23}}]},"13":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":2},"end":{"line":63,"column":2}},{"start":{"line":63,"column":2},"end":{"line":63,"column":2}}]},"14":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":4},"end":{"line":65,"column":4}},{"start":{"line":65,"column":4},"end":{"line":65,"column":4}}]},"15":{"line":65,"type":"binary-expr","locations":[{"start":{"line":65,"column":7},"end":{"line":65,"column":33}},{"start":{"line":65,"column":37},"end":{"line":65,"column":50}}]},"16":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":2},"end":{"line":75,"column":2}},{"start":{"line":75,"column":2},"end":{"line":75,"column":2}}]},"17":{"line":75,"type":"binary-expr","locations":[{"start":{"line":75,"column":5},"end":{"line":75,"column":22}},{"start":{"line":75,"column":26},"end":{"line":75,"column":69}}]},"18":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":9},"end":{"line":77,"column":9}},{"start":{"line":77,"column":9},"end":{"line":77,"column":9}}]},"19":{"line":77,"type":"binary-expr","locations":[{"start":{"line":77,"column":12},"end":{"line":77,"column":38}},{"start":{"line":77,"column":42},"end":{"line":77,"column":108}}]}},"code":["var Message = require('pomelo-protocol').Message;","var Constants = require('../../util/constants');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","var encode = function(reqId, route, msg) {","  if(!!reqId) {","    return composeResponse(this, reqId, route, msg);","  } else {","    return composePush(this, route, msg);","  }","};","","var decode = function(msg) {","  msg = Message.decode(msg.body);","  var route = msg.route;","","  // decode use dictionary","  if(!!msg.compressRoute) {","    if(!!this.connector.useDict) {","      var abbrs = this.dictionary.getAbbrs();","      if(!abbrs[route]) {","        logger.error('dictionary error! no abbrs for route : %s', route);","        return null;","      }","      route = msg.route = abbrs[route];","    } else {","      logger.error('fail to uncompress route code for msg: %j, server not enable dictionary.', msg);","      return null;","    }","  }","","  // decode use protobuf","  if(!!this.protobuf && !!this.protobuf.getProtos().client[route]) {","    msg.body = this.protobuf.decode(route, msg.body);","  } else if(!!this.decodeIO_protobuf && !!this.decodeIO_protobuf.check(Constants.RESERVED.CLIENT, route)) {","    msg.body = this.decodeIO_protobuf.decode(route, msg.body);","  } else {","    try {","      msg.body = JSON.parse(msg.body.toString('utf8'));","    } catch (ex) {","      msg.body = {};","    }","  }","","  return msg;","};","","var composeResponse = function(server, msgId, route, msgBody) {","  if(!msgId || !route || !msgBody) {","    return null;","  }","  msgBody = encodeBody(server, route, msgBody);","  return Message.encode(msgId, Message.TYPE_RESPONSE, 0, null, msgBody);","};","","var composePush = function(server, route, msgBody) {","  if(!route || !msgBody){","    return null;","  }","  msgBody = encodeBody(server, route, msgBody);","  // encode use dictionary","  var compressRoute = 0;","  if(!!server.dictionary) {","    var dict = server.dictionary.getDict();","    if(!!server.connector.useDict && !!dict[route]) {","      route = dict[route];","      compressRoute = 1;","    }","  }","  return Message.encode(0, Message.TYPE_PUSH, compressRoute, route, msgBody);","};","","var encodeBody = function(server, route, msgBody) {","    // encode use protobuf","  if(!!server.protobuf && !!server.protobuf.getProtos().server[route]) {","    msgBody = server.protobuf.encode(route, msgBody);","  } else if(!!server.decodeIO_protobuf && !!server.decodeIO_protobuf.check(Constants.RESERVED.SERVER, route)) {","     msgBody = server.decodeIO_protobuf.encode(route, msgBody);","  } else {","    msgBody = new Buffer(JSON.stringify(msgBody), 'utf8');","  }","  return msgBody;","};","","module.exports = {","  encode: encode,","  decode: decode","};"],"l":{"1":1,"2":1,"3":1,"5":1,"6":0,"7":0,"9":0,"13":1,"14":0,"15":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"25":0,"27":0,"28":0,"33":0,"34":0,"35":0,"36":0,"38":0,"39":0,"41":0,"45":0,"48":1,"49":0,"50":0,"52":0,"53":0,"56":1,"57":0,"58":0,"60":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"70":0,"73":1,"75":0,"76":0,"77":0,"78":0,"80":0,"82":0,"85":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/udpconnector.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/udpconnector.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":1,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":1,"59":1,"60":0,"61":0,"62":1,"63":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":18,"loc":{"start":{"line":18,"column":16},"end":{"line":18,"column":43}}},"2":{"name":"(anonymous_2)","line":41,"loc":{"start":{"line":41,"column":28},"end":{"line":41,"column":41}}},"3":{"name":"(anonymous_3)","line":44,"loc":{"start":{"line":44,"column":46},"end":{"line":44,"column":66}}},"4":{"name":"(anonymous_4)","line":59,"loc":{"start":{"line":59,"column":33},"end":{"line":59,"column":44}}},"5":{"name":"(anonymous_5)","line":69,"loc":{"start":{"line":69,"column":28},"end":{"line":69,"column":49}}},"6":{"name":"(anonymous_6)","line":76,"loc":{"start":{"line":76,"column":26},"end":{"line":76,"column":40}}},"7":{"name":"(anonymous_7)","line":90,"loc":{"start":{"line":90,"column":27},"end":{"line":90,"column":47}}},"8":{"name":"(anonymous_8)","line":95,"loc":{"start":{"line":95,"column":13},"end":{"line":95,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":25}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":27}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":37}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":45}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":39}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":38}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":48}},"9":{"start":{"line":9,"column":0},"end":{"line":9,"column":48}},"10":{"start":{"line":10,"column":0},"end":{"line":10,"column":42}},"11":{"start":{"line":11,"column":0},"end":{"line":11,"column":31}},"12":{"start":{"line":12,"column":0},"end":{"line":12,"column":31}},"13":{"start":{"line":13,"column":0},"end":{"line":13,"column":38}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":50}},"15":{"start":{"line":16,"column":0},"end":{"line":16,"column":14}},"16":{"start":{"line":18,"column":0},"end":{"line":35,"column":2}},"17":{"start":{"line":19,"column":2},"end":{"line":21,"column":3}},"18":{"start":{"line":20,"column":4},"end":{"line":20,"column":43}},"19":{"start":{"line":23,"column":2},"end":{"line":23,"column":26}},"20":{"start":{"line":24,"column":2},"end":{"line":24,"column":25}},"21":{"start":{"line":25,"column":2},"end":{"line":25,"column":37}},"22":{"start":{"line":26,"column":2},"end":{"line":26,"column":39}},"23":{"start":{"line":27,"column":2},"end":{"line":30,"column":3}},"24":{"start":{"line":28,"column":4},"end":{"line":28,"column":63}},"25":{"start":{"line":29,"column":4},"end":{"line":29,"column":64}},"26":{"start":{"line":31,"column":2},"end":{"line":31,"column":83}},"27":{"start":{"line":32,"column":2},"end":{"line":32,"column":20}},"28":{"start":{"line":33,"column":2},"end":{"line":33,"column":19}},"29":{"start":{"line":34,"column":2},"end":{"line":34,"column":19}},"30":{"start":{"line":37,"column":0},"end":{"line":37,"column":39}},"31":{"start":{"line":39,"column":0},"end":{"line":39,"column":27}},"32":{"start":{"line":41,"column":0},"end":{"line":84,"column":2}},"33":{"start":{"line":42,"column":2},"end":{"line":42,"column":18}},"34":{"start":{"line":43,"column":2},"end":{"line":43,"column":38}},"35":{"start":{"line":44,"column":2},"end":{"line":67,"column":5}},"36":{"start":{"line":45,"column":4},"end":{"line":45,"column":27}},"37":{"start":{"line":46,"column":4},"end":{"line":66,"column":5}},"38":{"start":{"line":47,"column":6},"end":{"line":47,"column":64}},"39":{"start":{"line":48,"column":6},"end":{"line":48,"column":36}},"40":{"start":{"line":50,"column":6},"end":{"line":51,"column":61}},"41":{"start":{"line":53,"column":6},"end":{"line":54,"column":61}},"42":{"start":{"line":56,"column":6},"end":{"line":57,"column":63}},"43":{"start":{"line":59,"column":6},"end":{"line":61,"column":9}},"44":{"start":{"line":60,"column":8},"end":{"line":60,"column":52}},"45":{"start":{"line":63,"column":6},"end":{"line":63,"column":65}},"46":{"start":{"line":65,"column":6},"end":{"line":65,"column":41}},"47":{"start":{"line":69,"column":2},"end":{"line":74,"column":5}},"48":{"start":{"line":70,"column":4},"end":{"line":70,"column":44}},"49":{"start":{"line":71,"column":4},"end":{"line":73,"column":5}},"50":{"start":{"line":72,"column":6},"end":{"line":72,"column":35}},"51":{"start":{"line":76,"column":2},"end":{"line":79,"column":5}},"52":{"start":{"line":77,"column":4},"end":{"line":77,"column":68}},"53":{"start":{"line":78,"column":4},"end":{"line":78,"column":11}},"54":{"start":{"line":81,"column":2},"end":{"line":81,"column":41}},"55":{"start":{"line":82,"column":2},"end":{"line":82,"column":35}},"56":{"start":{"line":83,"column":2},"end":{"line":83,"column":23}},"57":{"start":{"line":86,"column":0},"end":{"line":86,"column":61}},"58":{"start":{"line":88,"column":0},"end":{"line":88,"column":61}},"59":{"start":{"line":90,"column":0},"end":{"line":93,"column":2}},"60":{"start":{"line":91,"column":2},"end":{"line":91,"column":22}},"61":{"start":{"line":92,"column":2},"end":{"line":92,"column":23}},"62":{"start":{"line":95,"column":0},"end":{"line":97,"column":2}},"63":{"start":{"line":96,"column":2},"end":{"line":96,"column":40}}},"branchMap":{"1":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":2},"end":{"line":19,"column":2}},{"start":{"line":19,"column":2},"end":{"line":19,"column":2}}]},"2":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":14},"end":{"line":24,"column":18}},{"start":{"line":24,"column":22},"end":{"line":24,"column":24}}]},"3":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":14},"end":{"line":25,"column":26}},{"start":{"line":25,"column":30},"end":{"line":25,"column":36}}]},"4":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":2},"end":{"line":27,"column":2}},{"start":{"line":27,"column":2},"end":{"line":27,"column":2}}]},"5":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":4},"end":{"line":46,"column":4}},{"start":{"line":46,"column":4},"end":{"line":46,"column":4}}]},"6":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":4},"end":{"line":71,"column":4}},{"start":{"line":71,"column":4},"end":{"line":71,"column":4}}]}},"code":["var net = require('net');","var util = require('util');","var dgram = require(\"dgram\");","var utils = require('../util/utils');","var Constants = require('../util/constants');","var UdpSocket = require('./udpsocket');","var Kick = require('./commands/kick');","var Handshake = require('./commands/handshake');","var Heartbeat = require('./commands/heartbeat');","var protocol = require('pomelo-protocol');","var Package = protocol.Package;","var Message = protocol.Message;","var coder = require('./common/coder');","var EventEmitter = require('events').EventEmitter;","","var curId = 1;","","var Connector = function(port, host, opts) {","  if (!(this instanceof Connector)) {","    return new Connector(port, host, opts);","  }","","  EventEmitter.call(this);","  this.opts = opts || {};","  this.type = opts.udpType || 'udp4';","  this.handshake = new Handshake(opts);","  if(!opts.heartbeat) {","    opts.heartbeat = Constants.TIME.DEFAULT_UDP_HEARTBEAT_TIME;","    opts.timeout = Constants.TIME.DEFAULT_UDP_HEARTBEAT_TIMEOUT;","  }","  this.heartbeat = new Heartbeat(utils.extends(opts, {disconnectOnTimeout: true}));","  this.clients = {};","  this.host = host;","  this.port = port;","};","","util.inherits(Connector, EventEmitter);","","module.exports = Connector;","","Connector.prototype.start = function(cb) {","  var self = this;","  this.tcpServer = net.createServer();","  this.socket = dgram.createSocket(this.type, function(msg, peer) {","    var key = genKey(peer);","    if(!self.clients[key]) {","      var udpsocket = new UdpSocket(curId++, self.socket, peer);","      self.clients[key] = udpsocket;","","      udpsocket.on('handshake',","      self.handshake.handle.bind(self.handshake, udpsocket));","","      udpsocket.on('heartbeat',","      self.heartbeat.handle.bind(self.heartbeat, udpsocket));","","      udpsocket.on('disconnect',","      self.heartbeat.clear.bind(self.heartbeat, udpsocket.id));","","      udpsocket.on('disconnect', function() {","        delete self.clients[genKey(udpsocket.peer)];","      });","","      udpsocket.on('closing', Kick.handle.bind(null, udpsocket));","","      self.emit('connection', udpsocket);","    }","  });","","  this.socket.on('message', function(data, peer) {","    var socket = self.clients[genKey(peer)];","    if(!!socket) {","      socket.emit('package', data);","    }","  });","","  this.socket.on('error', function(err) {","    logger.error('udp socket encounters with error: %j', err.stack);","    return;","  });","","  this.socket.bind(this.port, this.host);","  this.tcpServer.listen(this.port);","  process.nextTick(cb);","};","","Connector.decode = Connector.prototype.decode = coder.decode;","","Connector.encode = Connector.prototype.encode = coder.encode;","","Connector.prototype.stop = function(force, cb) {","  this.socket.close();","  process.nextTick(cb);","};","","var genKey = function(peer) {","  return peer.address + \":\" + peer.port;","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"16":1,"18":1,"19":0,"20":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"31":0,"32":0,"33":0,"34":0,"37":1,"39":1,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"50":0,"53":0,"56":0,"59":0,"60":0,"63":0,"65":0,"69":0,"70":0,"71":0,"72":0,"76":0,"77":0,"78":0,"81":0,"82":0,"83":0,"86":1,"88":1,"90":1,"91":0,"92":0,"95":1,"96":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/udpsocket.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/udpsocket.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":1,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":1,"41":0,"42":0,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":0,"59":0,"60":0,"61":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":13},"end":{"line":13,"column":40}}},"2":{"name":"(anonymous_2)","line":27,"loc":{"start":{"line":27,"column":21},"end":{"line":27,"column":35}}},"3":{"name":"(anonymous_3)","line":46,"loc":{"start":{"line":46,"column":24},"end":{"line":46,"column":38}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":27},"end":{"line":58,"column":41}}},"5":{"name":"(anonymous_5)","line":59,"loc":{"start":{"line":59,"column":60},"end":{"line":59,"column":81}}},"6":{"name":"(anonymous_6)","line":67,"loc":{"start":{"line":67,"column":29},"end":{"line":67,"column":43}}},"7":{"name":"(anonymous_7)","line":74,"loc":{"start":{"line":74,"column":37},"end":{"line":74,"column":52}}},"8":{"name":"(anonymous_8)","line":82,"loc":{"start":{"line":82,"column":29},"end":{"line":82,"column":44}}},"9":{"name":"(anonymous_9)","line":94,"loc":{"start":{"line":94,"column":30},"end":{"line":94,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":42}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":31}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":50}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":70}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":18}},"8":{"start":{"line":9,"column":0},"end":{"line":9,"column":20}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":19}},"10":{"start":{"line":11,"column":0},"end":{"line":11,"column":18}},"11":{"start":{"line":13,"column":0},"end":{"line":35,"column":2}},"12":{"start":{"line":14,"column":1},"end":{"line":14,"column":25}},"13":{"start":{"line":16,"column":2},"end":{"line":16,"column":15}},"14":{"start":{"line":17,"column":1},"end":{"line":17,"column":22}},"15":{"start":{"line":18,"column":2},"end":{"line":18,"column":19}},"16":{"start":{"line":19,"column":1},"end":{"line":19,"column":26}},"17":{"start":{"line":20,"column":1},"end":{"line":20,"column":23}},"18":{"start":{"line":21,"column":1},"end":{"line":24,"column":4}},"19":{"start":{"line":26,"column":2},"end":{"line":26,"column":18}},"20":{"start":{"line":27,"column":2},"end":{"line":32,"column":5}},"21":{"start":{"line":28,"column":4},"end":{"line":31,"column":5}},"22":{"start":{"line":29,"column":6},"end":{"line":29,"column":32}},"23":{"start":{"line":30,"column":6},"end":{"line":30,"column":25}},"24":{"start":{"line":34,"column":2},"end":{"line":34,"column":25}},"25":{"start":{"line":37,"column":0},"end":{"line":37,"column":36}},"26":{"start":{"line":39,"column":0},"end":{"line":39,"column":24}},"27":{"start":{"line":46,"column":0},"end":{"line":56,"column":2}},"28":{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},"29":{"start":{"line":48,"column":4},"end":{"line":48,"column":11}},"30":{"start":{"line":50,"column":2},"end":{"line":54,"column":3}},"31":{"start":{"line":51,"column":4},"end":{"line":51,"column":26}},"32":{"start":{"line":52,"column":9},"end":{"line":54,"column":3}},"33":{"start":{"line":53,"column":4},"end":{"line":53,"column":42}},"34":{"start":{"line":55,"column":2},"end":{"line":55,"column":55}},"35":{"start":{"line":58,"column":0},"end":{"line":65,"column":2}},"36":{"start":{"line":59,"column":1},"end":{"line":64,"column":5}},"37":{"start":{"line":60,"column":4},"end":{"line":63,"column":5}},"38":{"start":{"line":61,"column":6},"end":{"line":61,"column":65}},"39":{"start":{"line":62,"column":6},"end":{"line":62,"column":13}},"40":{"start":{"line":67,"column":0},"end":{"line":72,"column":2}},"41":{"start":{"line":68,"column":2},"end":{"line":70,"column":3}},"42":{"start":{"line":69,"column":4},"end":{"line":69,"column":11}},"43":{"start":{"line":71,"column":2},"end":{"line":71,"column":20}},"44":{"start":{"line":74,"column":0},"end":{"line":80,"column":2}},"45":{"start":{"line":75,"column":2},"end":{"line":77,"column":3}},"46":{"start":{"line":76,"column":4},"end":{"line":76,"column":11}},"47":{"start":{"line":78,"column":2},"end":{"line":78,"column":21}},"48":{"start":{"line":79,"column":2},"end":{"line":79,"column":27}},"49":{"start":{"line":82,"column":0},"end":{"line":92,"column":2}},"50":{"start":{"line":83,"column":2},"end":{"line":85,"column":3}},"51":{"start":{"line":84,"column":4},"end":{"line":84,"column":11}},"52":{"start":{"line":86,"column":2},"end":{"line":86,"column":14}},"53":{"start":{"line":87,"column":2},"end":{"line":90,"column":3}},"54":{"start":{"line":88,"column":4},"end":{"line":88,"column":57}},"55":{"start":{"line":89,"column":4},"end":{"line":89,"column":17}},"56":{"start":{"line":91,"column":2},"end":{"line":91,"column":34}},"57":{"start":{"line":94,"column":0},"end":{"line":100,"column":2}},"58":{"start":{"line":95,"column":2},"end":{"line":97,"column":3}},"59":{"start":{"line":96,"column":4},"end":{"line":96,"column":11}},"60":{"start":{"line":98,"column":2},"end":{"line":98,"column":25}},"61":{"start":{"line":99,"column":2},"end":{"line":99,"column":61}}},"branchMap":{"1":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":28,"column":4}},{"start":{"line":28,"column":4},"end":{"line":28,"column":4}}]},"2":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":47,"column":2}},{"start":{"line":47,"column":2},"end":{"line":47,"column":2}}]},"3":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":50,"column":2}},{"start":{"line":50,"column":2},"end":{"line":50,"column":2}}]},"4":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":9},"end":{"line":52,"column":9}},{"start":{"line":52,"column":9},"end":{"line":52,"column":9}}]},"5":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":4},"end":{"line":60,"column":4}},{"start":{"line":60,"column":4},"end":{"line":60,"column":4}}]},"6":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":2},"end":{"line":68,"column":2}},{"start":{"line":68,"column":2},"end":{"line":68,"column":2}}]},"7":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":2},"end":{"line":75,"column":2}},{"start":{"line":75,"column":2},"end":{"line":75,"column":2}}]},"8":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":2},"end":{"line":83,"column":2}},{"start":{"line":83,"column":2},"end":{"line":83,"column":2}}]},"9":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":2},"end":{"line":95,"column":2}},{"start":{"line":95,"column":2},"end":{"line":95,"column":2}}]}},"code":["var util = require('util');","var handler = require('./common/handler');","var protocol = require('pomelo-protocol');","var Package = protocol.Package;","var EventEmitter = require('events').EventEmitter;","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","var ST_INITED = 0;","var ST_WAIT_ACK = 1;","var ST_WORKING = 2;","var ST_CLOSED = 3;","","var Socket = function(id, socket, peer) {","\tEventEmitter.call(this);","\t","  this.id = id;","\tthis.socket = socket;","  this.peer = peer;","\tthis.host = peer.address;","\tthis.port = peer.port;","\tthis.remoteAddress = {","    ip: this.host,","    port: this.port","  };","","  var self = this;","  this.on('package', function(pkg) {","    if(!!pkg) {","      pkg = Package.decode(pkg);","      handler(self, pkg);","    }","  });","","  this.state = ST_INITED;","};","","util.inherits(Socket, EventEmitter);","","module.exports = Socket;","","/**"," * Send byte data package to client."," *"," * @param  {Buffer} msg byte data"," */","Socket.prototype.send = function(msg) {","  if(this.state !== ST_WORKING) {","    return;","  }","  if(msg instanceof String) {","    msg = new Buffer(msg);","  } else if(!(msg instanceof Buffer)) {","    msg = new Buffer(JSON.stringify(msg));","  }","  this.sendRaw(Package.encode(Package.TYPE_DATA, msg));","};","","Socket.prototype.sendRaw = function(msg) {","\tthis.socket.send(msg, 0, msg.length, this.port, this.host, function(err, bytes) {","    if(!!err)\t{","      logger.error('send msg to remote with err: %j', err.stack);","      return;","    }","  });","};","","Socket.prototype.sendForce = function(msg) {","  if(this.state === ST_CLOSED) {","    return;","  }","  this.sendRaw(msg);","};","","Socket.prototype.handshakeResponse = function(resp) {","  if(this.state !== ST_INITED) {","    return;","  }","  this.sendRaw(resp);","  this.state = ST_WAIT_ACK;","};","","Socket.prototype.sendBatch = function(msgs) {","  if(this.state !== ST_WORKING) {","    return;","  }","  var rs = [];","  for(var i=0; i<msgs.length; i++) {","    var src = Package.encode(Package.TYPE_DATA, msgs[i]);","    rs.push(src);","  }","  this.sendRaw(Buffer.concat(rs));","};","","Socket.prototype.disconnect = function() {","  if(this.state === ST_CLOSED) {","    return;","  }","  this.state = ST_CLOSED;","  this.emit('disconnect', 'the connection is disconnected.');","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"9":1,"10":1,"11":1,"13":1,"14":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"26":0,"27":0,"28":0,"29":0,"30":0,"34":0,"37":1,"39":1,"46":1,"47":0,"48":0,"50":0,"51":0,"52":0,"53":0,"55":0,"58":1,"59":0,"60":0,"61":0,"62":0,"67":1,"68":0,"69":0,"71":0,"74":1,"75":0,"76":0,"78":0,"79":0,"82":1,"83":0,"84":0,"86":0,"87":0,"88":0,"89":0,"91":0,"94":1,"95":0,"96":0,"98":0,"99":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqttconnector.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqttconnector.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":1,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1,"41":0,"42":0,"43":1,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":1,"51":0,"52":0,"53":0,"54":1,"55":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":15,"loc":{"start":{"line":15,"column":16},"end":{"line":15,"column":43}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":28},"end":{"line":33,"column":41}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":31},"end":{"line":36,"column":48}}},"4":{"name":"(anonymous_4)","line":37,"loc":{"start":{"line":37,"column":21},"end":{"line":37,"column":35}}},"5":{"name":"(anonymous_5)","line":41,"loc":{"start":{"line":41,"column":23},"end":{"line":41,"column":34}}},"6":{"name":"(anonymous_6)","line":45,"loc":{"start":{"line":45,"column":28},"end":{"line":45,"column":45}}},"7":{"name":"(anonymous_7)","line":51,"loc":{"start":{"line":51,"column":39},"end":{"line":51,"column":50}}},"8":{"name":"(anonymous_8)","line":56,"loc":{"start":{"line":56,"column":25},"end":{"line":56,"column":42}}},"9":{"name":"(anonymous_9)","line":68,"loc":{"start":{"line":68,"column":27},"end":{"line":68,"column":38}}},"10":{"name":"(anonymous_10)","line":73,"loc":{"start":{"line":73,"column":22},"end":{"line":73,"column":54}}},"11":{"name":"(anonymous_11)","line":80,"loc":{"start":{"line":80,"column":18},"end":{"line":80,"column":43}}},"12":{"name":"(anonymous_12)","line":89,"loc":{"start":{"line":89,"column":29},"end":{"line":89,"column":61}}},"13":{"name":"(anonymous_13)","line":97,"loc":{"start":{"line":97,"column":28},"end":{"line":97,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":41}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":44}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":42}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":70}},"9":{"start":{"line":10,"column":0},"end":{"line":10,"column":14}},"10":{"start":{"line":15,"column":0},"end":{"line":26,"column":2}},"11":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"12":{"start":{"line":17,"column":4},"end":{"line":17,"column":43}},"13":{"start":{"line":20,"column":2},"end":{"line":20,"column":26}},"14":{"start":{"line":21,"column":2},"end":{"line":21,"column":19}},"15":{"start":{"line":22,"column":2},"end":{"line":22,"column":19}},"16":{"start":{"line":23,"column":2},"end":{"line":23,"column":25}},"17":{"start":{"line":25,"column":2},"end":{"line":25,"column":40}},"18":{"start":{"line":27,"column":0},"end":{"line":27,"column":39}},"19":{"start":{"line":29,"column":0},"end":{"line":29,"column":27}},"20":{"start":{"line":33,"column":0},"end":{"line":66,"column":2}},"21":{"start":{"line":34,"column":2},"end":{"line":34,"column":18}},"22":{"start":{"line":35,"column":2},"end":{"line":35,"column":40}},"23":{"start":{"line":36,"column":2},"end":{"line":61,"column":5}},"24":{"start":{"line":37,"column":2},"end":{"line":39,"column":5}},"25":{"start":{"line":38,"column":3},"end":{"line":38,"column":27}},"26":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"27":{"start":{"line":42,"column":3},"end":{"line":42,"column":27}},"28":{"start":{"line":45,"column":4},"end":{"line":47,"column":5}},"29":{"start":{"line":46,"column":3},"end":{"line":46,"column":27}},"30":{"start":{"line":49,"column":4},"end":{"line":54,"column":5}},"31":{"start":{"line":50,"column":6},"end":{"line":50,"column":94}},"32":{"start":{"line":51,"column":6},"end":{"line":53,"column":9}},"33":{"start":{"line":52,"column":8},"end":{"line":52,"column":29}},"34":{"start":{"line":56,"column":4},"end":{"line":60,"column":7}},"35":{"start":{"line":57,"column":6},"end":{"line":57,"column":38}},"36":{"start":{"line":58,"column":6},"end":{"line":58,"column":69}},"37":{"start":{"line":59,"column":6},"end":{"line":59,"column":42}},"38":{"start":{"line":63,"column":2},"end":{"line":63,"column":36}},"39":{"start":{"line":65,"column":2},"end":{"line":65,"column":23}},"40":{"start":{"line":68,"column":0},"end":{"line":71,"column":2}},"41":{"start":{"line":69,"column":1},"end":{"line":69,"column":25}},"42":{"start":{"line":70,"column":1},"end":{"line":70,"column":17}},"43":{"start":{"line":73,"column":0},"end":{"line":78,"column":2}},"44":{"start":{"line":74,"column":2},"end":{"line":77,"column":4}},"45":{"start":{"line":80,"column":0},"end":{"line":87,"column":2}},"46":{"start":{"line":81,"column":2},"end":{"line":81,"column":38}},"47":{"start":{"line":82,"column":2},"end":{"line":84,"column":3}},"48":{"start":{"line":83,"column":4},"end":{"line":83,"column":62}},"49":{"start":{"line":86,"column":2},"end":{"line":86,"column":13}},"50":{"start":{"line":89,"column":0},"end":{"line":95,"column":2}},"51":{"start":{"line":90,"column":1},"end":{"line":94,"column":2}},"52":{"start":{"line":91,"column":2},"end":{"line":91,"column":48}},"53":{"start":{"line":93,"column":2},"end":{"line":93,"column":37}},"54":{"start":{"line":97,"column":0},"end":{"line":99,"column":2}},"55":{"start":{"line":98,"column":2},"end":{"line":98,"column":26}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":16,"column":2}},{"start":{"line":16,"column":2},"end":{"line":16,"column":2}}]},"2":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":14},"end":{"line":23,"column":18}},{"start":{"line":23,"column":22},"end":{"line":23,"column":24}}]},"3":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":49,"column":4}},{"start":{"line":49,"column":4},"end":{"line":49,"column":4}}]},"4":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":20},"end":{"line":50,"column":44}},{"start":{"line":50,"column":48},"end":{"line":50,"column":93}}]},"5":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":2},"end":{"line":82,"column":2}},{"start":{"line":82,"column":2},"end":{"line":82,"column":2}}]},"6":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},{"start":{"line":90,"column":1},"end":{"line":90,"column":1}}]}},"code":["var util = require('util');","var EventEmitter = require('events').EventEmitter;","var mqtt = require('mqtt');","var constants = require('../util/constants');","var MQTTSocket = require('./mqttsocket');","var Adaptor = require('./mqtt/mqttadaptor');","var generate = require('./mqtt/generate');","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","","var curId = 1;","/**"," * Connector that manager low level connection and protocol bewteen server and client."," * Develper can provide their own connector to switch the low level prototol, such as tcp or probuf."," */","var Connector = function(port, host, opts) {","  if (!(this instanceof Connector)) {","    return new Connector(port, host, opts);","  }","","  EventEmitter.call(this);","  this.port = port;","  this.host = host;","  this.opts = opts || {};","","  this.adaptor = new Adaptor(this.opts);","};","util.inherits(Connector, EventEmitter);","","module.exports = Connector;","/**"," * Start connector to listen the specified port"," */","Connector.prototype.start = function(cb) {","  var self = this;","  this.mqttServer = mqtt.createServer();","  this.mqttServer.on('client', function(client) {","\t\tclient.on('error', function(err) {","\t\t\tclient.stream.destroy();","\t\t});","\t\t","    client.on('close', function() {","\t\t\tclient.stream.destroy();","\t\t});","\t\t","    client.on('disconnect', function(packet) {","\t\t\tclient.stream.destroy();","\t\t});","    ","    if(self.opts.disconnectOnTimeout) {","      var timeout = self.opts.timeout * 1000 || constants.TIME.DEFAULT_MQTT_HEARTBEAT_TIMEOUT;","      client.stream.setTimeout(timeout,function() {","        client.emit('close');","      });","    }","    ","    client.on('connect', function(packet) {","      client.connack({returnCode: 0});","      var mqttsocket = new MQTTSocket(curId++, client, self.adaptor);","      self.emit('connection', mqttsocket);","    });","  });","","  this.mqttServer.listen(this.port);","","  process.nextTick(cb);","};","","Connector.prototype.stop = function() {","\tthis.mqttServer.close();","\tprocess.exit(0);","};","","var composeResponse = function(msgId, route, msgBody) {","  return {","    id: msgId,","    body: msgBody","  };","};","","var composePush = function(route, msgBody) {","  var msg = generate.publish(msgBody);","  if(!msg) {","    logger.error('invalid mqtt publish message: %j', msgBody);","  }","","  return msg;","};","","Connector.prototype.encode = function(reqId, route, msgBody) {","\tif (!!reqId) {","\t\treturn composeResponse(reqId, route, msgBody);","\t} else {","\t\treturn composePush(route, msgBody);","\t}","};","","Connector.prototype.close = function() {","  this.mqttServer.close();","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"10":1,"15":1,"16":0,"17":0,"20":0,"21":0,"22":0,"23":0,"25":0,"27":1,"29":1,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"41":0,"42":0,"45":0,"46":0,"49":0,"50":0,"51":0,"52":0,"56":0,"57":0,"58":0,"59":0,"63":0,"65":0,"68":1,"69":0,"70":0,"73":1,"74":0,"80":1,"81":0,"82":0,"83":0,"86":0,"89":1,"90":0,"91":0,"93":0,"97":1,"98":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqttsocket.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqttsocket.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":13},"end":{"line":10,"column":43}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":23},"end":{"line":26,"column":40}}},"3":{"name":"(anonymous_3)","line":43,"loc":{"start":{"line":43,"column":24},"end":{"line":43,"column":38}}},"4":{"name":"(anonymous_4)","line":55,"loc":{"start":{"line":55,"column":29},"end":{"line":55,"column":44}}},"5":{"name":"(anonymous_5)","line":61,"loc":{"start":{"line":61,"column":30},"end":{"line":61,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":50}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":18}},"4":{"start":{"line":5,"column":0},"end":{"line":5,"column":18}},"5":{"start":{"line":10,"column":0},"end":{"line":37,"column":2}},"6":{"start":{"line":11,"column":2},"end":{"line":11,"column":26}},"7":{"start":{"line":12,"column":2},"end":{"line":12,"column":15}},"8":{"start":{"line":13,"column":2},"end":{"line":13,"column":23}},"9":{"start":{"line":14,"column":2},"end":{"line":17,"column":4}},"10":{"start":{"line":18,"column":2},"end":{"line":18,"column":25}},"11":{"start":{"line":20,"column":2},"end":{"line":20,"column":18}},"12":{"start":{"line":22,"column":2},"end":{"line":22,"column":57}},"13":{"start":{"line":23,"column":2},"end":{"line":23,"column":57}},"14":{"start":{"line":24,"column":2},"end":{"line":24,"column":62}},"15":{"start":{"line":26,"column":2},"end":{"line":28,"column":5}},"16":{"start":{"line":27,"column":4},"end":{"line":27,"column":22}},"17":{"start":{"line":30,"column":2},"end":{"line":30,"column":76}},"18":{"start":{"line":32,"column":2},"end":{"line":32,"column":72}},"19":{"start":{"line":34,"column":2},"end":{"line":34,"column":25}},"20":{"start":{"line":39,"column":0},"end":{"line":39,"column":36}},"21":{"start":{"line":41,"column":0},"end":{"line":41,"column":24}},"22":{"start":{"line":43,"column":0},"end":{"line":53,"column":2}},"23":{"start":{"line":44,"column":2},"end":{"line":46,"column":3}},"24":{"start":{"line":45,"column":4},"end":{"line":45,"column":11}},"25":{"start":{"line":47,"column":2},"end":{"line":52,"column":3}},"26":{"start":{"line":49,"column":4},"end":{"line":49,"column":34}},"27":{"start":{"line":51,"column":4},"end":{"line":51,"column":36}},"28":{"start":{"line":55,"column":0},"end":{"line":59,"column":2}},"29":{"start":{"line":56,"column":2},"end":{"line":58,"column":3}},"30":{"start":{"line":57,"column":4},"end":{"line":57,"column":23}},"31":{"start":{"line":61,"column":0},"end":{"line":68,"column":2}},"32":{"start":{"line":62,"column":2},"end":{"line":64,"column":3}},"33":{"start":{"line":63,"column":4},"end":{"line":63,"column":11}},"34":{"start":{"line":66,"column":2},"end":{"line":66,"column":25}},"35":{"start":{"line":67,"column":2},"end":{"line":67,"column":31}}},"branchMap":{"1":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":2},"end":{"line":44,"column":2}},{"start":{"line":44,"column":2},"end":{"line":44,"column":2}}]},"2":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":47,"column":2}},{"start":{"line":47,"column":2},"end":{"line":47,"column":2}}]},"3":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":2},"end":{"line":62,"column":2}},{"start":{"line":62,"column":2},"end":{"line":62,"column":2}}]}},"code":["var util = require('util');","var EventEmitter = require('events').EventEmitter;","","var ST_INITED = 1;","var ST_CLOSED = 2;","","/**"," * Socket class that wraps socket and websocket to provide unified interface for up level."," */","var Socket = function(id, socket, adaptor) {","  EventEmitter.call(this);","  this.id = id;","  this.socket = socket;","  this.remoteAddress = {","    ip: socket.stream.remoteAddress,","    port: socket.stream.remotePort","  };","  this.adaptor = adaptor;","","  var self = this;","","  socket.on('close', this.emit.bind(this, 'disconnect'));","  socket.on('error', this.emit.bind(this, 'disconnect'));","  socket.on('disconnect', this.emit.bind(this, 'disconnect'));","","  socket.on('pingreq', function(packet) {","    socket.pingresp();","  });","","  socket.on('subscribe', this.adaptor.onSubscribe.bind(this.adaptor, this));","","  socket.on('publish', this.adaptor.onPublish.bind(this.adaptor, this));","","  this.state = ST_INITED;","","  // TODO: any other events?","};","","util.inherits(Socket, EventEmitter);","","module.exports = Socket;","","Socket.prototype.send = function(msg) {","  if(this.state !== ST_INITED) {","    return;","  }","  if(msg instanceof Buffer) {","    // if encoded, send directly","    this.socket.stream.write(msg);","  } else {","    this.adaptor.publish(this, msg);","  }","};","","Socket.prototype.sendBatch = function(msgs) {","  for(var i = 0, l = msgs.length; i<l; i++) {","    this.send(msgs[i]);","  }","};","","Socket.prototype.disconnect = function() {","  if(this.state === ST_CLOSED) {","    return;","  }","","  this.state = ST_CLOSED;","  this.socket.stream.destroy();","};"],"l":{"1":1,"2":1,"4":1,"5":1,"10":1,"11":0,"12":0,"13":0,"14":0,"18":0,"20":0,"22":0,"23":0,"24":0,"26":0,"27":0,"30":0,"32":0,"34":0,"39":1,"41":1,"43":1,"44":0,"45":0,"47":0,"49":0,"51":0,"55":1,"56":0,"57":0,"61":1,"62":0,"63":0,"66":0,"67":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqtt/mqttadaptor.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqtt/mqttadaptor.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":14},"end":{"line":1,"column":29}}},"2":{"name":"(anonymous_2)","line":10,"loc":{"start":{"line":10,"column":30},"end":{"line":10,"column":55}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":32},"end":{"line":35,"column":57}}},"4":{"name":"(anonymous_4)","line":55,"loc":{"start":{"line":55,"column":29},"end":{"line":55,"column":54}}},"5":{"name":"(anonymous_5)","line":81,"loc":{"start":{"line":81,"column":28},"end":{"line":81,"column":53}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":6,"column":2}},"2":{"start":{"line":2,"column":2},"end":{"line":2,"column":20}},"3":{"start":{"line":3,"column":2},"end":{"line":3,"column":20}},"4":{"start":{"line":4,"column":2},"end":{"line":4,"column":40}},"5":{"start":{"line":5,"column":2},"end":{"line":5,"column":44}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":25}},"7":{"start":{"line":10,"column":0},"end":{"line":33,"column":2}},"8":{"start":{"line":11,"column":2},"end":{"line":11,"column":32}},"9":{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},"10":{"start":{"line":14,"column":4},"end":{"line":14,"column":50}},"11":{"start":{"line":17,"column":2},"end":{"line":17,"column":31}},"12":{"start":{"line":18,"column":2},"end":{"line":20,"column":3}},"13":{"start":{"line":19,"column":4},"end":{"line":19,"column":39}},"14":{"start":{"line":22,"column":2},"end":{"line":26,"column":4}},"15":{"start":{"line":28,"column":2},"end":{"line":28,"column":30}},"16":{"start":{"line":30,"column":2},"end":{"line":32,"column":3}},"17":{"start":{"line":31,"column":4},"end":{"line":31,"column":56}},"18":{"start":{"line":35,"column":0},"end":{"line":53,"column":2}},"19":{"start":{"line":36,"column":2},"end":{"line":36,"column":34}},"20":{"start":{"line":38,"column":2},"end":{"line":40,"column":3}},"21":{"start":{"line":39,"column":4},"end":{"line":39,"column":52}},"22":{"start":{"line":42,"column":2},"end":{"line":48,"column":4}},"23":{"start":{"line":50,"column":2},"end":{"line":50,"column":42}},"24":{"start":{"line":52,"column":2},"end":{"line":52,"column":30}},"25":{"start":{"line":55,"column":0},"end":{"line":67,"column":2}},"26":{"start":{"line":56,"column":2},"end":{"line":62,"column":4}},"27":{"start":{"line":64,"column":2},"end":{"line":64,"column":42}},"28":{"start":{"line":66,"column":2},"end":{"line":66,"column":30}},"29":{"start":{"line":81,"column":0},"end":{"line":92,"column":2}},"30":{"start":{"line":82,"column":2},"end":{"line":82,"column":22}},"31":{"start":{"line":83,"column":2},"end":{"line":83,"column":33}},"32":{"start":{"line":84,"column":2},"end":{"line":89,"column":3}},"33":{"start":{"line":86,"column":4},"end":{"line":86,"column":65}},"34":{"start":{"line":87,"column":4},"end":{"line":87,"column":29}},"35":{"start":{"line":88,"column":4},"end":{"line":88,"column":11}},"36":{"start":{"line":91,"column":2},"end":{"line":91,"column":37}}},"branchMap":{"1":{"line":2,"type":"binary-expr","locations":[{"start":{"line":2,"column":9},"end":{"line":2,"column":13}},{"start":{"line":2,"column":17},"end":{"line":2,"column":19}}]},"2":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":2},"end":{"line":13,"column":2}},{"start":{"line":13,"column":2},"end":{"line":13,"column":2}}]},"3":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":2},"end":{"line":18,"column":2}},{"start":{"line":18,"column":2},"end":{"line":18,"column":2}}]},"4":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":2},"end":{"line":30,"column":2}},{"start":{"line":30,"column":2},"end":{"line":30,"column":2}}]},"5":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":2},"end":{"line":38,"column":2}},{"start":{"line":38,"column":2},"end":{"line":38,"column":2}}]},"6":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":2},"end":{"line":84,"column":2}},{"start":{"line":84,"column":2},"end":{"line":84,"column":2}}]}},"code":["var Adaptor = function(opts) {","  opts = opts || {};","  this.subReqs = {};","  this.publishRoute = opts.publishRoute;","  this.subscribeRoute = opts.subscribeRoute;","};","","module.exports = Adaptor;","","Adaptor.prototype.onPublish = function(client, packet) {","  var route = this.publishRoute;","","  if(!route) {","    throw new Error('unspecified publish route.');","  }","","  var payload = packet.payload;","  if(payload instanceof Buffer) {","    payload = payload.toString('utf8');","  }","","  var req = {","    id: packet.messageId,","    route: route,","    body: packet","  };","","  client.emit('message', req);","","  if(packet.qos === 1) {","    client.socket.puback({messageId: packet.messageId});","  }","};","","Adaptor.prototype.onSubscribe = function(client, packet) {","  var route = this.subscribeRoute;","","  if(!route) {","    throw new Error('unspecified subscribe route.');","  }","","  var req = {","    id: packet.messageId,","    route: route,","    body: {","      subscriptions: packet.subscriptions","    }","  };","","  this.subReqs[packet.messageId] = packet;","","  client.emit('message', req);","};","","Adaptor.prototype.onPubAck = function(client, packet) {","  var req = {","    id: packet.messageId,","    route: 'connector.mqttHandler.pubAck',","    body: {","      mid: packet.messageId","    }","  };","","  this.subReqs[packet.messageId] = packet;","","  client.emit('message', req);","};","","/**"," * Publish message or subscription ack."," *"," * if packet.id exist and this.subReqs[packet.id] exist then packet is a suback."," * Subscription is request/response mode."," * packet.id is pass from client in packet.messageId and record in Pomelo context and attached to the subscribe response packet."," * packet.body is the context that returned by subscribe next callback."," *"," * if packet.id not exist then packet is a publish message."," *"," * otherwise packet is a illegal packet."," */","Adaptor.prototype.publish = function(client, packet) {","  var mid = packet.id;","  var subreq = this.subReqs[mid];","  if(subreq) {","    // is suback","    client.socket.suback({messageId: mid, granted: packet.body});","    delete this.subReqs[mid];","    return;","  }","","  client.socket.publish(packet.body);","};",""],"l":{"1":1,"2":0,"3":0,"4":0,"5":0,"8":1,"10":1,"11":0,"13":0,"14":0,"17":0,"18":0,"19":0,"22":0,"28":0,"30":0,"31":0,"35":1,"36":0,"38":0,"39":0,"42":0,"50":0,"52":0,"55":1,"56":0,"64":0,"66":0,"81":1,"82":0,"83":0,"84":0,"86":0,"87":0,"88":0,"91":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqtt/generate.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqtt/generate.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":1,"80":0,"81":0,"82":1,"83":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0,0],"13":[0,0],"14":[0,0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":25},"end":{"line":9,"column":40}}},"2":{"name":"(anonymous_2)","line":48,"loc":{"start":{"line":48,"column":17},"end":{"line":48,"column":34}}},"3":{"name":"(anonymous_3)","line":67,"loc":{"start":{"line":67,"column":17},"end":{"line":67,"column":47}}},"4":{"name":"(anonymous_4)","line":98,"loc":{"start":{"line":98,"column":17},"end":{"line":98,"column":31}}},"5":{"name":"(anonymous_5)","line":103,"loc":{"start":{"line":103,"column":14},"end":{"line":103,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":31}},"3":{"start":{"line":9,"column":0},"end":{"line":45,"column":2}},"4":{"start":{"line":10,"column":2},"end":{"line":10,"column":20}},"5":{"start":{"line":11,"column":2},"end":{"line":11,"column":45}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":26}},"7":{"start":{"line":13,"column":2},"end":{"line":13,"column":54}},"8":{"start":{"line":14,"column":2},"end":{"line":14,"column":25}},"9":{"start":{"line":15,"column":2},"end":{"line":15,"column":46}},"10":{"start":{"line":16,"column":2},"end":{"line":16,"column":80}},"11":{"start":{"line":17,"column":2},"end":{"line":17,"column":40}},"12":{"start":{"line":20,"column":2},"end":{"line":20,"column":66}},"13":{"start":{"line":20,"column":54},"end":{"line":20,"column":66}},"14":{"start":{"line":22,"column":2},"end":{"line":24,"column":3}},"15":{"start":{"line":23,"column":4},"end":{"line":23,"column":34}},"16":{"start":{"line":26,"column":2},"end":{"line":26,"column":45}},"17":{"start":{"line":26,"column":33},"end":{"line":26,"column":45}},"18":{"start":{"line":27,"column":2},"end":{"line":27,"column":65}},"19":{"start":{"line":27,"column":53},"end":{"line":27,"column":65}},"20":{"start":{"line":28,"column":2},"end":{"line":28,"column":67}},"21":{"start":{"line":28,"column":55},"end":{"line":28,"column":67}},"22":{"start":{"line":31,"column":2},"end":{"line":31,"column":106}},"23":{"start":{"line":34,"column":2},"end":{"line":34,"column":60}},"24":{"start":{"line":37,"column":2},"end":{"line":37,"column":70}},"25":{"start":{"line":37,"column":15},"end":{"line":37,"column":70}},"26":{"start":{"line":40,"column":2},"end":{"line":42,"column":31}},"27":{"start":{"line":44,"column":2},"end":{"line":44,"column":39}},"28":{"start":{"line":48,"column":0},"end":{"line":65,"column":2}},"29":{"start":{"line":49,"column":2},"end":{"line":49,"column":45}},"30":{"start":{"line":49,"column":33},"end":{"line":49,"column":45}},"31":{"start":{"line":50,"column":2},"end":{"line":50,"column":29}},"32":{"start":{"line":50,"column":17},"end":{"line":50,"column":29}},"33":{"start":{"line":52,"column":2},"end":{"line":52,"column":15}},"34":{"start":{"line":53,"column":2},"end":{"line":53,"column":16}},"35":{"start":{"line":55,"column":2},"end":{"line":62,"column":23}},"36":{"start":{"line":56,"column":4},"end":{"line":56,"column":29}},"37":{"start":{"line":57,"column":4},"end":{"line":57,"column":30}},"38":{"start":{"line":58,"column":4},"end":{"line":60,"column":5}},"39":{"start":{"line":59,"column":8},"end":{"line":59,"column":29}},"40":{"start":{"line":61,"column":4},"end":{"line":61,"column":20}},"41":{"start":{"line":64,"column":2},"end":{"line":64,"column":13}},"42":{"start":{"line":67,"column":0},"end":{"line":96,"column":2}},"43":{"start":{"line":68,"column":2},"end":{"line":68,"column":50}},"44":{"start":{"line":68,"column":27},"end":{"line":68,"column":50}},"45":{"start":{"line":69,"column":2},"end":{"line":69,"column":42}},"46":{"start":{"line":69,"column":30},"end":{"line":69,"column":42}},"47":{"start":{"line":70,"column":2},"end":{"line":70,"column":54}},"48":{"start":{"line":70,"column":42},"end":{"line":70,"column":54}},"49":{"start":{"line":72,"column":2},"end":{"line":72,"column":18}},"50":{"start":{"line":73,"column":2},"end":{"line":73,"column":17}},"51":{"start":{"line":74,"column":2},"end":{"line":94,"column":3}},"52":{"start":{"line":75,"column":4},"end":{"line":75,"column":33}},"53":{"start":{"line":76,"column":4},"end":{"line":93,"column":5}},"54":{"start":{"line":77,"column":6},"end":{"line":77,"column":24}},"55":{"start":{"line":77,"column":46},"end":{"line":77,"column":55}},"56":{"start":{"line":79,"column":11},"end":{"line":93,"column":5}},"57":{"start":{"line":80,"column":6},"end":{"line":80,"column":43}},"58":{"start":{"line":80,"column":44},"end":{"line":80,"column":53}},"59":{"start":{"line":81,"column":6},"end":{"line":81,"column":43}},"60":{"start":{"line":81,"column":44},"end":{"line":81,"column":53}},"61":{"start":{"line":82,"column":11},"end":{"line":93,"column":5}},"62":{"start":{"line":83,"column":6},"end":{"line":83,"column":43}},"63":{"start":{"line":83,"column":44},"end":{"line":83,"column":53}},"64":{"start":{"line":84,"column":6},"end":{"line":84,"column":45}},"65":{"start":{"line":84,"column":46},"end":{"line":84,"column":55}},"66":{"start":{"line":85,"column":6},"end":{"line":85,"column":43}},"67":{"start":{"line":85,"column":44},"end":{"line":85,"column":53}},"68":{"start":{"line":86,"column":11},"end":{"line":93,"column":5}},"69":{"start":{"line":87,"column":6},"end":{"line":87,"column":43}},"70":{"start":{"line":87,"column":44},"end":{"line":87,"column":53}},"71":{"start":{"line":88,"column":6},"end":{"line":88,"column":45}},"72":{"start":{"line":88,"column":46},"end":{"line":88,"column":55}},"73":{"start":{"line":89,"column":6},"end":{"line":89,"column":45}},"74":{"start":{"line":89,"column":46},"end":{"line":89,"column":55}},"75":{"start":{"line":90,"column":6},"end":{"line":90,"column":43}},"76":{"start":{"line":90,"column":44},"end":{"line":90,"column":53}},"77":{"start":{"line":92,"column":6},"end":{"line":92,"column":66}},"78":{"start":{"line":95,"column":2},"end":{"line":95,"column":69}},"79":{"start":{"line":98,"column":0},"end":{"line":101,"column":2}},"80":{"start":{"line":99,"column":2},"end":{"line":99,"column":40}},"81":{"start":{"line":100,"column":2},"end":{"line":100,"column":16}},"82":{"start":{"line":103,"column":0},"end":{"line":103,"column":72}},"83":{"start":{"line":103,"column":27},"end":{"line":103,"column":69}}},"branchMap":{"1":{"line":10,"type":"binary-expr","locations":[{"start":{"line":10,"column":9},"end":{"line":10,"column":13}},{"start":{"line":10,"column":17},"end":{"line":10,"column":19}}]},"2":{"line":11,"type":"cond-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":40}},{"start":{"line":11,"column":43},"end":{"line":11,"column":44}}]},"3":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":20}},{"start":{"line":12,"column":24},"end":{"line":12,"column":25}}]},"4":{"line":13,"type":"cond-expr","locations":[{"start":{"line":13,"column":29},"end":{"line":13,"column":49}},{"start":{"line":13,"column":52},"end":{"line":13,"column":53}}]},"5":{"line":15,"type":"binary-expr","locations":[{"start":{"line":15,"column":16},"end":{"line":15,"column":28}},{"start":{"line":15,"column":32},"end":{"line":15,"column":45}}]},"6":{"line":16,"type":"cond-expr","locations":[{"start":{"line":16,"column":53},"end":{"line":16,"column":62}},{"start":{"line":16,"column":65},"end":{"line":16,"column":79}}]},"7":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":20,"column":2}},{"start":{"line":20,"column":2},"end":{"line":20,"column":2}}]},"8":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":6},"end":{"line":20,"column":31}},{"start":{"line":20,"column":35},"end":{"line":20,"column":52}}]},"9":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":2},"end":{"line":22,"column":2}},{"start":{"line":22,"column":2},"end":{"line":22,"column":2}}]},"10":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":26,"column":2}},{"start":{"line":26,"column":2},"end":{"line":26,"column":2}}]},"11":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":2},"end":{"line":27,"column":2}},{"start":{"line":27,"column":2},"end":{"line":27,"column":2}}]},"12":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":6},"end":{"line":27,"column":29}},{"start":{"line":27,"column":33},"end":{"line":27,"column":40}},{"start":{"line":27,"column":44},"end":{"line":27,"column":51}}]},"13":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":2},"end":{"line":28,"column":2}},{"start":{"line":28,"column":2},"end":{"line":28,"column":2}}]},"14":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":6},"end":{"line":28,"column":28}},{"start":{"line":28,"column":32},"end":{"line":28,"column":38}},{"start":{"line":28,"column":42},"end":{"line":28,"column":53}}]},"15":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":2}},{"start":{"line":37,"column":2},"end":{"line":37,"column":2}}]},"16":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":2},"end":{"line":49,"column":2}},{"start":{"line":49,"column":2},"end":{"line":49,"column":2}}]},"17":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":50,"column":2}},{"start":{"line":50,"column":2},"end":{"line":50,"column":2}}]},"18":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":58,"column":4}},{"start":{"line":58,"column":4},"end":{"line":58,"column":4}}]},"19":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":2},"end":{"line":68,"column":2}},{"start":{"line":68,"column":2},"end":{"line":68,"column":2}}]},"20":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":69,"column":2}},{"start":{"line":69,"column":2},"end":{"line":69,"column":2}}]},"21":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":2},"end":{"line":70,"column":2}},{"start":{"line":70,"column":2},"end":{"line":70,"column":2}}]},"22":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":4},"end":{"line":76,"column":4}},{"start":{"line":76,"column":4},"end":{"line":76,"column":4}}]},"23":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":11},"end":{"line":79,"column":11}},{"start":{"line":79,"column":11},"end":{"line":79,"column":11}}]},"24":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":11},"end":{"line":82,"column":11}},{"start":{"line":82,"column":11},"end":{"line":82,"column":11}}]},"25":{"line":86,"type":"if","locations":[{"start":{"line":86,"column":11},"end":{"line":86,"column":11}},{"start":{"line":86,"column":11},"end":{"line":86,"column":11}}]},"26":{"line":95,"type":"cond-expr","locations":[{"start":{"line":95,"column":26},"end":{"line":95,"column":32}},{"start":{"line":95,"column":35},"end":{"line":95,"column":68}}]}},"code":["var protocol = require('./protocol');","var crypto = require('crypto');","","/* TODO: consider rewriting these functions using buffers instead"," * of arrays"," */","","/* Publish */","module.exports.publish = function(opts) {","  opts = opts || {};","  var dup = opts.dup ? protocol.DUP_MASK : 0;","  var qos = opts.qos || 0;","  var retain = opts.retain ? protocol.RETAIN_MASK : 0;","  var topic = opts.topic;","  var payload = opts.payload || new Buffer(0);","  var id = (typeof opts.messageId === 'undefined') ? randint() : opts.messageId;","  var packet = {header: 0, payload: []};","","  /* Check required fields */","  if (typeof topic !== 'string' || topic.length <= 0) return null;","  /* if payload is a string, we'll convert it into a buffer */","  if(typeof payload == 'string') {","    payload = new Buffer(payload);","  }","  /* accepting only a buffer for payload */","  if (!Buffer.isBuffer(payload)) return null;","  if (typeof qos !== 'number' || qos < 0 || qos > 2) return null;","  if (typeof id !== 'number' || id < 0 || id > 0xFFFF) return null;","","  /* Generate header */","  packet.header = protocol.codes.publish << protocol.CMD_SHIFT | dup | qos << protocol.QOS_SHIFT | retain;","","  /* Topic name */","  packet.payload = packet.payload.concat(gen_string(topic));","","  /* Message ID */","  if (qos > 0) packet.payload = packet.payload.concat(gen_number(id));","","","  var buf = new Buffer([packet.header]","      .concat(gen_length(packet.payload.length + payload.length))","      .concat(packet.payload));","","  return Buffer.concat([buf, payload]);","};","","/* Requires length be a number > 0 */","var gen_length = function(length) {","  if(typeof length !== \"number\") return null;","  if(length < 0) return null;","","  var len = [];","  var digit = 0;","","  do {","    digit = length % 128 | 0;","    length = length / 128 | 0;","    if (length > 0) {","        digit = digit | 0x80;","    }","    len.push(digit);","  } while (length > 0);","","  return len;","};","","var gen_string = function(str, without_length) { /* based on code in (from http://farhadi.ir/downloads/utf8.js) */","  if(arguments.length < 2) without_length = false;","  if(typeof str !== \"string\") return null;","  if(typeof without_length !== \"boolean\") return null;","","  var string = [];","  var length = 0;","  for(var i = 0; i < str.length; i++) {","    var code = str.charCodeAt(i);","    if (code < 128) {","      string.push(code);                      ++length;","","    } else if (code < 2048) {","      string.push(192 + ((code >> 6 )   )); ++length;","      string.push(128 + ((code    ) & 63)); ++length;","    } else if (code < 65536) {","      string.push(224 + ((code >> 12)   )); ++length;","      string.push(128 + ((code >> 6 ) & 63)); ++length;","      string.push(128 + ((code    ) & 63)); ++length;","    } else if (code < 2097152) {","      string.push(240 + ((code >> 18)   )); ++length;","      string.push(128 + ((code >> 12) & 63)); ++length;","      string.push(128 + ((code >> 6 ) & 63)); ++length;","      string.push(128 + ((code    ) & 63)); ++length;","    } else {","      throw new Error(\"Can't encode character with code \" + code);","    }","  }","  return without_length ? string : gen_number(length).concat(string);","};","","var gen_number = function(num) {","  var number = [num >> 8, num & 0x00FF];","  return number;","};","","var randint = function() { return Math.floor(Math.random() * 0xFFFF); };"],"l":{"1":1,"2":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"20":0,"22":0,"23":0,"26":0,"27":0,"28":0,"31":0,"34":0,"37":0,"40":0,"44":0,"48":1,"49":0,"50":0,"52":0,"53":0,"55":0,"56":0,"57":0,"58":0,"59":0,"61":0,"64":0,"67":1,"68":0,"69":0,"70":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"92":0,"95":0,"98":1,"99":0,"100":0,"103":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqtt/protocol.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/connectors/mqtt/protocol.js","s":{"1":1,"2":1,"3":1,"4":16,"5":16,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":21,"column":2}},"2":{"start":{"line":24,"column":0},"end":{"line":24,"column":26}},"3":{"start":{"line":25,"column":0},"end":{"line":28,"column":1}},"4":{"start":{"line":26,"column":2},"end":{"line":26,"column":34}},"5":{"start":{"line":27,"column":2},"end":{"line":27,"column":30}},"6":{"start":{"line":31,"column":0},"end":{"line":31,"column":29}},"7":{"start":{"line":32,"column":0},"end":{"line":32,"column":31}},"8":{"start":{"line":33,"column":0},"end":{"line":33,"column":31}},"9":{"start":{"line":34,"column":0},"end":{"line":34,"column":31}},"10":{"start":{"line":35,"column":0},"end":{"line":35,"column":29}},"11":{"start":{"line":36,"column":0},"end":{"line":36,"column":34}},"12":{"start":{"line":39,"column":0},"end":{"line":39,"column":34}},"13":{"start":{"line":40,"column":0},"end":{"line":40,"column":38}},"14":{"start":{"line":43,"column":0},"end":{"line":43,"column":36}},"15":{"start":{"line":44,"column":0},"end":{"line":44,"column":36}},"16":{"start":{"line":45,"column":0},"end":{"line":45,"column":39}},"17":{"start":{"line":46,"column":0},"end":{"line":46,"column":36}},"18":{"start":{"line":47,"column":0},"end":{"line":47,"column":34}},"19":{"start":{"line":48,"column":0},"end":{"line":48,"column":37}},"20":{"start":{"line":49,"column":0},"end":{"line":49,"column":41}}},"branchMap":{},"code":["/* Protocol - protocol constants */","","/* Command code => mnemonic */","module.exports.types = {","  0: 'reserved',","  1: 'connect',","  2: 'connack',","  3: 'publish',","  4: 'puback',","  5: 'pubrec',","  6: 'pubrel',","  7: 'pubcomp',","  8: 'subscribe',","  9: 'suback',","  10: 'unsubscribe',","  11: 'unsuback',","  12: 'pingreq',","  13: 'pingresp',","  14: 'disconnect',","  15: 'reserved'","};","","/* Mnemonic => Command code */","module.exports.codes = {};","for(var k in module.exports.types) {","  var v = module.exports.types[k];","  module.exports.codes[v] = k;","}","","/* Header */","module.exports.CMD_SHIFT = 4;","module.exports.CMD_MASK = 0xF0;","module.exports.DUP_MASK = 0x08;","module.exports.QOS_MASK = 0x03;","module.exports.QOS_SHIFT = 1;","module.exports.RETAIN_MASK = 0x01;","","/* Length */","module.exports.LENGTH_MASK = 0x7F;","module.exports.LENGTH_FIN_MASK = 0x80;","","/* Connect */","module.exports.USERNAME_MASK = 0x80;","module.exports.PASSWORD_MASK = 0x40;","module.exports.WILL_RETAIN_MASK = 0x20;","module.exports.WILL_QOS_MASK = 0x18;","module.exports.WILL_QOS_SHIFT = 3;","module.exports.WILL_FLAG_MASK = 0x04;","module.exports.CLEAN_SESSION_MASK = 0x02;",""],"l":{"4":1,"24":1,"25":1,"26":16,"27":16,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"39":1,"40":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/pushSchedulers/buffer.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/pushSchedulers/buffer.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":1,"49":0,"50":0,"51":0,"52":0,"53":0,"54":1,"55":0,"56":1,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"fnMap":{"1":{"name":"(anonymous_1)","line":4,"loc":{"start":{"line":4,"column":14},"end":{"line":4,"column":34}}},"2":{"name":"(anonymous_2)","line":18,"loc":{"start":{"line":18,"column":26},"end":{"line":18,"column":39}}},"3":{"name":"(anonymous_3)","line":20,"loc":{"start":{"line":20,"column":19},"end":{"line":20,"column":30}}},"4":{"name":"(anonymous_4)","line":25,"loc":{"start":{"line":25,"column":25},"end":{"line":25,"column":45}}},"5":{"name":"(anonymous_5)","line":30,"loc":{"start":{"line":30,"column":19},"end":{"line":30,"column":30}}},"6":{"name":"(anonymous_6)","line":35,"loc":{"start":{"line":35,"column":29},"end":{"line":35,"column":74}}},"7":{"name":"(anonymous_7)","line":43,"loc":{"start":{"line":43,"column":19},"end":{"line":43,"column":30}}},"8":{"name":"(anonymous_8)","line":48,"loc":{"start":{"line":48,"column":18},"end":{"line":48,"column":44}}},"9":{"name":"(anonymous_9)","line":53,"loc":{"start":{"line":53,"column":40},"end":{"line":53,"column":58}}},"10":{"name":"(anonymous_10)","line":62,"loc":{"start":{"line":62,"column":34},"end":{"line":62,"column":52}}},"11":{"name":"(anonymous_11)","line":73,"loc":{"start":{"line":73,"column":18},"end":{"line":73,"column":45}}},"12":{"name":"(anonymous_12)","line":84,"loc":{"start":{"line":84,"column":14},"end":{"line":84,"column":43}}},"13":{"name":"(anonymous_13)","line":94,"loc":{"start":{"line":94,"column":14},"end":{"line":94,"column":38}}},"14":{"name":"(anonymous_14)","line":98,"loc":{"start":{"line":98,"column":12},"end":{"line":98,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":32}},"3":{"start":{"line":4,"column":0},"end":{"line":14,"column":2}},"4":{"start":{"line":5,"column":2},"end":{"line":7,"column":3}},"5":{"start":{"line":6,"column":4},"end":{"line":6,"column":34}},"6":{"start":{"line":9,"column":2},"end":{"line":9,"column":20}},"7":{"start":{"line":10,"column":2},"end":{"line":10,"column":17}},"8":{"start":{"line":11,"column":2},"end":{"line":11,"column":68}},"9":{"start":{"line":12,"column":2},"end":{"line":12,"column":21}},"10":{"start":{"line":13,"column":2},"end":{"line":13,"column":18}},"11":{"start":{"line":16,"column":0},"end":{"line":16,"column":25}},"12":{"start":{"line":18,"column":0},"end":{"line":23,"column":2}},"13":{"start":{"line":19,"column":2},"end":{"line":19,"column":69}},"14":{"start":{"line":20,"column":2},"end":{"line":22,"column":5}},"15":{"start":{"line":21,"column":4},"end":{"line":21,"column":29}},"16":{"start":{"line":25,"column":0},"end":{"line":33,"column":2}},"17":{"start":{"line":26,"column":2},"end":{"line":29,"column":3}},"18":{"start":{"line":27,"column":4},"end":{"line":27,"column":28}},"19":{"start":{"line":28,"column":4},"end":{"line":28,"column":20}},"20":{"start":{"line":30,"column":2},"end":{"line":32,"column":5}},"21":{"start":{"line":31,"column":4},"end":{"line":31,"column":29}},"22":{"start":{"line":35,"column":0},"end":{"line":46,"column":2}},"23":{"start":{"line":36,"column":2},"end":{"line":36,"column":20}},"24":{"start":{"line":37,"column":2},"end":{"line":41,"column":3}},"25":{"start":{"line":38,"column":4},"end":{"line":38,"column":45}},"26":{"start":{"line":40,"column":4},"end":{"line":40,"column":34}},"27":{"start":{"line":43,"column":2},"end":{"line":45,"column":5}},"28":{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},"29":{"start":{"line":48,"column":0},"end":{"line":71,"column":2}},"30":{"start":{"line":49,"column":2},"end":{"line":49,"column":54}},"31":{"start":{"line":50,"column":2},"end":{"line":50,"column":54}},"32":{"start":{"line":52,"column":2},"end":{"line":70,"column":3}},"33":{"start":{"line":53,"column":4},"end":{"line":60,"column":7}},"34":{"start":{"line":54,"column":6},"end":{"line":57,"column":7}},"35":{"start":{"line":56,"column":8},"end":{"line":56,"column":15}},"36":{"start":{"line":59,"column":6},"end":{"line":59,"column":34}},"37":{"start":{"line":62,"column":4},"end":{"line":69,"column":7}},"38":{"start":{"line":63,"column":6},"end":{"line":66,"column":7}},"39":{"start":{"line":65,"column":8},"end":{"line":65,"column":15}},"40":{"start":{"line":68,"column":6},"end":{"line":68,"column":34}},"41":{"start":{"line":73,"column":0},"end":{"line":82,"column":2}},"42":{"start":{"line":74,"column":2},"end":{"line":74,"column":54}},"43":{"start":{"line":75,"column":2},"end":{"line":75,"column":14}},"44":{"start":{"line":76,"column":2},"end":{"line":81,"column":3}},"45":{"start":{"line":77,"column":4},"end":{"line":77,"column":43}},"46":{"start":{"line":78,"column":4},"end":{"line":80,"column":5}},"47":{"start":{"line":79,"column":6},"end":{"line":79,"column":34}},"48":{"start":{"line":84,"column":0},"end":{"line":92,"column":2}},"49":{"start":{"line":85,"column":2},"end":{"line":85,"column":40}},"50":{"start":{"line":86,"column":2},"end":{"line":89,"column":3}},"51":{"start":{"line":87,"column":4},"end":{"line":87,"column":43}},"52":{"start":{"line":88,"column":4},"end":{"line":88,"column":53}},"53":{"start":{"line":91,"column":2},"end":{"line":91,"column":18}},"54":{"start":{"line":94,"column":0},"end":{"line":96,"column":2}},"55":{"start":{"line":95,"column":2},"end":{"line":95,"column":35}},"56":{"start":{"line":98,"column":0},"end":{"line":115,"column":2}},"57":{"start":{"line":99,"column":2},"end":{"line":99,"column":54}},"58":{"start":{"line":100,"column":2},"end":{"line":100,"column":21}},"59":{"start":{"line":101,"column":2},"end":{"line":114,"column":3}},"60":{"start":{"line":102,"column":4},"end":{"line":102,"column":38}},"61":{"start":{"line":103,"column":4},"end":{"line":105,"column":5}},"62":{"start":{"line":104,"column":6},"end":{"line":104,"column":15}},"63":{"start":{"line":107,"column":4},"end":{"line":107,"column":31}},"64":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"65":{"start":{"line":109,"column":6},"end":{"line":109,"column":15}},"66":{"start":{"line":112,"column":4},"end":{"line":112,"column":29}},"67":{"start":{"line":113,"column":4},"end":{"line":113,"column":28}}},"branchMap":{"1":{"line":5,"type":"if","locations":[{"start":{"line":5,"column":2},"end":{"line":5,"column":2}},{"start":{"line":5,"column":2},"end":{"line":5,"column":2}}]},"2":{"line":9,"type":"binary-expr","locations":[{"start":{"line":9,"column":9},"end":{"line":9,"column":13}},{"start":{"line":9,"column":17},"end":{"line":9,"column":19}}]},"3":{"line":11,"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":41}},{"start":{"line":11,"column":45},"end":{"line":11,"column":67}}]},"4":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":26,"column":2}},{"start":{"line":26,"column":2},"end":{"line":26,"column":2}}]},"5":{"line":36,"type":"binary-expr","locations":[{"start":{"line":36,"column":9},"end":{"line":36,"column":13}},{"start":{"line":36,"column":17},"end":{"line":36,"column":19}}]},"6":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":2}},{"start":{"line":37,"column":2},"end":{"line":37,"column":2}}]},"7":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":52,"column":2}},{"start":{"line":52,"column":2},"end":{"line":52,"column":2}}]},"8":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":6},"end":{"line":54,"column":6}},{"start":{"line":54,"column":6},"end":{"line":54,"column":6}}]},"9":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":9},"end":{"line":54,"column":39}},{"start":{"line":55,"column":9},"end":{"line":55,"column":72}}]},"10":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":6},"end":{"line":63,"column":6}},{"start":{"line":63,"column":6},"end":{"line":63,"column":6}}]},"11":{"line":63,"type":"binary-expr","locations":[{"start":{"line":63,"column":9},"end":{"line":63,"column":39}},{"start":{"line":64,"column":10},"end":{"line":64,"column":73}}]},"12":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":78,"column":4}},{"start":{"line":78,"column":4},"end":{"line":78,"column":4}}]},"13":{"line":86,"type":"if","locations":[{"start":{"line":86,"column":2},"end":{"line":86,"column":2}},{"start":{"line":86,"column":2},"end":{"line":86,"column":2}}]},"14":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":4},"end":{"line":103,"column":4}},{"start":{"line":103,"column":4},"end":{"line":103,"column":4}}]},"15":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":108,"column":4}},{"start":{"line":108,"column":4},"end":{"line":108,"column":4}}]},"16":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":7},"end":{"line":108,"column":13}},{"start":{"line":108,"column":17},"end":{"line":108,"column":35}}]}},"code":["var utils = require('../util/utils');","var DEFAULT_FLUSH_INTERVAL = 20;","","var Service = function(app, opts) {","  if (!(this instanceof Service)) {","    return new Service(app, opts);","  }","","  opts = opts || {};","  this.app = app;","  this.flushInterval = opts.flushInterval || DEFAULT_FLUSH_INTERVAL;","  this.sessions = {};   // sid -> msg queue","  this.tid = null;","};","","module.exports = Service;","","Service.prototype.start = function(cb) {","  this.tid = setInterval(flush.bind(null, this), this.flushInterval);","  process.nextTick(function() {","    utils.invokeCallback(cb);","  });","};","","Service.prototype.stop = function(force, cb) {","  if(this.tid) {","    clearInterval(this.tid);","    this.tid = null;","  }","  process.nextTick(function() {","    utils.invokeCallback(cb);","  });","};","","Service.prototype.schedule = function(reqId, route, msg, recvs, opts, cb) {","  opts = opts || {};","  if(opts.type === 'broadcast') {","    doBroadcast(this, msg, opts.userOptions);","  } else {","    doBatchPush(this, msg, recvs);","  }","","  process.nextTick(function() {","    utils.invokeCallback(cb);","  });","};","","var doBroadcast = function(self, msg, opts) {","  var channelService = self.app.get('channelService');","  var sessionService = self.app.get('sessionService');","","  if(opts.binded) {","    sessionService.forEachBindedSession(function(session) {","      if(channelService.broadcastFilter &&","         !channelService.broadcastFilter(session, msg, opts.filterParam)) {","        return;","      }","","      enqueue(self, session, msg);","    });","  } else {","    sessionService.forEachSession(function(session) {","      if(channelService.broadcastFilter &&","          !channelService.broadcastFilter(session, msg, opts.filterParam)) {","        return;","      }","","      enqueue(self, session, msg);","    });","  }","};","","var doBatchPush = function(self, msg, recvs) {","  var sessionService = self.app.get('sessionService');","  var session;","  for(var i=0, l=recvs.length; i<l; i++) {","    session = sessionService.get(recvs[i]);","    if(session) {","      enqueue(self, session, msg);","    }","  }","};","","var enqueue = function(self, session, msg) {","  var queue = self.sessions[session.id];","  if(!queue) {","    queue = self.sessions[session.id] = [];","    session.once('closed', onClose.bind(null, self));","  }","","  queue.push(msg);","};","","var onClose = function(self, session) {","  delete self.sessions[session.id];","};","","var flush = function(self) {","  var sessionService = self.app.get('sessionService');","  var queue, session;","  for(var sid in self.sessions) {","    session = sessionService.get(sid);","    if(!session) {","      continue;","    }","","    queue = self.sessions[sid];","    if(!queue || queue.length === 0) {","      continue;","    }","","    session.sendBatch(queue);","    self.sessions[sid] = [];","  }","};",""],"l":{"1":1,"2":1,"4":1,"5":0,"6":0,"9":0,"10":0,"11":0,"12":0,"13":0,"16":1,"18":1,"19":0,"20":0,"21":0,"25":1,"26":0,"27":0,"28":0,"30":0,"31":0,"35":1,"36":0,"37":0,"38":0,"40":0,"43":0,"44":0,"48":1,"49":0,"50":0,"52":0,"53":0,"54":0,"56":0,"59":0,"62":0,"63":0,"65":0,"68":0,"73":1,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"84":1,"85":0,"86":0,"87":0,"88":0,"91":0,"94":1,"95":0,"98":1,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"107":0,"108":0,"109":0,"112":0,"113":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/rpc/toobusy.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/filters/rpc/toobusy.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":17},"end":{"line":10,"column":34}}},"2":{"name":"(anonymous_2)","line":14,"loc":{"start":{"line":14,"column":13},"end":{"line":14,"column":30}}},"3":{"name":"(anonymous_3)","line":29,"loc":{"start":{"line":29,"column":27},"end":{"line":29,"column":63}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":74}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":19}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":24}},"4":{"start":{"line":10,"column":0},"end":{"line":12,"column":2}},"5":{"start":{"line":11,"column":2},"end":{"line":11,"column":46}},"6":{"start":{"line":14,"column":0},"end":{"line":22,"column":2}},"7":{"start":{"line":15,"column":2},"end":{"line":18,"column":3}},"8":{"start":{"line":16,"column":4},"end":{"line":16,"column":33}},"9":{"start":{"line":19,"column":2},"end":{"line":21,"column":3}},"10":{"start":{"line":20,"column":4},"end":{"line":20,"column":27}},"11":{"start":{"line":24,"column":0},"end":{"line":24,"column":34}},"12":{"start":{"line":29,"column":1},"end":{"line":39,"column":2}},"13":{"start":{"line":30,"column":2},"end":{"line":30,"column":18}},"14":{"start":{"line":31,"column":2},"end":{"line":38,"column":3}},"15":{"start":{"line":32,"column":4},"end":{"line":32,"column":93}},"16":{"start":{"line":33,"column":4},"end":{"line":33,"column":77}},"17":{"start":{"line":34,"column":4},"end":{"line":34,"column":19}},"18":{"start":{"line":35,"column":4},"end":{"line":35,"column":14}},"19":{"start":{"line":37,"column":4},"end":{"line":37,"column":11}}},"branchMap":{"1":{"line":11,"type":"binary-expr","locations":[{"start":{"line":11,"column":20},"end":{"line":11,"column":26}},{"start":{"line":11,"column":30},"end":{"line":11,"column":44}}]},"2":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":2},"end":{"line":19,"column":2}},{"start":{"line":19,"column":2},"end":{"line":19,"column":2}}]},"3":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":9},"end":{"line":30,"column":13}},{"start":{"line":30,"column":15},"end":{"line":30,"column":17}}]},"4":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":31,"column":2}},{"start":{"line":31,"column":2},"end":{"line":31,"column":2}}]},"5":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":6},"end":{"line":31,"column":15}},{"start":{"line":31,"column":19},"end":{"line":31,"column":28}}]}},"code":["/**"," * Filter for rpc log."," * Reject rpc request when toobusy"," */","var rpcLogger = require('pomelo-logger').getLogger('rpc-log', __filename);","var toobusy = null;","","var DEFAULT_MAXLAG = 70;","","module.exports = function(maxLag) {","  return new Filter(maxLag || DEFAULT_MAXLAG);","};","","var Filter = function(maxLag) {","  try {","    toobusy = require('toobusy');","  } catch(e) {","  }","  if(!!toobusy) {","    toobusy.maxLag(maxLag);","  }","};","","Filter.prototype.name = 'toobusy';","","/**"," * Before filter for rpc"," */"," Filter.prototype.before = function(serverId, msg, opts, next) {","  opts = opts||{};","  if (!!toobusy && toobusy()) {","    rpcLogger.warn('Server too busy for rpc request, serverId:' + serverId + ' msg: ' + msg);","    var err =  new Error('Backend server ' + serverId + ' is too busy now!');","    err.code = 500;","    next(err);","  } else {","    next();","  }","};",""],"l":{"5":1,"6":1,"8":1,"10":1,"11":0,"14":1,"15":0,"16":0,"19":0,"20":0,"24":1,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"37":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/gruntfile.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/gruntfile.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":17},"end":{"line":3,"column":33}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":44,"column":2}},"2":{"start":{"line":5,"column":2},"end":{"line":5,"column":41}},"3":{"start":{"line":6,"column":2},"end":{"line":6,"column":44}},"4":{"start":{"line":7,"column":2},"end":{"line":7,"column":45}},"5":{"start":{"line":9,"column":2},"end":{"line":10,"column":95}},"6":{"start":{"line":13,"column":2},"end":{"line":40,"column":5}},"7":{"start":{"line":43,"column":2},"end":{"line":43,"column":66}}},"branchMap":{},"code":["'use strict';","","module.exports = function(grunt) {","","  grunt.loadNpmTasks('grunt-mocha-test');","  grunt.loadNpmTasks('grunt-contrib-clean');","  grunt.loadNpmTasks('grunt-contrib-jshint');","","  var src = ['test/manager/taskManager.js', 'test/filters/*.js', ","  'test/remote/*.js', 'test/service/*.js', 'test/modules/*.js', 'test/util/*.js', 'test/*.js'];","","  // Project configuration.","  grunt.initConfig({","    mochaTest: {","       test: {","        options: {","          reporter: 'spec',","          timeout: 5000,","          require: 'coverage/blanket'","        },","        src: src","      },","      coverage: {","        options: {","          reporter: 'html-cov',","          quiet: true,","          captureFile: 'coverage.html'","        },","        src: src","      }","    },","    clean: {","      \"coverage.html\" : {","        src: ['coverage.html']","      }","    },","    jshint: {","      all: ['lib/*']","    }","  });","","  // Default task.","  grunt.registerTask('default', ['clean', 'mochaTest', 'jshint']);","};"],"l":{"3":1,"5":0,"6":0,"7":0,"9":0,"13":0,"43":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/master/watchdog.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/master/watchdog.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":1,"40":0,"41":1,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":1,"50":0,"51":0,"52":0,"53":0,"54":1,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"fnMap":{"1":{"name":"(anonymous_1)","line":8,"loc":{"start":{"line":8,"column":15},"end":{"line":8,"column":38}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":31},"end":{"line":23,"column":48}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":34},"end":{"line":31,"column":47}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":37},"end":{"line":40,"column":54}}},"5":{"name":"(anonymous_5)","line":56,"loc":{"start":{"line":56,"column":31},"end":{"line":56,"column":44}}},"6":{"name":"(anonymous_6)","line":60,"loc":{"start":{"line":60,"column":33},"end":{"line":60,"column":46}}},"7":{"name":"(anonymous_7)","line":64,"loc":{"start":{"line":64,"column":27},"end":{"line":64,"column":38}}},"8":{"name":"(anonymous_8)","line":68,"loc":{"start":{"line":68,"column":28},"end":{"line":68,"column":41}}},"9":{"name":"(anonymous_9)","line":77,"loc":{"start":{"line":77,"column":32},"end":{"line":77,"column":50}}},"10":{"name":"(anonymous_10)","line":78,"loc":{"start":{"line":78,"column":74},"end":{"line":78,"column":91}}},"11":{"name":"(anonymous_11)","line":87,"loc":{"start":{"line":87,"column":28},"end":{"line":87,"column":42}}},"12":{"name":"(anonymous_12)","line":98,"loc":{"start":{"line":98,"column":104},"end":{"line":98,"column":124}}},"13":{"name":"(anonymous_13)","line":112,"loc":{"start":{"line":112,"column":22},"end":{"line":112,"column":41}}},"14":{"name":"(anonymous_14)","line":113,"loc":{"start":{"line":113,"column":12},"end":{"line":113,"column":23}}},"15":{"name":"(anonymous_15)","line":114,"loc":{"start":{"line":114,"column":78},"end":{"line":114,"column":95}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":70}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":55}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":50}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"7":{"start":{"line":8,"column":0},"end":{"line":18,"column":2}},"8":{"start":{"line":9,"column":2},"end":{"line":9,"column":26}},"9":{"start":{"line":11,"column":2},"end":{"line":11,"column":17}},"10":{"start":{"line":12,"column":2},"end":{"line":12,"column":25}},"11":{"start":{"line":13,"column":2},"end":{"line":13,"column":25}},"12":{"start":{"line":14,"column":2},"end":{"line":14,"column":54}},"13":{"start":{"line":16,"column":2},"end":{"line":16,"column":20}},"14":{"start":{"line":17,"column":2},"end":{"line":17,"column":22}},"15":{"start":{"line":19,"column":0},"end":{"line":19,"column":38}},"16":{"start":{"line":21,"column":0},"end":{"line":21,"column":26}},"17":{"start":{"line":23,"column":0},"end":{"line":29,"column":2}},"18":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"19":{"start":{"line":25,"column":4},"end":{"line":25,"column":11}},"20":{"start":{"line":27,"column":2},"end":{"line":27,"column":35}},"21":{"start":{"line":28,"column":2},"end":{"line":28,"column":53}},"22":{"start":{"line":31,"column":0},"end":{"line":38,"column":2}},"23":{"start":{"line":32,"column":2},"end":{"line":34,"column":3}},"24":{"start":{"line":33,"column":4},"end":{"line":33,"column":11}},"25":{"start":{"line":35,"column":2},"end":{"line":35,"column":23}},"26":{"start":{"line":36,"column":2},"end":{"line":36,"column":26}},"27":{"start":{"line":37,"column":2},"end":{"line":37,"column":48}},"28":{"start":{"line":40,"column":0},"end":{"line":54,"column":2}},"29":{"start":{"line":41,"column":2},"end":{"line":41,"column":18}},"30":{"start":{"line":42,"column":2},"end":{"line":44,"column":3}},"31":{"start":{"line":43,"column":4},"end":{"line":43,"column":11}},"32":{"start":{"line":45,"column":2},"end":{"line":47,"column":3}},"33":{"start":{"line":46,"column":4},"end":{"line":46,"column":37}},"34":{"start":{"line":49,"column":2},"end":{"line":49,"column":79}},"35":{"start":{"line":51,"column":2},"end":{"line":51,"column":53}},"36":{"start":{"line":53,"column":2},"end":{"line":53,"column":28}},"37":{"start":{"line":56,"column":0},"end":{"line":58,"column":2}},"38":{"start":{"line":57,"column":2},"end":{"line":57,"column":25}},"39":{"start":{"line":60,"column":0},"end":{"line":62,"column":2}},"40":{"start":{"line":61,"column":2},"end":{"line":61,"column":28}},"41":{"start":{"line":64,"column":0},"end":{"line":66,"column":2}},"42":{"start":{"line":65,"column":2},"end":{"line":65,"column":22}},"43":{"start":{"line":68,"column":0},"end":{"line":75,"column":2}},"44":{"start":{"line":69,"column":2},"end":{"line":74,"column":3}},"45":{"start":{"line":70,"column":4},"end":{"line":70,"column":51}},"46":{"start":{"line":71,"column":4},"end":{"line":71,"column":58}},"47":{"start":{"line":72,"column":4},"end":{"line":72,"column":39}},"48":{"start":{"line":73,"column":4},"end":{"line":73,"column":26}},"49":{"start":{"line":77,"column":0},"end":{"line":85,"column":2}},"50":{"start":{"line":78,"column":2},"end":{"line":84,"column":5}},"51":{"start":{"line":79,"column":4},"end":{"line":83,"column":5}},"52":{"start":{"line":80,"column":6},"end":{"line":80,"column":90}},"53":{"start":{"line":82,"column":6},"end":{"line":82,"column":90}},"54":{"start":{"line":87,"column":0},"end":{"line":129,"column":2}},"55":{"start":{"line":88,"column":2},"end":{"line":88,"column":33}},"56":{"start":{"line":89,"column":2},"end":{"line":89,"column":21}},"57":{"start":{"line":90,"column":2},"end":{"line":90,"column":17}},"58":{"start":{"line":91,"column":2},"end":{"line":91,"column":20}},"59":{"start":{"line":92,"column":2},"end":{"line":92,"column":20}},"60":{"start":{"line":93,"column":2},"end":{"line":93,"column":36}},"61":{"start":{"line":94,"column":2},"end":{"line":97,"column":3}},"62":{"start":{"line":95,"column":4},"end":{"line":95,"column":67}},"63":{"start":{"line":96,"column":4},"end":{"line":96,"column":11}},"64":{"start":{"line":98,"column":2},"end":{"line":110,"column":5}},"65":{"start":{"line":99,"column":4},"end":{"line":106,"column":5}},"66":{"start":{"line":100,"column":6},"end":{"line":104,"column":7}},"67":{"start":{"line":101,"column":8},"end":{"line":103,"column":9}},"68":{"start":{"line":102,"column":10},"end":{"line":102,"column":29}},"69":{"start":{"line":105,"column":6},"end":{"line":105,"column":113}},"70":{"start":{"line":107,"column":4},"end":{"line":109,"column":5}},"71":{"start":{"line":108,"column":6},"end":{"line":108,"column":86}},"72":{"start":{"line":112,"column":2},"end":{"line":123,"column":4}},"73":{"start":{"line":113,"column":4},"end":{"line":122,"column":9}},"74":{"start":{"line":114,"column":6},"end":{"line":121,"column":9}},"75":{"start":{"line":115,"column":8},"end":{"line":118,"column":9}},"76":{"start":{"line":116,"column":10},"end":{"line":116,"column":25}},"77":{"start":{"line":117,"column":10},"end":{"line":117,"column":26}},"78":{"start":{"line":119,"column":8},"end":{"line":119,"column":25}},"79":{"start":{"line":120,"column":8},"end":{"line":120,"column":21}},"80":{"start":{"line":125,"column":2},"end":{"line":128,"column":3}},"81":{"start":{"line":126,"column":4},"end":{"line":126,"column":21}},"82":{"start":{"line":127,"column":4},"end":{"line":127,"column":28}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":24,"column":2}},{"start":{"line":24,"column":2},"end":{"line":24,"column":2}}]},"2":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":32,"column":2}},{"start":{"line":32,"column":2},"end":{"line":32,"column":2}}]},"3":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":2},"end":{"line":42,"column":2}},{"start":{"line":42,"column":2},"end":{"line":42,"column":2}}]},"4":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":2},"end":{"line":45,"column":2}},{"start":{"line":45,"column":2},"end":{"line":45,"column":2}}]},"5":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":69,"column":2}},{"start":{"line":69,"column":2},"end":{"line":69,"column":2}}]},"6":{"line":69,"type":"binary-expr","locations":[{"start":{"line":69,"column":5},"end":{"line":69,"column":20}},{"start":{"line":69,"column":24},"end":{"line":69,"column":40}}]},"7":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"8":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":2},"end":{"line":94,"column":2}},{"start":{"line":94,"column":2},"end":{"line":94,"column":2}}]},"9":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":4},"end":{"line":99,"column":4}},{"start":{"line":99,"column":4},"end":{"line":99,"column":4}}]},"10":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":8},"end":{"line":101,"column":8}},{"start":{"line":101,"column":8},"end":{"line":101,"column":8}}]},"11":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":4},"end":{"line":107,"column":4}},{"start":{"line":107,"column":4},"end":{"line":107,"column":4}}]},"12":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":8},"end":{"line":115,"column":8}},{"start":{"line":115,"column":8},"end":{"line":115,"column":8}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var utils = require('../util/utils');","var Constants = require('../util/constants');","var countDownLatch = require('../util/countDownLatch');","var EventEmitter = require('events').EventEmitter;","var util = require('util');","","var Watchdog = function(app, service) {","  EventEmitter.call(this);","","  this.app = app;","  this.service = service;","  this.isStarted = false;","  this.count = utils.size(app.getServersFromConfig());","","  this.servers = {};","  this.listeners = {};","};","util.inherits(Watchdog, EventEmitter);","","module.exports = Watchdog;","","Watchdog.prototype.addServer = function(server) {","  if(!server) {","    return;","  }","  this.servers[server.id] = server;","  this.notify({action: 'addServer', server: server});","};","","Watchdog.prototype.removeServer = function(id) {","  if(!id) {","    return;","  }","  this.unsubscribe(id);","  delete this.servers[id];","  this.notify({action: 'removeServer', id: id});","};","","Watchdog.prototype.reconnectServer = function(server) {","  var self = this;","  if(!server) {","    return;","  }","  if(!this.servers[server.id]) {","    this.servers[server.id] = server;","  }","  //replace server in reconnect server","  this.notifyById(server.id, {action: 'replaceServer', servers: self.servers});","  // notify other server to add server","  this.notify({action: 'addServer', server: server});","  // add server in listener","  this.subscribe(server.id);","};","","Watchdog.prototype.subscribe = function(id) {","  this.listeners[id] = 1;","};","","Watchdog.prototype.unsubscribe = function(id) {","  delete this.listeners[id];","};","","Watchdog.prototype.query = function() {","  return this.servers;","};","","Watchdog.prototype.record = function(id) {","  if(!this.isStarted && --this.count < 0) {","    var usedTime = Date.now() - this.app.startTime;","    logger.info('all servers startup in %s ms', usedTime);","    this.notify({action: 'startOver'});","    this.isStarted = true;","  }","};","","Watchdog.prototype.notifyById = function(id, msg) {","  this.service.agent.request(id, Constants.KEYWORDS.MONITOR_WATCHER, msg, function(signal) {","    if(signal !== Constants.SIGNAL.OK) {","      logger.error('master watchdog fail to notify to monitor, id: %s, msg: %j', id, msg);","    } else {","      logger.debug('master watchdog notify to monitor success, id: %s, msg: %j', id, msg);","    }","  });","};","","Watchdog.prototype.notify = function(msg) {","  var listeners = this.listeners;","  var success = true;","  var fails = [];","  var timeouts = [];","  var requests = {};","  var count = utils.size(listeners);","  if(count === 0) {","    logger.warn('master watchdog listeners is none, msg: %j', msg);","    return;","  }","  var latch = countDownLatch.createCountDownLatch(count, {timeout: Constants.TIME.TIME_WAIT_COUNTDOWN}, function(isTimeout) {","    if(!!isTimeout) {","      for(var key in requests) {","        if(!requests[key])  {","          timeouts.push(key);","        }","      }","      logger.error('master watchdog request timeout message: %j, timeouts: %j, fails: %j', msg, timeouts, fails);","    }","    if(!success) {","      logger.error('master watchdog request fail message: %j, fails: %j', msg, fails);","    }","  });","","  var moduleRequest = function(self, id) {","    return (function() {","      self.service.agent.request(id, Constants.KEYWORDS.MONITOR_WATCHER, msg, function(signal) {","        if(signal !== Constants.SIGNAL.OK) {","          fails.push(id);","          success = false;","        }","        requests[id] = 1;","        latch.done();","      });","    })();","  };","","  for(var id in listeners) {","    requests[id] = 0;","    moduleRequest(this, id);","  }","};"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"8":1,"9":0,"11":0,"12":0,"13":0,"14":0,"16":0,"17":0,"19":1,"21":1,"23":1,"24":0,"25":0,"27":0,"28":0,"31":1,"32":0,"33":0,"35":0,"36":0,"37":0,"40":1,"41":0,"42":0,"43":0,"45":0,"46":0,"49":0,"51":0,"53":0,"56":1,"57":0,"60":1,"61":0,"64":1,"65":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"77":1,"78":0,"79":0,"80":0,"82":0,"87":1,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"98":0,"99":0,"100":0,"101":0,"102":0,"105":0,"107":0,"108":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"119":0,"120":0,"125":0,"126":0,"127":0}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/modules/console.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/modules/console.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":1,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":1,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":1,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":1,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":1,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":1,"164":0,"165":0,"166":0,"167":0,"168":1,"169":0,"170":0,"171":1,"172":0,"173":0,"174":1,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":1,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":1,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":1,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":1,"223":0,"224":0,"225":0,"226":0,"227":1,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":1,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":1,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":1,"273":0,"274":0,"275":0,"276":0,"277":1,"278":0,"279":0,"280":1,"281":1,"282":1,"283":1},"b":{"1":[0,0],"2":[0,0,0,0,0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0,0,0,0,0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":17},"end":{"line":13,"column":32}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":13},"end":{"line":19,"column":28}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":34},"end":{"line":25,"column":59}}},"4":{"name":"(anonymous_4)","line":49,"loc":{"start":{"line":49,"column":19},"end":{"line":49,"column":30}}},"5":{"name":"(anonymous_5)","line":73,"loc":{"start":{"line":73,"column":23},"end":{"line":73,"column":34}}},"6":{"name":"(anonymous_6)","line":83,"loc":{"start":{"line":83,"column":33},"end":{"line":83,"column":58}}},"7":{"name":"(anonymous_7)","line":116,"loc":{"start":{"line":116,"column":11},"end":{"line":116,"column":41}}},"8":{"name":"(anonymous_8)","line":120,"loc":{"start":{"line":120,"column":106},"end":{"line":120,"column":126}}},"9":{"name":"(anonymous_9)","line":126,"loc":{"start":{"line":126,"column":15},"end":{"line":126,"column":26}}},"10":{"name":"(anonymous_10)","line":131,"loc":{"start":{"line":131,"column":29},"end":{"line":131,"column":43}}},"11":{"name":"(anonymous_11)","line":148,"loc":{"start":{"line":148,"column":11},"end":{"line":148,"column":41}}},"12":{"name":"(anonymous_12)","line":170,"loc":{"start":{"line":170,"column":15},"end":{"line":170,"column":26}}},"13":{"name":"(anonymous_13)","line":177,"loc":{"start":{"line":177,"column":14},"end":{"line":177,"column":44}}},"14":{"name":"(anonymous_14)","line":199,"loc":{"start":{"line":199,"column":104},"end":{"line":199,"column":115}}},"15":{"name":"(anonymous_15)","line":207,"loc":{"start":{"line":207,"column":16},"end":{"line":207,"column":29}}},"16":{"name":"(anonymous_16)","line":208,"loc":{"start":{"line":208,"column":12},"end":{"line":208,"column":23}}},"17":{"name":"(anonymous_17)","line":209,"loc":{"start":{"line":209,"column":73},"end":{"line":209,"column":87}}},"18":{"name":"(anonymous_18)","line":214,"loc":{"start":{"line":214,"column":19},"end":{"line":214,"column":30}}},"19":{"name":"(anonymous_19)","line":215,"loc":{"start":{"line":215,"column":29},"end":{"line":215,"column":51}}},"20":{"name":"(anonymous_20)","line":234,"loc":{"start":{"line":234,"column":11},"end":{"line":234,"column":36}}},"21":{"name":"(anonymous_21)","line":238,"loc":{"start":{"line":238,"column":104},"end":{"line":238,"column":115}}},"22":{"name":"(anonymous_22)","line":242,"loc":{"start":{"line":242,"column":17},"end":{"line":242,"column":31}}},"23":{"name":"(anonymous_23)","line":252,"loc":{"start":{"line":252,"column":10},"end":{"line":252,"column":33}}},"24":{"name":"(anonymous_24)","line":261,"loc":{"start":{"line":261,"column":14},"end":{"line":261,"column":44}}},"25":{"name":"(anonymous_25)","line":266,"loc":{"start":{"line":266,"column":17},"end":{"line":266,"column":47}}},"26":{"name":"(anonymous_26)","line":271,"loc":{"start":{"line":271,"column":16},"end":{"line":271,"column":41}}},"27":{"name":"(anonymous_27)","line":280,"loc":{"start":{"line":280,"column":19},"end":{"line":280,"column":30}}},"28":{"name":"(anonymous_28)","line":285,"loc":{"start":{"line":285,"column":16},"end":{"line":285,"column":37}}},"29":{"name":"(anonymous_29)","line":298,"loc":{"start":{"line":298,"column":16},"end":{"line":298,"column":46}}},"30":{"name":"(anonymous_30)","line":303,"loc":{"start":{"line":303,"column":20},"end":{"line":303,"column":50}}},"31":{"name":"(anonymous_31)","line":314,"loc":{"start":{"line":314,"column":16},"end":{"line":314,"column":40}}},"32":{"name":"(anonymous_32)","line":332,"loc":{"start":{"line":332,"column":19},"end":{"line":332,"column":56}}},"33":{"name":"(anonymous_33)","line":339,"loc":{"start":{"line":339,"column":21},"end":{"line":339,"column":32}}},"34":{"name":"(anonymous_34)","line":348,"loc":{"start":{"line":348,"column":18},"end":{"line":348,"column":41}}},"35":{"name":"(anonymous_35)","line":357,"loc":{"start":{"line":357,"column":16},"end":{"line":357,"column":42}}},"36":{"name":"(anonymous_36)","line":358,"loc":{"start":{"line":358,"column":20},"end":{"line":358,"column":37}}},"37":{"name":"(anonymous_37)","line":362,"loc":{"start":{"line":362,"column":31},"end":{"line":362,"column":45}}},"38":{"name":"(anonymous_38)","line":368,"loc":{"start":{"line":368,"column":23},"end":{"line":368,"column":34}}},"39":{"name":"(anonymous_39)","line":375,"loc":{"start":{"line":375,"column":19},"end":{"line":375,"column":42}}},"40":{"name":"(anonymous_40)","line":382,"loc":{"start":{"line":382,"column":57},"end":{"line":382,"column":68}}},"41":{"name":"(anonymous_41)","line":390,"loc":{"start":{"line":390,"column":14},"end":{"line":390,"column":31}}},"42":{"name":"(anonymous_42)","line":391,"loc":{"start":{"line":391,"column":12},"end":{"line":391,"column":23}}},"43":{"name":"(anonymous_43)","line":392,"loc":{"start":{"line":392,"column":24},"end":{"line":392,"column":41}}},"44":{"name":"(anonymous_44)","line":397,"loc":{"start":{"line":397,"column":35},"end":{"line":397,"column":49}}},"45":{"name":"(anonymous_45)","line":403,"loc":{"start":{"line":403,"column":27},"end":{"line":403,"column":38}}},"46":{"name":"(anonymous_46)","line":417,"loc":{"start":{"line":417,"column":19},"end":{"line":417,"column":33}}},"47":{"name":"(anonymous_47)","line":428,"loc":{"start":{"line":428,"column":14},"end":{"line":428,"column":29}}},"48":{"name":"(anonymous_48)","line":437,"loc":{"start":{"line":437,"column":12},"end":{"line":437,"column":27}}}},"statementMap":{"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":70}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":55}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":37}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":45}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":43}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":41}},"7":{"start":{"line":13,"column":0},"end":{"line":15,"column":2}},"8":{"start":{"line":14,"column":2},"end":{"line":14,"column":26}},"9":{"start":{"line":17,"column":0},"end":{"line":17,"column":40}},"10":{"start":{"line":19,"column":0},"end":{"line":23,"column":2}},"11":{"start":{"line":20,"column":2},"end":{"line":20,"column":20}},"12":{"start":{"line":21,"column":2},"end":{"line":21,"column":22}},"13":{"start":{"line":22,"column":2},"end":{"line":22,"column":30}},"14":{"start":{"line":25,"column":0},"end":{"line":81,"column":2}},"15":{"start":{"line":26,"column":2},"end":{"line":26,"column":26}},"16":{"start":{"line":27,"column":2},"end":{"line":80,"column":3}},"17":{"start":{"line":29,"column":6},"end":{"line":31,"column":7}},"18":{"start":{"line":30,"column":8},"end":{"line":30,"column":15}},"19":{"start":{"line":32,"column":6},"end":{"line":32,"column":26}},"20":{"start":{"line":33,"column":6},"end":{"line":33,"column":12}},"21":{"start":{"line":35,"column":6},"end":{"line":35,"column":34}},"22":{"start":{"line":36,"column":6},"end":{"line":36,"column":28}},"23":{"start":{"line":37,"column":6},"end":{"line":37,"column":79}},"24":{"start":{"line":38,"column":6},"end":{"line":38,"column":69}},"25":{"start":{"line":39,"column":6},"end":{"line":39,"column":81}},"26":{"start":{"line":40,"column":6},"end":{"line":40,"column":52}},"27":{"start":{"line":41,"column":6},"end":{"line":44,"column":9}},"28":{"start":{"line":45,"column":6},"end":{"line":45,"column":12}},"29":{"start":{"line":47,"column":6},"end":{"line":47,"column":41}},"30":{"start":{"line":48,"column":6},"end":{"line":52,"column":7}},"31":{"start":{"line":49,"column":8},"end":{"line":51,"column":50}},"32":{"start":{"line":50,"column":10},"end":{"line":50,"column":27}},"33":{"start":{"line":53,"column":6},"end":{"line":53,"column":12}},"34":{"start":{"line":55,"column":6},"end":{"line":55,"column":36}},"35":{"start":{"line":56,"column":6},"end":{"line":56,"column":12}},"36":{"start":{"line":58,"column":6},"end":{"line":58,"column":39}},"37":{"start":{"line":59,"column":6},"end":{"line":59,"column":12}},"38":{"start":{"line":61,"column":6},"end":{"line":64,"column":7}},"39":{"start":{"line":62,"column":8},"end":{"line":62,"column":58}},"40":{"start":{"line":63,"column":8},"end":{"line":63,"column":72}},"41":{"start":{"line":65,"column":6},"end":{"line":65,"column":12}},"42":{"start":{"line":67,"column":6},"end":{"line":69,"column":7}},"43":{"start":{"line":68,"column":8},"end":{"line":68,"column":15}},"44":{"start":{"line":70,"column":6},"end":{"line":70,"column":22}},"45":{"start":{"line":71,"column":6},"end":{"line":71,"column":67}},"46":{"start":{"line":72,"column":6},"end":{"line":72,"column":39}},"47":{"start":{"line":73,"column":6},"end":{"line":75,"column":9}},"48":{"start":{"line":74,"column":8},"end":{"line":74,"column":28}},"49":{"start":{"line":76,"column":6},"end":{"line":76,"column":12}},"50":{"start":{"line":78,"column":6},"end":{"line":78,"column":52}},"51":{"start":{"line":79,"column":6},"end":{"line":79,"column":12}},"52":{"start":{"line":83,"column":0},"end":{"line":114,"column":2}},"53":{"start":{"line":84,"column":2},"end":{"line":84,"column":21}},"54":{"start":{"line":85,"column":2},"end":{"line":113,"column":3}},"55":{"start":{"line":87,"column":6},"end":{"line":87,"column":32}},"56":{"start":{"line":88,"column":6},"end":{"line":88,"column":12}},"57":{"start":{"line":90,"column":6},"end":{"line":90,"column":32}},"58":{"start":{"line":91,"column":6},"end":{"line":91,"column":12}},"59":{"start":{"line":93,"column":6},"end":{"line":93,"column":27}},"60":{"start":{"line":94,"column":6},"end":{"line":94,"column":12}},"61":{"start":{"line":96,"column":6},"end":{"line":96,"column":24}},"62":{"start":{"line":97,"column":6},"end":{"line":97,"column":12}},"63":{"start":{"line":99,"column":6},"end":{"line":99,"column":35}},"64":{"start":{"line":100,"column":6},"end":{"line":100,"column":12}},"65":{"start":{"line":102,"column":6},"end":{"line":102,"column":38}},"66":{"start":{"line":103,"column":6},"end":{"line":103,"column":12}},"67":{"start":{"line":105,"column":6},"end":{"line":105,"column":32}},"68":{"start":{"line":106,"column":6},"end":{"line":106,"column":12}},"69":{"start":{"line":108,"column":6},"end":{"line":108,"column":35}},"70":{"start":{"line":109,"column":6},"end":{"line":109,"column":12}},"71":{"start":{"line":111,"column":6},"end":{"line":111,"column":99}},"72":{"start":{"line":112,"column":6},"end":{"line":112,"column":12}},"73":{"start":{"line":116,"column":0},"end":{"line":146,"column":2}},"74":{"start":{"line":117,"column":2},"end":{"line":117,"column":18}},"75":{"start":{"line":118,"column":2},"end":{"line":118,"column":21}},"76":{"start":{"line":119,"column":2},"end":{"line":119,"column":38}},"77":{"start":{"line":120,"column":2},"end":{"line":129,"column":5}},"78":{"start":{"line":121,"column":4},"end":{"line":125,"column":5}},"79":{"start":{"line":122,"column":6},"end":{"line":122,"column":51}},"80":{"start":{"line":124,"column":6},"end":{"line":124,"column":79}},"81":{"start":{"line":126,"column":4},"end":{"line":128,"column":46}},"82":{"start":{"line":127,"column":6},"end":{"line":127,"column":23}},"83":{"start":{"line":131,"column":2},"end":{"line":139,"column":4}},"84":{"start":{"line":132,"column":6},"end":{"line":138,"column":7}},"85":{"start":{"line":133,"column":8},"end":{"line":137,"column":9}},"86":{"start":{"line":134,"column":10},"end":{"line":134,"column":32}},"87":{"start":{"line":135,"column":10},"end":{"line":135,"column":23}},"88":{"start":{"line":136,"column":10},"end":{"line":136,"column":16}},"89":{"start":{"line":141,"column":2},"end":{"line":145,"column":3}},"90":{"start":{"line":142,"column":4},"end":{"line":142,"column":30}},"91":{"start":{"line":143,"column":4},"end":{"line":143,"column":30}},"92":{"start":{"line":144,"column":4},"end":{"line":144,"column":100}},"93":{"start":{"line":148,"column":0},"end":{"line":175,"column":2}},"94":{"start":{"line":149,"column":2},"end":{"line":149,"column":26}},"95":{"start":{"line":150,"column":2},"end":{"line":174,"column":3}},"96":{"start":{"line":151,"column":4},"end":{"line":151,"column":35}},"97":{"start":{"line":152,"column":4},"end":{"line":152,"column":56}},"98":{"start":{"line":153,"column":4},"end":{"line":160,"column":5}},"99":{"start":{"line":154,"column":6},"end":{"line":154,"column":34}},"100":{"start":{"line":155,"column":6},"end":{"line":159,"column":7}},"101":{"start":{"line":156,"column":8},"end":{"line":156,"column":85}},"102":{"start":{"line":158,"column":8},"end":{"line":158,"column":84}},"103":{"start":{"line":161,"column":4},"end":{"line":161,"column":55}},"104":{"start":{"line":163,"column":4},"end":{"line":163,"column":35}},"105":{"start":{"line":164,"column":4},"end":{"line":164,"column":23}},"106":{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},"107":{"start":{"line":166,"column":8},"end":{"line":166,"column":25}},"108":{"start":{"line":168,"column":4},"end":{"line":168,"column":56}},"109":{"start":{"line":169,"column":4},"end":{"line":169,"column":69}},"110":{"start":{"line":170,"column":4},"end":{"line":173,"column":38}},"111":{"start":{"line":171,"column":6},"end":{"line":171,"column":21}},"112":{"start":{"line":172,"column":6},"end":{"line":172,"column":56}},"113":{"start":{"line":177,"column":0},"end":{"line":232,"column":2}},"114":{"start":{"line":178,"column":2},"end":{"line":178,"column":18}},"115":{"start":{"line":179,"column":2},"end":{"line":179,"column":22}},"116":{"start":{"line":180,"column":2},"end":{"line":180,"column":26}},"117":{"start":{"line":181,"column":2},"end":{"line":181,"column":22}},"118":{"start":{"line":182,"column":2},"end":{"line":182,"column":14}},"119":{"start":{"line":183,"column":2},"end":{"line":197,"column":3}},"120":{"start":{"line":184,"column":4},"end":{"line":184,"column":41}},"121":{"start":{"line":185,"column":4},"end":{"line":188,"column":5}},"122":{"start":{"line":186,"column":6},"end":{"line":186,"column":95}},"123":{"start":{"line":187,"column":6},"end":{"line":187,"column":13}},"124":{"start":{"line":189,"column":4},"end":{"line":191,"column":5}},"125":{"start":{"line":190,"column":6},"end":{"line":190,"column":36}},"126":{"start":{"line":192,"column":9},"end":{"line":197,"column":3}},"127":{"start":{"line":193,"column":4},"end":{"line":193,"column":31}},"128":{"start":{"line":194,"column":4},"end":{"line":196,"column":5}},"129":{"start":{"line":195,"column":6},"end":{"line":195,"column":26}},"130":{"start":{"line":198,"column":2},"end":{"line":198,"column":31}},"131":{"start":{"line":199,"column":2},"end":{"line":205,"column":5}},"132":{"start":{"line":200,"column":4},"end":{"line":203,"column":5}},"133":{"start":{"line":201,"column":6},"end":{"line":201,"column":71}},"134":{"start":{"line":202,"column":6},"end":{"line":202,"column":13}},"135":{"start":{"line":204,"column":4},"end":{"line":204,"column":75}},"136":{"start":{"line":207,"column":2},"end":{"line":227,"column":4}},"137":{"start":{"line":208,"column":4},"end":{"line":226,"column":9}},"138":{"start":{"line":209,"column":6},"end":{"line":225,"column":9}},"139":{"start":{"line":210,"column":8},"end":{"line":213,"column":9}},"140":{"start":{"line":211,"column":10},"end":{"line":211,"column":23}},"141":{"start":{"line":212,"column":10},"end":{"line":212,"column":17}},"142":{"start":{"line":214,"column":8},"end":{"line":224,"column":44}},"143":{"start":{"line":215,"column":9},"end":{"line":223,"column":11}},"144":{"start":{"line":216,"column":10},"end":{"line":221,"column":11}},"145":{"start":{"line":217,"column":12},"end":{"line":217,"column":55}},"146":{"start":{"line":219,"column":12},"end":{"line":219,"column":32}},"147":{"start":{"line":220,"column":12},"end":{"line":220,"column":31}},"148":{"start":{"line":222,"column":10},"end":{"line":222,"column":23}},"149":{"start":{"line":229,"column":2},"end":{"line":231,"column":3}},"150":{"start":{"line":230,"column":4},"end":{"line":230,"column":26}},"151":{"start":{"line":234,"column":0},"end":{"line":250,"column":2}},"152":{"start":{"line":235,"column":2},"end":{"line":235,"column":18}},"153":{"start":{"line":236,"column":2},"end":{"line":236,"column":22}},"154":{"start":{"line":237,"column":2},"end":{"line":237,"column":38}},"155":{"start":{"line":238,"column":2},"end":{"line":240,"column":5}},"156":{"start":{"line":239,"column":4},"end":{"line":239,"column":56}},"157":{"start":{"line":242,"column":2},"end":{"line":245,"column":4}},"158":{"start":{"line":243,"column":4},"end":{"line":243,"column":40}},"159":{"start":{"line":244,"column":4},"end":{"line":244,"column":17}},"160":{"start":{"line":246,"column":2},"end":{"line":249,"column":3}},"161":{"start":{"line":247,"column":4},"end":{"line":247,"column":30}},"162":{"start":{"line":248,"column":4},"end":{"line":248,"column":88}},"163":{"start":{"line":252,"column":0},"end":{"line":259,"column":2}},"164":{"start":{"line":253,"column":2},"end":{"line":257,"column":3}},"165":{"start":{"line":254,"column":4},"end":{"line":254,"column":31}},"166":{"start":{"line":256,"column":4},"end":{"line":256,"column":30}},"167":{"start":{"line":258,"column":2},"end":{"line":258,"column":20}},"168":{"start":{"line":261,"column":0},"end":{"line":264,"column":2}},"169":{"start":{"line":262,"column":2},"end":{"line":262,"column":42}},"170":{"start":{"line":263,"column":2},"end":{"line":263,"column":47}},"171":{"start":{"line":266,"column":0},"end":{"line":269,"column":2}},"172":{"start":{"line":267,"column":2},"end":{"line":267,"column":44}},"173":{"start":{"line":268,"column":2},"end":{"line":268,"column":49}},"174":{"start":{"line":271,"column":0},"end":{"line":283,"column":2}},"175":{"start":{"line":272,"column":2},"end":{"line":272,"column":21}},"176":{"start":{"line":273,"column":2},"end":{"line":278,"column":3}},"177":{"start":{"line":274,"column":4},"end":{"line":277,"column":5}},"178":{"start":{"line":275,"column":6},"end":{"line":275,"column":97}},"179":{"start":{"line":276,"column":6},"end":{"line":276,"column":13}},"180":{"start":{"line":279,"column":2},"end":{"line":279,"column":88}},"181":{"start":{"line":280,"column":2},"end":{"line":282,"column":5}},"182":{"start":{"line":281,"column":4},"end":{"line":281,"column":31}},"183":{"start":{"line":285,"column":0},"end":{"line":312,"column":2}},"184":{"start":{"line":286,"column":2},"end":{"line":289,"column":3}},"185":{"start":{"line":287,"column":4},"end":{"line":287,"column":40}},"186":{"start":{"line":288,"column":4},"end":{"line":288,"column":11}},"187":{"start":{"line":291,"column":2},"end":{"line":291,"column":43}},"188":{"start":{"line":292,"column":2},"end":{"line":292,"column":25}},"189":{"start":{"line":293,"column":2},"end":{"line":293,"column":35}},"190":{"start":{"line":294,"column":2},"end":{"line":296,"column":3}},"191":{"start":{"line":295,"column":4},"end":{"line":295,"column":36}},"192":{"start":{"line":298,"column":2},"end":{"line":311,"column":5}},"193":{"start":{"line":299,"column":4},"end":{"line":310,"column":5}},"194":{"start":{"line":300,"column":6},"end":{"line":300,"column":39}},"195":{"start":{"line":302,"column":6},"end":{"line":302,"column":28}},"196":{"start":{"line":303,"column":6},"end":{"line":309,"column":9}},"197":{"start":{"line":304,"column":8},"end":{"line":308,"column":9}},"198":{"start":{"line":305,"column":10},"end":{"line":305,"column":43}},"199":{"start":{"line":307,"column":10},"end":{"line":307,"column":46}},"200":{"start":{"line":314,"column":0},"end":{"line":330,"column":2}},"201":{"start":{"line":315,"column":2},"end":{"line":315,"column":14}},"202":{"start":{"line":316,"column":2},"end":{"line":316,"column":22}},"203":{"start":{"line":317,"column":2},"end":{"line":328,"column":3}},"204":{"start":{"line":318,"column":4},"end":{"line":321,"column":5}},"205":{"start":{"line":319,"column":6},"end":{"line":319,"column":61}},"206":{"start":{"line":320,"column":6},"end":{"line":320,"column":13}},"207":{"start":{"line":322,"column":4},"end":{"line":322,"column":35}},"208":{"start":{"line":323,"column":4},"end":{"line":323,"column":23}},"209":{"start":{"line":324,"column":4},"end":{"line":326,"column":5}},"210":{"start":{"line":325,"column":6},"end":{"line":325,"column":20}},"211":{"start":{"line":327,"column":4},"end":{"line":327,"column":28}},"212":{"start":{"line":329,"column":2},"end":{"line":329,"column":12}},"213":{"start":{"line":332,"column":0},"end":{"line":346,"column":2}},"214":{"start":{"line":333,"column":2},"end":{"line":344,"column":3}},"215":{"start":{"line":334,"column":4},"end":{"line":338,"column":5}},"216":{"start":{"line":335,"column":6},"end":{"line":335,"column":99}},"217":{"start":{"line":337,"column":6},"end":{"line":337,"column":103}},"218":{"start":{"line":339,"column":4},"end":{"line":341,"column":7}},"219":{"start":{"line":340,"column":6},"end":{"line":340,"column":33}},"220":{"start":{"line":343,"column":4},"end":{"line":343,"column":61}},"221":{"start":{"line":345,"column":2},"end":{"line":345,"column":14}},"222":{"start":{"line":348,"column":0},"end":{"line":355,"column":2}},"223":{"start":{"line":349,"column":2},"end":{"line":349,"column":46}},"224":{"start":{"line":350,"column":2},"end":{"line":354,"column":3}},"225":{"start":{"line":351,"column":4},"end":{"line":351,"column":31}},"226":{"start":{"line":353,"column":4},"end":{"line":353,"column":61}},"227":{"start":{"line":357,"column":0},"end":{"line":373,"column":2}},"228":{"start":{"line":358,"column":2},"end":{"line":372,"column":5}},"229":{"start":{"line":359,"column":4},"end":{"line":371,"column":5}},"230":{"start":{"line":360,"column":6},"end":{"line":360,"column":94}},"231":{"start":{"line":362,"column":6},"end":{"line":367,"column":9}},"232":{"start":{"line":363,"column":8},"end":{"line":366,"column":9}},"233":{"start":{"line":364,"column":10},"end":{"line":364,"column":57}},"234":{"start":{"line":365,"column":10},"end":{"line":365,"column":17}},"235":{"start":{"line":368,"column":6},"end":{"line":370,"column":9}},"236":{"start":{"line":369,"column":8},"end":{"line":369,"column":57}},"237":{"start":{"line":375,"column":0},"end":{"line":415,"column":2}},"238":{"start":{"line":376,"column":2},"end":{"line":376,"column":21}},"239":{"start":{"line":377,"column":2},"end":{"line":377,"column":17}},"240":{"start":{"line":378,"column":2},"end":{"line":378,"column":18}},"241":{"start":{"line":379,"column":2},"end":{"line":379,"column":51}},"242":{"start":{"line":380,"column":2},"end":{"line":380,"column":48}},"243":{"start":{"line":381,"column":2},"end":{"line":381,"column":36}},"244":{"start":{"line":382,"column":2},"end":{"line":388,"column":5}},"245":{"start":{"line":383,"column":4},"end":{"line":386,"column":5}},"246":{"start":{"line":384,"column":6},"end":{"line":384,"column":71}},"247":{"start":{"line":385,"column":6},"end":{"line":385,"column":13}},"248":{"start":{"line":387,"column":4},"end":{"line":387,"column":42}},"249":{"start":{"line":390,"column":2},"end":{"line":410,"column":4}},"250":{"start":{"line":391,"column":4},"end":{"line":409,"column":9}},"251":{"start":{"line":392,"column":6},"end":{"line":408,"column":9}},"252":{"start":{"line":393,"column":8},"end":{"line":407,"column":9}},"253":{"start":{"line":394,"column":10},"end":{"line":394,"column":29}},"254":{"start":{"line":395,"column":10},"end":{"line":395,"column":23}},"255":{"start":{"line":397,"column":10},"end":{"line":402,"column":13}},"256":{"start":{"line":398,"column":12},"end":{"line":401,"column":13}},"257":{"start":{"line":399,"column":14},"end":{"line":399,"column":33}},"258":{"start":{"line":400,"column":14},"end":{"line":400,"column":27}},"259":{"start":{"line":403,"column":10},"end":{"line":406,"column":13}},"260":{"start":{"line":404,"column":12},"end":{"line":404,"column":31}},"261":{"start":{"line":405,"column":12},"end":{"line":405,"column":25}},"262":{"start":{"line":411,"column":2},"end":{"line":414,"column":3}},"263":{"start":{"line":412,"column":4},"end":{"line":412,"column":32}},"264":{"start":{"line":413,"column":4},"end":{"line":413,"column":18}},"265":{"start":{"line":417,"column":0},"end":{"line":426,"column":2}},"266":{"start":{"line":418,"column":2},"end":{"line":418,"column":19}},"267":{"start":{"line":419,"column":2},"end":{"line":419,"column":22}},"268":{"start":{"line":420,"column":2},"end":{"line":424,"column":3}},"269":{"start":{"line":421,"column":4},"end":{"line":423,"column":5}},"270":{"start":{"line":422,"column":6},"end":{"line":422,"column":18}},"271":{"start":{"line":425,"column":2},"end":{"line":425,"column":14}},"272":{"start":{"line":428,"column":0},"end":{"line":435,"column":2}},"273":{"start":{"line":429,"column":2},"end":{"line":433,"column":3}},"274":{"start":{"line":430,"column":4},"end":{"line":432,"column":5}},"275":{"start":{"line":431,"column":6},"end":{"line":431,"column":19}},"276":{"start":{"line":434,"column":2},"end":{"line":434,"column":14}},"277":{"start":{"line":437,"column":0},"end":{"line":441,"column":2}},"278":{"start":{"line":438,"column":2},"end":{"line":440,"column":3}},"279":{"start":{"line":439,"column":4},"end":{"line":439,"column":18}},"280":{"start":{"line":443,"column":0},"end":{"line":448,"column":2}},"281":{"start":{"line":450,"column":0},"end":{"line":454,"column":2}},"282":{"start":{"line":456,"column":0},"end":{"line":458,"column":2}},"283":{"start":{"line":460,"column":0},"end":{"line":464,"column":2}}},"branchMap":{"1":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":9},"end":{"line":20,"column":13}},{"start":{"line":20,"column":17},"end":{"line":20,"column":19}}]},"2":{"line":27,"type":"switch","locations":[{"start":{"line":28,"column":4},"end":{"line":33,"column":12}},{"start":{"line":34,"column":4},"end":{"line":45,"column":12}},{"start":{"line":46,"column":4},"end":{"line":53,"column":12}},{"start":{"line":54,"column":4},"end":{"line":56,"column":12}},{"start":{"line":57,"column":4},"end":{"line":59,"column":12}},{"start":{"line":60,"column":4},"end":{"line":65,"column":12}},{"start":{"line":66,"column":4},"end":{"line":76,"column":12}},{"start":{"line":77,"column":4},"end":{"line":79,"column":12}}]},"3":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":6},"end":{"line":29,"column":6}},{"start":{"line":29,"column":6},"end":{"line":29,"column":6}}]},"4":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":6},"end":{"line":48,"column":6}},{"start":{"line":48,"column":6},"end":{"line":48,"column":6}}]},"5":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":6},"end":{"line":61,"column":6}},{"start":{"line":61,"column":6},"end":{"line":61,"column":6}}]},"6":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":6},"end":{"line":67,"column":6}},{"start":{"line":67,"column":6},"end":{"line":67,"column":6}}]},"7":{"line":85,"type":"switch","locations":[{"start":{"line":86,"column":4},"end":{"line":88,"column":12}},{"start":{"line":89,"column":4},"end":{"line":91,"column":12}},{"start":{"line":92,"column":4},"end":{"line":94,"column":12}},{"start":{"line":95,"column":4},"end":{"line":97,"column":12}},{"start":{"line":98,"column":4},"end":{"line":100,"column":12}},{"start":{"line":101,"column":4},"end":{"line":103,"column":12}},{"start":{"line":104,"column":4},"end":{"line":106,"column":12}},{"start":{"line":107,"column":4},"end":{"line":109,"column":12}},{"start":{"line":110,"column":4},"end":{"line":112,"column":12}}]},"8":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":4},"end":{"line":121,"column":4}},{"start":{"line":121,"column":4},"end":{"line":121,"column":4}}]},"9":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":8},"end":{"line":133,"column":8}},{"start":{"line":133,"column":8},"end":{"line":133,"column":8}}]},"10":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":2},"end":{"line":150,"column":2}},{"start":{"line":150,"column":2},"end":{"line":150,"column":2}}]},"11":{"line":155,"type":"if","locations":[{"start":{"line":155,"column":6},"end":{"line":155,"column":6}},{"start":{"line":155,"column":6},"end":{"line":155,"column":6}}]},"12":{"line":183,"type":"if","locations":[{"start":{"line":183,"column":2},"end":{"line":183,"column":2}},{"start":{"line":183,"column":2},"end":{"line":183,"column":2}}]},"13":{"line":183,"type":"binary-expr","locations":[{"start":{"line":183,"column":5},"end":{"line":183,"column":22}},{"start":{"line":183,"column":26},"end":{"line":183,"column":32}}]},"14":{"line":185,"type":"if","locations":[{"start":{"line":185,"column":4},"end":{"line":185,"column":4}},{"start":{"line":185,"column":4},"end":{"line":185,"column":4}}]},"15":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":9},"end":{"line":192,"column":9}},{"start":{"line":192,"column":9},"end":{"line":192,"column":9}}]},"16":{"line":200,"type":"if","locations":[{"start":{"line":200,"column":4},"end":{"line":200,"column":4}},{"start":{"line":200,"column":4},"end":{"line":200,"column":4}}]},"17":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":8},"end":{"line":210,"column":8}},{"start":{"line":210,"column":8},"end":{"line":210,"column":8}}]},"18":{"line":216,"type":"if","locations":[{"start":{"line":216,"column":10},"end":{"line":216,"column":10}},{"start":{"line":216,"column":10},"end":{"line":216,"column":10}}]},"19":{"line":253,"type":"if","locations":[{"start":{"line":253,"column":2},"end":{"line":253,"column":2}},{"start":{"line":253,"column":2},"end":{"line":253,"column":2}}]},"20":{"line":274,"type":"if","locations":[{"start":{"line":274,"column":4},"end":{"line":274,"column":4}},{"start":{"line":274,"column":4},"end":{"line":274,"column":4}}]},"21":{"line":286,"type":"if","locations":[{"start":{"line":286,"column":2},"end":{"line":286,"column":2}},{"start":{"line":286,"column":2},"end":{"line":286,"column":2}}]},"22":{"line":286,"type":"binary-expr","locations":[{"start":{"line":286,"column":6},"end":{"line":286,"column":18}},{"start":{"line":286,"column":22},"end":{"line":286,"column":40}}]},"23":{"line":291,"type":"binary-expr","locations":[{"start":{"line":291,"column":10},"end":{"line":291,"column":21}},{"start":{"line":291,"column":25},"end":{"line":291,"column":42}}]},"24":{"line":294,"type":"if","locations":[{"start":{"line":294,"column":2},"end":{"line":294,"column":2}},{"start":{"line":294,"column":2},"end":{"line":294,"column":2}}]},"25":{"line":299,"type":"if","locations":[{"start":{"line":299,"column":4},"end":{"line":299,"column":4}},{"start":{"line":299,"column":4},"end":{"line":299,"column":4}}]},"26":{"line":299,"type":"binary-expr","locations":[{"start":{"line":299,"column":8},"end":{"line":299,"column":14}},{"start":{"line":299,"column":18},"end":{"line":299,"column":24}}]},"27":{"line":304,"type":"if","locations":[{"start":{"line":304,"column":8},"end":{"line":304,"column":8}},{"start":{"line":304,"column":8},"end":{"line":304,"column":8}}]},"28":{"line":304,"type":"binary-expr","locations":[{"start":{"line":304,"column":12},"end":{"line":304,"column":18}},{"start":{"line":304,"column":22},"end":{"line":304,"column":28}}]},"29":{"line":318,"type":"if","locations":[{"start":{"line":318,"column":4},"end":{"line":318,"column":4}},{"start":{"line":318,"column":4},"end":{"line":318,"column":4}}]},"30":{"line":324,"type":"if","locations":[{"start":{"line":324,"column":4},"end":{"line":324,"column":4}},{"start":{"line":324,"column":4},"end":{"line":324,"column":4}}]},"31":{"line":333,"type":"if","locations":[{"start":{"line":333,"column":2},"end":{"line":333,"column":2}},{"start":{"line":333,"column":2},"end":{"line":333,"column":2}}]},"32":{"line":333,"type":"binary-expr","locations":[{"start":{"line":333,"column":5},"end":{"line":333,"column":18}},{"start":{"line":333,"column":23},"end":{"line":333,"column":36}},{"start":{"line":333,"column":40},"end":{"line":333,"column":55}}]},"33":{"line":334,"type":"if","locations":[{"start":{"line":334,"column":4},"end":{"line":334,"column":4}},{"start":{"line":334,"column":4},"end":{"line":334,"column":4}}]},"34":{"line":350,"type":"if","locations":[{"start":{"line":350,"column":2},"end":{"line":350,"column":2}},{"start":{"line":350,"column":2},"end":{"line":350,"column":2}}]},"35":{"line":359,"type":"if","locations":[{"start":{"line":359,"column":4},"end":{"line":359,"column":4}},{"start":{"line":359,"column":4},"end":{"line":359,"column":4}}]},"36":{"line":363,"type":"if","locations":[{"start":{"line":363,"column":8},"end":{"line":363,"column":8}},{"start":{"line":363,"column":8},"end":{"line":363,"column":8}}]},"37":{"line":383,"type":"if","locations":[{"start":{"line":383,"column":4},"end":{"line":383,"column":4}},{"start":{"line":383,"column":4},"end":{"line":383,"column":4}}]},"38":{"line":393,"type":"if","locations":[{"start":{"line":393,"column":8},"end":{"line":393,"column":8}},{"start":{"line":393,"column":8},"end":{"line":393,"column":8}}]},"39":{"line":398,"type":"if","locations":[{"start":{"line":398,"column":12},"end":{"line":398,"column":12}},{"start":{"line":398,"column":12},"end":{"line":398,"column":12}}]},"40":{"line":421,"type":"if","locations":[{"start":{"line":421,"column":4},"end":{"line":421,"column":4}},{"start":{"line":421,"column":4},"end":{"line":421,"column":4}}]},"41":{"line":430,"type":"if","locations":[{"start":{"line":430,"column":4},"end":{"line":430,"column":4}},{"start":{"line":430,"column":4},"end":{"line":430,"column":4}}]}},"code":["/*!"," * Pomelo -- consoleModule serverStop stop/kill"," * Copyright(c) 2012 fantasyni <fantasyni@163.com>"," * MIT Licensed"," */","var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var countDownLatch = require('../util/countDownLatch');","var utils = require('../util/utils');","var Constants = require('../util/constants');","var starter = require('../master/starter');","var exec = require('child_process').exec;","","module.exports = function(opts) {","  return new Module(opts);","};","","module.exports.moduleId = '__console__';","","var Module = function(opts) {","  opts = opts || {};","  this.app = opts.app;","  this.starter = opts.starter;","};","","Module.prototype.monitorHandler = function(agent, msg, cb) {","  var serverId = agent.id;","  switch(msg.signal) {","    case 'stop':","      if(agent.type === Constants.RESERVED.MASTER) {","        return;","      }","      this.app.stop(true);","      break;","    case 'list':","      var serverType = agent.type;","      var pid = process.pid;","      var heapUsed = (process.memoryUsage().heapUsed/(1024 * 1024)).toFixed(2);","      var rss = (process.memoryUsage().rss/(1024 * 1024)).toFixed(2);","      var heapTotal = (process.memoryUsage().heapTotal/(1024 * 1024)).toFixed(2);","      var uptime = (process.uptime()/60).toFixed(2);","      utils.invokeCallback(cb, {","        serverId: serverId,","        body: {serverId:serverId, serverType: serverType, pid:pid, rss: rss, heapTotal: heapTotal, heapUsed:heapUsed, uptime:uptime}","      });","      break;","    case 'kill':","      utils.invokeCallback(cb, serverId);","      if (agent.type !== 'master') {","        setTimeout(function() {","          process.exit(-1);","        }, Constants.TIME.TIME_WAIT_MONITOR_KILL);","      }","      break;","    case 'addCron':","      this.app.addCrons([msg.cron]);","      break;","    case 'removeCron':","      this.app.removeCrons([msg.cron]);","      break;","    case 'blacklist':","      if(this.app.isFrontend()) {","        var connector = this.app.components.__connector__;","        connector.blacklist = connector.blacklist.concat(msg.blacklist);","      }","      break;","    case 'restart':","      if(agent.type === Constants.RESERVED.MASTER) {","        return;","      }","      var self = this;","      var server = this.app.get(Constants.RESERVED.CURRENT_SERVER);","      utils.invokeCallback(cb, server);","      process.nextTick(function() {","        self.app.stop(true);","      });","      break;","    default:","      logger.error('receive error signal: %j', msg);","      break;","  }","};","","Module.prototype.clientHandler = function(agent, msg, cb) {","  var app = this.app;","  switch(msg.signal) {","    case 'kill':","      kill(app, agent, msg, cb);","      break;","    case 'stop':","      stop(app, agent, msg, cb);","      break;","    case 'list':","      list(agent, msg, cb);","      break;","    case 'add':","      add(app, msg, cb);","      break;","    case 'addCron':","      addCron(app, agent, msg, cb);","      break;","    case 'removeCron':","      removeCron(app, agent, msg, cb);","      break;","    case 'blacklist':","      blacklist(agent, msg, cb);","      break;","    case 'restart':","      restart(app, agent, msg, cb);","      break;","    default:","      utils.invokeCallback(cb, new Error('The command cannot be recognized, please check.'), null);","      break;","  }","};","","var kill = function(app, agent, msg, cb) {","  var sid, record;","  var serverIds = [];","  var count = utils.size(agent.idMap);","  var latch = countDownLatch.createCountDownLatch(count, {timeout: Constants.TIME.TIME_WAIT_MASTER_KILL}, function(isTimeout) {","    if (!isTimeout) {","      utils.invokeCallback(cb, null, {code: 'ok'});","    } else {","      utils.invokeCallback(cb, null, {code: 'remained', serverIds: serverIds});","    }","    setTimeout(function() {","      process.exit(-1);","    }, Constants.TIME.TIME_WAIT_MONITOR_KILL);","  });","","  var agentRequestCallback = function(msg) {","      for (var i = 0; i < serverIds.length; ++i) {","        if (serverIds[i] === msg) {","          serverIds.splice(i,1);","          latch.done();","          break;","        }","      }","  };","","  for(sid in agent.idMap) {","    record = agent.idMap[sid];","    serverIds.push(record.id);","    agent.request(record.id, module.exports.moduleId, { signal: msg.signal }, agentRequestCallback);","  }","};","","var stop = function(app, agent, msg, cb) {","  var serverIds = msg.ids;","  if(!!serverIds.length) {","    var servers = app.getServers();","    app.set(Constants.RESERVED.STOP_SERVERS, serverIds);","    for(var i=0; i<serverIds.length; i++) {","      var serverId = serverIds[i];","      if(!servers[serverId]) {","        utils.invokeCallback(cb, new Error('Cannot find the server to stop.'), null);","      } else {","        agent.notifyById(serverId, module.exports.moduleId, { signal: msg.signal });","      }","    }","    utils.invokeCallback(cb, null, { status: \"part\" });","  } else {","    var servers = app.getServers();","    var serverIds = [];","    for(var i in servers){","        serverIds.push(i)","    }","    app.set(Constants.RESERVED.STOP_SERVERS, serverIds);","    agent.notifyAll(module.exports.moduleId, { signal: msg.signal });","    setTimeout(function() {","      app.stop(true);","      utils.invokeCallback(cb, null, { status: \"all\" });","    }, Constants.TIME.TIME_WAIT_STOP);","  }","};","","var restart = function(app, agent, msg, cb) {","  var successFlag;","  var successIds = [];","  var serverIds = msg.ids;","  var type = msg.type;","  var servers;","  if(!serverIds.length && !!type) {","    servers = app.getServersByType(type);","    if(!servers) {","      utils.invokeCallback(cb, new Error('restart servers with unknown server type: ' + type));","      return;","    }","    for(var i=0; i<servers.length; i++) {","      serverIds.push(servers[i].id);","    }","  } else if(!serverIds.length) {","    servers = app.getServers();","    for(var key in servers) {","      serverIds.push(key);","    }","  }  ","  var count = serverIds.length;","  var latch = countDownLatch.createCountDownLatch(count, {timeout: Constants.TIME.TIME_WAIT_COUNTDOWN}, function() {","    if(!successFlag) {","      utils.invokeCallback(cb, new Error('all servers start failed.'));","      return;","    }","    utils.invokeCallback(cb, null, utils.arrayDiff(serverIds, successIds));","  });","","  var request = function(id) {","    return (function() {","      agent.request(id, module.exports.moduleId, { signal: msg.signal }, function(msg) {","        if(!utils.size(msg)) {","          latch.done();","          return;","        }","        setTimeout(function() {","         runServer(app, msg, function(err, status) {","          if(!!err) {","            logger.error('restart ' + id + ' failed.');","          } else {","            successIds.push(id);","            successFlag = true;","          }","          latch.done();","        });","       }, Constants.TIME.TIME_WAIT_RESTART);","      });","    })();","  };","","  for(var j=0; j<serverIds.length; j++) {","    request(serverIds[j]);","  }","};","","var list = function(agent, msg, cb) {","  var sid, record;","  var serverInfo = {};","  var count = utils.size(agent.idMap);","  var latch = countDownLatch.createCountDownLatch(count, {timeout: Constants.TIME.TIME_WAIT_COUNTDOWN}, function() {","    utils.invokeCallback(cb, null, { msg: serverInfo });","  });","","  var callback = function(msg) {","    serverInfo[msg.serverId] = msg.body;","    latch.done();","  };","  for(sid in agent.idMap) {","    record = agent.idMap[sid];","    agent.request(record.id, module.exports.moduleId, { signal: msg.signal }, callback);","  }","};","","var add = function(app, msg, cb) {","  if(checkCluster(msg)) {","    startCluster(app, msg, cb);","  } else {","    startServer(app, msg, cb);","  }","  reset(ServerInfo);","};","","var addCron = function(app, agent, msg, cb) {","  var cron = parseArgs(msg, CronInfo, cb);","  sendCronInfo(cron, agent, msg, CronInfo, cb);","};","","var removeCron = function(app, agent, msg, cb) {","  var cron = parseArgs(msg, RemoveCron, cb);","  sendCronInfo(cron, agent, msg, RemoveCron, cb);","};","","var blacklist = function(agent, msg, cb) {","  var ips = msg.args;","  for(var i=0; i<ips.length; i++) {","    if(!(new RegExp(/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)/g).test(ips[i]))) {","      utils.invokeCallback(cb, new Error('blacklist ip: ' + ips[i] + ' is error format.'), null);","      return;","    }","  }","  agent.notifyAll(module.exports.moduleId, { signal: msg.signal, blacklist: msg.args });","  process.nextTick(function() {","    cb(null, { status: \"ok\" });","  });","};","","var checkPort = function(server, cb) {","  if (!server.port && !server.clientPort) {","    utils.invokeCallback(cb, 'leisure');","    return;","  }","","  var p = server.port || server.clientPort;","  var host = server.host;","  var cmd = 'netstat -tln | grep ';","  if (!utils.isLocal(host)) {","    cmd = 'ssh ' + host + ' ' + cmd;","  }","","  exec(cmd + p, function(err, stdout, stderr) {","    if (stdout || stderr) {","      utils.invokeCallback(cb, 'busy');","    } else {","      p = server.clientPort;","      exec(cmd + p, function(err, stdout, stderr) {","        if (stdout || stderr) {","          utils.invokeCallback(cb, 'busy');","        } else {","          utils.invokeCallback(cb, 'leisure');","        }","      });","    }","  });","};","","var parseArgs = function(msg, info, cb) {","  var rs = {};","  var args = msg.args;","  for(var i =0; i<args.length; i++) {","    if(args[i].indexOf('=') < 0) {","      cb(new Error('Error server parameters format.'), null);","      return;","    }","    var pairs = args[i].split('=');","    var key = pairs[0];","    if(!!info[key]) {","      info[key] = 1;","    }","    rs[pairs[0]] = pairs[1];","  }","  return rs;","};","","var sendCronInfo = function(cron, agent, msg, info, cb) {","  if(isReady(info) && (cron.serverId || cron.serverType)) {","    if(!!cron.serverId) {","      agent.notifyById(cron.serverId, module.exports.moduleId, { signal: msg.signal, cron: cron });","    } else {","      agent.notifyByType(cron.serverType, module.exports.moduleId, { signal: msg.signal, cron: cron });","    }","    process.nextTick(function() {","      cb(null, { status: \"ok\" });","    });","  } else {","    cb(new Error('Miss necessary server parameters.'), null);","  }","  reset(info);","};","","var startServer = function(app, msg, cb) {","  var server = parseArgs(msg, ServerInfo, cb);","  if(isReady(ServerInfo)) {","    runServer(app, server, cb);","  } else {","    cb(new Error('Miss necessary server parameters.'), null);","  }","};","","var runServer = function(app, server, cb) {","  checkPort(server, function(status) {","    if(status === 'busy') {","      utils.invokeCallback(cb, new Error('Port occupied already, check your server to add.'));","    } else {","      starter.run(app, server, function(err) {","        if(err) {","          utils.invokeCallback(cb, new Error(err), null);","          return;","        }","      });","      process.nextTick(function() {","        utils.invokeCallback(cb, null, { status: \"ok\" });","      });","    }","  });","};","","var startCluster = function(app, msg, cb) {","  var serverMap = {};","  var fails = [];","  var successFlag;","  var serverInfo = parseArgs(msg, ClusterInfo, cb);","  utils.loadCluster(app, serverInfo, serverMap);","  var count = utils.size(serverMap);","  var latch = countDownLatch.createCountDownLatch(count, function() {","    if(!successFlag) {","      utils.invokeCallback(cb, new Error('all servers start failed.'));","      return;","    }","    utils.invokeCallback(cb, null, fails);","  });","","  var start = function(server) {","    return (function() {","      checkPort(server, function(status) {","        if(status === 'busy') {","          fails.push(server);","          latch.done();","        } else {","          starter.run(app, server, function(err) {","            if(err) {","              fails.push(server);","              latch.done();","            }","          });","          process.nextTick(function() {","            successFlag = true;","            latch.done();","          });","        }","      });","    })();","  };","  for(var key in serverMap) {","    var server = serverMap[key];","    start(server);","  }","};","","var checkCluster = function(msg) {","  var flag = false;","  var args = msg.args;","  for(var i=0; i < args.length; i++) {","    if(utils.startsWith(args[i], Constants.RESERVED.CLUSTER_COUNT)) {","      flag = true;","    }","  }","  return flag;","};","","var isReady = function(info) {","  for(var key in info) {","    if(info[key]) {","      return false;","    }","  }","  return true;","};","","var reset = function(info) {","  for(var key in info) {","    info[key] = 0;","  }","};","","var ServerInfo = {","  host: 0,","  port: 0,","  id:   0,","  serverType: 0","};","","var CronInfo = {","  id: 0,","  action: 0,","  time: 0","};","","var RemoveCron = {","  id: 0","};","","var ClusterInfo = {","  host: 0,","  port: 0,","  clusterCount: 0","};"],"l":{"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"13":1,"14":0,"17":1,"19":1,"20":0,"21":0,"22":0,"25":1,"26":0,"27":0,"29":0,"30":0,"32":0,"33":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"45":0,"47":0,"48":0,"49":0,"50":0,"53":0,"55":0,"56":0,"58":0,"59":0,"61":0,"62":0,"63":0,"65":0,"67":0,"68":0,"70":0,"71":0,"72":0,"73":0,"74":0,"76":0,"78":0,"79":0,"83":1,"84":0,"85":0,"87":0,"88":0,"90":0,"91":0,"93":0,"94":0,"96":0,"97":0,"99":0,"100":0,"102":0,"103":0,"105":0,"106":0,"108":0,"109":0,"111":0,"112":0,"116":1,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"124":0,"126":0,"127":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"141":0,"142":0,"143":0,"144":0,"148":1,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"158":0,"161":0,"163":0,"164":0,"165":0,"166":0,"168":0,"169":0,"170":0,"171":0,"172":0,"177":1,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"189":0,"190":0,"192":0,"193":0,"194":0,"195":0,"198":0,"199":0,"200":0,"201":0,"202":0,"204":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"214":0,"215":0,"216":0,"217":0,"219":0,"220":0,"222":0,"229":0,"230":0,"234":1,"235":0,"236":0,"237":0,"238":0,"239":0,"242":0,"243":0,"244":0,"246":0,"247":0,"248":0,"252":1,"253":0,"254":0,"256":0,"258":0,"261":1,"262":0,"263":0,"266":1,"267":0,"268":0,"271":1,"272":0,"273":0,"274":0,"275":0,"276":0,"279":0,"280":0,"281":0,"285":1,"286":0,"287":0,"288":0,"291":0,"292":0,"293":0,"294":0,"295":0,"298":0,"299":0,"300":0,"302":0,"303":0,"304":0,"305":0,"307":0,"314":1,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"322":0,"323":0,"324":0,"325":0,"327":0,"329":0,"332":1,"333":0,"334":0,"335":0,"337":0,"339":0,"340":0,"343":0,"345":0,"348":1,"349":0,"350":0,"351":0,"353":0,"357":1,"358":0,"359":0,"360":0,"362":0,"363":0,"364":0,"365":0,"368":0,"369":0,"375":1,"376":0,"377":0,"378":0,"379":0,"380":0,"381":0,"382":0,"383":0,"384":0,"385":0,"387":0,"390":0,"391":0,"392":0,"393":0,"394":0,"395":0,"397":0,"398":0,"399":0,"400":0,"403":0,"404":0,"405":0,"411":0,"412":0,"413":0,"417":1,"418":0,"419":0,"420":0,"421":0,"422":0,"425":0,"428":1,"429":0,"430":0,"431":0,"434":0,"437":1,"438":0,"439":0,"443":1,"450":1,"456":1,"460":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/modules/masterwatcher.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/modules/masterwatcher.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":0,"59":1,"60":0,"61":0,"62":0,"63":0,"64":1},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":6,"loc":{"start":{"line":6,"column":17},"end":{"line":6,"column":48}}},"2":{"name":"(anonymous_2)","line":12,"loc":{"start":{"line":12,"column":13},"end":{"line":12,"column":44}}},"3":{"name":"(anonymous_3)","line":25,"loc":{"start":{"line":25,"column":18},"end":{"line":25,"column":43}}},"4":{"name":"(anonymous_4)","line":33,"loc":{"start":{"line":33,"column":24},"end":{"line":33,"column":49}}},"5":{"name":"(anonymous_5)","line":42,"loc":{"start":{"line":42,"column":20},"end":{"line":42,"column":47}}},"6":{"name":"(anonymous_6)","line":55,"loc":{"start":{"line":55,"column":25},"end":{"line":55,"column":38}}},"7":{"name":"(anonymous_7)","line":59,"loc":{"start":{"line":59,"column":33},"end":{"line":59,"column":58}}},"8":{"name":"(anonymous_8)","line":74,"loc":{"start":{"line":74,"column":16},"end":{"line":74,"column":49}}},"9":{"name":"(anonymous_9)","line":84,"loc":{"start":{"line":84,"column":18},"end":{"line":84,"column":51}}},"10":{"name":"(anonymous_10)","line":93,"loc":{"start":{"line":93,"column":12},"end":{"line":93,"column":45}}},"11":{"name":"(anonymous_11)","line":97,"loc":{"start":{"line":97,"column":13},"end":{"line":97,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":70}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":51}},"5":{"start":{"line":6,"column":0},"end":{"line":8,"column":2}},"6":{"start":{"line":7,"column":2},"end":{"line":7,"column":42}},"7":{"start":{"line":10,"column":0},"end":{"line":10,"column":60}},"8":{"start":{"line":12,"column":0},"end":{"line":21,"column":2}},"9":{"start":{"line":13,"column":2},"end":{"line":13,"column":22}},"10":{"start":{"line":14,"column":2},"end":{"line":14,"column":32}},"11":{"start":{"line":15,"column":2},"end":{"line":15,"column":35}},"12":{"start":{"line":17,"column":2},"end":{"line":17,"column":61}},"13":{"start":{"line":18,"column":2},"end":{"line":18,"column":60}},"14":{"start":{"line":19,"column":2},"end":{"line":19,"column":64}},"15":{"start":{"line":20,"column":2},"end":{"line":20,"column":67}},"16":{"start":{"line":25,"column":0},"end":{"line":31,"column":2}},"17":{"start":{"line":26,"column":2},"end":{"line":26,"column":82}},"18":{"start":{"line":27,"column":2},"end":{"line":29,"column":3}},"19":{"start":{"line":28,"column":4},"end":{"line":28,"column":11}},"20":{"start":{"line":30,"column":2},"end":{"line":30,"column":36}},"21":{"start":{"line":33,"column":0},"end":{"line":40,"column":2}},"22":{"start":{"line":34,"column":2},"end":{"line":34,"column":88}},"23":{"start":{"line":35,"column":2},"end":{"line":38,"column":3}},"24":{"start":{"line":36,"column":4},"end":{"line":36,"column":71}},"25":{"start":{"line":37,"column":4},"end":{"line":37,"column":11}},"26":{"start":{"line":39,"column":2},"end":{"line":39,"column":42}},"27":{"start":{"line":42,"column":0},"end":{"line":51,"column":2}},"28":{"start":{"line":43,"column":2},"end":{"line":43,"column":97}},"29":{"start":{"line":44,"column":2},"end":{"line":47,"column":3}},"30":{"start":{"line":45,"column":4},"end":{"line":45,"column":61}},"31":{"start":{"line":46,"column":4},"end":{"line":46,"column":11}},"32":{"start":{"line":48,"column":2},"end":{"line":50,"column":3}},"33":{"start":{"line":49,"column":4},"end":{"line":49,"column":37}},"34":{"start":{"line":55,"column":0},"end":{"line":57,"column":2}},"35":{"start":{"line":56,"column":2},"end":{"line":56,"column":27}},"36":{"start":{"line":59,"column":0},"end":{"line":70,"column":2}},"37":{"start":{"line":60,"column":2},"end":{"line":63,"column":3}},"38":{"start":{"line":61,"column":4},"end":{"line":61,"column":56}},"39":{"start":{"line":62,"column":4},"end":{"line":62,"column":11}},"40":{"start":{"line":64,"column":2},"end":{"line":64,"column":39}},"41":{"start":{"line":65,"column":2},"end":{"line":68,"column":3}},"42":{"start":{"line":66,"column":4},"end":{"line":66,"column":64}},"43":{"start":{"line":67,"column":4},"end":{"line":67,"column":11}},"44":{"start":{"line":69,"column":2},"end":{"line":69,"column":29}},"45":{"start":{"line":74,"column":0},"end":{"line":82,"column":2}},"46":{"start":{"line":75,"column":2},"end":{"line":78,"column":3}},"47":{"start":{"line":76,"column":4},"end":{"line":76,"column":82}},"48":{"start":{"line":77,"column":4},"end":{"line":77,"column":11}},"49":{"start":{"line":80,"column":2},"end":{"line":80,"column":36}},"50":{"start":{"line":81,"column":2},"end":{"line":81,"column":58}},"51":{"start":{"line":84,"column":0},"end":{"line":91,"column":2}},"52":{"start":{"line":85,"column":2},"end":{"line":88,"column":3}},"53":{"start":{"line":86,"column":4},"end":{"line":86,"column":84}},"54":{"start":{"line":87,"column":4},"end":{"line":87,"column":11}},"55":{"start":{"line":89,"column":2},"end":{"line":89,"column":38}},"56":{"start":{"line":90,"column":2},"end":{"line":90,"column":27}},"57":{"start":{"line":93,"column":0},"end":{"line":95,"column":2}},"58":{"start":{"line":94,"column":2},"end":{"line":94,"column":58}},"59":{"start":{"line":97,"column":0},"end":{"line":103,"column":2}},"60":{"start":{"line":98,"column":2},"end":{"line":101,"column":3}},"61":{"start":{"line":99,"column":4},"end":{"line":99,"column":79}},"62":{"start":{"line":100,"column":4},"end":{"line":100,"column":11}},"63":{"start":{"line":102,"column":2},"end":{"line":102,"column":33}},"64":{"start":{"line":105,"column":0},"end":{"line":110,"column":2}}},"branchMap":{"1":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":2},"end":{"line":27,"column":2}},{"start":{"line":27,"column":2},"end":{"line":27,"column":2}}]},"2":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":5},"end":{"line":27,"column":12}},{"start":{"line":27,"column":16},"end":{"line":27,"column":40}},{"start":{"line":27,"column":44},"end":{"line":27,"column":62}}]},"3":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":35,"column":2}},{"start":{"line":35,"column":2},"end":{"line":35,"column":2}}]},"4":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":5},"end":{"line":35,"column":12}},{"start":{"line":35,"column":16},"end":{"line":35,"column":40}},{"start":{"line":35,"column":44},"end":{"line":35,"column":62}}]},"5":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":2},"end":{"line":44,"column":2}},{"start":{"line":44,"column":2},"end":{"line":44,"column":2}}]},"6":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":48,"column":2}},{"start":{"line":48,"column":2},"end":{"line":48,"column":2}}]},"7":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":2},"end":{"line":60,"column":2}},{"start":{"line":60,"column":2},"end":{"line":60,"column":2}}]},"8":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":2},"end":{"line":65,"column":2}},{"start":{"line":65,"column":2},"end":{"line":65,"column":2}}]},"9":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":2},"end":{"line":75,"column":2}},{"start":{"line":75,"column":2},"end":{"line":75,"column":2}}]},"10":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":2},"end":{"line":85,"column":2}},{"start":{"line":85,"column":2},"end":{"line":85,"column":2}}]},"11":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":2},"end":{"line":98,"column":2}},{"start":{"line":98,"column":2},"end":{"line":98,"column":2}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var utils = require('../util/utils');","var Constants = require('../util/constants');","var MasterWatchdog = require('../master/watchdog');","","module.exports = function(opts, consoleService) {","  return new Module(opts, consoleService);","};","","module.exports.moduleId = Constants.KEYWORDS.MASTER_WATCHER;","","var Module = function(opts, consoleService) {","  this.app = opts.app;","  this.service = consoleService;","  this.id = this.app.getServerId();","","  this.watchdog = new MasterWatchdog(this.app, this.service);","  this.service.on('register', onServerAdd.bind(null, this));","  this.service.on('disconnect', onServerLeave.bind(null, this));","  this.service.on('reconnect', onServerReconnect.bind(null, this));","};","","// ----------------- bind methods -------------------------","","var onServerAdd = function(module, record) {","  logger.debug('masterwatcher receive add server event, with server: %j', record);","  if(!record || record.type === 'client' || !record.serverType) {","    return;","  }","  module.watchdog.addServer(record);","};","","var onServerReconnect = function(module, record) {","  logger.debug('masterwatcher receive reconnect server event, with server: %j', record);","  if(!record || record.type === 'client' || !record.serverType) {","    logger.warn('onServerReconnect receive wrong message: %j', record);","    return;","  }","  module.watchdog.reconnectServer(record);","};","","var onServerLeave = function(module, id, type) {","  logger.debug('masterwatcher receive remove server event, with server: %s, type: %s', id, type);","  if(!id) {","    logger.warn('onServerLeave receive server id is empty.');","    return;","  }","  if(type !== 'client') {","    module.watchdog.removeServer(id);","  }","};","","// ----------------- module methods -------------------------","","Module.prototype.start = function(cb) {","  utils.invokeCallback(cb);","};","","Module.prototype.masterHandler = function(agent, msg, cb) {","  if(!msg) {","    logger.warn('masterwatcher receive empty message.');","    return;","  }","  var func = masterMethods[msg.action];","  if(!func) {","    logger.info('masterwatcher unknown action: %j', msg.action);","    return;","  }","  func(this, agent, msg, cb);","};","","// ----------------- monitor request methods -------------------------","","var subscribe = function(module, agent, msg, cb) {","  if(!msg) {","    utils.invokeCallback(cb, new Error('masterwatcher subscribe empty message.'));","    return;","  }","","  module.watchdog.subscribe(msg.id);","  utils.invokeCallback(cb, null, module.watchdog.query());","};","","var unsubscribe = function(module, agent, msg, cb) {","  if(!msg) {","    utils.invokeCallback(cb, new Error('masterwatcher unsubscribe empty message.'));","    return;","  }","  module.watchdog.unsubscribe(msg.id);","  utils.invokeCallback(cb);","};","","var query = function(module, agent, msg, cb) {","  utils.invokeCallback(cb, null, module.watchdog.query());","};","","var record = function(module, agent, msg) {","  if(!msg) {","    utils.invokeCallback(cb, new Error('masterwatcher record empty message.'));","    return;","  }","  module.watchdog.record(msg.id);","};","","var masterMethods = {","  'subscribe': subscribe,","  'unsubscribe': unsubscribe,","  'query': query,","  'record': record","};"],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"7":0,"10":1,"12":1,"13":0,"14":0,"15":0,"17":0,"18":0,"19":0,"20":0,"25":1,"26":0,"27":0,"28":0,"30":0,"33":1,"34":0,"35":0,"36":0,"37":0,"39":0,"42":1,"43":0,"44":0,"45":0,"46":0,"48":0,"49":0,"55":1,"56":0,"59":1,"60":0,"61":0,"62":0,"64":0,"65":0,"66":0,"67":0,"69":0,"74":1,"75":0,"76":0,"77":0,"80":0,"81":0,"84":1,"85":0,"86":0,"87":0,"89":0,"90":0,"93":1,"94":0,"97":1,"98":0,"99":0,"100":0,"102":0,"105":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/modules/monitorwatcher.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/lib/modules/monitorwatcher.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":0,"62":0,"63":0,"64":0,"65":1,"66":0,"67":0,"68":0,"69":1,"70":0,"71":0,"72":0,"73":1,"74":0,"75":1,"76":0,"77":0,"78":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":48}}},"2":{"name":"(anonymous_2)","line":13,"loc":{"start":{"line":13,"column":13},"end":{"line":13,"column":44}}},"3":{"name":"(anonymous_3)","line":21,"loc":{"start":{"line":21,"column":25},"end":{"line":21,"column":38}}},"4":{"name":"(anonymous_4)","line":25,"loc":{"start":{"line":25,"column":34},"end":{"line":25,"column":59}}},"5":{"name":"(anonymous_5)","line":39,"loc":{"start":{"line":39,"column":23},"end":{"line":39,"column":53}}},"6":{"name":"(anonymous_6)","line":41,"loc":{"start":{"line":41,"column":56},"end":{"line":41,"column":79}}},"7":{"name":"(anonymous_7)","line":57,"loc":{"start":{"line":57,"column":16},"end":{"line":57,"column":47}}},"8":{"name":"(anonymous_8)","line":68,"loc":{"start":{"line":68,"column":19},"end":{"line":68,"column":50}}},"9":{"name":"(anonymous_9)","line":79,"loc":{"start":{"line":79,"column":20},"end":{"line":79,"column":51}}},"10":{"name":"(anonymous_10)","line":90,"loc":{"start":{"line":90,"column":16},"end":{"line":90,"column":47}}},"11":{"name":"(anonymous_11)","line":101,"loc":{"start":{"line":101,"column":17},"end":{"line":101,"column":41}}},"12":{"name":"(anonymous_12)","line":108,"loc":{"start":{"line":108,"column":20},"end":{"line":108,"column":40}}},"13":{"name":"(anonymous_13)","line":115,"loc":{"start":{"line":115,"column":21},"end":{"line":115,"column":45}}},"14":{"name":"(anonymous_14)","line":121,"loc":{"start":{"line":121,"column":18},"end":{"line":121,"column":37}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":70}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":37}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":45}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":27}},"6":{"start":{"line":7,"column":0},"end":{"line":9,"column":2}},"7":{"start":{"line":8,"column":2},"end":{"line":8,"column":42}},"8":{"start":{"line":11,"column":0},"end":{"line":11,"column":61}},"9":{"start":{"line":13,"column":0},"end":{"line":19,"column":2}},"10":{"start":{"line":14,"column":2},"end":{"line":14,"column":22}},"11":{"start":{"line":15,"column":2},"end":{"line":15,"column":32}},"12":{"start":{"line":16,"column":2},"end":{"line":16,"column":35}},"13":{"start":{"line":18,"column":2},"end":{"line":18,"column":71}},"14":{"start":{"line":21,"column":0},"end":{"line":23,"column":2}},"15":{"start":{"line":22,"column":2},"end":{"line":22,"column":58}},"16":{"start":{"line":25,"column":0},"end":{"line":35,"column":2}},"17":{"start":{"line":26,"column":2},"end":{"line":28,"column":3}},"18":{"start":{"line":27,"column":4},"end":{"line":27,"column":11}},"19":{"start":{"line":29,"column":2},"end":{"line":29,"column":40}},"20":{"start":{"line":30,"column":2},"end":{"line":33,"column":3}},"21":{"start":{"line":31,"column":4},"end":{"line":31,"column":65}},"22":{"start":{"line":32,"column":4},"end":{"line":32,"column":11}},"23":{"start":{"line":34,"column":2},"end":{"line":34,"column":29}},"24":{"start":{"line":39,"column":0},"end":{"line":53,"column":2}},"25":{"start":{"line":40,"column":2},"end":{"line":40,"column":42}},"26":{"start":{"line":41,"column":2},"end":{"line":52,"column":5}},"27":{"start":{"line":42,"column":4},"end":{"line":45,"column":5}},"28":{"start":{"line":43,"column":6},"end":{"line":43,"column":83}},"29":{"start":{"line":44,"column":6},"end":{"line":44,"column":36}},"30":{"start":{"line":46,"column":4},"end":{"line":46,"column":17}},"31":{"start":{"line":47,"column":4},"end":{"line":49,"column":5}},"32":{"start":{"line":48,"column":6},"end":{"line":48,"column":28}},"33":{"start":{"line":50,"column":4},"end":{"line":50,"column":26}},"34":{"start":{"line":51,"column":4},"end":{"line":51,"column":29}},"35":{"start":{"line":57,"column":0},"end":{"line":66,"column":2}},"36":{"start":{"line":58,"column":2},"end":{"line":58,"column":76}},"37":{"start":{"line":59,"column":2},"end":{"line":63,"column":3}},"38":{"start":{"line":60,"column":4},"end":{"line":60,"column":75}},"39":{"start":{"line":61,"column":4},"end":{"line":61,"column":52}},"40":{"start":{"line":62,"column":4},"end":{"line":62,"column":11}},"41":{"start":{"line":64,"column":2},"end":{"line":64,"column":33}},"42":{"start":{"line":65,"column":2},"end":{"line":65,"column":48}},"43":{"start":{"line":68,"column":0},"end":{"line":77,"column":2}},"44":{"start":{"line":69,"column":2},"end":{"line":69,"column":77}},"45":{"start":{"line":70,"column":2},"end":{"line":74,"column":3}},"46":{"start":{"line":71,"column":4},"end":{"line":71,"column":78}},"47":{"start":{"line":72,"column":4},"end":{"line":72,"column":52}},"48":{"start":{"line":73,"column":4},"end":{"line":73,"column":11}},"49":{"start":{"line":75,"column":2},"end":{"line":75,"column":32}},"50":{"start":{"line":76,"column":2},"end":{"line":76,"column":48}},"51":{"start":{"line":79,"column":0},"end":{"line":88,"column":2}},"52":{"start":{"line":80,"column":2},"end":{"line":80,"column":78}},"53":{"start":{"line":81,"column":2},"end":{"line":85,"column":3}},"54":{"start":{"line":82,"column":4},"end":{"line":82,"column":79}},"55":{"start":{"line":83,"column":4},"end":{"line":83,"column":52}},"56":{"start":{"line":84,"column":4},"end":{"line":84,"column":11}},"57":{"start":{"line":86,"column":2},"end":{"line":86,"column":36}},"58":{"start":{"line":87,"column":2},"end":{"line":87,"column":48}},"59":{"start":{"line":90,"column":0},"end":{"line":97,"column":2}},"60":{"start":{"line":91,"column":2},"end":{"line":91,"column":70}},"61":{"start":{"line":92,"column":2},"end":{"line":94,"column":3}},"62":{"start":{"line":93,"column":4},"end":{"line":93,"column":29}},"63":{"start":{"line":95,"column":2},"end":{"line":95,"column":40}},"64":{"start":{"line":96,"column":2},"end":{"line":96,"column":48}},"65":{"start":{"line":101,"column":0},"end":{"line":106,"column":2}},"66":{"start":{"line":102,"column":2},"end":{"line":104,"column":3}},"67":{"start":{"line":103,"column":4},"end":{"line":103,"column":11}},"68":{"start":{"line":105,"column":2},"end":{"line":105,"column":31}},"69":{"start":{"line":108,"column":0},"end":{"line":113,"column":2}},"70":{"start":{"line":109,"column":2},"end":{"line":111,"column":3}},"71":{"start":{"line":110,"column":4},"end":{"line":110,"column":11}},"72":{"start":{"line":112,"column":2},"end":{"line":112,"column":30}},"73":{"start":{"line":115,"column":0},"end":{"line":117,"column":2}},"74":{"start":{"line":116,"column":2},"end":{"line":116,"column":35}},"75":{"start":{"line":121,"column":0},"end":{"line":124,"column":2}},"76":{"start":{"line":122,"column":2},"end":{"line":122,"column":39}},"77":{"start":{"line":123,"column":2},"end":{"line":123,"column":68}},"78":{"start":{"line":126,"column":0},"end":{"line":131,"column":2}}},"branchMap":{"1":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":26,"column":2}},{"start":{"line":26,"column":2},"end":{"line":26,"column":2}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":5},"end":{"line":26,"column":9}},{"start":{"line":26,"column":13},"end":{"line":26,"column":24}}]},"3":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":2},"end":{"line":30,"column":2}},{"start":{"line":30,"column":2},"end":{"line":30,"column":2}}]},"4":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]},"5":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":2},"end":{"line":59,"column":2}},{"start":{"line":59,"column":2},"end":{"line":59,"column":2}}]},"6":{"line":59,"type":"binary-expr","locations":[{"start":{"line":59,"column":5},"end":{"line":59,"column":9}},{"start":{"line":59,"column":13},"end":{"line":59,"column":24}}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":2},"end":{"line":70,"column":2}},{"start":{"line":70,"column":2},"end":{"line":70,"column":2}}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":5},"end":{"line":70,"column":9}},{"start":{"line":70,"column":13},"end":{"line":70,"column":20}}]},"9":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":2},"end":{"line":81,"column":2}},{"start":{"line":81,"column":2},"end":{"line":81,"column":2}}]},"10":{"line":81,"type":"binary-expr","locations":[{"start":{"line":81,"column":5},"end":{"line":81,"column":9}},{"start":{"line":81,"column":13},"end":{"line":81,"column":25}}]},"11":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":2},"end":{"line":92,"column":2}},{"start":{"line":92,"column":2},"end":{"line":92,"column":2}}]},"12":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":2},"end":{"line":102,"column":2}},{"start":{"line":102,"column":2},"end":{"line":102,"column":2}}]},"13":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":5},"end":{"line":102,"column":13}},{"start":{"line":102,"column":17},"end":{"line":102,"column":32}}]},"14":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":2},"end":{"line":109,"column":2}},{"start":{"line":109,"column":2},"end":{"line":109,"column":2}}]},"15":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":5},"end":{"line":109,"column":9}},{"start":{"line":109,"column":13},"end":{"line":109,"column":24}}]}},"code":["var logger = require('pomelo-logger').getLogger('pomelo', __filename);","var utils = require('../util/utils');","var events = require('../util/events');","var Constants = require('../util/constants');","var util = require('util');","","module.exports = function(opts, consoleService) {","  return new Module(opts, consoleService);","};","","module.exports.moduleId = Constants.KEYWORDS.MONITOR_WATCHER;","","var Module = function(opts, consoleService) {","  this.app = opts.app;","  this.service = consoleService;","  this.id = this.app.getServerId();","","  this.app.event.on(events.START_SERVER, finishStart.bind(null, this));","};","","Module.prototype.start = function(cb) {","  subscribeRequest(this, this.service.agent, this.id, cb);","};","","Module.prototype.monitorHandler = function(agent, msg, cb) {","  if(!msg || !msg.action) {","    return;","  }","  var func = monitorMethods[msg.action];","  if(!func) {","    logger.info('monitorwatcher unknown action: %j', msg.action);","    return;","  }","  func(this, agent, msg, cb);","};","","// ----------------- monitor start method -------------------------","","var subscribeRequest = function(self, agent, id, cb) {","  var msg = {action: 'subscribe', id: id};","  agent.request(Constants.KEYWORDS.MASTER_WATCHER, msg, function(err, servers) {","    if(err) {","      logger.error('subscribeRequest request to master with error: %j', err.stack);","      utils.invokeCallback(cb, err);","    }","    var res = [];","    for(var id in servers) {","      res.push(servers[id]);","    }","    addServers(self, res);","    utils.invokeCallback(cb);","  });","};","","// ----------------- monitor request methods -------------------------","","var addServer = function(self, agent, msg, cb) {","  logger.debug('[%s] receive addServer signal: %j', self.app.serverId, msg);","  if(!msg || !msg.server) {","    logger.warn('monitorwatcher addServer receive empty message: %j', msg);","    utils.invokeCallback(cb, Constants.SIGNAL.FAIL);","    return;","  }","  addServers(self, [msg.server]);","  utils.invokeCallback(cb, Constants.SIGNAL.OK);","};","","var removeServer = function(self, agent, msg, cb) {","  logger.debug('%s receive removeServer signal: %j', self.app.serverId, msg);","  if(!msg || !msg.id) {","    logger.warn('monitorwatcher removeServer receive empty message: %j', msg);","    utils.invokeCallback(cb, Constants.SIGNAL.FAIL);","    return;","  }","  removeServers(self, [msg.id]);","  utils.invokeCallback(cb, Constants.SIGNAL.OK);","};","","var replaceServer = function(self, agent, msg, cb) {","  logger.debug('%s receive replaceServer signal: %j', self.app.serverId, msg);","  if(!msg || !msg.servers) {","    logger.warn('monitorwatcher replaceServer receive empty message: %j', msg);","    utils.invokeCallback(cb, Constants.SIGNAL.FAIL);","    return;","  }","  replaceServers(self, msg.servers);","  utils.invokeCallback(cb, Constants.SIGNAL.OK);","};","","var startOver = function(self, agent, msg, cb) {","  var fun = self.app.lifecycleCbs[Constants.LIFECYCLE.AFTER_STARTALL];","  if(!!fun) {","    fun.call(null, self.app);","  }","  self.app.event.emit(events.START_ALL);","  utils.invokeCallback(cb, Constants.SIGNAL.OK);","};","","// ----------------- common methods -------------------------","","var addServers = function(self, servers) {","  if(!servers || !servers.length) {","    return;","  }","  self.app.addServers(servers);","};","","var removeServers = function(self, ids) {","  if(!ids || !ids.length) {","    return;","  }","  self.app.removeServers(ids);","};","","var replaceServers = function(self, servers) {","  self.app.replaceServers(servers);","};","","// ----------------- bind methods -------------------------","","var finishStart = function(self, id) {","  var msg = {action: 'record', id: id};","  self.service.agent.notify(Constants.KEYWORDS.MASTER_WATCHER, msg);","};","","var monitorMethods = {","  'addServer': addServer,","  'removeServer': removeServer,","  'replaceServer': replaceServer,","  'startOver': startOver","};",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"8":0,"11":1,"13":1,"14":0,"15":0,"16":0,"18":0,"21":1,"22":0,"25":1,"26":0,"27":0,"29":0,"30":0,"31":0,"32":0,"34":0,"39":1,"40":0,"41":0,"42":0,"43":0,"44":0,"46":0,"47":0,"48":0,"50":0,"51":0,"57":1,"58":0,"59":0,"60":0,"61":0,"62":0,"64":0,"65":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"75":0,"76":0,"79":1,"80":0,"81":0,"82":0,"83":0,"84":0,"86":0,"87":0,"90":1,"91":0,"92":0,"93":0,"95":0,"96":0,"101":1,"102":0,"103":0,"105":0,"108":1,"109":0,"110":0,"112":0,"115":1,"116":0,"121":1,"122":0,"123":0,"126":1}},"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/template/game-server/app.js":{"path":"/home/travis/build/npmtest/node-npmtest-pomelo/node_modules/pomelo/template/game-server/app.js","s":{"1":2,"2":2,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":53},"end":{"line":10,"column":63}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":32},"end":{"line":23,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":29}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":21}},"4":{"start":{"line":10,"column":0},"end":{"line":18,"column":3}},"5":{"start":{"line":11,"column":2},"end":{"line":17,"column":7}},"6":{"start":{"line":21,"column":0},"end":{"line":21,"column":12}},"7":{"start":{"line":23,"column":0},"end":{"line":25,"column":3}},"8":{"start":{"line":24,"column":2},"end":{"line":24,"column":51}}},"branchMap":{},"code":["var pomelo = require('pomelo');","","/**"," * Init app for client."," */","var app = pomelo.createApp();","app.set('name', '$');","","// app configuration","app.configure('production|development', 'connector', function(){","  app.set('connectorConfig',","    {","      connector : pomelo.connectors.hybridconnector,","      heartbeat : 3,","      useDict : true,","      useProtobuf : true","    });","});","","// start app","app.start();","","process.on('uncaughtException', function (err) {","  console.error(' Caught exception: ' + err.stack);","});",""],"l":{"1":2,"6":2,"7":0,"10":0,"11":0,"21":0,"23":0,"24":0}}}